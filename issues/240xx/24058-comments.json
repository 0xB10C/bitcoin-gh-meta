[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK\r\n\r\nThis should fix https://github.com/bitcoin/bitcoin/issues/10542",
      "created_at" : "2022-01-13T13:04:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012118062",
      "id" : 1012118062,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848U7Iu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012118062/reactions"
      },
      "updated_at" : "2022-01-13T13:12:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012118062",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@kallewoof do you know if any other wallet implemented BIP-322 yet, so we can compare the implementation?\r\n\r\nThis is really a good time to add test vectors to the BIP (and this PR).",
      "created_at" : "2022-01-13T13:39:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012145869",
      "id" : 1012145869,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848VB7N",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012145869/reactions"
      },
      "updated_at" : "2022-01-13T14:05:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012145869",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783971038"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783971038"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Although `SIGHASH_DEFAULT` implies `SIGHASH_ALL`, AFAIK using `SIGHASH_ALL` is still possible for users who wish to waste 1 byte. So I think you need `m_require_sighash_all && nHashType != SIGHASH_ALL` here too.",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T13:46:38Z",
      "diff_hunk" : "@@ -1707,6 +1711,9 @@ bool GenericTransactionSignatureChecker<T>::CheckSchnorrSignature(Span<const uns\n \n     uint8_t hashtype = SIGHASH_DEFAULT;\n     if (sig.size() == 65) {\n+        if (m_require_sighash_all) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783971038",
      "id" : 783971038,
      "line" : 1714,
      "node_id" : "PRRC_kwDOABII584uunLe",
      "original_commit_id" : "ad0002c91bb683c5d484ac03e16aaa682bc5a3e2",
      "original_line" : 1714,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/script/interpreter.cpp",
      "position" : 15,
      "pull_request_review_id" : 851731536,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783971038/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T13:48:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783971038",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783982176"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783982176"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This message implies the user can do something about it. Suggest instead: \"BIP-322 Proof of Funds is not supported\"",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T13:59:12Z",
      "diff_hunk" : "@@ -348,9 +348,16 @@ static RPCHelpMan verifymessage()\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n     case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+    case MessageVerificationResult::ERR_POF:\n+        throw JSONRPCError(RPC_TYPE_ERROR, \"Proof of funds require UTXO set access to verify\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783982176",
      "id" : 783982176,
      "line" : 352,
      "node_id" : "PRRC_kwDOABII584uup5g",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 352,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/misc.cpp",
      "position" : 5,
      "pull_request_review_id" : 851747231,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783982176/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T14:03:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783982176",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783983431"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783983431"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why not just throw in these other cases?",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T14:00:36Z",
      "diff_hunk" : "@@ -348,9 +348,16 @@ static RPCHelpMan verifymessage()\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n     case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+    case MessageVerificationResult::ERR_POF:\n+        throw JSONRPCError(RPC_TYPE_ERROR, \"Proof of funds require UTXO set access to verify\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?\n+    case MessageVerificationResult::INCONCLUSIVE:\n+        return false; // TODO: switch to a string based result? mix bool and strings?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783983431",
      "id" : 783983431,
      "line" : 354,
      "node_id" : "PRRC_kwDOABII584uuqNH",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 354,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/misc.cpp",
      "position" : 7,
      "pull_request_review_id" : 851747231,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783983431/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T14:03:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783983431",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783985638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783985638"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm unsure, but perhaps we should make a fresh `enum BIP322VerificationResult`?",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T14:03:16Z",
      "diff_hunk" : "@@ -36,7 +36,23 @@ enum class MessageVerificationResult {\n     ERR_NOT_SIGNED,\n \n     //! The message verification was successful.\n-    OK\n+    OK,\n+\n+    //\n+    // BIP-322 extensions",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r783985638",
      "id" : 783985638,
      "line" : 53,
      "node_id" : "PRRC_kwDOABII584uuqvm",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 42,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/util/message.h",
      "position" : 8,
      "pull_request_review_id" : 851747231,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783985638/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T14:03:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/783985638",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25331](https://github.com/bitcoin/bitcoin/pull/25331) (Add HashWriter without ser-type and ser-version and use it where possible by MarcoFalke)\n* [#25324](https://github.com/bitcoin/bitcoin/pull/25324) (refactor: add most of src/util to iwyu by fanquake)\n* [#22793](https://github.com/bitcoin/bitcoin/pull/22793) (Simplify BaseSignatureChecker virtual functions and GenericTransactionSignatureChecker constructors by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-01-13T14:58:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012214536",
      "id" : 1012214536,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848VSsI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012214536/reactions"
      },
      "updated_at" : "2022-07-09T04:50:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012214536",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @kallewoof do you know if any other wallet implemented BIP-322 yet, so we can compare the implementation?\r\n> \r\n> This is really a good time to add test vectors to the BIP (and this PR).\r\n\r\nI have an implementation here: https://github.com/bitcoin-s/bitcoin-s/pull/3823",
      "created_at" : "2022-01-13T18:38:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012405794",
      "id" : 1012405794,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848WBYi",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 1,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012405794/reactions"
      },
      "updated_at" : "2022-01-13T18:38:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012405794",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784367872"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784367872"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Isn't that a malleability? Anyway, gotcha.",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T22:18:53Z",
      "diff_hunk" : "@@ -1707,6 +1711,9 @@ bool GenericTransactionSignatureChecker<T>::CheckSchnorrSignature(Span<const uns\n \n     uint8_t hashtype = SIGHASH_DEFAULT;\n     if (sig.size() == 65) {\n+        if (m_require_sighash_all) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784367872",
      "id" : 784367872,
      "in_reply_to_id" : 783971038,
      "line" : 1714,
      "node_id" : "PRRC_kwDOABII584uwIEA",
      "original_commit_id" : "ad0002c91bb683c5d484ac03e16aaa682bc5a3e2",
      "original_line" : 1714,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/script/interpreter.cpp",
      "position" : 15,
      "pull_request_review_id" : 852302598,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784367872/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T22:18:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784367872",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784369323"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784369323"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sounds good. The intention is to actually add this functionality, but I think it should be its own PR.",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T22:21:45Z",
      "diff_hunk" : "@@ -348,9 +348,16 @@ static RPCHelpMan verifymessage()\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n     case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+    case MessageVerificationResult::ERR_POF:\n+        throw JSONRPCError(RPC_TYPE_ERROR, \"Proof of funds require UTXO set access to verify\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784369323",
      "id" : 784369323,
      "in_reply_to_id" : 783982176,
      "line" : 352,
      "node_id" : "PRRC_kwDOABII584uwIar",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 352,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/misc.cpp",
      "position" : 5,
      "pull_request_review_id" : 852304631,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784369323/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T22:21:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784369323",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784370137"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784370137"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Because these aren't errors? But yeah, that would be one way to return a message. I think I'd prefer to expand the returned value from simple bool to true|false|\"inconclusive\", but not sure that would be appreciated.",
      "commit_id" : "c1a5cf0033210f69af98a653895af801d452f041",
      "created_at" : "2022-01-13T22:23:14Z",
      "diff_hunk" : "@@ -348,9 +348,16 @@ static RPCHelpMan verifymessage()\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n     case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+    case MessageVerificationResult::ERR_POF:\n+        throw JSONRPCError(RPC_TYPE_ERROR, \"Proof of funds require UTXO set access to verify\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?\n+    case MessageVerificationResult::INCONCLUSIVE:\n+        return false; // TODO: switch to a string based result? mix bool and strings?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784370137",
      "id" : 784370137,
      "in_reply_to_id" : 783983431,
      "line" : 354,
      "node_id" : "PRRC_kwDOABII584uwInZ",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 354,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/misc.cpp",
      "position" : 7,
      "pull_request_review_id" : 852305720,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784370137/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T22:23:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784370137",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784393378"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784393378"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oftentimes you won't know which type it is until you finish verifying, so unifying the two types seems sensible to me.",
      "commit_id" : "8eb5031829390b1f746f54d08d28e51d507f3077",
      "created_at" : "2022-01-13T23:10:12Z",
      "diff_hunk" : "@@ -36,7 +36,23 @@ enum class MessageVerificationResult {\n     ERR_NOT_SIGNED,\n \n     //! The message verification was successful.\n-    OK\n+    OK,\n+\n+    //\n+    // BIP-322 extensions",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784393378",
      "id" : 784393378,
      "in_reply_to_id" : 783985638,
      "line" : 53,
      "node_id" : "PRRC_kwDOABII584uwOSi",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 53,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/util/message.h",
      "position" : 26,
      "pull_request_review_id" : 852337021,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784393378/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-13T23:10:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784393378",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I will make test vectors very soon. Let's compare notes at that point @benthecarman.",
      "created_at" : "2022-01-13T23:10:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012602458",
      "id" : 1012602458,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848WxZa",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012602458/reactions"
      },
      "updated_at" : "2022-01-13T23:10:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012602458",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I will make test vectors very soon. Let's compare notes at that point @benthecarman.\n\nSounds good, I made some in pr if you want to try those ",
      "created_at" : "2022-01-13T23:14:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012604302",
      "id" : 1012604302,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848Wx2O",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012604302/reactions"
      },
      "updated_at" : "2022-01-13T23:14:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012604302",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15256660?v=4",
         "events_url" : "https://api.github.com/users/benthecarman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/benthecarman/followers",
         "following_url" : "https://api.github.com/users/benthecarman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/benthecarman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/benthecarman",
         "id" : 15256660,
         "login" : "benthecarman",
         "node_id" : "MDQ6VXNlcjE1MjU2NjYw",
         "organizations_url" : "https://api.github.com/users/benthecarman/orgs",
         "received_events_url" : "https://api.github.com/users/benthecarman/received_events",
         "repos_url" : "https://api.github.com/users/benthecarman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/benthecarman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/benthecarman"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yep. I will try them, once I make my own. I don't want to adjust the code to fit your test vectors, I'd rather both implementations independently passing both sets.",
      "created_at" : "2022-01-13T23:15:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1012604804",
      "id" : 1012604804,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848Wx-E",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012604804/reactions"
      },
      "updated_at" : "2022-01-13T23:15:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1012604804",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784803179"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784803179"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Some RPCs return `false` as the result and an error message field. Others just throw with an error code and message. It's an error in the vague sense that the RPC failed to verify what it was asked to verify.",
      "commit_id" : "93a9c688541eb4a241156ac35d81ac735c1dd437",
      "created_at" : "2022-01-14T12:25:25Z",
      "diff_hunk" : "@@ -348,9 +348,16 @@ static RPCHelpMan verifymessage()\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n     case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+    case MessageVerificationResult::ERR_POF:\n+        throw JSONRPCError(RPC_TYPE_ERROR, \"Proof of funds require UTXO set access to verify\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?\n+    case MessageVerificationResult::INCONCLUSIVE:\n+        return false; // TODO: switch to a string based result? mix bool and strings?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r784803179",
      "id" : 784803179,
      "in_reply_to_id" : 783983431,
      "line" : 354,
      "node_id" : "PRRC_kwDOABII584uxyVr",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 354,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/misc.cpp",
      "position" : 7,
      "pull_request_review_id" : 852859400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784803179/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-14T12:25:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/784803179",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r785221182"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785221182"
         }
      },
      "author_association" : "MEMBER",
      "body" : "OK, but what about \"OK_TIMELOCKED\"?",
      "commit_id" : "93a9c688541eb4a241156ac35d81ac735c1dd437",
      "created_at" : "2022-01-14T23:09:17Z",
      "diff_hunk" : "@@ -348,9 +348,16 @@ static RPCHelpMan verifymessage()\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n     case MessageVerificationResult::ERR_MALFORMED_SIGNATURE:\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Malformed base64 encoding\");\n+    case MessageVerificationResult::ERR_POF:\n+        throw JSONRPCError(RPC_TYPE_ERROR, \"Proof of funds require UTXO set access to verify\"); // TODO: get access to UTXO set / mempool to handle this, then remove this error code?\n+    case MessageVerificationResult::INCONCLUSIVE:\n+        return false; // TODO: switch to a string based result? mix bool and strings?",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r785221182",
      "id" : 785221182,
      "in_reply_to_id" : 783983431,
      "line" : 354,
      "node_id" : "PRRC_kwDOABII584uzYY-",
      "original_commit_id" : "aed56aa486b6258aa03fd8c9a6154bb9bd7db973",
      "original_line" : 354,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/rpc/misc.cpp",
      "position" : 7,
      "pull_request_review_id" : 853453250,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785221182/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-14T23:09:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/785221182",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Would like to see BIP 322 address the distinction between the current \"signer receives fund with the address\" and the long-desired \"signer sent a prior transaction\" even if not supported by this PR.",
      "created_at" : "2022-01-15T22:06:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1013761616",
      "id" : 1013761616,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848bMZQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013761616/reactions"
      },
      "updated_at" : "2022-01-15T22:06:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013761616",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@luke-jr I'm not sure if you're suggesting a BIP change or a code feature. If the latter, I think the ideal path forward is for you to open a pull request follow-up to this one (maybe post-merge) to do what you are requesting. If former, open a PR to the BIP?",
      "created_at" : "2022-01-16T12:10:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1013864335",
      "id" : 1013864335,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5848bleP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013864335/reactions"
      },
      "updated_at" : "2022-01-16T12:10:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1013864335",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There is now a WIP with test vectors in https://github.com/bitcoin/bips/pull/1279 which needs to be filled in (possibly with @benthecarman's cases).",
      "created_at" : "2022-01-26T10:20:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1022060067",
      "id" : 1022060067,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII584862Yj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1022060067/reactions"
      },
      "updated_at" : "2022-01-26T10:20:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1022060067",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r795181706"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/795181706"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Note that `HASHER_BIP322` and some other identifiers are not available yet at this commit, i.e. compiling b23186d9f816aefe2fcf95e6f77d941c65e9c71c currently fails:\r\n```\r\n...\r\n  CXX      wallet/libbitcoin_wallet_tool_a-wallettool.o\r\nutil/message.cpp:105:41: error: use of undeclared identifier 'HASHER_BIP322'\r\n    uint256 message_hash = (CHashWriter(HASHER_BIP322) << message).GetSHA256();\r\n                                        ^\r\nutil/message.cpp:116:22: error: use of undeclared identifier 'DecodeTx'\r\n    if (signature && DecodeTx(to_sign, *signature, /* try_no_witness */ true, /* try_witness */ true)) {\r\n                     ^\r\nutil/message.cpp:120:49: error: no member named 'ERR_POF' in 'MessageVerificationResult'\r\n            result = MessageVerificationResult::ERR_POF;\r\n                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~^\r\nutil/message.cpp:128:49: error: no member named 'ERR_INVALID' in 'MessageVerificationResult'\r\n            result = MessageVerificationResult::ERR_INVALID;\r\n                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~^\r\nutil/message.cpp:141:57: error: no member named 'ERR_INVALID' in 'MessageVerificationResult'\r\n            result = MessageVerificationResult::ERR_INVALID;\r\n                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~^\r\n5 errors generated.\r\n...\r\n```",
      "commit_id" : "93a9c688541eb4a241156ac35d81ac735c1dd437",
      "created_at" : "2022-01-30T13:24:08Z",
      "diff_hunk" : "@@ -90,3 +90,65 @@ std::string SigningResultString(const SigningResult res)\n     }\n     assert(false);\n }\n+\n+std::optional<BIP322Txs> BIP322Txs::Create(const CTxDestination& destination, const std::string& message, MessageVerificationResult& result, const std::vector<unsigned char>* signature)\n+{\n+    // attempt to get script pub key for destination\n+    CScript message_challenge = GetScriptForDestination(destination);\n+    if (message_challenge.size() == 0) {\n+        // NoDestination; failure\n+        // (use legacy result)\n+        return std::nullopt;\n+    }\n+\n+    // prepare message hash\n+    uint256 message_hash = (CHashWriter(HASHER_BIP322) << message).GetSHA256();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r795181706",
      "id" : 795181706,
      "line" : 166,
      "node_id" : "PRRC_kwDOABII584vZYKK",
      "original_commit_id" : "b23186d9f816aefe2fcf95e6f77d941c65e9c71c",
      "original_line" : 105,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/util/message.cpp",
      "position" : 16,
      "pull_request_review_id" : 867105720,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/795181706/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-30T13:27:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/795181706",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@theStack Thanks for the review. You're right, I meant SIMPLE not SINGLE. Fixed.\r\n\r\nI did some clean-up and I think this also fixes the issues with HASHER_BIP322 being used before it is added.",
      "created_at" : "2022-01-31T04:23:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1025366737",
      "id" : 1025366737,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5849HdrR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1025366737/reactions"
      },
      "updated_at" : "2022-01-31T04:23:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1025366737",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "No idea why fuzzer runs out of time (2h!). Restarting didn't fix it either.",
      "created_at" : "2022-01-31T10:11:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1025572189",
      "id" : 1025572189,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5849IP1d",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1025572189/reactions"
      },
      "updated_at" : "2022-01-31T10:11:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1025572189",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This was fixed in 9237bdaac196951a437accaefa65638149b25978. Restarting the fuzz now should hopefully fix it.",
      "created_at" : "2022-01-31T10:21:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1025583487",
      "id" : 1025583487,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5849ISl_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1025583487/reactions"
      },
      "updated_at" : "2022-01-31T10:21:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1025583487",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated to reflect discrepancies in https://github.com/bitcoin/bips/pull/1279#issuecomment-1027545873 (version was explicitly set to 2 even though BIP allow(ed) any appropriate value, resulting in differences between implementations).",
      "created_at" : "2022-02-02T03:44:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1027547066",
      "id" : 1027547066,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5849Px-6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027547066/reactions"
      },
      "updated_at" : "2022-02-02T03:44:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027547066",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "8f0451c0-ec7d-4357-a370-eff72fb0685f",
      "created_at" : "2022-02-04T09:55:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1029818013",
      "id" : 1029818013,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII5849Ycad",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1029818013/reactions"
      },
      "updated_at" : "2022-02-04T09:55:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1029818013",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/93851981?v=4",
         "events_url" : "https://api.github.com/users/Bartascnk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Bartascnk/followers",
         "following_url" : "https://api.github.com/users/Bartascnk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Bartascnk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Bartascnk",
         "id" : 93851981,
         "login" : "Bartascnk",
         "node_id" : "U_kgDOBZgRTQ",
         "organizations_url" : "https://api.github.com/users/Bartascnk/orgs",
         "received_events_url" : "https://api.github.com/users/Bartascnk/received_events",
         "repos_url" : "https://api.github.com/users/Bartascnk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Bartascnk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Bartascnk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Bartascnk"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-04-27T15:49:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1111164990",
      "id" : 1111164990,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585COwg-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1111164990/reactions"
      },
      "updated_at" : "2022-04-27T15:49:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1111164990",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r872561862"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872561862"
         }
      },
      "author_association" : "NONE",
      "body" : "```suggestion\r\n\r\n    // BIP322 signature created using buidl-python library with same parameters as test on line 2596\r\n    BOOST_CHECK_EQUAL(\r\n        MessageVerify(\r\n            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\r\n         \"AkgwRQIhAOzyynlqt93lOKJr+wmmxIens//zPzl9tqIOua93wO6MAiBi5n5EyAcPScOjf1lAqIUIQtr3zKNeavYabHyR8eGhowEhAsfxIAMZZEKUPYWI4BruhAQjzFT8FSFSajuFwrDL1Yhy\",\r\n            \"Hello World\"),\r\n        MessageVerificationResult::OK);\r\n        \r\n```\r\n\r\nWe tried to create an implementation of BIP322 using the buidl-python library. The signature in this test case was produced using the same message and address. Not sure what is going on here.\r\n\r\nI was also able to verify the signature provided in the test on line 2596 through the buidl python code I produced.\r\n\r\nSo two signatures for the same message for the same address are both returning as valid. This seems strange?",
      "commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "created_at" : "2022-05-13T16:03:33Z",
      "diff_hunk" : "@@ -2547,6 +2581,74 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r872561862",
      "id" : 872561862,
      "line" : 2602,
      "node_id" : "PRRC_kwDOABII5840AjzG",
      "original_commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "original_line" : 2602,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 99,
      "pull_request_review_id" : 972487273,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872561862/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-13T16:03:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872561862",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18055112?v=4",
         "events_url" : "https://api.github.com/users/wip-abramson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wip-abramson/followers",
         "following_url" : "https://api.github.com/users/wip-abramson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wip-abramson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wip-abramson",
         "id" : 18055112,
         "login" : "wip-abramson",
         "node_id" : "MDQ6VXNlcjE4MDU1MTEy",
         "organizations_url" : "https://api.github.com/users/wip-abramson/orgs",
         "received_events_url" : "https://api.github.com/users/wip-abramson/received_events",
         "repos_url" : "https://api.github.com/users/wip-abramson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wip-abramson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wip-abramson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wip-abramson"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r872979455"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872979455"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@wip-abramson ECDSA signatures have randomness in them, so it is perfectly possible to construct multiple valid ones for the same key and message. Bitcoin Core's signing logic is based on RFC6979, but additionally grinds the nonce in order to make sure the R and S values in signatures don't exceed 32 bytes each. Is your signing code doing the same?",
      "commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "created_at" : "2022-05-14T13:23:51Z",
      "diff_hunk" : "@@ -2547,6 +2581,74 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r872979455",
      "id" : 872979455,
      "in_reply_to_id" : 872561862,
      "line" : 2602,
      "node_id" : "PRRC_kwDOABII5840CJv_",
      "original_commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "original_line" : 2602,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 99,
      "pull_request_review_id" : 973015656,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872979455/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-14T13:23:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/872979455",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r874435336"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874435336"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Added suggested test and rebased. Thanks!",
      "commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "created_at" : "2022-05-17T06:56:42Z",
      "diff_hunk" : "@@ -2547,6 +2581,74 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r874435336",
      "id" : 874435336,
      "in_reply_to_id" : 872561862,
      "line" : 2683,
      "node_id" : "PRRC_kwDOABII5840HtMI",
      "original_commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "original_line" : 2683,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 99,
      "pull_request_review_id" : 974928854,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874435336/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-17T06:56:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874435336",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r874773061"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874773061"
         }
      },
      "author_association" : "NONE",
      "body" : "Makes sense thanks! @sipa I am not a hundred per cent sure, but I think so. This is the code in buidl-python to generate the deterministic k value. https://github.com/buidl-bitcoin/buidl-python/blob/e62e0b9fd4271473cf641cde0fe366e65c787403/buidl/pecc.py#L563 ",
      "commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "created_at" : "2022-05-17T12:51:32Z",
      "diff_hunk" : "@@ -2547,6 +2581,74 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r874773061",
      "id" : 874773061,
      "in_reply_to_id" : 872561862,
      "line" : 2683,
      "node_id" : "PRRC_kwDOABII5840I_pF",
      "original_commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "original_line" : 2683,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 99,
      "pull_request_review_id" : 975410318,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874773061/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-17T12:51:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/874773061",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18055112?v=4",
         "events_url" : "https://api.github.com/users/wip-abramson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wip-abramson/followers",
         "following_url" : "https://api.github.com/users/wip-abramson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wip-abramson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wip-abramson",
         "id" : 18055112,
         "login" : "wip-abramson",
         "node_id" : "MDQ6VXNlcjE4MDU1MTEy",
         "organizations_url" : "https://api.github.com/users/wip-abramson/orgs",
         "received_events_url" : "https://api.github.com/users/wip-abramson/received_events",
         "repos_url" : "https://api.github.com/users/wip-abramson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wip-abramson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wip-abramson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wip-abramson"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Whilst implementing bip322 I noticed a discrepancy in the test vectors in the actual BIP vs the ones used in this P.R. The ones currently in bip322 are incorrect and don't verify against the messages provided. The above-mentioned P.R. is a fix for this",
      "created_at" : "2022-05-17T12:59:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1128838232",
      "id" : 1128838232,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585DSLRY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1128838232/reactions"
      },
      "updated_at" : "2022-05-17T12:59:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1128838232",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18055112?v=4",
         "events_url" : "https://api.github.com/users/wip-abramson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wip-abramson/followers",
         "following_url" : "https://api.github.com/users/wip-abramson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wip-abramson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wip-abramson",
         "id" : 18055112,
         "login" : "wip-abramson",
         "node_id" : "MDQ6VXNlcjE4MDU1MTEy",
         "organizations_url" : "https://api.github.com/users/wip-abramson/orgs",
         "received_events_url" : "https://api.github.com/users/wip-abramson/received_events",
         "repos_url" : "https://api.github.com/users/wip-abramson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wip-abramson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wip-abramson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wip-abramson"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r877627750"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877627750"
         }
      },
      "author_association" : "NONE",
      "body" : "Is there some reason it is useful to have different signatures considered valid for the same message?",
      "commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "created_at" : "2022-05-20T00:09:41Z",
      "diff_hunk" : "@@ -2547,6 +2581,74 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r877627750",
      "id" : 877627750,
      "in_reply_to_id" : 872561862,
      "line" : 2683,
      "node_id" : "PRRC_kwDOABII5840T4lm",
      "original_commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "original_line" : 2683,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 99,
      "pull_request_review_id" : 979382711,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877627750/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-20T00:09:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877627750",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/186831?v=4",
         "events_url" : "https://api.github.com/users/jandrieu/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jandrieu/followers",
         "following_url" : "https://api.github.com/users/jandrieu/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jandrieu/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jandrieu",
         "id" : 186831,
         "login" : "jandrieu",
         "node_id" : "MDQ6VXNlcjE4NjgzMQ==",
         "organizations_url" : "https://api.github.com/users/jandrieu/orgs",
         "received_events_url" : "https://api.github.com/users/jandrieu/received_events",
         "repos_url" : "https://api.github.com/users/jandrieu/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jandrieu/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jandrieu/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jandrieu"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r877631827"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877631827"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@jandrieu It is an inevitability. No unique signature scheme based on the discrete logarithm problem that Bitcoin relies on is known (unique signatures schemes are ones where only a single signature is valid per (message, public key) pair).",
      "commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "created_at" : "2022-05-20T00:21:39Z",
      "diff_hunk" : "@@ -2547,6 +2581,74 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r877631827",
      "id" : 877631827,
      "in_reply_to_id" : 872561862,
      "line" : 2683,
      "node_id" : "PRRC_kwDOABII5840T5lT",
      "original_commit_id" : "843ce398a1d4661b9d93160635b46cc0a70d6153",
      "original_line" : 2683,
      "original_position" : 99,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 99,
      "pull_request_review_id" : 979388084,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877631827/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-20T00:22:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/877631827",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r916736808"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/916736808"
         }
      },
      "author_association" : "NONE",
      "body" : "Two additional test vectors for p2sh and p2wsh multisig bip322 sigs\r\n\r\n```suggestion\r\n\r\n    // 2-of-3 p2sh multisig BIP322 signature (created with the buidl-python library)\r\n    // Keys are defined as (HDRootWIF, bip322_path)\r\n    // Key1 (L4DksdGZ4KQJfcLHD5Dv25fu8Rxyv7hHi2RjZR4TYzr8c6h9VNrp, m/45'/0/0/1)\r\n    // Key2 (KzSRqnCVwjzY8id2X5oHEJWXkSHwKUYaAXusjwgkES8BuQPJnPNu, m/45'/0/0/3)\r\n    // Key3 (L1zt9Rw7HrU7jaguMbVzhiX8ffuVkmMis5wLHddXYuHWYf8u8uRj, m/45'/0/0/6)\r\n    // BIP322 includes signs from Key2 and Key3\r\n    BOOST_CHECK_EQUAL(\r\n        MessageVerify(\r\n            \"3LnYoUkFrhyYP3V7rq3mhpwALz1XbCY9Uq\",\r\n         \"AAAAAAHNcfHaNfl8f/+ZC2gTr8aF+0KgppYjKM94egaNm/u1ZAAAAAD8AEcwRAIhAJ6hdj61vLDP+aFa30qUZQmrbBfE0kiOObYvt5nqPSxsAh9IrOKFwflfPRUcQ/5e0REkdFHVP2GGdUsMgDet+sNlAUcwRAIgH3eW/VyFDoXvCasd8qxgwj5NDVo0weXvM6qyGXLCR5YCIEwjbEV6fS6RWP6QsKOcMwvlGr1/SgdCC6pW4eH87/YgAUxpUiECKJfGy28imLcuAeNBLHCNv3NRP5jnJwFDNRXCYNY/vJ4hAv1RQtaZs7+vKqQeWl2rb/jd/gMxkEjUnjZdDGPDZkMLIQL65cH2X5O7LujjTLDL2l8Pxy0Y2UUR99u1qCfjdz7dklOuAAAAAAEAAAAAAAAAAAFqAAAAAA==\",\r\n            \"This will be a p2sh 2-of-3 multisig BIP 322 signed message\"),\r\n        MessageVerificationResult::OK);\r\n\r\n    // 3-of-3 p2wsh multisig BIP322 signature (created with the buidl-python library)\r\n    // Keys are defined as (HDRootWIF, bip322_path)\r\n    // Key1 (L4DksdGZ4KQJfcLHD5Dv25fu8Rxyv7hHi2RjZR4TYzr8c6h9VNrp, m/45'/0/0/6)\r\n    // Key2 (KzSRqnCVwjzY8id2X5oHEJWXkSHwKUYaAXusjwgkES8BuQPJnPNu, m/45'/0/0/9)\r\n    // Key3 (L1zt9Rw7HrU7jaguMbVzhiX8ffuVkmMis5wLHddXYuHWYf8u8uRj, m/45'/0/0/11)\r\n    BOOST_CHECK_EQUAL(\r\n        MessageVerify(\r\n            \"bc1qlqtuzpmazp2xmcutlwv0qvggdvem8vahkc333usey4gskug8nutsz53msw\",    \"BQBIMEUCIQDQoXvGKLH58exuujBOta+7+GN7vi0lKwiQxzBpuNuXuAIgIE0XYQlFDOfxbegGYYzlf+tqegleAKE6SXYIa1U+uCcBRzBEAiATegywVl6GWrG9jJuPpNwtgHKyVYCX2yfuSSDRFATAaQIgTLlU6reLQsSIrQSF21z3PtUO2yAUseUWGZqRUIE7VKoBSDBFAiEAgxtpidsU0Z4u/+5RB9cyeQtoCW5NcreLJmWXZ8kXCZMCIBR1sXoEinhZE4CF9P9STGIcMvCuZjY6F5F0XTVLj9SjAWlTIQP3dyWvTZjUENWJowMWBsQrrXCUs20Gu5YF79CG5Ga0XSEDwqI5GVBOuFkFzQOGH5eTExSAj2Z/LDV/hbcvAPQdlJMhA17FuuJd+4wGuj+ZbVxEsFapTKAOwyhfw9qpch52JKxbU64=\",\r\n            \"This will be a p2wsh 3-of-3 multisig BIP 322 signed message\"),\r\n        MessageVerificationResult::OK);\r\n        \r\n```",
      "commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "created_at" : "2022-07-08T11:41:44Z",
      "diff_hunk" : "@@ -2628,6 +2662,82 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // BIP322 signature created using buidl-python library with same parameters as test on line 2596\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+         \"AkgwRQIhAOzyynlqt93lOKJr+wmmxIens//zPzl9tqIOua93wO6MAiBi5n5EyAcPScOjf1lAqIUIQtr3zKNeavYabHyR8eGhowEhAsfxIAMZZEKUPYWI4BruhAQjzFT8FSFSajuFwrDL1Yhy\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r916736808",
      "id" : 916736808,
      "line" : 2691,
      "node_id" : "PRRC_kwDOABII5842pEso",
      "original_commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "original_line" : 2691,
      "original_position" : 107,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 107,
      "pull_request_review_id" : 1032795887,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/916736808/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-08T11:42:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/916736808",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18055112?v=4",
         "events_url" : "https://api.github.com/users/wip-abramson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wip-abramson/followers",
         "following_url" : "https://api.github.com/users/wip-abramson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wip-abramson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wip-abramson",
         "id" : 18055112,
         "login" : "wip-abramson",
         "node_id" : "MDQ6VXNlcjE4MDU1MTEy",
         "organizations_url" : "https://api.github.com/users/wip-abramson/orgs",
         "received_events_url" : "https://api.github.com/users/wip-abramson/received_events",
         "repos_url" : "https://api.github.com/users/wip-abramson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wip-abramson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wip-abramson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wip-abramson"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Tested for Legacy, P2SH-SegWit, SegWit, and Taproot. (commit 64ecca3f0e43b9088bf4be842a4096929724480f)\r\n\r\n`signmessage \"address\" \"mesage\"` -> signature\r\n`verifymessage \"address\" \"signature\" \"message\"` -> true\r\n\r\nResults in `true` when it should, and `errors` when messed with.\r\n\r\nExcept for Taproot addresses, which for some reason when the message is malformed, still results in `true`\r\n\r\nAll tests passed\r\n\r\nThis is a pre-req for BIP 129",
      "created_at" : "2022-07-08T15:42:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1179130082",
      "id" : 1179130082,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GSBji",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1179130082/reactions"
      },
      "updated_at" : "2022-07-11T20:28:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1179130082",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/24482484?v=4",
         "events_url" : "https://api.github.com/users/Rspigler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Rspigler/followers",
         "following_url" : "https://api.github.com/users/Rspigler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Rspigler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Rspigler",
         "id" : 24482484,
         "login" : "Rspigler",
         "node_id" : "MDQ6VXNlcjI0NDgyNDg0",
         "organizations_url" : "https://api.github.com/users/Rspigler/orgs",
         "received_events_url" : "https://api.github.com/users/Rspigler/received_events",
         "repos_url" : "https://api.github.com/users/Rspigler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Rspigler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Rspigler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Rspigler"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r918213210"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918213210"
         }
      },
      "author_association" : "NONE",
      "body" : "This is a test case that demonstrates the issue with taproot signatures that @richerandprettier refers to. It seems that p2tr signatures validate against any message under the current impl. \r\n\r\nIs there some extra configuration required to setup bitcoin with schnorr & taproot, wondering if these sigs are processed at all?\r\n\r\nI ran this against the buidl-python code - https://github.com/buidl-bitcoin/buidl-python/pull/140 - and get the expected results. Will dig into the code when i get some time.\r\n\r\n```suggestion\r\n\r\n    // Single key p2tr BIP322 signature (created with the buidl-python library)\r\n    // PrivateKeyWIF L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k \r\n    BOOST_CHECK_EQUAL(\r\n        MessageVerify(\r\n            \"bc1ppv609nr0vr25u07u95waq5lucwfm6tde4nydujnu8npg4q75mr5sxq8lt3\",                                                                \"AUHd69PrJQEv+oKTfZ8l+WROBHuy9HKrbFCJu7U1iK2iiEy1vMU5EfMtjc+VSHM7aU0SDbak5IUZRVno2P5mjSafAQ==\",\r\n            \"Hello World\"),\r\n        MessageVerificationResult::OK);\r\n\r\n    // Same p2tr BIP322 signature as above (created with the buidl-python library)\r\n    // Signature should not verify against the message\r\n    BOOST_CHECK_EQUAL(\r\n        MessageVerify(\r\n            \"bc1ppv609nr0vr25u07u95waq5lucwfm6tde4nydujnu8npg4q75mr5sxq8lt3\",\r\n         \"AUHd69PrJQEv+oKTfZ8l+WROBHuy9HKrbFCJu7U1iK2iiEy1vMU5EfMtjc+VSHM7aU0SDbak5IUZRVno2P5mjSafAQ==\",\r\n            \"Hello World - This should fail\"),\r\n        MessageVerificationResult::ERR_INVALID);\r\n\r\n    // wrong address\r\n```",
      "commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "created_at" : "2022-07-11T18:00:44Z",
      "diff_hunk" : "@@ -2628,6 +2662,82 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // BIP322 signature created using buidl-python library with same parameters as test on line 2596\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+         \"AkgwRQIhAOzyynlqt93lOKJr+wmmxIens//zPzl9tqIOua93wO6MAiBi5n5EyAcPScOjf1lAqIUIQtr3zKNeavYabHyR8eGhowEhAsfxIAMZZEKUPYWI4BruhAQjzFT8FSFSajuFwrDL1Yhy\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // wrong address",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r918213210",
      "id" : 918213210,
      "line" : 2692,
      "node_id" : "PRRC_kwDOABII5842utJa",
      "original_commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "original_line" : 2692,
      "original_position" : 108,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 108,
      "pull_request_review_id" : 1034738039,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918213210/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-11T18:00:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918213210",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18055112?v=4",
         "events_url" : "https://api.github.com/users/wip-abramson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wip-abramson/followers",
         "following_url" : "https://api.github.com/users/wip-abramson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wip-abramson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wip-abramson",
         "id" : 18055112,
         "login" : "wip-abramson",
         "node_id" : "MDQ6VXNlcjE4MDU1MTEy",
         "organizations_url" : "https://api.github.com/users/wip-abramson/orgs",
         "received_events_url" : "https://api.github.com/users/wip-abramson/received_events",
         "repos_url" : "https://api.github.com/users/wip-abramson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wip-abramson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wip-abramson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wip-abramson"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r918450389"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918450389"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks for the test! Immensely helpful. Looking into what's causing the issue now.",
      "commit_id" : "540c65adc4a1ab95723a5a4eda7029c551f152a9",
      "created_at" : "2022-07-12T00:38:10Z",
      "diff_hunk" : "@@ -2628,6 +2662,82 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // BIP322 signature created using buidl-python library with same parameters as test on line 2596\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+         \"AkgwRQIhAOzyynlqt93lOKJr+wmmxIens//zPzl9tqIOua93wO6MAiBi5n5EyAcPScOjf1lAqIUIQtr3zKNeavYabHyR8eGhowEhAsfxIAMZZEKUPYWI4BruhAQjzFT8FSFSajuFwrDL1Yhy\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // wrong address",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r918450389",
      "id" : 918450389,
      "in_reply_to_id" : 918213210,
      "line" : 2745,
      "node_id" : "PRRC_kwDOABII5842vnDV",
      "original_commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "original_line" : 2745,
      "original_position" : 108,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 149,
      "pull_request_review_id" : 1035083725,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918450389/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-12T00:38:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918450389",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Tested for Legacy, P2SH-SegWit, SegWit, and Taproot. (commit [64ecca3](https://github.com/bitcoin/bitcoin/commit/64ecca3f0e43b9088bf4be842a4096929724480f))\r\n[..]\r\n> Except for Taproot addresses, which for some reason when the message is malformed, still results in `true`\r\n\r\nThanks a lot for testing! Looking into taproot issues.",
      "created_at" : "2022-07-12T00:39:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1181186552",
      "id" : 1181186552,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GZ3n4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181186552/reactions"
      },
      "updated_at" : "2022-07-12T00:39:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181186552",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r918451932"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918451932"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Committed.",
      "commit_id" : "540c65adc4a1ab95723a5a4eda7029c551f152a9",
      "created_at" : "2022-07-12T00:42:38Z",
      "diff_hunk" : "@@ -2628,6 +2662,82 @@ BOOST_AUTO_TEST_CASE(message_verify)\n             \"IIcaIENoYW5jZWxsb3Igb24gYnJpbmsgb2Ygc2Vjb25kIGJhaWxvdXQgZm9yIGJhbmtzIAaHRtbCeDZINyavx14=\",\n             \"Trust me\"),\n         MessageVerificationResult::OK);\n+\n+    // BIP-322 tests\n+\n+    // privkey: L3VFeEujGtevx9w18HD1fhRbCH67Az2dpCymeRE1SoPK6XQtaN2k\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgM2gBAQqvZX15ZiysmKmQpDrG83avLIT492QBzLnQIxYCIBaTpOaD20qRlEylyxFSeEA2ba9YOixpX8z46TSDtS40ASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"\"),\n+        MessageVerificationResult::OK);\n+\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+            \"AkcwRAIgZRfIY3p7/DoVTty6YZbWS71bc5Vct9p9Fia83eRmw2QCICK/ENGfwLtptFluMGs2KsqoNSk89pO7F29zJLUx9a/sASECx/EgAxlkQpQ9hYjgGu6EBCPMVPwVIVJqO4XCsMvViHI=\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+\n+    // BIP322 signature created using buidl-python library with same parameters as test on line 2596\n+    BOOST_CHECK_EQUAL(\n+        MessageVerify(\n+            \"bc1q9vza2e8x573nczrlzms0wvx3gsqjx7vavgkx0l\",\n+         \"AkgwRQIhAOzyynlqt93lOKJr+wmmxIens//zPzl9tqIOua93wO6MAiBi5n5EyAcPScOjf1lAqIUIQtr3zKNeavYabHyR8eGhowEhAsfxIAMZZEKUPYWI4BruhAQjzFT8FSFSajuFwrDL1Yhy\",\n+            \"Hello World\"),\n+        MessageVerificationResult::OK);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#discussion_r918451932",
      "id" : 918451932,
      "in_reply_to_id" : 916736808,
      "line" : 2703,
      "node_id" : "PRRC_kwDOABII5842vnbc",
      "original_commit_id" : "64ecca3f0e43b9088bf4be842a4096929724480f",
      "original_line" : 2703,
      "original_position" : 107,
      "original_start_line" : null,
      "path" : "src/test/util_tests.cpp",
      "position" : 107,
      "pull_request_review_id" : 1035085606,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918451932/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-12T00:42:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/918451932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I'm not sure if you're suggesting a BIP change or a code feature.\r\n\r\nThis is a BIP incompleteness thing that should be addressed before any implementation is considered for merging. The BIP gives a technical way to \"sign a message\", without defining what the signature actually *means*.\r\n\r\nCurrent signed messages only mean \"the message is from whoever receives/d coins that are/were sent to this address\". Yet there's relatively little correct use of it. Instead, people seem to want things like proof-of-funds and proof-of-sending, which are fundamentally different in nature (eg, not associated with an address). The BIP should define each of these use cases distinctly, so they can't be misrepresented as the wrong kind of proof.",
      "created_at" : "2022-07-12T03:10:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1181264376",
      "id" : 1181264376,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GaKn4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181264376/reactions"
      },
      "updated_at" : "2022-07-12T03:10:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181264376",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The `SCRIPT_VERIFY_TAPROOT` flag was not added to the required flags, resulting in taproot checks being auto-successes. Fixed, thanks for the help!\r\n\r\nEdit: thinking about this, this is not how BIP-322 is meant to behave when it encounters unknown opcodes and such; the \"inconclusive\" middle state is meant to address exactly this, and not just throw a \"true\" out blindly. Annoying.\r\n\r\nEdit 2: this ends up being a silly special case for taproot, but it's worth taking note of as we may have the same issues in future versions as we upgrade the BIP322_REQUIRED_FLAGS vs BIP322_INCONCLUSIVE_FLAGS. The inconclusive flags checks for upgraded taproot versions and such, which current taproot is *not*, whereas the required flags neglected to include the current taproot.",
      "created_at" : "2022-07-12T03:18:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1181268285",
      "id" : 1181268285,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GaLk9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181268285/reactions"
      },
      "updated_at" : "2022-07-12T03:28:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181268285",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> This is a BIP incompleteness thing that should be addressed before any implementation is considered for merging. The BIP gives a technical way to \"sign a message\", without defining what the signature actually _means_.\r\n\r\nThe motivation is quite clear on what it means, IMO:\r\n\r\n> Ultimately no message signing protocol can actually prove control of funds, both because a signature is obsolete as soon as it is created, and because the possessor of a secret key may be willing to sign messages on others' behalf even if it would not sign actual transactions. No signmessage protocol can fix these limitations.\r\n\r\nIf you have suggestions on improvements to make, please make a pull request to the BIP repository.",
      "created_at" : "2022-07-12T03:32:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1181274882",
      "id" : 1181274882,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GaNMC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181274882/reactions"
      },
      "updated_at" : "2022-07-12T03:32:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181274882",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Right now its:\r\n\r\n`signmessage \"address\" \"message\"` -> signature\r\n`verifymessage \"address\" \"signature\" \"message\"` -> true/false\r\n\r\nWould it not be clearer to have the `verifymessage` command take the arguments this way:\r\n`verifymessage \"address\" \"message\" \"signature\"` -> true/false",
      "created_at" : "2022-07-12T06:03:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1181350722",
      "id" : 1181350722,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GaftC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181350722/reactions"
      },
      "updated_at" : "2022-07-12T06:03:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181350722",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/24482484?v=4",
         "events_url" : "https://api.github.com/users/Rspigler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Rspigler/followers",
         "following_url" : "https://api.github.com/users/Rspigler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Rspigler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Rspigler",
         "id" : 24482484,
         "login" : "Rspigler",
         "node_id" : "MDQ6VXNlcjI0NDgyNDg0",
         "organizations_url" : "https://api.github.com/users/Rspigler/orgs",
         "received_events_url" : "https://api.github.com/users/Rspigler/received_events",
         "repos_url" : "https://api.github.com/users/Rspigler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Rspigler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Rspigler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Rspigler"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-07-12T16:19:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1181976962",
      "id" : 1181976962,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585Gc4mC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181976962/reactions"
      },
      "updated_at" : "2022-07-12T16:19:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1181976962",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> This is a BIP incompleteness thing that should be addressed before any implementation is considered for merging. The BIP gives a technical way to \"sign a message\", without defining what the signature actually _means_.\r\n\r\nThis is not a problem specific to BIP-322. It's generally handled at another layer. For example, in Linked Data Signatures, a ProofPurpose is used to clarify why that particular proof is generated. For Verifiable Credentials, that proof purpose must be an attestationMethod, which means the signature was created as an attestation by the signer to the veracity of the signed document. \r\n\r\nIn contrast, zCaps, a capability mechanism that uses LinkedData signatures uses the two proof purposes of CapabilityInvocation and CapabilityDelegation to indicate the meaning of different signatures. The former to indicate that the signature means to \"do\" the action that is invoked, the latter that the signature means the previous controller is delegating to someone else (and not, at this time, invoking anything).\r\n\r\nIn all cases, the proof that is verified is cryptographic, and BIP-322 can provide that verifiable proof, while the proof-purpose is part of the signed payload yet exogenous to the signing itself.\r\n\r\nFWIW, @wip-abramson and I are working on mapping BIP-322 to Verifiable Credentials. I'm not sure if he's shared that work with this conversation, but it is a good example of how you can generalize BIP-322 signatures for specific use cases.",
      "created_at" : "2022-07-12T22:42:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1182565767",
      "id" : 1182565767,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GfIWH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182565767/reactions"
      },
      "updated_at" : "2022-07-12T22:42:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182565767",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/186831?v=4",
         "events_url" : "https://api.github.com/users/jandrieu/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jandrieu/followers",
         "following_url" : "https://api.github.com/users/jandrieu/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jandrieu/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jandrieu",
         "id" : 186831,
         "login" : "jandrieu",
         "node_id" : "MDQ6VXNlcjE4NjgzMQ==",
         "organizations_url" : "https://api.github.com/users/jandrieu/orgs",
         "received_events_url" : "https://api.github.com/users/jandrieu/received_events",
         "repos_url" : "https://api.github.com/users/jandrieu/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jandrieu/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jandrieu/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jandrieu"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">This is not a problem specific to BIP-322. It's generally handled at another layer.\r\n\r\nIt can't be. It's a different person signing in each scenario.\r\n\r\nProof-of-funds can be anyone who _could_ spend the UTXOs. Proof-of-sender can only be the actual person who _did_ send a given transaction. Proof-of-address can only be the person who received or would receive funds sent to an address. These can all be distinct entities, so the signature itself must specify which it is testifying to.\r\n\r\nThe existing `signmessage` standard/RPC is only capable of proof-of-address, and cannot prove funds or senders.\r\n",
      "created_at" : "2022-07-12T23:06:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24058#issuecomment-1182583236",
      "id" : 1182583236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24058",
      "node_id" : "IC_kwDOABII585GfMnE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182583236/reactions"
      },
      "updated_at" : "2022-07-12T23:06:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182583236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   }
]
