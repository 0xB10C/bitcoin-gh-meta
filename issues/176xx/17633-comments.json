[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#12134](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/12134.html) (Build previous releases and run functional tests by Sjors)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-11-29T19:36:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17633#issuecomment-559869749",
      "id" : 559869749,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17633",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTg2OTc0OQ==",
      "updated_at" : "2019-11-29T19:36:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559869749",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17633#discussion_r352275058"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17633"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/352275058"
         }
      },
      "author_association" : "NONE",
      "body" : "what do you think about updating the [developer docs](https://github.com/bitcoin/bitcoin/blob/33c103e2fe67e32e9f4e783fa243dd2bba6b1682/doc/developer-notes.md) or some other documentation (I'm new to bitcoin so I don't know where the right place is) with instructions on valgrind? \r\n\r\nIs there a CI step that runs the functional tests? Should we use this option there?",
      "commit_id" : "61a48c1b9515b717ac54914a4f60dd473fe29b73",
      "created_at" : "2019-11-30T09:13:56Z",
      "diff_hunk" : "@@ -157,6 +157,8 @@ def parse_args(self):\n                             help=\"use bitcoin-cli instead of RPC for all commands\")\n         parser.add_argument(\"--perf\", dest=\"perf\", default=False, action=\"store_true\",\n                             help=\"profile running nodes with perf for the duration of the test\")\n+        parser.add_argument(\"--valgrind\", dest=\"valgrind\", default=False, action=\"store_true\",\n+                            help=\"run nodes under the valgrind memory error detector: expect at least a ~10x slowdown, valgrind 3.14 or later required\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17633#discussion_r352275058",
      "id" : 352275058,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1MjI3NTA1OA==",
      "original_commit_id" : "61a48c1b9515b717ac54914a4f60dd473fe29b73",
      "original_position" : 5,
      "path" : "test/functional/test_framework/test_framework.py",
      "position" : 5,
      "pull_request_review_id" : 324884027,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17633",
      "updated_at" : "2019-11-30T09:16:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/352275058",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1986950?v=4",
         "events_url" : "https://api.github.com/users/paymog/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paymog/followers",
         "following_url" : "https://api.github.com/users/paymog/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paymog/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paymog",
         "id" : 1986950,
         "login" : "paymog",
         "node_id" : "MDQ6VXNlcjE5ODY5NTA=",
         "organizations_url" : "https://api.github.com/users/paymog/orgs",
         "received_events_url" : "https://api.github.com/users/paymog/received_events",
         "repos_url" : "https://api.github.com/users/paymog/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paymog/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paymog/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paymog"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17633#discussion_r352275126"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17633"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/352275126"
         }
      },
      "author_association" : "NONE",
      "body" : "Searching for valgrind doesn't show much documentation: https://github.com/bitcoin/bitcoin/search?q=valgrind&unscoped_q=valgrind",
      "commit_id" : "61a48c1b9515b717ac54914a4f60dd473fe29b73",
      "created_at" : "2019-11-30T09:15:21Z",
      "diff_hunk" : "@@ -157,6 +157,8 @@ def parse_args(self):\n                             help=\"use bitcoin-cli instead of RPC for all commands\")\n         parser.add_argument(\"--perf\", dest=\"perf\", default=False, action=\"store_true\",\n                             help=\"profile running nodes with perf for the duration of the test\")\n+        parser.add_argument(\"--valgrind\", dest=\"valgrind\", default=False, action=\"store_true\",\n+                            help=\"run nodes under the valgrind memory error detector: expect at least a ~10x slowdown, valgrind 3.14 or later required\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17633#discussion_r352275126",
      "id" : 352275126,
      "in_reply_to_id" : 352275058,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1MjI3NTEyNg==",
      "original_commit_id" : "61a48c1b9515b717ac54914a4f60dd473fe29b73",
      "original_position" : 5,
      "path" : "test/functional/test_framework/test_framework.py",
      "position" : 5,
      "pull_request_review_id" : 324884027,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17633",
      "updated_at" : "2019-11-30T09:16:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/352275126",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1986950?v=4",
         "events_url" : "https://api.github.com/users/paymog/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paymog/followers",
         "following_url" : "https://api.github.com/users/paymog/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paymog/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paymog",
         "id" : 1986950,
         "login" : "paymog",
         "node_id" : "MDQ6VXNlcjE5ODY5NTA=",
         "organizations_url" : "https://api.github.com/users/paymog/orgs",
         "received_events_url" : "https://api.github.com/users/paymog/received_events",
         "repos_url" : "https://api.github.com/users/paymog/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paymog/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paymog/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paymog"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17633#discussion_r352275132"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17633"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/352275132"
         }
      },
      "author_association" : "NONE",
      "body" : "`--exist-on-first-error` might slow down the development cycle if there are multiple valgrind problems in a single change.",
      "commit_id" : "61a48c1b9515b717ac54914a4f60dd473fe29b73",
      "created_at" : "2019-11-30T09:15:36Z",
      "diff_hunk" : "@@ -96,6 +96,15 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n+        if use_valgrind:\n+            default_suppressions_file = os.path.join(\n+                os.path.dirname(os.path.realpath(__file__)),\n+                \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n+            suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n+                                          default_suppressions_file)\n+            self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n+                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17633#discussion_r352275132",
      "id" : 352275132,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1MjI3NTEzMg==",
      "original_commit_id" : "61a48c1b9515b717ac54914a4f60dd473fe29b73",
      "original_position" : 20,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : 20,
      "pull_request_review_id" : 324884027,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17633",
      "updated_at" : "2019-11-30T09:16:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/352275132",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1986950?v=4",
         "events_url" : "https://api.github.com/users/paymog/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paymog/followers",
         "following_url" : "https://api.github.com/users/paymog/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paymog/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paymog",
         "id" : 1986950,
         "login" : "paymog",
         "node_id" : "MDQ6VXNlcjE5ODY5NTA=",
         "organizations_url" : "https://api.github.com/users/paymog/orgs",
         "received_events_url" : "https://api.github.com/users/paymog/received_events",
         "repos_url" : "https://api.github.com/users/paymog/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paymog/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paymog/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paymog"
      }
   }
]
