[
   {
      "author_association" : "MEMBER",
      "body" : "@Sjors \r\n\r\nI think you're seeing false positives due to MSAN being used only when compiling a subset of the code.\r\n\r\nOf the sanitizers MSAN is the most cumbersome to setup. Note that MSAN requires _all code used_ to be compiled using `-fsanitize=memory`. That is really all code: including the C++ standard library. I usually link Bitcoin Core against a self-built MSAN-instrumented `libc++` when using MSAN.\r\n\r\nIn short: to get MSAN working without false positives you'll have to make sure `-fsanitize=memory` is used when building a.) the standard library you're using, b.) all dependencies in use, and c.) Bitcoin Core itself :)",
      "created_at" : "2019-11-27T15:29:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17620#issuecomment-559135040",
      "id" : 559135040,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17620",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTEzNTA0MA==",
      "updated_at" : "2019-11-27T15:44:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559135040",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Sjors\r\n\r\nI don't have the time do it myself but if someone volunteers to add a MemorySanitizer build to Travis (we **really really** need that!) I can probably find time to document how I've gotten Bitcoin Core to work with MemorySanitizer in the past. The process is a bit hacky so it'll require some cleaning up before being integrated in Travis - but at least the required steps will be shown.",
      "created_at" : "2019-11-27T16:06:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17620#issuecomment-559150729",
      "id" : 559150729,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17620",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTE1MDcyOQ==",
      "updated_at" : "2019-11-27T16:06:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559150729",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I agree it's important to catch this class of bugs. Travis aside, it would be useful to document how to do this.\r\n\r\nOther than `libc++` I suppose I should use `/depends` and build those with `-fsanitize=memory` too?",
      "created_at" : "2019-11-27T16:07:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17620#issuecomment-559151318",
      "id" : 559151318,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17620",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTE1MTMxOA==",
      "updated_at" : "2019-11-27T16:07:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559151318",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Travis aside, it would be useful to document how to do this.\r\n\r\nAgreed! I'll try to guide you :)\r\n\r\nStart by compiling `libc++` with MSAN instrumentation. You'll get some hints here: https://github.com/google/sanitizers/wiki/MemorySanitizerLibcxxHowTo#instrumented-libc\r\n\r\nSee if you are able to get Bitcoin Core link to link against the MSAN-instrumented `libc++`.\r\n\r\nAfter that we can tackle the depends :)\r\n\r\n> Other than libc++ I suppose I should use /depends and build those with -fsanitize=memory too?\r\n\r\nYes, exactly! Boost will need some hand holding, but we'll get to that.\r\n\r\n",
      "created_at" : "2019-11-27T16:19:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17620#issuecomment-559156227",
      "id" : 559156227,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17620",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTE1NjIyNw==",
      "updated_at" : "2019-11-27T16:21:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559156227",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ironically I'm running into an uninitialized value error while compiling LLVM:\r\n\r\n```\r\ngit clone https://github.com/llvm/llvm-project.git\r\ngit checkout llvmorg-9.0.0\r\ncd llvm-project\r\nmkdir libcxx_msan && cd libcxx_msan\r\ncmake ../llvm -DCMAKE_BUILD_TYPE=Release -DLLVM_USE_SANITIZER=Memory -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++\r\nmake -j10\r\n\r\n...\r\nScanning dependencies of target LipoOptsTableGen\r\nSUMMARY: MemorySanitizer: use-of-uninitialized-value /usr/bin/../lib/gcc/x86_64-linux-gnu/7.4.0/../../../../include/c++/7.4.0/bits/stl_tree.h:1871:7 in _M_lower_bound\r\nExiting\r\ntools/llvm-cvtres/CMakeFiles/CvtResTableGen.dir/build.make:93: recipe for target 'tools/llvm-cvtres/Opts.inc' failed\r\nmake[2]: *** [tools/llvm-cvtres/Opts.inc] Error 77\r\nCMakeFiles/Makefile2:23514: recipe for target 'tools/llvm-cvtres/CMakeFiles/CvtResTableGen.dir/all' failed\r\nmake[1]: *** [tools/llvm-cvtres/CMakeFiles/CvtResTableGen.dir/all] Error 2\r\nmake[1]: *** Waiting for unfinished jobs....\r\n[ 21%] Linking CXX executable ../../bin/not\r\n[ 21%] Building LipoOpts.inc...\r\n==19389==WARNING: MemorySanitizer: use-of-uninitialized-value\r\n    #0 0xb8b543 in _M_lower_bound /usr/bin/../lib/gcc/x86_64-linux-gnu/7.4.0/../../../../include/c++/7.4.0/bits/stl_tree.h:1871:7\r\n    #1 0xb8b543 in lower_bound /usr/bin/../lib/gcc/x86_64-linux-gnu/7.4.0/../../../../include/c++/7.4.0/bits/stl_tree.h:1187:16\r\n    #2 0xb8b543 in lower_bound /usr/bin/../lib/gcc/x86_64-linux-gnu/7.4.0/../../../../include/c++/7.4.0/bits/stl_map.h:1233:21\r\n    #3 0xb8b543 in std::map<long, llvm::IntInit*, std::less<long>, std::allocator<std::pair<long const, llvm::IntInit*> > >::operator[](long const&) /usr/bin/../lib/gcc/x86_64-linux-gnu/7.4.0/../../../../include/c++/7.4.0/bits/stl_map.h:489:17\r\n    #4 0xb89714 in llvm::IntInit::get(long) /home/dev/src/llvm-project/llvm/lib/TableGen/Record.cpp:463:17\r\n    #5 0xc06ecb in llvm::TGParser::ParseSimpleValue(llvm::Record*, llvm::RecTy*, llvm::TGParser::IDParseMode) /home/dev/src/llvm-project/llvm/lib/TableGen/TGParser.cpp:1783:27\r\n    #6 0xbf2246 in llvm::TGParser::ParseValue(llvm::Record*, llvm::RecTy*, llvm::TGParser::IDParseMode) /home/dev/src/llvm-project/llvm/lib/TableGen/TGParser.cpp:2105:18\r\n    #7 0xc0d072 in llvm::TGParser::ParseDeclaration(llvm::Record*, bool) /home/dev/src/llvm-project/llvm/lib/TableGen/TGParser.cpp:2414:17\r\n    #8 0xc0edd6 in llvm::TGParser::ParseTemplateArgList(llvm::Record*) /home/dev/src/llvm-project/llvm/lib/TableGen/TGParser.cpp:2537:16\r\n    #9 0xc13e2a in llvm::TGParser::ParseClass() /home/dev/src/llvm-project/llvm/lib/TableGen/TGParser.cpp:2846:9\r\n    #10 0xc13465 in llvm::TGParser::ParseObject(llvm::MultiClass*) /home/dev/src/llvm-project/llvm/lib/TableGen/TGParser.cpp:3188:12\r\n    #11 0xc1b3ec in ParseObjectList /home/dev/src/llvm-project/llvm/lib/TableGen/TGParser.cpp:3200:9\r\n    #12 0xc1b3ec in llvm::TGParser::ParseFile() /home/dev/src/llvm-project/llvm/lib/TableGen/TGParser.cpp:3208:7\r\n    #13 0xb7e4fe in llvm::TableGenMain(char*, bool (*)(llvm::raw_ostream&, llvm::RecordKeeper&)) /home/dev/src/llvm-project/llvm/lib/TableGen/Main.cpp:99:14\r\n    #14 0xa7d445 in main /home/dev/src/llvm-project/llvm/utils/TableGen/TableGen.cpp:263:10\r\n    #15 0x7f02d86e7b96 in __libc_start_main /build/glibc-OTsEL5/glibc-2.27/csu/../csu/libc-start.c:310\r\n    #16 0x425f49 in _start (/home/dev/src/llvm-project/libcxx_msan/bin/llvm-tblgen+0x425f49)\r\n\r\nSUMMARY: MemorySanitizer: use-of-uninitialized-value /usr/bin/../lib/gcc/x86_64-linux-gnu/7.4.0/../../../../include/c++/7.4.0/bits/stl_tree.h:1871:7 in _M_lower_bound\r\nExiting\r\ntools/llvm-lipo/CMakeFiles/LipoOptsTableGen.dir/build.make:93: recipe for target 'tools/llvm-lipo/LipoOpts.inc' failed\r\nmake[2]: *** [tools/llvm-lipo/LipoOpts.inc] Error 77\r\n\r\n```\r\n\r\nShould I try an older version?",
      "created_at" : "2019-11-27T16:25:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17620#issuecomment-559158506",
      "id" : 559158506,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17620",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTE1ODUwNg==",
      "updated_at" : "2019-11-27T16:25:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559158506",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Sjors \r\n\r\nTry this:\r\n\r\n```\r\n$ svn co http://llvm.org/svn/llvm-project/llvm/trunk llvm\r\n$ (cd llvm/projects && svn co http://llvm.org/svn/llvm-project/libcxx/trunk libcxx)\r\n$ (cd llvm/projects && svn co http://llvm.org/svn/llvm-project/libcxxabi/trunk libcxxabi)\r\n$ mkdir libcxx_msan && cd libcxx_msan\r\n$ cmake ../llvm -DCMAKE_BUILD_TYPE=Release -DLLVM_USE_SANITIZER=Memory -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++\r\n$Â make cxx -j12\r\n```\r\n\r\nDoes that work? :)",
      "created_at" : "2019-11-27T16:29:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17620#issuecomment-559159919",
      "id" : 559159919,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17620",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTE1OTkxOQ==",
      "updated_at" : "2019-11-27T16:29:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559159919",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Subversion, really?",
      "created_at" : "2019-11-27T16:30:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17620#issuecomment-559160459",
      "id" : 559160459,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17620",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTE2MDQ1OQ==",
      "updated_at" : "2019-11-27T16:30:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559160459",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I heard the OpenBSD people suggested going with `cvs` instead :)",
      "created_at" : "2019-11-27T16:32:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17620#issuecomment-559161217",
      "id" : 559161217,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17620",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTE2MTIxNw==",
      "updated_at" : "2019-11-27T16:32:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559161217",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Subversion, really?\r\n\r\nHey... I used to work on Subversion. Apparently I had 82 commits (https://fisheye.apache.org/committer/subversion/rey4). Even still subversion can work better than git if you have a large codebase.",
      "created_at" : "2019-11-27T16:45:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17620#issuecomment-559166269",
      "id" : 559166269,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17620",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1OTE2NjI2OQ==",
      "updated_at" : "2019-11-27T16:45:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/559166269",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
