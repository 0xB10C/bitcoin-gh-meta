[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122534461"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122534461"
         }
      },
      "body" : "It seems like you could eliminate a bunch of ifdefs if you got rid of the JSONRPCRequest wallet pointer and did this mapping in GetWalletForJSONRPCRequest instead of here. This would keep core rpc code a little more independent from the wallet.",
      "commit_id" : "b77b2f254cc365728790f345deedbed1204964bb",
      "created_at" : "2017-06-16T21:10:45Z",
      "diff_hunk" : "@@ -184,6 +191,23 @@ static bool HTTPReq_JSONRPC(HTTPRequest* req, const std::string &)\n         // Set the URI\n         jreq.URI = req->GetURI();\n \n+#ifdef ENABLE_WALLET\n+        if (walletName.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122534461",
      "id" : 122534461,
      "original_commit_id" : "dbbdef99425539d5b59eba4ef640d241f7319d96",
      "original_position" : 71,
      "path" : "src/httprpc.cpp",
      "position" : 71,
      "pull_request_review_id" : 44665019,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615",
      "updated_at" : "2017-06-20T04:30:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122534461",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122833127"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122833127"
         }
      },
      "body" : "That would be less clean when calling in from GUI, tests, etc. But maybe a `void*` would make sense on the class?",
      "commit_id" : "b77b2f254cc365728790f345deedbed1204964bb",
      "created_at" : "2017-06-19T21:45:42Z",
      "diff_hunk" : "@@ -184,6 +191,23 @@ static bool HTTPReq_JSONRPC(HTTPRequest* req, const std::string &)\n         // Set the URI\n         jreq.URI = req->GetURI();\n \n+#ifdef ENABLE_WALLET\n+        if (walletName.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122833127",
      "id" : 122833127,
      "original_commit_id" : "dbbdef99425539d5b59eba4ef640d241f7319d96",
      "original_position" : 71,
      "path" : "src/httprpc.cpp",
      "position" : 71,
      "pull_request_review_id" : 44982715,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615",
      "updated_at" : "2017-06-20T04:30:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122833127",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122838637"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122838637"
         }
      },
      "body" : "> That would be less clean when calling in from GUI, tests, etc.\r\n\r\nI can see how deriving the wallet pointer in GetWalletForJSONRPCRequest could make gui & test code messier depending on how it was written, but if you provided an inverse function that set up the request object given the wallet name or pointer, I think that would keep things clean and isolated.\r\n\r\nAnyway, this is just a thought. It looks like if you wanted you could get rid of a lot of ifdefs even keeping the pointer member.\r\n\r\n> But maybe a void* would make sense on the class?\r\n\r\nAs long as there is a pointer member, I don't think making it void has advantages over using the forward declaration. Changing it to void just throws away type information and requires you to add casts, without letting you do anything that wasn't possible otherwise.",
      "commit_id" : "b77b2f254cc365728790f345deedbed1204964bb",
      "created_at" : "2017-06-19T22:15:15Z",
      "diff_hunk" : "@@ -184,6 +191,23 @@ static bool HTTPReq_JSONRPC(HTTPRequest* req, const std::string &)\n         // Set the URI\n         jreq.URI = req->GetURI();\n \n+#ifdef ENABLE_WALLET\n+        if (walletName.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122838637",
      "id" : 122838637,
      "original_commit_id" : "dbbdef99425539d5b59eba4ef640d241f7319d96",
      "original_position" : 71,
      "path" : "src/httprpc.cpp",
      "position" : 71,
      "pull_request_review_id" : 44988619,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615",
      "updated_at" : "2017-06-20T04:30:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122838637",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122972358"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122972358"
         }
      },
      "body" : "In commit \"RPC: Pass wallet through JSONRPCRequest\"\r\n\r\nConsider dropping this ifdef. It saves an insignificant amount of memory and seems like noise.",
      "commit_id" : "b77b2f254cc365728790f345deedbed1204964bb",
      "created_at" : "2017-06-20T13:18:13Z",
      "diff_hunk" : "@@ -46,8 +48,15 @@ class JSONRPCRequest\n     bool fHelp;\n     std::string URI;\n     std::string authUser;\n-\n-    JSONRPCRequest() : id(NullUniValue), params(NullUniValue), fHelp(false) {}\n+#ifdef ENABLE_WALLET",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122972358",
      "id" : 122972358,
      "original_commit_id" : "7b73f24311639fdc79c22608c21e4bfcbc6d4243",
      "original_position" : 15,
      "path" : "src/rpc/server.h",
      "position" : 15,
      "pull_request_review_id" : 45131983,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615",
      "updated_at" : "2017-06-20T13:31:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122972358",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122972500"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122972500"
         }
      },
      "body" : "In commit \"RPC: Pass wallet through JSONRPCRequest\"\r\n\r\nCould drop this ifdef also.",
      "commit_id" : "b77b2f254cc365728790f345deedbed1204964bb",
      "created_at" : "2017-06-20T13:18:48Z",
      "diff_hunk" : "@@ -46,8 +48,15 @@ class JSONRPCRequest\n     bool fHelp;\n     std::string URI;\n     std::string authUser;\n-\n-    JSONRPCRequest() : id(NullUniValue), params(NullUniValue), fHelp(false) {}\n+#ifdef ENABLE_WALLET\n+    CWallet *wallet;\n+#endif\n+\n+    JSONRPCRequest() : id(NullUniValue), params(NullUniValue), fHelp(false)\n+#ifdef ENABLE_WALLET",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122972500",
      "id" : 122972500,
      "original_commit_id" : "7b73f24311639fdc79c22608c21e4bfcbc6d4243",
      "original_position" : 20,
      "path" : "src/rpc/server.h",
      "position" : 20,
      "pull_request_review_id" : 45131983,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615",
      "updated_at" : "2017-06-20T13:31:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122972500",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122973289"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122973289"
         }
      },
      "body" : "In commit \"RPC: Allow rpcauth configs to specify...\"\r\n\r\nShould update `-rpcauth` documentation to mention the new field.",
      "commit_id" : "b77b2f254cc365728790f345deedbed1204964bb",
      "created_at" : "2017-06-20T13:21:51Z",
      "diff_hunk" : "@@ -119,14 +122,17 @@ static bool multiUserAuthorized(std::string strUserPass)\n             std::string strHashFromPass = HexStr(hexvec);\n \n             if (TimingResistantEqual(strHashFromPass, strHash)) {\n+                if (vFields.size() > 3) {\n+                    walletNameOut = vFields[3];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122973289",
      "id" : 122973289,
      "original_commit_id" : "b77b2f254cc365728790f345deedbed1204964bb",
      "original_position" : 33,
      "path" : "src/httprpc.cpp",
      "position" : 33,
      "pull_request_review_id" : 45131983,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615",
      "updated_at" : "2017-06-20T13:31:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122973289",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122988254"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122988254"
         }
      },
      "body" : "In commit \"RPC: Allow rpcauth configs to specify...\"\r\n\r\nI think instead of interpreting the 4th rpcauth field as a wallet filename field, it might be better to treat it as a generic options field (similar to the field in `fstab` files for mount options). E.g. instead of:\r\n\r\n```\r\nrpcauth=user:salt:hash:filename.dat\r\n```\r\n\r\nYou would write:\r\n\r\n```\r\nrpcauth=user:salt:hash:wallet=filename.dat\r\n```\r\n\r\nThis would be more extensible, also more readable.",
      "commit_id" : "b77b2f254cc365728790f345deedbed1204964bb",
      "created_at" : "2017-06-20T14:16:18Z",
      "diff_hunk" : "@@ -119,14 +122,17 @@ static bool multiUserAuthorized(std::string strUserPass)\n             std::string strHashFromPass = HexStr(hexvec);\n \n             if (TimingResistantEqual(strHashFromPass, strHash)) {\n+                if (vFields.size() > 3) {\n+                    walletNameOut = vFields[3];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122988254",
      "id" : 122988254,
      "original_commit_id" : "b77b2f254cc365728790f345deedbed1204964bb",
      "original_position" : 33,
      "path" : "src/httprpc.cpp",
      "position" : 33,
      "pull_request_review_id" : 45150078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615",
      "updated_at" : "2017-06-20T14:20:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122988254",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
