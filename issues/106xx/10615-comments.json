[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122534461"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122534461"
         }
      },
      "body" : "It seems like you could eliminate a bunch of ifdefs if you got rid of the JSONRPCRequest wallet pointer and did this mapping in GetWalletForJSONRPCRequest instead of here. This would keep core rpc code a little more independent from the wallet.",
      "commit_id" : "dbbdef99425539d5b59eba4ef640d241f7319d96",
      "created_at" : "2017-06-16T21:10:45Z",
      "diff_hunk" : "@@ -184,6 +191,23 @@ static bool HTTPReq_JSONRPC(HTTPRequest* req, const std::string &)\n         // Set the URI\n         jreq.URI = req->GetURI();\n \n+#ifdef ENABLE_WALLET\n+        if (walletName.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122534461",
      "id" : 122534461,
      "original_commit_id" : "dbbdef99425539d5b59eba4ef640d241f7319d96",
      "original_position" : 71,
      "path" : "src/httprpc.cpp",
      "position" : 71,
      "pull_request_review_id" : 44665019,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615",
      "updated_at" : "2017-06-16T21:10:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122534461",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122833127"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122833127"
         }
      },
      "body" : "That would be less clean when calling in from GUI, tests, etc. But maybe a `void*` would make sense on the class?",
      "commit_id" : "dbbdef99425539d5b59eba4ef640d241f7319d96",
      "created_at" : "2017-06-19T21:45:42Z",
      "diff_hunk" : "@@ -184,6 +191,23 @@ static bool HTTPReq_JSONRPC(HTTPRequest* req, const std::string &)\n         // Set the URI\n         jreq.URI = req->GetURI();\n \n+#ifdef ENABLE_WALLET\n+        if (walletName.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122833127",
      "id" : 122833127,
      "original_commit_id" : "dbbdef99425539d5b59eba4ef640d241f7319d96",
      "original_position" : 71,
      "path" : "src/httprpc.cpp",
      "position" : 71,
      "pull_request_review_id" : 44982715,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615",
      "updated_at" : "2017-06-19T21:45:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122833127",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122838637"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122838637"
         }
      },
      "body" : "> That would be less clean when calling in from GUI, tests, etc.\r\n\r\nI can see how deriving the wallet pointer in GetWalletForJSONRPCRequest could make gui & test code messier depending on how it was written, but if you provided an inverse function that set up the request object given the wallet name or pointer, I think that would keep things clean and isolated.\r\n\r\nAnyway, this is just a thought. It looks like if you wanted you could get rid of a lot of ifdefs even keeping the pointer member.\r\n\r\n> But maybe a void* would make sense on the class?\r\n\r\nAs long as there is a pointer member, I don't think making it void has advantages over using the forward declaration. Changing it to void just throws away type information and requires you to add casts, without letting you do anything that wasn't possible otherwise.",
      "commit_id" : "dbbdef99425539d5b59eba4ef640d241f7319d96",
      "created_at" : "2017-06-19T22:15:15Z",
      "diff_hunk" : "@@ -184,6 +191,23 @@ static bool HTTPReq_JSONRPC(HTTPRequest* req, const std::string &)\n         // Set the URI\n         jreq.URI = req->GetURI();\n \n+#ifdef ENABLE_WALLET\n+        if (walletName.empty()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10615#discussion_r122838637",
      "id" : 122838637,
      "original_commit_id" : "dbbdef99425539d5b59eba4ef640d241f7319d96",
      "original_position" : 71,
      "path" : "src/httprpc.cpp",
      "position" : 71,
      "pull_request_review_id" : 44988619,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10615",
      "updated_at" : "2017-06-19T22:15:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/122838637",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
