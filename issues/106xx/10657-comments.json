[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123681836"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123681836"
         }
      },
      "body" : "I guess that's not possible... ",
      "commit_id" : "d6c7ab9d27a56f08d4072a352640d55d5e46f484",
      "created_at" : "2017-06-23T06:44:59Z",
      "diff_hunk" : "@@ -1,4 +1,5 @@\n // Copyright (c) 2009-2016 The Bitcoin Core developers\n+// Copyright (c) 2017 The Zcash developers",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123681836",
      "id" : 123681836,
      "original_commit_id" : "d6c7ab9d27a56f08d4072a352640d55d5e46f484",
      "original_position" : 2,
      "path" : "src/key.cpp",
      "position" : 2,
      "pull_request_review_id" : 45909639,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657",
      "updated_at" : "2017-06-23T06:44:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123681836",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123684252"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123684252"
         }
      },
      "body" : "This change breaks the intentional compatibility with OpenSSL behavior; it also makes the commit message inaccurately described.\r\n\r\nIt doesn't matter for the Bitcoin system anymore because only strict DER matters there now, but this is otherwise an undisclosed consensus change (admittedly where OpenSSL creates inconsistency to begin with).",
      "commit_id" : "d6c7ab9d27a56f08d4072a352640d55d5e46f484",
      "created_at" : "2017-06-23T07:05:08Z",
      "diff_hunk" : "@@ -65,14 +66,15 @@ static int ecdsa_signature_parse_der_lax(const secp256k1_context* ctx, secp256k1\n     lenbyte = input[pos++];\n     if (lenbyte & 0x80) {\n         lenbyte -= 0x80;\n-        if (pos + lenbyte > inputlen) {\n+        if (lenbyte > inputlen - pos) {\n             return 0;\n         }\n         while (lenbyte > 0 && input[pos] == 0) {\n             pos++;\n             lenbyte--;\n         }\n-        if (lenbyte >= sizeof(size_t)) {\n+        static_assert(sizeof(size_t) >= 4, \"size_t too small\");\n+        if (lenbyte >= 4) {\n             return 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123684252",
      "id" : 123684252,
      "original_commit_id" : "6a42ccbb4f7abbe2d67e0ce288245c507b3edc4c",
      "original_position" : 30,
      "path" : "src/pubkey.cpp",
      "position" : 30,
      "pull_request_review_id" : 45912158,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657",
      "updated_at" : "2017-06-23T07:05:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123684252",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123684301"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123684301"
         }
      },
      "body" : "same here.",
      "commit_id" : "d6c7ab9d27a56f08d4072a352640d55d5e46f484",
      "created_at" : "2017-06-23T07:05:34Z",
      "diff_hunk" : "@@ -103,14 +105,15 @@ static int ecdsa_signature_parse_der_lax(const secp256k1_context* ctx, secp256k1\n     lenbyte = input[pos++];\n     if (lenbyte & 0x80) {\n         lenbyte -= 0x80;\n-        if (pos + lenbyte > inputlen) {\n+        if (lenbyte > inputlen - pos) {\n             return 0;\n         }\n         while (lenbyte > 0 && input[pos] == 0) {\n             pos++;\n             lenbyte--;\n         }\n-        if (lenbyte >= sizeof(size_t)) {\n+        static_assert(sizeof(size_t) >= 4, \"size_t too small\");\n+        if (lenbyte >= 4) {\n             return 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123684301",
      "id" : 123684301,
      "original_commit_id" : "6a42ccbb4f7abbe2d67e0ce288245c507b3edc4c",
      "original_position" : 48,
      "path" : "src/pubkey.cpp",
      "position" : 30,
      "pull_request_review_id" : 45912209,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657",
      "updated_at" : "2017-06-23T07:05:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123684301",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123685606"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123685606"
         }
      },
      "body" : "Help me understand how you believe there is a potential overflow here.\r\n\r\nMy meat based range analysis states:   Pos always has value 2 here.  Size_t lenbyte is 0-127 inclusive (after the subtraction takes it from a range of 128-255 inclusive).  This means that the left side (which is all  size_t) has a range of 2-129.\r\n\r\nWhat am I missing?    (As an aside, zcash really screwed up if there is any reason to use this lax parser in it; this code exists for compatibility with OpenSSL...)\r\n\r\n",
      "commit_id" : "d6c7ab9d27a56f08d4072a352640d55d5e46f484",
      "created_at" : "2017-06-23T07:15:45Z",
      "diff_hunk" : "@@ -46,7 +47,7 @@ static int ecdsa_signature_parse_der_lax(const secp256k1_context* ctx, secp256k1\n     lenbyte = input[pos++];\n     if (lenbyte & 0x80) {\n         lenbyte -= 0x80;\n-        if (pos + lenbyte > inputlen) {\n+        if (lenbyte > inputlen - pos) {\n             return 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123685606",
      "id" : 123685606,
      "original_commit_id" : "6a42ccbb4f7abbe2d67e0ce288245c507b3edc4c",
      "original_position" : 12,
      "path" : "src/pubkey.cpp",
      "position" : 12,
      "pull_request_review_id" : 45913661,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657",
      "updated_at" : "2017-06-23T07:31:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123685606",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123685772"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123685772"
         }
      },
      "body" : "And likewise for the below.",
      "commit_id" : "d6c7ab9d27a56f08d4072a352640d55d5e46f484",
      "created_at" : "2017-06-23T07:17:08Z",
      "diff_hunk" : "@@ -46,7 +47,7 @@ static int ecdsa_signature_parse_der_lax(const secp256k1_context* ctx, secp256k1\n     lenbyte = input[pos++];\n     if (lenbyte & 0x80) {\n         lenbyte -= 0x80;\n-        if (pos + lenbyte > inputlen) {\n+        if (lenbyte > inputlen - pos) {\n             return 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123685772",
      "id" : 123685772,
      "original_commit_id" : "6a42ccbb4f7abbe2d67e0ce288245c507b3edc4c",
      "original_position" : 12,
      "path" : "src/pubkey.cpp",
      "position" : 12,
      "pull_request_review_id" : 45913836,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657",
      "updated_at" : "2017-06-23T07:17:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123685772",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123689750"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123689750"
         }
      },
      "body" : "See https://github.com/zcash/zcash/pull/2335#discussion_r114272216:\r\n\r\n> This is a different style to before but it's still overflow-prone (for integer overflows this time).\r\n\r\nSo this change was included for consistency with the other changes, not necessarily because this specific instance suffers from overflow, but because that style of pointer comparison can be vulnerable, and it is better to have good style precedent. There's no telling what future people might happen to do with that code snippet.\r\n\r\n>  (As an aside, zcash really screwed up if there is any reason to use this lax parser in it; this code exists for compatibility with OpenSSL...)\r\n\r\nIn fact, we stripped out this code as unused and unnecessary in https://github.com/zcash/zcash/pull/2360, but for the purposes of upstreaming to Bitcoin Core where it was still present, we intentionally separated that change from these ones.",
      "commit_id" : "d6c7ab9d27a56f08d4072a352640d55d5e46f484",
      "created_at" : "2017-06-23T07:44:59Z",
      "diff_hunk" : "@@ -46,7 +47,7 @@ static int ecdsa_signature_parse_der_lax(const secp256k1_context* ctx, secp256k1\n     lenbyte = input[pos++];\n     if (lenbyte & 0x80) {\n         lenbyte -= 0x80;\n-        if (pos + lenbyte > inputlen) {\n+        if (lenbyte > inputlen - pos) {\n             return 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123689750",
      "id" : 123689750,
      "original_commit_id" : "6a42ccbb4f7abbe2d67e0ce288245c507b3edc4c",
      "original_position" : 12,
      "path" : "src/pubkey.cpp",
      "position" : 12,
      "pull_request_review_id" : 45918015,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657",
      "updated_at" : "2017-06-23T07:46:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123689750",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/4993799?v=3",
         "events_url" : "https://api.github.com/users/str4d/events{/privacy}",
         "followers_url" : "https://api.github.com/users/str4d/followers",
         "following_url" : "https://api.github.com/users/str4d/following{/other_user}",
         "gists_url" : "https://api.github.com/users/str4d/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/str4d",
         "id" : 4993799,
         "login" : "str4d",
         "organizations_url" : "https://api.github.com/users/str4d/orgs",
         "received_events_url" : "https://api.github.com/users/str4d/received_events",
         "repos_url" : "https://api.github.com/users/str4d/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/str4d/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/str4d/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/str4d"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123691904"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123691904"
         }
      },
      "body" : "We made this change because the previous check was platform-dependent and therefore difficult to review for determinism (and also we don't use the lax code at all, and have removed it). As far as being an undisclosed consensus change, it's obviously not one that would end up affecting running consensus (because compilation would fail on the target machines this affects), but ACK that it would have been clearer in a separate commit. I can revert it for this PR if desired.",
      "commit_id" : "d6c7ab9d27a56f08d4072a352640d55d5e46f484",
      "created_at" : "2017-06-23T07:58:38Z",
      "diff_hunk" : "@@ -65,14 +66,15 @@ static int ecdsa_signature_parse_der_lax(const secp256k1_context* ctx, secp256k1\n     lenbyte = input[pos++];\n     if (lenbyte & 0x80) {\n         lenbyte -= 0x80;\n-        if (pos + lenbyte > inputlen) {\n+        if (lenbyte > inputlen - pos) {\n             return 0;\n         }\n         while (lenbyte > 0 && input[pos] == 0) {\n             pos++;\n             lenbyte--;\n         }\n-        if (lenbyte >= sizeof(size_t)) {\n+        static_assert(sizeof(size_t) >= 4, \"size_t too small\");\n+        if (lenbyte >= 4) {\n             return 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10657#discussion_r123691904",
      "id" : 123691904,
      "original_commit_id" : "6a42ccbb4f7abbe2d67e0ce288245c507b3edc4c",
      "original_position" : 30,
      "path" : "src/pubkey.cpp",
      "position" : 30,
      "pull_request_review_id" : 45920373,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10657",
      "updated_at" : "2017-06-23T07:58:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/123691904",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/4993799?v=3",
         "events_url" : "https://api.github.com/users/str4d/events{/privacy}",
         "followers_url" : "https://api.github.com/users/str4d/followers",
         "following_url" : "https://api.github.com/users/str4d/following{/other_user}",
         "gists_url" : "https://api.github.com/users/str4d/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/str4d",
         "id" : 4993799,
         "login" : "str4d",
         "organizations_url" : "https://api.github.com/users/str4d/orgs",
         "received_events_url" : "https://api.github.com/users/str4d/received_events",
         "repos_url" : "https://api.github.com/users/str4d/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/str4d/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/str4d/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/str4d"
      }
   }
]
