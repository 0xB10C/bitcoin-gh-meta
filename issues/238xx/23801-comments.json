[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "A gentle ping, @MarcoFalke ",
      "created_at" : "2021-12-17T11:58:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23801#issuecomment-996668129",
      "id" : 996668129,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23801",
      "node_id" : "IC_kwDOABII5847Z_Lh",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/996668129/reactions"
      },
      "updated_at" : "2021-12-17T11:58:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/996668129",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/85434418?v=4",
         "events_url" : "https://api.github.com/users/shaavan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/shaavan/followers",
         "following_url" : "https://api.github.com/users/shaavan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/shaavan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/shaavan",
         "id" : 85434418,
         "login" : "shaavan",
         "node_id" : "MDQ6VXNlcjg1NDM0NDE4",
         "organizations_url" : "https://api.github.com/users/shaavan/orgs",
         "received_events_url" : "https://api.github.com/users/shaavan/received_events",
         "repos_url" : "https://api.github.com/users/shaavan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/shaavan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/shaavan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/shaavan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23801#discussion_r771354493"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23801"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771354493"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\nstatic constexpr std::chrono::minutes STALE_CHECK_INTERVAL{10};\r\n```\r\n\r\nnit. Also:\r\n\r\n```\r\nThe subject line of commit hash f8b810b8e15b72f5cff4c6e27bea3f6a64fd0c3d is followed by a non-empty line. Subject lines should always be followed by a blank line.",
      "commit_id" : "f8b810b8e15b72f5cff4c6e27bea3f6a64fd0c3d",
      "created_at" : "2021-12-17T12:23:01Z",
      "diff_hunk" : "@@ -58,9 +58,9 @@ static constexpr int32_t MAX_OUTBOUND_PEERS_TO_PROTECT_FROM_DISCONNECT = 4;\n /** Timeout for (unprotected) outbound peers to sync to our chainwork, in seconds */\n static constexpr int64_t CHAIN_SYNC_TIMEOUT = 20 * 60; // 20 minutes\n /** How frequently to check for stale tips, in seconds */\n-static constexpr int64_t STALE_CHECK_INTERVAL = 10 * 60; // 10 minutes\n+static constexpr std::chrono::seconds STALE_CHECK_INTERVAL{10 * 60}; // 10 minutes",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23801#discussion_r771354493",
      "id" : 771354493,
      "line" : 61,
      "node_id" : "PRRC_kwDOABII584t-e99",
      "original_commit_id" : "f8b810b8e15b72f5cff4c6e27bea3f6a64fd0c3d",
      "original_line" : 61,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 5,
      "pull_request_review_id" : 835174630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23801",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771354493/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-17T12:25:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771354493",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23801#discussion_r771354607"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23801"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771354607"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n/** How frequently to check for extra outbound peers and disconnect */\r\n```\r\n\r\nnit",
      "commit_id" : "f8b810b8e15b72f5cff4c6e27bea3f6a64fd0c3d",
      "created_at" : "2021-12-17T12:23:13Z",
      "diff_hunk" : "@@ -58,9 +58,9 @@ static constexpr int32_t MAX_OUTBOUND_PEERS_TO_PROTECT_FROM_DISCONNECT = 4;\n /** Timeout for (unprotected) outbound peers to sync to our chainwork, in seconds */\n static constexpr int64_t CHAIN_SYNC_TIMEOUT = 20 * 60; // 20 minutes\n /** How frequently to check for stale tips, in seconds */\n-static constexpr int64_t STALE_CHECK_INTERVAL = 10 * 60; // 10 minutes\n+static constexpr std::chrono::seconds STALE_CHECK_INTERVAL{10 * 60}; // 10 minutes\n /** How frequently to check for extra outbound peers and disconnect, in seconds */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23801#discussion_r771354607",
      "id" : 771354607,
      "line" : 62,
      "node_id" : "PRRC_kwDOABII584t-e_v",
      "original_commit_id" : "f8b810b8e15b72f5cff4c6e27bea3f6a64fd0c3d",
      "original_line" : 62,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 6,
      "pull_request_review_id" : 835174630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23801",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771354607/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-17T12:25:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771354607",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23801#discussion_r771355191"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23801"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771355191"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n            LogPrintf(\"Potential stale tip detected, will try using extra outbound peer (last tip update: %d seconds ago)\\n\", count_seconds(time_in_seconds - m_last_tip_update));\r\n```\r\n\r\nnit: Could clarify the unit",
      "commit_id" : "f8b810b8e15b72f5cff4c6e27bea3f6a64fd0c3d",
      "created_at" : "2021-12-17T12:24:17Z",
      "diff_hunk" : "@@ -4335,15 +4335,15 @@ void PeerManagerImpl::CheckForStaleTipAndEvictPeers()\n {\n     LOCK(cs_main);\n \n-    int64_t time_in_seconds = GetTime();\n+    auto time_in_seconds{GetTime<std::chrono::seconds>()};\n \n-    EvictExtraOutboundPeers(std::chrono::seconds{time_in_seconds});\n+    EvictExtraOutboundPeers(time_in_seconds);\n \n     if (time_in_seconds > m_stale_tip_check_time) {\n         // Check whether our tip is stale, and if so, allow using an extra\n         // outbound peer\n         if (!fImporting && !fReindex && m_connman.GetNetworkActive() && m_connman.GetUseAddrmanOutgoing() && TipMayBeStale()) {\n-            LogPrintf(\"Potential stale tip detected, will try using extra outbound peer (last tip update: %d seconds ago)\\n\", time_in_seconds - m_last_tip_update);\n+            LogPrintf(\"Potential stale tip detected, will try using extra outbound peer (last tip update: %d seconds ago)\\n\", (time_in_seconds - m_last_tip_update).count());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23801#discussion_r771355191",
      "id" : 771355191,
      "line" : 4346,
      "node_id" : "PRRC_kwDOABII584t-fI3",
      "original_commit_id" : "f8b810b8e15b72f5cff4c6e27bea3f6a64fd0c3d",
      "original_line" : 4346,
      "original_position" : 68,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 68,
      "pull_request_review_id" : 835174630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23801",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771355191/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-17T12:25:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771355191",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23801#discussion_r771355704"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23801"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771355704"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    if (m_last_tip_update.count() == 0) {\r\n```\r\n\r\nI'd use this, but there is really no difference, so both are fine.",
      "commit_id" : "f8b810b8e15b72f5cff4c6e27bea3f6a64fd0c3d",
      "created_at" : "2021-12-17T12:25:07Z",
      "diff_hunk" : "@@ -947,10 +947,10 @@ bool PeerManagerImpl::TipMayBeStale()\n {\n     AssertLockHeld(cs_main);\n     const Consensus::Params& consensusParams = m_chainparams.GetConsensus();\n-    if (m_last_tip_update == 0) {\n-        m_last_tip_update = GetTime();\n+    if (m_last_tip_update == std::chrono::seconds::zero()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23801#discussion_r771355704",
      "id" : 771355704,
      "line" : 950,
      "node_id" : "PRRC_kwDOABII584t-fQ4",
      "original_commit_id" : "f8b810b8e15b72f5cff4c6e27bea3f6a64fd0c3d",
      "original_line" : 950,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 36,
      "pull_request_review_id" : 835174630,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23801",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771355704/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-12-17T12:25:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/771355704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
