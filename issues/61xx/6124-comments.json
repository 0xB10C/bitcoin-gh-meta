[
   {
      "body" : "ACK. This version is well tested.\r\nThere are some ACKs for this PR in #5496 from before it was changed to a parameterised version.",
      "created_at" : "2015-05-12T17:14:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6124#issuecomment-101354626",
      "id" : 101354626,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6124",
      "updated_at" : "2015-05-12T17:17:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/101354626",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "As stated, I prefer this one, it is smaller code, has been more tested, save one byte.\r\n\r\nMy aesthetic argument is that we will get nicer human readable script. (< locktime > OP_CLTV and < push > OP_RCLTV, instead of cryptic < locktime > < mode > OP_CLTV )",
      "created_at" : "2015-05-12T17:29:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6124#issuecomment-101358596",
      "id" : 101358596,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6124",
      "updated_at" : "2015-05-12T17:30:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/101358596",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "Nit: I think CheckLockTime's full implementation would conceptually fit better implemented as part of BaseSignatureChecker (and it would remove a few lines of code), because the purpose of the BaseSignatureChecker/TransactionSignatureChecker split is just to have a checker that skips expensive ECDSA validation. Checking the locktime is fast, and it feels safer to have BaseSignatureChecker do the check.\r\n\r\nIn practice, the above nit doesn't matter, the only place BaseSignatureChecker is used at the moment is checking for non-standard scriptSigs.\r\n\r\nBesides that, code review ACK.\r\n",
      "created_at" : "2015-05-13T16:51:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6124#issuecomment-101744545",
      "id" : 101744545,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6124",
      "updated_at" : "2015-05-13T16:51:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/101744545",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "BaseSignatureChecker does not know that the data being signed is a\ntransaction.\n",
      "created_at" : "2015-05-13T16:57:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6124#issuecomment-101746355",
      "id" : 101746355,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6124",
      "updated_at" : "2015-05-13T16:57:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/101746355",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6124#discussion_r30430509"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6124"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/30430509"
         }
      },
      "body" : "This is not clear: 5-byte CScriptNum should be good up to 2\\*\\*39-1, *beyond* the limit of the nLockTime field.",
      "commit_id" : "afc4ff920540a9f18e15ee99b80c5dd0f437d058",
      "created_at" : "2015-05-15T17:57:50Z",
      "diff_hunk" : "@@ -335,9 +335,51 @@ bool EvalScript(vector<vector<unsigned char> >& stack, const CScript& script, un\n                 // Control\n                 //\n                 case OP_NOP:\n-                break;\n+                    break;\n+\n+                case OP_CHECKLOCKTIMEVERIFY:\n+                {\n+                    if (!(flags & SCRIPT_VERIFY_CHECKLOCKTIMEVERIFY)) {\n+                        // not enabled; treat as a NOP2\n+                        if (flags & SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS) {\n+                            return set_error(serror, SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS);\n+                        }\n+                        break;\n+                    }\n+\n+                    if (stack.size() < 1)\n+                        return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+\n+                    // Note that elsewhere numeric opcodes are limited to\n+                    // operands in the range -2**31+1 to 2**31-1, however it is\n+                    // legal for opcodes to produce results exceeding that\n+                    // range. This limitation is implemented by CScriptNum's\n+                    // default 4-byte limit.\n+                    //\n+                    // If we kept to that limit we'd have a year 2038 problem,\n+                    // even though the nLockTime field in transactions\n+                    // themselves is uint32 which only becomes meaningless\n+                    // after the year 2106.\n+                    //\n+                    // Thus as a special case we tell CScriptNum to accept up\n+                    // to 5-byte bignums, which are good until 2**32-1, the\n+                    // same limit as the nLockTime field itself.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6124#discussion_r30430509",
      "id" : 30430509,
      "original_commit_id" : "0eeab8e367dae0a01c417f25d76e2c40bd182732",
      "original_position" : 33,
      "path" : "src/script/interpreter.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6124",
      "updated_at" : "2015-05-15T18:05:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/30430509",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6124#discussion_r30430992"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6124"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/30430992"
         }
      },
      "body" : "Fixed.",
      "commit_id" : "afc4ff920540a9f18e15ee99b80c5dd0f437d058",
      "created_at" : "2015-05-15T18:02:59Z",
      "diff_hunk" : "@@ -335,9 +335,51 @@ bool EvalScript(vector<vector<unsigned char> >& stack, const CScript& script, un\n                 // Control\n                 //\n                 case OP_NOP:\n-                break;\n+                    break;\n+\n+                case OP_CHECKLOCKTIMEVERIFY:\n+                {\n+                    if (!(flags & SCRIPT_VERIFY_CHECKLOCKTIMEVERIFY)) {\n+                        // not enabled; treat as a NOP2\n+                        if (flags & SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS) {\n+                            return set_error(serror, SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS);\n+                        }\n+                        break;\n+                    }\n+\n+                    if (stack.size() < 1)\n+                        return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+\n+                    // Note that elsewhere numeric opcodes are limited to\n+                    // operands in the range -2**31+1 to 2**31-1, however it is\n+                    // legal for opcodes to produce results exceeding that\n+                    // range. This limitation is implemented by CScriptNum's\n+                    // default 4-byte limit.\n+                    //\n+                    // If we kept to that limit we'd have a year 2038 problem,\n+                    // even though the nLockTime field in transactions\n+                    // themselves is uint32 which only becomes meaningless\n+                    // after the year 2106.\n+                    //\n+                    // Thus as a special case we tell CScriptNum to accept up\n+                    // to 5-byte bignums, which are good until 2**32-1, the\n+                    // same limit as the nLockTime field itself.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6124#discussion_r30430992",
      "id" : 30430992,
      "original_commit_id" : "0eeab8e367dae0a01c417f25d76e2c40bd182732",
      "original_position" : 33,
      "path" : "src/script/interpreter.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6124",
      "updated_at" : "2015-05-15T18:05:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/30430992",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Yes, the whole point of BaseSignatureChecker is that EvalScript doesn't need to know anything about transactions.\r\nUntested ACK",
      "created_at" : "2015-05-15T18:38:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6124#issuecomment-102487938",
      "id" : 102487938,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6124",
      "updated_at" : "2015-05-15T18:38:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/102487938",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "any plan to merge that for 0.11 ? I know I can play with it with viacoin/testnet with mempool rule, but I think there is no point in delaying it anymore since there is no controversial problems anymore with it.",
      "created_at" : "2015-05-26T12:26:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6124#issuecomment-105507808",
      "id" : 105507808,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6124",
      "updated_at" : "2015-05-26T12:27:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/105507808",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   }
]
