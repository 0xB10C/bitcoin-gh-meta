[
   {
      "body" : "Commit description does not match. Also might be good to trigger a new CreateNewBlock in getblocktemplate, but not required I guess. Other than those, utACK.",
      "created_at" : "2015-05-23T00:12:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6177#issuecomment-104805680",
      "id" : 104805680,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6177",
      "updated_at" : "2015-05-23T00:12:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/104805680",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "I think the wording matches both the intent and the source code. Did I make a mistake somewhere? There was a grammar error which I fixed.",
      "created_at" : "2015-05-23T01:27:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6177#issuecomment-104810879",
      "id" : 104810879,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6177",
      "updated_at" : "2015-05-23T01:27:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/104810879",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "\"Fail a block template if block.nTime decreases\", but nothing fails?",
      "created_at" : "2015-05-23T01:48:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6177#issuecomment-104814105",
      "id" : 104814105,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6177",
      "updated_at" : "2015-05-23T01:48:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/104814105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Right, fixed.",
      "created_at" : "2015-05-23T12:41:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6177#issuecomment-104889249",
      "id" : 104889249,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6177",
      "updated_at" : "2015-05-23T12:41:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/104889249",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "Given that we already are guaranteed to mine valid blocks regardless by the GetMedianTimePast() check, how important is it really to avoid letting time go backwards?\r\n\r\nAs for the specific getblocktemplate issue have you actually seen this in practice? CreateNewBlock() checks every transaction against IsFinalTx() prior to including it in the template, so if I'm understanding the code correctly the worst that would happen is a transaction would be delayed from being mined and would sit in the mempool.\r\n\r\nAdditionally I and others have been thinking about changing the criteria for time-based nLockTime's to be compared against the median time rather than the block time for a number of incentive reasons. (possibly with a time-warp fix as well) At the very least I'm thinking of doing a patch to change the mempool behavior to accept txs based on the median rather than adjusted time.",
      "created_at" : "2015-05-23T15:18:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6177#issuecomment-104912026",
      "id" : 104912026,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6177",
      "updated_at" : "2015-05-23T15:18:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/104912026",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "If I understand correctly you want to prevent a solved block from having an epoch time stamp earlier than any prior block ? (Is the concern to prevent selfish/dishonest miners to possibly orphan the next block solved?) ",
      "created_at" : "2015-05-23T18:07:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6177#issuecomment-104933037",
      "id" : 104933037,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6177",
      "updated_at" : "2015-05-23T18:07:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/104933037",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5509299?v=3",
         "events_url" : "https://api.github.com/users/cinnamoncoin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cinnamoncoin/followers",
         "following_url" : "https://api.github.com/users/cinnamoncoin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cinnamoncoin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cinnamoncoin",
         "id" : 5509299,
         "login" : "cinnamoncoin",
         "organizations_url" : "https://api.github.com/users/cinnamoncoin/orgs",
         "received_events_url" : "https://api.github.com/users/cinnamoncoin/received_events",
         "repos_url" : "https://api.github.com/users/cinnamoncoin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cinnamoncoin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cinnamoncoin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cinnamoncoin"
      }
   },
   {
      "body" : "Peter, in the current code it is possible for the block's timestamp to be\nless than timestamp that was used during transaction selection, which means\nit is possible for invalid work to be generated: a block which contains a\ntransaction whose nLockTime is not satisfied by block.nTime. This patch\nfixes that edge case.\n\nFurther constraining the validity rules as you describe would also solve\nthe problem, but probably see some public debate.\n\nOn Sat, May 23, 2015 at 8:18 AM, Peter Todd <notifications@github.com>\nwrote:\n\n> Given that we already are guaranteed to mine valid blocks regardless by\n> the GetMedianTimePast() check, how important is it really to avoid letting\n> time go backwards?\n>\n> As for the specific getblocktemplate issue have you actually seen this in\n> practice? CreateNewBlock() checks every transaction against IsFinalTx()\n> prior to including it in the template, so if I'm understanding the code\n> correctly the worst that would happen is a transaction would be delayed\n> from being mined and would sit in the mempool.\n>\n> Additionally I and others have been thinking about changing the criteria\n> for time-based nLockTime's to be compared against the median time rather\n> than the block time for a number of incentive reasons. (possibly with a\n> time-warp fix as well) At the very least I'm thinking of doing a patch to\n> change the mempool behavior to accept txs based on the median rather than\n> adjusted time.\n>\n> Ã¢ÂÂ\n> Reply to this email directly or view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/6177#issuecomment-104912026>.\n>\n",
      "created_at" : "2015-05-23T19:37:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6177#issuecomment-104938490",
      "id" : 104938490,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6177",
      "updated_at" : "2015-05-23T19:37:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/104938490",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "No, this has nothing to do with the timestamps of previous blocks. It is to\nprevent invalid blocks from being generated, blocks which contain\ntime-locked transactions which have not yet matured because the timestamp\nwas altered after the transaction was selected.\n\nOn Sat, May 23, 2015 at 11:07 AM, cinnamon_carter <notifications@github.com>\nwrote:\n\n> If I understand correctly you want to prevent a solved block from having\n> an epoch time stamp earlier than any prior block ? (Is the concern to\n> prevent selfish/dishonest miners to possibly orphan the next block solved?)\n>\n> Ã¢ÂÂ\n> Reply to this email directly or view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/6177#issuecomment-104933037>.\n>\n",
      "created_at" : "2015-05-23T19:38:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6177#issuecomment-104938562",
      "id" : 104938562,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6177",
      "updated_at" : "2015-05-23T19:38:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/104938562",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "@maaku Ah, yeah, I'd forgotten we modify the block's nTime after creation, ugh; there's another usage of UpdateTime() in rpcmining.cpp in the getblocktemplate code that needs fixing too.\r\n\r\nAn alternative would be for UpdateTime() to simply never reduce the block nTime, which would remove the seldom tested codepath where the block template fails due to time going backwards. Basically the difference between what you've done and that option is that if GetAdjustedTime() somehow goes backwards by > 2 hours you risk creating a block that is invalid due to being too far into the future. Equally though, if GetAdjustedTime() goes backwards sufficiently far back that GetMedianTimePast() > GetAdjustedTime() + 2hrs you're also equally screwed - I have to wonder if the types of problems that would cause the latter are all that much less likely than the problems that would cause the former.\r\n\r\nIn any case, this pull-req needs more comments explaining what's going on, e.g. explain why UpdateTime() can cause the mining loop to break on line https://github.com/maaku/bitcoin/blob/blocktime-monotonic/src/miner.cpp#L539\r\n\r\nre: constraining the validity rules - of course, that needs a -dev mailing list post for the mempool change, and a full BIP if we eventually do a soft-fork.",
      "created_at" : "2015-05-23T23:11:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6177#issuecomment-104953950",
      "id" : 104953950,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6177",
      "updated_at" : "2015-05-23T23:11:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/104953950",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   }
]
