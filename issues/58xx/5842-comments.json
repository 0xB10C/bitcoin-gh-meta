[
   {
      "body" : "Please use the number of blocks on top of a block, rather than the height difference with the best known tip. This shouldn't be hard, as ActivateBestChain knows what tip we're working towards, so it could be passed down.\r\n\r\nAlso, I think you need a check to have a reasonable guess that pindexBestHeader is reasonably accurate/recent/valid, so you can't be cheated into skipping validation while being sybilled during IBD.\r\n\r\nFurthermore, just height can probably be skewed by an attacker. I think it's safer to look at difference in nChainWork, and divide that by best difficulty seen.\r\n\r\nAlso, removing the checkpoint verification before accepting a header means you're vulnerable to a memory usage DOS attack during IBD (a peer can give you a arbitrarily long low-difficulty headers).\r\n\r\nI'm generally in favor of reducing the relevance of checkpoints, but I think this patch is a way too large step at once. \r\n\r\nEDIT: fixed wrong code example",
      "created_at" : "2015-03-01T10:49:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5842#issuecomment-76591709",
      "id" : 76591709,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5842",
      "updated_at" : "2015-03-02T10:21:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/76591709",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "I think in general we can't get rid of checkpoints at this point. But we can reduce them to a performance/security tradeoff, without being a lock-in to a particular chain.",
      "created_at" : "2015-03-01T10:52:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5842#issuecomment-76591814",
      "id" : 76591814,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5842",
      "updated_at" : "2015-03-01T10:52:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/76591814",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@maaku's concern is trivially addressed by making it a one way latch.  E.g. so reorgs are still checked.",
      "created_at" : "2015-03-03T09:56:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5842#issuecomment-76916873",
      "id" : 76916873,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5842",
      "updated_at" : "2015-03-03T09:56:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/76916873",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "I was combing through the code recently with this in mind. \r\n\r\nMy idea was to disable checkpoints for accepting blocks once you are done totally catching up with the main chain(IsInitialBlockDownload() ?). You get the security benefits of the checkpoints during spinup, but removes the \"but Bitcoin uses checkpoints!\" idiocy in practice.\r\n\r\nWould anyone be interested in this?",
      "created_at" : "2015-03-09T02:46:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5842#issuecomment-77792708",
      "id" : 77792708,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5842",
      "updated_at" : "2015-03-09T02:48:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/77792708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "body" : "@instagibbs with headers first we do not need them during initial sync the benefit there can just be replaced by a work threshold before showing confirmations, or the like.",
      "created_at" : "2015-03-09T02:48:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5842#issuecomment-77792855",
      "id" : 77792855,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5842",
      "updated_at" : "2015-03-09T02:48:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/77792855",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell Just looking for small discrete steps that can be taken that answer 90% of the misconception without too much logic/code change. ",
      "created_at" : "2015-03-09T03:01:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5842#issuecomment-77793631",
      "id" : 77793631,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5842",
      "updated_at" : "2015-03-09T03:01:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/77793631",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   }
]
