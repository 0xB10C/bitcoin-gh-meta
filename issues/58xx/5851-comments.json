[
   {
      "body" : "I've also noticed this. There seems to be heavy lock contention during some of the synchronization phases. This causes e.g. RPC to react slowly. Also other peers sometimes completely time out. Not only during initial sync, but also when catching up a significant number of blocks.\r\n",
      "created_at" : "2015-05-18T09:00:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5851#issuecomment-102981306",
      "id" : 102981306,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5851",
      "updated_at" : "2015-05-18T10:01:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/102981306",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Made a little progress on finding out why the GUI hangs during intensive catch-up phases. Indeed, `cs_main` is held for a longer time. The GUI does not wait on `cs_main` during normal operation, however when it receives a new transaction\r\n\r\n    2015-05-29 06:48:46 AddToWallet xxx  new\r\n\r\nIt will try to get the transaction information from the wallet in `qt/transactiontablemodel.cpp:130`, which takes both a `cs_main` and wallet lock. It can stay stuck there for minutes at a time. A possible solution is to copy the relevant data in the notification function.\r\n\r\nThis is fighting symptoms, but will lead to a more responsive UI. The root cause would be mitigated by changing `ActivateBestChain`/`ActivateBestChainStep`/`ConnectTip` logic to release the cs_main lock between attaching blocks.\r\n\r\n**Edit:** another consequence is that the block number and progress in the UI is not updated, as it never manages to get the `cs_main` lock (it polls a few times per second, with `TRY_LOCK`). The new-block notification path (`NotifyBlockTip` Ã¢ÂÂ `ClientModel`) should be restored, with rate limiting.\r\n\r\n",
      "created_at" : "2015-05-29T06:56:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5851#issuecomment-106713148",
      "id" : 106713148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5851",
      "updated_at" : "2015-05-29T07:06:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/106713148",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "ActivateBestChain releases cs_main between blocks, except during a reorg,\nto avoid exposing a worse state than before.\n",
      "created_at" : "2015-05-29T14:38:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5851#issuecomment-106829957",
      "id" : 106829957,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5851",
      "updated_at" : "2015-05-29T14:38:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/106829957",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
