[
   {
      "author_association" : "MEMBER",
      "body" : "Needed rebase",
      "created_at" : "2017-10-26T20:40:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11568#issuecomment-339794211",
      "id" : 339794211,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11568",
      "updated_at" : "2017-10-26T20:40:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/339794211",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK 8ca0ffa127e1a11dca3a17f6d9b3079e92fd3771",
      "created_at" : "2017-10-26T21:57:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11568#issuecomment-339812899",
      "id" : 339812899,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11568",
      "updated_at" : "2017-10-26T21:57:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/339812899",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11568#discussion_r147334764"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11568"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/147334764"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Carrying forward my cranky-old-man-rant from: https://github.com/bitcoin/bitcoin/pull/11446#discussion_r144654182\r\n\r\nThis is crazy-confusing to read. If the header was bad enough to earn them some ban points, put the points on the score-board and carry on. But if it wasn't bad enough for points, kick them immediately.\r\n\r\nIf we're punishing for invalid, I think the disconnect needs to always happen ```if (state.IsInvalid)```. Using points as a proxy for some certain invalid condition(s) is really non-obvious.",
      "commit_id" : "8ca0ffa127e1a11dca3a17f6d9b3079e92fd3771",
      "created_at" : "2017-10-27T06:55:15Z",
      "diff_hunk" : "@@ -1264,6 +1264,9 @@ bool static ProcessHeadersMessage(CNode *pfrom, CConnman *connman, const std::ve\n             if (nDoS > 0) {\n                 LOCK(cs_main);\n                 Misbehaving(pfrom->GetId(), nDoS);\n+            } else if (!pfrom->fInbound && !pfrom->m_manual_connection && punish_invalid) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11568#discussion_r147334764",
      "id" : 147334764,
      "original_commit_id" : "8ca0ffa127e1a11dca3a17f6d9b3079e92fd3771",
      "original_position" : 13,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 72416330,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11568",
      "updated_at" : "2017-10-27T06:55:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/147334764",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11568#discussion_r147335063"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11568"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/147335063"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's weird to have a punish_invalid param that only punishes based on its own criteria. That means that both sites have to consider all constraints.\r\n\r\nInstead, from the ::HEADERS handler, how about something like:\r\n```c++\r\nbool punish_invalid = !pfrom->fInbound && !pfrom->m_manual_connection;\r\nProcessHeadersMessage(..., should_punish);\r\n```",
      "commit_id" : "8ca0ffa127e1a11dca3a17f6d9b3079e92fd3771",
      "created_at" : "2017-10-27T06:57:37Z",
      "diff_hunk" : "@@ -1264,6 +1264,9 @@ bool static ProcessHeadersMessage(CNode *pfrom, CConnman *connman, const std::ve\n             if (nDoS > 0) {\n                 LOCK(cs_main);\n                 Misbehaving(pfrom->GetId(), nDoS);\n+            } else if (!pfrom->fInbound && !pfrom->m_manual_connection && punish_invalid) {\n+                // Don't keep outbound peers that are on an invalid chain",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11568#discussion_r147335063",
      "id" : 147335063,
      "original_commit_id" : "8ca0ffa127e1a11dca3a17f6d9b3079e92fd3771",
      "original_position" : 14,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 72416682,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11568",
      "updated_at" : "2017-10-27T06:57:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/147335063",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. No hostility intended, I'm just still having a hard time understanding the intended ban/disconnect behavior.",
      "created_at" : "2017-10-27T07:05:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11568#issuecomment-339890772",
      "id" : 339890772,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11568",
      "updated_at" : "2017-10-27T07:05:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/339890772",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   }
]
