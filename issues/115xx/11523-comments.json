[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11523#discussion_r145581071"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11523"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145581071"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`enum class DoSSeverity`",
      "commit_id" : "863748bdd99f37d655921ba220705cf0bec107fd",
      "created_at" : "2017-10-19T01:15:58Z",
      "diff_hunk" : "@@ -22,6 +22,35 @@ static const unsigned char REJECT_NONSTANDARD = 0x40;\n static const unsigned char REJECT_INSUFFICIENTFEE = 0x42;\n static const unsigned char REJECT_CHECKPOINT = 0x43;\n \n+/** Reject codes greater or equal to this can be returned by AcceptToMemPool\n+ * for transactions, to signal internal conditions. They cannot and should not\n+ * be sent over the P2P network.\n+ *\n+ * These error codes are not consensus, but consensus changes should avoid using them\n+ * unnecessarily so as not to cause needless churn in core-based clients.\n+ */\n+static const unsigned int REJECT_INTERNAL = 0x100;\n+/** Too high fee. Can not be triggered by P2P transactions */\n+static const unsigned int REJECT_HIGHFEE = 0x100;\n+\n+enum class DoS_SEVERITY : int {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11523#discussion_r145581071",
      "id" : 145581071,
      "original_commit_id" : "863748bdd99f37d655921ba220705cf0bec107fd",
      "original_position" : 15,
      "path" : "src/consensus/validation.h",
      "position" : 15,
      "pull_request_review_id" : 70402166,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11523",
      "updated_at" : "2017-10-19T01:37:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145581071",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11523#discussion_r145582166"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11523"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145582166"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "You could overload `BadTx` (and others too) to avoid the empty string:\r\n```cpp\r\nvoid BadTx(const std::string& reject_reason, const std::string& debug_message=\"\", DoSSeverity level=DoSSeverity::CRITICAL, unsigned int reject_code=REJECT_INVALID);\r\nvoid BadTx(const std::string& reject_reason, DoSSeverity level=DoSSeverity::CRITICAL, unsigned int reject_code=REJECT_INVALID);\r\n```\r\nNit: also note the style change.",
      "commit_id" : "863748bdd99f37d655921ba220705cf0bec107fd",
      "created_at" : "2017-10-19T01:26:32Z",
      "diff_hunk" : "@@ -159,47 +159,65 @@ int64_t GetTransactionSigOpCost(const CTransaction& tx, const CCoinsViewCache& i\n bool CheckTransaction(const CTransaction& tx, CValidationState &state, bool fCheckDuplicateInputs)\n {\n     // Basic checks that don't depend on any context\n-    if (tx.vin.empty())\n-        return state.DoS(10, false, REJECT_INVALID, \"bad-txns-vin-empty\");\n-    if (tx.vout.empty())\n-        return state.DoS(10, false, REJECT_INVALID, \"bad-txns-vout-empty\");\n+    if (tx.vin.empty()) {\n+        state.BadTx(\"bad-txns-vin-empty\", \"\", DoS_SEVERITY::MEDIUM);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11523#discussion_r145582166",
      "id" : 145582166,
      "original_commit_id" : "863748bdd99f37d655921ba220705cf0bec107fd",
      "original_position" : 9,
      "path" : "src/consensus/tx_verify.cpp",
      "position" : 9,
      "pull_request_review_id" : 70402166,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11523",
      "updated_at" : "2017-10-19T01:37:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/145582166",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@promag Thanks for the review!\r\n\r\nI like your suggestion returning the class and calling modifiers on it -- not a fan of the use of default arguments -- but I think that it adds a bit more complexity to this patch that I'd like to avoid because I think that it makes it more difficult for future PRs working to separate this interface further.\r\n\r\nThe reason why I didn't do an `operator bool` is that we never return anything but false, so I think that it is more straightforward to return the literal `false` from the callsite, even if it is a little bit more verbose.",
      "created_at" : "2017-10-19T02:00:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11523#issuecomment-337777657",
      "id" : 337777657,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11523",
      "updated_at" : "2017-10-19T02:00:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/337777657",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   }
]
