[
   {
      "body" : "Thumbnail sketch of test plan:\r\n\r\n+ Create a wallet using 0.3.* version of bitcoin\r\n+ Run 0.6, create a couple of new keys via getnewaddress RPC\r\n+ Verify:  0.3.* version of bitcoin can still read wallet, version number in wallet is old\r\n\r\nRepeat for 0.4 and an encrypted wallet.\r\n\r\n+ Run 0.6 with -walletupgrade arg\r\n+ Verify: version number in wallet is new, new keys are compressed\r\n\r\n+ Run 0.6 with a brand-new -datadir\r\n+ Verify: version number in wallet is new, keys are compressed\r\n\r\nThose are the use-cases I care about.",
      "created_at" : "2012-03-22T17:49:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/974#issuecomment-4644305",
      "id" : 4644305,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/974",
      "updated_at" : "2012-03-22T18:16:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/4644305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Results of test:\r\n\r\nstart with a 0.3.24 wallet\r\nstart 0.6.0 (master + this pull)\r\nreported wallet version is low\r\nrequest 101 new addresses\r\nvalidateaddress reports that all are uncompressed \r\nstart 0.3.24\r\nvalidateaddress reports that earlier address are 'ismine'\r\n\r\nstart with an encrypted 0.4.1 wallet\r\nstart 0.6.0\r\nreported wallet version is 40000\r\nrequest 101 new addresses\r\nkeypool runs out\r\nunlock wallet\r\nrequest 101 new addresses\r\nvalidateaddress reports that all are uncompressed \r\nopen 0.4.1\r\nvalidateaddress reports that earlier address are 'ismine'\r\nunlock wallet\r\nunlock succeeds\r\n\r\nstart with an 0.3.24 wallet\r\nopen 0.6.0 -upgradewallet\r\nreported wallet version is 60000\r\nrequest 101 new addresses\r\nvalidateaddress reports that the last one is compressed\r\nstart 0.5.3\r\nerror\r\n\r\nstart with an 0.3.24 wallet\r\nopen 0.6.0 with -upgradewallet=50000\r\nreported wallet version is low\r\nencrypt wallet\r\nopen 0.6.0\r\nreport wallet version is 40000\r\n\r\nstart with an 0.3.24 wallet\r\nopen 0.6.0\r\nencrypt wallet\r\nopen 0.6.0\r\nreported wallet version is 60000\r\n\r\nstart with no wallet\r\nopen 0.6.0\r\nreported wallet version is 60000\r\nrequest new address\r\nvalidateaddress reports it is compressed\r\n\r\nstart with no wallet\r\nopen 0.6.0 with -upgradewallet=50000\r\nreported wallet version is low\r\nrequest new address\r\nvalidateaddress reports it is uncompressed\r\n",
      "created_at" : "2012-03-22T23:19:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/974#issuecomment-4650548",
      "id" : 4650548,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/974",
      "updated_at" : "2012-03-22T23:21:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/4650548",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "ACK",
      "created_at" : "2012-03-23T19:49:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/974#issuecomment-4666646",
      "id" : 4666646,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/974",
      "updated_at" : "2012-03-23T19:49:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/4666646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Code-read ACK, though do we want to enable compression when we encrypt wallets in 0.6 or only encrypt and set minversion to 0.4?\r\nThough maybe I dont understand why we would want to do an \"explicit\" upgrade when encrypting.  Also, what, exactly, is meant by an \"explicit\" upgrade?",
      "created_at" : "2012-03-23T22:28:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/974#issuecomment-4669103",
      "id" : 4669103,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/974",
      "updated_at" : "2012-03-23T22:33:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/4669103",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Explicit upgrade = the user takes an action from which one can reasonably expect that it makes the wallet incompatible with older versions. Wallet encryption is such an action (and for now, the only one).\r\n\r\nAlso, when an upgrade is done, it always upgrades all the way, unless a parameter is passed to -upgradewallet, and that constraint does not need to be broken.",
      "created_at" : "2012-03-23T22:39:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/974#issuecomment-4669224",
      "id" : 4669224,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/974",
      "updated_at" : "2012-03-23T22:39:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/4669224",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "ACK",
      "created_at" : "2012-03-23T22:40:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/974#issuecomment-4669243",
      "id" : 4669243,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/974",
      "updated_at" : "2012-03-23T22:40:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/4669243",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "A summary of the policy implemented by this patch:\r\n* -upgradewallet and -upgradewallet=0 force an upgrade to the latest version\r\n* -upgradewallet=<version> allows (but does not force) upgrades up to version <version>, unless the user takes an explicit action that requires upgrading beyond <version>, in which case an upgrade to the latest version is done.\r\n* no argument is identical to -upgradewallet=10500\r\n\r\nA simplified summary:\r\n* Wallets are not automatically upgraded, unless the user specifies -upgradewallet, or takes an explicit action that requires an upgrade. In both cases, we upgrade to the latest supported version.\r\n\r\n",
      "created_at" : "2012-03-24T01:24:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/974#issuecomment-4670803",
      "id" : 4670803,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/974",
      "updated_at" : "2012-03-24T01:24:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/4670803",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
