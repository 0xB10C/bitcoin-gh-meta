[
   {
      "body" : "Block source accounting serves multiple purposes: besides fixing DoS-score updates, doesn't this also eliminate all `nLastBlockTime` updates and some `reject` messages for compact blocks?",
      "created_at" : "2016-10-26T20:08:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9026#issuecomment-256462228",
      "id" : 256462228,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9026",
      "updated_at" : "2016-10-26T20:08:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/256462228",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "body" : "Yes, good point -- I'll rework, thanks for the review.",
      "created_at" : "2016-10-27T13:45:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9026#issuecomment-256644797",
      "id" : 256644797,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9026",
      "updated_at" : "2016-10-27T13:45:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/256644797",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "Reworked to try to avoid the problems pointed out by @kazcw.\r\n\r\nI don't really like this approach; I was planning to wait for the refactors being done by @TheBlueMatt elsewhere to settle down to try to fix this more cleanly, but he pointed out that we'd want to backport this bugfix to 0.13 so I went ahead and redid this in a way that is close to how the backport would look.\r\n\r\nDue to the code moves that have already happened in master (I think #8865) this didn't cherry-pick cleanly on 0.13, so I'll separately PR the backport for review.",
      "created_at" : "2016-10-31T14:45:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9026#issuecomment-257312895",
      "id" : 257312895,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9026",
      "updated_at" : "2016-10-31T14:45:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/257312895",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "I discussed this with @TheBlueMatt, who pointed out that `FillBlock()` was calling `CheckBlock()` and returning READ_STATUS_INVALID on `CheckBlock()` failures that weren't due to merkle-root mismatches.  This would in turn cause peers to be banned.  Since the intention is to only require our peers to check proof-of-work before relaying, I added a way to distinguish a `CheckBlock()` failure from other kinds of failures, and then in the caller I treat those the same as though `CheckBlock()` had succeeded -- this results in some extra computation in `ProcessNewBlock()` if an invalid block is received, but allows us to reuse the code that would mark the block as invalid, send reject messages, etc.\r\n\r\nAlso @gmaxwell suggested on IRC (if I understood correctly!) that we bump the protocol version so that we could distinguish between peers that have the old (buggy) banning behavior and peers that have this new behavior, so I did that here as well.\r\n\r\nThis all needs a BIP update, so I'll draft one, and I'll also mirror these changes in #9048.",
      "created_at" : "2016-11-01T15:21:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9026#issuecomment-257595250",
      "id" : 257595250,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9026",
      "updated_at" : "2016-11-01T15:22:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/257595250",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   }
]
