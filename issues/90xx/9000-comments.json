[
   {
      "body" : "Concept ACK.\r\n\r\nAlthough there looks to be a lot of code (as well as argument changes) to force powLimit to be interpreted as (\"7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\").\r\n\r\nWhat would be the disadvantage of just changing ConsensusParams.powLimit to that value in this case?\r\n\r\nAlso: maybe this should be allowed for the test networks only, not mainnet?",
      "created_at" : "2016-10-24T07:26:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9000#issuecomment-255666800",
      "id" : 255666800,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9000",
      "updated_at" : "2016-10-24T07:26:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255666800",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "This is sort of the idea behind block proposals, but what you're doing is more drop-in sounds useful to me.\r\n\r\nRe: pow limit, I have a proposal in progress to remove checkpoints completely that makes the powlimit an argument as a side effect. https://github.com/gmaxwell/bitcoin/commit/2db190b183c5204da23191ca642c7f6cad412ae3",
      "created_at" : "2016-10-25T08:39:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9000#issuecomment-255973336",
      "id" : 255973336,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9000",
      "updated_at" : "2016-10-25T08:39:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255973336",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@laanwj Allowing this to work on mainnet is actually a key part.\r\n\r\nThere's a reasonable next target for miner/pool testing: block reward to p2sh/p2wpkh/p2wsh. Most mining/pool software at the moment has only hard-coded support for paying to a pubkey hash. Obviously it would be nice give them the ability to support the other formats, but as-is, it can be tough (and potentially very expensive) to simulate mining for a few days on mainnet.\r\n\r\n(Though you could make the argument that a preference should be submitted to in gbt via coinbasetxn, which would include a serialized scriptPubKey or txout with the template, but let's ignore that for the sake of the example).\r\n\r\nThis would allow those changes to be made/tested safely, without having to worry about differences in chaings wrt activation status.\r\n\r\nAs for changing the consensus.powLimit, I was hoping to avoid mixing app logic in at the chain level.",
      "created_at" : "2016-10-25T19:20:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9000#issuecomment-256148203",
      "id" : 256148203,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9000",
      "updated_at" : "2016-10-25T19:20:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/256148203",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Yes agreed - I misunderstood the goal here, due to it being a global\r\ncommand-line argument instead of a per-use RPC argument. But you explain\r\nwhy in the OP (though it may still make sense to be able to do this with an\r\nRPC too)\r\n",
      "created_at" : "2016-10-25T21:54:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9000#issuecomment-256187422",
      "id" : 256187422,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9000",
      "updated_at" : "2016-10-26T11:52:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/256187422",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9000#discussion_r85441813"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9000"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85441813"
         }
      },
      "body" : "Since you are touching CheckBlockHeader, perhaps you could use the opportunity to remove the param fCheckPOW.\r\nNow checking the pow is the only thing CheckBlockHeader does, so if you don't want to check it just don't call the function.",
      "commit_id" : "9dafef32f62c32ca1e72fa53d6dfb8813339a411",
      "created_at" : "2016-10-27T22:35:04Z",
      "diff_hunk" : "@@ -3368,16 +3368,16 @@ bool FindUndoPos(CValidationState &state, int nFile, CDiskBlockPos &pos, unsigne\n     return true;\n }\n \n-bool CheckBlockHeader(const CBlockHeader& block, CValidationState& state, const Consensus::Params& consensusParams, bool fCheckPOW)\n+bool CheckBlockHeader(const CBlockHeader& block, CValidationState& state, const uint256& powLimit, bool fCheckPOW)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9000#discussion_r85441813",
      "id" : 85441813,
      "original_commit_id" : "a78f24e498ac3b5a8d07c883501e998c6bf23277",
      "original_position" : 40,
      "path" : "src/main.cpp",
      "position" : 40,
      "pull_request_review_id" : 6159322,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9000",
      "updated_at" : "2016-10-27T22:35:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85441813",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9000#discussion_r85442880"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9000"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85442880"
         }
      },
      "body" : "Tiny style nit: you could be inconsistent in the ordering of declaration and assignments to nBits and powLimit (ie either powLimit or nBits first in the 3 places). Feel free to ignore.",
      "commit_id" : "9dafef32f62c32ca1e72fa53d6dfb8813339a411",
      "created_at" : "2016-10-27T22:43:32Z",
      "diff_hunk" : "@@ -440,8 +443,16 @@ UniValue getblocktemplate(const JSONRPCRequest& request)\n             if (block.hashPrevBlock != pindexPrev->GetBlockHash())\n                 return \"inconclusive-not-best-prevblk\";\n             CValidationState state;\n-            uint32_t nBits = GetNextWorkRequired(pindexPrev, &block, Params().GetConsensus());\n-            TestBlockValidity(state, Params(), block, pindexPrev, Params().GetConsensus().powLimit, nBits, false, true);\n+            uint256 powLimit;\n+            uint32_t nBits;\n+            if (nforcednBits) {\n+                powLimit = uint256S(\"7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\");\n+                nBits = nforcednBits;\n+            } else {\n+                nBits = GetNextWorkRequired(pindexPrev, &block, Params().GetConsensus());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9000#discussion_r85442880",
      "id" : 85442880,
      "original_commit_id" : "9dafef32f62c32ca1e72fa53d6dfb8813339a411",
      "original_position" : 22,
      "path" : "src/rpc/mining.cpp",
      "position" : 30,
      "pull_request_review_id" : 6160331,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9000",
      "updated_at" : "2016-10-27T22:43:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85442880",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "utACK besides the fCheckPOW nit.\r\nIf the goal is to relay an invalid block on mainnet, neither the custom chains nor the blocksigned ones will help.\r\nRegarding CheckProofOfWork changing to taking the powLimit instead of the whole consensus params, I think it's fine that both do it. Whatever gets merged first will force the other one to rebase, but in a more or less trivial way. What you shouldn't do to avoid colliding with https://github.com/gmaxwell/bitcoin/commit/2db190b183c5204da23191ca642c7f6cad412ae3 is doing the same for CheckBlock and CheckBlockHeader. Those will have to take both a powLimit and the whole consensusParams (for @gmaxwell will need the struct in CheckBlockHeader()).\r\n",
      "created_at" : "2016-10-27T22:51:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9000#issuecomment-256792001",
      "id" : 256792001,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9000",
      "updated_at" : "2016-10-27T22:51:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/256792001",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "@jtimon I believe if we end up with both of these going in, @gmaxwell's change can simply decide which value to use inside of AcceptBlockHeader() before passing it on. I haven't looked closely though, that may not be the case. Either way, I'm sure rebasing would be no problem.\r\n\r\nAnd the goal isn't to relay an invalid block, it is simply to validate an otherwise-valid block that doesn't provide enough work. If that's the case, it responds with an \"ok\" to the miner, tricking it into thinking that the block was accepted. The block is then dropped and forgotten, not relayed.\r\n\r\nIn doing so, you can \"mine\" dozens (hundreds/thousands?) of mainnet blocks/sec as a test, using real and un-altered miners/pools.",
      "created_at" : "2016-10-27T23:37:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9000#issuecomment-256799686",
      "id" : 256799686,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9000",
      "updated_at" : "2016-10-27T23:37:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/256799686",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "needs rebase.",
      "created_at" : "2016-11-29T09:03:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9000#issuecomment-263514037",
      "id" : 263514037,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9000",
      "updated_at" : "2016-11-29T09:03:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/263514037",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   }
]
