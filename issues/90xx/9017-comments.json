[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r84996167"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84996167"
         }
      },
      "body" : "This is safe, but technically you are copying the vchData, which is specified to be zero_after_free memory, so you lose any guarantee that isn't somewhere in memory still.\r\n\r\nYou also may as well just directly use &scriptID (or scriptID.begin()) here rather than creating a temp.\r\n\r\n\r\n\r\n\r\n",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-10-25T20:41:31Z",
      "diff_hunk" : "@@ -277,6 +277,16 @@ bool CBitcoinAddress::GetKeyID(CKeyID& keyID) const\n     return true;\n }\n \n+bool CBitcoinAddress::GetScriptID(CScriptID& scriptID) const\n+{\n+    if (!IsValid() || vchVersion != Params().Base58Prefix(CChainParams::SCRIPT_ADDRESS))\n+        return false;\n+    uint160 id;\n+    memcpy(&id, &vchData[0], 20);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r84996167",
      "id" : 84996167,
      "original_commit_id" : "38186e2acbd51c1a6108f0e9b0525c5e9cda8614",
      "original_position" : 9,
      "path" : "src/base58.cpp",
      "position" : null,
      "pull_request_review_id" : 5738882,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84996167",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=3",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86399208"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86399208"
         }
      },
      "body" : "Curious when the pubkey.IsCompressed condition would not be true? Might be nice to note when the condition is expected in a comment. Alternately it might make more sense as an assertion if it's never expected, or as a separate JSON attribute like in the CKeyID handler above (line 123): `obj.push_back(Pair(\"iscompressed\", vchPubKey.IsCompressed()));`",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-03T17:29:22Z",
      "diff_hunk" : "@@ -135,6 +135,12 @@ class DescribeAddressVisitor : public boost::static_visitor<UniValue>\n             int nRequired;\n             ExtractDestinations(subscript, whichType, addresses, nRequired);\n             obj.push_back(Pair(\"script\", GetTxnOutputType(whichType)));\n+            CKeyID keyID;\n+            CPubKey pubkey;\n+            if (pwalletMain->GetWitnessKeyID(scriptID, keyID) &&\n+                pwalletMain->GetPubKey(keyID, pubkey) && pubkey.IsCompressed()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86399208",
      "id" : 86399208,
      "original_commit_id" : "8f001d24c7f93e83f8c9c75353312e7a31e6c1de",
      "original_position" : 7,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 7060794,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86399208",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86402388"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86402388"
         }
      },
      "body" : "Unless I'm missing something, nothing in this function seems specific to the `CCryptoKeyStore` type as opposed to a more general type like `CKeyStore`. If this is the case, it might be better to make this a `CKeyStore` member or a standalone function taking a `const CKeyStore&`.",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-03T17:44:15Z",
      "diff_hunk" : "@@ -277,6 +277,20 @@ bool CCryptoKeyStore::GetPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) co\n     return false;\n }\n \n+bool CCryptoKeyStore::GetWitnessKeyID(const CScriptID &scriptID, CKeyID &keyID) const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86402388",
      "id" : 86402388,
      "original_commit_id" : "f53bc8be5b51d0934d32f3af4ac3d963978c354a",
      "original_position" : 4,
      "path" : "src/wallet/crypter.cpp",
      "position" : 4,
      "pull_request_review_id" : 7060794,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86402388",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86407532"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86407532"
         }
      },
      "body" : "The size 20 check and explicit uint160 construction below seem like low level encoding details that are out of place here. Maybe this logic could go into to a new CScript method like: ```bool CScript::GetWitnessKeyID(CKeyID& keyID)``` or ```bool CScript::GetV0WitnessKeyID(uint160& keyID)```.",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-03T18:07:12Z",
      "diff_hunk" : "@@ -277,6 +277,20 @@ bool CCryptoKeyStore::GetPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) co\n     return false;\n }\n \n+bool CCryptoKeyStore::GetWitnessKeyID(const CScriptID &scriptID, CKeyID &keyID) const\n+{\n+    CScript subscript;\n+    int witnessVer = 0;\n+    std::vector<unsigned char> witnessProgram;\n+    if (!GetCScript(scriptID, subscript) ||\n+        !subscript.IsWitnessProgram(witnessVer, witnessProgram) ||\n+        witnessProgram.size() != 20) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86407532",
      "id" : 86407532,
      "original_commit_id" : "f53bc8be5b51d0934d32f3af4ac3d963978c354a",
      "original_position" : 11,
      "path" : "src/wallet/crypter.cpp",
      "position" : 11,
      "pull_request_review_id" : 7060794,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86407532",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86409948"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86409948"
         }
      },
      "body" : "Should at least replace `&id` with id.begin()` on this line to avoid making an assumption about the layout of uint160 objects.",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-03T18:17:28Z",
      "diff_hunk" : "@@ -277,6 +277,16 @@ bool CBitcoinAddress::GetKeyID(CKeyID& keyID) const\n     return true;\n }\n \n+bool CBitcoinAddress::GetScriptID(CScriptID& scriptID) const\n+{\n+    if (!IsValid() || vchVersion != Params().Base58Prefix(CChainParams::SCRIPT_ADDRESS))\n+        return false;\n+    uint160 id;\n+    memcpy(&id, &vchData[0], 20);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86409948",
      "id" : 86409948,
      "original_commit_id" : "38186e2acbd51c1a6108f0e9b0525c5e9cda8614",
      "original_position" : 9,
      "path" : "src/base58.cpp",
      "position" : null,
      "pull_request_review_id" : 7060794,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86409948",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86412900"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86412900"
         }
      },
      "body" : "This change makes the error message below somewhat inaccurate. Maybe replace `\"Invalid Bitcoin address\"` with `string(\"Invalid Bitcoin address for network \") + Params().NetworkIDString()` below.\r\n\r\n",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-03T18:30:44Z",
      "diff_hunk" : "@@ -539,11 +539,14 @@ UniValue dumpprivkey(const JSONRPCRequest& request)\n \n     string strAddress = request.params[0].get_str();\n     CBitcoinAddress address;\n-    if (!address.SetString(strAddress))\n+    if (!address.SetString(strAddress) || !address.IsValid())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86412900",
      "id" : 86412900,
      "original_commit_id" : "70ce4ed096d782970f6ddea29307919ee2a3db3a",
      "original_position" : 5,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : null,
      "pull_request_review_id" : 7060794,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86412900",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86413633"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86413633"
         }
      },
      "body" : "Maybe note in commit description that this change is moveonly (no code changes).",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-03T18:34:16Z",
      "diff_hunk" : "@@ -1016,51 +1016,6 @@ UniValue addmultisigaddress(const JSONRPCRequest& request)\n     return CBitcoinAddress(innerID).ToString();\n }\n \n-class Witnessifier : public boost::static_visitor<bool>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86413633",
      "id" : 86413633,
      "original_commit_id" : "2dce040ae0a252e77e7aa81c8821377fc82630ae",
      "original_position" : 4,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 7060794,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86413633",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86416529"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86416529"
         }
      },
      "body" : "It might be easier for callers if instead of exposing the `Witnessifier` class in wallet.h, you expose a simpler function that can be called by both `importprivkey` and `addwitnessaddress` and hides all the boost visitor implementation details:\r\n\r\n```bool AddWitnessCScript(CTxDestination dest, CScriptID &id);```\r\n\r\nThis could even be a CWallet member function.",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-03T18:47:08Z",
      "diff_hunk" : "@@ -986,4 +986,49 @@ class CAccount\n     }\n };\n \n+class Witnessifier : public boost::static_visitor<bool>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86416529",
      "id" : 86416529,
      "original_commit_id" : "2dce040ae0a252e77e7aa81c8821377fc82630ae",
      "original_position" : 4,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 7060794,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86416529",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86421555"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86421555"
         }
      },
      "body" : "This block of code seems very similar to code in `addwitnessaddress`:\r\n\r\nhttps://github.com/instagibbs/bitcoin/blob/1237cee5ab3506188fec78d33577f49ac78cd570/src/wallet/rpcwallet.cpp#L1053\r\n\r\nexcept this ignores the apply_visitor return value and passes a nonempty strlabel to SetAddressBook. Can both places be changed to call a common function?\r\n\r\nAlso is it ok to ignore the apply_visitor return value here? Consider adding a comment explaining why if it is ok.",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-03T19:13:10Z",
      "diff_hunk" : "@@ -133,6 +133,14 @@ UniValue importprivkey(const JSONRPCRequest& request)\n         pwalletMain->MarkDirty();\n         pwalletMain->SetAddressBook(vchAddress, strLabel, \"receive\");\n \n+        if (IsWitnessEnabled(chainActive.Tip(), Params().GetConsensus()) || GetBoolArg(\"-walletprematurewitness\", false)) {\n+            Witnessifier w;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86421555",
      "id" : 86421555,
      "original_commit_id" : "1237cee5ab3506188fec78d33577f49ac78cd570",
      "original_position" : 5,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : null,
      "pull_request_review_id" : 7060794,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86421555",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86424969"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86424969"
         }
      },
      "body" : "Would it be useful to callers to have an error message in the case where an update to the address book is skipped because this condition is false? Either way an explanatory comment might be good here.",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-03T19:32:01Z",
      "diff_hunk" : "@@ -133,6 +133,14 @@ UniValue importprivkey(const JSONRPCRequest& request)\n         pwalletMain->MarkDirty();\n         pwalletMain->SetAddressBook(vchAddress, strLabel, \"receive\");\n \n+        if (IsWitnessEnabled(chainActive.Tip(), Params().GetConsensus()) || GetBoolArg(\"-walletprematurewitness\", false)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86424969",
      "id" : 86424969,
      "original_commit_id" : "1237cee5ab3506188fec78d33577f49ac78cd570",
      "original_position" : 4,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : null,
      "pull_request_review_id" : 7060794,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86424969",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=3",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86429536"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86429536"
         }
      },
      "body" : "True an assert may make the most sense here. It really shouldn't happen, and if it is we want to find out as soon as possible to avoid loss of funds.",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-03T19:56:37Z",
      "diff_hunk" : "@@ -135,6 +135,12 @@ class DescribeAddressVisitor : public boost::static_visitor<UniValue>\n             int nRequired;\n             ExtractDestinations(subscript, whichType, addresses, nRequired);\n             obj.push_back(Pair(\"script\", GetTxnOutputType(whichType)));\n+            CKeyID keyID;\n+            CPubKey pubkey;\n+            if (pwalletMain->GetWitnessKeyID(scriptID, keyID) &&\n+                pwalletMain->GetPubKey(keyID, pubkey) && pubkey.IsCompressed()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86429536",
      "id" : 86429536,
      "original_commit_id" : "8f001d24c7f93e83f8c9c75353312e7a31e6c1de",
      "original_position" : 7,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_review_id" : 7090259,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86429536",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86429920"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86429920"
         }
      },
      "body" : "CKeyStore doesn't have access to keys if they're crypted.\r\n\r\nA standalone function may make more sense, I'm really ambivalent about this.",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-03T19:58:22Z",
      "diff_hunk" : "@@ -277,6 +277,20 @@ bool CCryptoKeyStore::GetPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) co\n     return false;\n }\n \n+bool CCryptoKeyStore::GetWitnessKeyID(const CScriptID &scriptID, CKeyID &keyID) const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86429920",
      "id" : 86429920,
      "original_commit_id" : "f53bc8be5b51d0934d32f3af4ac3d963978c354a",
      "original_position" : 4,
      "path" : "src/wallet/crypter.cpp",
      "position" : 4,
      "pull_request_review_id" : 7090620,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86429920",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "body" : "Why do you need GetWitnessKeyID in keystore? That doesn't seem to be something that belongs in the interface, and could just be implemented on top in the signing logic.",
      "created_at" : "2016-11-04T00:29:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#issuecomment-258314207",
      "id" : 258314207,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9017",
      "updated_at" : "2016-11-04T00:30:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/258314207",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86545230"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86545230"
         }
      },
      "body" : "Hmm, actually you're right, nothing in particular needs a CCryptoKeyStore. I thoroughly convinced myself otherwise previously somehow. Regardless, I'll divorce it from the keystore altogether.",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-04T13:33:36Z",
      "diff_hunk" : "@@ -277,6 +277,20 @@ bool CCryptoKeyStore::GetPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) co\n     return false;\n }\n \n+bool CCryptoKeyStore::GetWitnessKeyID(const CScriptID &scriptID, CKeyID &keyID) const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86545230",
      "id" : 86545230,
      "original_commit_id" : "f53bc8be5b51d0934d32f3af4ac3d963978c354a",
      "original_position" : 4,
      "path" : "src/wallet/crypter.cpp",
      "position" : 4,
      "pull_request_review_id" : 7199767,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86545230",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86552294"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86552294"
         }
      },
      "body" : "Not sure I should over-optimize this for 2 instances. Although I'm also getting concerned about the logic in this commit.\r\n\r\n1) If the user already has the p2pkh key in address book but not the nested version, it won't rescan(just a bug I can fix)\r\n2) I'm concerned of the user flow here. As soon as segwit activates it starts adding segwit addresses to the address book. This kind of behavior would be really unsafe for `getnewaddress` and it seems unsafe for the same reason here. It might make more sense to simply tell the user to importprivkey, then `addwitnessaddress`. That is literally equivalent.\r\n\r\nIn future wallet updates when `getnewaddress` is flipped to nested p2sh using some command line init variable, we can have this flip as well, or simply add both as a precaution.\r\n\r\nUnless there is a strong counter-argument here I think I should just delete this commit.",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-04T14:10:04Z",
      "diff_hunk" : "@@ -133,6 +133,14 @@ UniValue importprivkey(const JSONRPCRequest& request)\n         pwalletMain->MarkDirty();\n         pwalletMain->SetAddressBook(vchAddress, strLabel, \"receive\");\n \n+        if (IsWitnessEnabled(chainActive.Tip(), Params().GetConsensus()) || GetBoolArg(\"-walletprematurewitness\", false)) {\n+            Witnessifier w;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86552294",
      "id" : 86552294,
      "original_commit_id" : "1237cee5ab3506188fec78d33577f49ac78cd570",
      "original_position" : 5,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : null,
      "pull_request_review_id" : 7206541,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86552294",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86554049"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86554049"
         }
      },
      "body" : "Sounds like a good refactor for another PR, especially if I get rid of importprivkey commit. I'll drop this commit as well otherwise.",
      "commit_id" : "1c6fcd59d8bdcf2b1885ce3db6609310be713889",
      "created_at" : "2016-11-04T14:19:00Z",
      "diff_hunk" : "@@ -986,4 +986,49 @@ class CAccount\n     }\n };\n \n+class Witnessifier : public boost::static_visitor<bool>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9017#discussion_r86554049",
      "id" : 86554049,
      "original_commit_id" : "2dce040ae0a252e77e7aa81c8821377fc82630ae",
      "original_position" : 4,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 7208234,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9017",
      "updated_at" : "2016-11-04T15:53:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/86554049",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   }
]
