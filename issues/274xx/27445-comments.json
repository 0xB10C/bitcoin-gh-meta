[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23432](https://github.com/bitcoin/bitcoin/pull/23432) (BIP324: CKey encode/decode to elligator-swift by dhruv)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-04-11T00:44:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27445#issuecomment-1502524921",
      "id" : 1502524921,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27445",
      "node_id" : "IC_kwDOABII585ZjrX5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1502524921/reactions"
      },
      "updated_at" : "2023-04-11T08:07:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1502524921",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Build failure on CI here. This is during `make distdir`. \r\n\r\n```\r\n (cd secp256k1 && make  top_distdir=../../bitcoin-i686-pc-linux-gnu distdir=../../bitcoin-i686-pc-linux-gnu/src/secp256k1 \\\r\n     am__remove_distdir=: am__skip_length_check=: am__skip_mode_fix=: distdir)\r\nmake[4]: Entering directory '/tmp/cirrus-ci-build/ci/scratch/build/src/secp256k1'\r\nmake  distdir-am\r\nmake[5]: Entering directory '/tmp/cirrus-ci-build/ci/scratch/build/src/secp256k1'\r\npython3 tools/tests_wycheproof_generate.py /tmp/cirrus-ci-build/src/secp256k1/src/wycheproof/ecdsa_secp256k1_sha256_bitcoin_test.json > src/wycheproof/ecdsa_secp256k1_sha256_bitcoin_test.h\r\n/bin/dash: 1: cannot create src/wycheproof/ecdsa_secp256k1_sha256_bitcoin_test.h: Directory nonexistent\r\n```\r\nhttps://cirrus-ci.com/task/4665749793406976?logs=ci#L986\r\n\r\nSo, apparently the `wycheproof` directory doesn't exist. That's why (re)creating `ecdsa_secp256k1_sha256_bitcoin_test.h` fails.\r\n\r\nThe correct behavior would be that the `wycheproof` dir just exists (including `ecdsa_secp256k1_sha256_bitcoin_test.h`), so it wouldn't need to be created in the first place.\r\n\r\nI have no idea why this fails. `make distdir` works for me locally, even in a out-of-tree build.",
      "created_at" : "2023-04-11T09:01:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27445#issuecomment-1502947484",
      "id" : 1502947484,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27445",
      "node_id" : "IC_kwDOABII585ZlSic",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1502947484/reactions"
      },
      "updated_at" : "2023-04-11T09:01:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1502947484",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1071625?v=4",
         "events_url" : "https://api.github.com/users/real-or-random/events{/privacy}",
         "followers_url" : "https://api.github.com/users/real-or-random/followers",
         "following_url" : "https://api.github.com/users/real-or-random/following{/other_user}",
         "gists_url" : "https://api.github.com/users/real-or-random/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/real-or-random",
         "id" : 1071625,
         "login" : "real-or-random",
         "node_id" : "MDQ6VXNlcjEwNzE2MjU=",
         "organizations_url" : "https://api.github.com/users/real-or-random/orgs",
         "received_events_url" : "https://api.github.com/users/real-or-random/received_events",
         "repos_url" : "https://api.github.com/users/real-or-random/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/real-or-random/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/real-or-random/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/real-or-random"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Okay, I think I understand what's going on here:\r\n1. `make distdir` is supposed to create a directory with all files to be distributed\r\n2. the `distdir` target depends on all files to be distributed\r\n3. these file include `src/wycheproof/secdsa_secp256k1_sha256_bitcoin_test.h` because it's listed in `EXTRA_DIST` (perhaps `noinst_HEADERS` would be more appropriate, but the result is the same)\r\n4. `src/wycheproof/secdsa_secp256k1_sha256_bitcoin_test.h` has a dependency on `src/wycheproof/secdsa_secp256k1_sha256_bitcoin_test.json`\r\n6. if the `.json` file  in the src dir appears to be newer than the `.h` file in the build dir (e.g., due to meaningless timestamps after copying the source dir), `make distdir` tries to rebuild the `.h` in the build dir\r\n7. but this fails because not even the `src/wycheproof` subdirectory exists in the build dir (in a out-of-tree/VPATH build) \r\n\r\nPuh.\r\n\r\nItem 4 is a bug in libsecp256k1. While this dependency exists in fact, we don't want to list in the Makefile because the `.h` file is checked in the repo and only meant to be rebuilt by developers/maintainers of the library. (We similarly omit explicit dependencies for other generated source files.)  @sipa My suggestion above fixes exactly this. Can you to commit this here to see if it makes the problem disappear, just for a quick and dirty check of CI?  If that works, we can create a proper fix in libsecp256k1 and update this PR accordingly.  \r\n\r\nItem 7 is another bug in libsecp256k1, which is however only relevant to developers of the library. (Well, and users like Gentoo who insist on rebuilding everything from scratch in an out-of-tree build, see https://github.com/bitcoin-core/secp256k1/pull/1160.) The fix should simply be another `mkdir -p` call. ",
      "created_at" : "2023-04-11T09:33:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27445#issuecomment-1502994264",
      "id" : 1502994264,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27445",
      "node_id" : "IC_kwDOABII585Zld9Y",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 1,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1502994264/reactions"
      },
      "updated_at" : "2023-04-11T09:33:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1502994264",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1071625?v=4",
         "events_url" : "https://api.github.com/users/real-or-random/events{/privacy}",
         "followers_url" : "https://api.github.com/users/real-or-random/followers",
         "following_url" : "https://api.github.com/users/real-or-random/following{/other_user}",
         "gists_url" : "https://api.github.com/users/real-or-random/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/real-or-random",
         "id" : 1071625,
         "login" : "real-or-random",
         "node_id" : "MDQ6VXNlcjEwNzE2MjU=",
         "organizations_url" : "https://api.github.com/users/real-or-random/orgs",
         "received_events_url" : "https://api.github.com/users/real-or-random/received_events",
         "repos_url" : "https://api.github.com/users/real-or-random/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/real-or-random/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/real-or-random/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/real-or-random"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> Okay, I think I understand what's going on here\r\n\r\nGreat investigation, thanks! And sorry this broke the build.\r\n\r\nI see you already put hotfixes in https://github.com/bitcoin-core/secp256k1/pull/1276 for the autotools issue. Thanks. I can put a hotfix for the linting issue + open an issue for a longer-term fix for linting.",
      "created_at" : "2023-04-14T11:18:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27445#issuecomment-1508355198",
      "id" : 1508355198,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27445",
      "node_id" : "IC_kwDOABII585Z56x-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508355198/reactions"
      },
      "updated_at" : "2023-04-14T11:18:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508355198",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/128569685?v=4",
         "events_url" : "https://api.github.com/users/RandomLattice/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RandomLattice/followers",
         "following_url" : "https://api.github.com/users/RandomLattice/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RandomLattice/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RandomLattice",
         "id" : 128569685,
         "login" : "RandomLattice",
         "node_id" : "U_kgDOB6nRVQ",
         "organizations_url" : "https://api.github.com/users/RandomLattice/orgs",
         "received_events_url" : "https://api.github.com/users/RandomLattice/received_events",
         "repos_url" : "https://api.github.com/users/RandomLattice/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RandomLattice/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RandomLattice/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RandomLattice"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa https://github.com/bitcoin-core/secp256k1/pull/1276 has been merged, can you update this PR to include the current secp256k1 master? ",
      "created_at" : "2023-04-14T12:19:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27445#issuecomment-1508419009",
      "id" : 1508419009,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27445",
      "node_id" : "IC_kwDOABII585Z6KXB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508419009/reactions"
      },
      "updated_at" : "2023-04-14T12:19:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1508419009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1071625?v=4",
         "events_url" : "https://api.github.com/users/real-or-random/events{/privacy}",
         "followers_url" : "https://api.github.com/users/real-or-random/followers",
         "following_url" : "https://api.github.com/users/real-or-random/following{/other_user}",
         "gists_url" : "https://api.github.com/users/real-or-random/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/real-or-random",
         "id" : 1071625,
         "login" : "real-or-random",
         "node_id" : "MDQ6VXNlcjEwNzE2MjU=",
         "organizations_url" : "https://api.github.com/users/real-or-random/orgs",
         "received_events_url" : "https://api.github.com/users/real-or-random/received_events",
         "repos_url" : "https://api.github.com/users/real-or-random/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/real-or-random/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/real-or-random/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/real-or-random"
      }
   }
]
