[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This would needs tests written. Also consistent failures on [CI](https://cirrus-ci.com/task/5790448116563968?logs=ci#L2751) and [linter](https://cirrus-ci.com/task/6159884023496704?logs=lint#L889)",
      "created_at" : "2021-04-15T05:29:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21687#issuecomment-820125027",
      "id" : 820125027,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21687",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgyMDEyNTAyNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-15T05:29:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820125027",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23396902?v=4",
         "events_url" : "https://api.github.com/users/jarolrod/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jarolrod/followers",
         "following_url" : "https://api.github.com/users/jarolrod/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jarolrod/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jarolrod",
         "id" : 23396902,
         "login" : "jarolrod",
         "node_id" : "MDQ6VXNlcjIzMzk2OTAy",
         "organizations_url" : "https://api.github.com/users/jarolrod/orgs",
         "received_events_url" : "https://api.github.com/users/jarolrod/received_events",
         "repos_url" : "https://api.github.com/users/jarolrod/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jarolrod/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jarolrod/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jarolrod"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r613948313"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/613948313"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is untrue. All inbound connections have the same relay time assigned. See https://github.com/bitcoin/bitcoin/blob/c6b30ccb2eee5f80f844f79766591f0a1326ce43/src/net.cpp#L3014\r\n\r\nHaving multiple connections should be no different than a single one.",
      "commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "created_at" : "2021-04-15T10:22:48Z",
      "diff_hunk" : "@@ -1136,6 +1152,31 @@ void CConnman::CreateNodeFromAcceptedSocket(SOCKET hSocket,\n         }\n     }\n \n+\t// Currently, users can open multiple connections to a reachable node using the same IP address and a \n+\t// different port and request blockchain data at each connection. This behavior has the following impacts:\n+\t//   (1) Overwhelm the reachable node and consume its bandwidth by requesting data and discarding it\n+\t//     (see video demonstrations here: https://www.dropbox.com/s/pvasua7lnepdgfq/Occupy_Connections.mp4?dl=0\n+\t//     and https://www.dropbox.com/s/45ld1h7cxi3xzj6/RequestingBlockchain.mp4?dl=0)\n+\t//   (2) Undermine the transaction relaying anonymity since multiple connections to each node increase the\n+\t//     probability of mapping a transaction to an IP address (currently, the random delay factor in the\n+\t//     trickling effect implicitly assumes the attacker has one connection to each node). By establishing\n+\t//     multiple connections, the attacker undermines the anonymity property. ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r613948313",
      "id" : 613948313,
      "line" : 1163,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMzk0ODMxMw==",
      "original_commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "original_line" : 1163,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 44,
      "pull_request_review_id" : 636523122,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-15T10:30:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/613948313",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r613950030"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/613950030"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I didn't visit the website and I won't open this mp4, but a single inbound connection should be able to ask for the same data that multiple connections ask for.",
      "commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "created_at" : "2021-04-15T10:25:26Z",
      "diff_hunk" : "@@ -1136,6 +1152,31 @@ void CConnman::CreateNodeFromAcceptedSocket(SOCKET hSocket,\n         }\n     }\n \n+\t// Currently, users can open multiple connections to a reachable node using the same IP address and a \n+\t// different port and request blockchain data at each connection. This behavior has the following impacts:\n+\t//   (1) Overwhelm the reachable node and consume its bandwidth by requesting data and discarding it\n+\t//     (see video demonstrations here: https://www.dropbox.com/s/pvasua7lnepdgfq/Occupy_Connections.mp4?dl=0\n+\t//     and https://www.dropbox.com/s/45ld1h7cxi3xzj6/RequestingBlockchain.mp4?dl=0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r613950030",
      "id" : 613950030,
      "line" : 1159,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMzk1MDAzMA==",
      "original_commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "original_line" : 1159,
      "original_position" : 40,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 40,
      "pull_request_review_id" : 636523122,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-15T10:30:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/613950030",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r614356780"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614356780"
         }
      },
      "author_association" : "NONE",
      "body" : "Feasibly occupying multiple incoming connections using the same IP address will undermine the transaction anonymity property provisioned by the \"diffusion\" process. In the current deployment, a node announces a transaction to each connection after a certain delay. The assumption is that the adversary will not be able to infer the source of the transaction as it might receive the INV from another connection rather than the source (ref diffusion and exponential delay). \r\n\r\nIf an adversary occupies multiple incoming connections, the adversary can easily infer the source of the transaction, despite that delay (higher probability of receiving INV from the source rather than any other connection of that source). Allowing multiple incoming connections from the same IP address makes it a lot easier. ",
      "commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "created_at" : "2021-04-15T20:03:33Z",
      "diff_hunk" : "@@ -1136,6 +1152,31 @@ void CConnman::CreateNodeFromAcceptedSocket(SOCKET hSocket,\n         }\n     }\n \n+\t// Currently, users can open multiple connections to a reachable node using the same IP address and a \n+\t// different port and request blockchain data at each connection. This behavior has the following impacts:\n+\t//   (1) Overwhelm the reachable node and consume its bandwidth by requesting data and discarding it\n+\t//     (see video demonstrations here: https://www.dropbox.com/s/pvasua7lnepdgfq/Occupy_Connections.mp4?dl=0\n+\t//     and https://www.dropbox.com/s/45ld1h7cxi3xzj6/RequestingBlockchain.mp4?dl=0)\n+\t//   (2) Undermine the transaction relaying anonymity since multiple connections to each node increase the\n+\t//     probability of mapping a transaction to an IP address (currently, the random delay factor in the\n+\t//     trickling effect implicitly assumes the attacker has one connection to each node). By establishing\n+\t//     multiple connections, the attacker undermines the anonymity property. ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r614356780",
      "id" : 614356780,
      "in_reply_to_id" : 613948313,
      "line" : 1163,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNDM1Njc4MA==",
      "original_commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "original_line" : 1163,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 44,
      "pull_request_review_id" : 637082004,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-15T20:03:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614356780",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6090740?v=4",
         "events_url" : "https://api.github.com/users/beingmsaad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/beingmsaad/followers",
         "following_url" : "https://api.github.com/users/beingmsaad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/beingmsaad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/beingmsaad",
         "id" : 6090740,
         "login" : "beingmsaad",
         "node_id" : "MDQ6VXNlcjYwOTA3NDA=",
         "organizations_url" : "https://api.github.com/users/beingmsaad/orgs",
         "received_events_url" : "https://api.github.com/users/beingmsaad/received_events",
         "repos_url" : "https://api.github.com/users/beingmsaad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/beingmsaad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/beingmsaad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/beingmsaad"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r614358042"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614358042"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That's not correct. All incoming connections share the same Poisson timer for diffusion, so an attacker that creates multiple incoming connections should not be able to observe (significantly) more than with a single connection.",
      "commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "created_at" : "2021-04-15T20:05:50Z",
      "diff_hunk" : "@@ -1136,6 +1152,31 @@ void CConnman::CreateNodeFromAcceptedSocket(SOCKET hSocket,\n         }\n     }\n \n+\t// Currently, users can open multiple connections to a reachable node using the same IP address and a \n+\t// different port and request blockchain data at each connection. This behavior has the following impacts:\n+\t//   (1) Overwhelm the reachable node and consume its bandwidth by requesting data and discarding it\n+\t//     (see video demonstrations here: https://www.dropbox.com/s/pvasua7lnepdgfq/Occupy_Connections.mp4?dl=0\n+\t//     and https://www.dropbox.com/s/45ld1h7cxi3xzj6/RequestingBlockchain.mp4?dl=0)\n+\t//   (2) Undermine the transaction relaying anonymity since multiple connections to each node increase the\n+\t//     probability of mapping a transaction to an IP address (currently, the random delay factor in the\n+\t//     trickling effect implicitly assumes the attacker has one connection to each node). By establishing\n+\t//     multiple connections, the attacker undermines the anonymity property. ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r614358042",
      "id" : 614358042,
      "in_reply_to_id" : 613948313,
      "line" : 1163,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNDM1ODA0Mg==",
      "original_commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "original_line" : 1163,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 44,
      "pull_request_review_id" : 637083767,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-15T20:05:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614358042",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r614363637"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614363637"
         }
      },
      "author_association" : "NONE",
      "body" : "You are right. Any inbound connection should be able to request the same data that any other connection asks for. In that case, any effect on the bandwidth is perfectly fine. However, having multiple inbound connections from the same IP address makes it a lot easier for the adversary to overwhelm the bandwidth of the victim node. And this can be done easily through simple scripts without actually running a blockchain node. I have observed 33 incoming connections to my reachable node from the same IP address which raised a flag for me. \r\nAgain, the problem circle backs to allowing multiple incoming connections from the same IP address which needs to be addressed. ",
      "commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "created_at" : "2021-04-15T20:15:59Z",
      "diff_hunk" : "@@ -1136,6 +1152,31 @@ void CConnman::CreateNodeFromAcceptedSocket(SOCKET hSocket,\n         }\n     }\n \n+\t// Currently, users can open multiple connections to a reachable node using the same IP address and a \n+\t// different port and request blockchain data at each connection. This behavior has the following impacts:\n+\t//   (1) Overwhelm the reachable node and consume its bandwidth by requesting data and discarding it\n+\t//     (see video demonstrations here: https://www.dropbox.com/s/pvasua7lnepdgfq/Occupy_Connections.mp4?dl=0\n+\t//     and https://www.dropbox.com/s/45ld1h7cxi3xzj6/RequestingBlockchain.mp4?dl=0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r614363637",
      "id" : 614363637,
      "in_reply_to_id" : 613950030,
      "line" : 1159,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNDM2MzYzNw==",
      "original_commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "original_line" : 1159,
      "original_position" : 40,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 40,
      "pull_request_review_id" : 637091290,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-15T20:15:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614363637",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6090740?v=4",
         "events_url" : "https://api.github.com/users/beingmsaad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/beingmsaad/followers",
         "following_url" : "https://api.github.com/users/beingmsaad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/beingmsaad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/beingmsaad",
         "id" : 6090740,
         "login" : "beingmsaad",
         "node_id" : "MDQ6VXNlcjYwOTA3NDA=",
         "organizations_url" : "https://api.github.com/users/beingmsaad/orgs",
         "received_events_url" : "https://api.github.com/users/beingmsaad/received_events",
         "repos_url" : "https://api.github.com/users/beingmsaad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/beingmsaad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/beingmsaad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/beingmsaad"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r614390824"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614390824"
         }
      },
      "author_association" : "NONE",
      "body" : "Thanks Pieter. A test case would be to (1) set up a reachable node (say A), (2) find its outgoing connections (getpeerinfo), (3) establish one connection to each of A's outgoing connections, (4) establish multiple connections to A (say 30), and (5) generate a transaction from A and see how much can be inferred. I can do this experiment on my nodes and get back to you with the results. \r\n\r\nYou have pointed out that that attacker will not be able to observe (significantly) more than with a single connection. Does significantly mean a probability in k where k is the total number of incoming connections? ",
      "commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "created_at" : "2021-04-15T21:05:01Z",
      "diff_hunk" : "@@ -1136,6 +1152,31 @@ void CConnman::CreateNodeFromAcceptedSocket(SOCKET hSocket,\n         }\n     }\n \n+\t// Currently, users can open multiple connections to a reachable node using the same IP address and a \n+\t// different port and request blockchain data at each connection. This behavior has the following impacts:\n+\t//   (1) Overwhelm the reachable node and consume its bandwidth by requesting data and discarding it\n+\t//     (see video demonstrations here: https://www.dropbox.com/s/pvasua7lnepdgfq/Occupy_Connections.mp4?dl=0\n+\t//     and https://www.dropbox.com/s/45ld1h7cxi3xzj6/RequestingBlockchain.mp4?dl=0)\n+\t//   (2) Undermine the transaction relaying anonymity since multiple connections to each node increase the\n+\t//     probability of mapping a transaction to an IP address (currently, the random delay factor in the\n+\t//     trickling effect implicitly assumes the attacker has one connection to each node). By establishing\n+\t//     multiple connections, the attacker undermines the anonymity property. ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r614390824",
      "id" : 614390824,
      "in_reply_to_id" : 613948313,
      "line" : 1163,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNDM5MDgyNA==",
      "original_commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "original_line" : 1163,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 44,
      "pull_request_review_id" : 637127893,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-15T21:05:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614390824",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6090740?v=4",
         "events_url" : "https://api.github.com/users/beingmsaad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/beingmsaad/followers",
         "following_url" : "https://api.github.com/users/beingmsaad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/beingmsaad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/beingmsaad",
         "id" : 6090740,
         "login" : "beingmsaad",
         "node_id" : "MDQ6VXNlcjYwOTA3NDA=",
         "organizations_url" : "https://api.github.com/users/beingmsaad/orgs",
         "received_events_url" : "https://api.github.com/users/beingmsaad/received_events",
         "repos_url" : "https://api.github.com/users/beingmsaad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/beingmsaad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/beingmsaad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/beingmsaad"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r614393006"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614393006"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@beingmsaad That would be interesting to get data on!\r\n\r\nThe only gain you should get from having multiple incoming connections vs. just a single one is avoiding more internal latency/processing delay in the message processing loop. I.e., if CPU speed was infinite, there should be no gain at all. \r\n\r\nI mention \"significantly\" because it's not necessarily true in reality that it's literally no data, but at best I expect that you'd quickly converge towards a small constant factor better accuracy than a single one (maybe a few percent; perhaps a bit more on nodes that are relatively loaded). Of course, if this intuition is wrong I'd very much like to know.",
      "commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "created_at" : "2021-04-15T21:09:05Z",
      "diff_hunk" : "@@ -1136,6 +1152,31 @@ void CConnman::CreateNodeFromAcceptedSocket(SOCKET hSocket,\n         }\n     }\n \n+\t// Currently, users can open multiple connections to a reachable node using the same IP address and a \n+\t// different port and request blockchain data at each connection. This behavior has the following impacts:\n+\t//   (1) Overwhelm the reachable node and consume its bandwidth by requesting data and discarding it\n+\t//     (see video demonstrations here: https://www.dropbox.com/s/pvasua7lnepdgfq/Occupy_Connections.mp4?dl=0\n+\t//     and https://www.dropbox.com/s/45ld1h7cxi3xzj6/RequestingBlockchain.mp4?dl=0)\n+\t//   (2) Undermine the transaction relaying anonymity since multiple connections to each node increase the\n+\t//     probability of mapping a transaction to an IP address (currently, the random delay factor in the\n+\t//     trickling effect implicitly assumes the attacker has one connection to each node). By establishing\n+\t//     multiple connections, the attacker undermines the anonymity property. ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r614393006",
      "id" : 614393006,
      "in_reply_to_id" : 613948313,
      "line" : 1163,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNDM5MzAwNg==",
      "original_commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "original_line" : 1163,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 44,
      "pull_request_review_id" : 637130690,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-15T21:17:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614393006",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r614397316"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614397316"
         }
      },
      "author_association" : "NONE",
      "body" : "@sipa I will get some data on it and share it with you (possibly over the weekend). Will generate a few transactions in the testnet and see how much can be inferred by making 2-30 incoming connections. ",
      "commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "created_at" : "2021-04-15T21:17:25Z",
      "diff_hunk" : "@@ -1136,6 +1152,31 @@ void CConnman::CreateNodeFromAcceptedSocket(SOCKET hSocket,\n         }\n     }\n \n+\t// Currently, users can open multiple connections to a reachable node using the same IP address and a \n+\t// different port and request blockchain data at each connection. This behavior has the following impacts:\n+\t//   (1) Overwhelm the reachable node and consume its bandwidth by requesting data and discarding it\n+\t//     (see video demonstrations here: https://www.dropbox.com/s/pvasua7lnepdgfq/Occupy_Connections.mp4?dl=0\n+\t//     and https://www.dropbox.com/s/45ld1h7cxi3xzj6/RequestingBlockchain.mp4?dl=0)\n+\t//   (2) Undermine the transaction relaying anonymity since multiple connections to each node increase the\n+\t//     probability of mapping a transaction to an IP address (currently, the random delay factor in the\n+\t//     trickling effect implicitly assumes the attacker has one connection to each node). By establishing\n+\t//     multiple connections, the attacker undermines the anonymity property. ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21687#discussion_r614397316",
      "id" : 614397316,
      "in_reply_to_id" : 613948313,
      "line" : 1163,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNDM5NzMxNg==",
      "original_commit_id" : "26af082294183d9c8d0c2a52374e5c0bc18f8610",
      "original_line" : 1163,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 44,
      "pull_request_review_id" : 637136984,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21687",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-15T21:17:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/614397316",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6090740?v=4",
         "events_url" : "https://api.github.com/users/beingmsaad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/beingmsaad/followers",
         "following_url" : "https://api.github.com/users/beingmsaad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/beingmsaad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/beingmsaad",
         "id" : 6090740,
         "login" : "beingmsaad",
         "node_id" : "MDQ6VXNlcjYwOTA3NDA=",
         "organizations_url" : "https://api.github.com/users/beingmsaad/orgs",
         "received_events_url" : "https://api.github.com/users/beingmsaad/received_events",
         "repos_url" : "https://api.github.com/users/beingmsaad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/beingmsaad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/beingmsaad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/beingmsaad"
      }
   }
]
