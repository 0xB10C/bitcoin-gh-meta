[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10043#discussion_r107100889"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10043"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107100889"
         }
      },
      "body" : "Not sure if this is correct and if we should abort if this the assumption is not true.",
      "commit_id" : "85745423b356830e81e121ffb09563bcdfca55a1",
      "created_at" : "2017-03-21T08:54:12Z",
      "diff_hunk" : "@@ -135,6 +135,7 @@ bool CKey::SetPrivKey(const CPrivKey &privkey, bool fCompressedIn) {\n     if (!ec_privkey_import_der(secp256k1_context_sign, (unsigned char*)begin(), &privkey[0], privkey.size()))\n         return false;\n     fCompressed = fCompressedIn;\n+    assert(privkey[1] == (fCompressed ? 0x81 : 0x82));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10043#discussion_r107100889",
      "id" : 107100889,
      "original_commit_id" : "85745423b356830e81e121ffb09563bcdfca55a1",
      "original_position" : 4,
      "path" : "src/key.cpp",
      "position" : 4,
      "pull_request_review_id" : 28051252,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10043",
      "updated_at" : "2017-03-21T08:54:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107100889",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "I am quite surprised we even export private key in DER, I never had a need for it. Why is it used ?",
      "created_at" : "2017-03-21T09:22:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10043#issuecomment-288020544",
      "id" : 288020544,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10043",
      "updated_at" : "2017-03-21T09:22:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/288020544",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "AFAIK the only place where we use DER private keys is when storing/retrieving from the wallet.dat BDB database. We should probably change that, but reading DER must be supported at least.",
      "created_at" : "2017-03-21T09:33:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10043#issuecomment-288023263",
      "id" : 288023263,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10043",
      "updated_at" : "2017-03-21T09:33:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/288023263",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Thanks for the fix!\r\nHow does this affect users of the wallet or RPC? Does this need backports?",
      "created_at" : "2017-03-21T10:19:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10043#issuecomment-288034518",
      "id" : 288034518,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10043",
      "updated_at" : "2017-03-21T10:19:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/288034518",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "> How does this affect users of the wallet or RPC? Does this need backports?\r\n\r\nI'm not entirely sure. I haven't analysed the full ramification.\r\nIt looks like, that we only use the DER encoding during serialisation to and deserialisation from the database. Internally it should be treated correctly. Walletdump, etc. should be correct.\r\n\r\nAt the moment, I'm not sure what happens if you import an uncompressed WIF priv key. Or what happened when we introduced the bug with already existing uncompressed DER encoded keys in the wallet.",
      "created_at" : "2017-03-21T10:30:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10043#issuecomment-288037084",
      "id" : 288037084,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10043",
      "updated_at" : "2017-03-21T10:30:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/288037084",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10043#discussion_r107251439"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10043"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107251439"
         }
      },
      "body" : "Looks like we do not call this function at all anyway...",
      "commit_id" : "85745423b356830e81e121ffb09563bcdfca55a1",
      "created_at" : "2017-03-21T19:22:57Z",
      "diff_hunk" : "@@ -135,6 +135,7 @@ bool CKey::SetPrivKey(const CPrivKey &privkey, bool fCompressedIn) {\n     if (!ec_privkey_import_der(secp256k1_context_sign, (unsigned char*)begin(), &privkey[0], privkey.size()))\n         return false;\n     fCompressed = fCompressedIn;\n+    assert(privkey[1] == (fCompressed ? 0x81 : 0x82));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10043#discussion_r107251439",
      "id" : 107251439,
      "original_commit_id" : "85745423b356830e81e121ffb09563bcdfca55a1",
      "original_position" : 4,
      "path" : "src/key.cpp",
      "position" : 4,
      "pull_request_review_id" : 28212567,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10043",
      "updated_at" : "2017-03-21T19:22:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107251439",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   }
]
