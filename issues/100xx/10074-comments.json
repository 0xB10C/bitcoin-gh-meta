[
   {
      "body" : "NACK\r\n\r\nThis is an unnecessary addition to the codebase and consensus protocol. ",
      "created_at" : "2017-03-25T09:04:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10074#issuecomment-289199314",
      "id" : 289199314,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10074",
      "updated_at" : "2017-03-25T09:04:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/289199314",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/22999187?v=3",
         "events_url" : "https://api.github.com/users/buuser/events{/privacy}",
         "followers_url" : "https://api.github.com/users/buuser/followers",
         "following_url" : "https://api.github.com/users/buuser/following{/other_user}",
         "gists_url" : "https://api.github.com/users/buuser/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/buuser",
         "id" : 22999187,
         "login" : "buuser",
         "organizations_url" : "https://api.github.com/users/buuser/orgs",
         "received_events_url" : "https://api.github.com/users/buuser/received_events",
         "repos_url" : "https://api.github.com/users/buuser/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/buuser/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/buuser/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/buuser"
      }
   },
   {
      "body" : "@buuser: please add some technical arguments or observations. Simply saying no is not appropriate here.",
      "created_at" : "2017-03-25T11:15:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10074#issuecomment-289205550",
      "id" : 289205550,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10074",
      "updated_at" : "2017-03-25T11:15:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/289205550",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10074#discussion_r108872335"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10074"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/108872335"
         }
      },
      "body" : "probably need to test `(pIndex->nStatus & BLOCK_HAVE_DATA)` in case of pruned node.",
      "commit_id" : "8f625c4f5c9285696e13d014c7b5101caf25279e",
      "created_at" : "2017-03-30T08:50:27Z",
      "diff_hunk" : "@@ -2591,6 +2592,50 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n         }\n     }\n \n+\n+    else if (strCommand == NetMsgType::GETFRAUD)\n+    {\n+        CBlockLocator locator;\n+        vRecv >> locator;\n+        CBlockIndex *pindex = NULL;\n+        for (const uint256& hash : locator.vHave) {\n+            BlockMap::iterator mi = mapBlockIndex.find(hash);\n+            if (mi == mapBlockIndex.end()) {\n+                continue;\n+            }\n+            for (pindex = mi->second; pindex; pindex = pindex->pprev) {\n+                if (pindex->IsValid(BLOCK_VALID_SCRIPTS)) {\n+                    connman.PushMessage(pfrom, msgMaker.Make(NetMsgType::FRAUD, pindex->GetBlockHash(), VARINT(0)));\n+                    break;\n+                }\n+                if (pindex->nStatus & BLOCK_FAILED_VALID) {\n+                    if ((pindex->nStatus & BLOCK_VALID_MASK) >= BLOCK_VALID_TRANSACTIONS) {\n+                        // These are only reached when block size/weight are known to be good\n+                    } else {\n+                        CBlock block;\n+                        const bool ret = ReadBlockFromDisk(block, pindex, chainparams.GetConsensus());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10074#discussion_r108872335",
      "id" : 108872335,
      "original_commit_id" : "8f625c4f5c9285696e13d014c7b5101caf25279e",
      "original_position" : 33,
      "path" : "src/net_processing.cpp",
      "position" : 33,
      "pull_request_review_id" : 29933214,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10074",
      "updated_at" : "2017-03-30T08:50:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/108872335",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "I think BIP 180 is an interesting observation, but I don't think that it makes sense to merge an implementation of it into Bitcoin Core.\r\n\r\nFor BIP 180 support to be useful, Bitcoin Core would need to go out of its way to download and store invalid blocks to be able to generate proofs for light clients.  Currently, we make no effort to do this (in fact, from a very quick glance at the code in this PR, I don't see how this code can possibly work, because blocks whose invalidity is detected in `CheckBlock` or `ContextualCheckBlock` aren't even written to disk, and that's where the size checks are done).\r\n\r\nWhile we could attempt to \"fix\" that narrow issue, I also don't think it's worth pursuing as a goal: BIP 180 only makes sense in the context of a non-cooperative forking chain (as a cooperative one would e.g. provide signaling so that SPV clients could choose the headers chain they wish to follow), and if we assume non-cooperation, then BIP 180 wouldn't make sense if it's easy to subvert -- which it is.  For instance, suppose the first block in the forking chain had too many sigops but passed the blocksize/weight checks.  Bitcoin Core would not download any blocks that build off such an invalid block hash, because we'd know the chain to be invalid from the headers, and then wouldn't be able to provide any BIP 180 proofs to light clients.\r\n\r\nWe could try to rearchitect Bitcoin Core's consensus logic to try to make such fraud proofs available, by downloading later invalid blocks on a known-to-be-invalid chain and storing them, but this is a big change and IMO not worth doing.  I think we have a number of obstacles to overcome in order to make this work (see eg #9530, I think the improvements discussed there will already be review-intensive) and adding everything we need to ensure that BIP 180 would always work in Bitcoin Core seems like too much of a burden.\r\n\r\nAnyone who wanted to provide BIP 180-proofs to the network could do so as a separate service, and I think this is actually substantially easier to implement outside Bitcoin Core (since if you're providing these proofs as a separate service, you can solve the DoS issues more easily than we can do in Bitcoin Core, where the assumptions are different).\r\n\r\nConcept NACK.",
      "created_at" : "2017-03-30T16:05:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10074#issuecomment-290459075",
      "id" : 290459075,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10074",
      "updated_at" : "2017-03-30T16:05:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/290459075",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   }
]
