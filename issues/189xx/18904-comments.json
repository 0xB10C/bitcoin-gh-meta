[
   {
      "author_association" : "NONE",
      "body" : "lsn_reset on big wallet (actually wallet can became bigger) takes a minutes on GB file. It shuffles the priv key location but it does not make sense to be so frequently.",
      "created_at" : "2020-05-07T06:51:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18904#issuecomment-625065380",
      "id" : 625065380,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18904",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNTA2NTM4MA==",
      "updated_at" : "2020-05-07T10:35:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/625065380",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Shuffling private key location is not the point here.\r\nDoes it still concatenate the bdb logs after this, so that everything becomes one file? That's the point of the periodic flush. \r\n",
      "created_at" : "2020-05-07T17:35:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18904#issuecomment-625396536",
      "id" : 625396536,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18904",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNTM5NjUzNg==",
      "updated_at" : "2020-05-07T17:35:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/625396536",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> Does it still concatenate the bdb logs after this, so that everything becomes one file?\r\n\r\nhttps://docs.oracle.com/cd/E17276_01/html/api_reference/C/txncheckpoint.html\r\n\r\n> If there has been database environment activity since the last checkpoint, the DB_ENV->txn_checkpoint method flushes the underlying memory pool, writes a checkpoint record to the log, and then flushes the log.\r\n\r\nhttps://docs.oracle.com/cd/E17275_01/html/api_reference/C/envlsn_reset.html\r\n\r\n> The DB_ENV->lsn_reset() method allows database files to be moved from one transactional database environment to another.\r\n\r\nThere is no need to be called on every flush.",
      "created_at" : "2020-05-08T05:08:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18904#issuecomment-625633092",
      "id" : 625633092,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18904",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNTYzMzA5Mg==",
      "updated_at" : "2020-05-08T05:10:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/625633092",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I don't think this is safe without #18907. Otherwise there could be a condition where the log files are removed and the database opened again which could cause corruption. As I understand it, `lsn_reset` is required if we're going to do any log file removals.",
      "created_at" : "2020-05-08T06:16:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18904#issuecomment-625653503",
      "id" : 625653503,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18904",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNTY1MzUwMw==",
      "updated_at" : "2020-05-08T06:16:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/625653503",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@achow101 you should be more verbose on that, i don't see anything related. On periodic flush there is no db moving or changing, lsn_reset still present on backup and app close.",
      "created_at" : "2020-05-08T09:34:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18904#issuecomment-625731092",
      "id" : 625731092,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18904",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNTczMTA5Mg==",
      "updated_at" : "2020-05-08T09:39:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/625731092",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "During `BerkeleyEnvironment::Open`, if `dbenv->open` fails, it will move the transaction logs to a backup directory and retry `dbenv->open`. If the LSNs in the wallet file were not reset when this occurs, then there could be corruption issues due to mismatched LSNs. This situation could occur if Core has an unclean exit and if there is something that causes the environment to fail to open (e.g. a different BDB version).",
      "created_at" : "2020-05-08T16:20:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18904#issuecomment-625894756",
      "id" : 625894756,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18904",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNTg5NDc1Ng==",
      "updated_at" : "2020-05-08T16:20:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/625894756",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "When batch is using db is open without retry or i miss something\r\nhttps://github.com/bitcoin/bitcoin/blob/master/src/wallet/db.cpp#L533",
      "created_at" : "2020-05-09T08:44:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18904#issuecomment-626130576",
      "id" : 626130576,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18904",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNjEzMDU3Ng==",
      "updated_at" : "2020-05-09T08:44:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/626130576",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19292 (wallet: Refactor BerkeleyBatch Read, Write, Erase, and Exists functions into non-template functions by achow101)\n* #19290 (wallet: move BDB specific classes to bdb.{cpp/h} by achow101)\n* #19137 (wallettool: Add dump and createfromdump commands by achow101)\n* #19102 (wallet: Introduce and use DummyDatabase instead of dummy BerkeleyDatabase by achow101)\n* #19085 (Refactor: clean up PeriodicFlush() by jnewbery)\n* #19077 (wallet: Add sqlite as an alternative wallet database and use it for new descriptor wallets by achow101)\n* #18971 (wallet: Refactor the classes in wallet/db.{cpp/h} by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-05-14T03:50:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18904#issuecomment-628370122",
      "id" : 628370122,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18904",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyODM3MDEyMg==",
      "updated_at" : "2020-06-17T02:03:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628370122",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-06-17T10:01:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18904#issuecomment-645279320",
      "id" : 645279320,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18904",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NTI3OTMyMA==",
      "updated_at" : "2020-06-17T10:01:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/645279320",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
