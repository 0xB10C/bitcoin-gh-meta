[
   {
      "author_association" : "MEMBER",
      "body" : "So for every new heavy task that is added to the scheduler we have to add one more thread to not degrade the worst case performance? Imagine the wallet is flushed on scheduler thread 1 and the dns is queried on scheduler thread 2. Both block for minutes, so a third scheduler thread is needed. Sounds like this is missing the goal, and you might as well start a plain thread for each heavy task to begin with.\r\n\r\nI think what is needed is to have different queues. Maybe one for the validation interface (which validation might block on in the worst case), and other stuff like the wallet flushing or dns requests.",
      "created_at" : "2020-05-09T19:25:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18925#issuecomment-626224101",
      "id" : 626224101,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18925",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNjIyNDEwMQ==",
      "updated_at" : "2020-05-09T19:25:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/626224101",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #15502 (p2p: Speed up initial connection to p2p network by ajtowns)\n* #15421 (torcontrol: Launch a private Tor instance when not already running by luke-jr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-05-10T03:15:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18925#issuecomment-626266485",
      "id" : 626266485,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18925",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNjI2NjQ4NQ==",
      "updated_at" : "2020-05-10T03:15:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/626266485",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke right, this solution really doesn't help much in the long term, beyond #18421.\r\n\r\nIf we want something more long-term, we'd want a separate queue (with a dedicated thread). A trivial way to implement it is a second instance of a scheduler.\r\n\r\nBut we may want something smarter, like modifying the existing scheduler. Not sure how to achieve that right now, but I will take another look. Suggestions welcome :)\r\n\r\nNote that the suggested changes still apply: we definitely should be able to free a thread by moving those 2 things into scheduler.",
      "created_at" : "2020-05-12T14:07:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18925#issuecomment-627368465",
      "id" : 627368465,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18925",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNzM2ODQ2NQ==",
      "updated_at" : "2020-05-12T14:23:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/627368465",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   }
]
