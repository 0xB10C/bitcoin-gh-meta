[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Is it known to be true that every call to LogPrint has no expressions with\nside effects?\n\nOn Tue, Oct 22, 2019, 11:28 AM Jeffrey Czyz <notifications@github.com>\nwrote:\n\n> Calling LogPrint with a category that is not enabled results in\n> evaluating the remaining function arguments, which may be arbitrarily\n> complex (and possibly expensive) expressions. Defining LogPrint as a\n> macro prevents this unnecessary expression evaluation.\n>\n> This is a partial revert of #14209\n> <https://github.com/bitcoin/bitcoin/pull/14209>. The decision to revert\n> is discussed\n> in #16688 <https://github.com/bitcoin/bitcoin/pull/16688>, which adds\n> verbose logging for validation event notification.\n> ------------------------------\n> You can view, comment on, or merge this pull request online at:\n>\n>   https://github.com/bitcoin/bitcoin/pull/17218\n> Commit Summary\n>\n>    - Replace the LogPrint function with a macro\n>\n> File Changes\n>\n>    - *M* src/logging.h\n>    <https://github.com/bitcoin/bitcoin/pull/17218/files#diff-0> (12)\n>\n> Patch Links:\n>\n>    - https://github.com/bitcoin/bitcoin/pull/17218.patch\n>    - https://github.com/bitcoin/bitcoin/pull/17218.diff\n>\n> â\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/17218?email_source=notifications&email_token=AAGYN67LZZ4C7NCSPBAFEVDQP5A4VA5CNFSM4JDTSZXKYY3PNVWWK3TUL52HS4DFUVEXG43VMWVGG33NNVSW45C7NFSM4HTSVB2A>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAGYN67C6XATDCTWFXGPE6TQP5A4VANCNFSM4JDTSZXA>\n> .\n>\n",
      "created_at" : "2019-10-22T18:55:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17218#issuecomment-545104442",
      "id" : 545104442,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NTEwNDQ0Mg==",
      "updated_at" : "2019-10-22T18:55:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545104442",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17218#discussion_r337702226"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/337702226"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just a suggestion, but it might be good to leave existing LogPrint function alone, and instead just add a new `LOG_CATEGORY(category, format, ...)` macro. This would avoid issue the Jeremy raised about side effects in existing code, and also be nicer in my opinion because uppercase naming would be more consistent with other macros.",
      "commit_id" : "93e8f7a833a03a0add51612d1fcac557af51359c",
      "created_at" : "2019-10-22T19:16:14Z",
      "diff_hunk" : "@@ -155,12 +155,10 @@ static inline void LogPrintf(const char* fmt, const Args&... args)\n     }\n }\n \n-template <typename... Args>\n-static inline void LogPrint(const BCLog::LogFlags& category, const Args&... args)\n-{\n-    if (LogAcceptCategory((category))) {\n-        LogPrintf(args...);\n-    }\n-}\n+#define LogPrint(category, ...) do { \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17218#discussion_r337702226",
      "id" : 337702226,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzNzcwMjIyNg==",
      "original_commit_id" : "93e8f7a833a03a0add51612d1fcac557af51359c",
      "original_position" : 11,
      "path" : "src/logging.h",
      "position" : 11,
      "pull_request_review_id" : 305446649,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17218",
      "updated_at" : "2019-10-22T19:16:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/337702226",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17218#discussion_r337705213"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17218"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/337705213"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'd prefer to see a developer comment to explain why this is a macro (not a function like `LogPrintf` just a few lines up).\r\n\r\noptional: You may install `clang-format` and run the https://github.com/bitcoin/bitcoin/tree/master/contrib/devtools#clang-format-diffpy script to align the newline continuation chars `\\`.",
      "commit_id" : "93e8f7a833a03a0add51612d1fcac557af51359c",
      "created_at" : "2019-10-22T19:23:26Z",
      "diff_hunk" : "@@ -155,12 +155,10 @@ static inline void LogPrintf(const char* fmt, const Args&... args)\n     }\n }\n \n-template <typename... Args>\n-static inline void LogPrint(const BCLog::LogFlags& category, const Args&... args)\n-{\n-    if (LogAcceptCategory((category))) {\n-        LogPrintf(args...);\n-    }\n-}\n+#define LogPrint(category, ...) do { \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17218#discussion_r337705213",
      "id" : 337705213,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzNzcwNTIxMw==",
      "original_commit_id" : "93e8f7a833a03a0add51612d1fcac557af51359c",
      "original_position" : 11,
      "path" : "src/logging.h",
      "position" : 11,
      "pull_request_review_id" : 305450473,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17218",
      "updated_at" : "2019-10-22T19:23:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/337705213",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Is this a pure optimisation PR, or can we think of reasons beyond that?\r\n\r\nDo we have any examples of slow `LogPrint(â¦)` calls where this would make a significant difference?\r\n\r\nCan we benchmark this in any way?\r\n",
      "created_at" : "2019-10-22T20:08:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17218#issuecomment-545131818",
      "id" : 545131818,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17218",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0NTEzMTgxOA==",
      "updated_at" : "2019-10-22T20:08:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545131818",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   }
]
