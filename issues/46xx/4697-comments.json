[
   {
      "body" : "Not sure about this.\r\nFor wallets it's extremely important to keep compatibility, even with the oldest possible ones.\r\nBut if you say that multiple transactions having the same orderpos (or an orderpos<0) doesn't give problems then it may not be so important to keep `ReorderTransactions` around, especially if the current implementation makes it even more broken.\r\n",
      "created_at" : "2014-08-14T08:33:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-52156843",
      "id" : 52156843,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-08-14T08:33:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52156843",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "This worked when I wrote it. Maybe there's a bug introduced by the zap wallet stuff, but that shouldn't be \"fixed\" by breaking compatibility with old wallets.",
      "created_at" : "2014-08-14T08:44:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-52157705",
      "id" : 52157705,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-08-14T08:44:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52157705",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "I will do some more testing and report back.",
      "created_at" : "2014-08-14T08:48:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-52158086",
      "id" : 52158086,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-08-14T08:48:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52158086",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2814559?v=3",
         "events_url" : "https://api.github.com/users/cozz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cozz/followers",
         "following_url" : "https://api.github.com/users/cozz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cozz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cozz",
         "id" : 2814559,
         "login" : "cozz",
         "organizations_url" : "https://api.github.com/users/cozz/orgs",
         "received_events_url" : "https://api.github.com/users/cozz/received_events",
         "repos_url" : "https://api.github.com/users/cozz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cozz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cozz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cozz"
      }
   },
   {
      "body" : "In principle ReorderTransactions is a quite simple function. Not some Satoshi monster code that we have to get rid of asap. So my preference would go to fixing it as well.\r\n",
      "created_at" : "2014-08-14T08:50:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-52158315",
      "id" : 52158315,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-08-14T08:50:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52158315",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Updated the title from \"Remove\" to \"Improve\" now.\r\n\r\nI think we should write all changes to nOrderPos back to the database.\r\nCurrently txs and nOrderPosNext are not written back, only in-memory. This means that\r\nReorderTransactions(..) is run everytime you start the wallet and\r\nhave -1 ids. \r\n\r\nIf you only had AccEntrys with -1, this could result in a bug,\r\nbecause they are written back with higher ids, but nOrderPosNext is not written back.\r\nIf you restart now, you would start with the lower nOrderPosNext from before.\r\nThough this bug is not really a real world scenario, because someone would have\r\ntxs with -1 as well.\r\n\r\n@luke-jr Could you take a look at the code changes?",
      "created_at" : "2014-08-14T14:50:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-52193146",
      "id" : 52193146,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-08-14T14:50:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52193146",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2814559?v=3",
         "events_url" : "https://api.github.com/users/cozz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cozz/followers",
         "following_url" : "https://api.github.com/users/cozz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cozz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cozz",
         "id" : 2814559,
         "login" : "cozz",
         "organizations_url" : "https://api.github.com/users/cozz/orgs",
         "received_events_url" : "https://api.github.com/users/cozz/received_events",
         "repos_url" : "https://api.github.com/users/cozz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cozz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cozz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cozz"
      }
   },
   {
      "body" : "I think that looks safe, but it's been a while... Writing nOrderPosNext should be sufficient to fix it, no?",
      "created_at" : "2014-08-14T14:52:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-52193387",
      "id" : 52193387,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-08-14T14:52:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52193387",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Yes,\r\n\r\nbut if we dont write the txs back, they have nOrderPos=-1 again, next time you start the wallet.\r\nUnless you trigger a wtx.WriteToDisk() somehow else, through rescan for example.\r\n\r\nThis means that ReorderTransactions(..) is called everytime you load the wallet.\r\nBut it should be a one time thing.\r\n\r\nI am fine with closing this pull request too, if you prefer that, as this code is 2 years old now.",
      "created_at" : "2014-08-14T15:03:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-52194951",
      "id" : 52194951,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-08-14T15:03:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52194951",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2814559?v=3",
         "events_url" : "https://api.github.com/users/cozz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cozz/followers",
         "following_url" : "https://api.github.com/users/cozz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cozz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cozz",
         "id" : 2814559,
         "login" : "cozz",
         "organizations_url" : "https://api.github.com/users/cozz/orgs",
         "received_events_url" : "https://api.github.com/users/cozz/received_events",
         "repos_url" : "https://api.github.com/users/cozz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cozz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cozz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cozz"
      }
   },
   {
      "body" : "@cozz It's okay to redo it every time: the results should be the same. :)\r\n\r\nBut writing it back should be harmless too.",
      "created_at" : "2014-08-14T15:09:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-52195806",
      "id" : 52195806,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-08-14T15:09:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52195806",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Closing in that case, thanks for helping here anyway.",
      "created_at" : "2014-08-14T15:28:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-52198659",
      "id" : 52198659,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-08-14T15:28:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52198659",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2814559?v=3",
         "events_url" : "https://api.github.com/users/cozz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cozz/followers",
         "following_url" : "https://api.github.com/users/cozz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cozz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cozz",
         "id" : 2814559,
         "login" : "cozz",
         "organizations_url" : "https://api.github.com/users/cozz/orgs",
         "received_events_url" : "https://api.github.com/users/cozz/received_events",
         "repos_url" : "https://api.github.com/users/cozz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cozz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cozz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cozz"
      }
   },
   {
      "body" : "I don't think it makes sense to do it every time. Fixing an old wallet should be a one-time thing - after that it should behave like a new wallet.\r\n",
      "created_at" : "2014-08-14T15:30:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-52198959",
      "id" : 52198959,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-08-14T15:31:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52198959",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Reopening in that case.",
      "created_at" : "2014-08-14T15:38:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-52200101",
      "id" : 52200101,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-08-14T15:38:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52200101",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2814559?v=3",
         "events_url" : "https://api.github.com/users/cozz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cozz/followers",
         "following_url" : "https://api.github.com/users/cozz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cozz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cozz",
         "id" : 2814559,
         "login" : "cozz",
         "organizations_url" : "https://api.github.com/users/cozz/orgs",
         "received_events_url" : "https://api.github.com/users/cozz/received_events",
         "repos_url" : "https://api.github.com/users/cozz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cozz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cozz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cozz"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4697_da2ede2aa68ba14e1228b61e41a5840669560eee/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-08-18T17:48:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-52528474",
      "id" : 52528474,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-08-18T17:48:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52528474",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "ACK",
      "created_at" : "2014-09-08T09:05:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4697#issuecomment-54792591",
      "id" : 54792591,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4697",
      "updated_at" : "2014-09-08T09:05:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/54792591",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
