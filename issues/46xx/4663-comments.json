[
   {
      "body" : "Grr, build failures are due to pull-tester's ancient boost.\r\nSee https://svn.boost.org/trac/boost/ticket/2309\r\n\r\nChanged it to be disabled by default.",
      "created_at" : "2014-08-08T19:05:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-51644524",
      "id" : 51644524,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-08T19:05:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/51644524",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4663_938371c2805d3a3090faf416703e1cf942e77b29/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-08-08T19:17:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-51645811",
      "id" : 51645811,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-08T19:17:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/51645811",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "Why don't we do this by default?  Tagging exported functions is not a ton of work, and making it a default would avoid increasing the number of configurations which are not heavily tested.",
      "created_at" : "2014-08-10T00:49:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-51702740",
      "id" : 51702740,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-10T00:49:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/51702740",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "The default was set to false because ancient Boost (used by pulltester)\nfails with default visibility=hidden.",
      "created_at" : "2014-08-10T07:30:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-51708425",
      "id" : 51708425,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-10T07:30:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/51708425",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Right, the issue is that if an exception is thrown across a dso boundary, the receiver's symbol must be exported in order to catch it. In practice, due to the boost bug, that'd mean that we have to export all functions that may need to catch a boost exception. Imo that's not reasonable, especially since it's due to a faulty lib.\r\n\r\nThis wouldn't affect any of our final releases, though, as they're all built with a static boost.\r\n\r\nI would very much like to see this enabled by default as well, but it would mean refusing to build against boost < 1.49. I'd be much more comfortable with enforcing that restriction at some point in the future than trying to work around it by manually exporting many unrelated functions now.\r\n\r\nThe third option would be detecting the boost version and selectively enabling reduced exports, but I'm not sure I'd be comfortable with that either.",
      "created_at" : "2014-08-11T01:23:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-51734216",
      "id" : 51734216,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-11T01:23:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/51734216",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "s/export/specify default visibility/",
      "created_at" : "2014-08-11T01:25:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-51734287",
      "id" : 51734287,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-11T01:25:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/51734287",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Well we could make it a default and just use a flag to switch it off where it doesn't work. It could also autodetect that its going to fail (E.g. with an autotools compile and link test).  I am generally apposed to using autotools autodetection in ways that change user (/caller) visible functionality, but leaking private symbols is not 'functionality'. :)   The only harm I see with this is that we might merge something that doesn't build for people on more modern library setups, but we'd notice that quickly enough.",
      "created_at" : "2014-08-11T01:47:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-51735184",
      "id" : 51735184,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-11T01:47:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/51735184",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell It's ugly, but I could get on board with that. I'm not sure a link test would be enough though, I think we'd actually have to dump the resulting symbols and verify (as opposed to a try_run which would break on cross). If that's the case, it may end up being more reasonable to just use a version test.\r\n\r\nI'll give it a shot.",
      "created_at" : "2014-08-11T03:01:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-51738015",
      "id" : 51738015,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-11T03:01:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/51738015",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Using a doctored recent boost to test, I think I've come up with a link-test using a phony intermediary shared lib. I'll push it up tomorrow after playing some more.",
      "created_at" : "2014-08-11T03:19:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-51738665",
      "id" : 51738665,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-11T03:19:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/51738665",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "As discussed with @gmaxwell on IRC. Unfortunately, there's just no way to reliably test for broken boost visibility. Instead, I've added a check to disable reducing exports if boost is < 1.49. It's not pretty, but gets the job done.\r\n\r\nSo now reduce-exports is back to being enabled by default, and disabled if any of the criteria aren't met.\r\n\r\nAlso, added a check for default visibility attribute, so that we can properly advertise our api after #4692 is merged.",
      "created_at" : "2014-08-15T21:45:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-52361306",
      "id" : 52361306,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-15T21:45:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52361306",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Looks good to me.\r\n\r\nThough the reason that I used a linker script in the gitian build instead of these switches is that even with `-fvisibility=hidden` and `-Wl,--exclude-libs,ALL` some symbols exports 'leaked' out of the executable.\r\nSo without verification I'm not convinced that this can replace it.\r\n\r\nIt could be verified by running `contrib/devtools/symbol-check.py` on the gitian executables after removing the linker script and adding this. Then see whether you get `export of symbol %s not allowed` errors.\r\n\r\n(To be clear, I'm fine with merging this as well, even if it doesn't fix the problem mentioned in the gitian descriptor, its still a good change!)\r\n",
      "created_at" : "2014-08-16T08:50:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-52387855",
      "id" : 52387855,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-16T09:21:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52387855",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Yea, works as intended. Full output is:\r\n```\r\nbin/test_bitcoin: symbol clock_gettime from unsupported version GLIBC_2.17\r\nbin/bitcoin-qt: export of symbol _edata not allowed\r\nbin/bitcoin-qt: export of symbol _end not allowed\r\nbin/bitcoin-qt: export of symbol _init not allowed\r\nbin/bitcoin-qt: export of symbol __bss_start not allowed\r\nbin/bitcoin-qt: export of symbol _fini not allowed\r\nbin/bitcoin-tx: symbol clock_gettime from unsupported version GLIBC_2.17\r\nbin/test_bitcoin-qt: export of symbol _edata not allowed\r\nbin/test_bitcoin-qt: export of symbol _end not allowed\r\nbin/test_bitcoin-qt: export of symbol _init not allowed\r\nbin/test_bitcoin-qt: export of symbol __bss_start not allowed\r\nbin/test_bitcoin-qt: export of symbol _fini not allowed\r\nbin/bitcoin-cli: symbol clock_gettime from unsupported version GLIBC_2.17\r\nbin/bitcoind: symbol clock_gettime from unsupported version GLIBC_2.17\r\n```\r\nThe clock_gettime is an incompatibility we need to fix.\r\n\r\n_edata, _end, _init, __bss_start, and _fini are all absolute and added by the linker itself. We should update the checker to ignore those.",
      "created_at" : "2014-08-16T19:19:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-52403161",
      "id" : 52403161,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-16T19:19:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52403161",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "The clock_gettime actually comes in from my system since it's a newer glibc (that dump above is from my dev env using our depends, not from gitian). Gitian's glibc is 2.15, so that's actually not a problem until we move gitian to trusty.\r\n\r\nI haven't tested with gitian, but it will work exactly the same as above once we start using the new depends. I guess there's no reason to hold off on that now, so I'll PR those on Monday.",
      "created_at" : "2014-08-16T20:25:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-52404852",
      "id" : 52404852,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-16T20:25:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52404852",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@laanwj Ok, I gave it a go on gitian, and got (presumably) the same results as you. I dug around for a bit and it looks like preciseÃ¢ÂÂs default linker (bfd) has busted support for Ã¢ÂÂÃ¢ÂÂexclude-libs ALLÃ¢ÂÂ. Most distros these days have switched to gold anyway. I installed that and it worked as it shouldÃ¢ÂÂve.\r\n\r\nSo basically, all is good if you add Ã¢ÂÂbinutils-goldÃ¢ÂÂ to the packages list in the descriptor. IÃ¢ÂÂll add that into my PR on monday after verifying that it's still deterministic.\r\n\r\nScript output from gitian looks like this:\r\n```\r\n/home/ubuntu/out/bin/x86_64-unknown-linux-gnu/test_bitcoin-qt: export of symbol _edata not allowed\r\n/home/ubuntu/out/bin/x86_64-unknown-linux-gnu/test_bitcoin-qt: export of symbol _end not allowed\r\n/home/ubuntu/out/bin/x86_64-unknown-linux-gnu/test_bitcoin-qt: export of symbol _init not allowed\r\n/home/ubuntu/out/bin/x86_64-unknown-linux-gnu/test_bitcoin-qt: export of symbol __bss_start not allowed\r\n/home/ubuntu/out/bin/x86_64-unknown-linux-gnu/test_bitcoin-qt: export of symbol _fini not allowed\r\n/home/ubuntu/out/bin/x86_64-unknown-linux-gnu/bitcoin-cli: export of symbol std::basic_string<char, std::char_traits<char>, std::allocator<char> > std::operator+<char, std::char_traits<char>, std::allocator<char> >(char const*, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) not allowed\r\n/home/ubuntu/out/bin/x86_64-unknown-linux-gnu/bitcoin-cli: export of symbol std::basic_string<char, std::char_traits<char>, std::allocator<char> > std::operator+<char, std::char_traits<char>, std::allocator<char> >(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) not allowed\r\n/home/ubuntu/out/bin/x86_64-unknown-linux-gnu/bitcoin-qt: export of symbol _edata not allowed\r\n/home/ubuntu/out/bin/x86_64-unknown-linux-gnu/bitcoin-qt: export of symbol _end not allowed\r\n/home/ubuntu/out/bin/x86_64-unknown-linux-gnu/bitcoin-qt: export of symbol _init not allowed\r\n/home/ubuntu/out/bin/x86_64-unknown-linux-gnu/bitcoin-qt: export of symbol __bss_start not allowed\r\n/home/ubuntu/out/bin/x86_64-unknown-linux-gnu/bitcoin-qt: export of symbol _fini not allowed\r\n```\r\nLooks like thereÃ¢ÂÂs a single bug in that versionÃ¢ÂÂs libstdc++ that causes the strings to be visible, but thatÃ¢ÂÂs nothing to worry about (and it's obviously been fixed since, since it doesn't show up for me locally).\r\n\r\nSo as far as IÃ¢ÂÂm concerned, the visibility changes here are enough to get us what weÃ¢ÂÂre after, assuming the deps/tools arenÃ¢ÂÂt busted. Using the gold linker for precise seems to be all it takes to work around.",
      "created_at" : "2014-08-17T02:39:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-52411945",
      "id" : 52411945,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-17T02:39:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52411945",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@theuni Thanks for checking. Agreed - the base symbols such as _edata, _end, _init, __bss_start, and _fini could be ignored by the checker. There's no harm in exporting them, and requiring them to be filtered too is just undue maintenance work.\r\n",
      "created_at" : "2014-08-17T06:26:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-52414771",
      "id" : 52414771,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-17T06:26:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52414771",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Thanks. I'm prepared for a few reports of build problems after this (not sure what, but something's bound to come up). If so, I'll try to get 'em worked out asap.",
      "created_at" : "2014-08-17T16:26:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-52427026",
      "id" : 52427026,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-17T16:26:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52427026",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@theuni OOPS - seems the pulltester is failing now\r\nhttp://jenkins.bluematt.me/pull-tester/p4718_88fe88cf3640caede5222380383d0816a42a73b7/test.log\r\nAnd I notice that it's compiling with `-fvisibility=hidden`.\r\nMaybe the boost check isn't working :(\r\n",
      "created_at" : "2014-08-18T11:50:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4663#issuecomment-52481994",
      "id" : 52481994,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4663",
      "updated_at" : "2014-08-18T11:50:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/52481994",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
