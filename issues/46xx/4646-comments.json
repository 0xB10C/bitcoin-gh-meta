[
   {
      "body" : "Updated such that each message is a method.  It is recommended to review each commit rather than the sum of all commits, as this patch series follows the \"equivalent transformation\" method of refactoring code into a more useful form.\r\n\r\nThis should be suitable for updating to use signals or similar (possibly moving back outside of the class if necessary).\r\n",
      "created_at" : "2014-08-07T17:45:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#issuecomment-51506315",
      "id" : 51506315,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4646",
      "updated_at" : "2014-08-07T17:45:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/51506315",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4646_aa9ad2895e32dcaedba5e1511f5edead4664c029/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-08-07T17:58:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#issuecomment-51508028",
      "id" : 51508028,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4646",
      "updated_at" : "2014-08-07T17:58:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/51508028",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "Oh, yes, please!\r\nuntested and undiffed ACK. The diffed ack will come later. Maybe the last un-indent commit can be replaced with a \"Pass clang to the new files\". Now that we have a way to automatically format the code, it can be useful for after-diff-sensible commits like that one, should be faster to review just by reproducing it locally.",
      "created_at" : "2014-09-03T10:42:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#issuecomment-54279211",
      "id" : 54279211,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4646",
      "updated_at" : "2014-09-03T10:42:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/54279211",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Idea ACK, but this code is pretty much in flux still (askfor/headersfirst/sendmessages/...); I'd propose to delay this until close to the next major release.",
      "created_at" : "2014-09-03T13:00:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#issuecomment-54292468",
      "id" : 54292468,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4646",
      "updated_at" : "2014-09-03T13:00:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/54292468",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "After headersfirst has been merged, can we reopen this?",
      "created_at" : "2014-10-18T18:43:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#issuecomment-59625079",
      "id" : 59625079,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4646",
      "updated_at" : "2014-10-18T18:43:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/59625079",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "No objection against just moving things like this, but things like #4831 conflict probably with less, and actually go further, as it actually splits processing up completely, rather than just moving it as a whole.",
      "created_at" : "2014-10-19T08:13:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#issuecomment-59642865",
      "id" : 59642865,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4646",
      "updated_at" : "2014-10-19T08:13:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/59642865",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Things like ping/pong handling and alert handling can probably be split off in a way similar to #4831.",
      "created_at" : "2014-10-19T08:14:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#issuecomment-59642891",
      "id" : 59642891,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4646",
      "updated_at" : "2014-10-19T08:14:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/59642891",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059356"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059356"
         }
      },
      "body" : "Nit: Alphabetical ordering.",
      "commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "created_at" : "2014-10-19T10:42:30Z",
      "diff_hunk" : "@@ -17,6 +17,7 @@\n #include \"txmempool.h\"\n #include \"ui_interface.h\"\n #include \"util.h\"\n+#include \"procmsg.h\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059356",
      "id" : 19059356,
      "original_commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "original_position" : 4,
      "path" : "src/main.cpp",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646",
      "updated_at" : "2014-10-19T10:42:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059356",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059363"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059363"
         }
      },
      "body" : "Nit: Same here.",
      "commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "created_at" : "2014-10-19T10:43:12Z",
      "diff_hunk" : "@@ -23,6 +23,7 @@\n #include <exception>\n #include <map>\n #include <set>\n+#include <list>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059363",
      "id" : 19059363,
      "original_commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "original_position" : 4,
      "path" : "src/main.h",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646",
      "updated_at" : "2014-10-19T10:43:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059363",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059375"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059375"
         }
      },
      "body" : "Nit: And for this whole block. Also just MIT license.",
      "commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "created_at" : "2014-10-19T10:44:04Z",
      "diff_hunk" : "@@ -0,0 +1,1374 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <map>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059375",
      "id" : 19059375,
      "original_commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "original_position" : 6,
      "path" : "src/procmsg.cpp",
      "position" : 6,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646",
      "updated_at" : "2014-10-19T10:44:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059375",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059381"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059381"
         }
      },
      "body" : "Suggestion: remove the unneeded newlines here.",
      "commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "created_at" : "2014-10-19T10:44:34Z",
      "diff_hunk" : "@@ -0,0 +1,1374 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <map>\n+#include \"core.h\"\n+#include \"checkpoints.h\"\n+#include \"addrman.h\"\n+#include \"alert.h\"\n+#include \"main.h\"\n+#include \"procmsg.h\"\n+\n+using namespace std;\n+\n+class MessageEngine msgeng;\n+\n+map<uint256, set<uint256> > mapOrphanTransactionsByPrev;\n+\n+extern void UpdateBlockAvailability(NodeId nodeid, const uint256 &hash);\n+extern void ProcessBlockAvailability(NodeId nodeid);\n+extern void MarkBlockAsReceived(const uint256 &hash, NodeId nodeFrom = -1);\n+extern bool AddBlockToQueue(NodeId nodeid, const uint256 &hash);\n+extern void MarkBlockAsInFlight(NodeId nodeid, const uint256 &hash);\n+extern CNodeState *State(NodeId pnode);\n+extern map<uint256, NodeId> mapBlockSource;\n+extern uint256 GetOrphanRoot(const uint256& hash);\n+extern struct CMainSignals g_signals;\n+\n+//////////////////////////////////////////////////////////////////////////////\n+//\n+// mapOrphanTransactions\n+//\n+\n+bool AddOrphanTx(const CTransaction& tx)\n+{\n+    uint256 hash = tx.GetHash();\n+    if (mapOrphanTransactions.count(hash))\n+        return false;\n+\n+    // Ignore big transactions, to avoid a\n+    // send-big-orphans memory exhaustion attack. If a peer has a legitimate\n+    // large transaction with a missing parent then we assume\n+    // it will rebroadcast it later, after the parent transaction(s)\n+    // have been mined or received.\n+    // 10,000 orphans, each of which is at most 5,000 bytes big is\n+    // at most 500 megabytes of orphans:\n+    unsigned int sz = tx.GetSerializeSize(SER_NETWORK, CTransaction::CURRENT_VERSION);\n+    if (sz > 5000)\n+    {\n+        LogPrint(\"mempool\", \"ignoring large orphan tx (size: %u, hash: %s)\\n\", sz, hash.ToString());\n+        return false;\n+    }\n+\n+    mapOrphanTransactions[hash] = tx;\n+    BOOST_FOREACH(const CTxIn& txin, tx.vin)\n+        mapOrphanTransactionsByPrev[txin.prevout.hash].insert(hash);\n+\n+    LogPrint(\"mempool\", \"stored orphan tx %s (mapsz %u)\\n\", hash.ToString(),\n+        mapOrphanTransactions.size());\n+    return true;\n+}\n+\n+static void EraseOrphanTx(uint256 hash)\n+{\n+    if (!mapOrphanTransactions.count(hash))\n+        return;\n+    const CTransaction& tx = mapOrphanTransactions[hash];\n+    BOOST_FOREACH(const CTxIn& txin, tx.vin)\n+    {\n+        mapOrphanTransactionsByPrev[txin.prevout.hash].erase(hash);\n+        if (mapOrphanTransactionsByPrev[txin.prevout.hash].empty())\n+            mapOrphanTransactionsByPrev.erase(txin.prevout.hash);\n+    }\n+    mapOrphanTransactions.erase(hash);\n+}\n+\n+unsigned int LimitOrphanTxSize(unsigned int nMaxOrphans)\n+{\n+    unsigned int nEvicted = 0;\n+    while (mapOrphanTransactions.size() > nMaxOrphans)\n+    {\n+        // Evict a random orphan:\n+        uint256 randomhash = GetRandHash();\n+        map<uint256, CTransaction>::iterator it = mapOrphanTransactions.lower_bound(randomhash);\n+        if (it == mapOrphanTransactions.end())\n+            it = mapOrphanTransactions.begin();\n+        EraseOrphanTx(it->first);\n+        ++nEvicted;\n+    }\n+    return nEvicted;\n+}\n+\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059381",
      "id" : 19059381,
      "original_commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "original_position" : 94,
      "path" : "src/procmsg.cpp",
      "position" : 94,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646",
      "updated_at" : "2014-10-19T10:44:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059381",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059385"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059385"
         }
      },
      "body" : "Suggestion: Could be a one line-comment?",
      "commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "created_at" : "2014-10-19T10:45:00Z",
      "diff_hunk" : "@@ -0,0 +1,1374 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <map>\n+#include \"core.h\"\n+#include \"checkpoints.h\"\n+#include \"addrman.h\"\n+#include \"alert.h\"\n+#include \"main.h\"\n+#include \"procmsg.h\"\n+\n+using namespace std;\n+\n+class MessageEngine msgeng;\n+\n+map<uint256, set<uint256> > mapOrphanTransactionsByPrev;\n+\n+extern void UpdateBlockAvailability(NodeId nodeid, const uint256 &hash);\n+extern void ProcessBlockAvailability(NodeId nodeid);\n+extern void MarkBlockAsReceived(const uint256 &hash, NodeId nodeFrom = -1);\n+extern bool AddBlockToQueue(NodeId nodeid, const uint256 &hash);\n+extern void MarkBlockAsInFlight(NodeId nodeid, const uint256 &hash);\n+extern CNodeState *State(NodeId pnode);\n+extern map<uint256, NodeId> mapBlockSource;\n+extern uint256 GetOrphanRoot(const uint256& hash);\n+extern struct CMainSignals g_signals;\n+\n+//////////////////////////////////////////////////////////////////////////////\n+//\n+// mapOrphanTransactions\n+//\n+\n+bool AddOrphanTx(const CTransaction& tx)\n+{\n+    uint256 hash = tx.GetHash();\n+    if (mapOrphanTransactions.count(hash))\n+        return false;\n+\n+    // Ignore big transactions, to avoid a\n+    // send-big-orphans memory exhaustion attack. If a peer has a legitimate\n+    // large transaction with a missing parent then we assume\n+    // it will rebroadcast it later, after the parent transaction(s)\n+    // have been mined or received.\n+    // 10,000 orphans, each of which is at most 5,000 bytes big is\n+    // at most 500 megabytes of orphans:\n+    unsigned int sz = tx.GetSerializeSize(SER_NETWORK, CTransaction::CURRENT_VERSION);\n+    if (sz > 5000)\n+    {\n+        LogPrint(\"mempool\", \"ignoring large orphan tx (size: %u, hash: %s)\\n\", sz, hash.ToString());\n+        return false;\n+    }\n+\n+    mapOrphanTransactions[hash] = tx;\n+    BOOST_FOREACH(const CTxIn& txin, tx.vin)\n+        mapOrphanTransactionsByPrev[txin.prevout.hash].insert(hash);\n+\n+    LogPrint(\"mempool\", \"stored orphan tx %s (mapsz %u)\\n\", hash.ToString(),\n+        mapOrphanTransactions.size());\n+    return true;\n+}\n+\n+static void EraseOrphanTx(uint256 hash)\n+{\n+    if (!mapOrphanTransactions.count(hash))\n+        return;\n+    const CTransaction& tx = mapOrphanTransactions[hash];\n+    BOOST_FOREACH(const CTxIn& txin, tx.vin)\n+    {\n+        mapOrphanTransactionsByPrev[txin.prevout.hash].erase(hash);\n+        if (mapOrphanTransactionsByPrev[txin.prevout.hash].empty())\n+            mapOrphanTransactionsByPrev.erase(txin.prevout.hash);\n+    }\n+    mapOrphanTransactions.erase(hash);\n+}\n+\n+unsigned int LimitOrphanTxSize(unsigned int nMaxOrphans)\n+{\n+    unsigned int nEvicted = 0;\n+    while (mapOrphanTransactions.size() > nMaxOrphans)\n+    {\n+        // Evict a random orphan:\n+        uint256 randomhash = GetRandHash();\n+        map<uint256, CTransaction>::iterator it = mapOrphanTransactions.lower_bound(randomhash);\n+        if (it == mapOrphanTransactions.end())\n+            it = mapOrphanTransactions.begin();\n+        EraseOrphanTx(it->first);\n+        ++nEvicted;\n+    }\n+    return nEvicted;\n+}\n+\n+\n+\n+\n+\n+\n+bool static AlreadyHave(const CInv& inv)\n+{\n+    switch (inv.type)\n+    {\n+    case MSG_TX:\n+        {\n+            bool txInMap = false;\n+            txInMap = mempool.exists(inv.hash);\n+            return txInMap || mapOrphanTransactions.count(inv.hash) ||\n+                pcoinsTip->HaveCoins(inv.hash);\n+        }\n+    case MSG_BLOCK:\n+        return mapBlockIndex.count(inv.hash) ||\n+               mapOrphanBlocks.count(inv.hash);\n+    }\n+    // Don't know what it is, just say we already got one\n+    return true;\n+}\n+\n+\n+void static ProcessGetData(CNode* pfrom)\n+{\n+    std::deque<CInv>::iterator it = pfrom->vRecvGetData.begin();\n+\n+    vector<CInv> vNotFound;\n+\n+    LOCK(cs_main);\n+\n+    while (it != pfrom->vRecvGetData.end()) {\n+        // Don't bother if send buffer is too full to respond anyway\n+        if (pfrom->nSendSize >= SendBufferSize())\n+            break;\n+\n+        const CInv &inv = *it;\n+        {\n+            boost::this_thread::interruption_point();\n+            it++;\n+\n+            if (inv.type == MSG_BLOCK || inv.type == MSG_FILTERED_BLOCK)\n+            {\n+                bool send = false;\n+                map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(inv.hash);\n+                if (mi != mapBlockIndex.end())\n+                {\n+                    // If the requested block is at a height below our last\n+                    // checkpoint, only serve it if it's in the checkpointed chain\n+                    int nHeight = mi->second->nHeight;\n+                    CBlockIndex* pcheckpoint = Checkpoints::GetLastCheckpoint(mapBlockIndex);\n+                    if (pcheckpoint && nHeight < pcheckpoint->nHeight) {\n+                        if (!chainActive.Contains(mi->second))\n+                        {\n+                            LogPrintf(\"ProcessGetData(): ignoring request for old block that isn't in the main chain\\n\");\n+                        } else {\n+                            send = true;\n+                        }\n+                    } else {\n+                        send = true;\n+                    }\n+                }\n+                if (send)\n+                {\n+                    // Send block from disk\n+                    CBlock block;\n+                    if (!ReadBlockFromDisk(block, (*mi).second))\n+                        assert(!\"cannot load block from disk\");\n+                    if (inv.type == MSG_BLOCK)\n+                        pfrom->PushMessage(\"block\", block);\n+                    else // MSG_FILTERED_BLOCK)\n+                    {\n+                        LOCK(pfrom->cs_filter);\n+                        if (pfrom->pfilter)\n+                        {\n+                            CMerkleBlock merkleBlock(block, *pfrom->pfilter);\n+                            pfrom->PushMessage(\"merkleblock\", merkleBlock);\n+                            // CMerkleBlock just contains hashes, so also push any transactions in the block the client did not see\n+                            // This avoids hurting performance by pointlessly requiring a round-trip\n+                            // Note that there is currently no way for a node to request any single transactions we didnt send here -\n+                            // they must either disconnect and retry or request the full block.\n+                            // Thus, the protocol spec specified allows for us to provide duplicate txn here,\n+                            // however we MUST always provide at least what the remote peer needs\n+                            typedef std::pair<unsigned int, uint256> PairType;\n+                            BOOST_FOREACH(PairType& pair, merkleBlock.vMatchedTxn)\n+                                if (!pfrom->setInventoryKnown.count(CInv(MSG_TX, pair.second)))\n+                                    pfrom->PushMessage(\"tx\", block.vtx[pair.first]);\n+                        }\n+                        // else",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059385",
      "id" : 19059385,
      "original_commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "original_position" : 184,
      "path" : "src/procmsg.cpp",
      "position" : 184,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646",
      "updated_at" : "2014-10-19T10:45:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059385",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059390"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059390"
         }
      },
      "body" : "Nit: Unneeded newline.",
      "commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "created_at" : "2014-10-19T10:45:34Z",
      "diff_hunk" : "@@ -0,0 +1,1374 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <map>\n+#include \"core.h\"\n+#include \"checkpoints.h\"\n+#include \"addrman.h\"\n+#include \"alert.h\"\n+#include \"main.h\"\n+#include \"procmsg.h\"\n+\n+using namespace std;\n+\n+class MessageEngine msgeng;\n+\n+map<uint256, set<uint256> > mapOrphanTransactionsByPrev;\n+\n+extern void UpdateBlockAvailability(NodeId nodeid, const uint256 &hash);\n+extern void ProcessBlockAvailability(NodeId nodeid);\n+extern void MarkBlockAsReceived(const uint256 &hash, NodeId nodeFrom = -1);\n+extern bool AddBlockToQueue(NodeId nodeid, const uint256 &hash);\n+extern void MarkBlockAsInFlight(NodeId nodeid, const uint256 &hash);\n+extern CNodeState *State(NodeId pnode);\n+extern map<uint256, NodeId> mapBlockSource;\n+extern uint256 GetOrphanRoot(const uint256& hash);\n+extern struct CMainSignals g_signals;\n+\n+//////////////////////////////////////////////////////////////////////////////\n+//\n+// mapOrphanTransactions\n+//\n+\n+bool AddOrphanTx(const CTransaction& tx)\n+{\n+    uint256 hash = tx.GetHash();\n+    if (mapOrphanTransactions.count(hash))\n+        return false;\n+\n+    // Ignore big transactions, to avoid a\n+    // send-big-orphans memory exhaustion attack. If a peer has a legitimate\n+    // large transaction with a missing parent then we assume\n+    // it will rebroadcast it later, after the parent transaction(s)\n+    // have been mined or received.\n+    // 10,000 orphans, each of which is at most 5,000 bytes big is\n+    // at most 500 megabytes of orphans:\n+    unsigned int sz = tx.GetSerializeSize(SER_NETWORK, CTransaction::CURRENT_VERSION);\n+    if (sz > 5000)\n+    {\n+        LogPrint(\"mempool\", \"ignoring large orphan tx (size: %u, hash: %s)\\n\", sz, hash.ToString());\n+        return false;\n+    }\n+\n+    mapOrphanTransactions[hash] = tx;\n+    BOOST_FOREACH(const CTxIn& txin, tx.vin)\n+        mapOrphanTransactionsByPrev[txin.prevout.hash].insert(hash);\n+\n+    LogPrint(\"mempool\", \"stored orphan tx %s (mapsz %u)\\n\", hash.ToString(),\n+        mapOrphanTransactions.size());\n+    return true;\n+}\n+\n+static void EraseOrphanTx(uint256 hash)\n+{\n+    if (!mapOrphanTransactions.count(hash))\n+        return;\n+    const CTransaction& tx = mapOrphanTransactions[hash];\n+    BOOST_FOREACH(const CTxIn& txin, tx.vin)\n+    {\n+        mapOrphanTransactionsByPrev[txin.prevout.hash].erase(hash);\n+        if (mapOrphanTransactionsByPrev[txin.prevout.hash].empty())\n+            mapOrphanTransactionsByPrev.erase(txin.prevout.hash);\n+    }\n+    mapOrphanTransactions.erase(hash);\n+}\n+\n+unsigned int LimitOrphanTxSize(unsigned int nMaxOrphans)\n+{\n+    unsigned int nEvicted = 0;\n+    while (mapOrphanTransactions.size() > nMaxOrphans)\n+    {\n+        // Evict a random orphan:\n+        uint256 randomhash = GetRandHash();\n+        map<uint256, CTransaction>::iterator it = mapOrphanTransactions.lower_bound(randomhash);\n+        if (it == mapOrphanTransactions.end())\n+            it = mapOrphanTransactions.begin();\n+        EraseOrphanTx(it->first);\n+        ++nEvicted;\n+    }\n+    return nEvicted;\n+}\n+\n+\n+\n+\n+\n+\n+bool static AlreadyHave(const CInv& inv)\n+{\n+    switch (inv.type)\n+    {\n+    case MSG_TX:\n+        {\n+            bool txInMap = false;\n+            txInMap = mempool.exists(inv.hash);\n+            return txInMap || mapOrphanTransactions.count(inv.hash) ||\n+                pcoinsTip->HaveCoins(inv.hash);\n+        }\n+    case MSG_BLOCK:\n+        return mapBlockIndex.count(inv.hash) ||\n+               mapOrphanBlocks.count(inv.hash);\n+    }\n+    // Don't know what it is, just say we already got one\n+    return true;\n+}\n+\n+\n+void static ProcessGetData(CNode* pfrom)\n+{\n+    std::deque<CInv>::iterator it = pfrom->vRecvGetData.begin();\n+\n+    vector<CInv> vNotFound;\n+\n+    LOCK(cs_main);\n+\n+    while (it != pfrom->vRecvGetData.end()) {\n+        // Don't bother if send buffer is too full to respond anyway\n+        if (pfrom->nSendSize >= SendBufferSize())\n+            break;\n+\n+        const CInv &inv = *it;\n+        {\n+            boost::this_thread::interruption_point();\n+            it++;\n+\n+            if (inv.type == MSG_BLOCK || inv.type == MSG_FILTERED_BLOCK)\n+            {\n+                bool send = false;\n+                map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(inv.hash);\n+                if (mi != mapBlockIndex.end())\n+                {\n+                    // If the requested block is at a height below our last\n+                    // checkpoint, only serve it if it's in the checkpointed chain\n+                    int nHeight = mi->second->nHeight;\n+                    CBlockIndex* pcheckpoint = Checkpoints::GetLastCheckpoint(mapBlockIndex);\n+                    if (pcheckpoint && nHeight < pcheckpoint->nHeight) {\n+                        if (!chainActive.Contains(mi->second))\n+                        {\n+                            LogPrintf(\"ProcessGetData(): ignoring request for old block that isn't in the main chain\\n\");\n+                        } else {\n+                            send = true;\n+                        }\n+                    } else {\n+                        send = true;\n+                    }\n+                }\n+                if (send)\n+                {\n+                    // Send block from disk\n+                    CBlock block;\n+                    if (!ReadBlockFromDisk(block, (*mi).second))\n+                        assert(!\"cannot load block from disk\");\n+                    if (inv.type == MSG_BLOCK)\n+                        pfrom->PushMessage(\"block\", block);\n+                    else // MSG_FILTERED_BLOCK)\n+                    {\n+                        LOCK(pfrom->cs_filter);\n+                        if (pfrom->pfilter)\n+                        {\n+                            CMerkleBlock merkleBlock(block, *pfrom->pfilter);\n+                            pfrom->PushMessage(\"merkleblock\", merkleBlock);\n+                            // CMerkleBlock just contains hashes, so also push any transactions in the block the client did not see\n+                            // This avoids hurting performance by pointlessly requiring a round-trip\n+                            // Note that there is currently no way for a node to request any single transactions we didnt send here -\n+                            // they must either disconnect and retry or request the full block.\n+                            // Thus, the protocol spec specified allows for us to provide duplicate txn here,\n+                            // however we MUST always provide at least what the remote peer needs\n+                            typedef std::pair<unsigned int, uint256> PairType;\n+                            BOOST_FOREACH(PairType& pair, merkleBlock.vMatchedTxn)\n+                                if (!pfrom->setInventoryKnown.count(CInv(MSG_TX, pair.second)))\n+                                    pfrom->PushMessage(\"tx\", block.vtx[pair.first]);\n+                        }\n+                        // else\n+                            // no response\n+                    }\n+\n+                    // Trigger them to send a getblocks request for the next batch of inventory\n+                    if (inv.hash == pfrom->hashContinue)\n+                    {\n+                        // Bypass PushInventory, this must send even if redundant,\n+                        // and we want it right after the last block so they don't\n+                        // wait for other stuff first.\n+                        vector<CInv> vInv;\n+                        vInv.push_back(CInv(MSG_BLOCK, chainActive.Tip()->GetBlockHash()));\n+                        pfrom->PushMessage(\"inv\", vInv);\n+                        pfrom->hashContinue = 0;\n+                    }\n+                }\n+            }\n+            else if (inv.IsKnownType())\n+            {\n+                // Send stream from relay memory\n+                bool pushed = false;\n+                {\n+                    LOCK(cs_mapRelay);\n+                    map<CInv, CDataStream>::iterator mi = mapRelay.find(inv);\n+                    if (mi != mapRelay.end()) {\n+                        pfrom->PushMessage(inv.GetCommand(), (*mi).second);\n+                        pushed = true;\n+                    }\n+                }\n+                if (!pushed && inv.type == MSG_TX) {\n+                    CTransaction tx;\n+                    if (mempool.lookup(inv.hash, tx)) {\n+                        CDataStream ss(SER_NETWORK, PROTOCOL_VERSION);\n+                        ss.reserve(1000);\n+                        ss << tx;\n+                        pfrom->PushMessage(\"tx\", ss);\n+                        pushed = true;\n+                    }\n+                }\n+                if (!pushed) {\n+                    vNotFound.push_back(inv);\n+                }\n+            }\n+\n+            // Track requests for our stuff.\n+            g_signals.Inventory(inv.hash);\n+\n+            if (inv.type == MSG_BLOCK || inv.type == MSG_FILTERED_BLOCK)\n+                break;\n+        }\n+    }\n+\n+    pfrom->vRecvGetData.erase(pfrom->vRecvGetData.begin(), it);\n+\n+    if (!vNotFound.empty()) {\n+        // Let the peer know that we didn't find what it asked for, so it doesn't\n+        // have to wait around forever. Currently only SPV clients actually care\n+        // about this message: it's needed when they are recursively walking the\n+        // dependencies of relevant unconfirmed transactions. SPV clients want to\n+        // do that because they want to know about (and store and rebroadcast and\n+        // risk analyze) the dependencies of transactions relevant to them, without\n+        // having to download the entire memory pool.\n+        pfrom->PushMessage(\"notfound\", vNotFound);\n+    }\n+}\n+\n+bool MessageEngine::ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv, int64_t nTimeReceived)\n+{\n+    RandAddSeedPerfmon();\n+    LogPrint(\"net\", \"received: %s (%u bytes) peer=%d\\n\", strCommand, vRecv.size(), pfrom->id);\n+    if (mapArgs.count(\"-dropmessagestest\") && GetRand(atoi(mapArgs[\"-dropmessagestest\"])) == 0)\n+    {\n+        LogPrintf(\"dropmessagestest DROPPING RECV MESSAGE\\n\");\n+        return true;\n+    }\n+\n+    {\n+        LOCK(cs_main);\n+        State(pfrom->GetId())->nLastBlockProcess = GetTimeMicros();\n+    }\n+\n+    if (strCommand == \"version\") {\n+        if (!MsgVersion(pfrom, vRecv, nTimeReceived))\n+            return false;\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059390",
      "id" : 19059390,
      "original_commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "original_position" : 268,
      "path" : "src/procmsg.cpp",
      "position" : 268,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646",
      "updated_at" : "2014-10-19T10:45:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059390",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059396"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059396"
         }
      },
      "body" : "Misses license header!",
      "commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "created_at" : "2014-10-19T10:46:12Z",
      "diff_hunk" : "@@ -0,0 +1,41 @@\n+#ifndef __BITCOIN_PROCMSG_H__",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059396",
      "id" : 19059396,
      "original_commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "original_position" : 1,
      "path" : "src/procmsg.h",
      "position" : 1,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646",
      "updated_at" : "2014-10-19T10:46:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059396",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059399"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059399"
         }
      },
      "body" : "Nit: Ordering.",
      "commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "created_at" : "2014-10-19T10:46:22Z",
      "diff_hunk" : "@@ -0,0 +1,41 @@\n+#ifndef __BITCOIN_PROCMSG_H__\n+#define __BITCOIN_PROCMSG_H__\n+\n+#include <string>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#discussion_r19059399",
      "id" : 19059399,
      "original_commit_id" : "aa9ad2895e32dcaedba5e1511f5edead4664c029",
      "original_position" : 4,
      "path" : "src/procmsg.h",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4646",
      "updated_at" : "2014-10-19T10:46:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/19059399",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Suggestion: Why not let the clang-script fix coding style for this?",
      "created_at" : "2014-10-19T10:47:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#issuecomment-59645959",
      "id" : 59645959,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4646",
      "updated_at" : "2014-10-19T10:47:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/59645959",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "I really like how https://github.com/jgarzik/bitcoin/commit/78edf5cb8cf65caf38080ac57040469cc9c6957f (Split up P2P message processing into MessageEngine methods) improves the readability of the p2p messages.",
      "created_at" : "2014-10-23T06:00:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#issuecomment-60196006",
      "id" : 60196006,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4646",
      "updated_at" : "2014-10-23T06:00:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60196006",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "I felt that this was a good step towards the direction we want to go longer term, which is registering processing methods (signals/hooks), so that the message processing implementation is more de-coupled from network message dispatch.\r\n\r\nIt sounded like @sipa did not like this as an intermediate step, though.\r\n",
      "created_at" : "2014-10-23T13:34:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#issuecomment-60238911",
      "id" : 60238911,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4646",
      "updated_at" : "2014-10-23T13:34:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60238911",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "I would absolutely be in favor of this as intermediate step if not for the review overhead and the fact that it will break existing pull requests that already go further.\r\n\r\nAfterwards I think we can definitely do this for the non-trivial pieces after the trivial ones have been moved out.",
      "created_at" : "2014-10-23T15:37:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4646#issuecomment-60258533",
      "id" : 60258533,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4646",
      "updated_at" : "2014-10-23T15:37:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/60258533",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
