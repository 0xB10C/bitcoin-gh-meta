[
   {
      "author_association" : "NONE",
      "body" : "Hi, the command did take a while to return. Perhaps about 30 seconds. This is what I got,\r\n\r\n{\r\n  \"height\": 750848,\r\n  \"bestblock\": \"000000000000000000042bfa933012137be4426a545056c51d75f8358306f099\",\r\n  \"txouts\": 83853482,\r\n  \"bogosize\": 6255092170,\r\n  \"hash_serialized_2\": \"e8915ee90c5152753b10ab7e1b48d33f21d999a89668a3f5b948478b153ccff6\",\r\n  \"total_amount\": 19130092.17246361,\r\n  \"transactions\": 49927698,\r\n  \"disk_size\": 5119722459\r\n}\r\n\r\nWhat version are you running? \r\nI'm on Bitcoin Core RPC client version v23.99.0-b1a2021f7809-dirty",
      "created_at" : "2022-08-24T03:31:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25912#issuecomment-1225138581",
      "id" : 1225138581,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25912",
      "node_id" : "IC_kwDOABII585JBiGV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225138581/reactions"
      },
      "updated_at" : "2022-08-24T03:32:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225138581",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/111384550?v=4",
         "events_url" : "https://api.github.com/users/ZaidanK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ZaidanK/followers",
         "following_url" : "https://api.github.com/users/ZaidanK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ZaidanK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ZaidanK",
         "id" : 111384550,
         "login" : "ZaidanK",
         "node_id" : "U_kgDOBqOX5g",
         "organizations_url" : "https://api.github.com/users/ZaidanK/orgs",
         "received_events_url" : "https://api.github.com/users/ZaidanK/received_events",
         "repos_url" : "https://api.github.com/users/ZaidanK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ZaidanK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ZaidanK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ZaidanK"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I'm using the same version as you. It was compiled from the current develomment branch in this Git repository.\r\nCompiled with debug (-g) and with -DDEBUG_LOCKCONTENTION (as instructed by other developers because I submitted several other issues) here.\r\n\r\nThe node is fully synchronized, running as a full node.\r\n\r\nRunning on standard Debian Bullseye, in a VM with 8 CPU cores (Intel Core i9), 32GB RAM, and a dedicated physical storage volume for Bitcoin data, over a fast and reliable RAID5 array (on 6 physical disks), with 1TB allocated only for this volume (there's a separate volume for the rest of the system or /home, all Bitcion data goes into its own mounted partition, optimized for perfomance with 64KB clusters).\r\n\r\nI can reproduce it on my local PC, or when using a VM hosted Azure or AWS. So I know that it is not a hardware issue. I have the same issue when running on a cheaper personal notebook (with a SSD), where Debian is installed with a basic desktop environment.\r\n\r\nIt has both connectivity over IPv4 and IPv6 (but I don't use Tor) and accepts incoming connections from peers on the Internet.\r\n\r\n[That VM only runs the kernel (init), and a single user logged in running two bash sessions, one for running bitcoin dameon (via `gdb --args bitcoind -printtoconsole`), the other one for looking at what is happening (with \"htop\" to see active processes and threads, or to run 'bitcoin-cli' commands. [I use the \"-printtoconsole\" option just to have a direct view of logs, without having to use some \"tail -f debug.log\" in another console; but the main reason is that there are some other outputs on stderr which are not written in \"debug.log\", coming from some dependant libraries, noably from MiniUPNPC which is used in its own thread, so I can see these messages synchronized with other logs. I've not disabled UPNP with the \"pnp=0\" option; it has no effect on my network, as UPNP is not enabled on the router which is just configured with a single port forwarding for accepting incoming connections on TCP port 8333 with IPv4 or IPv6; I've disabled Tor, so \"listenonion=0\" is set in bitcoin.conf, as well there's no option to enable I2P; the RPC service is configured to allow onlyconnections using cookie authentication, and it only accepts local connections, with the \"whitelist=127.0.0.1/32\" option, and only from the same local Linux user, where this \"rpc.cookie\" file is accessible and not readable by any other Linux user (except \"root\") than the one used to run bitcoind or gdb.]\r\n\r\nI run bitcoind through gdb, only to be able to pause it an inspect what is happening and get stack traces if needed). But the same occurs when letting it run outside gdb (then I can use the released version 23.0, or a compiled version 23.99 without debug (-g). Note that I cannot \"attach\" gdb to an already running bitcoind, sur to security restrictions (\"ptrace\" is not permitted across sessions with different controling terminals or different parent processes, this is enforced by the kernel with its standard security settings, so gdb must be attached as the parent process and must run bitcoind itself; I will never run any Internet-connected program accepting incoming connections over any Linux where such restrictions on ptrace are not enforced by the kernel, at least with the \"yama\" security model or with the \"SELinux\" model; a strenghened kernel is mandatory for running any VM in AWS and Azure when not running any Linux VM on costly dedicated hardware, but on shared hosts where you cannot run custom kernels, but only supported kernels: I use the standard (securely signed) Debian Bullseye kernel proposed and supported by these cloud-hosting providers.\r\n\r\nI also know now (see other bug reports) that one \"bitcoin.conf\" option (checkblockindex=1) has an issue and is not thread-safe, so I've disabled it (that bug was signaled by another user in 2019). That option is disabled by default in the release, but while searching for other bugs, I had activated it, but this causes the RPC service to hang as well.\r\n\r\nI know that `bitcoin-cli gettxoutsetinfo` can take a while, but according to what is logged, the deamon just takes about 40 ms to complete the flush, but then hangs but then enters in a tight loop that never ends after more than 1 hour, and never replies to the bitcoin-cli client.\r\n",
      "created_at" : "2022-08-24T04:26:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25912#issuecomment-1225174876",
      "id" : 1225174876,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25912",
      "node_id" : "IC_kwDOABII585JBq9c",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225174876/reactions"
      },
      "updated_at" : "2022-08-24T05:23:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225174876",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1387035?v=4",
         "events_url" : "https://api.github.com/users/verdy-p/events{/privacy}",
         "followers_url" : "https://api.github.com/users/verdy-p/followers",
         "following_url" : "https://api.github.com/users/verdy-p/following{/other_user}",
         "gists_url" : "https://api.github.com/users/verdy-p/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/verdy-p",
         "id" : 1387035,
         "login" : "verdy-p",
         "node_id" : "MDQ6VXNlcjEzODcwMzU=",
         "organizations_url" : "https://api.github.com/users/verdy-p/orgs",
         "received_events_url" : "https://api.github.com/users/verdy-p/received_events",
         "repos_url" : "https://api.github.com/users/verdy-p/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/verdy-p/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/verdy-p/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/verdy-p"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Can you attach gdb when this deadlock happens and let us know where exactly the http thread is stuck?",
      "created_at" : "2022-08-24T05:44:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25912#issuecomment-1225224100",
      "id" : 1225224100,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25912",
      "node_id" : "IC_kwDOABII585JB2-k",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225224100/reactions"
      },
      "updated_at" : "2022-08-24T05:44:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225224100",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
