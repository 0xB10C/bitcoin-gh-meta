[
   {
      "author_association" : "MEMBER",
      "body" : "Can you explain why this is a \"bugfix\", considering that the API break was done on purpose at that time?",
      "created_at" : "2022-08-25T06:58:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25923#issuecomment-1226855039",
      "id" : 1226855039,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25923",
      "node_id" : "IC_kwDOABII585JIFJ_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1226855039/reactions"
      },
      "updated_at" : "2022-08-25T06:58:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1226855039",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK\r\n\r\n@MarcoFalke, a bug is a bug, even if it was done on purpose. @jnewbery can clarify here, but I do not think this was even purposeful. My guess is that this breakage was unwanted, but acceptable in order to get the refactor from #21160 done. It later required fixup attempts like https://github.com/bitcoin/bitcoin/pull/24691 and https://github.com/bitcoin/bitcoin/pull/25176.\r\n\r\nSo, what happened? The `relaytxes` and `minfeefilter` fields were always present, and documented as such, in the output of the `getpeerinfo` RPC. #21160 changed it so that they could sometimes be missing. I guess the issues (both for GUI and RPC) were neglected during the review with a comment like [will almost always be true, so this isn't a big issue](https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567395). Well, it turned out our own tool `bitcoin-cli` broke due to the missing but expected fields. Some user apps will break too (if we don't fix it in 24.0).\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/24691 documented the fields as optional, but that is not appropriate because in the previous version they were not-optional. When users wrote their apps they assumed the fields will always be present. I think the \"optional\" flag should only be added when a field is initially introduced. Adding it later is the same as dropping the field - it breaks the \"contract\" with the user that the field will be present.\r\n\r\nOn this PR: I think it is ok to display the values `relaytxes=false` and `minfeefilter=0` in those corner cases. This is what the code did before #21160. If this is stripped to the bare minimum needed for the fix, I think it will have higher chance of making it to 24.0",
      "created_at" : "2022-08-25T13:06:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25923#issuecomment-1227233657",
      "id" : 1227233657,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25923",
      "node_id" : "IC_kwDOABII585JJhl5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1227233657/reactions"
      },
      "updated_at" : "2022-08-25T13:06:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1227233657",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> So, what happened? The relaytxes and minfeefilter fields were always present, and documented as such, in the output of the getpeerinfo RPC.\r\n\r\nThis isn't true. **None** of the fields in `getpeerinfo` were documented as always present until the 'optional' fields were explicitly documented in #22798. Prior to that PR, there was no explicit guarantee that any of the fields would be present.\r\n\r\nPR 22798 was opened _after_ #21160, then merged, and resulted in the silent conflict where the fields were not marked as optional. That could be caught by better testing of optional fields.\r\n\r\n> with a comment like \"will almost always be true, so this isn't a big issue\"\r\n\r\nStop misrepresenting other people's words. This was in response to a review comment about the GUI, not the RPC. You've also clipped the quote to misrepresent it further. Here's the full sentence: \"will almost always be true, so this isn't a big issue (if it was, then the other stats in nodeStateStats not being available would also be an issue).\" I stand by that - if it's a problem that one of the fields is not visible in the GUI for a very short window during peer connection, then it'd be a problem that the other fields like \"startingheight\" or \"minping\" are not present. It's clearly not a problem, since that's always been the case.\r\n\r\nAt the time of the comment, it was also totally consistent with the other fields that were optional but not marked as such, since #22798 had not yet been opened.\r\n\r\n> in the previous version they were not-optional. When users wrote their apps they assumed the fields will always be present. I think the \"optional\" flag should only be added when a field is initially introduced. Adding it later is the same as dropping the field - it breaks the \"contract\" with the user that the field will be present.\r\n\r\nAgain, this is false. The 'optional' documentation was added in #22798, which was only included in v0.23. Until then, there were many fields could be considered optional but not documented as such. Users writing apps that interacted with the field (including the bitcoin-cli netinfo app) should have made those apps tolerant to the fields not being present.\r\n\r\nAs can be seen in #22798, there were 10s of fields across many different RPCs that were 'optional' before being explicitly documented as such. Both the PR description and @vasild's comment make it sound like this was some nefarious intentional API break, or some egregious bug. It's neither.\r\n\r\nFrankly, it's utterly tedious to have to spend time rebutting false statements and misrepresentations made about PRs that were merged months ago. Unfortunately, this 'gotcha' attitude of trying to shame code authors seems to be becoming more common in this project. It's extremely harmful for productive collaboration, and is certainly not something I'd expect to see from someone putting themselves forward as a potential project maintainer.",
      "created_at" : "2022-08-25T14:49:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25923#issuecomment-1227366243",
      "id" : 1227366243,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25923",
      "node_id" : "IC_kwDOABII585JKB9j",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1227366243/reactions"
      },
      "updated_at" : "2022-08-25T14:49:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1227366243",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
