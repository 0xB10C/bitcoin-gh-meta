[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r132848026"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132848026"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "!pblockindex",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-08-13T17:39:50Z",
      "diff_hunk" : "@@ -212,10 +211,11 @@ static bool rest_block(HTTPRequest* req,\n     CBlockIndex* pblockindex = NULL;\n     {\n         LOCK(cs_main);\n-        if (mapBlockIndex.count(hash) == 0)\n+        pblockindex = LookupBlockIndex(hash);\n+        if (pblockindex) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r132848026",
      "id" : 132848026,
      "original_commit_id" : "171213cb323e85630087e42e60967b56724d229a",
      "original_position" : 16,
      "path" : "src/rest.cpp",
      "position" : null,
      "pull_request_review_id" : 55971450,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:19:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132848026",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r132848037"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132848037"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Same as above.",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-08-13T17:40:23Z",
      "diff_hunk" : "@@ -669,10 +669,10 @@ UniValue getblockheader(const JSONRPCRequest& request)\n     if (!request.params[1].isNull())\n         fVerbose = request.params[1].get_bool();\n \n-    if (mapBlockIndex.count(hash) == 0)\n+    CBlockIndex* pblockindex = LookupBlockIndex(hash);\n+    if (pblockindex == nullptr) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r132848037",
      "id" : 132848037,
      "original_commit_id" : "171213cb323e85630087e42e60967b56724d229a",
      "original_position" : 6,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 55971450,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:19:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132848037",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r132848061"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132848061"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Remove assert.",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-08-13T17:40:52Z",
      "diff_hunk" : "@@ -817,7 +816,9 @@ static bool GetUTXOStats(CCoinsView *view, CCoinsStats &stats)\n     stats.hashBlock = pcursor->GetBestBlock();\n     {\n         LOCK(cs_main);\n-        stats.nHeight = mapBlockIndex.find(stats.hashBlock)->second->nHeight;\n+        const CBlockIndex* pindex = LookupBlockIndex(stats.hashBlock);\n+        assert(pindex);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r132848061",
      "id" : 132848061,
      "original_commit_id" : "171213cb323e85630087e42e60967b56724d229a",
      "original_position" : 35,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 55971450,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:19:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132848061",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "Concept ACK",
      "created_at" : "2017-08-14T10:27:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-322155803",
      "id" : 322155803,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-08-14T10:27:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322155803",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "This may make #10692 a bit simpler, though I'm not sure it matters what order they come in.",
      "created_at" : "2017-08-14T14:45:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-322210067",
      "id" : 322210067,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-08-14T14:45:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322210067",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Fixed bug and rebased.",
      "created_at" : "2017-08-15T15:37:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-322503789",
      "id" : 322503789,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-08-15T15:37:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322503789",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "@laanwj I believe it's ready.",
      "created_at" : "2017-08-22T14:56:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-324052747",
      "id" : 324052747,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-08-22T14:56:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324052747",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "Concept ACK",
      "created_at" : "2017-08-22T15:49:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-324069155",
      "id" : 324069155,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-08-22T15:49:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324069155",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r134638513"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134638513"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe explicit cast to bool here for clarity",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-08-23T01:20:42Z",
      "diff_hunk" : "@@ -904,7 +906,7 @@ bool static AlreadyHave(const CInv& inv) EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n         }\n     case MSG_BLOCK:\n     case MSG_WITNESS_BLOCK:\n-        return mapBlockIndex.count(inv.hash);\n+        return LookupBlockIndex(inv.hash);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r134638513",
      "id" : 134638513,
      "original_commit_id" : "c5153911f5f3c97f26b7dab29e779889aa4cee3b",
      "original_position" : 38,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 57952795,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:19:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134638513",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r134649948"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134649948"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Prefer this?\r\n```cpp\r\nreturn LookupBlockIndex(inv.hash) != nullptr;\r\n```",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-08-23T03:26:10Z",
      "diff_hunk" : "@@ -904,7 +906,7 @@ bool static AlreadyHave(const CInv& inv) EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n         }\n     case MSG_BLOCK:\n     case MSG_WITNESS_BLOCK:\n-        return mapBlockIndex.count(inv.hash);\n+        return LookupBlockIndex(inv.hash);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r134649948",
      "id" : 134649948,
      "in_reply_to_id" : 134638513,
      "original_commit_id" : "c5153911f5f3c97f26b7dab29e779889aa4cee3b",
      "original_position" : 38,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 57965458,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:19:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134649948",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r134655245"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134655245"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah or a ternary or even an if statement would be a lot clearer",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-08-23T04:33:37Z",
      "diff_hunk" : "@@ -904,7 +906,7 @@ bool static AlreadyHave(const CInv& inv) EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n         }\n     case MSG_BLOCK:\n     case MSG_WITNESS_BLOCK:\n-        return mapBlockIndex.count(inv.hash);\n+        return LookupBlockIndex(inv.hash);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r134655245",
      "id" : 134655245,
      "in_reply_to_id" : 134638513,
      "original_commit_id" : "c5153911f5f3c97f26b7dab29e779889aa4cee3b",
      "original_position" : 38,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 57971275,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:19:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134655245",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   },
   {
      "body" : "Rebased and fixed @MeshCollider comment.",
      "created_at" : "2017-08-25T14:38:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-324939734",
      "id" : 324939734,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-08-25T14:38:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324939734",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r147724360"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/147724360"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Missing assert lock is held.",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-10-30T14:45:15Z",
      "diff_hunk" : "@@ -425,6 +425,12 @@ class CVerifyDB {\n /** Replay blocks that aren't fully applied to the database. */\n bool ReplayBlocks(const CChainParams& params, CCoinsView* view);\n \n+inline CBlockIndex* LookupBlockIndex(const uint256& hash)\n+{\n+    BlockMap::const_iterator it = mapBlockIndex.find(hash);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r147724360",
      "id" : 147724360,
      "original_commit_id" : "1d1768f2978bafaf166bfa218c899ddaeeccad2d",
      "original_position" : 6,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 72860048,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:19:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/147724360",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r147808975"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/147808975"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Missing `EXCLUSIVE_LOCKS_REQUIRED(cs_main)` too :-)",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-10-30T19:25:44Z",
      "diff_hunk" : "@@ -425,6 +425,12 @@ class CVerifyDB {\n /** Replay blocks that aren't fully applied to the database. */\n bool ReplayBlocks(const CChainParams& params, CCoinsView* view);\n \n+inline CBlockIndex* LookupBlockIndex(const uint256& hash)\n+{\n+    BlockMap::const_iterator it = mapBlockIndex.find(hash);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r147808975",
      "id" : 147808975,
      "in_reply_to_id" : 147724360,
      "original_commit_id" : "1d1768f2978bafaf166bfa218c899ddaeeccad2d",
      "original_position" : 6,
      "path" : "src/validation.h",
      "position" : null,
      "pull_request_review_id" : 72957447,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:19:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/147808975",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r148586107"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/148586107"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In some of these places you could do \r\n\r\n```c++\r\nif (const CBlockIndex* pindex = LookupBlockIndex(wtx.hashBlock))\r\n```\r\n\r\nto reduce the scope of the pindex variables.",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-11-02T16:25:59Z",
      "diff_hunk" : "@@ -3793,7 +3791,8 @@ unsigned int CWallet::ComputeTimeSmart(const CWalletTx& wtx) const\n {\n     unsigned int nTimeSmart = wtx.nTimeReceived;\n     if (!wtx.hashUnset()) {\n-        if (mapBlockIndex.count(wtx.hashBlock)) {\n+        const CBlockIndex* pindex = LookupBlockIndex(wtx.hashBlock);\n+        if (pindex) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r148586107",
      "id" : 148586107,
      "original_commit_id" : "1d1768f2978bafaf166bfa218c899ddaeeccad2d",
      "original_position" : 44,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 73852544,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:19:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/148586107",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks @ryanofsky, I have to rebase and then I'll take into account your comment above.",
      "created_at" : "2017-11-02T16:39:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-341482401",
      "id" : 341482401,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-11-02T16:39:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/341482401",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r155389796"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/155389796"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Need to keep the `!mapBlockIndex.empty()`.",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-06T23:13:36Z",
      "diff_hunk" : "@@ -1434,8 +1434,9 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n \n                 // If the loaded chain has a wrong genesis, bail out immediately\n                 // (we're likely using a testnet datadir, or the other way around).\n-                if (!mapBlockIndex.empty() && mapBlockIndex.count(chainparams.GetConsensus().hashGenesisBlock) == 0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r155389796",
      "id" : 155389796,
      "original_commit_id" : "a029cd4093d821677588846cb3cbd577acace440",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 81701671,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:19:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/155389796",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r155390546"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/155390546"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Needs a `!`",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-06T23:17:43Z",
      "diff_hunk" : "@@ -2272,14 +2272,14 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n         {\n         LOCK(cs_main);\n \n-        if (mapBlockIndex.find(cmpctblock.header.hashPrevBlock) == mapBlockIndex.end()) {\n+        if (!LookupBlockIndex(cmpctblock.header.hashPrevBlock)) {\n             // Doesn't connect (or is genesis), instead of DoSing in AcceptBlockHeader, request deeper headers\n             if (!IsInitialBlockDownload())\n                 connman->PushMessage(pfrom, msgMaker.Make(NetMsgType::GETHEADERS, chainActive.GetLocator(pindexBestHeader), uint256()));\n             return true;\n         }\n \n-        if (mapBlockIndex.find(cmpctblock.header.GetHash()) == mapBlockIndex.end()) {\n+        if (LookupBlockIndex(cmpctblock.header.GetHash())) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r155390546",
      "id" : 155390546,
      "original_commit_id" : "a029cd4093d821677588846cb3cbd577acace440",
      "original_position" : 202,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 81701671,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:19:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/155390546",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/881253?v=4",
         "events_url" : "https://api.github.com/users/jimpo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jimpo/followers",
         "following_url" : "https://api.github.com/users/jimpo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jimpo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jimpo",
         "id" : 881253,
         "login" : "jimpo",
         "organizations_url" : "https://api.github.com/users/jimpo/orgs",
         "received_events_url" : "https://api.github.com/users/jimpo/received_events",
         "repos_url" : "https://api.github.com/users/jimpo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jimpo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jimpo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This needs rebase. I can do it and adapt the new code if there is interest in merging it quick.\r\n\r\nMaybe it should also make `BlockMap mapBlockIndex` static?\r\n\r\ncc @MarcoFalke @laanwj",
      "created_at" : "2017-12-06T23:39:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-349811860",
      "id" : 349811860,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-12-06T23:39:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/349811860",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK. Would like to see this rebased sooner rather than later.",
      "created_at" : "2017-12-12T15:42:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-351089901",
      "id" : 351089901,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-12-12T15:42:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/351089901",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Forgot to tackle @ryanofsky [comment](https://github.com/bitcoin/bitcoin/pull/11041#discussion_r148586107) above..",
      "created_at" : "2017-12-13T15:42:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-351429645",
      "id" : 351429645,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-12-13T15:42:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/351429645",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "travis failure:\r\n\r\n```\r\nAssertion failed: lock cs_main not held in ./validation.h:433; locks held:\r\n\r\n```",
      "created_at" : "2017-12-13T19:00:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-351488544",
      "id" : 351488544,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-12-13T19:00:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/351488544",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156909940"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156909940"
         }
      },
      "author_association" : "OWNER",
      "body" : "const?",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-14T10:46:02Z",
      "diff_hunk" : "@@ -167,10 +167,7 @@ void TransactionRecord::updateStatus(const CWalletTx &wtx)\n     // Determine transaction status\n \n     // Find the block the tx is in\n-    CBlockIndex* pindex = nullptr;\n-    BlockMap::iterator mi = mapBlockIndex.find(wtx.hashBlock);\n-    if (mi != mapBlockIndex.end())\n-        pindex = (*mi).second;\n+    CBlockIndex* pindex = LookupBlockIndex(wtx.hashBlock);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156909940",
      "id" : 156909940,
      "original_commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "original_position" : 8,
      "path" : "src/qt/transactionrecord.cpp",
      "position" : 8,
      "pull_request_review_id" : 83462031,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:56:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156909940",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156910767"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156910767"
         }
      },
      "author_association" : "OWNER",
      "body" : "`const CBlockIndex*`?",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-14T10:49:31Z",
      "diff_hunk" : "@@ -674,10 +674,10 @@ UniValue getblockheader(const JSONRPCRequest& request)\n     if (!request.params[1].isNull())\n         fVerbose = request.params[1].get_bool();\n \n-    if (mapBlockIndex.count(hash) == 0)\n+    CBlockIndex* pblockindex = LookupBlockIndex(hash);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156910767",
      "id" : 156910767,
      "original_commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "original_position" : 5,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 5,
      "pull_request_review_id" : 83462031,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:56:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156910767",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156910997"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156910997"
         }
      },
      "author_association" : "OWNER",
      "body" : "Another one that could be const. There are more, but I'll stop commenting every one.",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-14T10:50:39Z",
      "diff_hunk" : "@@ -753,12 +753,12 @@ UniValue getblock(const JSONRPCRequest& request)\n             verbosity = request.params[1].get_bool() ? 1 : 0;\n     }\n \n-    if (mapBlockIndex.count(hash) == 0)\n+    CBlockIndex* pblockindex = LookupBlockIndex(hash);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156910997",
      "id" : 156910997,
      "original_commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "original_position" : 19,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 19,
      "pull_request_review_id" : 83462031,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T10:56:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156910997",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think it would be preferable to use const CBlockIndex* where it's possible\r\n\r\nAgree.\r\n\r\n> There are some cs_main locking changes; can you please explain them? Were locks missing there before, making this a bugfix as well as refactor?\r\n\r\nYes, for instance `FindForkInGlobalIndex`.\r\n\r\nI'll check if adding annotations helps identifying more missing locks. I'll update accordingly.",
      "created_at" : "2017-12-14T11:30:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-351685379",
      "id" : 351685379,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-12-14T11:30:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/351685379",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "re: const CBlockIndex (and associated things): see #10692.",
      "created_at" : "2017-12-14T15:52:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#issuecomment-351750863",
      "id" : 351750863,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11041",
      "updated_at" : "2017-12-14T15:52:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/351750863",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156985799"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156985799"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I dont think that is the type of const you meant. Probably just leave it non-const for now and I'll fix it up in #10692 (or you can start pulling stuff out of there into this PR if you prefer, but that probably just ends up taking more time).",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-14T16:04:56Z",
      "diff_hunk" : "@@ -21,9 +21,9 @@ namespace Checkpoints {\n         for (const MapCheckpoints::value_type& i : reverse_iterate(checkpoints))\n         {\n             const uint256& hash = i.second;\n-            BlockMap::const_iterator t = mapBlockIndex.find(hash);\n-            if (t != mapBlockIndex.end())\n-                return t->second;\n+            if (CBlockIndex* const pindex = LookupBlockIndex(hash)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156985799",
      "id" : 156985799,
      "original_commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "original_position" : 7,
      "path" : "src/checkpoints.cpp",
      "position" : 7,
      "pull_request_review_id" : 83553623,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T16:38:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156985799",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156986317"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156986317"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This seems unrelated. Maybe leave it for #11596 instead? Or just do as I suggested at https://github.com/bitcoin/bitcoin/pull/11596#discussion_r155811677 and put a cs_main at the top of the load-chain-data block here.",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-14T16:06:34Z",
      "diff_hunk" : "@@ -1487,6 +1492,8 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n \n                 bool is_coinsview_empty = fReset || fReindexChainState || pcoinsTip->GetBestBlock().IsNull();\n                 if (!is_coinsview_empty) {\n+                    LOCK(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156986317",
      "id" : 156986317,
      "original_commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "original_position" : 24,
      "path" : "src/init.cpp",
      "position" : 24,
      "pull_request_review_id" : 83553623,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T16:38:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156986317",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156992080"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156992080"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Looks like you're just adding this for CreateWalletFromFile, which already needs cs_main (and is missing it there). This should be an AssertLockHeld.",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-14T16:25:24Z",
      "diff_hunk" : "@@ -259,12 +259,12 @@ namespace {\n \n CBlockIndex* FindForkInGlobalIndex(const CChain& chain, const CBlockLocator& locator)\n {\n+    LOCK(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156992080",
      "id" : 156992080,
      "original_commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "original_position" : 4,
      "path" : "src/validation.cpp",
      "position" : 4,
      "pull_request_review_id" : 83553623,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T16:38:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156992080",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156992400"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156992400"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Dunno if its worth bothering for things in CChainState. The whole goal here is to make mapBlockIndex a private in CChainState and expose LookupBlockIndex externally.",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-14T16:26:29Z",
      "diff_hunk" : "@@ -1813,9 +1813,9 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n         //  relative to a piece of software is an objective fact these defaults can be easily reviewed.\n         // This setting doesn't force the selection of any particular chain but makes validating some faster by\n         //  effectively caching the result of part of the verification.\n-        BlockMap::const_iterator  it = mapBlockIndex.find(hashAssumeValid);\n-        if (it != mapBlockIndex.end()) {\n-            if (it->second->GetAncestor(pindex->nHeight) == pindex &&\n+        const CBlockIndex* pindex_valid = LookupBlockIndex(hashAssumeValid);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156992400",
      "id" : 156992400,
      "original_commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "original_position" : 42,
      "path" : "src/validation.cpp",
      "position" : 42,
      "pull_request_review_id" : 83553623,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T16:38:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156992400",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156995634"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156995634"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This should absolutely be an AssertLockHeld, if anything. If you add the LOCK(cs_main) in the block-index-loading code in init.cpp this should be able to go away.",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-14T16:36:38Z",
      "diff_hunk" : "@@ -3641,17 +3640,20 @@ CBlockIndex * CChainState::InsertBlockIndex(const uint256& hash)\n     if (hash.IsNull())\n         return nullptr;\n \n+    LOCK(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156995634",
      "id" : 156995634,
      "original_commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "original_position" : 115,
      "path" : "src/validation.cpp",
      "position" : 115,
      "pull_request_review_id" : 83553623,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T16:38:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156995634",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156995817"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156995817"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Same here. Can go away with an init.cpp LOCK(cs_main).",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-14T16:37:18Z",
      "diff_hunk" : "@@ -4230,24 +4236,31 @@ bool LoadExternalBlockFile(const CChainParams& chainparams, FILE* fileIn, CDiskB\n \n                 // detect out of order blocks, and store them for later\n                 uint256 hash = block.GetHash();\n-                if (hash != chainparams.GetConsensus().hashGenesisBlock && mapBlockIndex.find(block.hashPrevBlock) == mapBlockIndex.end()) {\n-                    LogPrint(BCLog::REINDEX, \"%s: Out of order block %s, parent %s not known\\n\", __func__, hash.ToString(),\n-                            block.hashPrevBlock.ToString());\n-                    if (dbp)\n-                        mapBlocksUnknownParent.insert(std::make_pair(block.hashPrevBlock, *dbp));\n-                    continue;\n-                }\n \n-                // process in case the block isn't known yet\n-                if (mapBlockIndex.count(hash) == 0 || (mapBlockIndex[hash]->nStatus & BLOCK_HAVE_DATA) == 0) {\n+                {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r156995817",
      "id" : 156995817,
      "original_commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "original_position" : 209,
      "path" : "src/validation.cpp",
      "position" : 209,
      "pull_request_review_id" : 83553623,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-14T16:38:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156995817",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r157355249"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157355249"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Do we want to lock that long?",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-17T00:55:00Z",
      "diff_hunk" : "@@ -3641,17 +3640,20 @@ CBlockIndex * CChainState::InsertBlockIndex(const uint256& hash)\n     if (hash.IsNull())\n         return nullptr;\n \n+    LOCK(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r157355249",
      "id" : 157355249,
      "in_reply_to_id" : 156995634,
      "original_commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "original_position" : 115,
      "path" : "src/validation.cpp",
      "position" : 115,
      "pull_request_review_id" : 83987578,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-17T00:55:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157355249",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r157355270"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157355270"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "And why does `CreateWalletFromFile` needs `cs_main`?",
      "commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "created_at" : "2017-12-17T00:56:47Z",
      "diff_hunk" : "@@ -259,12 +259,12 @@ namespace {\n \n CBlockIndex* FindForkInGlobalIndex(const CChain& chain, const CBlockLocator& locator)\n {\n+    LOCK(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11041#discussion_r157355270",
      "id" : 157355270,
      "in_reply_to_id" : 156992080,
      "original_commit_id" : "cbff072b60cbf1d092c166fd5cf9d3fe233ed3d0",
      "original_position" : 4,
      "path" : "src/validation.cpp",
      "position" : 4,
      "pull_request_review_id" : 83987599,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11041",
      "updated_at" : "2017-12-17T00:56:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/157355270",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   }
]
