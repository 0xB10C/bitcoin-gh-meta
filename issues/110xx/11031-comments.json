[
   {
      "body" : "This could be made even more generic by adding additional `deprecated` field to the `CRPCTable`. That way the `IsDeprecatedRPCEnabled()` call could be added to the dispatcher instead of the individual RPC functions, and the help text could show methods as `DEPRECATED`. I didn't think that was worth doing for just this one RPC method.",
      "created_at" : "2017-08-11T17:50:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#issuecomment-321877466",
      "id" : 321877466,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11031",
      "updated_at" : "2017-08-11T17:50:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321877466",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Concept ACK",
      "created_at" : "2017-08-11T19:27:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#issuecomment-321898825",
      "id" : 321898825,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11031",
      "updated_at" : "2017-08-11T19:27:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321898825",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132798778"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132798778"
         }
      },
      "body" : "Missing validation for this argument?",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-11T23:03:24Z",
      "diff_hunk" : "@@ -441,6 +441,7 @@ std::string HelpMessage(HelpMessageMode mode)\n         strUsage += HelpMessageOpt(\"-checkmempool=<n>\", strprintf(\"Run checks every <n> transactions (default: %u)\", defaultChainParams->DefaultConsistencyChecks()));\n         strUsage += HelpMessageOpt(\"-checkpoints\", strprintf(\"Disable expensive verification for known chain history (default: %u)\", DEFAULT_CHECKPOINTS_ENABLED));\n         strUsage += HelpMessageOpt(\"-disablesafemode\", strprintf(\"Disable safemode, override a real safe mode event (default: %u)\", DEFAULT_DISABLE_SAFEMODE));\n+        strUsage += HelpMessageOpt(\"-enablerpcmethod\", \"Enables a deprecated RPC method\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132798778",
      "id" : 132798778,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 55923927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-12T17:39:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132798778",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132798832"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132798832"
         }
      },
      "body" : "Argument should mention it is a deprecated method? Like `-enabledeprecated=...`",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-11T23:03:55Z",
      "diff_hunk" : "@@ -441,6 +441,7 @@ std::string HelpMessage(HelpMessageMode mode)\n         strUsage += HelpMessageOpt(\"-checkmempool=<n>\", strprintf(\"Run checks every <n> transactions (default: %u)\", defaultChainParams->DefaultConsistencyChecks()));\n         strUsage += HelpMessageOpt(\"-checkpoints\", strprintf(\"Disable expensive verification for known chain history (default: %u)\", DEFAULT_CHECKPOINTS_ENABLED));\n         strUsage += HelpMessageOpt(\"-disablesafemode\", strprintf(\"Disable safemode, override a real safe mode event (default: %u)\", DEFAULT_DISABLE_SAFEMODE));\n+        strUsage += HelpMessageOpt(\"-enablerpcmethod\", \"Enables a deprecated RPC method\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132798832",
      "id" : 132798832,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 55923927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-12T17:39:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132798832",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132798923"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132798923"
         }
      },
      "body" : "Should be before help? Why show the help if it's disabled? Why the explicit `std::string()`?",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-11T23:04:57Z",
      "diff_hunk" : "@@ -790,6 +790,12 @@ UniValue estimatefee(const JSONRPCRequest& request)\n             + HelpExampleCli(\"estimatefee\", \"6\")\n             );\n \n+    if (!IsDeprecatedRPCEnabled(std::string(\"estimatefee\"))){",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132798923",
      "id" : 132798923,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/rpc/mining.cpp",
      "position" : null,
      "pull_request_review_id" : 55923927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-12T17:39:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132798923",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132799004"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132799004"
         }
      },
      "body" : "`const std::string& method`?",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-11T23:05:48Z",
      "diff_hunk" : "@@ -387,6 +387,16 @@ void JSONRPCRequest::parse(const UniValue& valRequest)\n         throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array or object\");\n }\n \n+bool IsDeprecatedRPCEnabled(std::string rpc_name)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132799004",
      "id" : 132799004,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 55923927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-12T17:39:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132799004",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132799143"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132799143"
         }
      },
      "body" : "No need to `if`:\r\n```\r\nreturn find(enabled_rpcs.begin(), enabled_rpcs.end(), rpc_name) != enabled_rpcs.end();\r\n```",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-11T23:07:21Z",
      "diff_hunk" : "@@ -387,6 +387,16 @@ void JSONRPCRequest::parse(const UniValue& valRequest)\n         throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array or object\");\n }\n \n+bool IsDeprecatedRPCEnabled(std::string rpc_name)\n+{\n+    const std::vector<std::string> enabled_rpcs = gArgs.GetArgs(\"-enablerpcmethod\");\n+\n+    if (find(enabled_rpcs.begin(), enabled_rpcs.end(), rpc_name) != enabled_rpcs.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132799143",
      "id" : 132799143,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 8,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 55923927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-12T17:39:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132799143",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132822376"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132822376"
         }
      },
      "body" : "I think `enablerpcmethod` is already clear, especially since this is a hidden option and the help text explains that it's used for enabling a deprecated method.\r\n\r\nI don't think there's validation for any of our arguments.",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-12T17:19:23Z",
      "diff_hunk" : "@@ -441,6 +441,7 @@ std::string HelpMessage(HelpMessageMode mode)\n         strUsage += HelpMessageOpt(\"-checkmempool=<n>\", strprintf(\"Run checks every <n> transactions (default: %u)\", defaultChainParams->DefaultConsistencyChecks()));\n         strUsage += HelpMessageOpt(\"-checkpoints\", strprintf(\"Disable expensive verification for known chain history (default: %u)\", DEFAULT_CHECKPOINTS_ENABLED));\n         strUsage += HelpMessageOpt(\"-disablesafemode\", strprintf(\"Disable safemode, override a real safe mode event (default: %u)\", DEFAULT_DISABLE_SAFEMODE));\n+        strUsage += HelpMessageOpt(\"-enablerpcmethod\", \"Enables a deprecated RPC method\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132822376",
      "id" : 132822376,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 55948021,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-12T17:39:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132822376",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132822591"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132822591"
         }
      },
      "body" : "I initially had this before the help if statement, but the way that help is implemented in `server.cpp` means that calling help without any arguments calls into every RPC method. Adding the `if (!IsDeprecatedRPCEnabled` statement before the help if statement breaks that.\r\n\r\nYou're right that no explicit `std::string()` is required. Removing.",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-12T17:30:10Z",
      "diff_hunk" : "@@ -790,6 +790,12 @@ UniValue estimatefee(const JSONRPCRequest& request)\n             + HelpExampleCli(\"estimatefee\", \"6\")\n             );\n \n+    if (!IsDeprecatedRPCEnabled(std::string(\"estimatefee\"))){",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132822591",
      "id" : 132822591,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/rpc/mining.cpp",
      "position" : null,
      "pull_request_review_id" : 55948214,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-12T17:39:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132822591",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132822635"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132822635"
         }
      },
      "body" : "Yes there is, don't recall exactly which.",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-12T17:33:22Z",
      "diff_hunk" : "@@ -441,6 +441,7 @@ std::string HelpMessage(HelpMessageMode mode)\n         strUsage += HelpMessageOpt(\"-checkmempool=<n>\", strprintf(\"Run checks every <n> transactions (default: %u)\", defaultChainParams->DefaultConsistencyChecks()));\n         strUsage += HelpMessageOpt(\"-checkpoints\", strprintf(\"Disable expensive verification for known chain history (default: %u)\", DEFAULT_CHECKPOINTS_ENABLED));\n         strUsage += HelpMessageOpt(\"-disablesafemode\", strprintf(\"Disable safemode, override a real safe mode event (default: %u)\", DEFAULT_DISABLE_SAFEMODE));\n+        strUsage += HelpMessageOpt(\"-enablerpcmethod\", \"Enables a deprecated RPC method\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132822635",
      "id" : 132822635,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 55948257,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-12T17:39:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132822635",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132822772"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132822772"
         }
      },
      "body" : "changed",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-12T17:39:06Z",
      "diff_hunk" : "@@ -387,6 +387,16 @@ void JSONRPCRequest::parse(const UniValue& valRequest)\n         throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array or object\");\n }\n \n+bool IsDeprecatedRPCEnabled(std::string rpc_name)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132822772",
      "id" : 132822772,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 55948381,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-12T17:39:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132822772",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132822773"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132822773"
         }
      },
      "body" : "yep, fixed",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-12T17:39:11Z",
      "diff_hunk" : "@@ -387,6 +387,16 @@ void JSONRPCRequest::parse(const UniValue& valRequest)\n         throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array or object\");\n }\n \n+bool IsDeprecatedRPCEnabled(std::string rpc_name)\n+{\n+    const std::vector<std::string> enabled_rpcs = gArgs.GetArgs(\"-enablerpcmethod\");\n+\n+    if (find(enabled_rpcs.begin(), enabled_rpcs.end(), rpc_name) != enabled_rpcs.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132822773",
      "id" : 132822773,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 8,
      "path" : "src/rpc/server.cpp",
      "position" : null,
      "pull_request_review_id" : 55948383,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-12T17:39:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132822773",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Thanks for the thoughtful review @promag!\r\n\r\n> Mixed feelings about adding a option to enable individual methods. Why not one option to enable all existing deprecated methods?\r\n\r\nThe point of this is that it *forces* action on the user if they want to continue using a deprecated method. In version x they need to explicitly update their config to include `-enablerpcmethod=<method>`, so they have fair warning of 1 release to update their client software before upgrading to version x+1. If there was a generic `enabledeprecatedmethods` that they could set and forget, then they might not realise that one of the methods they're using is deprecated, upgrade to version x+1 and find that they have no way to use the method.\r\n\r\n> In any case, I would split the code in 2 commits: 1st add support for the new argument; 2nd make estimatefee deprecated. In the 2nd commit there should be a functional test for the new RPC error.\r\n\r\nSeemed to me like this is a small enough change to not need multiple commits. But I'm happy to split if you think it'll help future reviewers.\r\n\r\nAgree that there should be a new functional test.",
      "created_at" : "2017-08-12T17:45:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#issuecomment-321995649",
      "id" : 321995649,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11031",
      "updated_at" : "2017-08-12T17:45:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321995649",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132822956"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132822956"
         }
      },
      "body" : "Would be nice to have a list of deprecated RPC methods with `enabled` flag",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-12T17:48:55Z",
      "diff_hunk" : "@@ -441,6 +441,7 @@ std::string HelpMessage(HelpMessageMode mode)\n         strUsage += HelpMessageOpt(\"-checkmempool=<n>\", strprintf(\"Run checks every <n> transactions (default: %u)\", defaultChainParams->DefaultConsistencyChecks()));\n         strUsage += HelpMessageOpt(\"-checkpoints\", strprintf(\"Disable expensive verification for known chain history (default: %u)\", DEFAULT_CHECKPOINTS_ENABLED));\n         strUsage += HelpMessageOpt(\"-disablesafemode\", strprintf(\"Disable safemode, override a real safe mode event (default: %u)\", DEFAULT_DISABLE_SAFEMODE));\n+        strUsage += HelpMessageOpt(\"-enablerpcmethod\", \"Enables a deprecated RPC method\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132822956",
      "id" : 132822956,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 55948549,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-12T17:53:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132822956",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7385989?v=4",
         "events_url" : "https://api.github.com/users/sd256/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sd256/followers",
         "following_url" : "https://api.github.com/users/sd256/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sd256/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sd256",
         "id" : 7385989,
         "login" : "sd256",
         "organizations_url" : "https://api.github.com/users/sd256/orgs",
         "received_events_url" : "https://api.github.com/users/sd256/received_events",
         "repos_url" : "https://api.github.com/users/sd256/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sd256/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sd256/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sd256"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132827824"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132827824"
         }
      },
      "body" : "With validation you force to clean outdated `enablerpcmethod ` from config file.",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-12T22:05:28Z",
      "diff_hunk" : "@@ -441,6 +441,7 @@ std::string HelpMessage(HelpMessageMode mode)\n         strUsage += HelpMessageOpt(\"-checkmempool=<n>\", strprintf(\"Run checks every <n> transactions (default: %u)\", defaultChainParams->DefaultConsistencyChecks()));\n         strUsage += HelpMessageOpt(\"-checkpoints\", strprintf(\"Disable expensive verification for known chain history (default: %u)\", DEFAULT_CHECKPOINTS_ENABLED));\n         strUsage += HelpMessageOpt(\"-disablesafemode\", strprintf(\"Disable safemode, override a real safe mode event (default: %u)\", DEFAULT_DISABLE_SAFEMODE));\n+        strUsage += HelpMessageOpt(\"-enablerpcmethod\", \"Enables a deprecated RPC method\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132827824",
      "id" : 132827824,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 55952767,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-12T22:05:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132827824",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132948422"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132948422"
         }
      },
      "body" : "I don't think validating arguments is the norm. If I'm wrong, please point out where in the code this happens.\r\n\r\nI'd definitely concept ACK a PR for better validating of command line arguments in general (for example, warning if a user tries setting an argument that doesn't exist, to catch mis-spellings).\r\n\r\nThis particular argument `enablerpcmethod` seems to be one where validation is least useful. Users will find out instantly if they didn't enable the RPC method. Outdated `enablerpcmethod` arguments are a no-op so are harmless.",
      "commit_id" : "9a1c90878de7e49f9505a404f684a767c4a62ed8",
      "created_at" : "2017-08-14T13:22:12Z",
      "diff_hunk" : "@@ -441,6 +441,7 @@ std::string HelpMessage(HelpMessageMode mode)\n         strUsage += HelpMessageOpt(\"-checkmempool=<n>\", strprintf(\"Run checks every <n> transactions (default: %u)\", defaultChainParams->DefaultConsistencyChecks()));\n         strUsage += HelpMessageOpt(\"-checkpoints\", strprintf(\"Disable expensive verification for known chain history (default: %u)\", DEFAULT_CHECKPOINTS_ENABLED));\n         strUsage += HelpMessageOpt(\"-disablesafemode\", strprintf(\"Disable safemode, override a real safe mode event (default: %u)\", DEFAULT_DISABLE_SAFEMODE));\n+        strUsage += HelpMessageOpt(\"-enablerpcmethod\", \"Enables a deprecated RPC method\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132948422",
      "id" : 132948422,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 56076286,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-14T13:22:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132948422",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Thanks to @mess110 for contributing a functional test to cover the new command line option.",
      "created_at" : "2017-08-23T15:06:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#issuecomment-324365648",
      "id" : 324365648,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11031",
      "updated_at" : "2017-08-23T15:06:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324365648",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "rebased",
      "created_at" : "2017-09-12T18:48:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#issuecomment-328946154",
      "id" : 328946154,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11031",
      "updated_at" : "2017-09-12T18:48:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/328946154",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
