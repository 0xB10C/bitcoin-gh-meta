[
   {
      "body" : "This could be made even more generic by adding additional `deprecated` field to the `CRPCTable`. That way the `IsDeprecatedRPCEnabled()` call could be added to the dispatcher instead of the individual RPC functions, and the help text could show methods as `DEPRECATED`. I didn't think that was worth doing for just this one RPC method.",
      "created_at" : "2017-08-11T17:50:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#issuecomment-321877466",
      "id" : 321877466,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11031",
      "updated_at" : "2017-08-11T17:50:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321877466",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Concept ACK",
      "created_at" : "2017-08-11T19:27:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#issuecomment-321898825",
      "id" : 321898825,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11031",
      "updated_at" : "2017-08-11T19:27:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/321898825",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132798778"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132798778"
         }
      },
      "body" : "Missing validation for this argument?",
      "commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "created_at" : "2017-08-11T23:03:24Z",
      "diff_hunk" : "@@ -441,6 +441,7 @@ std::string HelpMessage(HelpMessageMode mode)\n         strUsage += HelpMessageOpt(\"-checkmempool=<n>\", strprintf(\"Run checks every <n> transactions (default: %u)\", defaultChainParams->DefaultConsistencyChecks()));\n         strUsage += HelpMessageOpt(\"-checkpoints\", strprintf(\"Disable expensive verification for known chain history (default: %u)\", DEFAULT_CHECKPOINTS_ENABLED));\n         strUsage += HelpMessageOpt(\"-disablesafemode\", strprintf(\"Disable safemode, override a real safe mode event (default: %u)\", DEFAULT_DISABLE_SAFEMODE));\n+        strUsage += HelpMessageOpt(\"-enablerpcmethod\", \"Enables a deprecated RPC method\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132798778",
      "id" : 132798778,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 55923927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-11T23:11:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132798778",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132798832"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132798832"
         }
      },
      "body" : "Argument should mention it is a deprecated method? Like `-enabledeprecated=...`",
      "commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "created_at" : "2017-08-11T23:03:55Z",
      "diff_hunk" : "@@ -441,6 +441,7 @@ std::string HelpMessage(HelpMessageMode mode)\n         strUsage += HelpMessageOpt(\"-checkmempool=<n>\", strprintf(\"Run checks every <n> transactions (default: %u)\", defaultChainParams->DefaultConsistencyChecks()));\n         strUsage += HelpMessageOpt(\"-checkpoints\", strprintf(\"Disable expensive verification for known chain history (default: %u)\", DEFAULT_CHECKPOINTS_ENABLED));\n         strUsage += HelpMessageOpt(\"-disablesafemode\", strprintf(\"Disable safemode, override a real safe mode event (default: %u)\", DEFAULT_DISABLE_SAFEMODE));\n+        strUsage += HelpMessageOpt(\"-enablerpcmethod\", \"Enables a deprecated RPC method\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132798832",
      "id" : 132798832,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/init.cpp",
      "position" : 4,
      "pull_request_review_id" : 55923927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-11T23:12:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132798832",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132798923"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132798923"
         }
      },
      "body" : "Should be before help? Why show the help if it's disabled? Why the explicit `std::string()`?",
      "commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "created_at" : "2017-08-11T23:04:57Z",
      "diff_hunk" : "@@ -790,6 +790,12 @@ UniValue estimatefee(const JSONRPCRequest& request)\n             + HelpExampleCli(\"estimatefee\", \"6\")\n             );\n \n+    if (!IsDeprecatedRPCEnabled(std::string(\"estimatefee\"))){",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132798923",
      "id" : 132798923,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/rpc/mining.cpp",
      "position" : 4,
      "pull_request_review_id" : 55923927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-11T23:13:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132798923",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132799004"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132799004"
         }
      },
      "body" : "`const std::string& method`?",
      "commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "created_at" : "2017-08-11T23:05:48Z",
      "diff_hunk" : "@@ -387,6 +387,16 @@ void JSONRPCRequest::parse(const UniValue& valRequest)\n         throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array or object\");\n }\n \n+bool IsDeprecatedRPCEnabled(std::string rpc_name)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132799004",
      "id" : 132799004,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 4,
      "path" : "src/rpc/server.cpp",
      "position" : 4,
      "pull_request_review_id" : 55923927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-11T23:11:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132799004",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132799143"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132799143"
         }
      },
      "body" : "No need to `if`:\r\n```\r\nreturn find(enabled_rpcs.begin(), enabled_rpcs.end(), rpc_name) != enabled_rpcs.end();\r\n```",
      "commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "created_at" : "2017-08-11T23:07:21Z",
      "diff_hunk" : "@@ -387,6 +387,16 @@ void JSONRPCRequest::parse(const UniValue& valRequest)\n         throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array or object\");\n }\n \n+bool IsDeprecatedRPCEnabled(std::string rpc_name)\n+{\n+    const std::vector<std::string> enabled_rpcs = gArgs.GetArgs(\"-enablerpcmethod\");\n+\n+    if (find(enabled_rpcs.begin(), enabled_rpcs.end(), rpc_name) != enabled_rpcs.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11031#discussion_r132799143",
      "id" : 132799143,
      "original_commit_id" : "d301afead9fc58950a03a8310abf9ba221b06f0d",
      "original_position" : 8,
      "path" : "src/rpc/server.cpp",
      "position" : 8,
      "pull_request_review_id" : 55923927,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11031",
      "updated_at" : "2017-08-11T23:11:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/132799143",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   }
]
