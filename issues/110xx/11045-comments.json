[
   {
      "body" : "That sounds very cool! Our current fuzzers are indeed hardly more than proof of concepts.",
      "created_at" : "2017-08-14T18:17:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11045#issuecomment-322267213",
      "id" : 322267213,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11045",
      "updated_at" : "2017-08-14T18:17:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322267213",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Great. Currently it is not integrated into the build script. It's just the directory /fuzzers with a number of cpp files and a Makefile, which references hardcoded relative paths (```../src/libbitcoin_util.a ../src/crypto/libbitcoin_crypto.a``` etc). If this is not what you want you must integrate it into the build scripts yourself because that is not my forte.\r\n\r\nI'm gonna prepare it now and make the PR.",
      "created_at" : "2017-08-14T18:26:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11045#issuecomment-322269538",
      "id" : 322269538,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11045",
      "updated_at" : "2017-08-14T18:26:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322269538",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/6846644?v=4",
         "events_url" : "https://api.github.com/users/guidovranken/events{/privacy}",
         "followers_url" : "https://api.github.com/users/guidovranken/followers",
         "following_url" : "https://api.github.com/users/guidovranken/following{/other_user}",
         "gists_url" : "https://api.github.com/users/guidovranken/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/guidovranken",
         "id" : 6846644,
         "login" : "guidovranken",
         "organizations_url" : "https://api.github.com/users/guidovranken/orgs",
         "received_events_url" : "https://api.github.com/users/guidovranken/received_events",
         "repos_url" : "https://api.github.com/users/guidovranken/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/guidovranken/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/guidovranken/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/guidovranken"
      }
   },
   {
      "body" : "@guidovranken That's awesome! I've played around with different ways to extend the fuzzing coverage myself, so I'd be really interested in checking your stuff out and how you've attacked the problem.\r\n\r\nIf you are not yet ready to submit a proper pull request I'd be glad to take a look at it as-is. Just dump the code in its current state in a gist, repo or somewhere convenient for you and I'll figure out the rest :-)\r\n\r\nFor reference, see some previous discussions about improving Bitcoin fuzzing :\r\n* [tests] Add fuzz testing for BlockTransactions, BlockTransactionsRequest and CBlockHeaderAndShortTxIDs deserialization, #10409\r\n* [tests] Add libFuzzer support, #10440\r\n* [tests] Speed up fuzzing by ~200x when using afl-fuzz, #10415\r\n* Feature request: Make Bitcoin libFuzzer-friendly and consider integration into the OSS-Fuzz project, #10364",
      "created_at" : "2017-08-16T10:02:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11045#issuecomment-322724218",
      "id" : 322724218,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11045",
      "updated_at" : "2017-08-16T14:55:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322724218",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "Here they are: https://github.com/guidovranken/bitcoin/tree/fuzzing/fuzzers\r\n\r\nYou need to compile Bitcoin with AddressSanitizer (preferably) and instrumentation, something like this:\r\n\r\n```-fsanitize=address -g -fsanitize-coverage=trace-pc-guard,indirect-calls,trace-cmp```\r\n\r\nand put libFuzzer.a in the fuzzers/ directory.\r\n\r\nInstructions how to build libFuzzer can be found here (it's trivial): https://llvm.org/docs/LibFuzzer.html",
      "created_at" : "2017-08-17T01:05:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11045#issuecomment-322940587",
      "id" : 322940587,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11045",
      "updated_at" : "2017-08-17T01:05:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322940587",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/6846644?v=4",
         "events_url" : "https://api.github.com/users/guidovranken/events{/privacy}",
         "followers_url" : "https://api.github.com/users/guidovranken/followers",
         "following_url" : "https://api.github.com/users/guidovranken/following{/other_user}",
         "gists_url" : "https://api.github.com/users/guidovranken/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/guidovranken",
         "id" : 6846644,
         "login" : "guidovranken",
         "organizations_url" : "https://api.github.com/users/guidovranken/orgs",
         "received_events_url" : "https://api.github.com/users/guidovranken/received_events",
         "repos_url" : "https://api.github.com/users/guidovranken/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/guidovranken/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/guidovranken/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/guidovranken"
      }
   },
   {
      "body" : "@guidovranken Wow, really nice! Thanks for sharing! Ã°ÂÂÂ ",
      "created_at" : "2017-08-17T07:26:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11045#issuecomment-322991131",
      "id" : 322991131,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11045",
      "updated_at" : "2017-08-17T07:26:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322991131",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "You're welcome. There's more coming, like a prevector fuzzer (using class prevector_tester, from tests), will push it later today.",
      "created_at" : "2017-08-17T14:52:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11045#issuecomment-323097043",
      "id" : 323097043,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11045",
      "updated_at" : "2017-08-17T14:52:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/323097043",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/6846644?v=4",
         "events_url" : "https://api.github.com/users/guidovranken/events{/privacy}",
         "followers_url" : "https://api.github.com/users/guidovranken/followers",
         "following_url" : "https://api.github.com/users/guidovranken/following{/other_user}",
         "gists_url" : "https://api.github.com/users/guidovranken/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/guidovranken",
         "id" : 6846644,
         "login" : "guidovranken",
         "organizations_url" : "https://api.github.com/users/guidovranken/orgs",
         "received_events_url" : "https://api.github.com/users/guidovranken/received_events",
         "repos_url" : "https://api.github.com/users/guidovranken/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/guidovranken/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/guidovranken/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/guidovranken"
      }
   },
   {
      "body" : "@guidovranken Great! Keep it coming! Ã°ÂÂÂ  Are you still writing new fuzzers or are all these the fuzzers you had been running for a while without finding any issues?",
      "created_at" : "2017-08-17T14:57:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11045#issuecomment-323098303",
      "id" : 323098303,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11045",
      "updated_at" : "2017-08-17T14:57:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/323098303",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "@guidovranken A small nit - would it be possible to rewrite `fuzzer-blockchain-load.cpp` so that it doesn't write to the filesystem? It would be nice to avoid filesystem access in all fuzzers.\r\n\r\n@sipa What is your opinion - should new tests such as these be added as additional tests in `test_bitcoin_fuzzy.cpp` (extending the `enum TEST_ID`), or should we add them somewhere else to keep `test_bitcoin_fuzzy.cpp` \"deserialization-only\"? :-)",
      "created_at" : "2017-08-17T15:17:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11045#issuecomment-323104012",
      "id" : 323104012,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11045",
      "updated_at" : "2017-08-17T15:17:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/323104012",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "@practicalswift I believe @kcc has advised against the approach of switching between tests based on input. It risks confusing the fuzzer, and reusing information from one test and trying to apply it in another.\n\nThe suggestion, I believe, was to have a separate binary for each test (which could be done automatically using #defines that select which test to build for).",
      "created_at" : "2017-08-17T15:30:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11045#issuecomment-323108021",
      "id" : 323108021,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11045",
      "updated_at" : "2017-08-17T15:30:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/323108021",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@practicalswift I'm still updating them and writing new fuzzers. I want to update the blockchain loader, but ```LoadExternalBlockFile``` takes a ```FILE*```. What do you suggest?",
      "created_at" : "2017-08-17T19:16:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11045#issuecomment-323167949",
      "id" : 323167949,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11045",
      "updated_at" : "2017-08-17T19:16:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/323167949",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/6846644?v=4",
         "events_url" : "https://api.github.com/users/guidovranken/events{/privacy}",
         "followers_url" : "https://api.github.com/users/guidovranken/followers",
         "following_url" : "https://api.github.com/users/guidovranken/following{/other_user}",
         "gists_url" : "https://api.github.com/users/guidovranken/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/guidovranken",
         "id" : 6846644,
         "login" : "guidovranken",
         "organizations_url" : "https://api.github.com/users/guidovranken/orgs",
         "received_events_url" : "https://api.github.com/users/guidovranken/received_events",
         "repos_url" : "https://api.github.com/users/guidovranken/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/guidovranken/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/guidovranken/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/guidovranken"
      }
   }
]
