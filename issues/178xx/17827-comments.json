[
   {
      "author_association" : "NONE",
      "body" : "I tried the workaround I suggested in the bug report, by removing the earlier of the rev*.dat files to free  up the required space to download all blocks, and then removing all rev*.dat files forcing a reindex but the result is the same. On the Mac Mini I get to 83% when the disk is full. So achieving a full node on the Mac Mini with 480 GB free space to begin with _seems_ impossible.\r\n\r\n```\r\nblocks % pwd\r\n\r\n/Users/erik/Library/Application Support/Bitcoin/blocks\r\n\r\nblocks % du -h .\r\n\r\n 90M\t./index\r\n391G\t.\r\n\r\n% df -h\r\n\r\nFilesystem          Size   Used  Avail Capacity iused      ifree %iused  Mounted on\r\n/dev/disk1s5       466Gi   10Gi   52Gi    17%  484073 4881333367    0%   /\r\ndevfs              233Ki  233Ki    0Bi   100%     808          0  100%   /dev\r\n/dev/disk1s1       466Gi  401Gi   52Gi    89%  142604 4881674836    0%   /System/Volumes/Data\r\n/dev/disk1s4       466Gi  2.0Gi   52Gi     4%       2 4881817438    0%   /private/var/vm\r\nmap auto_home        0Bi    0Bi    0Bi   100%       0          0  100%   /System/Volumes/Data/home\r\n\r\nblocks % du -ch rev*.dat | sort -n\r\n\r\n 17M\trev01912.dat\r\n 19M\trev00000.dat\r\n 32M\trev00002.dat\r\n ...\r\n 210M\trev01291.dat\r\n 250M\trev01036.dat\r\n152G\ttotal\r\n\r\nblocks % du -ch blk*.dat\r\n\r\n128M\tblk00000.dat\r\n128M\tblk00001.dat\r\n128M\tblk00002.dat\r\n...\r\n128M\tblk01912.dat\r\n125M\tblk01913.dat\r\n238G\ttotal\r\n\r\nblocks % rm rev*.dat\r\n\r\n% df -h\r\n\r\nFilesystem          Size   Used  Avail Capacity iused      ifree %iused  Mounted on\r\n/dev/disk1s5       466Gi   10Gi  204Gi     5%  484073 4881333367    0%   /\r\ndevfs              233Ki  233Ki    0Bi   100%     808          0  100%   /dev\r\n/dev/disk1s1       466Gi  248Gi  204Gi    55%  141579 4881675861    0%   /System/Volumes/Data\r\n/dev/disk1s4       466Gi  2.0Gi  204Gi     1%       2 4881817438    0%   /private/var/vm\r\nmap auto_home        0Bi    0Bi    0Bi   100%       0          0  100%   /System/Volumes/Data/home\r\n```\r\n\r\nStarted Bitcoin Core and clicked OK to rebuild the block database.\r\n\r\n![corrupted-block-database-detected](https://user-images.githubusercontent.com/20860124/71611833-e97aee00-2ba4-11ea-942b-df3d7bebeb3e.png)\r\n\r\n![reindexing-blocks-on-disk](https://user-images.githubusercontent.com/20860124/71611857-116a5180-2ba5-11ea-9e91-25c160c011b6.png)\r\n\r\n![processing-blocks-on-disk](https://user-images.githubusercontent.com/20860124/71611861-17603280-2ba5-11ea-8dd0-9101bb29712d.png)\r\n\r\n```\r\n% tail debug.log\r\n\r\n2019-12-31T04:32:26Z UpdateTip: new best=00000000000000000016319a033ba5a534d962bf17077825634a0bbcce5dbf48 height=573963 version=0x20000000 log2_work=90.59244 tx=408110896 date='2019-04-30T19:18:40Z' progress=0.832507 cache=726.0MiB(5526596txo)\r\n2019-12-31T04:32:26Z *** Disk space is too low!\r\n2019-12-31T04:32:26Z Error: Disk space is too low!\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:10Z socket sending timeout: 1201s\r\n2019-12-31T04:52:13Z socket sending timeout: 1201s\r\n2019-12-31T06:02:11Z Failed to connect best block (Disk space is too low! (code 0))\r\n2019-12-31T06:02:11Z tor: Thread interrupt\r\n2019-12-31T06:02:11Z Shutdown: In progress...\r\n2019-12-31T06:02:11Z torcontrol thread exit\r\n2019-12-31T06:02:11Z addcon thread exit\r\n2019-12-31T06:02:11Z opencon thread exit\r\n2019-12-31T06:02:11Z msghand thread exit\r\n2019-12-31T06:02:11Z net thread exit\r\n2019-12-31T06:02:11Z scheduler thread interrupt\r\n2019-12-31T06:02:11Z *** Disk space is too low!\r\n2019-12-31T06:02:11Z Error: Disk space is too low!\r\n2019-12-31T06:02:11Z ForceFlushStateToDisk: failed to flush state (Disk space is too low! (code 0))\r\n2019-12-31T06:02:11Z *** Disk space is too low!\r\n2019-12-31T06:02:11Z Error: Disk space is too low!\r\n2019-12-31T06:02:11Z ForceFlushStateToDisk: failed to flush state (Disk space is too low! (code 0))\r\n2019-12-31T06:02:12Z [default wallet] Releasing wallet\r\n2019-12-31T06:02:12Z Shutdown: done\r\n```\r\n\r\nOnce again the rev*.dat files uses 205G of disk space, the sizes range from 0B to 231M.\r\n```\r\nblocks % du -ch rev*.dat | sort -n\r\n\r\n  0B\trev01623.dat\r\n  0B\trev01624.dat\r\n  0B\trev01625.dat\r\n  0B\trev01626.dat\r\n  0B\trev01627.dat\r\n  0B\trev01628.dat\r\n...\r\n210M\trev00349.dat\r\n210M\trev00350.dat\r\n210M\trev00352.dat\r\n210M\trev00353.dat\r\n210M\trev00432.dat\r\n229M\trev00337.dat\r\n231M\trev00333.dat\r\n231M\trev00336.dat\r\n205G\ttotal\r\n\r\n% df -h\r\n                     \r\nFilesystem          Size   Used  Avail Capacity iused      ifree %iused  Mounted on\r\n/dev/disk1s5       466Gi   10Gi  247Mi    98%  484073 4881333367    0%   /\r\ndevfs              233Ki  233Ki    0Bi   100%     808          0  100%   /dev\r\n/dev/disk1s1       466Gi  452Gi  247Mi   100%  143019 4881674421    0%   /System/Volumes/Data\r\n/dev/disk1s4       466Gi  2.0Gi  247Mi    90%       2 4881817438    0%   /private/var/vm\r\nmap auto_home        0Bi    0Bi    0Bi   100%       0          0  100%   /System/Volumes/Data/home\r\n```",
      "created_at" : "2019-12-31T06:23:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569872745",
      "id" : 569872745,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg3Mjc0NQ==",
      "updated_at" : "2019-12-31T06:23:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569872745",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It says \"at least\". We can't accurately predict exactly how large the blockchain and associated data will be by the time synchronization finishes.",
      "created_at" : "2019-12-31T07:33:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569881430",
      "id" : 569881430,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg4MTQzMA==",
      "updated_at" : "2019-12-31T07:33:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569881430",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "With the help of people on IRC #bitcoin we've managed to rule out some potential causes:\r\n1. Time Machine is not configured on the Mac mini:\r\n![no-time-machine-on-mac-mini](https://user-images.githubusercontent.com/20860124/71613981-fc47ef80-2bb1-11ea-913c-569a35c72ecc.png)\r\n",
      "created_at" : "2019-12-31T07:44:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569882624",
      "id" : 569882624,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg4MjYyNA==",
      "updated_at" : "2019-12-31T07:44:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569882624",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> It says \"at least\". We can't accurately predict exactly how large the blockchain and associated data will be by the time synchronization finishes.\r\n\r\nYou're absolutely correct. However, I would argue that 480+ GB is **way** more than 284 GB. I actually don't know how much the whole download would require, as 480 GB only gets me to 83%.",
      "created_at" : "2019-12-31T07:47:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569882901",
      "id" : 569882901,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg4MjkwMQ==",
      "updated_at" : "2019-12-31T07:47:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569882901",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "My apologies, I missed that the difference was so large between two systems.\n\nYour rev files are way larger than they should be. However you can't just delete them, as that will interfere with reorgs and a few other operations.\n\nAs an immediate solution, you can enable pruning (which will delete blocks and rev files that are sufficiently old automatically and safely), but that is only addressing the symptom. ",
      "created_at" : "2019-12-31T07:55:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569883923",
      "id" : 569883923,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg4MzkyMw==",
      "updated_at" : "2019-12-31T07:57:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569883923",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> My apologies, I missed that the difference was so large between two systems.\r\n> \r\n> Your rev files are way larger than they should be. However you can't just delete them, as that will interfere with reorgs and a few other operations.\r\n> \r\n> As an immediate solution, you can enable pruning (which will delete blocks and rev files that are sufficiently old automatically and safely), but that is only addressing the symptom.\r\n\r\nThanks for clarifying why deleting them is not a working solution (or even workaround as I concluded in my later tests). In my case, as I understand it, I cannot enable pruning since I will be running Lightning towards this full node.\r\n\r\nFurthermore, if this is the intended behaviour on macOS, then perhaps it would be a good idea to revise the minimum requirements on https://bitcoin.org/en/full-node#special-cases to make sure that Mac users avoid running into this problem.",
      "created_at" : "2019-12-31T08:08:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569885570",
      "id" : 569885570,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg4NTU3MA==",
      "updated_at" : "2019-12-31T08:12:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569885570",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "No, this is not intended behavior at all. The rev*.dat files shouldn't go above 15-20 MB usually.\n\nFWIW, some lightning implementations (e.g. c-lightning) work fine with a pruned bitcoind.",
      "created_at" : "2019-12-31T08:57:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569891730",
      "id" : 569891730,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg5MTczMA==",
      "updated_at" : "2019-12-31T08:57:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569891730",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> No, this is not intended behavior at all. The rev*.dat files shouldn't go above 15-20 MB usually.\r\n> \r\n> FWIW, some lightning implementations (e.g. c-lightning) work fine with a pruned bitcoind.\r\n\r\nThanks for the hint, I have only tried the lnd implementation so it could also be interesting to try that out!",
      "created_at" : "2019-12-31T09:10:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569893454",
      "id" : 569893454,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTg5MzQ1NA==",
      "updated_at" : "2019-12-31T09:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569893454",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Digging a bit more into it with the help of #bitcoin we see that the files are mostly empty. Copying the file will result in a file size in the expected range.\r\n\r\n```\r\nblocks % du -h rev00336.dat \r\n231M\trev00336.dat\r\n\r\nblocks % hexdump -C rev00336.dat | tail -4\r\n0145c010  ea 7b e8 e9 86 7e c0 bc  fb 13 00 00 00 00 00 00  |.{...~..........|\r\n0145c020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\r\n*\r\n01500000\r\n\r\n% grep \"rev00336.dat\" debug.log          \r\n2019-12-30T20:48:10Z Pre-allocating up to position 0x100000 in rev00336.dat\r\n2019-12-30T20:48:39Z Pre-allocating up to position 0x200000 in rev00336.dat\r\n2019-12-30T20:48:43Z Pre-allocating up to position 0x300000 in rev00336.dat\r\n2019-12-30T20:48:45Z Pre-allocating up to position 0x400000 in rev00336.dat\r\n2019-12-30T20:48:49Z Pre-allocating up to position 0x500000 in rev00336.dat\r\n2019-12-30T20:48:50Z Pre-allocating up to position 0x600000 in rev00336.dat\r\n2019-12-30T20:48:51Z Pre-allocating up to position 0x700000 in rev00336.dat\r\n2019-12-30T20:48:52Z Pre-allocating up to position 0x800000 in rev00336.dat\r\n2019-12-30T20:48:54Z Pre-allocating up to position 0x900000 in rev00336.dat\r\n2019-12-30T20:48:55Z Pre-allocating up to position 0xa00000 in rev00336.dat\r\n2019-12-30T20:48:57Z Pre-allocating up to position 0xb00000 in rev00336.dat\r\n2019-12-30T20:48:58Z Pre-allocating up to position 0xc00000 in rev00336.dat\r\n2019-12-30T20:49:00Z Pre-allocating up to position 0xd00000 in rev00336.dat\r\n2019-12-30T20:49:01Z Pre-allocating up to position 0xe00000 in rev00336.dat\r\n2019-12-30T20:49:02Z Pre-allocating up to position 0xf00000 in rev00336.dat\r\n2019-12-30T20:49:03Z Pre-allocating up to position 0x1000000 in rev00336.dat\r\n2019-12-30T20:49:05Z Pre-allocating up to position 0x1100000 in rev00336.dat\r\n2019-12-30T20:49:06Z Pre-allocating up to position 0x1200000 in rev00336.dat\r\n2019-12-30T20:49:08Z Pre-allocating up to position 0x1300000 in rev00336.dat\r\n2019-12-30T20:49:10Z Pre-allocating up to position 0x1400000 in rev00336.dat\r\n2019-12-30T20:49:12Z Pre-allocating up to position 0x1500000 in rev00336.dat\r\n\r\nblocks % ls -lh rev00336.dat \r\n-rw-------  1 erik  staff    21M Dec 30 22:49 rev00336.dat\r\n\r\nblocks % cp rev00336.dat rev00336.copy\r\n\r\nblocks % du -h rev00336.*\r\n 21M\trev00336.copy\r\n231M\trev00336.dat\r\n```\r\n\r\nSo a workaround might be to replace all the rev files with copies.",
      "created_at" : "2019-12-31T11:34:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569914702",
      "id" : 569914702,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTkxNDcwMg==",
      "updated_at" : "2019-12-31T11:47:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569914702",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> No, this is not intended behavior at all. The rev*.dat files shouldn't go above 15-20 MB usually.\r\n\r\nI currently have a fully synced node running on macOS (10.14) that uses nearly 500GB on disk:\r\n```bash\r\n475G\ttotal\r\n422G\tblocks\r\n 40G\tindexes\r\n8.4G\ttestnet3\r\n4.1G\tchainstate\r\n356M\tregtest\r\n9.8M\tdebug.log\r\n4.0M\twallet.dat\r\n4.0M\tpeers.dat\r\n4.0M\tmempool.dat\r\n896K\tsome_wallet\r\n256K\tfee_estimates.dat\r\n4.0K\tbitcoin.conf\r\n4.0K\tbanlist.dat\r\n  0B\tdb.log\r\n  0B\t.walletlock\r\n  0B\t.lock\r\n```\r\n\r\nLargest `rev*.dat` files:\r\n```bash\r\n206M\trev00352.dat\r\n193M\trev00331.dat\r\n190M\trev00461.dat\r\n190M\trev00447.dat\r\n190M\trev00390.dat\r\n190M\trev00389.dat\r\n190M\trev00386.dat\r\n190M\trev00374.dat\r\n```",
      "created_at" : "2019-12-31T18:21:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-569969725",
      "id" : 569969725,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2OTk2OTcyNQ==",
      "updated_at" : "2019-12-31T18:21:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/569969725",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> > No, this is not intended behavior at all. The rev*.dat files shouldn't go above 15-20 MB usually.\r\n> \r\n> I currently have a fully synced node running on macOS (10.14) that uses nearly 500GB on disk:\r\n> \r\n> ```shell\r\n> 475G\ttotal\r\n> 422G\tblocks\r\n>  40G\tindexes\r\n> 8.4G\ttestnet3\r\n> 4.1G\tchainstate\r\n> 356M\tregtest\r\n> 9.8M\tdebug.log\r\n> 4.0M\twallet.dat\r\n> 4.0M\tpeers.dat\r\n> 4.0M\tmempool.dat\r\n> 896K\tsome_wallet\r\n> 256K\tfee_estimates.dat\r\n> 4.0K\tbitcoin.conf\r\n> 4.0K\tbanlist.dat\r\n>   0B\tdb.log\r\n>   0B\t.walletlock\r\n>   0B\t.lock\r\n> ```\r\n> \r\n> Largest `rev*.dat` files:\r\n> \r\n> ```shell\r\n> 206M\trev00352.dat\r\n> 193M\trev00331.dat\r\n> 190M\trev00461.dat\r\n> 190M\trev00447.dat\r\n> 190M\trev00390.dat\r\n> 190M\trev00389.dat\r\n> 190M\trev00386.dat\r\n> 190M\trev00374.dat\r\n> ```\r\n\r\nAnd if you copy one of the larger files, will it reduce in size to the expected 15-20 MB range?",
      "created_at" : "2020-01-01T07:55:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/17827#issuecomment-570032136",
      "id" : 570032136,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17827",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MDAzMjEzNg==",
      "updated_at" : "2020-01-01T07:55:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570032136",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   }
]
