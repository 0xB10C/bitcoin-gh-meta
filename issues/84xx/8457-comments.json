[
   {
      "body" : "I don't like overloading the argument, making it ambiguous. It seems messy, and we don't do that anywhere else on the API.\r\nE.g. a long hash with no hexadecimal characters could be interpreted as a long number.\r\nThis would need to be a new RPC call `getbockbyheight` or so.\r\nThough even then I'm not convinced it's a worthwhile addition.",
      "created_at" : "2016-08-04T18:48:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8457#issuecomment-237647103",
      "id" : 237647103,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8457",
      "updated_at" : "2016-08-04T18:48:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/237647103",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : ">This would need to be a new RPC call getbockbyheight or so.\r\n\r\nGiven that `getblock` is not called `getblockbyhash` was the reason that I've added the height support.\r\n\r\n> Though even then I'm not convinced it's a worthwhile addition.\r\n\r\nFor a new RPC I also share your opinion, about the `getblock` IMHO I think is useful for developers.",
      "created_at" : "2016-08-05T10:07:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8457#issuecomment-237813695",
      "id" : 237813695,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8457",
      "updated_at" : "2016-08-05T10:07:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/237813695",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "body" : "I think `getbockbyheight` could be handy. Concept ACK.",
      "created_at" : "2016-08-05T10:10:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8457#issuecomment-237814075",
      "id" : 237814075,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8457",
      "updated_at" : "2016-08-05T10:10:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/237814075",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "> I don't like overloading the argument, making it ambiguous.\r\n\r\nDisagree, there is a place for overloading in APIs. In this case blocks are usually referenced by height or hash.\r\n\r\nThere is also overloading in the protocol: `4\tlock_time\tuint32_t\tA time (Unix epoch time) or block number. See the locktime parsing rules`.\r\n\r\n> It seems messy, and we don't do that anywhere else on the API.\r\n\r\nFrom `help importaddress`: `1. \"script\"           (string, required) The hex-encoded script (or address) either`.\r\n\r\n> E.g. a long hash with no hexadecimal characters could be interpreted as a long number.\r\n\r\nUnlikely? Still it's simple to distinguish that block hash from a number.\r\n\r\n> Though even then I'm not convinced it's a worthwhile addition.\r\n\r\nFrom the API point of view, I think it's fair to fetch a block from it's height. From a technical point of view, making 2 calls causing locks on cs_main etc on a heavy loaded daemon is resource wasting.\r\n\r\nSo, +1 for `getblock hash|height (verbose)`.",
      "created_at" : "2016-08-05T10:34:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8457#issuecomment-237818518",
      "id" : 237818518,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8457",
      "updated_at" : "2016-08-05T10:34:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/237818518",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=3",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "I like the concept of one RPC call. But unfortunately there is one big caveat. In the future (and because of probability even in not so distant one), we can have a block whose hash is a hexadecimal number parseable as a decimal one resulting in the uncertain block referenced. We can't afford to have uncertain result...\r\n\r\nSo NACK.\r\n\r\nSo if we want to have an API to get block by hash, we can have one more RPC call or to live with\r\n\r\n```\r\nbtc getblock `btc getblockhash 423787`\r\n```\r\n\r\nI'm fine even without the new RPC call...\r\n\r\nFWIW: as of block 423792 we do not have any block whose hash written in hex is decimal number.\r\n",
      "created_at" : "2016-08-05T10:55:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8457#issuecomment-237822136",
      "id" : 237822136,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8457",
      "updated_at" : "2016-08-05T11:49:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/237822136",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : ">we can have a block whose hash is a hexadecimal number parseable as a decimal one\r\n\r\nIMO it is possible to detect if a given input is a block hash, as it comes as string, and, given that block hashes have fixed length, I don't think that if we want get the block 5125122 we call like this:\r\n```\r\ngetblock 0000000000000000000000000000000000000000000000000000000005125122\r\n```\r\nSo it will push a fix to this special case.\r\n\r\n>So if we want to have an API to get block by hash, we can have one more RPC call or to live with\r\n\r\nImagine that you need to scan the whole blockchain, given that `getblockhash` RPC call takes 1 second to process (can be more or less): \r\n- 1 second * 423789 blocks (at this moment) = takes more 4.90 days to process.\r\n\r\nSo, IMO, a call like `btc getblock 'btc getblockhash 423787'` is not very optimized.",
      "created_at" : "2016-08-05T11:54:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8457#issuecomment-237832001",
      "id" : 237832001,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8457",
      "updated_at" : "2016-08-05T11:54:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/237832001",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "body" : "Compare results of\r\n```\r\nbtc getblock 00c937983704a73af28acdec37b049d214adbda81d7e2a3dd146f6ed09\r\nbtc getblock c937983704a73af28acdec37b049d214adbda81d7e2a3dd146f6ed09\r\n```\r\n",
      "created_at" : "2016-08-05T11:57:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8457#issuecomment-237832369",
      "id" : 237832369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8457",
      "updated_at" : "2016-08-05T11:57:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/237832369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "@laanwj @promag @paveljanik WDYT of supporting something like this:\r\n- As is today (to be deprecated maybe):\r\n```\r\nbitcoin-cli getblock hash (verbose)\r\n```\r\n- With JSON input:\r\n```\r\nbitcoin-cli getblock '{ \"hash\": \"0x123\", \"verbose\": true}'\r\nbitcoin-cli getblock '{ \"block\": 1, \"verbose\": false}'\r\n```",
      "created_at" : "2016-08-05T13:16:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8457#issuecomment-237847394",
      "id" : 237847394,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8457",
      "updated_at" : "2016-08-05T13:16:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/237847394",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4319748?v=3",
         "events_url" : "https://api.github.com/users/pedrobranco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pedrobranco/followers",
         "following_url" : "https://api.github.com/users/pedrobranco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pedrobranco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pedrobranco",
         "id" : 4319748,
         "login" : "pedrobranco",
         "organizations_url" : "https://api.github.com/users/pedrobranco/orgs",
         "received_events_url" : "https://api.github.com/users/pedrobranco/received_events",
         "repos_url" : "https://api.github.com/users/pedrobranco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pedrobranco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pedrobranco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pedrobranco"
      }
   },
   {
      "body" : "It's better. But still this is special casing to work around one specific round-trip. This opens the flood-gates to many more.\r\n\r\nTo solve this more generally I plan on working on a cute little extension RFC to the [JSONRPC 2.0 spec](http://www.jsonrpc.org/specification). See discussion in https://github.com/bitcoin/bitcoin/pull/7783#issuecomment-239442267 .\r\n\r\nThis will add a simple form of (in-batch) promise pipelining to JSON-RPC batching, which will allow doing this kind of composition in a more flexible way. Eg `ext_store` and `ext_load` below:\r\n```javascript\r\n[\r\n{\r\n    \"version\": \"x.x\",\r\n    \"method\": \"getblockhash\",\r\n    \"id\": 0,\r\n    \"params\": [\"123456\"],\r\n    \"ext_store\": True   // Store the result of this request for later use\r\n},\r\n{\r\n    \"version\": \"x.x\",\r\n    \"method\": \"getblock\",\r\n    \"id\": 1,\r\n    \"params\": [\r\n        null // Placeholder for argument 0, will be replaced by ext_load below\r\n    ],\r\n    \"ext_load\": [\r\n        {\r\n            \"src\": [0, \"result\"],  // Load the output of request id 0, [\"result\"]\r\n            \"dst\": [0]             // into into params[0]\r\n        }\r\n    ],\r\n}\r\n]\r\n```\r\nThe effect of which will be:\r\n```javascript\r\ntmp0 = getblockhash(123456);\r\ntmp1 = getblock(tmp0);\r\n```\r\nIn contrast to simple nesting of calls, which would be the alternative extension, this also allows for more complex composition, and re-use of values.\r\n\r\nReturning:\r\n```javascript\r\n[\r\n{\r\n    \"id\": 0,\r\n    \"error\": null,\r\n    \"result\": \"0000000000002917ed80650c6174aac8dfc46f5fe36480aaef682ff6cd83c3ca\"\r\n},\r\n{\r\n    \"id\": 1,\r\n    \"error\": null,\r\n    \"result\": {\r\n        \"hash\": ...,\r\n        \"confirmations\": ...,\r\n        ...\r\n    }\r\n}\r\n]\r\n```",
      "created_at" : "2016-08-13T09:09:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8457#issuecomment-239611262",
      "id" : 239611262,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8457",
      "updated_at" : "2016-08-13T09:54:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/239611262",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
