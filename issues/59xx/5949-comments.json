[
   {
      "body" : "Is there any reason to be embedding a copy of this code rather than using *some* library? This isn't even consensus-critical...",
      "created_at" : "2015-03-27T01:13:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5949#issuecomment-86781942",
      "id" : 86781942,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5949",
      "updated_at" : "2015-03-27T01:13:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/86781942",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@luke-jr Well we're ending up with our own implementation of AES either way, either through #5885 or this. \r\n\r\nYou do have a point that we should not start importing all non-consensus critical dependencies as well. NIH syndrome is an enduring source of irritation to me. But using an external crypto library just for AES is also undesirable. Low-level crypto code is very stable, it is unlikely to require maintenance, so doesn't add to the maintenance burden much.\r\n",
      "created_at" : "2015-03-27T07:14:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5949#issuecomment-86851812",
      "id" : 86851812,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5949",
      "updated_at" : "2015-03-27T07:15:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/86851812",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5949#discussion_r27597011"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5949"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/27597011"
         }
      },
      "body" : "'int' and 'size_type' comparison.\r\nGives a clang warning.",
      "commit_id" : "43d43081be8294d3f5d49484a03cf6cc6304d994",
      "created_at" : "2015-04-01T18:32:10Z",
      "diff_hunk" : "@@ -47,57 +73,40 @@ bool CCrypter::SetKey(const CKeyingMaterial& chNewKey, const std::vector<unsigne\n     return true;\n }\n \n-bool CCrypter::Encrypt(const CKeyingMaterial& vchPlaintext, std::vector<unsigned char> &vchCiphertext)\n+bool CCrypter::Encrypt(const CKeyingMaterial& vchPlaintext, std::vector<unsigned char> &vchCiphertext) const\n {\n     if (!fKeySet)\n         return false;\n \n     // max ciphertext len for a n bytes of plaintext is\n-    // n + AES_BLOCK_SIZE - 1 bytes\n+    // n + AES_BLOCKSIZE bytes\n     int nLen = vchPlaintext.size();\n-    int nCLen = nLen + AES_BLOCK_SIZE, nFLen = 0;\n-    vchCiphertext = std::vector<unsigned char> (nCLen);\n-\n-    EVP_CIPHER_CTX ctx;\n+    vchCiphertext = std::vector<unsigned char> (nLen + AES_BLOCKSIZE);\n \n-    bool fOk = true;\n-\n-    EVP_CIPHER_CTX_init(&ctx);\n-    if (fOk) fOk = EVP_EncryptInit_ex(&ctx, EVP_aes_256_cbc(), NULL, chKey, chIV) != 0;\n-    if (fOk) fOk = EVP_EncryptUpdate(&ctx, &vchCiphertext[0], &nCLen, &vchPlaintext[0], nLen) != 0;\n-    if (fOk) fOk = EVP_EncryptFinal_ex(&ctx, (&vchCiphertext[0]) + nCLen, &nFLen) != 0;\n-    EVP_CIPHER_CTX_cleanup(&ctx);\n-\n-    if (!fOk) return false;\n+    AES256CBCEncrypt enc(chKey, chIV, true);\n+    nLen = enc.Encrypt(&vchPlaintext[0], vchPlaintext.size(), &vchCiphertext[0]);\n+    if(nLen < vchPlaintext.size())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5949#discussion_r27597011",
      "id" : 27597011,
      "original_commit_id" : "43d43081be8294d3f5d49484a03cf6cc6304d994",
      "original_position" : 95,
      "path" : "src/wallet/crypter.cpp",
      "position" : 95,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5949",
      "updated_at" : "2015-04-01T18:32:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/27597011",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Tests are broken on mac osx. Could be mac only because travis did not report any issues. Wondering how this behaves on windows.\r\n\r\nmake check log: https://gist.github.com/jonasschnelli/a8aaf63a219f010dbc1f\r\nCompile log: https://gist.github.com/jonasschnelli/8f947da1148b79950ead\r\n\r\nI think further test does not make sense unless the unit-tests are running through.",
      "created_at" : "2015-04-01T18:52:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5949#issuecomment-88593530",
      "id" : 88593530,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5949",
      "updated_at" : "2015-04-01T18:52:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88593530",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "@jonasschnelli That should fix your issue. It wasn't actually related to osx.\r\n\r\nThe tests turned up an unintended change in openssl behavior for version 1.0.1j, which was later reverted for 1.0.1k. It should be harmless since it only affects the output of failed decrypts which shouldn't be used anyway, but the tests here go to extra lengths to ensure that our output always matches openssl's.\r\n\r\nThanks for testing and reporting, that was a fun one to track down.",
      "created_at" : "2015-04-02T15:58:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5949#issuecomment-88958209",
      "id" : 88958209,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5949",
      "updated_at" : "2015-04-02T15:58:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/88958209",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   }
]
