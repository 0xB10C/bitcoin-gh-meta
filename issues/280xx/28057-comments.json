[
   {
      "author_association" : "MEMBER",
      "body" : "Now trying to start the program just fails on startup:\r\n\r\n```\r\nError: Unrecognized descriptor found. Loading wallet ....../wallet.dat\r\n\r\nThe wallet might had been created on a newer version.\r\nPlease try running the latest software version.\r\n\r\n",
      "created_at" : "2023-07-09T10:39:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28057#issuecomment-1627675932",
      "id" : 1627675932,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28057",
      "node_id" : "IC_kwDOABII585hBF0c",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1627675932/reactions"
      },
      "updated_at" : "2023-07-09T10:39:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1627675932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "To recover from the error, use the wallet backup. Can find it inside the directory of the wallet that you are trying to migrate e.g. `/wallets/wallet_name/wallet_name-<timestamp>.legacy.bak`.\r\n\r\nThe issue seems to be related to one of your imported scripts. Would be good to gather more information about the script type. So we can check under which circumstances the legacy spkm `IsMine` return false for a script contained by the wallet.\r\n\r\nIf you can, try applying this patch and re-run the migration process:\r\n\r\n```diff\r\ndiff --git a/src/wallet/scriptpubkeyman.cpp b/src/wallet/scriptpubkeyman.cpp\r\n--- a/src/wallet/scriptpubkeyman.cpp\t(revision 79e8247ddb166f9b980f40249b7372a502402a4d)\r\n+++ b/src/wallet/scriptpubkeyman.cpp\t(date 1688915136527)\r\n@@ -1912,6 +1912,9 @@\r\n         for (const CScript& desc_spk : desc_spks) {\r\n             auto del_it = spks.find(desc_spk);\r\n             assert(del_it != spks.end());\r\n+            if (IsMine(desc_spk) != ISMINE_NO) {\r\n+                assert(desc);\r\n+                LogPrintf(\"%s: not mine script: %s\\n\", __func__, desc->ToString());\r\n+            }\r\n             assert(IsMine(desc_spk) != ISMINE_NO);\r\n             it = spks.erase(del_it);\r\n         }\r\n```",
      "created_at" : "2023-07-09T15:22:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28057#issuecomment-1627746019",
      "id" : 1627746019,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28057",
      "node_id" : "IC_kwDOABII585hBW7j",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1627746019/reactions"
      },
      "updated_at" : "2023-07-09T15:22:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1627746019",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I tried on 25.0, where it will just fill the storage at full speed in a never ending loop (aborted after 30 minutes)\r\n\r\n![Untitled_w](https://github.com/bitcoin/bitcoin/assets/6399679/67667a1b-5398-4332-93c9-a17cdcb173af)\r\n",
      "created_at" : "2023-07-10T08:14:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28057#issuecomment-1628461546",
      "id" : 1628461546,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28057",
      "node_id" : "IC_kwDOABII585hEFnq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1628461546/reactions"
      },
      "updated_at" : "2023-07-10T08:14:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1628461546",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The wallet version is `139900`, not sure if relevant.\r\n\r\n```\r\n2023-07-10T08:19:38Z [qt-rpcconsole] [wallet/scriptpubkeyman.cpp:1917] [MigrateToDescriptor] MigrateToDescriptor: not mine script: addr(mqRzyzrW7DPGT1KZN2mLuyGPVUugpfEVPW)#4ndsysze\r\nbitcoin-qt: wallet/scriptpubkeyman.cpp:1919: std::optional<MigrationData> wallet::LegacyScriptPubKeyMan::MigrateToDescriptor(): Assertion `IsMine(desc_spk) != ISMINE_NO' failed.\r\n",
      "created_at" : "2023-07-10T08:20:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28057#issuecomment-1628476666",
      "id" : 1628476666,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28057",
      "node_id" : "IC_kwDOABII585hEJT6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1628476666/reactions"
      },
      "updated_at" : "2023-07-10T08:41:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1628476666",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Could you provide the `getaddressinfo mqRzyzrW7DPGT1KZN2mLuyGPVUugpfEVPW` output please.\r\n\r\nAnd also, do you have steps to reproduce it? how did you import that address?",
      "created_at" : "2023-07-10T14:31:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28057#issuecomment-1629096788",
      "id" : 1629096788,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28057",
      "node_id" : "IC_kwDOABII585hGgtU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1629096788/reactions"
      },
      "updated_at" : "2023-07-10T14:31:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1629096788",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "No idea where it is from. Apparently it is from a \"test_2\" :sweat_smile: \r\n\r\n```\r\n{\r\n  \"address\": \"mqRzyzrW7DPGT1KZN2mLuyGPVUugpfEVPW\",\r\n  \"scriptPubKey\": \"76a9146cc16c24e249bab4384d4a759fe53ab23227de1988ac\",\r\n  \"ismine\": false,\r\n  \"solvable\": false,\r\n  \"iswatchonly\": true,\r\n  \"isscript\": false,\r\n  \"iswitness\": false,\r\n  \"ischange\": false,\r\n  \"timestamp\": 0,\r\n  \"labels\": [\r\n    \"test_2\"\r\n  ]\r\n}",
      "created_at" : "2023-07-10T14:38:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28057#issuecomment-1629109069",
      "id" : 1629109069,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28057",
      "node_id" : "IC_kwDOABII585hGjtN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 1,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1629109069/reactions"
      },
      "updated_at" : "2023-07-10T14:38:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1629109069",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ok, found the `Unrecognized descriptor found` error cause. You might have imported a hex script (with the `p2sh` flag enabled) and the migration process translated into a `sh(addr(mqRzyzrW7DPGT1KZN2mLuyGPVUugpfEVPW))#0ezg4j29` descriptor. Which isn't a valid descriptor because the `addr()` func can only appear at the top level.\r\n\r\nThe assertion cause is still unknown but hey, one bug less at least :). Fixing it..",
      "created_at" : "2023-07-10T15:06:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28057#issuecomment-1629158947",
      "id" : 1629158947,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28057",
      "node_id" : "IC_kwDOABII585hGv4j",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1629158947/reactions"
      },
      "updated_at" : "2023-07-10T15:30:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1629158947",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   }
]
