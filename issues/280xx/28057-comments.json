[
   {
      "author_association" : "MEMBER",
      "body" : "Now trying to start the program just fails on startup:\r\n\r\n```\r\nError: Unrecognized descriptor found. Loading wallet ....../wallet.dat\r\n\r\nThe wallet might had been created on a newer version.\r\nPlease try running the latest software version.\r\n\r\n",
      "created_at" : "2023-07-09T10:39:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28057#issuecomment-1627675932",
      "id" : 1627675932,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28057",
      "node_id" : "IC_kwDOABII585hBF0c",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1627675932/reactions"
      },
      "updated_at" : "2023-07-09T10:39:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1627675932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "To recover from the error, use the wallet backup. Can find it inside the directory of the wallet that you are trying to migrate e.g. `/wallets/wallet_name/wallet_name-<timestamp>.legacy.bak`.\r\n\r\nThe issue seems to be related to one of your imported scripts. Would be good to gather more information about the script type. So we can check under which circumstances the legacy spkm `IsMine` return false for a script contained by the wallet.\r\n\r\nIf you can, try applying this patch and re-run the migration process:\r\n\r\n```diff\r\ndiff --git a/src/wallet/scriptpubkeyman.cpp b/src/wallet/scriptpubkeyman.cpp\r\n--- a/src/wallet/scriptpubkeyman.cpp\t(revision 79e8247ddb166f9b980f40249b7372a502402a4d)\r\n+++ b/src/wallet/scriptpubkeyman.cpp\t(date 1688915136527)\r\n@@ -1912,6 +1912,9 @@\r\n         for (const CScript& desc_spk : desc_spks) {\r\n             auto del_it = spks.find(desc_spk);\r\n             assert(del_it != spks.end());\r\n+            if (IsMine(desc_spk) != ISMINE_NO) {\r\n+                assert(desc);\r\n+                LogPrintf(\"%s: not mine script: %s\\n\", __func__, desc->ToString());\r\n+            }\r\n             assert(IsMine(desc_spk) != ISMINE_NO);\r\n             it = spks.erase(del_it);\r\n         }\r\n```",
      "created_at" : "2023-07-09T15:22:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/28057#issuecomment-1627746019",
      "id" : 1627746019,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28057",
      "node_id" : "IC_kwDOABII585hBW7j",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1627746019/reactions"
      },
      "updated_at" : "2023-07-09T15:22:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1627746019",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   }
]
