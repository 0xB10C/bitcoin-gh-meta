[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [dergoegge](https://github.com/bitcoin/bitcoin/pull/25781#issuecomment-1284337076), [fanquake](https://github.com/bitcoin/bitcoin/pull/25781#issuecomment-1341049253) |\n| Stale ACK | [w0xlt](https://github.com/bitcoin/bitcoin/pull/25781#pullrequestreview-1080847265), [TheCharlatan](https://github.com/bitcoin/bitcoin/pull/25781#pullrequestreview-1111545689) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26762](https://github.com/bitcoin/bitcoin/pull/26762) (refactor: Make `CCheckQueue` RAII-styled by hebasto)\n* [#26251](https://github.com/bitcoin/bitcoin/pull/26251) (refactor: add kernel/cs_main.h by fanquake)\n* [#25862](https://github.com/bitcoin/bitcoin/pull/25862) (refactor, kernel: Remove gArgs accesses from dbwrapper and txdb by ryanofsky)\n* [#25740](https://github.com/bitcoin/bitcoin/pull/25740) (assumeutxo: background validation completion by jamesob)\n* [#25665](https://github.com/bitcoin/bitcoin/pull/25665) (refactor: Add util::Result failure values, multiple error and warning messages by ryanofsky)\n* [#25574](https://github.com/bitcoin/bitcoin/pull/25574) (validation: Improve error handling when VerifyDB fails due to insufficient dbcache by mzumsande)\n* [#25386](https://github.com/bitcoin/bitcoin/pull/25386) (refactor: Extract MIB_BYTES constant for init.cpp by Empact)\n* [#25193](https://github.com/bitcoin/bitcoin/pull/25193) (indexes: Read the locator's top block during init, allow interaction with reindex-chainstate by mzumsande)\n* [#19463](https://github.com/bitcoin/bitcoin/pull/19463) (Prune locks by luke-jr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-08-05T04:13:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#issuecomment-1206022284",
      "id" : 1206022284,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25781",
      "node_id" : "IC_kwDOABII585H4nCM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1206022284/reactions"
      },
      "updated_at" : "2023-01-07T01:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1206022284",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "rebased",
      "created_at" : "2022-08-12T07:41:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#issuecomment-1212824645",
      "id" : 1212824645,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25781",
      "node_id" : "IC_kwDOABII585ISjxF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1212824645/reactions"
      },
      "updated_at" : "2022-08-12T07:41:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1212824645",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-08-22T10:37:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#issuecomment-1222170767",
      "id" : 1222170767,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25781",
      "node_id" : "IC_kwDOABII585I2NiP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1222170767/reactions"
      },
      "updated_at" : "2022-08-22T10:37:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1222170767",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased",
      "created_at" : "2022-08-22T12:51:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#issuecomment-1222315749",
      "id" : 1222315749,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25781",
      "node_id" : "IC_kwDOABII585I2w7l",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1222315749/reactions"
      },
      "updated_at" : "2022-08-22T12:51:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1222315749",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-08-25T08:14:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#issuecomment-1226931098",
      "id" : 1226931098,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25781",
      "node_id" : "IC_kwDOABII585JIXua",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1226931098/reactions"
      },
      "updated_at" : "2022-08-25T08:14:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1226931098",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'll rebase this after \"https://github.com/bitcoin/bitcoin/pull/25704 (refactor: Remove almost all validation option globals by MarcoFalke)\"",
      "created_at" : "2022-09-19T12:48:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#issuecomment-1250975663",
      "id" : 1250975663,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25781",
      "node_id" : "IC_kwDOABII585KkF-v",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1250975663/reactions"
      },
      "updated_at" : "2022-09-19T12:48:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1250975663",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2022-10-19T17:20:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#issuecomment-1284337076",
      "id" : 1284337076,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25781",
      "node_id" : "IC_kwDOABII585MjW20",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1284337076/reactions"
      },
      "updated_at" : "2022-10-19T17:20:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1284337076",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2022-12-07T14:29:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#issuecomment-1341049253",
      "id" : 1341049253,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25781",
      "node_id" : "IC_kwDOABII585P7sml",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1341049253/reactions"
      },
      "updated_at" : "2022-12-07T14:29:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1341049253",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1061323795"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061323795"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I would prefer if these were private and only accessed through methods on `BlockManager`.",
      "commit_id" : "fa2062649564a60f760be1fd0c72358ec54ae70f",
      "created_at" : "2023-01-04T10:10:07Z",
      "diff_hunk" : "@@ -143,6 +138,19 @@ class BlockManager\n     std::unordered_map<std::string, PruneLockInfo> m_prune_locks GUARDED_BY(::cs_main);\n \n public:\n+    using Options = kernel::BlockManagerOpts;\n+\n+    explicit BlockManager(const Options& opts)\n+        : m_prune_mode{opts.prune_mode},\n+          m_prune_target{opts.prune_target} {};\n+\n+    std::atomic<bool> m_importing{false};\n+    /** Pruning-related variables and constants */\n+    /** True if we're running in -prune mode. */\n+    const bool m_prune_mode;\n+    /** Number of bytes of block files that we're trying to stay below. */\n+    const uint64_t m_prune_target;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1061323795",
      "id" : 1061323795,
      "line" : 152,
      "node_id" : "PRRC_kwDOABII584_QoQT",
      "original_commit_id" : "fa2062649564a60f760be1fd0c72358ec54ae70f",
      "original_line" : 152,
      "original_position" : 37,
      "original_start_line" : 147,
      "path" : "src/node/blockstorage.h",
      "position" : 37,
      "pull_request_review_id" : 1235638193,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061323795/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 147,
      "start_side" : "RIGHT",
      "updated_at" : "2023-01-04T10:20:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061323795",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1061324177"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061324177"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    [[nodiscard]] bool LoadingBlocks() const\r\n```",
      "commit_id" : "fa2062649564a60f760be1fd0c72358ec54ae70f",
      "created_at" : "2023-01-04T10:10:34Z",
      "diff_hunk" : "@@ -177,6 +185,11 @@ class BlockManager\n     /** Store block on disk. If dbp is not nullptr, then it provides the known position of the block within a block file on disk. */\n     FlatFilePos SaveBlockToDisk(const CBlock& block, int nHeight, CChain& active_chain, const CChainParams& chainparams, const FlatFilePos* dbp);\n \n+    [[nodiscard]] bool LoadingBlocks()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1061324177",
      "id" : 1061324177,
      "line" : 188,
      "node_id" : "PRRC_kwDOABII584_QoWR",
      "original_commit_id" : "fa2062649564a60f760be1fd0c72358ec54ae70f",
      "original_line" : 188,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 46,
      "pull_request_review_id" : 1235638193,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061324177/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-01-04T10:20:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061324177",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1061404037"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061404037"
         }
      },
      "author_association" : "MEMBER",
      "body" : "See also #26664.",
      "commit_id" : "fa2062649564a60f760be1fd0c72358ec54ae70f",
      "created_at" : "2023-01-04T11:50:58Z",
      "diff_hunk" : "@@ -177,6 +185,11 @@ class BlockManager\n     /** Store block on disk. If dbp is not nullptr, then it provides the known position of the block within a block file on disk. */\n     FlatFilePos SaveBlockToDisk(const CBlock& block, int nHeight, CChain& active_chain, const CChainParams& chainparams, const FlatFilePos* dbp);\n \n+    [[nodiscard]] bool LoadingBlocks()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1061404037",
      "id" : 1061404037,
      "in_reply_to_id" : 1061324177,
      "line" : 188,
      "node_id" : "PRRC_kwDOABII584_Q72F",
      "original_commit_id" : "fa2062649564a60f760be1fd0c72358ec54ae70f",
      "original_line" : 188,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : 46,
      "pull_request_review_id" : 1235761983,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061404037/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-01-04T11:50:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1061404037",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-01-16T15:04:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#issuecomment-1384188232",
      "id" : 1384188232,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25781",
      "node_id" : "IC_kwDOABII585SgQlI",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1384188232/reactions"
      },
      "updated_at" : "2023-01-16T15:04:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1384188232",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1090365212"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1090365212"
         }
      },
      "author_association" : "MEMBER",
      "body" : "already done in master",
      "commit_id" : "fac85d8a93be71e919e01511f2bff7e684932b6d",
      "created_at" : "2023-01-30T09:28:00Z",
      "diff_hunk" : "@@ -177,6 +185,11 @@ class BlockManager\n     /** Store block on disk. If dbp is not nullptr, then it provides the known position of the block within a block file on disk. */\n     FlatFilePos SaveBlockToDisk(const CBlock& block, int nHeight, CChain& active_chain, const CChainParams& chainparams, const FlatFilePos* dbp);\n \n+    [[nodiscard]] bool LoadingBlocks()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1090365212",
      "id" : 1090365212,
      "in_reply_to_id" : 1061324177,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585A_acc",
      "original_commit_id" : "fa2062649564a60f760be1fd0c72358ec54ae70f",
      "original_line" : 188,
      "original_position" : 46,
      "original_start_line" : null,
      "path" : "src/node/blockstorage.h",
      "position" : null,
      "pull_request_review_id" : 1274765165,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1090365212/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-01-30T09:28:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1090365212",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1090365983"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1090365983"
         }
      },
      "author_association" : "MEMBER",
      "body" : "done, I think",
      "commit_id" : "fac85d8a93be71e919e01511f2bff7e684932b6d",
      "created_at" : "2023-01-30T09:28:39Z",
      "diff_hunk" : "@@ -143,6 +138,19 @@ class BlockManager\n     std::unordered_map<std::string, PruneLockInfo> m_prune_locks GUARDED_BY(::cs_main);\n \n public:\n+    using Options = kernel::BlockManagerOpts;\n+\n+    explicit BlockManager(const Options& opts)\n+        : m_prune_mode{opts.prune_mode},\n+          m_prune_target{opts.prune_target} {};\n+\n+    std::atomic<bool> m_importing{false};\n+    /** Pruning-related variables and constants */\n+    /** True if we're running in -prune mode. */\n+    const bool m_prune_mode;\n+    /** Number of bytes of block files that we're trying to stay below. */\n+    const uint64_t m_prune_target;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1090365983",
      "id" : 1090365983,
      "in_reply_to_id" : 1061323795,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585A_aof",
      "original_commit_id" : "fa2062649564a60f760be1fd0c72358ec54ae70f",
      "original_line" : 152,
      "original_position" : 37,
      "original_start_line" : 147,
      "path" : "src/node/blockstorage.h",
      "position" : null,
      "pull_request_review_id" : 1274766879,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1090365983/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2023-01-30T09:28:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1090365983",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1090368226"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1090368226"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in fa710f1aa3280532279ddaa510826e6bd2d3d1c8: I wonder if this is a use-after-move and why clang-tidy does not see it",
      "commit_id" : "fac85d8a93be71e919e01511f2bff7e684932b6d",
      "created_at" : "2023-01-30T09:30:40Z",
      "diff_hunk" : "@@ -5306,7 +5306,7 @@ static ChainstateManager::Options&& Flatten(ChainstateManager::Options&& opts)\n     return std::move(opts);\n }\n \n-ChainstateManager::ChainstateManager(Options options) : m_options{Flatten(std::move(options))} {}\n+ChainstateManager::ChainstateManager(Options options) : m_options{Flatten(std::move(options))}, m_blockman{options.blockman_opts} {}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1090368226",
      "id" : 1090368226,
      "line" : 5309,
      "node_id" : "PRRC_kwDOABII585A_bLi",
      "original_commit_id" : "fa710f1aa3280532279ddaa510826e6bd2d3d1c8",
      "original_line" : 5309,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 5,
      "pull_request_review_id" : 1274771777,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1090368226/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-01-30T09:30:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1090368226",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1090485959"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1090485959"
         }
      },
      "author_association" : "MEMBER",
      "body" : "From https://en.cppreference.com/w/cpp/language/constructor#Initialization_order:\r\n\r\n> non-static data member are initialized in order of declaration in the class definition.\r\n\r\nSo according to that I'd say yes, this is a use after move (as m_options is declared before m_blockman).\r\n\r\n(also: https://github.com/llvm/llvm-project/issues/56195)\r\n\r\n",
      "commit_id" : "fac85d8a93be71e919e01511f2bff7e684932b6d",
      "created_at" : "2023-01-30T11:11:58Z",
      "diff_hunk" : "@@ -5306,7 +5306,7 @@ static ChainstateManager::Options&& Flatten(ChainstateManager::Options&& opts)\n     return std::move(opts);\n }\n \n-ChainstateManager::ChainstateManager(Options options) : m_options{Flatten(std::move(options))} {}\n+ChainstateManager::ChainstateManager(Options options) : m_options{Flatten(std::move(options))}, m_blockman{options.blockman_opts} {}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25781#discussion_r1090485959",
      "id" : 1090485959,
      "in_reply_to_id" : 1090368226,
      "line" : 5309,
      "node_id" : "PRRC_kwDOABII585A_37H",
      "original_commit_id" : "fa710f1aa3280532279ddaa510826e6bd2d3d1c8",
      "original_line" : 5309,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 5,
      "pull_request_review_id" : 1274948743,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25781",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1090485959/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-01-30T11:11:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1090485959",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   }
]
