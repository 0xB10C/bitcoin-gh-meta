[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Tested on macOS.\r\n\r\nNeeds update for `-printtoconsole` help text.",
      "created_at" : "2018-03-14T22:32:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12689#issuecomment-373197138",
      "id" : 373197138,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12689",
      "updated_at" : "2018-03-14T22:32:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373197138",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12689#discussion_r174632036"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12689"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/174632036"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I know you said that MingW includes a compatible unistd.h version for Windows but on Visual Studio/msvc isatty is deprecated and replaced by _isatty. Also STDOUT_FILENO (1) is not defined. There's currently some PRs for msvc support so just a heads up that this will likely break things there. #11526 and #11873 ",
      "commit_id" : "92059163e8f71dfaa18acaab4e71ddff84f1fb03",
      "created_at" : "2018-03-14T22:39:52Z",
      "diff_hunk" : "@@ -336,6 +336,11 @@ static std::string LogTimestampStr(const std::string &str, std::atomic_bool *fSt\n     return strStamped;\n }\n \n+bool IsStdoutTty()\n+{\n+    return isatty(STDOUT_FILENO);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12689#discussion_r174632036",
      "id" : 174632036,
      "original_commit_id" : "92059163e8f71dfaa18acaab4e71ddff84f1fb03",
      "original_position" : 6,
      "path" : "src/util.cpp",
      "position" : 6,
      "pull_request_review_id" : 104024459,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12689",
      "updated_at" : "2018-03-14T22:40:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/174632036",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6394033?v=4",
         "events_url" : "https://api.github.com/users/donaloconnor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/donaloconnor/followers",
         "following_url" : "https://api.github.com/users/donaloconnor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/donaloconnor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/donaloconnor",
         "id" : 6394033,
         "login" : "donaloconnor",
         "organizations_url" : "https://api.github.com/users/donaloconnor/orgs",
         "received_events_url" : "https://api.github.com/users/donaloconnor/received_events",
         "repos_url" : "https://api.github.com/users/donaloconnor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/donaloconnor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/donaloconnor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/donaloconnor"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Strong concept ACK. Very nice usability improvement! I'm also running `bitcoind` in the foreground mode for the most part.\r\n\r\nWhat about reducing the number of `\\n`:s from 20 to say 5? That should be more than enough to distinguish between to subsequent executions.",
      "created_at" : "2018-03-14T22:56:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12689#issuecomment-373202394",
      "id" : 373202394,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12689",
      "updated_at" : "2018-03-14T22:56:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373202394",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Just a few concerns (Mainly on Windows)\r\n\r\n1. There's now no way of turning the stdout logging off when launched in foreground. It's either on or (on by default) \r\n2. On Windows output will always be shown now since deamonising isn't possible?. (AFAIK it's not possible to run bitcoind as a windows service?\r\n3. stdout isn't buffered very well (if at all?) so it can potentially have a perf penalty (especially if custom high freq custom logging is enabled)\r\n\r\nBTW fPrintToDebugLog is set to true and not changed ever so the code can be simplified.",
      "created_at" : "2018-03-14T23:05:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12689#issuecomment-373204344",
      "id" : 373204344,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12689",
      "updated_at" : "2018-03-14T23:05:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373204344",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6394033?v=4",
         "events_url" : "https://api.github.com/users/donaloconnor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/donaloconnor/followers",
         "following_url" : "https://api.github.com/users/donaloconnor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/donaloconnor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/donaloconnor",
         "id" : 6394033,
         "login" : "donaloconnor",
         "organizations_url" : "https://api.github.com/users/donaloconnor/orgs",
         "received_events_url" : "https://api.github.com/users/donaloconnor/received_events",
         "repos_url" : "https://api.github.com/users/donaloconnor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/donaloconnor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/donaloconnor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/donaloconnor"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK, cool :+1:.",
      "created_at" : "2018-03-14T23:08:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12689#issuecomment-373204889",
      "id" : 373204889,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12689",
      "updated_at" : "2018-03-14T23:08:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373204889",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Now that I've thought about this more I don't think the `isatty()` check is necessary. The situation where it wouldn't be a TTY would be if you were running commands like:\r\n\r\n```bash\r\n# stdout is a pipe, not a TTY.\r\nbitcoind | less\r\n\r\n# stdout is a file, not a TTY.\r\nbitcoind > redundantcopyofdebug.log\r\n```\r\n\r\nI don't think either of these are things people are going to actually run, but if they did they would probably expect to see output printed. The usual use of `isatty()` is actually to test for features like using console escape sequences (e.g. the ASCII \"bell\" character) or to tell if it makes sense to print ANSI color codes.",
      "created_at" : "2018-03-14T23:22:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12689#issuecomment-373207731",
      "id" : 373207731,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12689",
      "updated_at" : "2018-03-14T23:22:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373207731",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/2734?v=4",
         "events_url" : "https://api.github.com/users/eklitzke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eklitzke/followers",
         "following_url" : "https://api.github.com/users/eklitzke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eklitzke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eklitzke",
         "id" : 2734,
         "login" : "eklitzke",
         "organizations_url" : "https://api.github.com/users/eklitzke/orgs",
         "received_events_url" : "https://api.github.com/users/eklitzke/received_events",
         "repos_url" : "https://api.github.com/users/eklitzke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eklitzke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eklitzke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "New version (with squashed commit) removes the `isatty()` check and reduces the number of newlines we print from 20 to 5. I've also updated the PR description to remove the commentary about `isatty()`.",
      "created_at" : "2018-03-14T23:32:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12689#issuecomment-373209436",
      "id" : 373209436,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12689",
      "updated_at" : "2018-03-14T23:32:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373209436",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/2734?v=4",
         "events_url" : "https://api.github.com/users/eklitzke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eklitzke/followers",
         "following_url" : "https://api.github.com/users/eklitzke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eklitzke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eklitzke",
         "id" : 2734,
         "login" : "eklitzke",
         "organizations_url" : "https://api.github.com/users/eklitzke/orgs",
         "received_events_url" : "https://api.github.com/users/eklitzke/received_events",
         "repos_url" : "https://api.github.com/users/eklitzke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eklitzke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eklitzke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "My understanding is now logging will not be sent to the *log file* unless -daemon is passed via command line. If that's the case won't this be unexpected and annoying behavior?\r\n\r\nLogPrintStr only prints to one or the other.\r\n\r\nI'm on the phone so it's difficult to check",
      "created_at" : "2018-03-15T00:30:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12689#issuecomment-373220096",
      "id" : 373220096,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12689",
      "updated_at" : "2018-03-15T00:30:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373220096",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6394033?v=4",
         "events_url" : "https://api.github.com/users/donaloconnor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/donaloconnor/followers",
         "following_url" : "https://api.github.com/users/donaloconnor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/donaloconnor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/donaloconnor",
         "id" : 6394033,
         "login" : "donaloconnor",
         "organizations_url" : "https://api.github.com/users/donaloconnor/orgs",
         "received_events_url" : "https://api.github.com/users/donaloconnor/received_events",
         "repos_url" : "https://api.github.com/users/donaloconnor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/donaloconnor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/donaloconnor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/donaloconnor"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Not sure this makes sense. I don't know of any other software that guesses stdout vs log based on whether stdout is a tty. It seems likely to break users who do `bitcoin-qt &`\r\n\r\nWhy not just put `printtoconsole=1` in bitcoin.conf if you prefer it by default?",
      "created_at" : "2018-03-15T00:40:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12689#issuecomment-373221889",
      "id" : 373221889,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12689",
      "updated_at" : "2018-03-15T00:40:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373221889",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@lukejr The code no longer uses `isatty()`, I removed that code. Adding `printtoconsole=1` to `bitcoin.conf` has the side effect that it completely suppresses logging to `debug.log`, which is annoying if sometimes you run bitcoin as a daemon and sometimes you run it in foreground mode.\r\n\r\nWe should probably change the `LogPrintf()` logic to log to both if both flags are set. But even in that case if you add `printtoconsole=1` to your bitcoin.conf file you'll get behavior where bitcoind would log all messages twice, with the stdout one going to `/dev/null`. This is harmless but inefficient.",
      "created_at" : "2018-03-15T01:35:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12689#issuecomment-373230941",
      "id" : 373230941,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12689",
      "updated_at" : "2018-03-15T01:35:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373230941",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/2734?v=4",
         "events_url" : "https://api.github.com/users/eklitzke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eklitzke/followers",
         "following_url" : "https://api.github.com/users/eklitzke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eklitzke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eklitzke",
         "id" : 2734,
         "login" : "eklitzke",
         "organizations_url" : "https://api.github.com/users/eklitzke/orgs",
         "received_events_url" : "https://api.github.com/users/eklitzke/received_events",
         "repos_url" : "https://api.github.com/users/eklitzke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eklitzke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eklitzke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@donaloconnor I also just noticed that which I think is bad behavior. Updated to make these flags independent (printing to console will not affect logging to debug.log).",
      "created_at" : "2018-03-15T01:38:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12689#issuecomment-373231442",
      "id" : 373231442,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12689",
      "updated_at" : "2018-03-15T01:38:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373231442",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/2734?v=4",
         "events_url" : "https://api.github.com/users/eklitzke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eklitzke/followers",
         "following_url" : "https://api.github.com/users/eklitzke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eklitzke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eklitzke",
         "id" : 2734,
         "login" : "eklitzke",
         "organizations_url" : "https://api.github.com/users/eklitzke/orgs",
         "received_events_url" : "https://api.github.com/users/eklitzke/received_events",
         "repos_url" : "https://api.github.com/users/eklitzke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eklitzke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eklitzke"
      }
   }
]
