[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The argument for keeping the block index in the data dir would be that in the vast majority of cases it means the block index will be on the same filesystem as the utxo database, and therefore we can rely on regular filesystem semantics regarding data ordering. If the block index and utxo database are on different filesystems then it's not possible to guarantee that one is ahead of the other without fully serializing the operations with fsync.\r\n\r\nI will try to look through the code more and think about this more closely. I think this change is fine the way the code currently works because the flushes are basically serialized anyway (and we fsync for block storage and block index updates), but this might become annoying long term.",
      "created_at" : "2018-03-10T16:25:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-372042436",
      "id" : 372042436,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-10T16:25:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372042436",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/2734?v=4",
         "events_url" : "https://api.github.com/users/eklitzke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eklitzke/followers",
         "following_url" : "https://api.github.com/users/eklitzke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eklitzke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eklitzke",
         "id" : 2734,
         "login" : "eklitzke",
         "organizations_url" : "https://api.github.com/users/eklitzke/orgs",
         "received_events_url" : "https://api.github.com/users/eklitzke/received_events",
         "repos_url" : "https://api.github.com/users/eklitzke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eklitzke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eklitzke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Added a commit (basically a one-liner) that will make the block index database stick in datadir.",
      "created_at" : "2018-03-11T04:43:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-372089163",
      "id" : 372089163,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-11T04:43:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372089163",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK Once you fix the python lint failure.",
      "created_at" : "2018-03-11T07:11:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-372094666",
      "id" : 372094666,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-11T07:11:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372094666",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/2734?v=4",
         "events_url" : "https://api.github.com/users/eklitzke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eklitzke/followers",
         "following_url" : "https://api.github.com/users/eklitzke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eklitzke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eklitzke",
         "id" : 2734,
         "login" : "eklitzke",
         "organizations_url" : "https://api.github.com/users/eklitzke/orgs",
         "received_events_url" : "https://api.github.com/users/eklitzke/received_events",
         "repos_url" : "https://api.github.com/users/eklitzke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eklitzke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eklitzke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK.",
      "created_at" : "2018-03-11T19:05:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-372140158",
      "id" : 372140158,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-11T19:05:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372140158",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173667736"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173667736"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I am wondering why this should be net specific, considering that we have the same concept for wallets and the `GetWalletDir` is not net specific.",
      "commit_id" : "a1926362ecb3c354ae338ef7d7020daf78f980c9",
      "created_at" : "2018-03-11T20:13:01Z",
      "diff_hunk" : "@@ -182,6 +182,7 @@ void ReleaseDirectoryLocks();\n \n bool TryCreateDirectories(const fs::path& p);\n fs::path GetDefaultDataDir();\n+const fs::path &GetBlocksDir(bool fNetSpecific = true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173667736",
      "id" : 173667736,
      "original_commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "original_position" : 4,
      "path" : "src/util.h",
      "position" : 4,
      "pull_request_review_id" : 102894584,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653",
      "updated_at" : "2018-03-20T02:33:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173667736",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173841457"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173841457"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Remove `;`.",
      "commit_id" : "a1926362ecb3c354ae338ef7d7020daf78f980c9",
      "created_at" : "2018-03-12T15:37:23Z",
      "diff_hunk" : "@@ -0,0 +1,34 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2018 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the blocksdir option.\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, initialize_datadir\n+\n+import shutil\n+import os\n+\n+class BlocksdirTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def run_test(self):\n+        self.stop_node(0)\n+        node0path = os.path.join(self.options.tmpdir, \"node0\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173841457",
      "id" : 173841457,
      "original_commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "original_position" : 20,
      "path" : "test/functional/feature_blocksdir.py",
      "position" : null,
      "pull_request_review_id" : 103096628,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653",
      "updated_at" : "2018-03-20T02:33:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173841457",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173843918"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173843918"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Add\r\n```py\r\nblocksdir = os.path.join(self.options.tmpdir, \"blocksdir\")\r\n```\r\nand reuse here and below.",
      "commit_id" : "a1926362ecb3c354ae338ef7d7020daf78f980c9",
      "created_at" : "2018-03-12T15:44:09Z",
      "diff_hunk" : "@@ -0,0 +1,34 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2018 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the blocksdir option.\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, initialize_datadir\n+\n+import shutil\n+import os\n+\n+class BlocksdirTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def run_test(self):\n+        self.stop_node(0)\n+        node0path = os.path.join(self.options.tmpdir, \"node0\");\n+        shutil.rmtree(node0path)\n+        initialize_datadir(self.options.tmpdir, 0)\n+        self.log.info(\"Starting with non exiting blocksdir ...\")\n+        self.assert_start_raises_init_error(0, [\"-blocksdir=\"+self.options.tmpdir+ \"/blocksdir\"], \"Specified blocks director\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173843918",
      "id" : 173843918,
      "original_commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "original_position" : 24,
      "path" : "test/functional/feature_blocksdir.py",
      "position" : null,
      "pull_request_review_id" : 103096628,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653",
      "updated_at" : "2018-03-20T02:33:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173843918",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173847868"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173847868"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`\"blockindex\"`? Should be `\"blocks\" / \"index\"`?\r\n\r\nMaybe add `GetBlockIndexDir()`?",
      "commit_id" : "a1926362ecb3c354ae338ef7d7020daf78f980c9",
      "created_at" : "2018-03-12T15:54:39Z",
      "diff_hunk" : "@@ -147,7 +147,7 @@ size_t CCoinsViewDB::EstimateSize() const\n     return db.EstimateSize(DB_COIN, (char)(DB_COIN+1));\n }\n \n-CBlockTreeDB::CBlockTreeDB(size_t nCacheSize, bool fMemory, bool fWipe) : CDBWrapper(GetDataDir() / \"blocks\" / \"index\", nCacheSize, fMemory, fWipe) {\n+CBlockTreeDB::CBlockTreeDB(size_t nCacheSize, bool fMemory, bool fWipe) : CDBWrapper(gArgs.IsArgSet(\"-blocksdir\") ? GetDataDir() / \"blockindex\" : GetBlocksDir() / \"index\", nCacheSize, fMemory, fWipe) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173847868",
      "id" : 173847868,
      "original_commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "original_position" : 5,
      "path" : "src/txdb.cpp",
      "position" : null,
      "pull_request_review_id" : 103096628,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653",
      "updated_at" : "2018-03-20T02:33:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173847868",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Concept ACK, this would avoid some symlinking gymnastics I'm currently doing.\r\n(ref; #10922)",
      "created_at" : "2018-03-13T11:27:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-372633558",
      "id" : 372633558,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-13T11:28:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372633558",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK 34ec8e3, once lint issues are fixed.\r\n\r\nDoes what it says on the tin, seems like a useful feature.",
      "created_at" : "2018-03-13T13:35:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-372666695",
      "id" : 372666695,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-13T13:35:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372666695",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/287215?v=4",
         "events_url" : "https://api.github.com/users/hkjn/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hkjn/followers",
         "following_url" : "https://api.github.com/users/hkjn/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hkjn/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hkjn",
         "id" : 287215,
         "login" : "hkjn",
         "organizations_url" : "https://api.github.com/users/hkjn/orgs",
         "received_events_url" : "https://api.github.com/users/hkjn/received_events",
         "repos_url" : "https://api.github.com/users/hkjn/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hkjn/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hkjn/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hkjn"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I might have to retract my earlier statement, as @sipa says [here](https://github.com/bitcoin/bitcoin/pull/10922#issuecomment-317596359) that the blocks index and block files should be on the same filesystem, contradicting my earlier statement. I'm not sure if I understand that reasoning though, as we fsync after writing the block and before committing to the block index, which should be fine across filesystems. If it's really true that they need to be on the same filesystem that would be problematic in the future if we ever wanted to merge the block index and the chainstate index.",
      "created_at" : "2018-03-15T13:29:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-373375739",
      "id" : 373375739,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-15T13:29:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373375739",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/2734?v=4",
         "events_url" : "https://api.github.com/users/eklitzke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eklitzke/followers",
         "following_url" : "https://api.github.com/users/eklitzke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eklitzke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eklitzke",
         "id" : 2734,
         "login" : "eklitzke",
         "organizations_url" : "https://api.github.com/users/eklitzke/orgs",
         "received_events_url" : "https://api.github.com/users/eklitzke/received_events",
         "repos_url" : "https://api.github.com/users/eklitzke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eklitzke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eklitzke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r174784834"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/174784834"
         }
      },
      "author_association" : "OWNER",
      "body" : "Isn't the blocks directory *by definition* net specific?",
      "commit_id" : "a1926362ecb3c354ae338ef7d7020daf78f980c9",
      "created_at" : "2018-03-15T13:42:03Z",
      "diff_hunk" : "@@ -182,6 +182,7 @@ void ReleaseDirectoryLocks();\n \n bool TryCreateDirectories(const fs::path& p);\n fs::path GetDefaultDataDir();\n+const fs::path &GetBlocksDir(bool fNetSpecific = true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r174784834",
      "id" : 174784834,
      "in_reply_to_id" : 173667736,
      "original_commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "original_position" : 4,
      "path" : "src/util.h",
      "position" : 4,
      "pull_request_review_id" : 104204235,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653",
      "updated_at" : "2018-03-20T02:33:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/174784834",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "~~I think this is almost ready. Will test.~~ However, python-nanny wants you to fix:\r\n```\r\n./test/functional/feature_blocksdir.py:20:63: E703 statement ends with a semicolon\r\n^---- failure generated from contrib/devtools/lint-python.sh\r\n```",
      "created_at" : "2018-03-15T13:43:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-373379810",
      "id" : 373379810,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-15T19:32:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373379810",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r174905759"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/174905759"
         }
      },
      "author_association" : "OWNER",
      "body" : "Yes, this seems wrong.\r\nI tried providing my existing blocks directory:\r\n```\r\n$ src/bitcoind -testnet -blocksdir=/store2/tmp/bitcoin/testnet3/blocks -printtoconsole\r\n2018-03-15T19:29:04Z Opening LevelDB in /.../.bitcoin/testnet3/blockindex\r\n2018-03-15T19:29:04Z Opened LevelDB successfully\r\n...\r\n2018-03-15T19:29:05Z : Error initializing block database.\r\nPlease restart with -reindex or -reindex-chainstate to recover.\r\n: Error initializing block database.\r\nPlease restart with -reindex or -reindex-chainstate to recover.\r\n```\r\nThis fails. Shouldn't it  use the `index` directory within the `blocksdir`?",
      "commit_id" : "a1926362ecb3c354ae338ef7d7020daf78f980c9",
      "created_at" : "2018-03-15T19:31:54Z",
      "diff_hunk" : "@@ -147,7 +147,7 @@ size_t CCoinsViewDB::EstimateSize() const\n     return db.EstimateSize(DB_COIN, (char)(DB_COIN+1));\n }\n \n-CBlockTreeDB::CBlockTreeDB(size_t nCacheSize, bool fMemory, bool fWipe) : CDBWrapper(GetDataDir() / \"blocks\" / \"index\", nCacheSize, fMemory, fWipe) {\n+CBlockTreeDB::CBlockTreeDB(size_t nCacheSize, bool fMemory, bool fWipe) : CDBWrapper(gArgs.IsArgSet(\"-blocksdir\") ? GetDataDir() / \"blockindex\" : GetBlocksDir() / \"index\", nCacheSize, fMemory, fWipe) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r174905759",
      "id" : 174905759,
      "in_reply_to_id" : 173847868,
      "original_commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "original_position" : 5,
      "path" : "src/txdb.cpp",
      "position" : null,
      "pull_request_review_id" : 104349571,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653",
      "updated_at" : "2018-03-20T02:33:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/174905759",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK ",
      "created_at" : "2018-03-15T22:56:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-373548896",
      "id" : 373548896,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-15T22:57:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/373548896",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6394033?v=4",
         "events_url" : "https://api.github.com/users/donaloconnor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/donaloconnor/followers",
         "following_url" : "https://api.github.com/users/donaloconnor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/donaloconnor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/donaloconnor",
         "id" : 6394033,
         "login" : "donaloconnor",
         "organizations_url" : "https://api.github.com/users/donaloconnor/orgs",
         "received_events_url" : "https://api.github.com/users/donaloconnor/received_events",
         "repos_url" : "https://api.github.com/users/donaloconnor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/donaloconnor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/donaloconnor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/donaloconnor"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "> I might have to retract my earlier statement, as @sipa says here that the blocks index and block files should be on the same filesystem\r\n\r\nWouldn't this imply that we're better off without commit https://github.com/bitcoin/bitcoin/pull/12653/commits/4855b9e8365e0037fcd9a4c6796dea04efa019ec? That would keep the block index with the blocks, which is @sipa's preference.",
      "created_at" : "2018-03-19T15:09:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-374246044",
      "id" : 374246044,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-19T15:09:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/374246044",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r175640919"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/175640919"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Using the same directory looks most obvious correct, though, if you switch the blocks dir to a different path (with `-blocksdir=<path>`) users may run into troubles since the old blocks dir may still be in the datadir...\r\nBut I agree, lets keep \"block\" / \"Index\" for now... \r\nfixed.",
      "commit_id" : "a1926362ecb3c354ae338ef7d7020daf78f980c9",
      "created_at" : "2018-03-20T02:35:12Z",
      "diff_hunk" : "@@ -147,7 +147,7 @@ size_t CCoinsViewDB::EstimateSize() const\n     return db.EstimateSize(DB_COIN, (char)(DB_COIN+1));\n }\n \n-CBlockTreeDB::CBlockTreeDB(size_t nCacheSize, bool fMemory, bool fWipe) : CDBWrapper(GetDataDir() / \"blocks\" / \"index\", nCacheSize, fMemory, fWipe) {\n+CBlockTreeDB::CBlockTreeDB(size_t nCacheSize, bool fMemory, bool fWipe) : CDBWrapper(gArgs.IsArgSet(\"-blocksdir\") ? GetDataDir() / \"blockindex\" : GetBlocksDir() / \"index\", nCacheSize, fMemory, fWipe) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r175640919",
      "id" : 175640919,
      "in_reply_to_id" : 173847868,
      "original_commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "original_position" : 5,
      "path" : "src/txdb.cpp",
      "position" : null,
      "pull_request_review_id" : 105202445,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653",
      "updated_at" : "2018-03-20T02:35:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/175640919",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">> I might have to retract my earlier statement, as @sipa says here that the blocks index and block files should be on the same filesystem\r\n\r\n> Wouldn't this imply that we're better off without commit 4855b9e? That would keep the block index with the blocks, which is @sipa's preference.\r\n\r\n@sipa: can you elaborate your concerns of having the index outside of the blocks directory?",
      "created_at" : "2018-03-20T02:36:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-374452598",
      "id" : 374452598,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-20T02:36:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/374452598",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "@jonasschnelli @eklitzke I don't think there's an actual problem with having the blocks and the block index on separate filesystems. I was worried about them going out of sync due to management (you copy one but not the other, etc).",
      "created_at" : "2018-03-20T02:37:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-374452816",
      "id" : 374452816,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-20T02:37:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/374452816",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks @sipa.\r\nI think then we should keep the last commit (a1926362ecb3c354ae338ef7d7020daf78f980c9).",
      "created_at" : "2018-03-20T02:39:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-374453089",
      "id" : 374453089,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-20T02:39:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/374453089",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   }
]
