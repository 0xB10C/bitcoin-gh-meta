[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The argument for keeping the block index in the data dir would be that in the vast majority of cases it means the block index will be on the same filesystem as the utxo database, and therefore we can rely on regular filesystem semantics regarding data ordering. If the block index and utxo database are on different filesystems then it's not possible to guarantee that one is ahead of the other without fully serializing the operations with fsync.\r\n\r\nI will try to look through the code more and think about this more closely. I think this change is fine the way the code currently works because the flushes are basically serialized anyway (and we fsync for block storage and block index updates), but this might become annoying long term.",
      "created_at" : "2018-03-10T16:25:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-372042436",
      "id" : 372042436,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-10T16:25:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372042436",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/2734?v=4",
         "events_url" : "https://api.github.com/users/eklitzke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eklitzke/followers",
         "following_url" : "https://api.github.com/users/eklitzke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eklitzke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eklitzke",
         "id" : 2734,
         "login" : "eklitzke",
         "organizations_url" : "https://api.github.com/users/eklitzke/orgs",
         "received_events_url" : "https://api.github.com/users/eklitzke/received_events",
         "repos_url" : "https://api.github.com/users/eklitzke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eklitzke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eklitzke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Added a commit (basically a one-liner) that will make the block index database stick in datadir.",
      "created_at" : "2018-03-11T04:43:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-372089163",
      "id" : 372089163,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-11T04:43:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372089163",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK Once you fix the python lint failure.",
      "created_at" : "2018-03-11T07:11:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-372094666",
      "id" : 372094666,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-11T07:11:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372094666",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/2734?v=4",
         "events_url" : "https://api.github.com/users/eklitzke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eklitzke/followers",
         "following_url" : "https://api.github.com/users/eklitzke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eklitzke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eklitzke",
         "id" : 2734,
         "login" : "eklitzke",
         "organizations_url" : "https://api.github.com/users/eklitzke/orgs",
         "received_events_url" : "https://api.github.com/users/eklitzke/received_events",
         "repos_url" : "https://api.github.com/users/eklitzke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eklitzke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eklitzke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK.",
      "created_at" : "2018-03-11T19:05:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-372140158",
      "id" : 372140158,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-11T19:05:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372140158",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173667736"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173667736"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I am wondering why this should be net specific, considering that we have the same concept for wallets and the `GetWalletDir` is not net specific.",
      "commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "created_at" : "2018-03-11T20:13:01Z",
      "diff_hunk" : "@@ -182,6 +182,7 @@ void ReleaseDirectoryLocks();\n \n bool TryCreateDirectories(const fs::path& p);\n fs::path GetDefaultDataDir();\n+const fs::path &GetBlocksDir(bool fNetSpecific = true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173667736",
      "id" : 173667736,
      "original_commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "original_position" : 4,
      "path" : "src/util.h",
      "position" : 4,
      "pull_request_review_id" : 102894584,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653",
      "updated_at" : "2018-03-11T20:13:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173667736",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173841457"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173841457"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Remove `;`.",
      "commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "created_at" : "2018-03-12T15:37:23Z",
      "diff_hunk" : "@@ -0,0 +1,34 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2018 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the blocksdir option.\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, initialize_datadir\n+\n+import shutil\n+import os\n+\n+class BlocksdirTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def run_test(self):\n+        self.stop_node(0)\n+        node0path = os.path.join(self.options.tmpdir, \"node0\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173841457",
      "id" : 173841457,
      "original_commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "original_position" : 20,
      "path" : "test/functional/feature_blocksdir.py",
      "position" : 20,
      "pull_request_review_id" : 103096628,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653",
      "updated_at" : "2018-03-12T15:54:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173841457",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173843918"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173843918"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Add\r\n```py\r\nblocksdir = os.path.join(self.options.tmpdir, \"blocksdir\")\r\n```\r\nand reuse here and below.",
      "commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "created_at" : "2018-03-12T15:44:09Z",
      "diff_hunk" : "@@ -0,0 +1,34 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2018 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the blocksdir option.\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, initialize_datadir\n+\n+import shutil\n+import os\n+\n+class BlocksdirTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def run_test(self):\n+        self.stop_node(0)\n+        node0path = os.path.join(self.options.tmpdir, \"node0\");\n+        shutil.rmtree(node0path)\n+        initialize_datadir(self.options.tmpdir, 0)\n+        self.log.info(\"Starting with non exiting blocksdir ...\")\n+        self.assert_start_raises_init_error(0, [\"-blocksdir=\"+self.options.tmpdir+ \"/blocksdir\"], \"Specified blocks director\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173843918",
      "id" : 173843918,
      "original_commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "original_position" : 24,
      "path" : "test/functional/feature_blocksdir.py",
      "position" : 24,
      "pull_request_review_id" : 103096628,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653",
      "updated_at" : "2018-03-12T15:54:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173843918",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173847868"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173847868"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`\"blockindex\"`? Should be `\"blocks\" / \"index\"`?\r\n\r\nMaybe add `GetBlockIndexDir()`?",
      "commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "created_at" : "2018-03-12T15:54:39Z",
      "diff_hunk" : "@@ -147,7 +147,7 @@ size_t CCoinsViewDB::EstimateSize() const\n     return db.EstimateSize(DB_COIN, (char)(DB_COIN+1));\n }\n \n-CBlockTreeDB::CBlockTreeDB(size_t nCacheSize, bool fMemory, bool fWipe) : CDBWrapper(GetDataDir() / \"blocks\" / \"index\", nCacheSize, fMemory, fWipe) {\n+CBlockTreeDB::CBlockTreeDB(size_t nCacheSize, bool fMemory, bool fWipe) : CDBWrapper(gArgs.IsArgSet(\"-blocksdir\") ? GetDataDir() / \"blockindex\" : GetBlocksDir() / \"index\", nCacheSize, fMemory, fWipe) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#discussion_r173847868",
      "id" : 173847868,
      "original_commit_id" : "34ec8e308b99228f1bff1b9c26d8533a46727cb6",
      "original_position" : 5,
      "path" : "src/txdb.cpp",
      "position" : 5,
      "pull_request_review_id" : 103096628,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12653",
      "updated_at" : "2018-03-12T15:54:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/173847868",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Concept ACK, this would avoid some symlinking gymnastics I'm currently doing.\r\n(ref; #10922)",
      "created_at" : "2018-03-13T11:27:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12653#issuecomment-372633558",
      "id" : 372633558,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12653",
      "updated_at" : "2018-03-13T11:28:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372633558",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
