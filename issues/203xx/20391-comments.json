[
   {
      "author_association" : "MEMBER",
      "body" : "Thanks to @Xekyo for suggesting this in https://github.com/bitcoin/bitcoin/pull/20305#discussion_r520234818.",
      "created_at" : "2020-11-14T22:24:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20391#issuecomment-727273591",
      "id" : 727273591,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20391",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzI3MzU5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-14T22:24:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727273591",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Idea: since this is per-wallet, return the name of the wallet in the responses.",
      "created_at" : "2020-11-14T22:35:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20391#issuecomment-727274760",
      "id" : 727274760,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20391",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzI3NDc2MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-14T22:35:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727274760",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20305 (wallet: introduce fee_rate sat/vB param/option by jonatack)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-11-15T00:07:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20391#issuecomment-727284177",
      "id" : 727284177,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20391",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzI4NDE3Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-16T13:38:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727284177",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "In the 'Successful responses' and 'Error responses' above shouldn't it be `sat/vB` instead of `sat/B`?",
      "created_at" : "2020-11-15T03:28:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20391#issuecomment-727363191",
      "id" : 727363191,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20391",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzM2MzE5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-15T03:28:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727363191",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@prayank23 thanks for looking. Those will be automatically updated from sat/B to sat/vB by #20305, which updates the ToString() helper in `CFeeRate`. I updated the PR descpription to clarify that (thanks!)",
      "created_at" : "2020-11-15T07:21:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20391#issuecomment-727527712",
      "id" : 727527712,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20391",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzUyNzcxMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-15T15:59:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727527712",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-11-17T14:02:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20391#issuecomment-728947930",
      "id" : 728947930,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20391",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyODk0NzkzMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-17T14:02:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/728947930",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20391#discussion_r530037069"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20391"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/530037069"
         }
      },
      "author_association" : "MEMBER",
      "body" : "IMO we should add a `ValueFromFeeRate`",
      "commit_id" : "a96417d85ae3f3667455706c54828b7a9e55d825",
      "created_at" : "2020-11-25T00:48:04Z",
      "diff_hunk" : "@@ -2347,6 +2347,74 @@ static RPCHelpMan settxfee()\n     };\n }\n \n+static RPCHelpMan setfeerate()\n+{\n+    return RPCHelpMan{\n+        \"setfeerate\",\n+        \"\\nSet the transaction fee rate in \" + CURRENCY_ATOM + \"/vB for this wallet. Overrides the global -paytxfee configuration option.\\n\"\n+        \"Can be deactivated by passing 0 as the fee rate, in which case automatic fee selection will be used by default.\\n\",\n+        {\n+            {\"amount\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"The transaction fee rate in \" + CURRENCY_ATOM + \"/vB to set (0 to unset)\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+            {\n+                {RPCResult::Type::STR, \"wallet_name\", \"Name of the wallet the fee rate setting applies to\"},\n+                {RPCResult::Type::NUM, \"fee_rate\", \"Fee rate after this operation\"},\n+                {RPCResult::Type::STR, \"result\", /* optional */ true, \"Description of result, if successful\"},\n+                {RPCResult::Type::STR, \"error\", /* optional */ true, \"Description of error, if any\"},\n+            },\n+        },\n+        RPCExamples{\n+            \"\"\n+            \"\\nSet a fee rate of 1 \" + CURRENCY_ATOM + \"/vB\\n\"\n+            + HelpExampleCli(\"setfeerate\", \"1\") +\n+            \"\\nSet a fee rate of 3.141 \" + CURRENCY_ATOM + \"/vB\\n\"\n+            + HelpExampleCli(\"setfeerate\", \"3.141\") +\n+            \"\\nSet a fee rate of 7.75 \" + CURRENCY_ATOM + \"/vB with named arguments\\n\"\n+            + HelpExampleCli(\"-named setfeerate\", \"amount=7.75\") +\n+            \"\\nSet a fee rate of 25 \" + CURRENCY_ATOM + \"/vB with the RPC\\n\"\n+            + HelpExampleRpc(\"setfeerate\", \"25\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue {\n+            std::shared_ptr<CWallet> const rpc_wallet{GetWalletForJSONRPCRequest(request)};\n+            if (!rpc_wallet) return NullUniValue;\n+            CWallet& wallet = *rpc_wallet;\n+\n+            LOCK(wallet.cs_wallet);\n+\n+            CFeeRate amount{AmountFromValue(request.params[0]), COIN};\n+            std::string amount_str{amount.ToString(FeeEstimateMode::SAT_B)};\n+            std::string current_amount_str{wallet.m_pay_tx_fee.ToString(FeeEstimateMode::SAT_B)};\n+            CFeeRate relay_min_feerate(wallet.chain().relayMinFee().GetFeePerK());\n+            CFeeRate wallet_min_feerate(wallet.m_min_fee.GetFeePerK());\n+            CFeeRate wallet_max_feerate(wallet.m_default_max_tx_fee, 1000);\n+            std::string result, error;\n+\n+            if (amount == CFeeRate(0)) {\n+                wallet.m_pay_tx_fee = amount;\n+                result = \"Fee rate for transactions with this wallet successfully unset. By default, automatic fee selection will be used.\";\n+            } else if (amount < relay_min_feerate) {\n+                error = strprintf(\"The requested fee rate of %s cannot be less than the minimum relay fee rate of %s. The current setting of %s for this wallet remains unchanged.\", amount_str, relay_min_feerate.ToString(FeeEstimateMode::SAT_B), current_amount_str);\n+            } else if (amount < wallet_min_feerate) {\n+                error = strprintf(\"The requested fee rate of %s cannot be less than the wallet min fee rate of %s. The current setting of %s for this wallet remains unchanged.\", amount_str, wallet_min_feerate.ToString(FeeEstimateMode::SAT_B), current_amount_str);\n+            } else if (amount > wallet_max_feerate) {\n+                error = strprintf(\"The requested fee rate of %s cannot be greater than the wallet max fee rate of %s. The current setting of %s for this wallet remains unchanged.\", amount_str, wallet_max_feerate.ToString(FeeEstimateMode::SAT_B), current_amount_str);\n+            } else {\n+                wallet.m_pay_tx_fee = amount;\n+                result = \"Fee rate for transactions with this wallet successfully set to \" + amount_str;\n+            }\n+\n+            UniValue obj(UniValue::VOBJ);\n+            obj.pushKV(\"wallet_name\", wallet.GetName());\n+            obj.pushKV(\"fee_rate\", UniValue(UniValue::VNUM, wallet.m_pay_tx_fee.SatsToString()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20391#discussion_r530037069",
      "id" : 530037069,
      "line" : 2410,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDAzNzA2OQ==",
      "original_commit_id" : "a96417d85ae3f3667455706c54828b7a9e55d825",
      "original_line" : 2410,
      "original_position" : 78,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 78,
      "pull_request_review_id" : 538077112,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20391",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-25T00:48:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/530037069",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20391#discussion_r530044646"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20391"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/530044646"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe rebase this on top of 8798383475f4e1db44f734cdd94885e5527761fe",
      "commit_id" : "a96417d85ae3f3667455706c54828b7a9e55d825",
      "created_at" : "2020-11-25T01:13:14Z",
      "diff_hunk" : "@@ -2347,6 +2347,74 @@ static RPCHelpMan settxfee()\n     };\n }\n \n+static RPCHelpMan setfeerate()\n+{\n+    return RPCHelpMan{\n+        \"setfeerate\",\n+        \"\\nSet the transaction fee rate in \" + CURRENCY_ATOM + \"/vB for this wallet. Overrides the global -paytxfee configuration option.\\n\"\n+        \"Can be deactivated by passing 0 as the fee rate, in which case automatic fee selection will be used by default.\\n\",\n+        {\n+            {\"amount\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"The transaction fee rate in \" + CURRENCY_ATOM + \"/vB to set (0 to unset)\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+            {\n+                {RPCResult::Type::STR, \"wallet_name\", \"Name of the wallet the fee rate setting applies to\"},\n+                {RPCResult::Type::NUM, \"fee_rate\", \"Fee rate after this operation\"},\n+                {RPCResult::Type::STR, \"result\", /* optional */ true, \"Description of result, if successful\"},\n+                {RPCResult::Type::STR, \"error\", /* optional */ true, \"Description of error, if any\"},\n+            },\n+        },\n+        RPCExamples{\n+            \"\"\n+            \"\\nSet a fee rate of 1 \" + CURRENCY_ATOM + \"/vB\\n\"\n+            + HelpExampleCli(\"setfeerate\", \"1\") +\n+            \"\\nSet a fee rate of 3.141 \" + CURRENCY_ATOM + \"/vB\\n\"\n+            + HelpExampleCli(\"setfeerate\", \"3.141\") +\n+            \"\\nSet a fee rate of 7.75 \" + CURRENCY_ATOM + \"/vB with named arguments\\n\"\n+            + HelpExampleCli(\"-named setfeerate\", \"amount=7.75\") +\n+            \"\\nSet a fee rate of 25 \" + CURRENCY_ATOM + \"/vB with the RPC\\n\"\n+            + HelpExampleRpc(\"setfeerate\", \"25\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue {\n+            std::shared_ptr<CWallet> const rpc_wallet{GetWalletForJSONRPCRequest(request)};\n+            if (!rpc_wallet) return NullUniValue;\n+            CWallet& wallet = *rpc_wallet;\n+\n+            LOCK(wallet.cs_wallet);\n+\n+            CFeeRate amount{AmountFromValue(request.params[0]), COIN};\n+            std::string amount_str{amount.ToString(FeeEstimateMode::SAT_B)};\n+            std::string current_amount_str{wallet.m_pay_tx_fee.ToString(FeeEstimateMode::SAT_B)};\n+            CFeeRate relay_min_feerate(wallet.chain().relayMinFee().GetFeePerK());\n+            CFeeRate wallet_min_feerate(wallet.m_min_fee.GetFeePerK());\n+            CFeeRate wallet_max_feerate(wallet.m_default_max_tx_fee, 1000);\n+            std::string result, error;\n+\n+            if (amount == CFeeRate(0)) {\n+                wallet.m_pay_tx_fee = amount;\n+                result = \"Fee rate for transactions with this wallet successfully unset. By default, automatic fee selection will be used.\";\n+            } else if (amount < relay_min_feerate) {\n+                error = strprintf(\"The requested fee rate of %s cannot be less than the minimum relay fee rate of %s. The current setting of %s for this wallet remains unchanged.\", amount_str, relay_min_feerate.ToString(FeeEstimateMode::SAT_B), current_amount_str);\n+            } else if (amount < wallet_min_feerate) {\n+                error = strprintf(\"The requested fee rate of %s cannot be less than the wallet min fee rate of %s. The current setting of %s for this wallet remains unchanged.\", amount_str, wallet_min_feerate.ToString(FeeEstimateMode::SAT_B), current_amount_str);\n+            } else if (amount > wallet_max_feerate) {\n+                error = strprintf(\"The requested fee rate of %s cannot be greater than the wallet max fee rate of %s. The current setting of %s for this wallet remains unchanged.\", amount_str, wallet_max_feerate.ToString(FeeEstimateMode::SAT_B), current_amount_str);\n+            } else {\n+                wallet.m_pay_tx_fee = amount;\n+                result = \"Fee rate for transactions with this wallet successfully set to \" + amount_str;\n+            }\n+\n+            UniValue obj(UniValue::VOBJ);\n+            obj.pushKV(\"wallet_name\", wallet.GetName());\n+            obj.pushKV(\"fee_rate\", UniValue(UniValue::VNUM, wallet.m_pay_tx_fee.SatsToString()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20391#discussion_r530044646",
      "id" : 530044646,
      "in_reply_to_id" : 530037069,
      "line" : 2410,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMDA0NDY0Ng==",
      "original_commit_id" : "a96417d85ae3f3667455706c54828b7a9e55d825",
      "original_line" : 2410,
      "original_position" : 78,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 78,
      "pull_request_review_id" : 538085656,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20391",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-25T01:15:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/530044646",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20391#discussion_r531175708"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20391"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531175708"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Maybe rebase this on top of [8798383](https://github.com/bitcoin/bitcoin/commit/8798383475f4e1db44f734cdd94885e5527761fe)\r\n\r\nSGTM",
      "commit_id" : "a96417d85ae3f3667455706c54828b7a9e55d825",
      "created_at" : "2020-11-26T18:07:09Z",
      "diff_hunk" : "@@ -2347,6 +2347,74 @@ static RPCHelpMan settxfee()\n     };\n }\n \n+static RPCHelpMan setfeerate()\n+{\n+    return RPCHelpMan{\n+        \"setfeerate\",\n+        \"\\nSet the transaction fee rate in \" + CURRENCY_ATOM + \"/vB for this wallet. Overrides the global -paytxfee configuration option.\\n\"\n+        \"Can be deactivated by passing 0 as the fee rate, in which case automatic fee selection will be used by default.\\n\",\n+        {\n+            {\"amount\", RPCArg::Type::AMOUNT, RPCArg::Optional::NO, \"The transaction fee rate in \" + CURRENCY_ATOM + \"/vB to set (0 to unset)\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+            {\n+                {RPCResult::Type::STR, \"wallet_name\", \"Name of the wallet the fee rate setting applies to\"},\n+                {RPCResult::Type::NUM, \"fee_rate\", \"Fee rate after this operation\"},\n+                {RPCResult::Type::STR, \"result\", /* optional */ true, \"Description of result, if successful\"},\n+                {RPCResult::Type::STR, \"error\", /* optional */ true, \"Description of error, if any\"},\n+            },\n+        },\n+        RPCExamples{\n+            \"\"\n+            \"\\nSet a fee rate of 1 \" + CURRENCY_ATOM + \"/vB\\n\"\n+            + HelpExampleCli(\"setfeerate\", \"1\") +\n+            \"\\nSet a fee rate of 3.141 \" + CURRENCY_ATOM + \"/vB\\n\"\n+            + HelpExampleCli(\"setfeerate\", \"3.141\") +\n+            \"\\nSet a fee rate of 7.75 \" + CURRENCY_ATOM + \"/vB with named arguments\\n\"\n+            + HelpExampleCli(\"-named setfeerate\", \"amount=7.75\") +\n+            \"\\nSet a fee rate of 25 \" + CURRENCY_ATOM + \"/vB with the RPC\\n\"\n+            + HelpExampleRpc(\"setfeerate\", \"25\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue {\n+            std::shared_ptr<CWallet> const rpc_wallet{GetWalletForJSONRPCRequest(request)};\n+            if (!rpc_wallet) return NullUniValue;\n+            CWallet& wallet = *rpc_wallet;\n+\n+            LOCK(wallet.cs_wallet);\n+\n+            CFeeRate amount{AmountFromValue(request.params[0]), COIN};\n+            std::string amount_str{amount.ToString(FeeEstimateMode::SAT_B)};\n+            std::string current_amount_str{wallet.m_pay_tx_fee.ToString(FeeEstimateMode::SAT_B)};\n+            CFeeRate relay_min_feerate(wallet.chain().relayMinFee().GetFeePerK());\n+            CFeeRate wallet_min_feerate(wallet.m_min_fee.GetFeePerK());\n+            CFeeRate wallet_max_feerate(wallet.m_default_max_tx_fee, 1000);\n+            std::string result, error;\n+\n+            if (amount == CFeeRate(0)) {\n+                wallet.m_pay_tx_fee = amount;\n+                result = \"Fee rate for transactions with this wallet successfully unset. By default, automatic fee selection will be used.\";\n+            } else if (amount < relay_min_feerate) {\n+                error = strprintf(\"The requested fee rate of %s cannot be less than the minimum relay fee rate of %s. The current setting of %s for this wallet remains unchanged.\", amount_str, relay_min_feerate.ToString(FeeEstimateMode::SAT_B), current_amount_str);\n+            } else if (amount < wallet_min_feerate) {\n+                error = strprintf(\"The requested fee rate of %s cannot be less than the wallet min fee rate of %s. The current setting of %s for this wallet remains unchanged.\", amount_str, wallet_min_feerate.ToString(FeeEstimateMode::SAT_B), current_amount_str);\n+            } else if (amount > wallet_max_feerate) {\n+                error = strprintf(\"The requested fee rate of %s cannot be greater than the wallet max fee rate of %s. The current setting of %s for this wallet remains unchanged.\", amount_str, wallet_max_feerate.ToString(FeeEstimateMode::SAT_B), current_amount_str);\n+            } else {\n+                wallet.m_pay_tx_fee = amount;\n+                result = \"Fee rate for transactions with this wallet successfully set to \" + amount_str;\n+            }\n+\n+            UniValue obj(UniValue::VOBJ);\n+            obj.pushKV(\"wallet_name\", wallet.GetName());\n+            obj.pushKV(\"fee_rate\", UniValue(UniValue::VNUM, wallet.m_pay_tx_fee.SatsToString()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20391#discussion_r531175708",
      "id" : 531175708,
      "in_reply_to_id" : 530037069,
      "line" : 2410,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTE3NTcwOA==",
      "original_commit_id" : "a96417d85ae3f3667455706c54828b7a9e55d825",
      "original_line" : 2410,
      "original_position" : 78,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 78,
      "pull_request_review_id" : 539496909,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20391",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-26T18:07:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531175708",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
