[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r428140123"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428140123"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The signalling is done using a service flag because the service flags are gossiped and thus a node can choose to connect to `ADDRv2`-supporting nodes in the hopes of learning more e.g. Tor v3 addresses. For sure it is not going to learn any Tor v3, I2P or CJDNS addresses from nodes that do not support `ADDRv2`.\r\n\r\nHowever, [BIP155](https://github.com/bitcoin/bips/blob/master/bip-0155.mediawiki#compatibility) mentions support should be signalled by protocol version bump. And [pull#16748 [WIP] Add support for addrv2 (BIP155)](https://github.com/bitcoin/bitcoin/pull/16748) implemented this via a dedicated new type of messages `sendaddrv2`.\r\n\r\nI think that signalling via a service flag gives the most flexibility and thus I took the liberty to implement it that way, but I do not insist on it. I can change it to \"protocol version bump\", \"dedicated new message type\" or something else.\r\n",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-05-20T16:18:09Z",
      "diff_hunk" : "@@ -263,6 +269,8 @@ enum ServiceFlags : uint64_t {\n     // NODE_WITNESS indicates that a node can be asked for blocks and transactions including\n     // witness data.\n     NODE_WITNESS = (1 << 3),\n+    // NODE_ADDRv2 indicates send and receive support for ADDRv2 messages (BIP155).\n+    NODE_ADDRv2 = (1 << 4),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r428140123",
      "id" : 428140123,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODE0MDEyMw==",
      "original_commit_id" : "89d346a488141d028ed460de51164d4a367e36e7",
      "original_line" : 295,
      "original_position" : 18,
      "original_start_line" : 272,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 415501821,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428140123",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK :smile: \r\n\r\nAm I correct in saying that you've replaced `NetworkID` in my implementation with `Bip155NetworkId`? (totally fine btw, just wanted to make sure)",
      "created_at" : "2020-05-20T16:55:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-631599290",
      "id" : 631599290,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMTU5OTI5MA==",
      "updated_at" : "2020-05-20T16:55:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631599290",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK!",
      "created_at" : "2020-05-20T17:03:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-631603514",
      "id" : 631603514,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMTYwMzUxNA==",
      "updated_at" : "2020-05-20T17:03:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631603514",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Am I correct in saying that you've replaced `NetworkID` in my implementation with `Bip155NetworkId`? (totally fine btw, just wanted to make sure)\r\n\r\nYes, thanks for asking!\r\n\r\nIdeally we would have just one `enum` for network types, not two. That would contain the network ids from BIP155 + the other ones we have now - unroutable, internal/name, etc. But the problem is that lots of code relies on the values being sequential - there are loops from `0` to `NET_MAX`. I did not wanted to plant e.g. \"unroutable\" as `0x07` just after `CJDNS` or to change those loops and assumptions because it would bloat this PR too much.\r\n\r\nSo I introduced a second `enum` but made it private inside `CNetAddr` and named it `BIP155...` to denote that it contains just the networks mentioned in BIP155 and nothing else.",
      "created_at" : "2020-05-20T18:17:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-631641564",
      "id" : 631641564,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMTY0MTU2NA==",
      "updated_at" : "2020-05-20T18:17:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631641564",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19415 (net: Make DNS lookup mockable, add fuzzing harness by practicalswift)\n* #19360 (net: improve encapsulation of CNetAddr by vasild)\n* #19326 (Simplify hash.h interface using Spans by sipa)\n* #19238 (refactor: Replace RecursiveMutex with Mutex in CAddrMan by hebasto)\n* #18722 (addrman: improve performance by using more suitable containers by vasild)\n* #18044 (Use wtxid for transaction relay by sdaftuar)\n* #17944 (netaddress: Simplify reachability logic by dongcarl)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-05-20T18:57:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-631662338",
      "id" : 631662338,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMTY2MjMzOA==",
      "updated_at" : "2020-07-10T06:19:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631662338",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-05-20T19:31:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-631679778",
      "id" : 631679778,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMTY3OTc3OA==",
      "updated_at" : "2020-05-20T19:31:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631679778",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. WIll do a good review later.",
      "created_at" : "2020-05-20T22:13:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-631755683",
      "id" : 631755683,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMTc1NTY4Mw==",
      "updated_at" : "2020-05-20T22:13:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631755683",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-05-29T09:49:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-635882617",
      "id" : 635882617,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNTg4MjYxNw==",
      "updated_at" : "2020-05-29T09:49:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635882617",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased.",
      "created_at" : "2020-06-04T13:23:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-638844175",
      "id" : 638844175,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzODg0NDE3NQ==",
      "updated_at" : "2020-06-04T13:23:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/638844175",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Changed the implementation to use dedicated message `sendaddrv2` for signaling support instead of a service bit. The code complexity is about the same, the dedicated message needs a few more lines, [d85215213..9a526f22b](https://github.com/bitcoin/bitcoin/compare/d85215213..9a526f22b):\r\n```\r\n src/init.cpp                                |  2 +-\r\n src/net.h                                   |  3 ++-\r\n src/net_processing.cpp                      | 10 +++++++++-\r\n src/protocol.cpp                            |  3 ++-\r\n src/protocol.h                              |  8 ++++++--\r\n test/functional/p2p_leak.py                 |  1 +\r\n test/functional/p2p_node_network_limited.py |  4 ++--\r\n test/functional/test_framework/messages.py  | 18 +++++++++++++++++-\r\n test/functional/test_framework/mininode.py  |  3 +++\r\n 9 files changed, 43 insertions(+), 9 deletions(-)\r\n```",
      "created_at" : "2020-06-09T18:40:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-641499477",
      "id" : 641499477,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MTQ5OTQ3Nw==",
      "updated_at" : "2020-06-09T18:40:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641499477",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased.",
      "created_at" : "2020-06-09T18:54:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-641506189",
      "id" : 641506189,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MTUwNjE4OQ==",
      "updated_at" : "2020-06-09T18:54:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641506189",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-06-09T21:48:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-641600279",
      "id" : 641600279,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MTYwMDI3OQ==",
      "updated_at" : "2020-06-09T21:48:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641600279",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased.",
      "created_at" : "2020-06-10T06:58:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-641772444",
      "id" : 641772444,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MTc3MjQ0NA==",
      "updated_at" : "2020-06-10T06:58:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641772444",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438044714"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438044714"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It has also something to do with NET_TEREDO below.\r\nI mean, the whole thing is somewhat confusing, but maybe there's a chance to make it better or at least more clear?",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-06-10T11:13:29Z",
      "diff_hunk" : "@@ -16,14 +16,30 @@\n #include <string>\n #include <vector>\n \n+/**\n+ * A network type.\n+ * @note An address may belong to more than one network, for example `10.0.0.1`\n+ * belongs to both `NET_UNROUTABLE` and `NET_IPV4`.\n+ * Keep these sequential starting from 0 and `NET_MAX` as last.\n+ */\n enum Network\n {\n+    /// Addresses from these networks are not publicly routable on the global Internet.\n     NET_UNROUTABLE = 0,\n+\n+    /// IPv4\n     NET_IPV4,\n+\n+    /// IPv6\n     NET_IPV6,\n+\n+    /// TORv2\n     NET_ONION,\n+\n+    /// A set of dummy addresses that map a name to an IPv6 address.\n     NET_INTERNAL,\n \n+    /// Dummy value to indicate the number of NET_* constants.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438044714",
      "id" : 438044714,
      "line" : 56,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA0NDcxNA==",
      "original_commit_id" : "21e62e32456b299f391b261d684a26ca5b12e3c8",
      "original_line" : 56,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 48,
      "pull_request_review_id" : 427950949,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438044714",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438049838"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438049838"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can you rename the var to something more meaningful? At least `addr_format_supported` maybe. I see the comment, but well, it won't hurt to have better war names too.",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-06-10T11:24:03Z",
      "diff_hunk" : "@@ -951,11 +952,16 @@ class CNode\n \n     void PushAddress(const CAddress& _addr, FastRandomContext &insecure_rand)\n     {\n+        // Whether the peer supports the address in `_addr`. For example,\n+        // nodes that do not implement BIP155 cannot receive Tor v3 addresses\n+        // because they require ADDRv2 (BIP155) encoding.\n+        const bool supported = m_supports_addrv2 || _addr.IsAddrV1Compatible();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438049838",
      "id" : 438049838,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA0OTgzOA==",
      "original_commit_id" : "3deae0ce03e7d83f8f8409a9e01eb8a0fa9018d8",
      "original_line" : 958,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 427957618,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438049838",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I reviewed the code and it looks sane.\r\n\r\nI believe all the questionable parts about BIP155 are not included here? Making this PR more or less ready to review without high-level discussions.\r\n\r\nWe probably need much more eyes, there's just too much low level code changes.",
      "created_at" : "2020-06-10T11:34:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-641942869",
      "id" : 641942869,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MTk0Mjg2OQ==",
      "updated_at" : "2020-06-10T11:34:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641942869",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438064667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438064667"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n * Keep these sequential starting from 0 and `NET_MAX` as the last entry. \r\n * We have loops like `for (int i = 0; i < NET_MAX; i++)` that expect to iterate \r\n * over all enum values and also `GetExtNetwork()` \"extends\" this enum by \r\n * introducing standalone constants starting from `NET_MAX`.\r\n```",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-06-10T11:54:46Z",
      "diff_hunk" : "@@ -16,14 +16,30 @@\n #include <string>\n #include <vector>\n \n+/**\n+ * A network type.\n+ * @note An address may belong to more than one network, for example `10.0.0.1`\n+ * belongs to both `NET_UNROUTABLE` and `NET_IPV4`.\n+ * Keep these sequential starting from 0 and `NET_MAX` as last.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438064667",
      "id" : 438064667,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA2NDY2Nw==",
      "original_commit_id" : "21e62e32456b299f391b261d684a26ca5b12e3c8",
      "original_line" : 23,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : null,
      "pull_request_review_id" : 427977088,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438064667",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438068554"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438068554"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Renamed locally to `addr_format_supported`, will push it together with the other change.",
      "commit_id" : "baf43171a670b5e41823836c889ecf6b2934e3bf",
      "created_at" : "2020-06-10T12:02:33Z",
      "diff_hunk" : "@@ -951,11 +952,16 @@ class CNode\n \n     void PushAddress(const CAddress& _addr, FastRandomContext &insecure_rand)\n     {\n+        // Whether the peer supports the address in `_addr`. For example,\n+        // nodes that do not implement BIP155 cannot receive Tor v3 addresses\n+        // because they require ADDRv2 (BIP155) encoding.\n+        const bool supported = m_supports_addrv2 || _addr.IsAddrV1Compatible();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438068554",
      "id" : 438068554,
      "in_reply_to_id" : 438049838,
      "line" : 958,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA2ODU1NA==",
      "original_commit_id" : "3deae0ce03e7d83f8f8409a9e01eb8a0fa9018d8",
      "original_line" : 958,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : 15,
      "pull_request_review_id" : 427977088,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-10T12:02:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438068554",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438069014"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438069014"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What about this? https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438064667",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-06-10T12:03:29Z",
      "diff_hunk" : "@@ -16,14 +16,30 @@\n #include <string>\n #include <vector>\n \n+/**\n+ * A network type.\n+ * @note An address may belong to more than one network, for example `10.0.0.1`\n+ * belongs to both `NET_UNROUTABLE` and `NET_IPV4`.\n+ * Keep these sequential starting from 0 and `NET_MAX` as last.\n+ */\n enum Network\n {\n+    /// Addresses from these networks are not publicly routable on the global Internet.\n     NET_UNROUTABLE = 0,\n+\n+    /// IPv4\n     NET_IPV4,\n+\n+    /// IPv6\n     NET_IPV6,\n+\n+    /// TORv2\n     NET_ONION,\n+\n+    /// A set of dummy addresses that map a name to an IPv6 address.\n     NET_INTERNAL,\n \n+    /// Dummy value to indicate the number of NET_* constants.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438069014",
      "id" : 438069014,
      "in_reply_to_id" : 438044714,
      "line" : 56,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODA2OTAxNA==",
      "original_commit_id" : "21e62e32456b299f391b261d684a26ca5b12e3c8",
      "original_line" : 56,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 48,
      "pull_request_review_id" : 427982800,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438069014",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I believe all the questionable parts about BIP155 are not included here? Making this PR more or less ready to review without high-level discussions.\r\n\r\nThis PR is a full implementation of ADDRv2. However:\r\n\r\n* The maximum length of an address, mentioned in BIP155 is 32 bytes, whereas this PR has set it to 512 bytes.\r\n* Signaling for ADDRv2 support is done by a protocol version bump in BIP155, whereas this PR does it by a new dedicated message `sendaddrv2`.\r\n\r\nhttps://github.com/bitcoin/bips/pull/907 should align the code and the spec.",
      "created_at" : "2020-06-10T12:40:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-641979759",
      "id" : 641979759,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MTk3OTc1OQ==",
      "updated_at" : "2020-06-10T12:40:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641979759",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438115301"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115301"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done: https://github.com/bitcoin/bitcoin/compare/baf43171a670b5e41823836c889ecf6b2934e3bf..0bbe82d95b54e7727f966f4f8944f126619c9f28",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-06-10T13:20:05Z",
      "diff_hunk" : "@@ -16,14 +16,30 @@\n #include <string>\n #include <vector>\n \n+/**\n+ * A network type.\n+ * @note An address may belong to more than one network, for example `10.0.0.1`\n+ * belongs to both `NET_UNROUTABLE` and `NET_IPV4`.\n+ * Keep these sequential starting from 0 and `NET_MAX` as last.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438115301",
      "id" : 438115301,
      "in_reply_to_id" : 438064667,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODExNTMwMQ==",
      "original_commit_id" : "21e62e32456b299f391b261d684a26ca5b12e3c8",
      "original_line" : 23,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : null,
      "pull_request_review_id" : 428044030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115301",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438115672"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115672"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done: https://github.com/bitcoin/bitcoin/compare/baf43171a670b5e41823836c889ecf6b2934e3bf..0bbe82d95b54e7727f966f4f8944f126619c9f28",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-06-10T13:20:37Z",
      "diff_hunk" : "@@ -951,11 +952,16 @@ class CNode\n \n     void PushAddress(const CAddress& _addr, FastRandomContext &insecure_rand)\n     {\n+        // Whether the peer supports the address in `_addr`. For example,\n+        // nodes that do not implement BIP155 cannot receive Tor v3 addresses\n+        // because they require ADDRv2 (BIP155) encoding.\n+        const bool supported = m_supports_addrv2 || _addr.IsAddrV1Compatible();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438115672",
      "id" : 438115672,
      "in_reply_to_id" : 438049838,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODExNTY3Mg==",
      "original_commit_id" : "3deae0ce03e7d83f8f8409a9e01eb8a0fa9018d8",
      "original_line" : 958,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 428044507,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115672",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438115800"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115800"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done: https://github.com/bitcoin/bitcoin/compare/baf43171a670b5e41823836c889ecf6b2934e3bf..0bbe82d95b54e7727f966f4f8944f126619c9f28",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-06-10T13:20:48Z",
      "diff_hunk" : "@@ -16,14 +16,30 @@\n #include <string>\n #include <vector>\n \n+/**\n+ * A network type.\n+ * @note An address may belong to more than one network, for example `10.0.0.1`\n+ * belongs to both `NET_UNROUTABLE` and `NET_IPV4`.\n+ * Keep these sequential starting from 0 and `NET_MAX` as last.\n+ */\n enum Network\n {\n+    /// Addresses from these networks are not publicly routable on the global Internet.\n     NET_UNROUTABLE = 0,\n+\n+    /// IPv4\n     NET_IPV4,\n+\n+    /// IPv6\n     NET_IPV6,\n+\n+    /// TORv2\n     NET_ONION,\n+\n+    /// A set of dummy addresses that map a name to an IPv6 address.\n     NET_INTERNAL,\n \n+    /// Dummy value to indicate the number of NET_* constants.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r438115800",
      "id" : 438115800,
      "in_reply_to_id" : 438044714,
      "line" : 56,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzODExNTgwMA==",
      "original_commit_id" : "21e62e32456b299f391b261d684a26ca5b12e3c8",
      "original_line" : 56,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 48,
      "pull_request_review_id" : 428044675,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/438115800",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-06-19T12:29:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-646609356",
      "id" : 646609356,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NjYwOTM1Ng==",
      "updated_at" : "2020-06-19T12:29:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/646609356",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. At a high level the code looks well-done. Looked through the BIP and the previous PR.\r\n\r\nI wonder if this would make faster progress if it was turned into a master roadmap PR and split into easier-to-review PRs similar to what we've seen with the serialization refactoring. (A possible key to consider in making that work, if you do it, may be to take the time to set a clear map from the start so as to not change it midway, have to backtrack, or invalidate in-progress review.)",
      "created_at" : "2020-06-19T13:23:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-646633241",
      "id" : 646633241,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NjYzMzI0MQ==",
      "updated_at" : "2020-06-19T13:23:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/646633241",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I wonder if this would make faster progress if ... split into easier-to-review PRs ...\r\n\r\nMy thought exactly! Let's start with something small and see how it goes: https://github.com/bitcoin/bitcoin/pull/19351.\r\n\r\nI updated the roadmap at: https://github.com/bitcoin/bitcoin/issues/18884, this PR can be split in:\r\n\r\nPreparation cleanup\r\n---\r\n```\r\ntest: add an edge case test for CSubNet\r\nnet: improve encapsulation of CNetAddr\r\nnet: document `enum Network`\r\nnet: save the network type explicitly in CNetAddr\r\n```\r\n\r\nChange `CNetAddr::ip` to have flexible size\r\n---\r\n```\r\nnet: change CNetAddr::ip to have flexible size\r\n```\r\n\r\nImplement `addrv2` (un)serializing\r\n---\r\n```\r\nnet: CAddress & CAddrMan: (un)serialize as ADDRv2\r\nnet: CNetAddr: add support to (un)serialize as ADDRv2\r\ntest: add CAddress serialization tests\r\n```\r\n\r\nAdvertise support for `addrv2` and start sending such messages to peers\r\n---\r\n```\r\nnet: advertise support for ADDRv2 via new message\r\n```",
      "created_at" : "2020-06-22T13:49:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-647531927",
      "id" : 647531927,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzUzMTkyNw==",
      "updated_at" : "2020-06-22T13:49:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647531927",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased.",
      "created_at" : "2020-06-22T13:55:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-647535424",
      "id" : 647535424,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzUzNTQyNA==",
      "updated_at" : "2020-06-22T13:55:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647535424",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Can you update the PR descriptions of this PR and 18884 with the roadmap and to indicate clearly which PRs correspond to which step and which PR of the 3 that are open should currently be reviewed? Review can be hard to obtain; best to make it easy and clear for your reviewers.",
      "created_at" : "2020-06-22T13:59:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-647537878",
      "id" : 647537878,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzUzNzg3OA==",
      "updated_at" : "2020-06-22T14:01:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647537878",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased, removing commit `test: add an edge case test for CSubNet` which was merged via https://github.com/bitcoin/bitcoin/pull/19351",
      "created_at" : "2020-06-22T19:55:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-647738511",
      "id" : 647738511,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzczODUxMQ==",
      "updated_at" : "2020-06-22T19:55:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647738511",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Can you update the PR descriptions...\r\n\r\nDone. In summary - https://github.com/bitcoin/bitcoin/issues/18884 is a roadmap for Tor v3. It is just an issue, does not contain code and this PR is part of that roadmap. https://github.com/bitcoin/bitcoin/pull/19351 already got merged (Thanks!). I chopped off the next one at https://github.com/bitcoin/bitcoin/pull/19360. It is happening!",
      "created_at" : "2020-06-23T14:26:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-648192113",
      "id" : 648192113,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0ODE5MjExMw==",
      "updated_at" : "2020-06-23T14:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/648192113",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased to restart CI",
      "created_at" : "2020-07-06T14:04:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-654259883",
      "id" : 654259883,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NDI1OTg4Mw==",
      "updated_at" : "2020-07-06T14:04:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/654259883",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r450941410"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/450941410"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I have never seen this variable used like this before and I've just spent 10 minutes trying to figure out what's going on, and I'm still a little confused. Maybe worth adding a comment?\r\nI think this code is counter-intuitive atm.",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-07-07T15:12:23Z",
      "diff_hunk" : "@@ -2438,9 +2441,27 @@ void ProcessMessage(\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(version_orig | ADDRv2_FORMAT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r450941410",
      "id" : 450941410,
      "line" : 2450,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDk0MTQxMA==",
      "original_commit_id" : "6a5f357c9b189c2e427b669cace9d026b0c0e335",
      "original_line" : 2450,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 20,
      "pull_request_review_id" : 443990536,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/450941410",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r451138256"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451138256"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think perhaps `m_wants_addrv2` would be a more appropriate name",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-07-07T20:56:35Z",
      "diff_hunk" : "@@ -769,6 +769,7 @@ class CNode\n     bool m_manual_connection{false};\n     bool fClient{false}; // set by version message\n     bool m_limited_node{false}; //after BIP159, set by version message\n+    std::atomic_bool m_supports_addrv2{false};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r451138256",
      "id" : 451138256,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTEzODI1Ng==",
      "original_commit_id" : "6a5f357c9b189c2e427b669cace9d026b0c0e335",
      "original_line" : 772,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 444243766,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451138256",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r451140392"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451140392"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This part probably deserves some extra scrutiny, I know that it's generally better to avoid exceptions in C++, but when I first wrote this I didn't see another option here for bubbling up an error and handling it.",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-07-07T21:00:35Z",
      "diff_hunk" : "@@ -2438,9 +2441,27 @@ void ProcessMessage(\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(version_orig | ADDRv2_FORMAT);\n+        }\n         std::vector<CAddress> vAddr;\n-        vRecv >> vAddr;\n+\n+        try {\n+            vRecv >> vAddr;\n+        } catch (const std::exception& e) {\n+            vRecv.SetVersion(version_orig);\n+\n+            LOCK(cs_main);\n+            Misbehaving(pfrom.GetId(), 20,\n+                strprintf(\n+                    \"Supplied us with a message that contains an unparsable address: %s\",\n+                    e.what()));\n+            return;\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r451140392",
      "id" : 451140392,
      "line" : 2465,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTE0MDM5Mg==",
      "original_commit_id" : "6a5f357c9b189c2e427b669cace9d026b0c0e335",
      "original_line" : 2465,
      "original_position" : 34,
      "original_start_line" : 2451,
      "path" : "src/net_processing.cpp",
      "position" : 36,
      "pull_request_review_id" : 444243766,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : 2454,
      "start_side" : "RIGHT",
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451140392",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r451141607"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451141607"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Potential followup: perhaps there is something cleaner we can do in the future for serialization/deserialization options other than abusing the protocol version.",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-07-07T21:02:54Z",
      "diff_hunk" : "@@ -12,6 +12,12 @@\n #include <serialize.h>\n #include <uint256.h>\n \n+/**\n+ * A flag that is ORed into the protocol version to designate that a transaction\n+ * should be (un)serialized without witness data.\n+ * Make sure that this does not collide with any of the values in `version.h`\n+ * or with `ADDRv2_FORMAT`.\n+ */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r451141607",
      "id" : 451141607,
      "line" : 20,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTE0MTYwNw==",
      "original_commit_id" : "9b94ac3768449fcbaf4368e24abc6790665e8191",
      "original_line" : 20,
      "original_position" : 9,
      "original_start_line" : 15,
      "path" : "src/primitives/transaction.h",
      "position" : 9,
      "pull_request_review_id" : 444243766,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : 15,
      "start_side" : "RIGHT",
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451141607",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452338207"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452338207"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, that is a bit hackish but I do not think there is a cleaner way. It is somewhat similar to [iostream::setf()](http://www.cplusplus.com/reference/ios/ios_base/setf/) which is used to configure the stream wrt how data should be parsed or printed, e.g.:\r\n```cpp\r\ncout.setf(ios::boolalpha);\r\ncout << true; // prints (serializes as) \"true\" rather than \"1\"\r\n```\r\n\r\nI added comments like:\r\n```cpp\r\n// Sneak ADDRv2_FORMAT into the version so that the CNetAddr and CAddress\r\n// unserialize methods know that an address in v2 format is coming.\r\n```\r\nto all places where we do that.",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-07-09T16:21:34Z",
      "diff_hunk" : "@@ -2438,9 +2441,27 @@ void ProcessMessage(\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(version_orig | ADDRv2_FORMAT);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452338207",
      "id" : 452338207,
      "in_reply_to_id" : 450941410,
      "line" : 2450,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMzODIwNw==",
      "original_commit_id" : "6a5f357c9b189c2e427b669cace9d026b0c0e335",
      "original_line" : 2450,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 20,
      "pull_request_review_id" : 445774634,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452338207",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452338790"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452338790"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Renamed to `m_wants_addrv2`.",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-07-09T16:22:40Z",
      "diff_hunk" : "@@ -769,6 +769,7 @@ class CNode\n     bool m_manual_connection{false};\n     bool fClient{false}; // set by version message\n     bool m_limited_node{false}; //after BIP159, set by version message\n+    std::atomic_bool m_supports_addrv2{false};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452338790",
      "id" : 452338790,
      "in_reply_to_id" : 451138256,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjMzODc5MA==",
      "original_commit_id" : "6a5f357c9b189c2e427b669cace9d026b0c0e335",
      "original_line" : 772,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 445775473,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452338790",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452343713"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452343713"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, I also couldn't find a better way to cancel the parsing. I think that is a limitation of our ser/unser framework - its not possible to cancel the parsing of multiple entries in the middle (e.g. when parsing a `std::vector` of `CNetAddr`) without using an exception.\r\n\r\nAnother way, but that's not good, would be to not throw an exception from `CNetAddr` unserialize methods, consume the bogus data from the stream, mark the object as invalid, continue parsing the remaining `CNetAddr` objects and later remove the invalid objects. But that is not good because we do not want to continue parsing the data once we see that it is clearly malformed/malicious.",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-07-09T16:30:32Z",
      "diff_hunk" : "@@ -2438,9 +2441,27 @@ void ProcessMessage(\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(version_orig | ADDRv2_FORMAT);\n+        }\n         std::vector<CAddress> vAddr;\n-        vRecv >> vAddr;\n+\n+        try {\n+            vRecv >> vAddr;\n+        } catch (const std::exception& e) {\n+            vRecv.SetVersion(version_orig);\n+\n+            LOCK(cs_main);\n+            Misbehaving(pfrom.GetId(), 20,\n+                strprintf(\n+                    \"Supplied us with a message that contains an unparsable address: %s\",\n+                    e.what()));\n+            return;\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452343713",
      "id" : 452343713,
      "in_reply_to_id" : 451140392,
      "line" : 2465,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjM0MzcxMw==",
      "original_commit_id" : "6a5f357c9b189c2e427b669cace9d026b0c0e335",
      "original_line" : 2465,
      "original_position" : 34,
      "original_start_line" : 2451,
      "path" : "src/net_processing.cpp",
      "position" : 36,
      "pull_request_review_id" : 445781727,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : 2454,
      "start_side" : "RIGHT",
      "updated_at" : "2020-07-09T16:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452343713",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-07-09T16:32:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-656228954",
      "id" : 656228954,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NjIyODk1NA==",
      "updated_at" : "2020-07-09T16:32:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656228954",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452451052"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452451052"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right, there is room for improvement here. I opened https://github.com/bitcoin/bitcoin/issues/19477 to track this.",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-07-09T19:47:08Z",
      "diff_hunk" : "@@ -12,6 +12,12 @@\n #include <serialize.h>\n #include <uint256.h>\n \n+/**\n+ * A flag that is ORed into the protocol version to designate that a transaction\n+ * should be (un)serialized without witness data.\n+ * Make sure that this does not collide with any of the values in `version.h`\n+ * or with `ADDRv2_FORMAT`.\n+ */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452451052",
      "id" : 452451052,
      "in_reply_to_id" : 451141607,
      "line" : 20,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ1MTA1Mg==",
      "original_commit_id" : "9b94ac3768449fcbaf4368e24abc6790665e8191",
      "original_line" : 20,
      "original_position" : 9,
      "original_start_line" : 15,
      "path" : "src/primitives/transaction.h",
      "position" : 9,
      "pull_request_review_id" : 445918780,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : 15,
      "start_side" : "RIGHT",
      "updated_at" : "2020-07-09T19:47:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452451052",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452462111"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452462111"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa Could you advise on whether there's another way or if the current way is alright?",
      "commit_id" : "cb85af83bb3476323367b480e48ce729714db996",
      "created_at" : "2020-07-09T20:09:59Z",
      "diff_hunk" : "@@ -2438,9 +2441,27 @@ void ProcessMessage(\n         return;\n     }\n \n-    if (msg_type == NetMsgType::ADDR) {\n+    if (msg_type == NetMsgType::ADDR || msg_type == NetMsgType::ADDRv2) {\n+        const auto version_orig = vRecv.GetVersion();\n+        if (msg_type == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(version_orig | ADDRv2_FORMAT);\n+        }\n         std::vector<CAddress> vAddr;\n-        vRecv >> vAddr;\n+\n+        try {\n+            vRecv >> vAddr;\n+        } catch (const std::exception& e) {\n+            vRecv.SetVersion(version_orig);\n+\n+            LOCK(cs_main);\n+            Misbehaving(pfrom.GetId(), 20,\n+                strprintf(\n+                    \"Supplied us with a message that contains an unparsable address: %s\",\n+                    e.what()));\n+            return;\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#discussion_r452462111",
      "id" : 452462111,
      "in_reply_to_id" : 451140392,
      "line" : 2465,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjQ2MjExMQ==",
      "original_commit_id" : "6a5f357c9b189c2e427b669cace9d026b0c0e335",
      "original_line" : 2465,
      "original_position" : 34,
      "original_start_line" : 2451,
      "path" : "src/net_processing.cpp",
      "position" : 36,
      "pull_request_review_id" : 445933446,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19031",
      "side" : "RIGHT",
      "start_line" : 2454,
      "start_side" : "RIGHT",
      "updated_at" : "2020-07-09T20:10:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452462111",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I simplified the code a little bit, now that `CNetAddr::GetAddrBytes()` has been added to `master`.\r\n\r\n#19219 introduced a new method [CNetAddr::GetAddrBytes()](https://github.com/bitcoin/bitcoin/blob/0d69fdb/src/netaddress.h#L93) in `master` which does the same thing as [CNetAddr::GetAddrKey()](https://github.com/bitcoin/bitcoin/blob/567f98ea5d33d8cec699148be83b079dd5189101/src/netaddress.cpp#L554) (introduced in this PR).\r\n\r\nSo, change this PR to use the existent `CNetAddr::GetAddrBytes()` and don't introduce a new method.",
      "created_at" : "2020-07-10T13:59:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-656691574",
      "id" : 656691574,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NjY5MTU3NA==",
      "updated_at" : "2020-07-10T13:59:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656691574",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "While testing https://github.com/bitcoin/bitcoin/commit/81780afb3b4575642f74b682327ff1c78b6efaa7\r\nI saw that v3 are advertised as  [::]:0  and ToString resulted also in  [::]:0\r\n\r\n```\r\n2020-07-10T17:43:18Z sending feefilter (8 bytes) peer=0\r\n2020-07-10T17:43:18Z trying connection [::]:0 lastseen=0.0hrs\r\n2020-07-10T17:43:18Z SOCKS5 connecting [::]:0\r\n2020-07-10T17:43:18Z Socks5() connect to [::]:0:18444 failed: general failure\r\n````\r\n\r\nWith that Nit changes in the patch, The correct V3 long address is displayed and get an advertised reconnect at reboot.  \r\nWith that minor changes I had some success and so far https://github.com/bitcoin/bitcoin/commit/81780afb3b4575642f74b682327ff1c78b6efaa7 LGTM\r\n\r\nHope that helps...\r\nBtw. if you  git pull  https://github.com/Saibato/bitcoin add-ed25519 on top you have v3 onion on the fly for testing.  #19485\r\n\r\n\r\n``` Diff\r\ndiff --git a/src/netaddress.cpp b/src/netaddress.cpp\r\nindex 1ac99ddd1..0171b1d80 100644\r\n--- a/src/netaddress.cpp\r\n+++ b/src/netaddress.cpp\r\n@@ -21,6 +21,7 @@ CNetAddr::Bip155NetworkId CNetAddr::ToBIP155NetworkId() const\r\n     case NET_ONION:\r\n         switch (m_addr.size()) {\r\n         case ADDR_TORv2_SIZE: return Bip155NetworkId::TORv2;\r\n+        case ADDR_TORv3_SIZE: return Bip155NetworkId::TORv3;\r\n         default: assert(!\"Unexpected TOR address size\");\r\n         }\r\n     case NET_UNROUTABLE:\r\n@@ -58,6 +59,11 @@ bool CNetAddr::FromBIP155NetworkId(Bip155NetworkId bip155_network_id,\r\n         }\r\n         return false;\r\n     case Bip155NetworkId::TORv3:\r\n+        if (address_size == ADDR_TORv3_SIZE) {\r\n+           net = NET_ONION;\r\n+           return true;\r\n+        }\r\n+        return false;\r\n     case Bip155NetworkId::I2P:\r\n     case Bip155NetworkId::CJDNS:\r\n         return false;\r\n@@ -137,7 +143,7 @@ bool CNetAddr::SetSpecial(const std::string &strName)\r\n {\r\n     if (strName.size()>6 && strName.substr(strName.size() - 6, 6) == \".onion\") {\r\n         std::vector<unsigned char> vchAddr = DecodeBase32(strName.substr(0, strName.size() - 6).c_str());\r\n-        if (vchAddr.size() != ADDR_TORv2_SIZE)\r\n+        if (vchAddr.size() != ADDR_TORv2_SIZE && vchAddr.size() != ADDR_TORv3_SIZE)\r\n             return false;\r\n         m_net = NET_ONION;\r\n         m_addr = vchAddr;\r\ndiff --git a/src/netaddress.h b/src/netaddress.h\r\nindex 0a94f0587..baf7d29a2 100644\r\n--- a/src/netaddress.h\r\n+++ b/src/netaddress.h\r\n@@ -81,6 +81,10 @@ static constexpr size_t ADDR_IPv6_SIZE = 16;\r\n /// Size of TORv2 address (in bytes).\r\n static constexpr size_t ADDR_TORv2_SIZE = 10;\r\n \r\n+/// Size of TORv3 address (in bytes).\r\n+static constexpr size_t ADDR_TORv3_SIZE = 35;\r\n+\r\n+\r\n /// Size of \"internal\" (NET_INTERNAL) address (in bytes).\r\n static constexpr size_t ADDR_INTERNAL_SIZE = 10;\r\n \r\n@@ -259,10 +263,12 @@ class CNetAddr\r\n                 memcpy(arr, m_addr.data(), m_addr.size());\r\n                 break;\r\n             case NET_ONION:\r\n+                if (ToBIP155NetworkId() == Bip155NetworkId::TORv2) {\r\n                 prefix_size = sizeof(TORv2_IN_IPv6_PREFIX);\r\n                 assert(m_addr.size() + prefix_size == sizeof(arr));\r\n                 memcpy(arr, TORv2_IN_IPv6_PREFIX, prefix_size);\r\n                 memcpy(arr + prefix_size, m_addr.data(), m_addr.size());\r\n+                }\r\n                 break;\r\n             case NET_INTERNAL:\r\n                 prefix_size = sizeof(INTERNAL_IN_IPv6_PREFIX);\r\n\r\n```",
      "created_at" : "2020-07-10T18:21:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19031#issuecomment-656817252",
      "id" : 656817252,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19031",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NjgxNzI1Mg==",
      "updated_at" : "2020-07-10T18:23:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656817252",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/34917548?v=4",
         "events_url" : "https://api.github.com/users/Saibato/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Saibato/followers",
         "following_url" : "https://api.github.com/users/Saibato/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Saibato/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Saibato",
         "id" : 34917548,
         "login" : "Saibato",
         "node_id" : "MDQ6VXNlcjM0OTE3NTQ4",
         "organizations_url" : "https://api.github.com/users/Saibato/orgs",
         "received_events_url" : "https://api.github.com/users/Saibato/received_events",
         "repos_url" : "https://api.github.com/users/Saibato/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Saibato/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Saibato/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Saibato"
      }
   }
]
