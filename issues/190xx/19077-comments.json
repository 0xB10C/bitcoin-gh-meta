[
   {
      "author_association" : "MEMBER",
      "body" : "I've dropped the amalgamation file",
      "created_at" : "2020-05-27T03:19:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#issuecomment-634403350",
      "id" : 634403350,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19077",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDQwMzM1MA==",
      "updated_at" : "2020-05-27T03:19:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634403350",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Pretty amazing work! Thanks for doing this.\r\nFor testing purposes, would it make sense to add logdb (#5686, simple implementation) in order to test and benchmark?\r\n\r\nConcept ACK on a BDB replacement for descriptor wallets.\r\nStill unsure wether sqlite or an internal format should be chosen. Maybe a comparison(-matrix) of internal vs. sqlite could be done?\r\n\r\nAs for concrete implementation steps, maybe it would make sense to PR the DB flexibility first, then additional storage engines later.",
      "created_at" : "2020-05-27T15:54:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#issuecomment-634758099",
      "id" : 634758099,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19077",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDc1ODA5OQ==",
      "updated_at" : "2020-05-27T15:55:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634758099",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> For testing purposes, would it make sense to add logdb (#5686, simple implementation) in order to test and benchmark?\r\n\r\nI don't think it really makes sense to add a database system that we aren't going to use.\r\n\r\n> Still unsure wether sqlite or an internal format should be chosen. Maybe a comparison(-matrix) of internal vs. sqlite could be done?\r\n\r\nI think there's two primary reasons to choose sqlite over an internal format.\r\n\r\n1. Review and implementation are much simpler The library already exists so implementation just means correctly using the API. Reviewers won't have to review a file format implementation and convince themselves that that format won't corrupt and is robust.\r\n\r\n2. Better guarantees of consistency and non-corruption. SQLite is very well tested and very widely used. I think they are able better guarantee that data will get written, won't get lost, and won't get corrupted, than we would be able to with an internal format.\r\n\r\n> As for concrete implementation steps, maybe it would make sense to PR the DB flexibility first, then additional storage engines later.\r\n\r\n#18971 does the DB class stuff that gives us this flexibility. This PR is adding in the storage engine and the logic for CWallet to choose which storage to use.",
      "created_at" : "2020-05-27T16:25:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#issuecomment-634780861",
      "id" : 634780861,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19077",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDc4MDg2MQ==",
      "updated_at" : "2020-05-27T16:25:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634780861",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK\r\n\r\nNice work! Very readable code!",
      "created_at" : "2020-05-27T19:21:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#issuecomment-634887122",
      "id" : 634887122,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19077",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDg4NzEyMg==",
      "updated_at" : "2020-05-27T19:21:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634887122",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19558 (build: split pthread flags out of ldflags and dont use when building libconsensus by fanquake)\n* #19502 (Bugfix: Wallet: Soft-fail exceptions within ListWalletDir file checks by luke-jr)\n* #19461 (multiprocess: Add bitcoin-gui -ipcconnect option by ryanofsky)\n* #19460 (multiprocess: Add bitcoin-wallet -ipcconnect option by ryanofsky)\n* #19457 (wallet: Cleanup wallettool salvage and walletdb extraneous declarations by achow101)\n* #19419 (wallet: let Listwalletdir do not iterate trough our blocksdata. by Saibato)\n* #19335 (wallet: Cleanup and separate BerkeleyDatabase and BerkeleyBatch by achow101)\n* #19245 ([WIP DONOTMERGE] Replace boost::filesystem with std::filesystem (in c++17) by kiminuo)\n* #19101 (refactor: remove ::vpwallets and related global variables by ryanofsky)\n* #18904 (Don't call lsn_reset in periodic flush by bvbfan)\n* #18077 (net: Add NAT-PMP port forwarding support by hebasto)\n* #16546 (External signer support - Wallet Box edition by Sjors)\n* #15382 (util: add RunCommandParseJSON by Sjors)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-05-27T19:50:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#issuecomment-634903672",
      "id" : 634903672,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19077",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDkwMzY3Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-23T00:59:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634903672",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "CONCEPT ACK\r\n :tada: :partying_face: :tada: \r\nVery happy to move on from BerkeleyDB and I've always liked sqlite as a versatile but still minimalistic replacement.",
      "created_at" : "2020-05-28T10:41:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#issuecomment-635262568",
      "id" : 635262568,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19077",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNTI2MjU2OA==",
      "updated_at" : "2020-05-28T10:42:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635262568",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. I'm able to build and run the test suite (including `feature_backwards_compatibility.py`) on macOS 10.15.4 with Homebrew `brew install sqlite3` (don't forget to add). I'm also able to build with `/depends`. I'm able to load an existing descriptor wallet (bdb) and create a new one.\r\n\r\nIs there a particular reason to stick to `.dat` as the file extension, rather than `.sqlite`? If you do the latter, `listwalletdir` and the Open Wallet GUI need a trivial change.\r\n\r\nWould it make sense to switch some of the records over to a format that's more easy to inspect with a SQLite viewer? As well as use tables like \"transactions\"? Or would that make this PR far too complicated?",
      "created_at" : "2020-06-01T15:28:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#issuecomment-636923373",
      "id" : 636923373,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19077",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNjkyMzM3Mw==",
      "updated_at" : "2020-06-01T15:29:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/636923373",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Is there a particular reason to stick to `.dat` as the file extension, rather than `.sqlite`? If you do the latter, `listwalletdir` and the Open Wallet GUI need a trivial change.\r\n\r\nThere are 2 reasons. The first is that it's easier on review on implementation to stick to one filename. As you mentioned, if I make it `.sqlite`, `listwalletdir` and other places need to be changed. There are several places throughout the codebase where we specifically look for `wallet.dat` and not changing those to also use `wallet.sqlite` could be very bad. Additionally, some of those places may need to know whether they are looking for `wallet.dat` or `wallet.sqlite` so they would need access to whether a wallet is a descriptor wallet. They may need to know what kind of storage to look for which exposes more information than we currently already do. It's much simpler to just keep it `wallet.dat`. This avoids issues where the wrong filename could be used and makes review simpler.\r\n\r\nThe second reason is that there are already lots of tooling, documentation, and discussion that use `wallet.dat`. Things like backup scripts or instructions telling people how to backup their wallet won't be invalidated as we keep the same naming. For the most part, the end user doesn't care about how the data is being stored within the file, they just need to know to preserve the `wallet.dat` file. So by keeping the naming, all of these things stay the same and make it less likely for people to lose their money.\r\n\r\nThere are, of course, a few cases where tooling does need to be updated because of the format change. But this tooling is all for manual inspection of the wallet.dat file and most users aren't using that tooling.\r\n\r\n> Would it make sense to switch some of the records over to a format that's more easy to inspect with a SQLite viewer? As well as use tables like \"transactions\"? Or would that make this PR far too complicated?\r\n\r\nI would like to do that in the future. But I think that is too complicated for right now.",
      "created_at" : "2020-06-01T15:58:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#issuecomment-636939984",
      "id" : 636939984,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19077",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNjkzOTk4NA==",
      "updated_at" : "2020-06-01T15:58:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/636939984",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I don't think it really makes sense to add a database system that we aren't going to use.\r\n\r\nMaybe it's time to use logdb.\r\n\r\n>Review and implementation are much simpler\r\n\r\nRealistically, this should be phrased \"review and implementation are behind closed doors by another team, and non-transparent\".\r\n\r\nWhile SQLite has a free license, it is not open development. I'm not sure if their review standards are even documented.\r\n\r\n> I've always liked sqlite as a versatile but still minimalistic\r\n\r\nNot sure SQLite counts as minimalistic... :p",
      "created_at" : "2020-06-03T18:03:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#issuecomment-638366578",
      "id" : 638366578,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19077",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzODM2NjU3OA==",
      "updated_at" : "2020-06-03T18:03:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/638366578",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Awesome.",
      "created_at" : "2020-06-11T20:33:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#issuecomment-642914167",
      "id" : 642914167,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19077",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MjkxNDE2Nw==",
      "updated_at" : "2020-06-11T20:33:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/642914167",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Since #19334 has been merged, this is now ready for review.",
      "created_at" : "2020-07-23T03:50:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#issuecomment-662805756",
      "id" : 662805756,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19077",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MjgwNTc1Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-23T03:50:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/662805756",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460269271"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460269271"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Change WalletLocation::Exists to check for wallet file existence\" (6e7ef52e359e55bc82a30207a701995f0ca255d7)\r\n\r\nMinor: I can't really figure out what this commit and also the previous commit \"wallet: Don't Verify if database location doesn't exist\" (b64e40310742e3975ae704a801ccafa73d8617bf) are doing. Changes seem harmless, but they are making code more complicated. It would be good if commit messages mentioned motivations in commits like these where the motivations aren't obvious.",
      "commit_id" : "ed80553046e47a96be27c8e12f69e98f4e8d3d74",
      "created_at" : "2020-07-24T20:20:16Z",
      "diff_hunk" : "@@ -101,9 +101,23 @@ WalletLocation::WalletLocation(const std::string& name)\n bool WalletLocation::Exists() const\n {\n     fs::path path = m_path;\n-    // For the default wallet, check specifically for the wallet.dat file\n-    if (m_name.empty()) {\n+\n+    fs::file_type path_type = fs::symlink_status(path).type();\n+    // Short circuit if it just doesn't exist\n+    if (path_type == fs::file_not_found) {\n+        return false;\n+    }\n+\n+    // If it's a file, it exists (duh)\n+    if (path_type == fs::regular_file) {\n+        return true;\n+    }\n+\n+    // If it's a directory, check specifically for the wallet.dat files\n+    if (path_type == fs::directory_file || (path_type == fs::symlink_file && fs::is_directory(path))) {\n         path = fs::absolute(\"wallet.dat\", m_path);\n+        return fs::symlink_status(path).type() != fs::file_not_found;\n     }\n-    return fs::symlink_status(path).type() != fs::file_not_found;\n+    // Something exists here but we don't know what it is... Just say something exists so an error can be caught later",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460269271",
      "id" : 460269271,
      "line" : 112,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI2OTI3MQ==",
      "original_commit_id" : "6e7ef52e359e55bc82a30207a701995f0ca255d7",
      "original_line" : 121,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 75,
      "pull_request_review_id" : 455162194,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-24T20:59:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460269271",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460275191"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460275191"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Add libsqlite3\" (31243f5482bb1c8a71affbe7ced6653a09bd6829)\r\n\r\nWould suggest splitting this commit and other build and depends and travis related commits into a separate build PR so it can get feedback from bitcoin build aficionados (and so this PR can more approachable for regular and wallet reviewers).\r\n\r\nI think probably build reviewers will want a `--with-sqlite` configure option to allow sqlite to be disabled in the build even if it is present in the system. They might also want the sqlite location to be determined through pkgconfig instead of assumed to be in the system include directory.",
      "commit_id" : "ed80553046e47a96be27c8e12f69e98f4e8d3d74",
      "created_at" : "2020-07-24T20:34:37Z",
      "diff_hunk" : "@@ -1138,6 +1138,9 @@ fi\n if test x$enable_wallet != xno; then\n     dnl Check for libdb_cxx only if wallet enabled\n     BITCOIN_FIND_BDB48\n+\n+    dnl Check for sqlite3\n+    AC_CHECK_HEADERS([sqlite3.h], [AC_CHECK_LIB([sqlite3], [sqlite3_open], [SQLITE_LIBS=-lsqlite3], [AC_MSG_ERROR(sqlite3_open missing from libsqlite3)], [-pthread -lpthread])], [AC_MSG_ERROR(sqlite3.h headers missing)])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460275191",
      "id" : 460275191,
      "line" : 1143,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI3NTE5MQ==",
      "original_commit_id" : "31243f5482bb1c8a71affbe7ced6653a09bd6829",
      "original_line" : 1143,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "configure.ac",
      "position" : 6,
      "pull_request_review_id" : 455162194,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-24T20:59:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460275191",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460276199"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460276199"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Constructors, destructors, and relevant private fields for SQLiteDatabase/Batch\" (08847ca4de58c112da4b6455230f7b454afa543c)\r\n\r\nMinor: Suggest `sqlite3* m_db{nullptr};` or `sqlite3* m_db = nullptr;` here to be sure this is safe without looking and even if someone adds another constructor.",
      "commit_id" : "ed80553046e47a96be27c8e12f69e98f4e8d3d74",
      "created_at" : "2020-07-24T20:37:14Z",
      "diff_hunk" : "@@ -83,6 +92,8 @@ class SQLiteDatabase : public WalletDatabase\n \n     /** Make a SQLiteBatch connected to this database */\n     std::unique_ptr<DatabaseBatch> MakeBatch(const char* mode = \"r+\", bool flush_on_close = true) override;\n+\n+    sqlite3* m_db;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460276199",
      "id" : 460276199,
      "line" : 103,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI3NjE5OQ==",
      "original_commit_id" : "08847ca4de58c112da4b6455230f7b454afa543c",
      "original_line" : 96,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "src/wallet/sqlite.h",
      "position" : 103,
      "pull_request_review_id" : 455162194,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-24T20:59:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460276199",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460278213"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460278213"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Introduce g_file_paths\" (d038d04a4e3e0522a51cf0d39110749f8395f61a)\r\n\r\nMinor: Pretty sure we can get rid of these globals with more sane loading code in the wallet, but in any case could consider switching RecursiveMutex to Mutex if possible and switching `cs_sqlite` to `g_sqlite_mutex` to follow newer conventions",
      "commit_id" : "ed80553046e47a96be27c8e12f69e98f4e8d3d74",
      "created_at" : "2020-07-24T20:41:46Z",
      "diff_hunk" : "@@ -5,12 +5,20 @@\n #include <wallet/sqlite.h>\n \n #include <logging.h>\n+#include <sync.h>\n #include <util/strencodings.h>\n #include <util/translation.h>\n #include <wallet/db.h>\n \n #include <sqlite3.h>\n #include <stdint.h>\n+#include <unordered_set>\n+\n+namespace {\n+    RecursiveMutex cs_sqlite;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460278213",
      "id" : 460278213,
      "line" : 19,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI3ODIxMw==",
      "original_commit_id" : "d038d04a4e3e0522a51cf0d39110749f8395f61a",
      "original_line" : 18,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/sqlite.cpp",
      "position" : 19,
      "pull_request_review_id" : 455162194,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-24T20:59:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460278213",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460279135"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460279135"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Implement SQLiteDatabaseVersion\" (b2f2e7171861fe2998f2c27af44b65b0e1f558aa)\r\n\r\nMinor: SQLiteLibraryVersion might be a more descriptive name",
      "commit_id" : "ed80553046e47a96be27c8e12f69e98f4e8d3d74",
      "created_at" : "2020-07-24T20:43:50Z",
      "diff_hunk" : "@@ -124,3 +125,8 @@ bool SQLiteBatch::TxnAbort()\n {\n     return false;\n }\n+\n+std::string SQLiteDatabaseVersion()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460279135",
      "id" : 460279135,
      "line" : 497,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI3OTEzNQ==",
      "original_commit_id" : "b2f2e7171861fe2998f2c27af44b65b0e1f558aa",
      "original_line" : 129,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/wallet/sqlite.cpp",
      "position" : 497,
      "pull_request_review_id" : 455162194,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-24T20:59:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460279135",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460280638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460280638"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Initialize and Shutdown sqlite3 globals\" (5c78c9094a0158e4d466b696a3bbbcbd35b51b15)\r\n\r\nMinor: Would add comment saying this is a no-op if it is already called. Another option would be to only call it when g_file_paths is empty.",
      "commit_id" : "ed80553046e47a96be27c8e12f69e98f4e8d3d74",
      "created_at" : "2020-07-24T20:47:36Z",
      "diff_hunk" : "@@ -34,6 +34,10 @@ SQLiteDatabase::SQLiteDatabase(const fs::path& dir_path, const fs::path& file_pa\n     LogPrintf(\"Using SQLite Version %s\\n\", SQLiteDatabaseVersion());\n     LogPrintf(\"Using wallet %s\\n\", m_dir_path);\n \n+    int ret = sqlite3_initialize();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460280638",
      "id" : 460280638,
      "line" : 52,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI4MDYzOA==",
      "original_commit_id" : "5c78c9094a0158e4d466b696a3bbbcbd35b51b15",
      "original_line" : 37,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/sqlite.cpp",
      "position" : 52,
      "pull_request_review_id" : 455162194,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-24T20:59:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460280638",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460281099"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460281099"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Initialize and Shutdown sqlite3 globals\" (5c78c9094a0158e4d466b696a3bbbcbd35b51b15)\r\n\r\nReturn value isn't checked here. Would suggest at least logging an error so we know if something has gone wrong.",
      "commit_id" : "ed80553046e47a96be27c8e12f69e98f4e8d3d74",
      "created_at" : "2020-07-24T20:48:46Z",
      "diff_hunk" : "@@ -44,6 +48,9 @@ SQLiteDatabase::~SQLiteDatabase()\n     Close();\n     LOCK(cs_sqlite);\n     g_file_paths.erase(m_file_path);\n+    if (g_file_paths.empty()) {\n+        sqlite3_shutdown();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460281099",
      "id" : 460281099,
      "line" : 114,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI4MTA5OQ==",
      "original_commit_id" : "5c78c9094a0158e4d466b696a3bbbcbd35b51b15",
      "original_line" : 52,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/wallet/sqlite.cpp",
      "position" : 114,
      "pull_request_review_id" : 455162194,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-24T20:59:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460281099",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> If it's available, I'd be curious to see a diff of the additional changes that switch `wallet.dat` to `wallet.sqlite` and how complicated they are.\r\n\r\nhttps://github.com/achow101/bitcoin/tree/sqlite-wallet-w-rename is a copy of the original branch with the rename. It's a bit outdated, but it should give you an idea of what was needed for renaming.\r\n\r\n  > Do we know how current & previous versions of bitcoins react if they load a `wallet.dat` file that doesn't contain berkeley db data? Hopefully they show a sensible error instead of crashing obscurely or doing something worse like modifying the file.\r\n\r\nThe wallets won't be listed by `listwalletdir` as the bdb magic is checked in that function. BDB itself will error with `Not a Berkeley DB` (or something like that) when it tries to open the sqlite file and that error makes it's way to the user.",
      "created_at" : "2020-07-24T21:17:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#issuecomment-663738278",
      "id" : 663738278,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19077",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MzczODI3OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-24T21:17:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/663738278",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460293438"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460293438"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The motivation is so that we check the wallet file itself as part of the db type checking later on. IIRC there were some issues with where the wrong file type was being used that necessitated these changes.\r\n\r\nI'll try to expand the commit message ",
      "commit_id" : "ed80553046e47a96be27c8e12f69e98f4e8d3d74",
      "created_at" : "2020-07-24T21:20:52Z",
      "diff_hunk" : "@@ -101,9 +101,23 @@ WalletLocation::WalletLocation(const std::string& name)\n bool WalletLocation::Exists() const\n {\n     fs::path path = m_path;\n-    // For the default wallet, check specifically for the wallet.dat file\n-    if (m_name.empty()) {\n+\n+    fs::file_type path_type = fs::symlink_status(path).type();\n+    // Short circuit if it just doesn't exist\n+    if (path_type == fs::file_not_found) {\n+        return false;\n+    }\n+\n+    // If it's a file, it exists (duh)\n+    if (path_type == fs::regular_file) {\n+        return true;\n+    }\n+\n+    // If it's a directory, check specifically for the wallet.dat files\n+    if (path_type == fs::directory_file || (path_type == fs::symlink_file && fs::is_directory(path))) {\n         path = fs::absolute(\"wallet.dat\", m_path);\n+        return fs::symlink_status(path).type() != fs::file_not_found;\n     }\n-    return fs::symlink_status(path).type() != fs::file_not_found;\n+    // Something exists here but we don't know what it is... Just say something exists so an error can be caught later",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19077#discussion_r460293438",
      "id" : 460293438,
      "in_reply_to_id" : 460269271,
      "line" : 112,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MDI5MzQzOA==",
      "original_commit_id" : "6e7ef52e359e55bc82a30207a701995f0ca255d7",
      "original_line" : 121,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/wallet/walletutil.cpp",
      "position" : 75,
      "pull_request_review_id" : 455192029,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19077",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-24T21:20:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/460293438",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
