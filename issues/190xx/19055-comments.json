[
   {
      "author_association" : "MEMBER",
      "body" : "Reviewers: This PR is being discussed in the review club at https://bitcoincore.reviews/19055\r\n\r\n(A `Review club` tag for this PR would be helpful to indicate that review notes and discussion are available there.)",
      "created_at" : "2020-05-26T11:38:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-633971712",
      "id" : 633971712,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMzk3MTcxMg==",
      "updated_at" : "2020-05-26T11:38:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633971712",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Some history for the context:\r\n* https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2017-May/014337.html\r\n* based on #10434",
      "created_at" : "2020-05-26T12:02:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-633981639",
      "id" : 633981639,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMzk4MTYzOQ==",
      "updated_at" : "2020-05-26T12:02:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633981639",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gzhao408 I think there is a bit of a miscommunication. The term \"rolling\" here just means efficient addition as well as deletion from the set being hashed. There is no actual window, as sets are unordered. Perhaps the term was chosen badly (which would be my fault).\r\n\r\nAll of LtHash, MuHash, and ECMH support incremental addition and deletion. The \"non-rolling\" mention in @fjahr's document refers to the fact that he hasn't implemented continuous UTXO set hashing with these functions, only a from scratch computation. It has nothing to do with what these functions can or can't do.\r\n\r\nThe primary difference between MuHash and ECMH is caching:\r\n\r\n* ECMH is more CPU time overall, but the time is mostly in computing the \"effect\" of a set of additions/deletions; applying that effect to the overall hash is extremely cheap. Furthermore, a 64-byte precomputed \"patch\" per set of additions/deletions can be created, which means a patch could be cached per-transaction, and then very cheaply applied when the transaction confirms. So it allows doing most of the work ahead of time (before the block arrives).\r\n\r\n* MuHash is cheaper overall, but the time is mostly in applying the changes to the overall hash. This means caching isn't very useful (and also the caches would be 768 bytes, which is pretty large). If the intent is computing things in the background, or at block connection time, then this is a better (and simpler) approach.",
      "created_at" : "2020-05-26T16:45:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-634142704",
      "id" : 634142704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDE0MjcwNA==",
      "updated_at" : "2020-05-26T16:45:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634142704",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "AaaAHhhh, thank you @sipa for the clarification! \r\n\r\n> The term \"rolling\" here just means efficient addition as well as deletion from the set being hashed.\r\n> The \"non-rolling\" mention in @fjahr's document refers to the fact that he hasn't implemented continuous UTXO set hashing with these functions\r\n\r\nThis makes a lot more sense; I had thought he meant the hash function itself is rolling/non-rolling. I didn't have much info but was super interested and went for a textbook definition ð now I feel embarrassed. This information is super helpful, thanks!",
      "created_at" : "2020-05-26T17:08:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-634155367",
      "id" : 634155367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDE1NTM2Nw==",
      "updated_at" : "2020-05-26T17:08:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634155367",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/gzhao408/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gzhao408/followers",
         "following_url" : "https://api.github.com/users/gzhao408/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gzhao408/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gzhao408",
         "id" : 25183001,
         "login" : "gzhao408",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/gzhao408/orgs",
         "received_events_url" : "https://api.github.com/users/gzhao408/received_events",
         "repos_url" : "https://api.github.com/users/gzhao408/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gzhao408/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gzhao408/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gzhao408"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> It also seems that ECMH (which is noted as non-rolling) performed better and has a maintainability plus since it's part of Secp256k1.\r\n\r\nPlease also note that there is an implementation of ECMH that is an open pull request to Secp256k1 but it is not merged and has been stale for some time. So the work to get it merged is more or less the same and I don't think there is a big difference in maintainability between having it in core or secp.",
      "created_at" : "2020-05-26T18:44:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-634207235",
      "id" : 634207235,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDIwNzIzNQ==",
      "updated_at" : "2020-05-26T18:44:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634207235",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@fjahr I've written a Python implementation of MuHash3072, so it can be more easily tested: https://github.com/sipa/bitcoin/commits/202005_muhash_python (no tests are included, but I've verified it matches the C++ code in a few simple examples).",
      "created_at" : "2020-05-26T21:14:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-634282984",
      "id" : 634282984,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDI4Mjk4NA==",
      "updated_at" : "2020-05-26T21:14:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634282984",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-05-26T21:15:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-634283316",
      "id" : 634283316,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDI4MzMxNg==",
      "updated_at" : "2020-05-26T21:15:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634283316",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @fjahr I've written a Python implementation of MuHash3072, so it can be more easily tested: [sipa/bitcoin@`202005_muhash_python` (commits)](https://github.com/sipa/bitcoin/commits/202005_muhash_python) (no tests are included, but I've verified it matches the C++ code in a few simple examples).\r\n\r\nAwesome, I have just pulled it in here and will build further tests on top of it.",
      "created_at" : "2020-05-26T22:22:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-634312013",
      "id" : 634312013,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDMxMjAxMw==",
      "updated_at" : "2020-05-26T22:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634312013",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased and added a6cf0df104728a587283578735e7f11c5f0f2ae4 which allows the user to use the legacy hash with the use of a flag. This will definitely be squashed but I decided to keep it separate for the moment to make discussions easier in the review club tomorrow. I figured I would need to do something like this anyway in order go through a deprecation cycle with `gettxoutsetinfo`, the question is if that is still needed with the flag. Also added 4438aed09e87de0afb37da64ffb5e7489084e8ab which is @sipa 's python implementation of Muhash, currently unused.",
      "created_at" : "2020-05-26T22:28:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-634314204",
      "id" : 634314204,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDMxNDIwNA==",
      "updated_at" : "2020-05-26T22:28:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634314204",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r431080029"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/431080029"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ced54242 nit: sort",
      "commit_id" : "8a3ad8e6f17a96006f63ea5553095f5c85378761",
      "created_at" : "2020-05-27T12:31:37Z",
      "diff_hunk" : "@@ -388,6 +388,8 @@ crypto_libbitcoin_crypto_base_a_SOURCES = \\\n   crypto/hmac_sha512.h \\\n   crypto/poly1305.h \\\n   crypto/poly1305.cpp \\\n+  crypto/muhash.cpp \\\n+  crypto/muhash.h \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r431080029",
      "id" : 431080029,
      "line" : 391,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTA4MDAyOQ==",
      "original_commit_id" : "4438aed09e87de0afb37da64ffb5e7489084e8ab",
      "original_line" : 391,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/Makefile.am",
      "position" : 4,
      "pull_request_review_id" : 419143541,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T20:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/431080029",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r431132007"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/431132007"
         }
      },
      "author_association" : "MEMBER",
      "body" : "cda20f3 nit: perhaps sort the functions above and this list, e.g. like\r\n\r\n```\r\n$ src/bench/bench_bitcoin -list\r\n...\r\nMuHash, 5, 5000, 0, 0, 0, 0\r\nMuHashAdd, 5, 5000, 0, 0, 0, 0\r\nMuHashDiv, 5, 100, 0, 0, 0, 0\r\nMuHashPrecompute, 5, 5000, 0, 0, 0, 0\r\n\r\n$ src/bench/bench_bitcoin -filter=MuHash*.*\r\n# Benchmark, evals, iterations, total, min, max, median\r\nMuHash, 5, 5000, 0.287426, 7.45603e-06, 1.72302e-05, 1.08339e-05\r\nMuHashAdd, 5, 5000, 0.243778, 7.93741e-06, 1.17234e-05, 9.61388e-06\r\nMuHashDiv, 5, 100, 8.62069, 0.0146344, 0.0216452, 0.0169485\r\nMuHashPrecompute, 5, 5000, 0.0557224, 1.55965e-06, 4.40565e-06, 1.65373e-06\r\n```\r\n",
      "commit_id" : "8a3ad8e6f17a96006f63ea5553095f5c85378761",
      "created_at" : "2020-05-27T13:30:41Z",
      "diff_hunk" : "@@ -101,3 +166,8 @@ BENCHMARK(SipHash_32b, 40 * 1000 * 1000);\n BENCHMARK(SHA256D64_1024, 7400);\n BENCHMARK(FastRandom_32bit, 110 * 1000 * 1000);\n BENCHMARK(FastRandom_1bit, 440 * 1000 * 1000);\n+\n+BENCHMARK(MuHash, 5000);\n+BENCHMARK(MuHashPrecompute, 5000);\n+BENCHMARK(MuHashAdd, 5000);\n+BENCHMARK(MuHashDiv, 100);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r431132007",
      "id" : 431132007,
      "line" : 172,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTEzMjAwNw==",
      "original_commit_id" : "4438aed09e87de0afb37da64ffb5e7489084e8ab",
      "original_line" : 172,
      "original_position" : 87,
      "original_start_line" : null,
      "path" : "src/bench/crypto_hash.cpp",
      "position" : 86,
      "pull_request_review_id" : 419143541,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T20:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/431132007",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r431151719"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/431151719"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ced54242 and cda20f3f nit: in these four functions above `++i` is preferred over `i++` per doc/developer-notes.md\r\n\r\n5d67c47 same for `src/crypto/muhash.h::L71`",
      "commit_id" : "8a3ad8e6f17a96006f63ea5553095f5c85378761",
      "created_at" : "2020-05-27T13:56:46Z",
      "diff_hunk" : "@@ -91,6 +92,70 @@ static void FastRandom_1bit(benchmark::State& state)\n     }\n }\n \n+static void MuHash(benchmark::State& state)\n+{\n+    FastRandomContext rng(true);\n+    MuHash3072 acc;\n+    unsigned char key[32] = {0};\n+    int i = 0;\n+    while (state.KeepRunning()) {\n+        key[0] = ++i;\n+        acc *= MuHash3072(key);\n+    }\n+}\n+\n+static void MuHashPrecompute(benchmark::State& state)\n+{\n+    FastRandomContext rng(true);\n+    MuHash3072 acc;\n+    unsigned char key[32];\n+    std::vector<unsigned char> randkey = rng.randbytes(32);\n+    for (size_t i = 0; i < randkey.size(); i++) {\n+        key[i] = randkey[i];\n+    }\n+\n+    while (state.KeepRunning()) {\n+        MuHash3072{key};\n+    }\n+}\n+\n+static void MuHashAdd(benchmark::State& state)\n+{\n+    FastRandomContext rng(true);\n+    MuHash3072 acc;\n+    unsigned char key[32];\n+    std::vector<unsigned char> randkey = rng.randbytes(32);\n+    for (size_t i = 0; i < randkey.size(); i++) {\n+        key[i] = randkey[i];\n+    }\n+\n+    MuHash3072 muhash = MuHash3072(key);\n+    while (state.KeepRunning()) {\n+        acc *= muhash;\n+    }\n+}\n+\n+static void MuHashDiv(benchmark::State& state)\n+{\n+    FastRandomContext rng(true);\n+    MuHash3072 acc;\n+    unsigned char key[32];\n+    std::vector<unsigned char> randkey = rng.randbytes(32);\n+    for (size_t i = 0; i < randkey.size(); i++) {\n+        key[i] = randkey[i];\n+    }\n+\n+    MuHash3072 muhash = MuHash3072(key);\n+\n+    for (size_t i = 0; i < state.m_num_iters; i++) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r431151719",
      "id" : 431151719,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE1MTcxOQ==",
      "original_commit_id" : "4438aed09e87de0afb37da64ffb5e7489084e8ab",
      "original_line" : 150,
      "original_position" : 67,
      "original_start_line" : null,
      "path" : "src/bench/crypto_hash.cpp",
      "position" : null,
      "pull_request_review_id" : 419143541,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T20:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/431151719",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r431199564"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/431199564"
         }
      },
      "author_association" : "MEMBER",
      "body" : "a6cf0df1 could add the new `bool GetUTXOStats()` next to the existing one -- to ease review, I moved them together.",
      "commit_id" : "8a3ad8e6f17a96006f63ea5553095f5c85378761",
      "created_at" : "2020-05-27T14:53:12Z",
      "diff_hunk" : "@@ -66,9 +97,38 @@ bool GetUTXOStats(CCoinsView* view, CCoinsStats& stats, const std::function<void\n         pcursor->Next();\n     }\n     if (!outputs.empty()) {\n-        ApplyStats(stats, ss, prevkey, outputs);\n+        ApplyStats(stats, hash, prevkey, outputs);\n     }\n-    stats.hashSerialized = ss.GetHash();\n+\n+    FinalizeHash(hash, stats);\n+\n     stats.nDiskSize = view->EstimateSize();\n     return true;\n }\n+\n+// The legacy hash serializes the hashBlock\n+void PrepareHash(CHashWriter& hash, CCoinsStats& stats) {\n+    hash << stats.hashBlock;\n+}\n+// Muhash does not need the prepare step\n+void PrepareHash(MuHash3072 hash, CCoinsStats& stats) {}\n+\n+void FinalizeHash(CHashWriter& hash, CCoinsStats& stats) {\n+    stats.hashSerialized = hash.GetHash();\n+}\n+void FinalizeHash(MuHash3072 hash, CCoinsStats& stats) {\n+    unsigned char out[384];\n+    hash.Finalize(out);\n+    stats.hashSerialized = (TruncatedSHA512Writer(SER_DISK, 0) << out).GetHash();\n+}\n+\n+bool GetUTXOStats(CCoinsView *view, CCoinsStats &stats, const std::function<void()>& interruption_point, bool use_muhash)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r431199564",
      "id" : 431199564,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTE5OTU2NA==",
      "original_commit_id" : "4438aed09e87de0afb37da64ffb5e7489084e8ab",
      "original_line" : 125,
      "original_position" : 119,
      "original_start_line" : null,
      "path" : "src/node/coinstats.cpp",
      "position" : null,
      "pull_request_review_id" : 419143541,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T20:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/431199564",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Also verified that, like your added test in `rpc_blockchain.py`, only `utxo_set_hash` varies between `gettxoutsetinfo` in -regtest with each algo.\r\n\r\n```bash \r\n$ bitcoin-cli -regtest gettxoutsetinfo\r\n{\r\n  \"height\": 15599,\r\n  \"bestblock\": \"6e535bc570f9be1b86d21711b23391e4e8f001682b5c6243883744879cdc4f84\",\r\n  \"transactions\": 3216,\r\n  \"txouts\": 3219,\r\n  \"bogosize\": 234987,\r\n  \"utxo_set_hash\": \"c4926481130f6689950e07e0e1f2060277d349b106a94b83145d577d3db4d225\",\r\n  \"disk_size\": 226234,\r\n  \"total_amount\": 14949.99998350\r\n}\r\n$ bitcoin-cli -regtest gettxoutsetinfo true\r\n{\r\n  \"height\": 15599,\r\n  \"bestblock\": \"6e535bc570f9be1b86d21711b23391e4e8f001682b5c6243883744879cdc4f84\",\r\n  \"transactions\": 3216,\r\n  \"txouts\": 3219,\r\n  \"bogosize\": 234987,\r\n  \"utxo_set_hash\": \"1883e99e56927fd5e3b82ccb9e08acd1be7ed0256d4cafe142626ae2fb66ffb4\",\r\n  \"disk_size\": 226234,\r\n  \"total_amount\": 14949.99998350\r\n}\r\n```",
      "created_at" : "2020-05-27T16:01:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-634764233",
      "id" : 634764233,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDc2NDIzMw==",
      "updated_at" : "2020-05-27T18:09:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634764233",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: \"separate\" is misspelled in the commit title of cda20f3f897ff88337756cb0c0345b41cec9014e\r\n\r\nIt might be nice to split this in two PRs: One which adds MuHash, and one which updates `gettxoutsetinfo` to support it. I would definitely at least rebase/squash to put all the MuHash additions first and then layer the functionality changes on top.\r\n\r\nEdited to add thought: The next PR could add rolling as well, so this way we don't have an interim state where `gettxoutsetinfo` is even slower than it is now.",
      "created_at" : "2020-05-27T17:10:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-634809748",
      "id" : 634809748,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDgwOTc0OA==",
      "updated_at" : "2020-05-27T17:23:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634809748",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/177646?v=4",
         "events_url" : "https://api.github.com/users/narula/events{/privacy}",
         "followers_url" : "https://api.github.com/users/narula/followers",
         "following_url" : "https://api.github.com/users/narula/following{/other_user}",
         "gists_url" : "https://api.github.com/users/narula/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/narula",
         "id" : 177646,
         "login" : "narula",
         "node_id" : "MDQ6VXNlcjE3NzY0Ng==",
         "organizations_url" : "https://api.github.com/users/narula/orgs",
         "received_events_url" : "https://api.github.com/users/narula/received_events",
         "repos_url" : "https://api.github.com/users/narula/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/narula/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/narula/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/narula"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2020-05-27T20:04:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-634910640",
      "id" : 634910640,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDkxMDY0MA==",
      "updated_at" : "2020-05-29T17:21:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634910640",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r431778760"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/431778760"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n                    {\"hash_type\", RPCArg::Type::STR, /* default */ \"hash_serialized_2\", \"Which UTXO set hash should be calculated. Options: 'hash_serialized_2' (the legacy algorithm), 'muhash', 'none'.\"},\r\n```\r\n\r\nHow much time is spent on hashing with the legacy hash vs muhash vs none? Imagine someone just wants the `total_amount` as fast as possible.\r\n\r\nIf hashing is slow in general, maybe there should be an option to skip it?",
      "commit_id" : "8a3ad8e6f17a96006f63ea5553095f5c85378761",
      "created_at" : "2020-05-28T11:53:20Z",
      "diff_hunk" : "@@ -971,7 +971,9 @@ static UniValue gettxoutsetinfo(const JSONRPCRequest& request)\n             RPCHelpMan{\"gettxoutsetinfo\",\n                 \"\\nReturns statistics about the unspent transaction output set.\\n\"\n                 \"Note this call may take some time.\\n\",\n-                {},\n+                {\n+                    {\"legacy_hash\", RPCArg::Type::BOOL, /* default */ \"false\", \"Whether the UTXO set hash should be calculated using the legacy algorithm (not Muhash).\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r431778760",
      "id" : 431778760,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTc3ODc2MA==",
      "original_commit_id" : "4438aed09e87de0afb37da64ffb5e7489084e8ab",
      "original_line" : 975,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 420031955,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T20:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/431778760",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r431944665"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/431944665"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It's a good question but based on my tests (with commented out hashing code) the performance impact of `hash_serialized2` is only small. Results were volatile but on average `gettxoutsetinfo` without the hash was only a few seconds faster (5s - 20s faster, an improvement of ~10%). I think it's not really worth adding an option for that if we can have the index instead.",
      "commit_id" : "8a3ad8e6f17a96006f63ea5553095f5c85378761",
      "created_at" : "2020-05-28T15:54:19Z",
      "diff_hunk" : "@@ -971,7 +971,9 @@ static UniValue gettxoutsetinfo(const JSONRPCRequest& request)\n             RPCHelpMan{\"gettxoutsetinfo\",\n                 \"\\nReturns statistics about the unspent transaction output set.\\n\"\n                 \"Note this call may take some time.\\n\",\n-                {},\n+                {\n+                    {\"legacy_hash\", RPCArg::Type::BOOL, /* default */ \"false\", \"Whether the UTXO set hash should be calculated using the legacy algorithm (not Muhash).\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r431944665",
      "id" : 431944665,
      "in_reply_to_id" : 431778760,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMTk0NDY2NQ==",
      "original_commit_id" : "4438aed09e87de0afb37da64ffb5e7489084e8ab",
      "original_line" : 975,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 420256522,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T20:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/431944665",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r432425903"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432425903"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thinking about it a little bit more, I think it would be good to have the option for later on when we want to remove the code for `hash_serialized_2`. So I will add it as an option.",
      "commit_id" : "8a3ad8e6f17a96006f63ea5553095f5c85378761",
      "created_at" : "2020-05-29T11:36:13Z",
      "diff_hunk" : "@@ -971,7 +971,9 @@ static UniValue gettxoutsetinfo(const JSONRPCRequest& request)\n             RPCHelpMan{\"gettxoutsetinfo\",\n                 \"\\nReturns statistics about the unspent transaction output set.\\n\"\n                 \"Note this call may take some time.\\n\",\n-                {},\n+                {\n+                    {\"legacy_hash\", RPCArg::Type::BOOL, /* default */ \"false\", \"Whether the UTXO set hash should be calculated using the legacy algorithm (not Muhash).\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r432425903",
      "id" : 432425903,
      "in_reply_to_id" : 431778760,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQyNTkwMw==",
      "original_commit_id" : "4438aed09e87de0afb37da64ffb5e7489084e8ab",
      "original_line" : 975,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 420873318,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T20:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432425903",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r432426282"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432426282"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "now out of scope of this PR but will reorg it in the follow-up",
      "commit_id" : "8a3ad8e6f17a96006f63ea5553095f5c85378761",
      "created_at" : "2020-05-29T11:37:08Z",
      "diff_hunk" : "@@ -66,9 +97,38 @@ bool GetUTXOStats(CCoinsView* view, CCoinsStats& stats, const std::function<void\n         pcursor->Next();\n     }\n     if (!outputs.empty()) {\n-        ApplyStats(stats, ss, prevkey, outputs);\n+        ApplyStats(stats, hash, prevkey, outputs);\n     }\n-    stats.hashSerialized = ss.GetHash();\n+\n+    FinalizeHash(hash, stats);\n+\n     stats.nDiskSize = view->EstimateSize();\n     return true;\n }\n+\n+// The legacy hash serializes the hashBlock\n+void PrepareHash(CHashWriter& hash, CCoinsStats& stats) {\n+    hash << stats.hashBlock;\n+}\n+// Muhash does not need the prepare step\n+void PrepareHash(MuHash3072 hash, CCoinsStats& stats) {}\n+\n+void FinalizeHash(CHashWriter& hash, CCoinsStats& stats) {\n+    stats.hashSerialized = hash.GetHash();\n+}\n+void FinalizeHash(MuHash3072 hash, CCoinsStats& stats) {\n+    unsigned char out[384];\n+    hash.Finalize(out);\n+    stats.hashSerialized = (TruncatedSHA512Writer(SER_DISK, 0) << out).GetHash();\n+}\n+\n+bool GetUTXOStats(CCoinsView *view, CCoinsStats &stats, const std::function<void()>& interruption_point, bool use_muhash)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r432426282",
      "id" : 432426282,
      "in_reply_to_id" : 431199564,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQyNjI4Mg==",
      "original_commit_id" : "4438aed09e87de0afb37da64ffb5e7489084e8ab",
      "original_line" : 125,
      "original_position" : 119,
      "original_start_line" : null,
      "path" : "src/node/coinstats.cpp",
      "position" : null,
      "pull_request_review_id" : 420873836,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T20:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432426282",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r432426338"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432426338"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "8a3ad8e6f17a96006f63ea5553095f5c85378761",
      "created_at" : "2020-05-29T11:37:15Z",
      "diff_hunk" : "@@ -91,6 +92,70 @@ static void FastRandom_1bit(benchmark::State& state)\n     }\n }\n \n+static void MuHash(benchmark::State& state)\n+{\n+    FastRandomContext rng(true);\n+    MuHash3072 acc;\n+    unsigned char key[32] = {0};\n+    int i = 0;\n+    while (state.KeepRunning()) {\n+        key[0] = ++i;\n+        acc *= MuHash3072(key);\n+    }\n+}\n+\n+static void MuHashPrecompute(benchmark::State& state)\n+{\n+    FastRandomContext rng(true);\n+    MuHash3072 acc;\n+    unsigned char key[32];\n+    std::vector<unsigned char> randkey = rng.randbytes(32);\n+    for (size_t i = 0; i < randkey.size(); i++) {\n+        key[i] = randkey[i];\n+    }\n+\n+    while (state.KeepRunning()) {\n+        MuHash3072{key};\n+    }\n+}\n+\n+static void MuHashAdd(benchmark::State& state)\n+{\n+    FastRandomContext rng(true);\n+    MuHash3072 acc;\n+    unsigned char key[32];\n+    std::vector<unsigned char> randkey = rng.randbytes(32);\n+    for (size_t i = 0; i < randkey.size(); i++) {\n+        key[i] = randkey[i];\n+    }\n+\n+    MuHash3072 muhash = MuHash3072(key);\n+    while (state.KeepRunning()) {\n+        acc *= muhash;\n+    }\n+}\n+\n+static void MuHashDiv(benchmark::State& state)\n+{\n+    FastRandomContext rng(true);\n+    MuHash3072 acc;\n+    unsigned char key[32];\n+    std::vector<unsigned char> randkey = rng.randbytes(32);\n+    for (size_t i = 0; i < randkey.size(); i++) {\n+        key[i] = randkey[i];\n+    }\n+\n+    MuHash3072 muhash = MuHash3072(key);\n+\n+    for (size_t i = 0; i < state.m_num_iters; i++) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r432426338",
      "id" : 432426338,
      "in_reply_to_id" : 431151719,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQyNjMzOA==",
      "original_commit_id" : "4438aed09e87de0afb37da64ffb5e7489084e8ab",
      "original_line" : 150,
      "original_position" : 67,
      "original_start_line" : null,
      "path" : "src/bench/crypto_hash.cpp",
      "position" : null,
      "pull_request_review_id" : 420873910,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T20:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432426338",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r432426405"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432426405"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "8a3ad8e6f17a96006f63ea5553095f5c85378761",
      "created_at" : "2020-05-29T11:37:23Z",
      "diff_hunk" : "@@ -101,3 +166,8 @@ BENCHMARK(SipHash_32b, 40 * 1000 * 1000);\n BENCHMARK(SHA256D64_1024, 7400);\n BENCHMARK(FastRandom_32bit, 110 * 1000 * 1000);\n BENCHMARK(FastRandom_1bit, 440 * 1000 * 1000);\n+\n+BENCHMARK(MuHash, 5000);\n+BENCHMARK(MuHashPrecompute, 5000);\n+BENCHMARK(MuHashAdd, 5000);\n+BENCHMARK(MuHashDiv, 100);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r432426405",
      "id" : 432426405,
      "in_reply_to_id" : 431132007,
      "line" : 172,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQyNjQwNQ==",
      "original_commit_id" : "4438aed09e87de0afb37da64ffb5e7489084e8ab",
      "original_line" : 172,
      "original_position" : 87,
      "original_start_line" : null,
      "path" : "src/bench/crypto_hash.cpp",
      "position" : 86,
      "pull_request_review_id" : 420873991,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T20:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432426405",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r432426468"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432426468"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "8a3ad8e6f17a96006f63ea5553095f5c85378761",
      "created_at" : "2020-05-29T11:37:31Z",
      "diff_hunk" : "@@ -388,6 +388,8 @@ crypto_libbitcoin_crypto_base_a_SOURCES = \\\n   crypto/hmac_sha512.h \\\n   crypto/poly1305.h \\\n   crypto/poly1305.cpp \\\n+  crypto/muhash.cpp \\\n+  crypto/muhash.h \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r432426468",
      "id" : 432426468,
      "in_reply_to_id" : 431080029,
      "line" : 391,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjQyNjQ2OA==",
      "original_commit_id" : "4438aed09e87de0afb37da64ffb5e7489084e8ab",
      "original_line" : 391,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/Makefile.am",
      "position" : 4,
      "pull_request_review_id" : 420874073,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T20:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432426468",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It looks like you removed a bunch of code, and the functional tests, in the last push? If yes, review effort is being thrown away, and perhaps the PR description needs to be updated.",
      "created_at" : "2020-05-29T12:51:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-635955599",
      "id" : 635955599,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNTk1NTU5OQ==",
      "updated_at" : "2020-05-29T12:52:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635955599",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> It looks like you removed a bunch of code, and the functional tests, in the last push? If yes, review effort is being thrown away, and perhaps the PR description needs to be updated.\r\n\r\nYes, I am writing an update at the moment",
      "created_at" : "2020-05-29T12:53:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-635956325",
      "id" : 635956325,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNTk1NjMyNQ==",
      "updated_at" : "2020-05-29T12:53:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635956325",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> nit: \"separate\" is misspelled in the commit title of [cda20f3](https://github.com/bitcoin/bitcoin/commit/cda20f3f897ff88337756cb0c0345b41cec9014e)\r\n\r\ndone\r\n\r\n",
      "created_at" : "2020-05-29T12:53:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-635956487",
      "id" : 635956487,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNTk1NjQ4Nw==",
      "updated_at" : "2020-05-29T12:53:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635956487",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for all the reviews so far! I have addressed comments and, based on feedback from the PR review club and others, split it up further to make reviews more manageable and keep discussions more focussed. This now only adds the implementation of `Muhash3072` and `TruncatedSHA512` in C++. The next in the series is https://github.com/bitcoin/bitcoin/pull/19105 and will only add the Python implementation. A PR review club on it will give another chance to dive deeper into implementation details of Muhash3072. The third PR will add let the user use `gettxoutsetinfo` with Muhash, taking feedback into account (WIP). Progress of the different pull requests is now tracked in #18000 (top of the description).",
      "created_at" : "2020-05-29T13:03:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-635960689",
      "id" : 635960689,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNTk2MDY4OQ==",
      "updated_at" : "2020-05-29T13:03:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635960689",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> * This PR essentially makes `gettxoutsetinfo` too slow to be useable in testnet and mainnet (it times out and raises after 15 minutes); for that reason, until the -coinstatsindex in #18000 is merged, the MuHash algorithm should be opt-in for rpc `gettxoutsetinfo` and not the default\r\n\r\nWill do so in the follow-up that adds the option to the RPC.\r\n\r\n> * What are your plans regarding ECMH?\r\n\r\nI don't have plans for it unless there is a reason to reconsider it as the algorithm of choice over Muhash. The branch with the ECMH implementation in secp256k1 is still there if people want to play with it.\r\n\r\n> * it looks like `TruncatedSHA512Writer` could use unit tests (perhaps just sanity checks if not viable to use test vectors, `CHashWriter` is also not tested directly but used by other unit tests: addrman, hash, sighash)\r\n\r\nI have laid out some thoughts on it [here]( https://github.com/bitcoin/bitcoin/pull/18000#issuecomment-629296641) why it is hard to add meaningful unit tests. I am still thinking about a better solution and might add an implementation of SHA512/256. There is a single sanity check at the bottom of the Muhash test at least. \r\n\r\n> * a fuzz harness would be ideal\r\n\r\nYeah, as I mention in my answer to Sjors, I would like to add it as a follow-up.\r\n\r\n> * do you plan to add tests using the just-added Python MuHash3072 implementation?\r\n\r\n Yes\r\n\r\n> * [06ae4ab](https://github.com/bitcoin/bitcoin/commit/06ae4ab04f010b24bad03ea6a3c728848cd28545) commit message s/256/512/?\r\n\r\ndone\r\n\r\n> * [04d088d](https://github.com/bitcoin/bitcoin/commit/04d088da106d8c7df0d629d21416c824d6568d18) commit message could mention the renaming of `hash_serialized_2` to `utxo_set_hash` and why it was changed (I didn't see any explanation anywhere)\r\n\r\nI was going back and forth on this, which is probably why it is not mentioned. Initially it was named `muhash`, then I thought it should be more general name that makes more sense to the user. But now my tendency is back to naming it muhash, since we want to keep `hash_serialized_2` for longer and there is no guarantee that there will not be another algo used some time in the future which would mean we would probably need to rename it again in order to avoid confusion.\r\n\r\n> * [04d088d](https://github.com/bitcoin/bitcoin/commit/04d088da106d8c7df0d629d21416c824d6568d18) and [a6cf0df](https://github.com/bitcoin/bitcoin/commit/a6cf0df104728a587283578735e7f11c5f0f2ae4) ought to be squashed to one commit; keeping them separate unnecessarily complicates reviewing -- I squashed them locally in order to see the relevant diff, as ApplyStats() is weird enough to review already\r\n\r\nYes, done in follow-up pr\r\n\r\n> * at some point you'll want to add a release note\r\n\r\nyepp\r\n",
      "created_at" : "2020-05-29T13:17:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-635967249",
      "id" : 635967249,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNTk2NzI0OQ==",
      "updated_at" : "2020-05-29T13:17:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635967249",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think it'd be easier to review this code if the PR didn't include the ASM implementation.",
      "created_at" : "2020-06-05T18:29:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-639690930",
      "id" : 639690930,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzOTY5MDkzMA==",
      "updated_at" : "2020-06-05T18:29:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/639690930",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r436143516"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436143516"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is now implemented in #19145.",
      "commit_id" : "8a3ad8e6f17a96006f63ea5553095f5c85378761",
      "created_at" : "2020-06-05T20:14:59Z",
      "diff_hunk" : "@@ -971,7 +971,9 @@ static UniValue gettxoutsetinfo(const JSONRPCRequest& request)\n             RPCHelpMan{\"gettxoutsetinfo\",\n                 \"\\nReturns statistics about the unspent transaction output set.\\n\"\n                 \"Note this call may take some time.\\n\",\n-                {},\n+                {\n+                    {\"legacy_hash\", RPCArg::Type::BOOL, /* default */ \"false\", \"Whether the UTXO set hash should be calculated using the legacy algorithm (not Muhash).\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#discussion_r436143516",
      "id" : 436143516,
      "in_reply_to_id" : 431778760,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE0MzUxNg==",
      "original_commit_id" : "4438aed09e87de0afb37da64ffb5e7489084e8ab",
      "original_line" : 975,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 425598449,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19055",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T20:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436143516",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think it'd be easier to review this code if the PR didn't include the ASM implementation.\r\n\r\nYeah, I can split that out easily as well.",
      "created_at" : "2020-06-05T20:16:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-639776914",
      "id" : 639776914,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzOTc3NjkxNA==",
      "updated_at" : "2020-06-05T20:16:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/639776914",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ASM optimizations moved to https://github.com/bitcoin/bitcoin/pull/19181",
      "created_at" : "2020-06-05T20:24:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-639783978",
      "id" : 639783978,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzOTc4Mzk3OA==",
      "updated_at" : "2020-06-05T20:24:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/639783978",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Is there a particular reason for sha512?  Although for some sizes it can be faster w/ a totally naive implementation It is a lot slower on hardware with sha-ni (and presumably somewhat slower than a parallel implementation using 8-way avx sha256).",
      "created_at" : "2020-06-07T07:22:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19055#issuecomment-640169988",
      "id" : 640169988,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19055",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MDE2OTk4OA==",
      "updated_at" : "2020-06-07T07:22:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/640169988",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   }
]
