[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430359949"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430359949"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why can't this be a testing setup with logging disabled, like in the other tests?",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-05-26T12:02:33Z",
      "diff_hunk" : "@@ -2,15 +2,27 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <addrdb.h>\n+#include <chainparams.h>\n+#include <net.h>\n+#include <outputtype.h>\n+#include <policy/fees.h>\n #include <rpc/util.h>\n #include <test/fuzz/FuzzedDataProvider.h>\n #include <test/fuzz/fuzz.h>\n #include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n #include <util/error.h>\n \n #include <cstdint>\n #include <vector>\n \n+void initialize()\n+{\n+    SelectParams(CBaseChainParams::REGTEST);\n+    StartMutedLogging();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430359949",
      "id" : 430359949,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM1OTk0OQ==",
      "original_commit_id" : "403c5ad9ad3d9ebbcc7c6ceec0ce677760e0f3b6",
      "original_line" : 23,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/fuzz/kitchen_sink.cpp",
      "position" : null,
      "pull_request_review_id" : 418228841,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430359949",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430383126"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430383126"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Unfortunately `TestingSetup` introduces non-determinism which makes coverage vary between runs also when using the same set of inputs, see https://github.com/bitcoin/bitcoin/pull/19067#discussion_r429986672 :)",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-05-26T12:44:38Z",
      "diff_hunk" : "@@ -2,15 +2,27 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <addrdb.h>\n+#include <chainparams.h>\n+#include <net.h>\n+#include <outputtype.h>\n+#include <policy/fees.h>\n #include <rpc/util.h>\n #include <test/fuzz/FuzzedDataProvider.h>\n #include <test/fuzz/fuzz.h>\n #include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n #include <util/error.h>\n \n #include <cstdint>\n #include <vector>\n \n+void initialize()\n+{\n+    SelectParams(CBaseChainParams::REGTEST);\n+    StartMutedLogging();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430383126",
      "id" : 430383126,
      "in_reply_to_id" : 430359949,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM4MzEyNg==",
      "original_commit_id" : "403c5ad9ad3d9ebbcc7c6ceec0ce677760e0f3b6",
      "original_line" : 23,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/fuzz/kitchen_sink.cpp",
      "position" : null,
      "pull_request_review_id" : 418259302,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430383126",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430386919"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430386919"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What about BasicTestgingSetup then?",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-05-26T12:50:51Z",
      "diff_hunk" : "@@ -2,15 +2,27 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <addrdb.h>\n+#include <chainparams.h>\n+#include <net.h>\n+#include <outputtype.h>\n+#include <policy/fees.h>\n #include <rpc/util.h>\n #include <test/fuzz/FuzzedDataProvider.h>\n #include <test/fuzz/fuzz.h>\n #include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n #include <util/error.h>\n \n #include <cstdint>\n #include <vector>\n \n+void initialize()\n+{\n+    SelectParams(CBaseChainParams::REGTEST);\n+    StartMutedLogging();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430386919",
      "id" : 430386919,
      "in_reply_to_id" : 430359949,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM4NjkxOQ==",
      "original_commit_id" : "403c5ad9ad3d9ebbcc7c6ceec0ce677760e0f3b6",
      "original_line" : 23,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/fuzz/kitchen_sink.cpp",
      "position" : null,
      "pull_request_review_id" : 418264174,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430386919",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-05-26T12:53:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-634005698",
      "id" : 634005698,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDAwNTY5OA==",
      "updated_at" : "2020-05-26T12:53:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634005698",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430395950"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430395950"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it is the same problem there: I get more setup than I need and a subset of that setup work introduces coverage non-determinism :)\r\n\r\nI prefer opt-ing in to exactly the setup I need: it avoids the non-determinism problem and I also think that makes it easier to reason about the dependencies of each fuzzing harness.",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-05-26T13:05:00Z",
      "diff_hunk" : "@@ -2,15 +2,27 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <addrdb.h>\n+#include <chainparams.h>\n+#include <net.h>\n+#include <outputtype.h>\n+#include <policy/fees.h>\n #include <rpc/util.h>\n #include <test/fuzz/FuzzedDataProvider.h>\n #include <test/fuzz/fuzz.h>\n #include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n #include <util/error.h>\n \n #include <cstdint>\n #include <vector>\n \n+void initialize()\n+{\n+    SelectParams(CBaseChainParams::REGTEST);\n+    StartMutedLogging();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430395950",
      "id" : 430395950,
      "in_reply_to_id" : 430359949,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDM5NTk1MA==",
      "original_commit_id" : "403c5ad9ad3d9ebbcc7c6ceec0ce677760e0f3b6",
      "original_line" : 23,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/fuzz/kitchen_sink.cpp",
      "position" : null,
      "pull_request_review_id" : 418276058,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430395950",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430403885"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430403885"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If non-determinism is an issue for fuzz tests, it is also an issue for unit tests etc. Instead of solving it fresh in every single test case, I'd rather fix it once and for all.\r\n\r\nUsing hacks that don't clean up after themselves, depend on global state and leave global state dirty is asking for mishaps. Currently the fuzz datadir is set to the default location of the datadir. I don't think I need to repeat why this is bad.\r\n\r\nIf the basic testing setup is still too bloated, then please add one that is stripped down, so that unit and bench tests can use it as well.",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-05-26T13:17:11Z",
      "diff_hunk" : "@@ -2,15 +2,27 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <addrdb.h>\n+#include <chainparams.h>\n+#include <net.h>\n+#include <outputtype.h>\n+#include <policy/fees.h>\n #include <rpc/util.h>\n #include <test/fuzz/FuzzedDataProvider.h>\n #include <test/fuzz/fuzz.h>\n #include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n #include <util/error.h>\n \n #include <cstdint>\n #include <vector>\n \n+void initialize()\n+{\n+    SelectParams(CBaseChainParams::REGTEST);\n+    StartMutedLogging();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430403885",
      "id" : 430403885,
      "in_reply_to_id" : 430359949,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDQwMzg4NQ==",
      "original_commit_id" : "403c5ad9ad3d9ebbcc7c6ceec0ce677760e0f3b6",
      "original_line" : 23,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/fuzz/kitchen_sink.cpp",
      "position" : null,
      "pull_request_review_id" : 418286682,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430403885",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430586406"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430586406"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I was wrong about `BasicTestingSetup`: it seems like only `TestingSetup` introduces coverage non-determinism.\r\n\r\nThis shows the issue with `TestingSetup`:\r\n\r\n```\r\n# With TestingSetup:\r\n$ src/test/fuzz/kitchen_sink corpus/\r\nâ¦\r\n#20425  NEW    cov: 3867 ft: 12141 corp: 248/49Kb lim: 607 exec/s: 464 rss: 357Mb L: 605/607 MS: 5 InsertRepeatedBytes-CopyPart-InsertByte-ChangeBinInt-CopyPart-\r\n        NEW_FUNC[1/68]: 0x56533ed75c60 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::c_str() const /usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits/basic_string.h:2291\r\n        NEW_FUNC[2/68]: 0x56533f03dfc0 in std::function<void ()>::function(std::function<void ()> const&) /usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits/std_function.h:655\r\n#20441  NEW    cov: 4384 ft: 12690 corp: 249/49Kb lim: 607 exec/s: 454 rss: 358Mb L: 326/607 MS: 1 CopyPart-\r\nâ¦\r\n#28628        NEW    cov: 4384 ft: 12731 corp: 258/54Kb lim: 652 exec/s: 454 rss: 452Mb L: 652/652 MS: 1 CrossOver-\r\n==6668== libFuzzer: run interrupted; exiting\r\n\r\n$ src/test/fuzz/kitchen_sink corpus/\r\n#423    INITED cov: 3867 ft: 12182 corp: 245/48Kb exec/s: 423 rss: 148Mb\r\n```\r\n\r\nNotice the non-deterministic coverage increase from 3867 to 4384 which drops back to 3867 when the fuzzer is restarted.\r\n\r\nI'll go with `BasicTestingSetup` :)\r\n\r\n",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-05-26T17:32:12Z",
      "diff_hunk" : "@@ -2,15 +2,27 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <addrdb.h>\n+#include <chainparams.h>\n+#include <net.h>\n+#include <outputtype.h>\n+#include <policy/fees.h>\n #include <rpc/util.h>\n #include <test/fuzz/FuzzedDataProvider.h>\n #include <test/fuzz/fuzz.h>\n #include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n #include <util/error.h>\n \n #include <cstdint>\n #include <vector>\n \n+void initialize()\n+{\n+    SelectParams(CBaseChainParams::REGTEST);\n+    StartMutedLogging();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430586406",
      "id" : 430586406,
      "in_reply_to_id" : 430359949,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDU4NjQwNg==",
      "original_commit_id" : "403c5ad9ad3d9ebbcc7c6ceec0ce677760e0f3b6",
      "original_line" : 23,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/fuzz/kitchen_sink.cpp",
      "position" : null,
      "pull_request_review_id" : 418523525,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430586406",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430599736"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430599736"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Coverage stability with `BasicTestingSetup` vs `TestingSetup`:\r\n\r\nFuzzer with an empty `test_one_input` function, and an `initialize` function containing `static const BasicTestingSetup basic_testing_setup`:\r\n\r\n```\r\nINFO: A corpus is not provided, starting from an empty corpus\r\n#2      INITED cov: 58 ft: 59 corp: 1/1b exec/s: 0 rss: 125Mb\r\n#65536  pulse  cov: 58 ft: 59 corp: 1/1b lim: 652 exec/s: 21845 rss: 145Mb\r\n#131072 pulse  cov: 58 ft: 59 corp: 1/1b lim: 1300 exec/s: 21845 rss: 188Mb\r\n#262144 pulse  cov: 58 ft: 59 corp: 1/1b lim: 2611 exec/s: 21845 rss: 339Mb\r\n#524288 pulse  cov: 58 ft: 59 corp: 1/1b lim: 4096 exec/s: 20164 rss: 715Mb\r\n#1048576        pulse  cov: 58 ft: 59 corp: 1/1b lim: 4096 exec/s: 20560 rss: 716Mb\r\n#2097152        pulse  cov: 58 ft: 59 corp: 1/1b lim: 4096 exec/s: 20560 rss: 716Mb\r\n```\r\n\r\nFuzzer with an empty `test_one_input` function, and an `initialize` function containing `static const TestingSetup testing_setup`:\r\n\r\n```\r\nINFO: A corpus is not provided, starting from an empty corpus\r\n#2      INITED cov: 58 ft: 59 corp: 1/1b exec/s: 0 rss: 134Mb\r\n#65536  pulse  cov: 58 ft: 59 corp: 1/1b lim: 652 exec/s: 21845 rss: 155Mb\r\n#131072 pulse  cov: 58 ft: 59 corp: 1/1b lim: 1300 exec/s: 21845 rss: 198Mb\r\n#262144 pulse  cov: 58 ft: 59 corp: 1/1b lim: 2611 exec/s: 21845 rss: 348Mb\r\n#524288 pulse  cov: 58 ft: 59 corp: 1/1b lim: 4096 exec/s: 20164 rss: 715Mb\r\n        NEW_FUNC[1/85]: 0x55e526ad96c0 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string<std::allocator<char> >(char const*, std::allocator<char> const&) /usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits/basic_string.h:516\r\n        NEW_FUNC[2/85]: 0x55e526adc5a0 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_local_data() /usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits/basic_string.h:180\r\n#910854 NEW    cov: 663 ft: 143 corp: 2/3b lim: 4096 exec/s: 20241 rss: 717Mb L: 2/2 MS: 2 InsertByte-CopyPart-\r\n#1048576        pulse  cov: 663 ft: 143 corp: 2/3b lim: 4096 exec/s: 20560 rss: 717Mb\r\n        NEW_FUNC[1/10]: 0x55e526ad95c0 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::c_str() const /usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits/basic_string.h:2291\r\n        NEW_FUNC[2/10]: 0x55e526adc140 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_dispose() /usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits/basic_string.h:219\r\n#1830962        NEW    cov: 711 ft: 335 corp: 3/4099b lim: 4096 exec/s: 20572 rss: 717Mb L: 4096/4096 MS: 3 ChangeBinInt-CrossOver-ChangeASCIIInt-\r\n#2097152        pulse  cov: 711 ft: 335 corp: 3/4099b lim: 4096 exec/s: 20360 rss: 717Mb\r\n```\r\n",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-05-26T17:54:55Z",
      "diff_hunk" : "@@ -2,15 +2,27 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <addrdb.h>\n+#include <chainparams.h>\n+#include <net.h>\n+#include <outputtype.h>\n+#include <policy/fees.h>\n #include <rpc/util.h>\n #include <test/fuzz/FuzzedDataProvider.h>\n #include <test/fuzz/fuzz.h>\n #include <test/fuzz/util.h>\n+#include <test/util/setup_common.h>\n #include <util/error.h>\n \n #include <cstdint>\n #include <vector>\n \n+void initialize()\n+{\n+    SelectParams(CBaseChainParams::REGTEST);\n+    StartMutedLogging();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r430599736",
      "id" : 430599736,
      "in_reply_to_id" : 430359949,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDU5OTczNg==",
      "original_commit_id" : "403c5ad9ad3d9ebbcc7c6ceec0ce677760e0f3b6",
      "original_line" : 23,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/test/fuzz/kitchen_sink.cpp",
      "position" : null,
      "pull_request_review_id" : 418540251,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430599736",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Anything left to do here? :)  The changes are limited to `src/test/fuzz/` and should hopefully be trivial to review.",
      "created_at" : "2020-06-28T19:20:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-650809846",
      "id" : 650809846,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1MDgwOTg0Ng==",
      "updated_at" : "2020-06-28T19:20:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/650809846",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I cannot build this branch with either `clang/clang++` or `afl-gcc/afl-g++`:\r\n\r\nclang version: `6.0.0-1ubuntu2 (tags/RELEASE_600/final)`\r\nafl-gcc/afl-g++ built from afl master\r\n\r\nMake output:\r\n```\r\nMaking all in src\r\n  2 make[1]: Entering directory '/root/bitcoin/src'\r\n  3 make[2]: Entering directory '/root/bitcoin/src'\r\n  4   CXX      test/fuzz/test_fuzz_addition_overflow-addition_overflow.o\r\n  5 In file included from test/fuzz/addition_overflow.cpp:7:\r\n  6 ./test/fuzz/util.h:62:18: error: no template named 'optional' in namespace 'std'; did you mean 'Optional'?\r\n  7 NODISCARD inline std::optional<T> ConsumeDeserializable(FuzzedDataProvider& fuzzed_data_provider, const si    ze_t max_length = 4096) noexcept\r\n  8                  ^~~~~~~~~~~~~\r\n  9                  Optional\r\n 10 ./optional.h:14:1: note: 'Optional' declared here\r\n 11 using Optional = boost::optional<T>;\r\n 12 ^\r\n 13 In file included from test/fuzz/addition_overflow.cpp:7:\r\n 14 ./test/fuzz/util.h:70:16: error: no member named 'nullopt' in namespace 'std'; did you mean simply 'nullop    t'?\r\n 15         return std::nullopt;\r\n 16                ^~~~~~~~~~~~\r\n 17                nullopt\r\n 18 ./optional.h:24:14: note: 'nullopt' declared here\r\n 19 static auto& nullopt = boost::none;\r\n 20              ^\r\n 21 2 errors generated.\r\n 22 Makefile:14081: recipe for target 'test/fuzz/test_fuzz_addition_overflow-addition_overflow.o' failed\r\n 23 make[2]: *** [test/fuzz/test_fuzz_addition_overflow-addition_overflow.o] Error 1\r\n 24 make[2]: Leaving directory '/root/bitcoin/src'\r\n 25 Makefile:17268: recipe for target 'all-recursive' failed\r\n 26 make[1]: *** [all-recursive] Error 1\r\n 27 make[1]: Leaving directory '/root/bitcoin/src'\r\n 28 Makefile:785: recipe for target 'all-recursive' failed\r\n 29 make: *** [all-recursive] Error 1\r\n```\r\n\r\nAm I doing something wrong? I have C++17 features and can build on master.",
      "created_at" : "2020-07-13T17:47:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-657699951",
      "id" : 657699951,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NzY5OTk1MQ==",
      "updated_at" : "2020-07-13T17:58:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657699951",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Crypt-iQ So to clarify, you can build current `master`, but not this pull request merged into current `master`?",
      "created_at" : "2020-07-13T17:54:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-657703107",
      "id" : 657703107,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NzcwMzEwNw==",
      "updated_at" : "2020-07-13T17:54:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657703107",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke I can build the current `master` branch, but not this branch as it is. I checkout this branch via:\r\n\r\n```\r\ngit fetch origin pull/19065/head:addrmanfuzz\r\n```",
      "created_at" : "2020-07-13T17:57:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-657704505",
      "id" : 657704505,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NzcwNDUwNQ==",
      "updated_at" : "2020-07-13T17:57:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657704505",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Crypt-iQ Oh, that's weird! Thanks for reporting. I've now rebased this PR on current `master`. Would you mind testing again? :)",
      "created_at" : "2020-07-13T22:37:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-657828502",
      "id" : 657828502,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NzgyODUwMg==",
      "updated_at" : "2020-07-13T22:37:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657828502",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@practicalswift I think you may have forgotten to push it up :) And will test once it's up",
      "created_at" : "2020-07-14T01:20:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-657911100",
      "id" : 657911100,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NzkxMTEwMA==",
      "updated_at" : "2020-07-14T01:20:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657911100",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Crypt-iQ Oh, thanks for letting me know! Now pushed for real :)",
      "created_at" : "2020-07-14T07:44:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-658025967",
      "id" : 658025967,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1ODAyNTk2Nw==",
      "updated_at" : "2020-07-14T07:44:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658025967",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2020-07-15T00:08:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-658472418",
      "id" : 658472418,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1ODQ3MjQxOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-20T23:33:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658472418",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@practicalswift Able to build this branch with afl and with libfuzzer (clang-10).\r\n\r\nCoverage from 24 hours of AFL fuzzing here: https://crypt-iq.github.io/addrman_fuzz_outs/src/index.html\r\nWith more time it should hit the collision code but it was very slow ~4-5 execs/s.",
      "created_at" : "2020-07-15T14:58:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-658819700",
      "id" : 658819700,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1ODgxOTcwMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-15T15:01:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/658819700",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r456845775"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/456845775"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Is the other way `>>` skipped because it's covered in `deserialize.cpp`? Also since `m_asmap` isn't specified there is a single line that the fuzzer misses:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/090d87716074434bdc6c7656ec44d049197a793a/src/addrman.h#L370-L376__",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-07-19T01:25:40Z",
      "diff_hunk" : "@@ -0,0 +1,113 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <addrdb.h>\n+#include <addrman.h>\n+#include <chainparams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+\n+#include <cstdint>\n+#include <optional>\n+#include <string>\n+#include <vector>\n+\n+void initialize()\n+{\n+    SelectParams(CBaseChainParams::REGTEST);\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    CAddrMan addr_man;\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        switch (fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 11)) {\n+        case 0: {\n+            addr_man.Clear();\n+            break;\n+        }\n+        case 1: {\n+            addr_man.ResolveCollisions();\n+            break;\n+        }\n+        case 2: {\n+            (void)addr_man.SelectTriedCollision();\n+            break;\n+        }\n+        case 3: {\n+            (void)addr_man.Select(fuzzed_data_provider.ConsumeBool());\n+            break;\n+        }\n+        case 4: {\n+            (void)addr_man.GetAddr();\n+            break;\n+        }\n+        case 5: {\n+            const std::optional<CAddress> opt_address = ConsumeDeserializable<CAddress>(fuzzed_data_provider);\n+            const std::optional<CNetAddr> opt_net_addr = ConsumeDeserializable<CNetAddr>(fuzzed_data_provider);\n+            if (opt_address && opt_net_addr) {\n+                addr_man.Add(*opt_address, *opt_net_addr, fuzzed_data_provider.ConsumeIntegralInRange<int64_t>(0, 100000000));\n+            }\n+            break;\n+        }\n+        case 6: {\n+            std::vector<CAddress> addresses;\n+            while (fuzzed_data_provider.ConsumeBool()) {\n+                const std::optional<CAddress> opt_address = ConsumeDeserializable<CAddress>(fuzzed_data_provider);\n+                if (!opt_address) {\n+                    break;\n+                }\n+                addresses.push_back(*opt_address);\n+            }\n+            const std::optional<CNetAddr> opt_net_addr = ConsumeDeserializable<CNetAddr>(fuzzed_data_provider);\n+            if (opt_net_addr) {\n+                addr_man.Add(addresses, *opt_net_addr, fuzzed_data_provider.ConsumeIntegralInRange<int64_t>(0, 100000000));\n+            }\n+            break;\n+        }\n+        case 7: {\n+            const std::optional<CService> opt_service = ConsumeDeserializable<CService>(fuzzed_data_provider);\n+            if (opt_service) {\n+                addr_man.Good(*opt_service, fuzzed_data_provider.ConsumeBool(), ConsumeTime(fuzzed_data_provider));\n+            }\n+            break;\n+        }\n+        case 8: {\n+            const std::optional<CService> opt_service = ConsumeDeserializable<CService>(fuzzed_data_provider);\n+            if (opt_service) {\n+                addr_man.Attempt(*opt_service, fuzzed_data_provider.ConsumeBool(), ConsumeTime(fuzzed_data_provider));\n+            }\n+            break;\n+        }\n+        case 9: {\n+            const std::optional<CService> opt_service = ConsumeDeserializable<CService>(fuzzed_data_provider);\n+            if (opt_service) {\n+                addr_man.Connected(*opt_service, ConsumeTime(fuzzed_data_provider));\n+            }\n+            break;\n+        }\n+        case 10: {\n+            const std::optional<CService> opt_service = ConsumeDeserializable<CService>(fuzzed_data_provider);\n+            if (opt_service) {\n+                addr_man.SetServices(*opt_service, ServiceFlags{fuzzed_data_provider.ConsumeIntegral<uint64_t>()});\n+            }\n+            break;\n+        }\n+        case 11: {\n+            (void)addr_man.Check();\n+            break;\n+        }\n+        }\n+\n+        if (fuzzed_data_provider.ConsumeBool()) {\n+            (void)addr_man.size();\n+\n+            CDataStream data_stream(SER_NETWORK, PROTOCOL_VERSION);\n+            data_stream << addr_man;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r456845775",
      "id" : 456845775,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg0NTc3NQ==",
      "original_commit_id" : "80ee923d73c7de52a9b3f99ecdb5c3edb39a4893",
      "original_line" : 110,
      "original_position" : 110,
      "original_start_line" : null,
      "path" : "src/test/fuzz/addrman.cpp",
      "position" : null,
      "pull_request_review_id" : 451091812,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/456845775",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r456849493"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/456849493"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Could a case be made to not only have the default, match-all filter?",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-07-19T02:24:16Z",
      "diff_hunk" : "@@ -16,12 +16,49 @@\n void test_one_input(const std::vector<uint8_t>& buffer)\n {\n     FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n-    std::optional<CPartialMerkleTree> partial_merkle_tree = ConsumeDeserializable<CPartialMerkleTree>(fuzzed_data_provider);\n-    if (!partial_merkle_tree) {\n-        return;\n+\n+    {\n+        std::optional<CPartialMerkleTree> partial_merkle_tree = ConsumeDeserializable<CPartialMerkleTree>(fuzzed_data_provider);\n+        if (partial_merkle_tree) {\n+            (void)partial_merkle_tree->GetNumTransactions();\n+            std::vector<uint256> matches;\n+            std::vector<unsigned int> indices;\n+            while (fuzzed_data_provider.ConsumeBool()) {\n+                indices.push_back(fuzzed_data_provider.ConsumeIntegral<unsigned int>());\n+            }\n+            (void)partial_merkle_tree->ExtractMatches(matches, indices);\n+        }\n+    }\n+\n+    {\n+        CMerkleBlock merkle_block;\n+        const std::optional<CBlock> opt_block = ConsumeDeserializable<CBlock>(fuzzed_data_provider);\n+        CBloomFilter bloom_filter;\n+        std::set<uint256> txids;\n+        if (opt_block && !opt_block->vtx.empty()) {\n+            if (fuzzed_data_provider.ConsumeBool()) {\n+                merkle_block = CMerkleBlock{*opt_block, bloom_filter};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r456849493",
      "id" : 456849493,
      "line" : 40,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Njg0OTQ5Mw==",
      "original_commit_id" : "c8055503f0c26a970ccf1779c6b6fb3fcfa30cee",
      "original_line" : 40,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/test/fuzz/merkleblock.cpp",
      "position" : 28,
      "pull_request_review_id" : 451091812,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/456849493",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r472475731"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/472475731"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Is the other way `>>` skipped because it's covered in `deserialize.cpp`?\r\n\r\nYes :)\r\n\r\n> Also since `m_asmap` isn't specified there is a single line that the fuzzer misses:\r\n\r\nThanks! Now fixed.",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-08-18T20:33:25Z",
      "diff_hunk" : "@@ -0,0 +1,113 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <addrdb.h>\n+#include <addrman.h>\n+#include <chainparams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+\n+#include <cstdint>\n+#include <optional>\n+#include <string>\n+#include <vector>\n+\n+void initialize()\n+{\n+    SelectParams(CBaseChainParams::REGTEST);\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    CAddrMan addr_man;\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        switch (fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 11)) {\n+        case 0: {\n+            addr_man.Clear();\n+            break;\n+        }\n+        case 1: {\n+            addr_man.ResolveCollisions();\n+            break;\n+        }\n+        case 2: {\n+            (void)addr_man.SelectTriedCollision();\n+            break;\n+        }\n+        case 3: {\n+            (void)addr_man.Select(fuzzed_data_provider.ConsumeBool());\n+            break;\n+        }\n+        case 4: {\n+            (void)addr_man.GetAddr();\n+            break;\n+        }\n+        case 5: {\n+            const std::optional<CAddress> opt_address = ConsumeDeserializable<CAddress>(fuzzed_data_provider);\n+            const std::optional<CNetAddr> opt_net_addr = ConsumeDeserializable<CNetAddr>(fuzzed_data_provider);\n+            if (opt_address && opt_net_addr) {\n+                addr_man.Add(*opt_address, *opt_net_addr, fuzzed_data_provider.ConsumeIntegralInRange<int64_t>(0, 100000000));\n+            }\n+            break;\n+        }\n+        case 6: {\n+            std::vector<CAddress> addresses;\n+            while (fuzzed_data_provider.ConsumeBool()) {\n+                const std::optional<CAddress> opt_address = ConsumeDeserializable<CAddress>(fuzzed_data_provider);\n+                if (!opt_address) {\n+                    break;\n+                }\n+                addresses.push_back(*opt_address);\n+            }\n+            const std::optional<CNetAddr> opt_net_addr = ConsumeDeserializable<CNetAddr>(fuzzed_data_provider);\n+            if (opt_net_addr) {\n+                addr_man.Add(addresses, *opt_net_addr, fuzzed_data_provider.ConsumeIntegralInRange<int64_t>(0, 100000000));\n+            }\n+            break;\n+        }\n+        case 7: {\n+            const std::optional<CService> opt_service = ConsumeDeserializable<CService>(fuzzed_data_provider);\n+            if (opt_service) {\n+                addr_man.Good(*opt_service, fuzzed_data_provider.ConsumeBool(), ConsumeTime(fuzzed_data_provider));\n+            }\n+            break;\n+        }\n+        case 8: {\n+            const std::optional<CService> opt_service = ConsumeDeserializable<CService>(fuzzed_data_provider);\n+            if (opt_service) {\n+                addr_man.Attempt(*opt_service, fuzzed_data_provider.ConsumeBool(), ConsumeTime(fuzzed_data_provider));\n+            }\n+            break;\n+        }\n+        case 9: {\n+            const std::optional<CService> opt_service = ConsumeDeserializable<CService>(fuzzed_data_provider);\n+            if (opt_service) {\n+                addr_man.Connected(*opt_service, ConsumeTime(fuzzed_data_provider));\n+            }\n+            break;\n+        }\n+        case 10: {\n+            const std::optional<CService> opt_service = ConsumeDeserializable<CService>(fuzzed_data_provider);\n+            if (opt_service) {\n+                addr_man.SetServices(*opt_service, ServiceFlags{fuzzed_data_provider.ConsumeIntegral<uint64_t>()});\n+            }\n+            break;\n+        }\n+        case 11: {\n+            (void)addr_man.Check();\n+            break;\n+        }\n+        }\n+\n+        if (fuzzed_data_provider.ConsumeBool()) {\n+            (void)addr_man.size();\n+\n+            CDataStream data_stream(SER_NETWORK, PROTOCOL_VERSION);\n+            data_stream << addr_man;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r472475731",
      "id" : 472475731,
      "in_reply_to_id" : 456845775,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ3NTczMQ==",
      "original_commit_id" : "80ee923d73c7de52a9b3f99ecdb5c3edb39a4893",
      "original_line" : 110,
      "original_position" : 110,
      "original_start_line" : null,
      "path" : "src/test/fuzz/addrman.cpp",
      "position" : null,
      "pull_request_review_id" : 469809848,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/472475731",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r472477852"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/472477852"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed! I'm now covering all three:\r\n* `CMerkleBlock{*opt_block, bloom_filter}`\r\n* `CMerkleBlock{*opt_block, txids}`\r\n* `CMerkleBlock{}` (added)",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-08-18T20:36:41Z",
      "diff_hunk" : "@@ -16,12 +16,49 @@\n void test_one_input(const std::vector<uint8_t>& buffer)\n {\n     FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n-    std::optional<CPartialMerkleTree> partial_merkle_tree = ConsumeDeserializable<CPartialMerkleTree>(fuzzed_data_provider);\n-    if (!partial_merkle_tree) {\n-        return;\n+\n+    {\n+        std::optional<CPartialMerkleTree> partial_merkle_tree = ConsumeDeserializable<CPartialMerkleTree>(fuzzed_data_provider);\n+        if (partial_merkle_tree) {\n+            (void)partial_merkle_tree->GetNumTransactions();\n+            std::vector<uint256> matches;\n+            std::vector<unsigned int> indices;\n+            while (fuzzed_data_provider.ConsumeBool()) {\n+                indices.push_back(fuzzed_data_provider.ConsumeIntegral<unsigned int>());\n+            }\n+            (void)partial_merkle_tree->ExtractMatches(matches, indices);\n+        }\n+    }\n+\n+    {\n+        CMerkleBlock merkle_block;\n+        const std::optional<CBlock> opt_block = ConsumeDeserializable<CBlock>(fuzzed_data_provider);\n+        CBloomFilter bloom_filter;\n+        std::set<uint256> txids;\n+        if (opt_block && !opt_block->vtx.empty()) {\n+            if (fuzzed_data_provider.ConsumeBool()) {\n+                merkle_block = CMerkleBlock{*opt_block, bloom_filter};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r472477852",
      "id" : 472477852,
      "in_reply_to_id" : 456849493,
      "line" : 40,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MjQ3Nzg1Mg==",
      "original_commit_id" : "c8055503f0c26a970ccf1779c6b6fb3fcfa30cee",
      "original_line" : 40,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/test/fuzz/merkleblock.cpp",
      "position" : 28,
      "pull_request_review_id" : 469811955,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/472477852",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Crypt-iQ Thanks a lot for reviewing! Feedback addressed. Would you mind re-reviewing? :)",
      "created_at" : "2020-08-18T20:37:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-675702991",
      "id" : 675702991,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3NTcwMjk5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-18T20:37:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/675702991",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke Would you mind reviewing? FWIW this PR touches only `src/test/fuzz/` :)",
      "created_at" : "2020-08-28T05:17:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-682330236",
      "id" : 682330236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MjMzMDIzNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-28T05:17:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/682330236",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The `CAddrMan` harness looks good to me. \r\nUbuntu 18:\r\n- `./configure --enable-fuzz --with-sanitizers=address,undefined,integer,fuzzer` reports implicit-signed-integer-truncation\r\n- valgrind reports no errors\r\n\r\nmacOS v10.15.4:\r\n- `./configure --enable-fuzz --with-sanitizers=address,fuzzer --disable-asm` reports no errors\r\n- `./configure --enable-fuzz --with-sanitizers=undefined,integer,fuzzer` reports implicit-signed-integer-truncation\r\n\r\n<details>\r\n<summary>implicit-signed-integer-truncation</summary>\r\n\r\n```\r\naddrman.cpp:524:22: runtime error: implicit conversion from type 'int64_t' (aka 'long long') of value 60031562745 (64-bit, signed) to type 'uint32_t' (aka 'unsigned int') changed the value to 4196987897 (32-bit, unsigned)\r\n    #0 0x103319c69 in CAddrMan::Connected_(CService const&, long long) addrman.cpp:524\r\n    #1 0x1032a0a1b in CAddrMan::Connected(CService const&, long long) addrman.h:652\r\n    #2 0x10329c621 in test_one_input(std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const&) addrman.cpp:89\r\n    #3 0x1042c8ff8 in LLVMFuzzerTestOneInput fuzz.cpp:45\r\n    #4 0x1044cb970 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) FuzzerLoop.cpp:556\r\n    #5 0x1044cb0b5 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) FuzzerLoop.cpp:470\r\n    #6 0x1044cd757 in fuzzer::Fuzzer::ReadAndExecuteSeedCorpora(std::__1::vector<fuzzer::SizedFile, fuzzer::fuzzer_allocator<fuzzer::SizedFile> >&) FuzzerLoop.cpp:765\r\n    #7 0x1044cdab9 in fuzzer::Fuzzer::Loop(std::__1::vector<fuzzer::SizedFile, fuzzer::fuzzer_allocator<fuzzer::SizedFile> >&) FuzzerLoop.cpp:792\r\n    #8 0x1044baf7d in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) FuzzerDriver.cpp:829\r\n    #9 0x1044e6c52 in main FuzzerMain.cpp:19\r\n    #10 0x7fff73778cc8 in start+0x0 (libdyld.dylib:x86_64+0x1acc8)\r\n\r\nSUMMARY: UndefinedBehaviorSanitizer: implicit-signed-integer-truncation addrman.cpp:524:22 in\r\n```\r\n</details>\r\n\r\nHappens here because `info.nTime` is `uint32_t`:\r\nhttps://github.com/bitcoin/bitcoin/blob/a0a422c34cfd6514d0cc445bd784d3ee1a2d1749/src/addrman.cpp#L524\r\n\r\nStill couldn't hit the collision code, so may need to run for longer. Will review and run the changes to the other harnesses.",
      "created_at" : "2020-09-04T05:14:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-686912218",
      "id" : 686912218,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NjkxMjIxOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-04T05:20:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/686912218",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r483395120"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/483395120"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "How was 100000000 chosen?",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-09-04T05:29:25Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <addrdb.h>\n+#include <addrman.h>\n+#include <chainparams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+\n+#include <cstdint>\n+#include <optional>\n+#include <string>\n+#include <vector>\n+\n+void initialize()\n+{\n+    SelectParams(CBaseChainParams::REGTEST);\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    CAddrMan addr_man;\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        switch (fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 11)) {\n+        case 0: {\n+            addr_man.Clear();\n+            break;\n+        }\n+        case 1: {\n+            addr_man.ResolveCollisions();\n+            break;\n+        }\n+        case 2: {\n+            (void)addr_man.SelectTriedCollision();\n+            break;\n+        }\n+        case 3: {\n+            (void)addr_man.Select(fuzzed_data_provider.ConsumeBool());\n+            break;\n+        }\n+        case 4: {\n+            (void)addr_man.GetAddr(fuzzed_data_provider.ConsumeIntegralInRange<size_t>(0, 4096), fuzzed_data_provider.ConsumeIntegralInRange<size_t>(0, 4096));\n+            break;\n+        }\n+        case 5: {\n+            const std::optional<CAddress> opt_address = ConsumeDeserializable<CAddress>(fuzzed_data_provider);\n+            const std::optional<CNetAddr> opt_net_addr = ConsumeDeserializable<CNetAddr>(fuzzed_data_provider);\n+            if (opt_address && opt_net_addr) {\n+                addr_man.Add(*opt_address, *opt_net_addr, fuzzed_data_provider.ConsumeIntegralInRange<int64_t>(0, 100000000));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r483395120",
      "id" : 483395120,
      "line" : 53,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MzM5NTEyMA==",
      "original_commit_id" : "688660d3c4ed2092bce2dec1e554e45ed4af2356",
      "original_line" : 53,
      "original_position" : 53,
      "original_start_line" : null,
      "path" : "src/test/fuzz/addrman.cpp",
      "position" : 53,
      "pull_request_review_id" : 482367877,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-17T13:43:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/483395120",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The merkleblock and kitchensink harnesses look good to me. Fuzzers didn't report any errors with sanitizers nor with valgrind.\r\n\r\nSo the reason the `addrman` fuzzer wasn't able to hit the collision code *consistently* is because of `insecure_rand` which changes across runs. Another source of test randomness is the `GetAdjustedTime` function.\r\n\r\nCan also see it when running `make cov_fuzz` twice as the `cov` and `ft` numbers differ with libfuzzer output.\r\nFirst run:\r\n```\r\nRun addrman with args ['/Users/nsa/bitcoin_cov/src/test/fuzz/addrman', '-runs=1', 'qa-assets/fuzz_seed_corpus/addrman']INFO: Seed: 1286454130\r\nINFO: Loaded 1 modules   (264114 inline 8-bit counters): 264114 [0x1114a3ee8, 0x1114e469a), \r\nINFO: Loaded 1 PC tables (264114 PCs): 264114 [0x1114e46a0,0x1118ec1c0), \r\nINFO:     5557 files found in qa-assets/fuzz_seed_corpus/addrman\r\nINFO: -max_len is not provided; libFuzzer will not generate inputs larger than 4151 bytes\r\nINFO: seed corpus: files: 5557 min: 1b max: 4151b total: 3492077b rss: 44Mb\r\n#1024\tpulse  cov: 3008 ft: 8297 corp: 326/14217b exec/s: 341 rss: 45Mb\r\n#2048\tpulse  cov: 3127 ft: 10801 corp: 530/40Kb exec/s: 89 rss: 45Mb\r\n#4096\tpulse  cov: 3160 ft: 13578 corp: 830/143Kb exec/s: 42 rss: 45Mb\r\n#5558\tINITED cov: 3172 ft: 15459 corp: 1160/728Kb exec/s: 29 rss: 46Mb\r\n#5558\tDONE   cov: 3172 ft: 15459 corp: 1160/728Kb lim: 4147 exec/s: 29 rss: 46Mb\r\nDone 5558 runs in 191 second(s)\r\n```\r\n\r\nSecond run:\r\n```\r\nRun addrman with args ['/Users/nsa/bitcoin_cov/src/test/fuzz/addrman', '-runs=1', 'qa-assets/fuzz_seed_corpus/addrman']INFO: Seed: 1987669807\r\nINFO: Loaded 1 modules   (264114 inline 8-bit counters): 264114 [0x104dd7ee8, 0x104e1869a), \r\nINFO: Loaded 1 PC tables (264114 PCs): 264114 [0x104e186a0,0x1052201c0), \r\nINFO:     5557 files found in qa-assets/fuzz_seed_corpus/addrman\r\nINFO: -max_len is not provided; libFuzzer will not generate inputs larger than 4151 bytes\r\nINFO: seed corpus: files: 5557 min: 1b max: 4151b total: 3492077b rss: 44Mb\r\n#1024\tpulse  cov: 3008 ft: 8316 corp: 330/14641b exec/s: 204 rss: 45Mb\r\n#2048\tpulse  cov: 3117 ft: 10818 corp: 522/39Kb exec/s: 49 rss: 45Mb\r\n#4096\tpulse  cov: 3159 ft: 13573 corp: 838/148Kb exec/s: 27 rss: 45Mb\r\nSlowest unit: 12 s:\r\nartifact_prefix='./'; Test unit written to ./slow-unit-8450b39fa9bc5a9408007860514c53b0b6bf2723\r\n#5558\tINITED cov: 3181 ft: 15428 corp: 1159/714Kb exec/s: 20 rss: 46Mb\r\n#5558\tDONE   cov: 3181 ft: 15428 corp: 1159/714Kb lim: 4147 exec/s: 20 rss: 46Mb\r\nDone 5558 runs in 267 second(s)\r\n```",
      "created_at" : "2020-09-11T02:39:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-690838621",
      "id" : 690838621,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MDgzODYyMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-11T02:39:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/690838621",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r499868060"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499868060"
         }
      },
      "author_association" : "MEMBER",
      "body" : "100 000 000  was chosen to avoid this signed integer overflow:\r\n\r\n```\r\naddrman.cpp:306:67: runtime error: signed integer overflow: 100000000 - -9223372036854775808 cannot be represented in type 'long'\r\n    #0 0x5594ad96b160 in CAddrMan::Add_(CAddress const&, CNetAddr const&, long) src/addrman.cpp:306:67\r\n    #1 0x5594ad90d6ce in CAddrMan::Add(CAddress const&, CNetAddr const&, long) src/./addrman.h:556:17\r\n    #2 0x5594ad909041 in test_one_input(std::vector<unsigned char, std::allocator<unsigned char> > const&) src/test/fuzz/addrman.cpp:53:26\r\n```",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-10-05T20:57:13Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <addrdb.h>\n+#include <addrman.h>\n+#include <chainparams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+\n+#include <cstdint>\n+#include <optional>\n+#include <string>\n+#include <vector>\n+\n+void initialize()\n+{\n+    SelectParams(CBaseChainParams::REGTEST);\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    CAddrMan addr_man;\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        switch (fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 11)) {\n+        case 0: {\n+            addr_man.Clear();\n+            break;\n+        }\n+        case 1: {\n+            addr_man.ResolveCollisions();\n+            break;\n+        }\n+        case 2: {\n+            (void)addr_man.SelectTriedCollision();\n+            break;\n+        }\n+        case 3: {\n+            (void)addr_man.Select(fuzzed_data_provider.ConsumeBool());\n+            break;\n+        }\n+        case 4: {\n+            (void)addr_man.GetAddr(fuzzed_data_provider.ConsumeIntegralInRange<size_t>(0, 4096), fuzzed_data_provider.ConsumeIntegralInRange<size_t>(0, 4096));\n+            break;\n+        }\n+        case 5: {\n+            const std::optional<CAddress> opt_address = ConsumeDeserializable<CAddress>(fuzzed_data_provider);\n+            const std::optional<CNetAddr> opt_net_addr = ConsumeDeserializable<CNetAddr>(fuzzed_data_provider);\n+            if (opt_address && opt_net_addr) {\n+                addr_man.Add(*opt_address, *opt_net_addr, fuzzed_data_provider.ConsumeIntegralInRange<int64_t>(0, 100000000));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r499868060",
      "id" : 499868060,
      "in_reply_to_id" : 483395120,
      "line" : 53,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ5OTg2ODA2MA==",
      "original_commit_id" : "688660d3c4ed2092bce2dec1e554e45ed4af2356",
      "original_line" : 53,
      "original_position" : 53,
      "original_start_line" : null,
      "path" : "src/test/fuzz/addrman.cpp",
      "position" : 53,
      "pull_request_review_id" : 502414830,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-05T20:57:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/499868060",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Crypt-iQ I'm afraid we'll have to live with some degree of non-determinism. With that said I'm open to all suggestions on how to reduce the non-determinism in testing, but I guess that is out of scope for this PR :)",
      "created_at" : "2020-10-05T21:03:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-703887725",
      "id" : 703887725,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMzg4NzcyNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-05T21:03:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/703887725",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r501611685"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/501611685"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Should this be at the beginning so that addrman GetGroup calls use a populated asmap?",
      "commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "created_at" : "2020-10-08T10:23:38Z",
      "diff_hunk" : "@@ -0,0 +1,114 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <addrdb.h>\n+#include <addrman.h>\n+#include <chainparams.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+\n+#include <cstdint>\n+#include <optional>\n+#include <string>\n+#include <vector>\n+\n+void initialize()\n+{\n+    SelectParams(CBaseChainParams::REGTEST);\n+}\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    CAddrMan addr_man;\n+    while (fuzzed_data_provider.ConsumeBool()) {\n+        switch (fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 11)) {\n+        case 0: {\n+            addr_man.Clear();\n+            break;\n+        }\n+        case 1: {\n+            addr_man.ResolveCollisions();\n+            break;\n+        }\n+        case 2: {\n+            (void)addr_man.SelectTriedCollision();\n+            break;\n+        }\n+        case 3: {\n+            (void)addr_man.Select(fuzzed_data_provider.ConsumeBool());\n+            break;\n+        }\n+        case 4: {\n+            (void)addr_man.GetAddr(fuzzed_data_provider.ConsumeIntegralInRange<size_t>(0, 4096), fuzzed_data_provider.ConsumeIntegralInRange<size_t>(0, 4096));\n+            break;\n+        }\n+        case 5: {\n+            const std::optional<CAddress> opt_address = ConsumeDeserializable<CAddress>(fuzzed_data_provider);\n+            const std::optional<CNetAddr> opt_net_addr = ConsumeDeserializable<CNetAddr>(fuzzed_data_provider);\n+            if (opt_address && opt_net_addr) {\n+                addr_man.Add(*opt_address, *opt_net_addr, fuzzed_data_provider.ConsumeIntegralInRange<int64_t>(0, 100000000));\n+            }\n+            break;\n+        }\n+        case 6: {\n+            std::vector<CAddress> addresses;\n+            while (fuzzed_data_provider.ConsumeBool()) {\n+                const std::optional<CAddress> opt_address = ConsumeDeserializable<CAddress>(fuzzed_data_provider);\n+                if (!opt_address) {\n+                    break;\n+                }\n+                addresses.push_back(*opt_address);\n+            }\n+            const std::optional<CNetAddr> opt_net_addr = ConsumeDeserializable<CNetAddr>(fuzzed_data_provider);\n+            if (opt_net_addr) {\n+                addr_man.Add(addresses, *opt_net_addr, fuzzed_data_provider.ConsumeIntegralInRange<int64_t>(0, 100000000));\n+            }\n+            break;\n+        }\n+        case 7: {\n+            const std::optional<CService> opt_service = ConsumeDeserializable<CService>(fuzzed_data_provider);\n+            if (opt_service) {\n+                addr_man.Good(*opt_service, fuzzed_data_provider.ConsumeBool(), ConsumeTime(fuzzed_data_provider));\n+            }\n+            break;\n+        }\n+        case 8: {\n+            const std::optional<CService> opt_service = ConsumeDeserializable<CService>(fuzzed_data_provider);\n+            if (opt_service) {\n+                addr_man.Attempt(*opt_service, fuzzed_data_provider.ConsumeBool(), ConsumeTime(fuzzed_data_provider));\n+            }\n+            break;\n+        }\n+        case 9: {\n+            const std::optional<CService> opt_service = ConsumeDeserializable<CService>(fuzzed_data_provider);\n+            if (opt_service) {\n+                addr_man.Connected(*opt_service, ConsumeTime(fuzzed_data_provider));\n+            }\n+            break;\n+        }\n+        case 10: {\n+            const std::optional<CService> opt_service = ConsumeDeserializable<CService>(fuzzed_data_provider);\n+            if (opt_service) {\n+                addr_man.SetServices(*opt_service, ServiceFlags{fuzzed_data_provider.ConsumeIntegral<uint64_t>()});\n+            }\n+            break;\n+        }\n+        case 11: {\n+            (void)addr_man.Check();\n+            break;\n+        }\n+        }\n+    }\n+    (void)addr_man.size();\n+    if (fuzzed_data_provider.ConsumeBool()) {\n+        while (fuzzed_data_provider.ConsumeBool()) {\n+            addr_man.m_asmap.push_back(fuzzed_data_provider.ConsumeBool());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#discussion_r501611685",
      "id" : 501611685,
      "line" : 109,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMTYxMTY4NQ==",
      "original_commit_id" : "4bd95f42e2d18bdf86c05f4b9b5e31fcf0e3ba1d",
      "original_line" : 109,
      "original_position" : 109,
      "original_start_line" : null,
      "path" : "src/test/fuzz/addrman.cpp",
      "position" : 109,
      "pull_request_review_id" : 504638756,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19065",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-08T10:23:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/501611685",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> So the reason the addrman fuzzer wasn't able to hit the collision code consistently is because of insecure_rand which changes across runs. Another source of test randomness is the GetAdjustedTime function.\r\n\r\nI presume `GetAdjustedTime` is non-deterministic because you it asks the system for the time. With `SetMockTime` you can make it return the time you (or the fuzz engine) set.\r\n\r\n`insecure_rand` could be made deterministic by accepting a bool parameter to the addrman constructor and passing it on to `insecure_rand`.",
      "created_at" : "2020-10-08T11:39:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19065#issuecomment-705512234",
      "id" : 705512234,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19065",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwNTUxMjIzNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-08T11:39:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/705512234",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
