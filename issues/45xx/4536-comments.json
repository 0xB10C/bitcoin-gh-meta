[
   {
      "body" : "Of course, the name of the RPC call is up for discussion - maybe \"getchaintips\" is better, or \"getblockchainheads\" or something like that.  For now, I just used the original name.  This command has been included (and tested) so far in Huntercoin, Namecoin and Motocoin.",
      "created_at" : "2014-07-15T15:52:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49052524",
      "id" : 49052524,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-15T15:52:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49052524",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "\"getchaintips\" seems more intuitive to me; I've wanted this feature before myself.",
      "created_at" : "2014-07-15T16:38:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49058944",
      "id" : 49058944,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-15T16:38:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49058944",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Just iterate over the mapBlockIndex entries, removing the ones that are the pprev of another mapBlockIndex entry.",
      "created_at" : "2014-07-15T17:20:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49064432",
      "id" : 49064432,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-15T17:20:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49064432",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "ACK concept + @sipa suggestion",
      "created_at" : "2014-07-15T17:28:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49065331",
      "id" : 49065331,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-15T17:28:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49065331",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r14950166"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14950166"
         }
      },
      "body" : "\"Returns status\" is not very helpful. More detail on what information is returned, please.",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-15T17:34:26Z",
      "diff_hunk" : "@@ -461,3 +461,116 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchains heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchains (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchains\\n\"\n+            \"Return status of all known chains.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r14950166",
      "id" : 14950166,
      "original_commit_id" : "0d12743c48b25f51da81cb5ebcce45e0d3c81f85",
      "original_position" : 23,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14950166",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r14950340"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14950340"
         }
      },
      "body" : "This was just meant as a \"place-holder\" for now.  I will extend the help text, also including example output (similar to other help texts).",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-15T17:37:32Z",
      "diff_hunk" : "@@ -461,3 +461,116 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchains heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchains (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchains\\n\"\n+            \"Return status of all known chains.\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r14950340",
      "id" : 14950340,
      "original_commit_id" : "0d12743c48b25f51da81cb5ebcce45e0d3c81f85",
      "original_position" : 23,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14950340",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "Thanks for the input - I'll try to incorporate everything and update the pull request.  I wanted to know if there's interest in this feature at all first, and I'm glad that there is. :)",
      "created_at" : "2014-07-15T17:38:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49066562",
      "id" : 49066562,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-15T17:38:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49066562",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "Yes, no problem with such an RPC.",
      "created_at" : "2014-07-15T17:39:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49066721",
      "id" : 49066721,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-15T17:39:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49066721",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r14950608"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14950608"
         }
      },
      "body" : "branch_len should be branchlength to be consistent with other RPC results (e.g. see getblockchaininfo or getblocktemplate).\r\n",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-15T17:41:43Z",
      "diff_hunk" : "@@ -461,3 +461,116 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchains heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchains (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchains\\n\"\n+            \"Return status of all known chains.\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli (\"getchains\", \"\")\n+            + HelpExampleRpc (\"getchains\", \"\")\n+        );\n+\n+    /* Lock everything.  Not sure if this is needed for the whole duration\n+       of the call, but better be safe than sorry.  */\n+    LOCK(cs_main);\n+\n+    /* For each block known, keep track if there are follow-ups (which have\n+       the block as pprev) so that we find the chain heads.  */\n+\n+    std::map<uint256, bool> blockIsHead;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+        blockIsHead.insert (std::make_pair (i->first, true));\n+\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (!pprev)\n+            continue;\n+\n+        const uint256 prevHash = *pprev->phashBlock;\n+        const std::map<uint256, bool>::iterator j = blockIsHead.find (prevHash);\n+        assert (j != blockIsHead.end ());\n+        j->second = false;\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+\n+    std::vector<uint256> heads;\n+    for (std::map<uint256, bool>::const_iterator j = blockIsHead.begin ();\n+         j != blockIsHead.end (); ++j)\n+    {\n+        if (j->second)\n+            heads.push_back (j->first);\n+    }\n+\n+    std::sort (heads.begin (), heads.end (), &compareBlocksByHeight);\n+\n+    /* Construct the output array.  */\n+\n+    Array res;\n+    for (std::vector<uint256>::const_iterator j = heads.begin ();\n+         j != heads.end (); ++j)\n+    {\n+        i = mapBlockIndex.find (*j);\n+        assert (i != mapBlockIndex.end ());\n+\n+        const CBlockIndex& block = *i->second;\n+        assert (*j == *block.phashBlock);\n+\n+        Object obj;\n+        obj.push_back (Pair (\"height\", block.nHeight));\n+        obj.push_back (Pair (\"hash\", block.phashBlock->GetHex ()));\n+\n+        const bool isMain = chainActive.Contains (&block);\n+        obj.push_back (Pair (\"is_best\", isMain));\n+\n+        /* If the block is not the main head, construct the branch that\n+           connects it to the main chain.  */\n+        if (!isMain)\n+        {\n+            Array branch;\n+            int len = 0;\n+\n+            const CBlockIndex* pcur = &block;\n+            while (true)\n+            {\n+                assert (pcur->pprev);\n+                pcur = pcur->pprev;\n+\n+                branch.push_back (pcur->phashBlock->GetHex ());\n+                ++len;\n+\n+                /* We are on the main chain if there's a next pointer.  */\n+                if (chainActive.Contains (pcur))\n+                    break;\n+            }\n+\n+            obj.push_back (Pair (\"branch_len\", len));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r14950608",
      "id" : 14950608,
      "original_commit_id" : "0d12743c48b25f51da81cb5ebcce45e0d3c81f85",
      "original_position" : 106,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14950608",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r14950763"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14950763"
         }
      },
      "body" : "Convention for RPC results is to not sometimes return a field and sometimes not.\r\n\r\nSo returning an empty branch Array here would be better.\r\n\r\nIs branch_len always the length of the branch array? If yes, then it is redundant and should be removed.\r\n",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-15T17:43:57Z",
      "diff_hunk" : "@@ -461,3 +461,116 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchains heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchains (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchains\\n\"\n+            \"Return status of all known chains.\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli (\"getchains\", \"\")\n+            + HelpExampleRpc (\"getchains\", \"\")\n+        );\n+\n+    /* Lock everything.  Not sure if this is needed for the whole duration\n+       of the call, but better be safe than sorry.  */\n+    LOCK(cs_main);\n+\n+    /* For each block known, keep track if there are follow-ups (which have\n+       the block as pprev) so that we find the chain heads.  */\n+\n+    std::map<uint256, bool> blockIsHead;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+        blockIsHead.insert (std::make_pair (i->first, true));\n+\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (!pprev)\n+            continue;\n+\n+        const uint256 prevHash = *pprev->phashBlock;\n+        const std::map<uint256, bool>::iterator j = blockIsHead.find (prevHash);\n+        assert (j != blockIsHead.end ());\n+        j->second = false;\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+\n+    std::vector<uint256> heads;\n+    for (std::map<uint256, bool>::const_iterator j = blockIsHead.begin ();\n+         j != blockIsHead.end (); ++j)\n+    {\n+        if (j->second)\n+            heads.push_back (j->first);\n+    }\n+\n+    std::sort (heads.begin (), heads.end (), &compareBlocksByHeight);\n+\n+    /* Construct the output array.  */\n+\n+    Array res;\n+    for (std::vector<uint256>::const_iterator j = heads.begin ();\n+         j != heads.end (); ++j)\n+    {\n+        i = mapBlockIndex.find (*j);\n+        assert (i != mapBlockIndex.end ());\n+\n+        const CBlockIndex& block = *i->second;\n+        assert (*j == *block.phashBlock);\n+\n+        Object obj;\n+        obj.push_back (Pair (\"height\", block.nHeight));\n+        obj.push_back (Pair (\"hash\", block.phashBlock->GetHex ()));\n+\n+        const bool isMain = chainActive.Contains (&block);\n+        obj.push_back (Pair (\"is_best\", isMain));\n+\n+        /* If the block is not the main head, construct the branch that\n+           connects it to the main chain.  */\n+        if (!isMain)\n+        {\n+            Array branch;\n+            int len = 0;\n+\n+            const CBlockIndex* pcur = &block;\n+            while (true)\n+            {\n+                assert (pcur->pprev);\n+                pcur = pcur->pprev;\n+\n+                branch.push_back (pcur->phashBlock->GetHex ());\n+                ++len;\n+\n+                /* We are on the main chain if there's a next pointer.  */\n+                if (chainActive.Contains (pcur))\n+                    break;\n+            }\n+\n+            obj.push_back (Pair (\"branch_len\", len));\n+            obj.push_back (Pair (\"branch\", branch));\n+        }\n+        else\n+            obj.push_back (Pair (\"branch_len\", 0));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r14950763",
      "id" : 14950763,
      "original_commit_id" : "0d12743c48b25f51da81cb5ebcce45e0d3c81f85",
      "original_position" : 110,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14950763",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Also: a regression test that exercises this new RPC call would be spiffy (see qa/rpc-tests/ for examples).",
      "created_at" : "2014-07-15T17:46:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49067638",
      "id" : 49067638,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-15T17:46:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49067638",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r14950996"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14950996"
         }
      },
      "body" : "Ok.  Yes, it is always the length - I included it originally for convenience when reading the data manually in a terminal or something.  But I can remove it, as it is indeed redundant.  I realise there are in general a lot of rough edges in the patch, I'll update it tomorrow to a hopefully cleaner one.",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-15T17:47:23Z",
      "diff_hunk" : "@@ -461,3 +461,116 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchains heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchains (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchains\\n\"\n+            \"Return status of all known chains.\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli (\"getchains\", \"\")\n+            + HelpExampleRpc (\"getchains\", \"\")\n+        );\n+\n+    /* Lock everything.  Not sure if this is needed for the whole duration\n+       of the call, but better be safe than sorry.  */\n+    LOCK(cs_main);\n+\n+    /* For each block known, keep track if there are follow-ups (which have\n+       the block as pprev) so that we find the chain heads.  */\n+\n+    std::map<uint256, bool> blockIsHead;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+        blockIsHead.insert (std::make_pair (i->first, true));\n+\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (!pprev)\n+            continue;\n+\n+        const uint256 prevHash = *pprev->phashBlock;\n+        const std::map<uint256, bool>::iterator j = blockIsHead.find (prevHash);\n+        assert (j != blockIsHead.end ());\n+        j->second = false;\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+\n+    std::vector<uint256> heads;\n+    for (std::map<uint256, bool>::const_iterator j = blockIsHead.begin ();\n+         j != blockIsHead.end (); ++j)\n+    {\n+        if (j->second)\n+            heads.push_back (j->first);\n+    }\n+\n+    std::sort (heads.begin (), heads.end (), &compareBlocksByHeight);\n+\n+    /* Construct the output array.  */\n+\n+    Array res;\n+    for (std::vector<uint256>::const_iterator j = heads.begin ();\n+         j != heads.end (); ++j)\n+    {\n+        i = mapBlockIndex.find (*j);\n+        assert (i != mapBlockIndex.end ());\n+\n+        const CBlockIndex& block = *i->second;\n+        assert (*j == *block.phashBlock);\n+\n+        Object obj;\n+        obj.push_back (Pair (\"height\", block.nHeight));\n+        obj.push_back (Pair (\"hash\", block.phashBlock->GetHex ()));\n+\n+        const bool isMain = chainActive.Contains (&block);\n+        obj.push_back (Pair (\"is_best\", isMain));\n+\n+        /* If the block is not the main head, construct the branch that\n+           connects it to the main chain.  */\n+        if (!isMain)\n+        {\n+            Array branch;\n+            int len = 0;\n+\n+            const CBlockIndex* pcur = &block;\n+            while (true)\n+            {\n+                assert (pcur->pprev);\n+                pcur = pcur->pprev;\n+\n+                branch.push_back (pcur->phashBlock->GetHex ());\n+                ++len;\n+\n+                /* We are on the main chain if there's a next pointer.  */\n+                if (chainActive.Contains (pcur))\n+                    break;\n+            }\n+\n+            obj.push_back (Pair (\"branch_len\", len));\n+            obj.push_back (Pair (\"branch\", branch));\n+        }\n+        else\n+            obj.push_back (Pair (\"branch_len\", 0));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r14950996",
      "id" : 14950996,
      "original_commit_id" : "0d12743c48b25f51da81cb5ebcce45e0d3c81f85",
      "original_position" : 110,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14950996",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "I've now updated the code and help text.  What do you think about it?  @sipa, is this the algorithm you had in mind?  I'll also build a new unit test for the call, possibly tomorrow.",
      "created_at" : "2014-07-16T19:46:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49216784",
      "id" : 49216784,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-16T19:46:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49216784",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "@TheBlueMatt: Not sure why the test failed - the log shows no conclusive error message (but I haven't got any experience with your script so far), and it builds perfectly fine for me on GNU/Linux (after a `make distclean`).  Also `make check` works fine.  Any hints?",
      "created_at" : "2014-07-17T05:34:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49260115",
      "id" : 49260115,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-17T05:34:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49260115",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "Currently pulltester is broken.\r\n",
      "created_at" : "2014-07-17T06:04:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49261542",
      "id" : 49261542,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-17T06:04:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49261542",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Basic regtest added.  Since the test framework chain doesn't contain orphans, it only checks that the \"isbest:true\" result is as expected.  Ok?",
      "created_at" : "2014-07-18T08:46:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49408556",
      "id" : 49408556,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-18T08:46:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49408556",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15102172"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15102172"
         }
      },
      "body" : "As the command is not marked as `threadSafe` in the RPC command table, acquiring any locks is redundant.\r\n",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-18T09:10:15Z",
      "diff_hunk" : "@@ -461,3 +461,112 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchaintips (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branch\\\": []            (array) empty for the main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branch\\\": [             (array) blocks connecting the tip to the main chain\\n\"\n+            \"      \\\"xxxx\\\"                (string) hashes of the connecting blocks\\n\"\n+            \"    ]\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli (\"getchaintips\", \"\")\n+            + HelpExampleRpc (\"getchaintips\", \"\")\n+        );\n+\n+    /* Lock everything.  Not sure if this is needed for the whole duration\n+       of the call, but better be safe than sorry.  */\n+    LOCK(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15102172",
      "id" : 15102172,
      "original_commit_id" : "dc290df1cb5a1aba6ef66211cddd17a7a48c100e",
      "original_position" : 49,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15102172",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15102297"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15102297"
         }
      },
      "body" : "I'd prefer throwing a JSONRPCError when unexpected things happen in this function instead of asserting.\r\n",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-18T09:14:45Z",
      "diff_hunk" : "@@ -461,3 +461,112 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchaintips (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branch\\\": []            (array) empty for the main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branch\\\": [             (array) blocks connecting the tip to the main chain\\n\"\n+            \"      \\\"xxxx\\\"                (string) hashes of the connecting blocks\\n\"\n+            \"    ]\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli (\"getchaintips\", \"\")\n+            + HelpExampleRpc (\"getchaintips\", \"\")\n+        );\n+\n+    /* Lock everything.  Not sure if this is needed for the whole duration\n+       of the call, but better be safe than sorry.  */\n+    LOCK(cs_main);\n+\n+    /* Build up a list of chain tips.  We start with the list of all\n+       known blocks, and successively remove blocks that appear as pprev\n+       of another block.  */\n+    std::set<uint256> setTips;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+        setTips.insert (i->first);\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (pprev)\n+        {\n+            const uint256 prevHash = *pprev->phashBlock;\n+            const std::set<uint256>::iterator j = setTips.find (prevHash);\n+            if (j != setTips.end ())\n+                setTips.erase (j);\n+        }\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+    std::vector<uint256> vTips(setTips.begin (), setTips.end ());\n+    std::sort (vTips.begin (), vTips.end (), &compareBlocksByHeight);\n+\n+    /* Construct the output array.  */\n+    Array res;\n+    for (std::vector<uint256>::const_iterator j = vTips.begin ();\n+         j != vTips.end (); ++j)\n+    {\n+        i = mapBlockIndex.find (*j);\n+        assert (i != mapBlockIndex.end ());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15102297",
      "id" : 15102297,
      "original_commit_id" : "dc290df1cb5a1aba6ef66211cddd17a7a48c100e",
      "original_position" : 80,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15102297",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Useful information, ACK on concept.\r\n",
      "created_at" : "2014-07-18T09:15:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49411017",
      "id" : 49411017,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-18T09:15:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49411017",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15102425"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15102425"
         }
      },
      "body" : "I see.  So just removing the LOCK in the call is fine?",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-18T09:18:23Z",
      "diff_hunk" : "@@ -461,3 +461,112 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchaintips (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branch\\\": []            (array) empty for the main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branch\\\": [             (array) blocks connecting the tip to the main chain\\n\"\n+            \"      \\\"xxxx\\\"                (string) hashes of the connecting blocks\\n\"\n+            \"    ]\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli (\"getchaintips\", \"\")\n+            + HelpExampleRpc (\"getchaintips\", \"\")\n+        );\n+\n+    /* Lock everything.  Not sure if this is needed for the whole duration\n+       of the call, but better be safe than sorry.  */\n+    LOCK(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15102425",
      "id" : 15102425,
      "original_commit_id" : "dc290df1cb5a1aba6ef66211cddd17a7a48c100e",
      "original_position" : 49,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15102425",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15102465"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15102465"
         }
      },
      "body" : "This assert should never really happen, and it shouldn't be possible to trigger it by invalid user input or something like that.  For me, this is precisely a situation where one wants to assert().  But if it is more in line with Bitcoin Core philosophy to throw a JSONRPCError, I can, of course, do that.",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-18T09:19:29Z",
      "diff_hunk" : "@@ -461,3 +461,112 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchaintips (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branch\\\": []            (array) empty for the main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branch\\\": [             (array) blocks connecting the tip to the main chain\\n\"\n+            \"      \\\"xxxx\\\"                (string) hashes of the connecting blocks\\n\"\n+            \"    ]\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli (\"getchaintips\", \"\")\n+            + HelpExampleRpc (\"getchaintips\", \"\")\n+        );\n+\n+    /* Lock everything.  Not sure if this is needed for the whole duration\n+       of the call, but better be safe than sorry.  */\n+    LOCK(cs_main);\n+\n+    /* Build up a list of chain tips.  We start with the list of all\n+       known blocks, and successively remove blocks that appear as pprev\n+       of another block.  */\n+    std::set<uint256> setTips;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+        setTips.insert (i->first);\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (pprev)\n+        {\n+            const uint256 prevHash = *pprev->phashBlock;\n+            const std::set<uint256>::iterator j = setTips.find (prevHash);\n+            if (j != setTips.end ())\n+                setTips.erase (j);\n+        }\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+    std::vector<uint256> vTips(setTips.begin (), setTips.end ());\n+    std::sort (vTips.begin (), vTips.end (), &compareBlocksByHeight);\n+\n+    /* Construct the output array.  */\n+    Array res;\n+    for (std::vector<uint256>::const_iterator j = vTips.begin ();\n+         j != vTips.end (); ++j)\n+    {\n+        i = mapBlockIndex.find (*j);\n+        assert (i != mapBlockIndex.end ());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15102465",
      "id" : 15102465,
      "original_commit_id" : "dc290df1cb5a1aba6ef66211cddd17a7a48c100e",
      "original_position" : 80,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15102465",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15103016"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15103016"
         }
      },
      "body" : "Yes. The calling code acquires the cs_main lock and cs_wallet locks if that bit is not set.\r\n",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-18T09:33:25Z",
      "diff_hunk" : "@@ -461,3 +461,112 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchaintips (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branch\\\": []            (array) empty for the main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branch\\\": [             (array) blocks connecting the tip to the main chain\\n\"\n+            \"      \\\"xxxx\\\"                (string) hashes of the connecting blocks\\n\"\n+            \"    ]\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli (\"getchaintips\", \"\")\n+            + HelpExampleRpc (\"getchaintips\", \"\")\n+        );\n+\n+    /* Lock everything.  Not sure if this is needed for the whole duration\n+       of the call, but better be safe than sorry.  */\n+    LOCK(cs_main);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15103016",
      "id" : 15103016,
      "original_commit_id" : "dc290df1cb5a1aba6ef66211cddd17a7a48c100e",
      "original_position" : 49,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15103016",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15103153"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15103153"
         }
      },
      "body" : "Well - fine with me to keep it as assert in that case.",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-18T09:37:19Z",
      "diff_hunk" : "@@ -461,3 +461,112 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchaintips (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branch\\\": []            (array) empty for the main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branch\\\": [             (array) blocks connecting the tip to the main chain\\n\"\n+            \"      \\\"xxxx\\\"                (string) hashes of the connecting blocks\\n\"\n+            \"    ]\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli (\"getchaintips\", \"\")\n+            + HelpExampleRpc (\"getchaintips\", \"\")\n+        );\n+\n+    /* Lock everything.  Not sure if this is needed for the whole duration\n+       of the call, but better be safe than sorry.  */\n+    LOCK(cs_main);\n+\n+    /* Build up a list of chain tips.  We start with the list of all\n+       known blocks, and successively remove blocks that appear as pprev\n+       of another block.  */\n+    std::set<uint256> setTips;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+        setTips.insert (i->first);\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (pprev)\n+        {\n+            const uint256 prevHash = *pprev->phashBlock;\n+            const std::set<uint256>::iterator j = setTips.find (prevHash);\n+            if (j != setTips.end ())\n+                setTips.erase (j);\n+        }\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+    std::vector<uint256> vTips(setTips.begin (), setTips.end ());\n+    std::sort (vTips.begin (), vTips.end (), &compareBlocksByHeight);\n+\n+    /* Construct the output array.  */\n+    Array res;\n+    for (std::vector<uint256>::const_iterator j = vTips.begin ();\n+         j != vTips.end (); ++j)\n+    {\n+        i = mapBlockIndex.find (*j);\n+        assert (i != mapBlockIndex.end ());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15103153",
      "id" : 15103153,
      "original_commit_id" : "dc290df1cb5a1aba6ef66211cddd17a7a48c100e",
      "original_position" : 80,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15103153",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15130818"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15130818"
         }
      },
      "body" : "Coding style nit: no space before ()",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-18T20:04:42Z",
      "diff_hunk" : "@@ -461,3 +461,108 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15130818",
      "id" : 15130818,
      "original_commit_id" : "fa69eaa41ba1cf5c62352aefb4dfefef25a4ff4f",
      "original_position" : 10,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15130818",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15130878"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15130878"
         }
      },
      "body" : "Agree on using an assert.",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-18T20:06:01Z",
      "diff_hunk" : "@@ -461,3 +461,112 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchaintips (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branch\\\": []            (array) empty for the main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branch\\\": [             (array) blocks connecting the tip to the main chain\\n\"\n+            \"      \\\"xxxx\\\"                (string) hashes of the connecting blocks\\n\"\n+            \"    ]\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli (\"getchaintips\", \"\")\n+            + HelpExampleRpc (\"getchaintips\", \"\")\n+        );\n+\n+    /* Lock everything.  Not sure if this is needed for the whole duration\n+       of the call, but better be safe than sorry.  */\n+    LOCK(cs_main);\n+\n+    /* Build up a list of chain tips.  We start with the list of all\n+       known blocks, and successively remove blocks that appear as pprev\n+       of another block.  */\n+    std::set<uint256> setTips;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+        setTips.insert (i->first);\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (pprev)\n+        {\n+            const uint256 prevHash = *pprev->phashBlock;\n+            const std::set<uint256>::iterator j = setTips.find (prevHash);\n+            if (j != setTips.end ())\n+                setTips.erase (j);\n+        }\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+    std::vector<uint256> vTips(setTips.begin (), setTips.end ());\n+    std::sort (vTips.begin (), vTips.end (), &compareBlocksByHeight);\n+\n+    /* Construct the output array.  */\n+    Array res;\n+    for (std::vector<uint256>::const_iterator j = vTips.begin ();\n+         j != vTips.end (); ++j)\n+    {\n+        i = mapBlockIndex.find (*j);\n+        assert (i != mapBlockIndex.end ());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15130878",
      "id" : 15130878,
      "original_commit_id" : "dc290df1cb5a1aba6ef66211cddd17a7a48c100e",
      "original_position" : 80,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15130878",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15131001"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15131001"
         }
      },
      "body" : "This wasn't clear to me from the documentation. How about just include the length of the branch (how many blocks are not in the main chain)? You can always find the actual chain through getblock -> prev.",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-18T20:08:35Z",
      "diff_hunk" : "@@ -461,3 +461,108 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchaintips (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branch\\\": []            (array) empty for the main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branch\\\": [             (array) blocks connecting the tip to the main chain\\n\"\n+            \"      \\\"xxxx\\\"                (string) hashes of the connecting blocks\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15131001",
      "id" : 15131001,
      "original_commit_id" : "fa69eaa41ba1cf5c62352aefb4dfefef25a4ff4f",
      "original_position" : 38,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15131001",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15143250"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15143250"
         }
      },
      "body" : "I see.  I'm used to GNU projects and tried to adapt my style to the surrounding code, but it seemed not to have worked 100%.  I can, of course, change this if it matters.  Should I?",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-19T11:36:33Z",
      "diff_hunk" : "@@ -461,3 +461,108 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15143250",
      "id" : 15143250,
      "original_commit_id" : "fa69eaa41ba1cf5c62352aefb4dfefef25a4ff4f",
      "original_position" : 10,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15143250",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15143256"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15143256"
         }
      },
      "body" : "That's true, but my original motivation was to include the information already here because it makes life easier.  If you want the branch, you don't have to use repeated \"getblock\" calls.  It doesn't hurt much to have that here instead of the length, IMHO.  But if you prefer the length, I will change it of course.",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-19T11:37:53Z",
      "diff_hunk" : "@@ -461,3 +461,108 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchaintips (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branch\\\": []            (array) empty for the main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branch\\\": [             (array) blocks connecting the tip to the main chain\\n\"\n+            \"      \\\"xxxx\\\"                (string) hashes of the connecting blocks\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15143256",
      "id" : 15143256,
      "original_commit_id" : "fa69eaa41ba1cf5c62352aefb4dfefef25a4ff4f",
      "original_position" : 38,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15143256",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "I've now updated the whitespace and replaced the \"branch\" output in the JSON result with \"branchlen\", according to the last feedback.  Should I provide a quashed commit, or is the series of commits also fine?",
      "created_at" : "2014-07-21T09:54:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49588339",
      "id" : 49588339,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-21T09:54:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49588339",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "A series of commits is fine if the commits are distinct changes, or a logical sequence of changes.\r\n\r\nIn this case I'd suggest squashing as all of the changes apply to the same code.\r\n",
      "created_at" : "2014-07-21T09:56:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49588558",
      "id" : 49588558,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-21T10:08:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49588558",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Squashed commit of the last version.",
      "created_at" : "2014-07-21T11:02:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-49593111",
      "id" : 49593111,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-21T11:02:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49593111",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15167431"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15167431"
         }
      },
      "body" : "If it should not happen in any way, why is it there ;)?",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-21T13:16:21Z",
      "diff_hunk" : "@@ -461,3 +461,112 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight (const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find (a);\n+    ib = mapBlockIndex.find (b);\n+\n+    assert (ia != mapBlockIndex.end () && ib != mapBlockIndex.end ());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchaintips (const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size () != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branch\\\": []            (array) empty for the main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branch\\\": [             (array) blocks connecting the tip to the main chain\\n\"\n+            \"      \\\"xxxx\\\"                (string) hashes of the connecting blocks\\n\"\n+            \"    ]\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli (\"getchaintips\", \"\")\n+            + HelpExampleRpc (\"getchaintips\", \"\")\n+        );\n+\n+    /* Lock everything.  Not sure if this is needed for the whole duration\n+       of the call, but better be safe than sorry.  */\n+    LOCK(cs_main);\n+\n+    /* Build up a list of chain tips.  We start with the list of all\n+       known blocks, and successively remove blocks that appear as pprev\n+       of another block.  */\n+    std::set<uint256> setTips;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+        setTips.insert (i->first);\n+    for (i = mapBlockIndex.begin (); i != mapBlockIndex.end (); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (pprev)\n+        {\n+            const uint256 prevHash = *pprev->phashBlock;\n+            const std::set<uint256>::iterator j = setTips.find (prevHash);\n+            if (j != setTips.end ())\n+                setTips.erase (j);\n+        }\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+    std::vector<uint256> vTips(setTips.begin (), setTips.end ());\n+    std::sort (vTips.begin (), vTips.end (), &compareBlocksByHeight);\n+\n+    /* Construct the output array.  */\n+    Array res;\n+    for (std::vector<uint256>::const_iterator j = vTips.begin ();\n+         j != vTips.end (); ++j)\n+    {\n+        i = mapBlockIndex.find (*j);\n+        assert (i != mapBlockIndex.end ());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15167431",
      "id" : 15167431,
      "original_commit_id" : "dc290df1cb5a1aba6ef66211cddd17a7a48c100e",
      "original_position" : 80,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15167431",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "I think the implementation can be made more efficient by using sets/maps of CBlockIndex* entries rather than uint256's. (it means you don't need a find in the comparator, and the data structures are 4 or 8 times smaller).",
      "created_at" : "2014-07-27T14:51:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-50266328",
      "id" : 50266328,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-27T14:54:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/50266328",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15439651"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15439651"
         }
      },
      "body" : "You can use pcur->nHeight - chainActive.FindFork(pcur)->nHeight; instead of this loop (which uses the recently added CBlockIndex* skiplist).",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-27T14:53:08Z",
      "diff_hunk" : "@@ -461,3 +461,106 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight(const uint256& a, const uint256& b)\n+{\n+    std::map<uint256, CBlockIndex*>::const_iterator ia, ib;\n+\n+    ia = mapBlockIndex.find(a);\n+    ib = mapBlockIndex.find(b);\n+\n+    assert (ia != mapBlockIndex.end() && ib != mapBlockIndex.end());\n+\n+    return (ia->second->nHeight > ib->second->nHeight);\n+}\n+\n+Value getchaintips(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branchlen\\\": 0          (numeric) zero for main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branchlen\\\": 1          (numeric) length of branch connecting the tip to the main chain\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"getchaintips\", \"\")\n+            + HelpExampleRpc(\"getchaintips\", \"\")\n+        );\n+\n+    /* Build up a list of chain tips.  We start with the list of all\n+       known blocks, and successively remove blocks that appear as pprev\n+       of another block.  */\n+    std::set<uint256> setTips;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+    for (i = mapBlockIndex.begin(); i != mapBlockIndex.end(); ++i)\n+        setTips.insert(i->first);\n+    for (i = mapBlockIndex.begin(); i != mapBlockIndex.end(); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (pprev)\n+        {\n+            const uint256 prevHash = *pprev->phashBlock;\n+            const std::set<uint256>::iterator j = setTips.find(prevHash);\n+            if (j != setTips.end())\n+                setTips.erase(j);\n+        }\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+    std::vector<uint256> vTips(setTips.begin(), setTips.end());\n+    std::sort(vTips.begin(), vTips.end(), &compareBlocksByHeight);\n+\n+    /* Construct the output array.  */\n+    Array res;\n+    for (std::vector<uint256>::const_iterator j = vTips.begin();\n+         j != vTips.end(); ++j)\n+    {\n+        i = mapBlockIndex.find(*j);\n+        assert (i != mapBlockIndex.end());\n+\n+        const CBlockIndex& block = *i->second;\n+        assert (*j == *block.phashBlock);\n+\n+        Object obj;\n+        obj.push_back(Pair(\"height\", block.nHeight));\n+        obj.push_back(Pair(\"hash\", block.phashBlock->GetHex()));\n+\n+        const bool isMain = chainActive.Contains(&block);\n+        obj.push_back(Pair(\"isbest\", isMain));\n+\n+        /* If the block is not the main head, construct the branch that\n+           connects it to the main chain.  Find its length.  */\n+        int branchLen = 0;\n+        if (!isMain)\n+        {\n+            const CBlockIndex* pcur = &block;\n+            do\n+            {\n+                assert (pcur->pprev);\n+                pcur = pcur->pprev;\n+                ++branchLen;\n+            }\n+            while (!chainActive.Contains(pcur));\n+        }\n+        obj.push_back(Pair(\"branchlen\", branchLen));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15439651",
      "id" : 15439651,
      "original_commit_id" : "3e1af92c1b63a28aae40261ed57d4fc227ff97b7",
      "original_position" : 100,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15439651",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Indeed, very good observations!  I've updated the patch now.  Let me know if it is ok like this, then I will again provide a squashed commit instead.",
      "created_at" : "2014-07-29T17:05:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-50506289",
      "id" : 50506289,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-07-29T17:05:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/50506289",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15560335"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15560335"
         }
      },
      "body" : "No need for the find/erase. Just `setTips.erase(pprev)`.\r\n",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-29T23:54:33Z",
      "diff_hunk" : "@@ -461,3 +461,81 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight(const CBlockIndex* a, const CBlockIndex* b)\n+{\n+    return (a->nHeight > b->nHeight);\n+}\n+\n+Value getchaintips(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branchlen\\\": 0          (numeric) zero for main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branchlen\\\": 1          (numeric) length of branch connecting the tip to the main chain\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"getchaintips\", \"\")\n+            + HelpExampleRpc(\"getchaintips\", \"\")\n+        );\n+\n+    /* Build up a list of chain tips.  We start with the list of all\n+       known blocks, and successively remove blocks that appear as pprev\n+       of another block.  */\n+    std::set<const CBlockIndex*> setTips;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+    for (i = mapBlockIndex.begin(); i != mapBlockIndex.end(); ++i)\n+        setTips.insert(i->second);\n+    for (i = mapBlockIndex.begin(); i != mapBlockIndex.end(); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15560335",
      "id" : 15560335,
      "original_commit_id" : "b92da981fe4f4609ae442cb92b4eca7a50f3c52d",
      "original_position" : 47,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15560335",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15560369"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15560369"
         }
      },
      "body" : "Does this work? This will compare two blocks equal if they're of equal height. I'm not sure how std::sort behaves when the comparator and the equality operator are inconsistent.",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-29T23:55:49Z",
      "diff_hunk" : "@@ -461,3 +461,81 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight(const CBlockIndex* a, const CBlockIndex* b)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15560369",
      "id" : 15560369,
      "original_commit_id" : "b92da981fe4f4609ae442cb92b4eca7a50f3c52d",
      "original_position" : 6,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15560369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15560427"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15560427"
         }
      },
      "body" : "If you make the comparator support multiple blocks at the same height, you could just use that comparator directly as internal sort for setTips, so you don't need the vector or the explicity sort, and can just iterate through setTips (use BOOST_FOREACH, btw).",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-29T23:57:32Z",
      "diff_hunk" : "@@ -461,3 +461,81 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight(const CBlockIndex* a, const CBlockIndex* b)\n+{\n+    return (a->nHeight > b->nHeight);\n+}\n+\n+Value getchaintips(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branchlen\\\": 0          (numeric) zero for main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branchlen\\\": 1          (numeric) length of branch connecting the tip to the main chain\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"getchaintips\", \"\")\n+            + HelpExampleRpc(\"getchaintips\", \"\")\n+        );\n+\n+    /* Build up a list of chain tips.  We start with the list of all\n+       known blocks, and successively remove blocks that appear as pprev\n+       of another block.  */\n+    std::set<const CBlockIndex*> setTips;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+    for (i = mapBlockIndex.begin(); i != mapBlockIndex.end(); ++i)\n+        setTips.insert(i->second);\n+    for (i = mapBlockIndex.begin(); i != mapBlockIndex.end(); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (pprev)\n+        {\n+            const std::set<const CBlockIndex*>::iterator j = setTips.find(pprev);\n+            if (j != setTips.end())\n+                setTips.erase(j);\n+        }\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+    std::vector<const CBlockIndex*> vTips(setTips.begin(), setTips.end());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15560427",
      "id" : 15560427,
      "original_commit_id" : "b92da981fe4f4609ae442cb92b4eca7a50f3c52d",
      "original_position" : 57,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15560427",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15560597"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15560597"
         }
      },
      "body" : "The name 'isbest' may be obvious now, but if #4468 would get merged, we may end up with multiple header tips that all descend from the current chainActive (while we're catching up).\r\n\r\nI'm not sure how to deal with this, but something branchlen essentially conveys this information already (maybe a better name is 'reorg_distance' or 'fork_distance', or replace it with 'fork_height'?) - if it's 0, it extends our main branch.\r\n\r\nEDIT: ah, not really; fork_distance would be chainActive.Height() - chainActive.FindFork(&block)->nHeight. 'isbest' would be equal to fork_distance == 0 then.",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-30T00:02:59Z",
      "diff_hunk" : "@@ -461,3 +461,81 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight(const CBlockIndex* a, const CBlockIndex* b)\n+{\n+    return (a->nHeight > b->nHeight);\n+}\n+\n+Value getchaintips(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branchlen\\\": 0          (numeric) zero for main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branchlen\\\": 1          (numeric) length of branch connecting the tip to the main chain\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"getchaintips\", \"\")\n+            + HelpExampleRpc(\"getchaintips\", \"\")\n+        );\n+\n+    /* Build up a list of chain tips.  We start with the list of all\n+       known blocks, and successively remove blocks that appear as pprev\n+       of another block.  */\n+    std::set<const CBlockIndex*> setTips;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+    for (i = mapBlockIndex.begin(); i != mapBlockIndex.end(); ++i)\n+        setTips.insert(i->second);\n+    for (i = mapBlockIndex.begin(); i != mapBlockIndex.end(); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (pprev)\n+        {\n+            const std::set<const CBlockIndex*>::iterator j = setTips.find(pprev);\n+            if (j != setTips.end())\n+                setTips.erase(j);\n+        }\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+    std::vector<const CBlockIndex*> vTips(setTips.begin(), setTips.end());\n+    std::sort(vTips.begin(), vTips.end(), &compareBlocksByHeight);\n+\n+    /* Construct the output array.  */\n+    Array res;\n+    for (std::vector<const CBlockIndex*>::const_iterator j = vTips.begin();\n+         j != vTips.end(); ++j)\n+    {\n+        const CBlockIndex& block = **j;\n+\n+        Object obj;\n+        obj.push_back(Pair(\"height\", block.nHeight));\n+        obj.push_back(Pair(\"hash\", block.phashBlock->GetHex()));\n+\n+        const bool isMain = chainActive.Contains(&block);\n+        obj.push_back(Pair(\"isbest\", isMain));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15560597",
      "id" : 15560597,
      "original_commit_id" : "b92da981fe4f4609ae442cb92b4eca7a50f3c52d",
      "original_position" : 72,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15560597",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15566598"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15566598"
         }
      },
      "body" : "I think that the STL doesn't use the '==' at all in sort, it considers elements to be the same if neither \"a < b\" nor \"b < a\".  But I can't guarantee that it keeps two \"equal\" elements by themselves, rather than copying one of them two times - I believe not, but I'll change the code to include ordering of the pointers as a secondary criterion to be safe.",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-30T04:56:50Z",
      "diff_hunk" : "@@ -461,3 +461,81 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight(const CBlockIndex* a, const CBlockIndex* b)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15566598",
      "id" : 15566598,
      "original_commit_id" : "b92da981fe4f4609ae442cb92b4eca7a50f3c52d",
      "original_position" : 6,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15566598",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15566624"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15566624"
         }
      },
      "body" : "Yes, that is a good idea!\r\n\r\nI don't really like BOOST_FOREACH personally, but I guess this is how the existing code does it - so I'll change this, too.",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-30T04:58:57Z",
      "diff_hunk" : "@@ -461,3 +461,81 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight(const CBlockIndex* a, const CBlockIndex* b)\n+{\n+    return (a->nHeight > b->nHeight);\n+}\n+\n+Value getchaintips(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branchlen\\\": 0          (numeric) zero for main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branchlen\\\": 1          (numeric) length of branch connecting the tip to the main chain\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"getchaintips\", \"\")\n+            + HelpExampleRpc(\"getchaintips\", \"\")\n+        );\n+\n+    /* Build up a list of chain tips.  We start with the list of all\n+       known blocks, and successively remove blocks that appear as pprev\n+       of another block.  */\n+    std::set<const CBlockIndex*> setTips;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+    for (i = mapBlockIndex.begin(); i != mapBlockIndex.end(); ++i)\n+        setTips.insert(i->second);\n+    for (i = mapBlockIndex.begin(); i != mapBlockIndex.end(); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (pprev)\n+        {\n+            const std::set<const CBlockIndex*>::iterator j = setTips.find(pprev);\n+            if (j != setTips.end())\n+                setTips.erase(j);\n+        }\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+    std::vector<const CBlockIndex*> vTips(setTips.begin(), setTips.end());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15566624",
      "id" : 15566624,
      "original_commit_id" : "b92da981fe4f4609ae442cb92b4eca7a50f3c52d",
      "original_position" : 57,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15566624",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15566646"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15566646"
         }
      },
      "body" : "Yes, branchlen==0 is equivalent to isbest.  So if you prefer, we can drop the \"isbest\" field and just have \"branchlen\".  The name was suggested by Gavin, IIRC, but I can change it to \"fork_distance\" if that is clearer?",
      "commit_id" : "b33bd7a3be1cbcc8d255178307976b7762125b18",
      "created_at" : "2014-07-30T05:01:16Z",
      "diff_hunk" : "@@ -461,3 +461,81 @@ Value getblockchaininfo(const Array& params, bool fHelp)\n     obj.push_back(Pair(\"chainwork\",             chainActive.Tip()->nChainWork.GetHex()));\n     return obj;\n }\n+\n+/* Comparison function for sorting the getchaintips heads.  */\n+static bool compareBlocksByHeight(const CBlockIndex* a, const CBlockIndex* b)\n+{\n+    return (a->nHeight > b->nHeight);\n+}\n+\n+Value getchaintips(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 0)\n+        throw runtime_error(\n+            \"getchaintips\\n\"\n+            \"Return information about all known tips in the block tree,\"\n+            \" including the main chain as well as orphaned branches.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,         (numeric) height of the chain tip\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",         (string) block hash of the tip\\n\"\n+            \"    \\\"isbest\\\": true,         (boolean) whether this is the main chain\\n\"\n+            \"    \\\"branchlen\\\": 0          (numeric) zero for main chain\\n\"\n+            \"  },\\n\"\n+            \"  {\\n\"\n+            \"    \\\"height\\\": xxxx,\\n\"\n+            \"    \\\"hash\\\": \\\"xxxx\\\",\\n\"\n+            \"    \\\"isbest\\\": false,\\n\"\n+            \"    \\\"branchlen\\\": 1          (numeric) length of branch connecting the tip to the main chain\\n\"\n+            \"  }\\n\"\n+            \"]\\n\"\n+            \"\\nExamples:\\n\"\n+            + HelpExampleCli(\"getchaintips\", \"\")\n+            + HelpExampleRpc(\"getchaintips\", \"\")\n+        );\n+\n+    /* Build up a list of chain tips.  We start with the list of all\n+       known blocks, and successively remove blocks that appear as pprev\n+       of another block.  */\n+    std::set<const CBlockIndex*> setTips;\n+    std::map<uint256, CBlockIndex*>::const_iterator i;\n+    for (i = mapBlockIndex.begin(); i != mapBlockIndex.end(); ++i)\n+        setTips.insert(i->second);\n+    for (i = mapBlockIndex.begin(); i != mapBlockIndex.end(); ++i)\n+    {\n+        const CBlockIndex* pprev = i->second->pprev;\n+        if (pprev)\n+        {\n+            const std::set<const CBlockIndex*>::iterator j = setTips.find(pprev);\n+            if (j != setTips.end())\n+                setTips.erase(j);\n+        }\n+    }\n+\n+    /* Get chain heads and sort them by height.  */\n+    std::vector<const CBlockIndex*> vTips(setTips.begin(), setTips.end());\n+    std::sort(vTips.begin(), vTips.end(), &compareBlocksByHeight);\n+\n+    /* Construct the output array.  */\n+    Array res;\n+    for (std::vector<const CBlockIndex*>::const_iterator j = vTips.begin();\n+         j != vTips.end(); ++j)\n+    {\n+        const CBlockIndex& block = **j;\n+\n+        Object obj;\n+        obj.push_back(Pair(\"height\", block.nHeight));\n+        obj.push_back(Pair(\"hash\", block.phashBlock->GetHex()));\n+\n+        const bool isMain = chainActive.Contains(&block);\n+        obj.push_back(Pair(\"isbest\", isMain));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#discussion_r15566646",
      "id" : 15566646,
      "original_commit_id" : "b92da981fe4f4609ae442cb92b4eca7a50f3c52d",
      "original_position" : 72,
      "path" : "src/rpcblockchain.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4536",
      "updated_at" : "2014-08-03T16:13:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15566646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "Tested ACK. Works nicely.",
      "created_at" : "2014-08-03T10:40:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-50987210",
      "id" : 50987210,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-08-03T10:40:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/50987210",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Please squash you commits, though.",
      "created_at" : "2014-08-03T10:40:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-50987217",
      "id" : 50987217,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-08-03T10:40:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/50987217",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Another tested ACK (after squashing commits)",
      "created_at" : "2014-08-03T12:09:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-50988877",
      "id" : 50988877,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-08-03T12:09:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/50988877",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Thanks for the review - I've updated the branch to a single squashed commit.",
      "created_at" : "2014-08-03T16:14:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-50994589",
      "id" : 50994589,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-08-03T16:14:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/50994589",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4536_b33bd7a3be1cbcc8d255178307976b7762125b18/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-08-03T16:27:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4536#issuecomment-50994976",
      "id" : 50994976,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4536",
      "updated_at" : "2014-08-03T16:27:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/50994976",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   }
]
