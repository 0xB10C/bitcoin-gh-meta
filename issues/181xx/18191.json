{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "This patch contains to follow ups to #18120. I've done it as a follow on to not slow down a merge of #18120 (which I think is mergeable as is).\r\n\r\nThe first is a small regression fix -- the previous PR accidentally over-caches elements (we cache things that in setExclude, when there is no purpose for that). We now remove those elements from the cache before saving it, and trim to size if the cache is oversized after clearing the excluded elements (implementation dependent, but could save some memory).\r\n\r\nThe second further change is that we modify setExclude to be a property of the mempool entries rather than checking a set of the hashes. This adds a little bit of memory overhead (if we really cared, we could cram it into the top bit of the epoch or combine with bool spendsCoinbase). However, this makes checking the excluded set O(1) (and with fast constants) versus lots of indirection & hash comparison in a set. It's also a straightforward win because we get rid of having to use memory/time to build the setExcluded at all.\r\n\r\n@sdaftuar can you re-run your bench from #18120?",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 0,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18191/comments",
   "created_at" : "2020-02-22T04:19:12Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18191/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/18191",
   "id" : 569278507,
   "labels" : [
      {
         "color" : "fef2c0",
         "default" : false,
         "description" : null,
         "id" : 164208572,
         "name" : "Mempool",
         "node_id" : "MDU6TGFiZWwxNjQyMDg1NzI=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Mempool"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18191/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0Mzc4NTQ5MTUz",
   "number" : 18191,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/18191.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18191",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/18191.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18191"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Epoch mempool cache regression plus remove excluded set.",
   "updated_at" : "2020-02-22T04:35:08Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18191",
   "user" : {
      "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
      "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
      "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/JeremyRubin",
      "id" : 886523,
      "login" : "JeremyRubin",
      "node_id" : "MDQ6VXNlcjg4NjUyMw==",
      "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
      "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
      "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/JeremyRubin"
   }
}
