[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706516144"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706516144"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "this check is actually probably superfluous with the iteration not including combos -1 (the all bits set).",
      "commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "created_at" : "2021-09-10T23:21:03Z",
      "diff_hunk" : "@@ -174,9 +174,29 @@ unsigned int FillFlags(unsigned int flags)\n // Assumes that mapFlagNames contains all script verify flags.\n std::set<unsigned int> ExcludeIndividualFlags(unsigned int flags)\n {\n+    std::vector<unsigned int> set_flags;\n+    const size_t n_flags = sizeof(unsigned int);\n+    set_flags.reserve(n_flags);\n+    for (size_t i = 0; i < n_flags; ++i) {\n+        auto flag = flags & (1 << i);\n+        if (flag) {\n+            set_flags.push_back(flag);\n+        }\n+    }\n+    const auto combos = 1 << set_flags.size();\n+    // skip last all set flags\n+    std::vector<unsigned int> all_flag_combos(combos-1);\n+    for (size_t i = 0; i < combos-1; ++i){\n+        for(size_t j = 0; j < set_flags.size(); ++j) {\n+            if (i & (1<<j)) {\n+                all_flag_combos[i] |= set_flags[j];\n+            }\n+        }\n+    }\n+\n     std::set<unsigned int> flags_combos;\n-    for (const auto& pair : mapFlagNames) {\n-        const unsigned int flags_excluding_one = TrimFlags(flags & ~(pair.second));\n+    for (const auto& excluded_flags : all_flag_combos) {\n+        const unsigned int flags_excluding_one = TrimFlags(excluded_flags);\n         if (flags != flags_excluding_one) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706516144",
      "id" : 706516144,
      "line" : 200,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjUxNjE0NA==",
      "original_commit_id" : "125fb1c8dce51b1992cee6aa2c5b6faa6bd97b1d",
      "original_line" : 200,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/test/transaction_tests.cpp",
      "position" : 29,
      "pull_request_review_id" : 751852066,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-10T23:21:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706516144",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706518296"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706518296"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "update: it's not, because of the TrimFlags",
      "commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "created_at" : "2021-09-10T23:30:25Z",
      "diff_hunk" : "@@ -174,9 +174,29 @@ unsigned int FillFlags(unsigned int flags)\n // Assumes that mapFlagNames contains all script verify flags.\n std::set<unsigned int> ExcludeIndividualFlags(unsigned int flags)\n {\n+    std::vector<unsigned int> set_flags;\n+    const size_t n_flags = sizeof(unsigned int);\n+    set_flags.reserve(n_flags);\n+    for (size_t i = 0; i < n_flags; ++i) {\n+        auto flag = flags & (1 << i);\n+        if (flag) {\n+            set_flags.push_back(flag);\n+        }\n+    }\n+    const auto combos = 1 << set_flags.size();\n+    // skip last all set flags\n+    std::vector<unsigned int> all_flag_combos(combos-1);\n+    for (size_t i = 0; i < combos-1; ++i){\n+        for(size_t j = 0; j < set_flags.size(); ++j) {\n+            if (i & (1<<j)) {\n+                all_flag_combos[i] |= set_flags[j];\n+            }\n+        }\n+    }\n+\n     std::set<unsigned int> flags_combos;\n-    for (const auto& pair : mapFlagNames) {\n-        const unsigned int flags_excluding_one = TrimFlags(flags & ~(pair.second));\n+    for (const auto& excluded_flags : all_flag_combos) {\n+        const unsigned int flags_excluding_one = TrimFlags(excluded_flags);\n         if (flags != flags_excluding_one) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706518296",
      "id" : 706518296,
      "in_reply_to_id" : 706516144,
      "line" : 200,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjUxODI5Ng==",
      "original_commit_id" : "125fb1c8dce51b1992cee6aa2c5b6faa6bd97b1d",
      "original_line" : 200,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/test/transaction_tests.cpp",
      "position" : 29,
      "pull_request_review_id" : 751854312,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-10T23:30:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706518296",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706728574"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706728574"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think you might be missing a `* 8` here",
      "commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "created_at" : "2021-09-12T01:59:39Z",
      "diff_hunk" : "@@ -174,9 +174,29 @@ unsigned int FillFlags(unsigned int flags)\n // Assumes that mapFlagNames contains all script verify flags.\n std::set<unsigned int> ExcludeIndividualFlags(unsigned int flags)\n {\n+    std::vector<unsigned int> set_flags;\n+    const size_t n_flags = sizeof(unsigned int);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706728574",
      "id" : 706728574,
      "line" : 178,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjcyODU3NA==",
      "original_commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "original_line" : 178,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/transaction_tests.cpp",
      "position" : 5,
      "pull_request_review_id" : 752061278,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-12T02:41:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706728574",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/667132?v=4",
         "events_url" : "https://api.github.com/users/esneider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/esneider/followers",
         "following_url" : "https://api.github.com/users/esneider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/esneider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/esneider",
         "id" : 667132,
         "login" : "esneider",
         "node_id" : "MDQ6VXNlcjY2NzEzMg==",
         "organizations_url" : "https://api.github.com/users/esneider/orgs",
         "received_events_url" : "https://api.github.com/users/esneider/received_events",
         "repos_url" : "https://api.github.com/users/esneider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/esneider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/esneider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/esneider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706729262"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706729262"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The doc is out of date now",
      "commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "created_at" : "2021-09-12T02:08:10Z",
      "diff_hunk" : "@@ -174,9 +174,29 @@ unsigned int FillFlags(unsigned int flags)\n // Assumes that mapFlagNames contains all script verify flags.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706729262",
      "id" : 706729262,
      "line" : 174,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjcyOTI2Mg==",
      "original_commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "original_line" : 174,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/test/transaction_tests.cpp",
      "position" : 1,
      "pull_request_review_id" : 752061278,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-12T02:41:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706729262",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/667132?v=4",
         "events_url" : "https://api.github.com/users/esneider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/esneider/followers",
         "following_url" : "https://api.github.com/users/esneider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/esneider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/esneider",
         "id" : 667132,
         "login" : "esneider",
         "node_id" : "MDQ6VXNlcjY2NzEzMg==",
         "organizations_url" : "https://api.github.com/users/esneider/orgs",
         "received_events_url" : "https://api.github.com/users/esneider/received_events",
         "repos_url" : "https://api.github.com/users/esneider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/esneider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/esneider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/esneider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706730907"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706730907"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Notice that `TrimFlags` only removes flags, so it is, indeed, superfluous:\r\n`flags_excluding_one â excluded_flags â flags`\r\n\r\nHaving said that, there's no harm in leaving it here.",
      "commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "created_at" : "2021-09-12T02:28:46Z",
      "diff_hunk" : "@@ -174,9 +174,29 @@ unsigned int FillFlags(unsigned int flags)\n // Assumes that mapFlagNames contains all script verify flags.\n std::set<unsigned int> ExcludeIndividualFlags(unsigned int flags)\n {\n+    std::vector<unsigned int> set_flags;\n+    const size_t n_flags = sizeof(unsigned int);\n+    set_flags.reserve(n_flags);\n+    for (size_t i = 0; i < n_flags; ++i) {\n+        auto flag = flags & (1 << i);\n+        if (flag) {\n+            set_flags.push_back(flag);\n+        }\n+    }\n+    const auto combos = 1 << set_flags.size();\n+    // skip last all set flags\n+    std::vector<unsigned int> all_flag_combos(combos-1);\n+    for (size_t i = 0; i < combos-1; ++i){\n+        for(size_t j = 0; j < set_flags.size(); ++j) {\n+            if (i & (1<<j)) {\n+                all_flag_combos[i] |= set_flags[j];\n+            }\n+        }\n+    }\n+\n     std::set<unsigned int> flags_combos;\n-    for (const auto& pair : mapFlagNames) {\n-        const unsigned int flags_excluding_one = TrimFlags(flags & ~(pair.second));\n+    for (const auto& excluded_flags : all_flag_combos) {\n+        const unsigned int flags_excluding_one = TrimFlags(excluded_flags);\n         if (flags != flags_excluding_one) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706730907",
      "id" : 706730907,
      "in_reply_to_id" : 706516144,
      "line" : 200,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjczMDkwNw==",
      "original_commit_id" : "125fb1c8dce51b1992cee6aa2c5b6faa6bd97b1d",
      "original_line" : 200,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/test/transaction_tests.cpp",
      "position" : 29,
      "pull_request_review_id" : 752061278,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-12T02:41:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706730907",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/667132?v=4",
         "events_url" : "https://api.github.com/users/esneider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/esneider/followers",
         "following_url" : "https://api.github.com/users/esneider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/esneider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/esneider",
         "id" : 667132,
         "login" : "esneider",
         "node_id" : "MDQ6VXNlcjY2NzEzMg==",
         "organizations_url" : "https://api.github.com/users/esneider/orgs",
         "received_events_url" : "https://api.github.com/users/esneider/received_events",
         "repos_url" : "https://api.github.com/users/esneider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/esneider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/esneider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/esneider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706731875"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706731875"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Not sure if this is a problem, but notice that `TrimFlags` might cause the resulting `flag_combos` to have duplicate elements.\r\n\r\nEg, if `SCRIPT_VERIFY_P2SH` and `SCRIPT_VERIFY_WITNESS` are set in `flags`, the mapping done by `TrimFlags` will make 25% of the resulting elements duplicates.",
      "commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "created_at" : "2021-09-12T02:40:41Z",
      "diff_hunk" : "@@ -174,9 +174,29 @@ unsigned int FillFlags(unsigned int flags)\n // Assumes that mapFlagNames contains all script verify flags.\n std::set<unsigned int> ExcludeIndividualFlags(unsigned int flags)\n {\n+    std::vector<unsigned int> set_flags;\n+    const size_t n_flags = sizeof(unsigned int);\n+    set_flags.reserve(n_flags);\n+    for (size_t i = 0; i < n_flags; ++i) {\n+        const unsigned int flag = flags & (1 << i);\n+        if (flag) {\n+            set_flags.push_back(flag);\n+        }\n+    }\n+    const size_t combos = 1 << set_flags.size();\n+    // skip last all set flags\n+    std::vector<unsigned int> all_flag_combos(combos-1);\n+    for (size_t i = 0; i < combos-1; ++i){\n+        for(size_t j = 0; j < set_flags.size(); ++j) {\n+            if (i & (1<<j)) {\n+                all_flag_combos[i] |= set_flags[j];\n+            }\n+        }\n+    }\n+\n     std::set<unsigned int> flags_combos;\n-    for (const auto& pair : mapFlagNames) {\n-        const unsigned int flags_excluding_one = TrimFlags(flags & ~(pair.second));\n+    for (const unsigned int excluded_flags : all_flag_combos) {\n+        const unsigned int flags_excluding_one = TrimFlags(excluded_flags);\n         if (flags != flags_excluding_one) {\n             flags_combos.insert(flags_excluding_one);\n         }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706731875",
      "id" : 706731875,
      "line" : 202,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjczMTg3NQ==",
      "original_commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "original_line" : 202,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "src/test/transaction_tests.cpp",
      "position" : 31,
      "pull_request_review_id" : 752061278,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-12T02:41:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706731875",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/667132?v=4",
         "events_url" : "https://api.github.com/users/esneider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/esneider/followers",
         "following_url" : "https://api.github.com/users/esneider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/esneider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/esneider",
         "id" : 667132,
         "login" : "esneider",
         "node_id" : "MDQ6VXNlcjY2NzEzMg==",
         "organizations_url" : "https://api.github.com/users/esneider/orgs",
         "received_events_url" : "https://api.github.com/users/esneider/received_events",
         "repos_url" : "https://api.github.com/users/esneider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/esneider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/esneider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/esneider"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706767923"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706767923"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "ð¤¦ --> will fix",
      "commit_id" : "885bf41580c7a7043cc3445179c76aec3dca38c6",
      "created_at" : "2021-09-12T06:06:59Z",
      "diff_hunk" : "@@ -174,9 +174,29 @@ unsigned int FillFlags(unsigned int flags)\n // Assumes that mapFlagNames contains all script verify flags.\n std::set<unsigned int> ExcludeIndividualFlags(unsigned int flags)\n {\n+    std::vector<unsigned int> set_flags;\n+    const size_t n_flags = sizeof(unsigned int);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706767923",
      "id" : 706767923,
      "in_reply_to_id" : 706728574,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjc2NzkyMw==",
      "original_commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "original_line" : 178,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/test/transaction_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 752095910,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-12T06:06:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706767923",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706768096"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706768096"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "yeah I could do a de-dup pass with TrimFlags. It makes more sense IMO to keep TrimFlags even if superfluos with the above as TrimFlags is a separate validity of flag combo check v.s. the dumb subset generator.",
      "commit_id" : "885bf41580c7a7043cc3445179c76aec3dca38c6",
      "created_at" : "2021-09-12T06:08:35Z",
      "diff_hunk" : "@@ -174,9 +174,29 @@ unsigned int FillFlags(unsigned int flags)\n // Assumes that mapFlagNames contains all script verify flags.\n std::set<unsigned int> ExcludeIndividualFlags(unsigned int flags)\n {\n+    std::vector<unsigned int> set_flags;\n+    const size_t n_flags = sizeof(unsigned int);\n+    set_flags.reserve(n_flags);\n+    for (size_t i = 0; i < n_flags; ++i) {\n+        const unsigned int flag = flags & (1 << i);\n+        if (flag) {\n+            set_flags.push_back(flag);\n+        }\n+    }\n+    const size_t combos = 1 << set_flags.size();\n+    // skip last all set flags\n+    std::vector<unsigned int> all_flag_combos(combos-1);\n+    for (size_t i = 0; i < combos-1; ++i){\n+        for(size_t j = 0; j < set_flags.size(); ++j) {\n+            if (i & (1<<j)) {\n+                all_flag_combos[i] |= set_flags[j];\n+            }\n+        }\n+    }\n+\n     std::set<unsigned int> flags_combos;\n-    for (const auto& pair : mapFlagNames) {\n-        const unsigned int flags_excluding_one = TrimFlags(flags & ~(pair.second));\n+    for (const unsigned int excluded_flags : all_flag_combos) {\n+        const unsigned int flags_excluding_one = TrimFlags(excluded_flags);\n         if (flags != flags_excluding_one) {\n             flags_combos.insert(flags_excluding_one);\n         }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706768096",
      "id" : 706768096,
      "in_reply_to_id" : 706731875,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjc2ODA5Ng==",
      "original_commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "original_line" : 202,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "src/test/transaction_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 752096007,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-12T06:08:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706768096",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706768676"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706768676"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "i can't tell what line you are commenting on",
      "commit_id" : "885bf41580c7a7043cc3445179c76aec3dca38c6",
      "created_at" : "2021-09-12T06:13:53Z",
      "diff_hunk" : "@@ -174,9 +174,29 @@ unsigned int FillFlags(unsigned int flags)\n // Assumes that mapFlagNames contains all script verify flags.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706768676",
      "id" : 706768676,
      "in_reply_to_id" : 706729262,
      "line" : 173,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjc2ODY3Ng==",
      "original_commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "original_line" : 173,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/test/transaction_tests.cpp",
      "position" : 9,
      "pull_request_review_id" : 752096376,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-12T06:13:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706768676",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706770414"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706770414"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Right, sorry about that.\r\n```c\r\n// Exclude each possible script verify flag from flags. Returns a set of these flag combinations\r\n// that are valid and without duplicates. For example: if flags=1111 and the 4 possible flags are\r\n// 0001, 0010, 0100, and 1000, this should return the set {0111, 1011, 1101, 1110}.\r\n```",
      "commit_id" : "885bf41580c7a7043cc3445179c76aec3dca38c6",
      "created_at" : "2021-09-12T06:30:55Z",
      "diff_hunk" : "@@ -174,9 +174,29 @@ unsigned int FillFlags(unsigned int flags)\n // Assumes that mapFlagNames contains all script verify flags.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22948#discussion_r706770414",
      "id" : 706770414,
      "in_reply_to_id" : 706729262,
      "line" : 173,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjc3MDQxNA==",
      "original_commit_id" : "7812cff7c3cd90235c4d8d7a74901d81ac239128",
      "original_line" : 173,
      "original_position" : 1,
      "original_start_line" : null,
      "path" : "src/test/transaction_tests.cpp",
      "position" : 9,
      "pull_request_review_id" : 752097399,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22948",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-09-12T06:30:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706770414",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/667132?v=4",
         "events_url" : "https://api.github.com/users/esneider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/esneider/followers",
         "following_url" : "https://api.github.com/users/esneider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/esneider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/esneider",
         "id" : 667132,
         "login" : "esneider",
         "node_id" : "MDQ6VXNlcjY2NzEzMg==",
         "organizations_url" : "https://api.github.com/users/esneider/orgs",
         "received_events_url" : "https://api.github.com/users/esneider/received_events",
         "repos_url" : "https://api.github.com/users/esneider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/esneider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/esneider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/esneider"
      }
   }
]
