[
   {
      "author_association" : "MEMBER",
      "body" : "`fFoundStartingHeader` is not necessarily false because it could be made true inside the `for (const uint256& hash : peer->m_blocks_for_headers_relay) {` loop, right?\r\n\r\nAlso, if you were thinking it's always false, it would just make sense to drop `fFoundStartingHeader` variable altogether? After your change it's never being accessed anyway.",
      "created_at" : "2021-09-08T07:26:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22913#issuecomment-914989626",
      "id" : 914989626,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22913",
      "node_id" : "IC_kwDOABII5842iaI6",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-08T07:26:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/914989626",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "OK. Normally `fForceSendHeaders` is always true when adding a new block. It's hard to imagine an exception, but I reverted `fFoundStartingHeader` because something special might happen.",
      "created_at" : "2021-09-08T10:30:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22913#issuecomment-915118003",
      "id" : 915118003,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22913",
      "node_id" : "IC_kwDOABII5842i5ez",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-08T10:37:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/915118003",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7656623?v=4",
         "events_url" : "https://api.github.com/users/fujicoin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fujicoin/followers",
         "following_url" : "https://api.github.com/users/fujicoin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fujicoin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fujicoin",
         "id" : 7656623,
         "login" : "fujicoin",
         "node_id" : "MDQ6VXNlcjc2NTY2MjM=",
         "organizations_url" : "https://api.github.com/users/fujicoin/orgs",
         "received_events_url" : "https://api.github.com/users/fujicoin/received_events",
         "repos_url" : "https://api.github.com/users/fujicoin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fujicoin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fujicoin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fujicoin"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@naumenkogs \r\nThe current code is designed not to send headers to peers from that we received new blocks or headers.\r\nIs this specification intentional? If so, why?\r\nI think this is probably the idea that the peer is already aware of the new block and doesn't need to be notified again.\r\nHowever, as long as the node has peer status information, I think it should always be correct. \r\nThe current code is inappropriate in that sense.\r\nWhat do you think?\r\n",
      "created_at" : "2021-09-09T23:33:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22913#issuecomment-916510410",
      "id" : 916510410,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22913",
      "node_id" : "IC_kwDOABII5842oNbK",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-09T23:33:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/916510410",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7656623?v=4",
         "events_url" : "https://api.github.com/users/fujicoin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fujicoin/followers",
         "following_url" : "https://api.github.com/users/fujicoin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fujicoin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fujicoin",
         "id" : 7656623,
         "login" : "fujicoin",
         "node_id" : "MDQ6VXNlcjc2NTY2MjM=",
         "organizations_url" : "https://api.github.com/users/fujicoin/orgs",
         "received_events_url" : "https://api.github.com/users/fujicoin/received_events",
         "repos_url" : "https://api.github.com/users/fujicoin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fujicoin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fujicoin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fujicoin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Sorry, I'm trying to help but I'm completely lost in your code and your intentions.\r\nI'm looking at the current master code, and it does make sense to me, so I'm not sure what you're trying to change in it.\r\nYour issue, despite being very elaborate, is also confusing.",
      "created_at" : "2021-09-10T08:36:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22913#issuecomment-916733682",
      "id" : 916733682,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22913",
      "node_id" : "IC_kwDOABII5842pD7y",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-10T08:36:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/916733682",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@naumenkogs \r\nDid you see issue #22898 ?\r\nDo you think the test results are as expected and it is fine?\r\nDo you say it's correct not to notify our status to peers who already have a new block?\r\nI'm not saying that the current code is absolutely wrong. But if it's correct to notify our status to all connected peers, then the current code is wrong.\r\n\r\n\r\nI built and tested v22.0 with this PR and the peer status has been improved to always show the correct status.",
      "created_at" : "2021-09-10T10:00:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22913#issuecomment-916784799",
      "id" : 916784799,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22913",
      "node_id" : "IC_kwDOABII5842pQaf",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-10T12:15:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/916784799",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7656623?v=4",
         "events_url" : "https://api.github.com/users/fujicoin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fujicoin/followers",
         "following_url" : "https://api.github.com/users/fujicoin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fujicoin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fujicoin",
         "id" : 7656623,
         "login" : "fujicoin",
         "node_id" : "MDQ6VXNlcjc2NTY2MjM=",
         "organizations_url" : "https://api.github.com/users/fujicoin/orgs",
         "received_events_url" : "https://api.github.com/users/fujicoin/received_events",
         "repos_url" : "https://api.github.com/users/fujicoin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fujicoin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fujicoin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fujicoin"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Please answer my question simply. However, it's hard to get your answer, so today I'll try another method to explain the problem.\r\n\r\nThis is the line I think is the problem with the current code:\r\n`} else if (PeerHasHeader (& state, pindex)) {`\r\nhttps://github.com/bitcoin/bitcoin/blob/5c0f46ca46e23a161649b5150baa01020dc85e48/src/net_processing.cpp#L4608\r\n\r\nThis if statement is `true` for peers that the node has already received a new block or header. So the node does not send headers to that peer. Therefore, the peer does not update the status of this node.\r\nDo you think this behavior of the node is correct?",
      "created_at" : "2021-09-11T06:27:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22913#issuecomment-917351669",
      "id" : 917351669,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22913",
      "node_id" : "IC_kwDOABII5842raz1",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-11T06:27:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/917351669",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7656623?v=4",
         "events_url" : "https://api.github.com/users/fujicoin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fujicoin/followers",
         "following_url" : "https://api.github.com/users/fujicoin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fujicoin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fujicoin",
         "id" : 7656623,
         "login" : "fujicoin",
         "node_id" : "MDQ6VXNlcjc2NTY2MjM=",
         "organizations_url" : "https://api.github.com/users/fujicoin/orgs",
         "received_events_url" : "https://api.github.com/users/fujicoin/received_events",
         "repos_url" : "https://api.github.com/users/fujicoin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fujicoin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fujicoin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fujicoin"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@achow101\r\nIs it possible for you to check this PR?\r\nThe discussion doesn't proceed at all, probably because I'm not good at explaining.\r\n",
      "created_at" : "2021-09-11T18:44:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22913#issuecomment-917454981",
      "id" : 917454981,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22913",
      "node_id" : "IC_kwDOABII5842r0CF",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-11T18:44:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/917454981",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7656623?v=4",
         "events_url" : "https://api.github.com/users/fujicoin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fujicoin/followers",
         "following_url" : "https://api.github.com/users/fujicoin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fujicoin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fujicoin",
         "id" : 7656623,
         "login" : "fujicoin",
         "node_id" : "MDQ6VXNlcjc2NTY2MjM=",
         "organizations_url" : "https://api.github.com/users/fujicoin/orgs",
         "received_events_url" : "https://api.github.com/users/fujicoin/received_events",
         "repos_url" : "https://api.github.com/users/fujicoin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fujicoin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fujicoin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fujicoin"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@naumenkogs \r\nAre you fundamentally misunderstanding?\r\nI don't think you can't understand this simple problem.\r\nPlease consider it a little more seriously. ",
      "created_at" : "2021-09-14T13:06:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22913#issuecomment-919132337",
      "id" : 919132337,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22913",
      "node_id" : "IC_kwDOABII5842yNix",
      "performed_via_github_app" : null,
      "updated_at" : "2021-09-14T13:06:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919132337",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7656623?v=4",
         "events_url" : "https://api.github.com/users/fujicoin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fujicoin/followers",
         "following_url" : "https://api.github.com/users/fujicoin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fujicoin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fujicoin",
         "id" : 7656623,
         "login" : "fujicoin",
         "node_id" : "MDQ6VXNlcjc2NTY2MjM=",
         "organizations_url" : "https://api.github.com/users/fujicoin/orgs",
         "received_events_url" : "https://api.github.com/users/fujicoin/received_events",
         "repos_url" : "https://api.github.com/users/fujicoin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fujicoin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fujicoin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fujicoin"
      }
   }
]
