[
   {
      "body" : "This is a recent rough draft, but it needs improvement.\r\n\r\nThink about the object structure a bit.  You want a \"CAddress factory\", that will create one or more CAddress's from a DNS lookup.  Supporting a multiple-address lookup from *inside* a singleton address object is awkward, because DNS lookups have a one-to-many relationship between DNS names and addresses.\r\n\r\nThe \"create higher nIndex, until address returned is invalid\" is unusual for this reason, and the code should be refactored.\r\n\r\nYou want a helper (CAddressFactory?) that returns one or more CAddress objects, from a DNS lookup.  Because a DNS lookup may produce multiple addresses, this cannot be inside the CAddress implementation itself.\r\n\r\n",
      "created_at" : "2011-05-03T14:01:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/192#issuecomment-1093984",
      "id" : 1093984,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/192",
      "updated_at" : "2011-05-03T14:01:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1093984",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "I agree, actually. I moved the lookup code to a NameLookup function that creates a CAddress or a vector of those, and is used in the (single-address only) lookup version of the CAddress constructor, for convenience.",
      "created_at" : "2011-05-04T11:21:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/192#issuecomment-1099269",
      "id" : 1099269,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/192",
      "updated_at" : "2011-05-05T13:21:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1099269",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "ACK, thanks for revising",
      "created_at" : "2011-05-05T14:55:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/192#issuecomment-1106091",
      "id" : 1106091,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/192",
      "updated_at" : "2011-05-05T14:55:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1106091",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Forum thread http://www.bitcoin.org/smf/index.php?topic=7123.0\r\n",
      "created_at" : "2011-05-06T11:37:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/192#issuecomment-1110829",
      "id" : 1110829,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/192",
      "updated_at" : "2011-05-06T11:37:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1110829",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "My finger was hovering over the \"Merge pull request\" button, but I found a last minute issue.\r\n\r\nEventually, we do want to support IPv6.  Satoshi reserved space for it in the P2P protocol address storage area, and it will be needed in years to come, to connect some clients.\r\n\r\nAs such, please separate hostname and port into two distinct function parameters / variables, and do not combine them into a single string \"host:port\", only to be parsed and separated in NameLookup()\r\n\r\nRationale:\r\n1) It is recommended due to IPv6 that this convention be avoided.  IPv6 addresses contain a colon, implying that proper parsing requires users to specify a bracketed string, if you are specifying a port:  [0:1:2:3:4:5:6:7]:8333.  For this reason, all new APIs -- most notably, libc function getaddrinfo(3) -- always keep hostname and port separate.\r\n\r\n2) gethostbyname(3) is deprecated, and we need to switch to getaddrinfo(3).  The commit is fine as-is, and relies on a well-tested API, so I did not request revision.  But long term, again due to IPv6, it is recommended that all applications use getaddrinfo(3).  This function is supported in winsock, freebsd (macos) and linux, all our supported platforms.\r\n\r\nSo, separate hostname and port, and you're golden with this commit.\r\n\r\nThanks.\r\n",
      "created_at" : "2011-05-06T11:50:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/192#issuecomment-1110871",
      "id" : 1110871,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/192",
      "updated_at" : "2011-05-06T11:50:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1110871",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "I actually started writing this patch by using getaddrinfo, since its interface is much cleaner and supports seamless upgrading to IPv6. Not knowing what the compatibility of that is with other operating systems, i sticked to gethostbyname.\r\n\r\nConsidering IPv6 hostnames, I would suggest first trying to parse the string passed as [host]:port, and if this parsing fails, resort to host:port. Otherwise we will still need some function somewhere to do that parsing anyway, if people want to pass an address including a port number on the command line or config file somewhere.\r\n",
      "created_at" : "2011-05-06T11:56:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/192#issuecomment-1110891",
      "id" : 1110891,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/192",
      "updated_at" : "2011-05-06T11:56:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1110891",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Added string+port number constructors.",
      "created_at" : "2011-05-10T21:52:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/192#issuecomment-1133776",
      "id" : 1133776,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/192",
      "updated_at" : "2011-05-10T21:52:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1133776",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "ACK",
      "created_at" : "2011-05-10T21:59:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/192#issuecomment-1133800",
      "id" : 1133800,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/192",
      "updated_at" : "2011-05-10T21:59:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1133800",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   }
]
