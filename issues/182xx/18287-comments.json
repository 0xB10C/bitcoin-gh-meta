[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--a722867cd34abeea1fadc8d60700f111-->\n### Gitian builds\n\n| File | commit 3d28c886f077ce22fb7755fe9ec1f4e08d3d4a62<br>(master) | commit b9de48a06e7a3caea0616fb70c859143f5fa2eb1<br>(master and this pull) |\n|--|--|--|\n\n",
      "created_at" : "2020-03-07T05:41:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18287#issuecomment-596050070",
      "id" : 596050070,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18287",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5NjA1MDA3MA==",
      "updated_at" : "2020-03-07T05:41:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/596050070",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Good catch. It's really sneaky that including a header can make this difference.\r\n\r\nI think it'd be good to have a test for this case to detect regression.",
      "created_at" : "2020-03-11T14:23:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18287#issuecomment-597664070",
      "id" : 597664070,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18287",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5NzY2NDA3MA==",
      "updated_at" : "2020-03-11T14:23:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/597664070",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Who maintains the Windows CI stuff? That's the only place I can see a test making sense...",
      "created_at" : "2020-03-11T16:05:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18287#issuecomment-597721066",
      "id" : 597721066,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18287",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5NzcyMTA2Ng==",
      "updated_at" : "2020-03-11T16:05:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/597721066",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "How would a test case look like? Can't it be added as a normal unit or functional test?",
      "created_at" : "2020-03-11T16:47:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18287#issuecomment-597743996",
      "id" : 597743996,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18287",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5Nzc0Mzk5Ng==",
      "updated_at" : "2020-03-11T16:47:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/597743996",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I *think* just specifying `-rpcbind=::1` would fail at startup. Does AppVeyor run the functional tests?",
      "created_at" : "2020-03-11T17:51:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18287#issuecomment-597777459",
      "id" : 597777459,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18287",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5Nzc3NzQ1OQ==",
      "updated_at" : "2020-03-11T17:51:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/597777459",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Appveyor uses msvc to compile, not sure if that changes anything. @sipsorcery \r\n\r\nThough, we have a windows cross build that runs the unit tests: https://github.com/bitcoin/bitcoin/blob/58c72880ff70807cf622cdebf1d6273f4041bd2e/ci/test/00_setup_env_win64.sh#L12",
      "created_at" : "2020-03-11T18:36:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18287#issuecomment-597799439",
      "id" : 597799439,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18287",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5Nzc5OTQzOQ==",
      "updated_at" : "2020-03-11T18:36:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/597799439",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've just tested starting bitcoind built with msvc using:\r\n\r\n`..\\src\\bitcoind -rpcbind=::1 -rpcallowip=0.0.0.0/0 -debug`\r\n\r\nIt failed with the relevant log messages being:\r\n\r\n````\r\nlibevent: event_add: event: 000001F4D284AA20 (fd 1764), EV_READ    call 00007FF6DB2244A0\r\n2020-03-11T18:48:42Z libevent: win32_add: adding event for 1764\r\n2020-03-11T18:48:42Z Binding RPC on address ::1 port 8332\r\n2020-03-11T18:48:42Z libevent: Detected an IPv4 interface\r\n2020-03-11T18:48:42Z libevent: getaddrinfo: nodename nor servname provided, or not known\r\n2020-03-11T18:48:42Z Binding RPC on address ::1 port 8332 failed.\r\n2020-03-11T18:48:42Z Unable to bind any endpoint for RPC server\r\n2020-03-11T18:48:42Z libevent: event_del: 000001F4D284AA20 (fd 1764), callback 00007FF6DB2244A0\r\n2020-03-11T18:48:42Z libevent: win32_del: Removing event for 1764\r\n2020-03-11T18:48:42Z libevent: event_base_free_: 0 events freed\r\n````\r\n\r\nThis does appear to support Luke's diagnosis.\r\n\r\nThe patch won't solve the problem for msvc builds because the `libevent` dependency isn't installed with the Bitcoin Core depends scripts (it uses vcpkg in the .appveyor file). \r\n\r\nIf it's possible it would seem sensible to add a unit test that attempts to start `bitcoind` with the rpc listener on ::1. I can't recall if the appveyor vm's have IPv6 enabled or not, I'll check.",
      "created_at" : "2020-03-11T18:56:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18287#issuecomment-597809987",
      "id" : 597809987,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18287",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5NzgwOTk4Nw==",
      "updated_at" : "2020-03-11T18:56:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/597809987",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/197660?v=4",
         "events_url" : "https://api.github.com/users/sipsorcery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipsorcery/followers",
         "following_url" : "https://api.github.com/users/sipsorcery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipsorcery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipsorcery",
         "id" : 197660,
         "login" : "sipsorcery",
         "node_id" : "MDQ6VXNlcjE5NzY2MA==",
         "organizations_url" : "https://api.github.com/users/sipsorcery/orgs",
         "received_events_url" : "https://api.github.com/users/sipsorcery/received_events",
         "repos_url" : "https://api.github.com/users/sipsorcery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipsorcery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipsorcery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipsorcery"
      }
   }
]
