[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #17526 (Use Single Random Draw In addition to knapsack as coin selection fallback by achow101)\n* #17331 (Use effective values throughout coin selection by achow101)\n* #16378 (The ultimate send RPC by Sjors)\n* #11413 ([wallet] [rpc] sendtoaddress/sendmany: Add explicit feerate option by kallewoof)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-03-06T06:43:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-595625000",
      "id" : 595625000,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18275",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5NTYyNTAwMA==",
      "updated_at" : "2020-03-06T06:43:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/595625000",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389086562"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18275"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/389086562"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The mempool fee is not considered when the user picks the fee rate. See also https://doxygen.bitcoincore.org/wallet_2fees_8cpp_source.html#l00028\r\n\r\nHow did you trigger this bug? It would be nice to include a test vector or steps to reproduce, otherwise this will just be dead code.",
      "commit_id" : "7ac14a5a86d6bc8f15cf2c336a1bf560babf0c84",
      "created_at" : "2020-03-06T19:04:44Z",
      "diff_hunk" : "@@ -2659,6 +2659,12 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n \n             // Get the fee rate to use effective values in coin selection\n             CFeeRate nFeeRateNeeded = GetMinimumFeeRate(*this, coin_control, &feeCalc);\n+            // Do not, ever, assume that it's fine to change the fee rate if the user has explicitly\n+            // provided one\n+            if (coin_control.m_feerate && nFeeRateNeeded > *coin_control.m_feerate) {\n+                strFailReason = strprintf(\"Fee rate is too low for the current mempool. Increase it to %s or modify -maxmempool\", nFeeRateNeeded.ToString());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389086562",
      "id" : 389086562,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA4NjU2Mg==",
      "original_commit_id" : "7ac14a5a86d6bc8f15cf2c336a1bf560babf0c84",
      "original_position" : 7,
      "path" : "src/wallet/wallet.cpp",
      "position" : 7,
      "pull_request_review_id" : 370557191,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18275",
      "updated_at" : "2020-03-06T19:04:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/389086562",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389091168"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18275"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/389091168"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke the error is triggered by setting a fee rate below 1 sat / byte in the updated `sendtoaddress` RPCs in #11413. See https://github.com/bitcoin/bitcoin/pull/11413#issuecomment-593284781 for discussion and some alternative ideas. ",
      "commit_id" : "7ac14a5a86d6bc8f15cf2c336a1bf560babf0c84",
      "created_at" : "2020-03-06T19:14:37Z",
      "diff_hunk" : "@@ -2659,6 +2659,12 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n \n             // Get the fee rate to use effective values in coin selection\n             CFeeRate nFeeRateNeeded = GetMinimumFeeRate(*this, coin_control, &feeCalc);\n+            // Do not, ever, assume that it's fine to change the fee rate if the user has explicitly\n+            // provided one\n+            if (coin_control.m_feerate && nFeeRateNeeded > *coin_control.m_feerate) {\n+                strFailReason = strprintf(\"Fee rate is too low for the current mempool. Increase it to %s or modify -maxmempool\", nFeeRateNeeded.ToString());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389091168",
      "id" : 389091168,
      "in_reply_to_id" : 389086562,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA5MTE2OA==",
      "original_commit_id" : "7ac14a5a86d6bc8f15cf2c336a1bf560babf0c84",
      "original_position" : 7,
      "path" : "src/wallet/wallet.cpp",
      "position" : 7,
      "pull_request_review_id" : 370563299,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18275",
      "updated_at" : "2020-03-06T19:15:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/389091168",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389093005"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18275"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/389093005"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If it is not possible to hit this case with Bitcoin Core master, it probably makes sense to only add it when it can be hit. And also add a test to hit it.",
      "commit_id" : "7ac14a5a86d6bc8f15cf2c336a1bf560babf0c84",
      "created_at" : "2020-03-06T19:18:24Z",
      "diff_hunk" : "@@ -2659,6 +2659,12 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n \n             // Get the fee rate to use effective values in coin selection\n             CFeeRate nFeeRateNeeded = GetMinimumFeeRate(*this, coin_control, &feeCalc);\n+            // Do not, ever, assume that it's fine to change the fee rate if the user has explicitly\n+            // provided one\n+            if (coin_control.m_feerate && nFeeRateNeeded > *coin_control.m_feerate) {\n+                strFailReason = strprintf(\"Fee rate is too low for the current mempool. Increase it to %s or modify -maxmempool\", nFeeRateNeeded.ToString());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389093005",
      "id" : 389093005,
      "in_reply_to_id" : 389086562,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTA5MzAwNQ==",
      "original_commit_id" : "7ac14a5a86d6bc8f15cf2c336a1bf560babf0c84",
      "original_position" : 7,
      "path" : "src/wallet/wallet.cpp",
      "position" : 7,
      "pull_request_review_id" : 370565595,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18275",
      "updated_at" : "2020-03-06T19:18:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/389093005",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
