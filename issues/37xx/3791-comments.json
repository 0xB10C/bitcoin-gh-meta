[
   {
      "body" : "There is no way that Bitcoin-Qt can know whether the address was used before somewhere in the world. It has only the local view provided by the keypool in the wallet.dat that you installed.\r\n\r\nSo if you restore an old backup it will think it's handing out new addresses.\r\n\r\nYou can 'skip ahead' by running the RPC call `getrawchangeaddress` as many times as needed (up to the keypoolsize to mark the entire keypool as used).\r\n",
      "created_at" : "2014-03-04T07:17:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3791#issuecomment-36597840",
      "id" : 36597840,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3791",
      "updated_at" : "2014-03-04T07:17:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/36597840",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I'm reopening this. We can know when keys are used (see a transaction spending using them), and don't use this to mark keypool keys used.\r\n\r\nIn fact, this will be necessary for recovery from BIP32 wallet backups.",
      "created_at" : "2014-03-04T13:03:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3791#issuecomment-36621543",
      "id" : 36621543,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3791",
      "updated_at" : "2014-03-04T13:03:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/36621543",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "You can know whether the key has been used, but you cannot know for sure whether the key has not been used.\r\n\r\nIt could be given to someone as an invoice and not be in a visible transaction yet. Or it could be in a queued-up transaction. The \"addresses is in the blockchain\" assumption is very shallow.\r\n",
      "created_at" : "2014-03-04T13:28:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3791#issuecomment-36623319",
      "id" : 36623319,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3791",
      "updated_at" : "2014-03-04T13:28:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/36623319",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "It's still very reasonable to mark addresses as used if you see them used, imho :)",
      "created_at" : "2014-03-04T13:32:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3791#issuecomment-36623681",
      "id" : 36623681,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3791",
      "updated_at" : "2014-03-04T13:32:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/36623681",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "It it reasonable, but may be dangerous if people make the wrong assumptions (it looks as if it works in every case, but it doesn't). \r\n\r\nEdit: If you use multiple copies of a wallet you're bound to have race conditions in which both give you the same key as 'new'. There is always a window for this confusion. The only solution would be to make them generate keys with different BIP32 parent keys.\r\n",
      "created_at" : "2014-03-04T13:35:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3791#issuecomment-36623891",
      "id" : 36623891,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3791",
      "updated_at" : "2014-03-04T13:45:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/36623891",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "In a GUI client we could notice this case and wag a popup at the user. \"Woah, this wallet appears to be out of sync with the network, coins seem to be spent out from under it. [...] If you're using multiple copies of the same wallet, beware your impending doom. See [here] for more info.\"\r\n\r\nWRT multiple copies beyond the reuse, the problem is that they'll double-spend each other... and if spending unconfirmed change end up totally borken.\r\n\r\nBut I think better handling a backup recovery doesn't prevent better catching of risky use. It's not like it replaying the keypool is the only or the most obvious mechanism we can use to point out that this doesn't really work.\r\n",
      "created_at" : "2014-03-04T14:31:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3791#issuecomment-36628821",
      "id" : 36628821,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3791",
      "updated_at" : "2014-03-04T14:31:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/36628821",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Agreed that the client could warn in that case, but that's very different from claiming that 'reuse an existing receiving address' does not work which is the issue title.",
      "created_at" : "2014-03-04T14:36:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/3791#issuecomment-36629386",
      "id" : 36629386,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3791",
      "updated_at" : "2014-03-04T14:37:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/36629386",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
