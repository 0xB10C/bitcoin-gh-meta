[
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/c077555c77dd1a58bedd6466a086c4f116fd0e57 for binaries and test log.",
      "created_at" : "2012-09-10T12:18:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-8421578",
      "id" : 8421578,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2012-09-10T12:18:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8421578",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "Nested-three-deep reject(DoS(error(...))) with two different error strings seems kinda crazy. If I wasn't familiar with the history of how that came to be I'd be befuddled.\n\nCould it be simplified to just:\nreturn reject(errorMessage, int nDoS=0) ?\n\n... where reject prints errorMessage to debug.log and saves it in the block, and then does the DoS thing if nDoS > 0. Then returns false.\n",
      "created_at" : "2012-09-10T14:08:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-8424448",
      "id" : 8424448,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2012-09-10T14:08:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8424448",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "I'll flatten this later and collapse the 3 levels of function wrappers, just needed to get something working for Eligius...",
      "created_at" : "2012-09-11T01:40:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-8444452",
      "id" : 8444452,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2012-09-11T01:40:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8444452",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/8f976aaa862c933c41c153007d0ffe3093ff475b for binaries and test log.",
      "created_at" : "2012-09-12T00:10:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-8477180",
      "id" : 8477180,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2012-09-12T00:10:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8477180",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r1660813"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1660813"
         }
      },
      "body" : "I really don't like CBlocks storing their own reject string, seems like a layer violation. Maybe not directly related to this change, as nDoS does the same.\n\nI'd rather see a CValidationResult which stores such information, which is returned or pass-by-ref inside the block- and transaction validation functions. That's maybe out of scope for this change, though.\n\n",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2012-09-21T12:55:09Z",
      "diff_hunk" : "@@ -837,6 +837,8 @@ class CBlock\n     // Denial-of-service detection:\n     mutable int nDoS;\n     bool DoS(int nDoSIn, bool fIn) const { nDoS += nDoSIn; return fIn; }\n+    mutable std::string strRejectReason;\n+    bool reject(const std::string& strRejectReasonIn, bool fIn) const { strRejectReason = strRejectReasonIn; return fIn; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r1660813",
      "id" : 1660813,
      "original_commit_id" : "8f976aaa862c933c41c153007d0ffe3093ff475b",
      "original_position" : 23,
      "path" : "src/main.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1660813",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Rebased and implemented @sipa 's CValidationResult solution.",
      "created_at" : "2012-11-15T00:24:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-10392472",
      "id" : 10392472,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2012-11-15T00:24:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10392472",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Automatic sanity-testing: FAILED MERGE, see http://jenkins.bluematt.me/pull-tester/212089d306d351e63111e91a969e9da1b1920cbc for test log.\n\nThis pull does not merge cleanly onto current master",
      "created_at" : "2012-11-24T22:57:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-10684867",
      "id" : 10684867,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2012-11-24T22:57:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10684867",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/46888e6abca27dd6d2132aab7cd63f25363057c6 for binaries and test log.",
      "created_at" : "2012-11-27T18:43:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-10770788",
      "id" : 10770788,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2012-11-27T18:43:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/10770788",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2846549"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2846549"
         }
      },
      "body" : "This seems to have a race condition - or maybe just a bug when proposing based on a not-the-most-recent prevblock.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2013-01-31T16:57:44Z",
      "diff_hunk" : "@@ -2241,13 +2251,25 @@ bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBl\n             // Ask this guy to fill in what we're missing\n             pfrom->PushGetBlocks(pindexBest, GetOrphanRoot(pblock2));\n         }\n-        return true;\n+        // The block is accepted, but not immediately processed\n+        return state.Orphan();\n     }\n \n     // Store to disk\n-    if (!pblock->AcceptBlock(state, dbp))\n+    if (!pblock->AcceptBlock(state, dbp, fHasPOW))\n         return error(\"ProcessBlock() : AcceptBlock FAILED\");\n \n+    if (!fHasPOW)\n+    {\n+        // The block isn't committed to disk since it was just a proposal, but we need to do connect checks still\n+        CBlockIndex* pindexPrev = mapBlockIndex[pblock->hashPrevBlock];\n+        CBlockIndex indexDummy(*pblock);\n+        indexDummy.pprev = pindexPrev;\n+        indexDummy.nHeight = pindexPrev->nHeight + 1;\n+        CCoinsViewCache viewNew(*pcoinsTip, true);\n+        return pblock->ConnectBlock(state, &indexDummy, viewNew, true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2846549",
      "id" : 2846549,
      "original_commit_id" : "999365d9bad34957c5da34ed63c1690e4ee09caf",
      "original_position" : 296,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2846549",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2864980"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2864980"
         }
      },
      "body" : "I thought about adding these, too :), nice you catched that.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2013-02-01T20:45:02Z",
      "diff_hunk" : "@@ -1810,7 +1810,7 @@ bool SetBestChain(CValidationState &state, CBlockIndex* pindexNew)\n         // an overestimation, as most will delete an existing entry or\n         // overwrite one. Still, use a conservative safety factor of 2.\n         if (!CheckDiskSpace(100 * 2 * 2 * pcoinsTip->GetCacheSize()))\n-            return state.Error();\n+            return state.Error(\"out of disk space\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2864980",
      "id" : 2864980,
      "original_commit_id" : "61814c3953a6fc11e21e9d60de066dd5d3d46b13",
      "original_position" : 68,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2864980",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2865117"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2865117"
         }
      },
      "body" : "Why do you assign fCheckPOW here? I know that works, but I would set it to false and use fCheckPOW in the following if-clause.\r\nSo we have fCheckPOW for calling CheckProofOfWork(), which writes it's result to fHasPOW.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2013-02-01T20:56:46Z",
      "diff_hunk" : "@@ -2194,19 +2197,26 @@ bool CBlockIndex::IsSuperMajority(int minVersion, const CBlockIndex* pstart, uns\n     return (nFound >= nRequired);\n }\n \n-bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBlockPos *dbp)\n+bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBlockPos *dbp, bool fCheckPOW)\n {\n     // Check for duplicate\n     uint256 hash = pblock->GetHash();\n     if (mapBlockIndex.count(hash))\n-        return state.Invalid(error(\"ProcessBlock() : already have block %d %s\", mapBlockIndex[hash]->nHeight, BlockHashStr(hash).c_str()));\n+        return state.Invalid(\"duplicate\", error(\"ProcessBlock() : already have block %d %s\", mapBlockIndex[hash]->nHeight, BlockHashStr(hash).c_str()));\n     if (mapOrphanBlocks.count(hash))\n-        return state.Invalid(error(\"ProcessBlock() : already have block (orphan) %s\", BlockHashStr(hash).c_str()));\n+        return state.Invalid(\"duplicate\", error(\"ProcessBlock() : already have block (orphan) %s\", BlockHashStr(hash).c_str()));\n \n     // Preliminary checks\n-    if (!pblock->CheckBlock(state))\n+    if (!pblock->CheckBlock(state, fCheckPOW))\n         return error(\"ProcessBlock() : CheckBlock FAILED\");\n \n+    bool fHasPOW = fCheckPOW;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2865117",
      "id" : 2865117,
      "original_commit_id" : "61814c3953a6fc11e21e9d60de066dd5d3d46b13",
      "original_position" : 246,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2865117",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2865589"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2865589"
         }
      },
      "body" : "CheckBlock calls CheckProofOfWork if fCheckPOW is true.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2013-02-01T21:29:58Z",
      "diff_hunk" : "@@ -2194,19 +2197,26 @@ bool CBlockIndex::IsSuperMajority(int minVersion, const CBlockIndex* pstart, uns\n     return (nFound >= nRequired);\n }\n \n-bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBlockPos *dbp)\n+bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBlockPos *dbp, bool fCheckPOW)\n {\n     // Check for duplicate\n     uint256 hash = pblock->GetHash();\n     if (mapBlockIndex.count(hash))\n-        return state.Invalid(error(\"ProcessBlock() : already have block %d %s\", mapBlockIndex[hash]->nHeight, BlockHashStr(hash).c_str()));\n+        return state.Invalid(\"duplicate\", error(\"ProcessBlock() : already have block %d %s\", mapBlockIndex[hash]->nHeight, BlockHashStr(hash).c_str()));\n     if (mapOrphanBlocks.count(hash))\n-        return state.Invalid(error(\"ProcessBlock() : already have block (orphan) %s\", BlockHashStr(hash).c_str()));\n+        return state.Invalid(\"duplicate\", error(\"ProcessBlock() : already have block (orphan) %s\", BlockHashStr(hash).c_str()));\n \n     // Preliminary checks\n-    if (!pblock->CheckBlock(state))\n+    if (!pblock->CheckBlock(state, fCheckPOW))\n         return error(\"ProcessBlock() : CheckBlock FAILED\");\n \n+    bool fHasPOW = fCheckPOW;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2865589",
      "id" : 2865589,
      "original_commit_id" : "61814c3953a6fc11e21e9d60de066dd5d3d46b13",
      "original_position" : 246,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2865589",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2865704"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2865704"
         }
      },
      "body" : "Fixed in current code (stale-prevblk check above)",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2013-02-01T21:38:43Z",
      "diff_hunk" : "@@ -2241,13 +2251,25 @@ bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBl\n             // Ask this guy to fill in what we're missing\n             pfrom->PushGetBlocks(pindexBest, GetOrphanRoot(pblock2));\n         }\n-        return true;\n+        // The block is accepted, but not immediately processed\n+        return state.Orphan();\n     }\n \n     // Store to disk\n-    if (!pblock->AcceptBlock(state, dbp))\n+    if (!pblock->AcceptBlock(state, dbp, fHasPOW))\n         return error(\"ProcessBlock() : AcceptBlock FAILED\");\n \n+    if (!fHasPOW)\n+    {\n+        // The block isn't committed to disk since it was just a proposal, but we need to do connect checks still\n+        CBlockIndex* pindexPrev = mapBlockIndex[pblock->hashPrevBlock];\n+        CBlockIndex indexDummy(*pblock);\n+        indexDummy.pprev = pindexPrev;\n+        indexDummy.nHeight = pindexPrev->nHeight + 1;\n+        CCoinsViewCache viewNew(*pcoinsTip, true);\n+        return pblock->ConnectBlock(state, &indexDummy, viewNew, true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2865704",
      "id" : 2865704,
      "original_commit_id" : "999365d9bad34957c5da34ed63c1690e4ee09caf",
      "original_position" : 296,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2865704",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2866017"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2866017"
         }
      },
      "body" : "I just wanted you to differentiate between fCheckPOW and fHasPOW, which you don't do with the current initialisation, that's all :).",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2013-02-01T22:00:07Z",
      "diff_hunk" : "@@ -2194,19 +2197,26 @@ bool CBlockIndex::IsSuperMajority(int minVersion, const CBlockIndex* pstart, uns\n     return (nFound >= nRequired);\n }\n \n-bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBlockPos *dbp)\n+bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBlockPos *dbp, bool fCheckPOW)\n {\n     // Check for duplicate\n     uint256 hash = pblock->GetHash();\n     if (mapBlockIndex.count(hash))\n-        return state.Invalid(error(\"ProcessBlock() : already have block %d %s\", mapBlockIndex[hash]->nHeight, BlockHashStr(hash).c_str()));\n+        return state.Invalid(\"duplicate\", error(\"ProcessBlock() : already have block %d %s\", mapBlockIndex[hash]->nHeight, BlockHashStr(hash).c_str()));\n     if (mapOrphanBlocks.count(hash))\n-        return state.Invalid(error(\"ProcessBlock() : already have block (orphan) %s\", BlockHashStr(hash).c_str()));\n+        return state.Invalid(\"duplicate\", error(\"ProcessBlock() : already have block (orphan) %s\", BlockHashStr(hash).c_str()));\n \n     // Preliminary checks\n-    if (!pblock->CheckBlock(state))\n+    if (!pblock->CheckBlock(state, fCheckPOW))\n         return error(\"ProcessBlock() : CheckBlock FAILED\");\n \n+    bool fHasPOW = fCheckPOW;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2866017",
      "id" : 2866017,
      "original_commit_id" : "61814c3953a6fc11e21e9d60de066dd5d3d46b13",
      "original_position" : 246,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2866017",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2866499"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2866499"
         }
      },
      "body" : "fCheckPOW is \"should the function check the proof-of-work?\"\r\nfHasPOW is \"does the block in fact satisfy the proof-of-work?\"",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2013-02-01T22:37:52Z",
      "diff_hunk" : "@@ -2194,19 +2197,26 @@ bool CBlockIndex::IsSuperMajority(int minVersion, const CBlockIndex* pstart, uns\n     return (nFound >= nRequired);\n }\n \n-bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBlockPos *dbp)\n+bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBlockPos *dbp, bool fCheckPOW)\n {\n     // Check for duplicate\n     uint256 hash = pblock->GetHash();\n     if (mapBlockIndex.count(hash))\n-        return state.Invalid(error(\"ProcessBlock() : already have block %d %s\", mapBlockIndex[hash]->nHeight, BlockHashStr(hash).c_str()));\n+        return state.Invalid(\"duplicate\", error(\"ProcessBlock() : already have block %d %s\", mapBlockIndex[hash]->nHeight, BlockHashStr(hash).c_str()));\n     if (mapOrphanBlocks.count(hash))\n-        return state.Invalid(error(\"ProcessBlock() : already have block (orphan) %s\", BlockHashStr(hash).c_str()));\n+        return state.Invalid(\"duplicate\", error(\"ProcessBlock() : already have block (orphan) %s\", BlockHashStr(hash).c_str()));\n \n     // Preliminary checks\n-    if (!pblock->CheckBlock(state))\n+    if (!pblock->CheckBlock(state, fCheckPOW))\n         return error(\"ProcessBlock() : CheckBlock FAILED\");\n \n+    bool fHasPOW = fCheckPOW;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2866499",
      "id" : 2866499,
      "original_commit_id" : "61814c3953a6fc11e21e9d60de066dd5d3d46b13",
      "original_position" : 246,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2866499",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2866582"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2866582"
         }
      },
      "body" : "I know, you just dont seem to understand, what I am trying to tell you ;-).",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2013-02-01T22:46:51Z",
      "diff_hunk" : "@@ -2194,19 +2197,26 @@ bool CBlockIndex::IsSuperMajority(int minVersion, const CBlockIndex* pstart, uns\n     return (nFound >= nRequired);\n }\n \n-bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBlockPos *dbp)\n+bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBlockPos *dbp, bool fCheckPOW)\n {\n     // Check for duplicate\n     uint256 hash = pblock->GetHash();\n     if (mapBlockIndex.count(hash))\n-        return state.Invalid(error(\"ProcessBlock() : already have block %d %s\", mapBlockIndex[hash]->nHeight, BlockHashStr(hash).c_str()));\n+        return state.Invalid(\"duplicate\", error(\"ProcessBlock() : already have block %d %s\", mapBlockIndex[hash]->nHeight, BlockHashStr(hash).c_str()));\n     if (mapOrphanBlocks.count(hash))\n-        return state.Invalid(error(\"ProcessBlock() : already have block (orphan) %s\", BlockHashStr(hash).c_str()));\n+        return state.Invalid(\"duplicate\", error(\"ProcessBlock() : already have block (orphan) %s\", BlockHashStr(hash).c_str()));\n \n     // Preliminary checks\n-    if (!pblock->CheckBlock(state))\n+    if (!pblock->CheckBlock(state, fCheckPOW))\n         return error(\"ProcessBlock() : CheckBlock FAILED\");\n \n+    bool fHasPOW = fCheckPOW;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r2866582",
      "id" : 2866582,
      "original_commit_id" : "61814c3953a6fc11e21e9d60de066dd5d3d46b13",
      "original_position" : 246,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2866582",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "No objections to the code.  Driving use case?\r\n",
      "created_at" : "2013-05-30T17:08:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-18694614",
      "id" : 18694614,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-05-30T17:08:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18694614",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Ability to test block templates before putting the effort into mining them.",
      "created_at" : "2013-05-30T17:17:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-18695132",
      "id" : 18695132,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-05-30T17:17:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18695132",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "That's a use case.  What size user constituency is *driving* this?  Do multiple pools want this?\r\n",
      "created_at" : "2013-05-30T17:26:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-18695846",
      "id" : 18695846,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-05-30T17:26:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18695846",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "As far as I know, only Eligius and EclipseMC are actively using this today. Any pool using Eloipool for their poolserver would be able to immediately take advantage of it in the simplest case. It is also necessary for both a multiple-validating-node-implementation economy, and miner-chooses-his-own-transactions GBT-based pool mining.",
      "created_at" : "2013-05-30T18:06:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-18697341",
      "id" : 18697341,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-05-30T18:06:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18697341",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@jgarzik I don't think that's a requirement (though certainly something to take into consideration).\r\n\r\nI like the idea of such functionality, as it allows miners to validate their work against multiple implementations. Especially with alternative full node implementations becoming available, having something like this may be inevitable. Plus it's a good debugging tool for checking whether new (unreleased) versions can accept the best chain.\r\n\r\nOn the other hand, I don't like the evolution that may follow from this, where miners become required to validate against a dozen implementations that may or may not differ in validation rules... that has nothing to do with this PR though.",
      "created_at" : "2013-05-30T18:10:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-18697600",
      "id" : 18697600,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-05-30T18:10:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18697600",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa A good example where the validation is extremely useful is a safety net for bitcoin changes that could potentially create invalid blocks. For instance in discussions with pools and miners something that comes up with implementing replace-by-fee and the child-pays-for-parent code I'm working on is the danger that there will be some kind of bug that leads to an invalid block. (let alone a delibrate exploit) Sure you can test all you want on testnet, but it's impossible to be 100% sure, and any orphan costs ~$3000USD; I've got one pool that wants to implement replace-by-fee that has said they are going to wait until it's been tested on Eligius first.",
      "created_at" : "2013-05-31T21:04:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-18771491",
      "id" : 18771491,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-05-31T21:04:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18771491",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "@petertodd Sure, I agree it's a very good way to debug and test potentially forking changes. I just don't like what it may lead to.",
      "created_at" : "2013-06-01T08:29:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-18785624",
      "id" : 18785624,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-06-01T08:29:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18785624",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa I agree it is good to be wary of where this may lead to. Are you meaning to imply that leaving things as they are may be a better alternative to the proposed solution made by Luke?",
      "created_at" : "2013-06-02T03:43:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-18801469",
      "id" : 18801469,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-06-02T03:43:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18801469",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "I would like to have block proposal functionality for BitMinter as well.",
      "created_at" : "2013-06-04T21:56:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-18942190",
      "id" : 18942190,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-06-04T21:56:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/18942190",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/854778?v=3",
         "events_url" : "https://api.github.com/users/DrHaribo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrHaribo/followers",
         "following_url" : "https://api.github.com/users/DrHaribo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrHaribo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrHaribo",
         "id" : 854778,
         "login" : "DrHaribo",
         "organizations_url" : "https://api.github.com/users/DrHaribo/orgs",
         "received_events_url" : "https://api.github.com/users/DrHaribo/received_events",
         "repos_url" : "https://api.github.com/users/DrHaribo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrHaribo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrHaribo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrHaribo"
      }
   },
   {
      "body" : "I'd very much like this for my new pool (currently in private testing), if another \"driver\" is needed :)",
      "created_at" : "2013-07-10T12:35:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-20738783",
      "id" : 20738783,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-07-10T12:35:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/20738783",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/377816?v=3",
         "events_url" : "https://api.github.com/users/hrabbach/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hrabbach/followers",
         "following_url" : "https://api.github.com/users/hrabbach/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hrabbach/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hrabbach",
         "id" : 377816,
         "login" : "hrabbach",
         "organizations_url" : "https://api.github.com/users/hrabbach/orgs",
         "received_events_url" : "https://api.github.com/users/hrabbach/received_events",
         "repos_url" : "https://api.github.com/users/hrabbach/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hrabbach/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hrabbach/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hrabbach"
      }
   },
   {
      "body" : "Rebase needed.\r\n",
      "created_at" : "2013-10-21T01:08:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-26687926",
      "id" : 26687926,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-10-21T01:08:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26687926",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Rebased.",
      "created_at" : "2013-10-25T00:29:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-27046226",
      "id" : 27046226,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-10-25T00:29:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/27046226",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Should this be closed now that #3185 is in?",
      "created_at" : "2013-11-11T14:40:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-28204541",
      "id" : 28204541,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-11-11T14:40:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/28204541",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "No, #3185 is entirely unrelated.",
      "created_at" : "2013-11-11T19:39:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-28231466",
      "id" : 28231466,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-11-11T19:39:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/28231466",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Rebased on top of #3185.",
      "created_at" : "2013-12-03T15:35:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-29719634",
      "id" : 29719634,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2013-12-03T15:35:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/29719634",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Seems nominally OK, but I'm not convinced the CValidationState stuff is correct for all cases.\r\n",
      "created_at" : "2014-06-06T18:55:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-45372132",
      "id" : 45372132,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-06-06T18:55:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/45372132",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r14175122"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14175122"
         }
      },
      "body" : "Instead of adding a fWriteToDisk boolean argument, wouldn't it be more clear to split up the function in a checking and disk-writing part?\r\n",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-06-25T09:04:34Z",
      "diff_hunk" : "@@ -2307,6 +2307,9 @@ bool AcceptBlock(CBlock& block, CValidationState& state, CDiskBlockPos* dbp)\n         }\n     }\n \n+    if (!fWriteToDisk)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r14175122",
      "id" : 14175122,
      "original_commit_id" : "6707a08edb3706c71c00c4a7b3b843e3cbce9e79",
      "original_position" : 35,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14175122",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r14175156"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14175156"
         }
      },
      "body" : "Same here. I'm not a fan of boolean arguments that change the functionality of a function to something completely different. Would prefer just having two functions and moving the common stuff to a third.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-06-25T09:05:45Z",
      "diff_hunk" : "@@ -2372,7 +2375,7 @@ void PushGetBlocks(CNode* pnode, CBlockIndex* pindexBegin, uint256 hashEnd)\n     pnode->PushMessage(\"getblocks\", chainActive.GetLocator(pindexBegin), hashEnd);\n }\n \n-bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBlockPos *dbp)\n+bool ProcessBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDiskBlockPos *dbp, bool fCheckPOW)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r14175156",
      "id" : 14175156,
      "original_commit_id" : "6707a08edb3706c71c00c4a7b3b843e3cbce9e79",
      "original_position" : 46,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14175156",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Notes to self: We shouldn't store proposed orphan blocks (Edit: Confirmed, this doesn't). Ensure nBits is itself checked (Edit: via AcceptBlock).",
      "created_at" : "2014-06-26T12:50:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-47221140",
      "id" : 47221140,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-06-26T14:43:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47221140",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r14238790"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14238790"
         }
      },
      "body" : "Splitting up these means the new split functions would need to assume the mutex is held already (thus not get it themselves) to ensure the mutex isn't released between checks & writing - forcing the callers to hold the mutex instead. In which case IMO those new methods would best be private, and the current AcceptBlock interface (with fWriteToDisk added) exposed as a wrapper. Is that a change that still makes sense to you?",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-06-26T13:09:00Z",
      "diff_hunk" : "@@ -2307,6 +2307,9 @@ bool AcceptBlock(CBlock& block, CValidationState& state, CDiskBlockPos* dbp)\n         }\n     }\n \n+    if (!fWriteToDisk)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r14238790",
      "id" : 14238790,
      "original_commit_id" : "6707a08edb3706c71c00c4a7b3b843e3cbce9e79",
      "original_position" : 35,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14238790",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Automatic sanity-testing: FAILED MERGE, see http://jenkins.bluematt.me/pull-tester/p1816_f21746c89f7b38440c471ad95bbd0158460ad677/ for test log.\n\nThis pull does not merge cleanly onto current master\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-06-26T18:01:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-47258303",
      "id" : 47258303,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-06-26T18:01:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47258303",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "Needs rebase.",
      "created_at" : "2014-07-14T21:04:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-48959531",
      "id" : 48959531,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-07-14T21:04:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48959531",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Sounds like the consensus on this is to merge, once rebased and [self-]notes addressed.\r\n",
      "created_at" : "2014-08-04T15:48:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-51077896",
      "id" : 51077896,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-08-04T15:48:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/51077896",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r15763154"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15763154"
         }
      },
      "body" : "Sounds fair to me. Except for adding a fWriteToDisk boolean argument, which was my problem with this in the first place. The idea would be to have two functions, one that only checks and one that checks and writes to disk.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-08-04T15:59:47Z",
      "diff_hunk" : "@@ -2307,6 +2307,9 @@ bool AcceptBlock(CBlock& block, CValidationState& state, CDiskBlockPos* dbp)\n         }\n     }\n \n+    if (!fWriteToDisk)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r15763154",
      "id" : 15763154,
      "original_commit_id" : "6707a08edb3706c71c00c4a7b3b843e3cbce9e79",
      "original_position" : 35,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/15763154",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "ACK collection... @gmaxwell @sipa @laanwj @gavinandresen ?\r\n\r\nSeems like the consensus is to merge, and the author rebased as requested.\r\n",
      "created_at" : "2014-10-13T15:18:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-58907295",
      "id" : 58907295,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-10-13T15:18:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/58907295",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "@sipa pointed out that ProcessBlock no longer performs the full validation of the new block, which breaks detecting such failures for this.",
      "created_at" : "2014-10-13T21:41:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-58959157",
      "id" : 58959157,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-10-13T21:41:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/58959157",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "For that issue, see also https://github.com/bitcoin/bitcoin/pull/3727#issuecomment-50601253 and #5083 ",
      "created_at" : "2014-10-13T21:49:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-58960126",
      "id" : 58960126,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-10-13T21:49:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/58960126",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Rebased on top of #5106, #3727, and #5103",
      "created_at" : "2014-10-30T02:58:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-61039399",
      "id" : 61039399,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-10-30T02:58:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/61039399",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20432912"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20432912"
         }
      },
      "body" : "Please check ppindex itself for NULL as well before this assignment, as was the case in the old code",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T12:46:35Z",
      "diff_hunk" : "@@ -2391,15 +2391,48 @@ bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBloc\n         }\n     }\n \n-    if (pindex == NULL)\n-        pindex = AddToBlockIndex(block);\n-\n     if (ppindex)\n         *ppindex = pindex;\n \n     return true;\n }\n \n+bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIndex* const & pindexPrev)\n+{\n+    const int nHeight = pindexPrev->nHeight + 1;\n+\n+    // Check that all transactions are finalized\n+    BOOST_FOREACH(const CTransaction& tx, block.vtx)\n+        if (!IsFinalTx(tx, nHeight, block.GetBlockTime())) {\n+            return state.DoS(10, error(\"AcceptBlock() : contains a non-final transaction\"),\n+                             REJECT_INVALID, \"bad-txns-nonfinal\");\n+        }\n+\n+    // Enforce block.nVersion=2 rule that the coinbase starts with serialized block height\n+    // if 750 of the last 1,000 blocks are version 2 or greater (51/100 if testnet):\n+    if (block.nVersion >= 2 && \n+        CBlockIndex::IsSuperMajority(2, pindexPrev, Params().EnforceBlockUpgradeMajority()))\n+    {\n+        CScript expect = CScript() << nHeight;\n+        if (block.vtx[0].vin[0].scriptSig.size() < expect.size() ||\n+            !std::equal(expect.begin(), expect.end(), block.vtx[0].vin[0].scriptSig.begin())) {\n+            return state.DoS(100, error(\"AcceptBlock() : block height mismatch in coinbase\"), REJECT_INVALID, \"bad-cb-height\");\n+        }\n+    }\n+\n+    return true;\n+}\n+\n+bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBlockIndex** ppindex)\n+{\n+    if (!ContextualCheckBlockHeader(block, state, ppindex))\n+        return false;\n+\n+    if (!*ppindex)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20432912",
      "id" : 20432912,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 62,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20432912",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20433050"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20433050"
         }
      },
      "body" : "Making this Array static looks like premature optimization to me. I'd worry about multiple threads using it at the same time (resulting in race conditions). I'd prefer to just build it when needed.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T12:49:32Z",
      "diff_hunk" : "@@ -462,6 +513,10 @@ Value getblocktemplate(const Array& params, bool fHelp)\n     UpdateTime(pblock, pindexPrev);\n     pblock->nNonce = 0;\n \n+    static Array aCaps;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20433050",
      "id" : 20433050,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 69,
      "path" : "src/rpcmining.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20433050",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20433265"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20433265"
         }
      },
      "body" : "What is the reason to pass a `CBlockIndex* const &` instead of just a `const CBlockIndex *` for `pindexPrev`? (same for `TestBlockValidity` below)",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T12:55:10Z",
      "diff_hunk" : "@@ -457,12 +457,19 @@ bool ReadBlockFromDisk(CBlock& block, const CBlockIndex* pindex);\n bool DisconnectBlock(CBlock& block, CValidationState& state, CBlockIndex* pindex, CCoinsViewCache& coins, bool* pfClean = NULL);\n \n // Apply the effects of this block (with given index) on the UTXO set represented by coins\n-bool ConnectBlock(CBlock& block, CValidationState& state, CBlockIndex* pindex, CCoinsViewCache& coins, bool fJustCheck = false);\n+bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockIndex* pindex, CCoinsViewCache& coins, bool fJustCheck = false);\n \n // Context-independent validity checks\n bool CheckBlockHeader(const CBlockHeader& block, CValidationState& state, bool fCheckPOW = true);\n bool CheckBlock(const CBlock& block, CValidationState& state, bool fCheckPOW = true, bool fCheckMerkleRoot = true);\n \n+// Context-dependent validity checks\n+bool ContextualCheckBlockHeader(const CBlockHeader& block, CValidationState& state, CBlockIndex **ppindex= NULL);\n+bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIndex* const & pindexPrev);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20433265",
      "id" : 20433265,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 13,
      "path" : "src/main.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20433265",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20433561"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20433561"
         }
      },
      "body" : "`pindex->nStatus |= BLOCK_FAILED_VALID;` was removed here - verified that it still happens:\r\n\r\n- This call to `state.DoS` (and the one below) sets `state.mode = MODE_INVALID` and `state.corruptionPossible = false`\r\n- After return in `AcceptBlock`, where this code comes from, the check `state.IsInvalid() && !state.CorruptionPossible()` is made, in which case `pindex->nStatus |= BLOCK_FAILED_VALID`",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T13:01:12Z",
      "diff_hunk" : "@@ -2391,15 +2391,48 @@ bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBloc\n         }\n     }\n \n-    if (pindex == NULL)\n-        pindex = AddToBlockIndex(block);\n-\n     if (ppindex)\n         *ppindex = pindex;\n \n     return true;\n }\n \n+bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIndex* const & pindexPrev)\n+{\n+    const int nHeight = pindexPrev->nHeight + 1;\n+\n+    // Check that all transactions are finalized\n+    BOOST_FOREACH(const CTransaction& tx, block.vtx)\n+        if (!IsFinalTx(tx, nHeight, block.GetBlockTime())) {\n+            return state.DoS(10, error(\"AcceptBlock() : contains a non-final transaction\"),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20433561",
      "id" : 20433561,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 38,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20433561",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20433597"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20433597"
         }
      },
      "body" : "Nit: please use %s w/ `__func__` here for the error, so that it shows the right function name instead of `AcceptBlock()` (same on line 2419)",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T13:02:01Z",
      "diff_hunk" : "@@ -2391,15 +2391,48 @@ bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBloc\n         }\n     }\n \n-    if (pindex == NULL)\n-        pindex = AddToBlockIndex(block);\n-\n     if (ppindex)\n         *ppindex = pindex;\n \n     return true;\n }\n \n+bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIndex* const & pindexPrev)\n+{\n+    const int nHeight = pindexPrev->nHeight + 1;\n+\n+    // Check that all transactions are finalized\n+    BOOST_FOREACH(const CTransaction& tx, block.vtx)\n+        if (!IsFinalTx(tx, nHeight, block.GetBlockTime())) {\n+            return state.DoS(10, error(\"AcceptBlock() : contains a non-final transaction\"),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20433597",
      "id" : 20433597,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 38,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20433597",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20433964"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20433964"
         }
      },
      "body" : "This shouldn't be necessary (but won't hurt): if any CValidationState-updating function sets a non-valid state, it should return false already, so this could be replaced by an assert(state.IsValid());",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T13:11:07Z",
      "diff_hunk" : "@@ -2555,6 +2567,32 @@ bool ProcessNewBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDis\n     return true;\n }\n \n+bool TestBlockValidity(CValidationState &state, const CBlock& block, CBlockIndex * const &pindexPrev, bool fCheckPOW, bool fCheckMerkleRoot)\n+{\n+    AssertLockHeld(cs_main);\n+    assert(pindexPrev == chainActive.Tip());\n+\n+    CCoinsViewCache viewNew(pcoinsTip);\n+    CBlockIndex indexDummy(block);\n+    indexDummy.pprev = pindexPrev;\n+    indexDummy.nHeight = pindexPrev->nHeight + 1;\n+\n+    // NOTE: CheckBlockHeader is called by CheckBlock\n+    // NOTE: ContextualCheckBlockHeader only assigns ppindex, which we don't need/want\n+    if (!ContextualCheckBlockHeader(block, state, NULL))\n+        return false;\n+    if (!CheckBlock(block, state, fCheckPOW, fCheckMerkleRoot))\n+        return false;\n+    if (!ContextualCheckBlock(block, state, pindexPrev))\n+        return false;\n+    if (!ConnectBlock(block, state, &indexDummy, viewNew, true))\n+        return false;\n+    if (!state.IsValid())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20433964",
      "id" : 20433964,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 131,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20433964",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20434035"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20434035"
         }
      },
      "body" : "I expect it's to minimize the differences in the code that's moving from the Accept* functions to the ContextualCheck* functions. But I agree it would be cleaner to just pass in a CBlockIndex*.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T13:12:48Z",
      "diff_hunk" : "@@ -457,12 +457,19 @@ bool ReadBlockFromDisk(CBlock& block, const CBlockIndex* pindex);\n bool DisconnectBlock(CBlock& block, CValidationState& state, CBlockIndex* pindex, CCoinsViewCache& coins, bool* pfClean = NULL);\n \n // Apply the effects of this block (with given index) on the UTXO set represented by coins\n-bool ConnectBlock(CBlock& block, CValidationState& state, CBlockIndex* pindex, CCoinsViewCache& coins, bool fJustCheck = false);\n+bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockIndex* pindex, CCoinsViewCache& coins, bool fJustCheck = false);\n \n // Context-independent validity checks\n bool CheckBlockHeader(const CBlockHeader& block, CValidationState& state, bool fCheckPOW = true);\n bool CheckBlock(const CBlock& block, CValidationState& state, bool fCheckPOW = true, bool fCheckMerkleRoot = true);\n \n+// Context-dependent validity checks\n+bool ContextualCheckBlockHeader(const CBlockHeader& block, CValidationState& state, CBlockIndex **ppindex= NULL);\n+bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIndex* const & pindexPrev);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20434035",
      "id" : 20434035,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 13,
      "path" : "src/main.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20434035",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20434125"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20434125"
         }
      },
      "body" : "Can this go in core_read/core_io?",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T13:15:11Z",
      "diff_hunk" : "@@ -283,6 +283,38 @@ Value prioritisetransaction(const Array& params, bool fHelp)\n }\n \n \n+static bool DecodeHexBlk(CBlock& block, const std::string hexblock)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20434125",
      "id" : 20434125,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 4,
      "path" : "src/rpcmining.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20434125",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "utACK apart from above nits - commithash b61b59f9ce680f6d514e377b5fe591f5a3f7c6e4 https://dev.visucore.com/bitcoin/acks/1816\r\n",
      "created_at" : "2014-11-17T13:21:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-63303416",
      "id" : 63303416,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-11-17T13:21:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63303416",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20434724"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20434724"
         }
      },
      "body" : "Pass by reference?",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T13:30:54Z",
      "diff_hunk" : "@@ -283,6 +283,38 @@ Value prioritisetransaction(const Array& params, bool fHelp)\n }\n \n \n+static bool DecodeHexBlk(CBlock& block, const std::string hexblock)\n+{\n+    vector<unsigned char> blockData(ParseHex(hexblock));\n+    CDataStream ssBlock(blockData, SER_NETWORK, PROTOCOL_VERSION);\n+    try {\n+        ssBlock >> block;\n+        return true;\n+    }\n+    catch (const std::exception &) {\n+        return false;\n+    }\n+}\n+\n+// NOTE: Assumes a conclusive result; if result is inconclusive, it must be handled by caller\n+static Value BIP22ValidationResult(const CValidationState state)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20434724",
      "id" : 20434724,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 18,
      "path" : "src/rpcmining.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20434724",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20435120"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20435120"
         }
      },
      "body" : "Indeed, I like moving those manual nStatus updates out.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T13:41:43Z",
      "diff_hunk" : "@@ -2391,15 +2391,48 @@ bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBloc\n         }\n     }\n \n-    if (pindex == NULL)\n-        pindex = AddToBlockIndex(block);\n-\n     if (ppindex)\n         *ppindex = pindex;\n \n     return true;\n }\n \n+bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIndex* const & pindexPrev)\n+{\n+    const int nHeight = pindexPrev->nHeight + 1;\n+\n+    // Check that all transactions are finalized\n+    BOOST_FOREACH(const CTransaction& tx, block.vtx)\n+        if (!IsFinalTx(tx, nHeight, block.GetBlockTime())) {\n+            return state.DoS(10, error(\"AcceptBlock() : contains a non-final transaction\"),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20435120",
      "id" : 20435120,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 38,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20435120",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20435368"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20435368"
         }
      },
      "body" : "Does it? It seems AcceptBlockHeader does...\r\n\r\nEDIT: Ignore, I misread.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T13:44:51Z",
      "diff_hunk" : "@@ -2555,6 +2567,32 @@ bool ProcessNewBlock(CValidationState &state, CNode* pfrom, CBlock* pblock, CDis\n     return true;\n }\n \n+bool TestBlockValidity(CValidationState &state, const CBlock& block, CBlockIndex * const &pindexPrev, bool fCheckPOW, bool fCheckMerkleRoot)\n+{\n+    AssertLockHeld(cs_main);\n+    assert(pindexPrev == chainActive.Tip());\n+\n+    CCoinsViewCache viewNew(pcoinsTip);\n+    CBlockIndex indexDummy(block);\n+    indexDummy.pprev = pindexPrev;\n+    indexDummy.nHeight = pindexPrev->nHeight + 1;\n+\n+    // NOTE: CheckBlockHeader is called by CheckBlock\n+    // NOTE: ContextualCheckBlockHeader only assigns ppindex, which we don't need/want",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20435368",
      "id" : 20435368,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 122,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20435368",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20435441"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20435441"
         }
      },
      "body" : "Agree.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T13:46:21Z",
      "diff_hunk" : "@@ -462,6 +513,10 @@ Value getblocktemplate(const Array& params, bool fHelp)\n     UpdateTime(pblock, pindexPrev);\n     pblock->nNonce = 0;\n \n+    static Array aCaps;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20435441",
      "id" : 20435441,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 69,
      "path" : "src/rpcmining.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20435441",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20447432"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20447432"
         }
      },
      "body" : "Does it matter for const?",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T16:48:41Z",
      "diff_hunk" : "@@ -283,6 +283,38 @@ Value prioritisetransaction(const Array& params, bool fHelp)\n }\n \n \n+static bool DecodeHexBlk(CBlock& block, const std::string hexblock)\n+{\n+    vector<unsigned char> blockData(ParseHex(hexblock));\n+    CDataStream ssBlock(blockData, SER_NETWORK, PROTOCOL_VERSION);\n+    try {\n+        ssBlock >> block;\n+        return true;\n+    }\n+    catch (const std::exception &) {\n+        return false;\n+    }\n+}\n+\n+// NOTE: Assumes a conclusive result; if result is inconclusive, it must be handled by caller\n+static Value BIP22ValidationResult(const CValidationState state)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20447432",
      "id" : 20447432,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 18,
      "path" : "src/rpcmining.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20447432",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20447464"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20447464"
         }
      },
      "body" : "Any way we can just make this a static const Array somehow? That seems cleanest, but not sure if it's possible to do in C++ :/",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T16:49:11Z",
      "diff_hunk" : "@@ -462,6 +513,10 @@ Value getblocktemplate(const Array& params, bool fHelp)\n     UpdateTime(pblock, pindexPrev);\n     pblock->nNonce = 0;\n \n+    static Array aCaps;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20447464",
      "id" : 20447464,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 69,
      "path" : "src/rpcmining.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20447464",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20447506"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20447506"
         }
      },
      "body" : "Avoiding a copy.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T16:49:50Z",
      "diff_hunk" : "@@ -283,6 +283,38 @@ Value prioritisetransaction(const Array& params, bool fHelp)\n }\n \n \n+static bool DecodeHexBlk(CBlock& block, const std::string hexblock)\n+{\n+    vector<unsigned char> blockData(ParseHex(hexblock));\n+    CDataStream ssBlock(blockData, SER_NETWORK, PROTOCOL_VERSION);\n+    try {\n+        ssBlock >> block;\n+        return true;\n+    }\n+    catch (const std::exception &) {\n+        return false;\n+    }\n+}\n+\n+// NOTE: Assumes a conclusive result; if result is inconclusive, it must be handled by caller\n+static Value BIP22ValidationResult(const CValidationState state)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20447506",
      "id" : 20447506,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 18,
      "path" : "src/rpcmining.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20447506",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20447617"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20447617"
         }
      },
      "body" : "static const Array aCaps = boost::assign::list_of(\"proposal\");",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-17T16:51:15Z",
      "diff_hunk" : "@@ -462,6 +513,10 @@ Value getblocktemplate(const Array& params, bool fHelp)\n     UpdateTime(pblock, pindexPrev);\n     pblock->nNonce = 0;\n \n+    static Array aCaps;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20447617",
      "id" : 20447617,
      "original_commit_id" : "76590af5bd2ceae7d2e3f11982d20739063cde1b",
      "original_position" : 69,
      "path" : "src/rpcmining.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20447617",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Comments addressed and QA RPC tests added.",
      "created_at" : "2014-11-17T19:20:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-63359249",
      "id" : 63359249,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-11-17T19:20:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63359249",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20482212"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20482212"
         }
      },
      "body" : "Does this mean its a blocker, or just future feature?",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-18T02:36:31Z",
      "diff_hunk" : "@@ -0,0 +1,182 @@\n+#!/usr/bin/env python\n+# Copyright (c) 2014 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+from test_framework import BitcoinTestFramework\n+from bitcoinrpc.authproxy import AuthServiceProxy, JSONRPCException\n+from util import *\n+\n+from binascii import a2b_hex, b2a_hex\n+from hashlib import sha256\n+from struct import pack\n+\n+\n+def check_array_result(object_array, to_match, expected):\n+    \"\"\"\n+    Pass in array of JSON objects, a dictionary with key/value pairs\n+    to match against, and another dictionary with expected key/value\n+    pairs.\n+    \"\"\"\n+    num_matched = 0\n+    for item in object_array:\n+        all_match = True\n+        for key,value in to_match.items():\n+            if item[key] != value:\n+                all_match = False\n+        if not all_match:\n+            continue\n+        for key,value in expected.items():\n+            if item[key] != value:\n+                raise AssertionError(\"%s : expected %s=%s\"%(str(item), str(key), str(value)))\n+            num_matched = num_matched+1\n+    if num_matched == 0:\n+        raise AssertionError(\"No objects matched %s\"%(str(to_match)))\n+\n+def b2x(b):\n+    return b2a_hex(b).decode('ascii')\n+\n+# NOTE: This does not work for signed numbers (set the high bit) or zero (use b'\\0')\n+def encodeUNum(n):\n+    s = bytearray(b'\\1')\n+    while n > 127:\n+        s[0] += 1\n+        s.append(n % 256)\n+        n //= 256\n+    s.append(n)\n+    return bytes(s)\n+\n+def varlenEncode(n):\n+    if n < 0xfd:\n+        return pack('<B', n)\n+    if n <= 0xffff:\n+        return b'\\xfd' + pack('<H', n)\n+    if n <= 0xffffffff:\n+        return b'\\xfe' + pack('<L', n)\n+    return b'\\xff' + pack('<Q', n)\n+\n+def dblsha(b):\n+    return sha256(sha256(b).digest()).digest()\n+\n+def genmrklroot(leaflist):\n+    cur = leaflist\n+    while len(cur) > 1:\n+        n = []\n+        if len(cur) & 1:\n+            cur.append(cur[-1])\n+        for i in range(0, len(cur), 2):\n+            n.append(dblsha(cur[i] + cur[i+1]))\n+        cur = n\n+    return cur[0]\n+\n+def template_to_bytes(tmpl, txlist):\n+    blkver = pack('<L', tmpl['version'])\n+    mrklroot = genmrklroot(list(dblsha(a) for a in txlist))\n+    timestamp = pack('<L', tmpl['curtime'])\n+    nonce = b'\\0\\0\\0\\0'\n+    blk = blkver + a2b_hex(tmpl['previousblockhash'])[::-1] + mrklroot + timestamp + a2b_hex(tmpl['bits'])[::-1] + nonce\n+    blk += varlenEncode(len(txlist))\n+    for tx in txlist:\n+        blk += tx\n+    return blk\n+\n+def template_to_hex(tmpl, txlist):\n+    return b2x(template_to_bytes(tmpl, txlist))\n+\n+def assert_template(node, tmpl, txlist, expect):\n+    rsp = node.getblocktemplate({'data':template_to_hex(tmpl, txlist),'mode':'proposal'})\n+    if rsp != expect:\n+        raise AssertionError('unexpected: %s' % (rsp,))\n+\n+class GetBlockTemplateProposalTest(BitcoinTestFramework):\n+    '''\n+    Test block proposals with getblocktemplate.\n+    '''\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        tmpl = node.getblocktemplate()\n+        if 'coinbasetxn' not in tmpl:\n+            rawcoinbase = encodeUNum(tmpl['height'])\n+            rawcoinbase += b'\\x01-'\n+            hexcoinbase = b2x(rawcoinbase)\n+            hexoutval = b2x(pack('<Q', tmpl['coinbasevalue']))\n+            tmpl['coinbasetxn'] = {'data': '01000000' + '01' + '0000000000000000000000000000000000000000000000000000000000000000ffffffff' + ('%02x' % (len(rawcoinbase),)) + hexcoinbase + 'fffffffe' + '01' + hexoutval + '00' + '00000000'}\n+        txlist = list(bytearray(a2b_hex(a['data'])) for a in (tmpl['coinbasetxn'],) + tuple(tmpl['transactions']))\n+\n+        # Test 0: Capability advertised\n+        assert('proposal' in tmpl['capabilities'])\n+\n+        # NOTE: This test currently FAILS",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20482212",
      "id" : 20482212,
      "original_commit_id" : "98974b5e9562c89fa0478cb4b8b6e9325ed9d424",
      "original_position" : 110,
      "path" : "qa/rpc-tests/getblocktemplate_proposals.py",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20482212",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20482474"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20482474"
         }
      },
      "body" : "It means regtest mode is failing to enforce height-in-coinbase rules. No reason to think it affects real-world use.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-18T02:43:29Z",
      "diff_hunk" : "@@ -0,0 +1,182 @@\n+#!/usr/bin/env python\n+# Copyright (c) 2014 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+from test_framework import BitcoinTestFramework\n+from bitcoinrpc.authproxy import AuthServiceProxy, JSONRPCException\n+from util import *\n+\n+from binascii import a2b_hex, b2a_hex\n+from hashlib import sha256\n+from struct import pack\n+\n+\n+def check_array_result(object_array, to_match, expected):\n+    \"\"\"\n+    Pass in array of JSON objects, a dictionary with key/value pairs\n+    to match against, and another dictionary with expected key/value\n+    pairs.\n+    \"\"\"\n+    num_matched = 0\n+    for item in object_array:\n+        all_match = True\n+        for key,value in to_match.items():\n+            if item[key] != value:\n+                all_match = False\n+        if not all_match:\n+            continue\n+        for key,value in expected.items():\n+            if item[key] != value:\n+                raise AssertionError(\"%s : expected %s=%s\"%(str(item), str(key), str(value)))\n+            num_matched = num_matched+1\n+    if num_matched == 0:\n+        raise AssertionError(\"No objects matched %s\"%(str(to_match)))\n+\n+def b2x(b):\n+    return b2a_hex(b).decode('ascii')\n+\n+# NOTE: This does not work for signed numbers (set the high bit) or zero (use b'\\0')\n+def encodeUNum(n):\n+    s = bytearray(b'\\1')\n+    while n > 127:\n+        s[0] += 1\n+        s.append(n % 256)\n+        n //= 256\n+    s.append(n)\n+    return bytes(s)\n+\n+def varlenEncode(n):\n+    if n < 0xfd:\n+        return pack('<B', n)\n+    if n <= 0xffff:\n+        return b'\\xfd' + pack('<H', n)\n+    if n <= 0xffffffff:\n+        return b'\\xfe' + pack('<L', n)\n+    return b'\\xff' + pack('<Q', n)\n+\n+def dblsha(b):\n+    return sha256(sha256(b).digest()).digest()\n+\n+def genmrklroot(leaflist):\n+    cur = leaflist\n+    while len(cur) > 1:\n+        n = []\n+        if len(cur) & 1:\n+            cur.append(cur[-1])\n+        for i in range(0, len(cur), 2):\n+            n.append(dblsha(cur[i] + cur[i+1]))\n+        cur = n\n+    return cur[0]\n+\n+def template_to_bytes(tmpl, txlist):\n+    blkver = pack('<L', tmpl['version'])\n+    mrklroot = genmrklroot(list(dblsha(a) for a in txlist))\n+    timestamp = pack('<L', tmpl['curtime'])\n+    nonce = b'\\0\\0\\0\\0'\n+    blk = blkver + a2b_hex(tmpl['previousblockhash'])[::-1] + mrklroot + timestamp + a2b_hex(tmpl['bits'])[::-1] + nonce\n+    blk += varlenEncode(len(txlist))\n+    for tx in txlist:\n+        blk += tx\n+    return blk\n+\n+def template_to_hex(tmpl, txlist):\n+    return b2x(template_to_bytes(tmpl, txlist))\n+\n+def assert_template(node, tmpl, txlist, expect):\n+    rsp = node.getblocktemplate({'data':template_to_hex(tmpl, txlist),'mode':'proposal'})\n+    if rsp != expect:\n+        raise AssertionError('unexpected: %s' % (rsp,))\n+\n+class GetBlockTemplateProposalTest(BitcoinTestFramework):\n+    '''\n+    Test block proposals with getblocktemplate.\n+    '''\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+        tmpl = node.getblocktemplate()\n+        if 'coinbasetxn' not in tmpl:\n+            rawcoinbase = encodeUNum(tmpl['height'])\n+            rawcoinbase += b'\\x01-'\n+            hexcoinbase = b2x(rawcoinbase)\n+            hexoutval = b2x(pack('<Q', tmpl['coinbasevalue']))\n+            tmpl['coinbasetxn'] = {'data': '01000000' + '01' + '0000000000000000000000000000000000000000000000000000000000000000ffffffff' + ('%02x' % (len(rawcoinbase),)) + hexcoinbase + 'fffffffe' + '01' + hexoutval + '00' + '00000000'}\n+        txlist = list(bytearray(a2b_hex(a['data'])) for a in (tmpl['coinbasetxn'],) + tuple(tmpl['transactions']))\n+\n+        # Test 0: Capability advertised\n+        assert('proposal' in tmpl['capabilities'])\n+\n+        # NOTE: This test currently FAILS",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20482474",
      "id" : 20482474,
      "original_commit_id" : "98974b5e9562c89fa0478cb4b8b6e9325ed9d424",
      "original_position" : 110,
      "path" : "qa/rpc-tests/getblocktemplate_proposals.py",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20482474",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20495242"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20495242"
         }
      },
      "body" : "Can you move the duplicate/prevfinding code to AcceptBlockHeader, and have this function just take a CBlockIndex* pointer (which cannot be NULL)? I would prefer it if this function didn't need cs_main.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-18T09:53:30Z",
      "diff_hunk" : "@@ -2334,7 +2334,7 @@ bool CheckBlock(const CBlock& block, CValidationState& state, bool fCheckPOW, bo\n     return true;\n }\n \n-bool AcceptBlockHeader(const CBlockHeader& block, CValidationState& state, CBlockIndex** ppindex)\n+bool ContextualCheckBlockHeader(const CBlockHeader& block, CValidationState& state, CBlockIndex** ppindex)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20495242",
      "id" : 20495242,
      "original_commit_id" : "98974b5e9562c89fa0478cb4b8b6e9325ed9d424",
      "original_position" : 14,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20495242",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@luke-jr I'm hacking a bit on this myself now (just so we don't do double work).",
      "created_at" : "2014-11-18T16:30:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-63499105",
      "id" : 63499105,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-11-18T16:30:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63499105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@luke-jr See #5302. Feel free to disagree, cherry-pick, or edit into your commits.",
      "created_at" : "2014-11-18T16:56:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-63503776",
      "id" : 63503776,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-11-18T16:56:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63503776",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20528180"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20528180"
         }
      },
      "body" : "mapBlockIndex.count(hash) != 0 ?",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-18T18:55:19Z",
      "diff_hunk" : "@@ -580,14 +621,13 @@ Value submitblock(const Array& params, bool fHelp)\n             + HelpExampleRpc(\"submitblock\", \"\\\"mydata\\\"\")\n         );\n \n-    vector<unsigned char> blockData(ParseHex(params[0].get_str()));\n-    CDataStream ssBlock(blockData, SER_NETWORK, PROTOCOL_VERSION);\n     CBlock pblock;\n-    try {\n-        ssBlock >> pblock;\n-    }\n-    catch (const std::exception &) {\n+    if (!DecodeHexBlk(pblock, params[0].get_str()))\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block decode failed\");\n+\n+    uint256 hash = block.GetHash();\n+    if (mapBlockIndex.find(hash) != mapBlockIndex.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20528180",
      "id" : 20528180,
      "original_commit_id" : "e25e31d32de3971e516bff9fccbf173165bc51eb",
      "original_position" : 84,
      "path" : "src/rpcmining.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20528180",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20528333"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20528333"
         }
      },
      "body" : "Actually, just having the header does not mean we already have the block.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-18T18:57:22Z",
      "diff_hunk" : "@@ -580,14 +621,13 @@ Value submitblock(const Array& params, bool fHelp)\n             + HelpExampleRpc(\"submitblock\", \"\\\"mydata\\\"\")\n         );\n \n-    vector<unsigned char> blockData(ParseHex(params[0].get_str()));\n-    CDataStream ssBlock(blockData, SER_NETWORK, PROTOCOL_VERSION);\n     CBlock pblock;\n-    try {\n-        ssBlock >> pblock;\n-    }\n-    catch (const std::exception &) {\n+    if (!DecodeHexBlk(pblock, params[0].get_str()))\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block decode failed\");\n+\n+    uint256 hash = block.GetHash();\n+    if (mapBlockIndex.find(hash) != mapBlockIndex.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20528333",
      "id" : 20528333,
      "original_commit_id" : "e25e31d32de3971e516bff9fccbf173165bc51eb",
      "original_position" : 84,
      "path" : "src/rpcmining.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20528333",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Seems ready to merge now? Ready to ACK this now @gmaxwell @sipa @gavinandresen ?\r\n",
      "created_at" : "2014-11-19T09:38:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-63613784",
      "id" : 63613784,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-11-19T09:38:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63613784",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20616068"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20616068"
         }
      },
      "body" : "nit: pindex->IsValid(BLOCK_VALID_SCRIPTS)",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-19T23:16:28Z",
      "diff_hunk" : "@@ -566,41 +618,39 @@ Value submitblock(const Array& params, bool fHelp)\n             + HelpExampleRpc(\"submitblock\", \"\\\"mydata\\\"\")\n         );\n \n-    vector<unsigned char> blockData(ParseHex(params[0].get_str()));\n-    CDataStream ssBlock(blockData, SER_NETWORK, PROTOCOL_VERSION);\n-    CBlock pblock;\n-    try {\n-        ssBlock >> pblock;\n-    }\n-    catch (const std::exception &) {\n+    CBlock block;\n+    if (!DecodeHexBlk(block, params[0].get_str()))\n         throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"Block decode failed\");\n+\n+    uint256 hash = block.GetHash();\n+    BlockMap::iterator mi = mapBlockIndex.find(hash);\n+    if (mi != mapBlockIndex.end()) {\n+        CBlockIndex *pindex = mi->second;\n+        if (pindex->nStatus & BLOCK_VALID_MASK == BLOCK_VALID_SCRIPTS)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20616068",
      "id" : 20616068,
      "original_commit_id" : "720efbe98667160d5b66c6bbcb0afa7c3c3dc0c9",
      "original_position" : 99,
      "path" : "src/rpcmining.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T15:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20616068",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Untested ACK.",
      "created_at" : "2014-11-19T23:41:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-63736216",
      "id" : 63736216,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-11-19T23:41:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63736216",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "(Made the change @sipa suggested.)",
      "created_at" : "2014-11-20T00:18:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#issuecomment-63740164",
      "id" : 63740164,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1816",
      "updated_at" : "2014-11-20T00:18:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/63740164",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20656485"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20656485"
         }
      },
      "body" : "Just for completeness, every other function here has a variable (name) specified, while CBlock has not. In the definition you use ``block``.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-20T16:12:49Z",
      "diff_hunk" : "@@ -16,6 +17,7 @@ class UniValue;\n // core_read.cpp\n extern CScript ParseScript(std::string s);\n extern bool DecodeHexTx(CTransaction& tx, const std::string& strHexTx);\n+extern bool DecodeHexBlk(CBlock&, const std::string& strHexBlk);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20656485",
      "id" : 20656485,
      "original_commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "original_position" : 12,
      "path" : "src/core_io.h",
      "position" : 12,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T16:13:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20656485",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20656649"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20656649"
         }
      },
      "body" : "Better not to add redundant content.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-20T16:15:01Z",
      "diff_hunk" : "@@ -16,6 +17,7 @@ class UniValue;\n // core_read.cpp\n extern CScript ParseScript(std::string s);\n extern bool DecodeHexTx(CTransaction& tx, const std::string& strHexTx);\n+extern bool DecodeHexBlk(CBlock&, const std::string& strHexBlk);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20656649",
      "id" : 20656649,
      "original_commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "original_position" : 12,
      "path" : "src/core_io.h",
      "position" : 12,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T16:15:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20656649",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20656783"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20656783"
         }
      },
      "body" : "You are such a contra guy sometimes ^^.",
      "commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "created_at" : "2014-11-20T16:16:48Z",
      "diff_hunk" : "@@ -16,6 +17,7 @@ class UniValue;\n // core_read.cpp\n extern CScript ParseScript(std::string s);\n extern bool DecodeHexTx(CTransaction& tx, const std::string& strHexTx);\n+extern bool DecodeHexBlk(CBlock&, const std::string& strHexBlk);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1816#discussion_r20656783",
      "id" : 20656783,
      "original_commit_id" : "b867e409e5dd34b84eb9d6d0d8f257dbb19b986d",
      "original_position" : 12,
      "path" : "src/core_io.h",
      "position" : 12,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1816",
      "updated_at" : "2014-11-20T16:16:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/20656783",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   }
]
