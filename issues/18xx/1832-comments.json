[
   {
      "body" : "Hm, this could be solved by making CDBEnv bitdb an explicitly constructed/destructed singleton instead of a static global. Explicitly created in Init() and destroyed in Shutdown().\n\nIt would be more clear, too.\n",
      "created_at" : "2012-09-20T08:04:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/1832#issuecomment-8719529",
      "id" : 8719529,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1832",
      "updated_at" : "2012-09-20T08:04:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8719529",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "But then we'll run into the same issue again if we ever have other global or static objects that want to printf() during shutdown (and it is a nasty issue because it can work just fine for some people and not for others).\n\nMaking the mutex a pointer initialized to NULL, creating it using 'new' and then simply never deleting it is probably the best fix.",
      "created_at" : "2012-09-20T14:39:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/1832#issuecomment-8730560",
      "id" : 8730560,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1832",
      "updated_at" : "2012-09-20T14:39:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8730560",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Yes that would fix the instances of printf() in shutdown, but there could always be other dependencies between static objects' destructors.\n\nI think it'd be better to not have non-trivial objects that rely on static construction / destruction, and do our own object lifetime management in a well-defined order. That seems to be pretty common in C++ coding guidelines.\n\nOr do both.\n\n",
      "created_at" : "2012-09-20T14:49:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/1832#issuecomment-8730902",
      "id" : 8730902,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1832",
      "updated_at" : "2012-09-20T15:03:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/8730902",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@gavinandresen Wasn't this also fixed?",
      "created_at" : "2013-01-11T06:37:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/1832#issuecomment-12133430",
      "id" : 12133430,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1832",
      "updated_at" : "2013-01-11T06:37:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/12133430",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@Diapolo : yes, thanks for looking through the issues list, that's a huge help!  Closing.",
      "created_at" : "2013-01-11T16:13:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/1832#issuecomment-12150928",
      "id" : 12150928,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1832",
      "updated_at" : "2013-01-11T16:13:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/12150928",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "I'll keep an eye on the issues list, because it's getting quite long recently ;).",
      "created_at" : "2013-01-11T16:42:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/1832#issuecomment-12152295",
      "id" : 12152295,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1832",
      "updated_at" : "2013-01-11T16:42:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/12152295",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   }
]
