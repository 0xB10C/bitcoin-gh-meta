[
   {
      "author_association" : "NONE",
      "body" : "@Sjors where were you making this patch? having trouble with this myself",
      "created_at" : "2020-07-31T07:00:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-666965873",
      "id" : 666965873,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2Njk2NTg3Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-31T07:00:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/666965873",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15133828?v=4",
         "events_url" : "https://api.github.com/users/jakeleventhal/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jakeleventhal/followers",
         "following_url" : "https://api.github.com/users/jakeleventhal/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jakeleventhal/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jakeleventhal",
         "id" : 15133828,
         "login" : "jakeleventhal",
         "node_id" : "MDQ6VXNlcjE1MTMzODI4",
         "organizations_url" : "https://api.github.com/users/jakeleventhal/orgs",
         "received_events_url" : "https://api.github.com/users/jakeleventhal/received_events",
         "repos_url" : "https://api.github.com/users/jakeleventhal/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jakeleventhal/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jakeleventhal/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jakeleventhal"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jakeleventhal I haven't tried. In fact I had to ditch my Big Sur machine because it was broken. Will probably upgrade another machine later this summer and try again.",
      "created_at" : "2020-07-31T17:03:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-667231051",
      "id" : 667231051,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NzIzMTA1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-31T17:03:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/667231051",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@Sjors i only have one machine and i need it on big sur. is there a docker image you recommend using that i can just share my workspace with as a volume? one that has most of everything installed already?",
      "created_at" : "2020-08-02T06:33:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-667635497",
      "id" : 667635497,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NzYzNTQ5Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-02T06:33:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/667635497",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15133828?v=4",
         "events_url" : "https://api.github.com/users/jakeleventhal/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jakeleventhal/followers",
         "following_url" : "https://api.github.com/users/jakeleventhal/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jakeleventhal/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jakeleventhal",
         "id" : 15133828,
         "login" : "jakeleventhal",
         "node_id" : "MDQ6VXNlcjE1MTMzODI4",
         "organizations_url" : "https://api.github.com/users/jakeleventhal/orgs",
         "received_events_url" : "https://api.github.com/users/jakeleventhal/received_events",
         "repos_url" : "https://api.github.com/users/jakeleventhal/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jakeleventhal/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jakeleventhal/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jakeleventhal"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Update: `cdecker/bitcoin-dev:common` is a good docker image that lets you build bitcoin for anyone who comes across this issue in the future",
      "created_at" : "2020-08-02T17:57:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-667705447",
      "id" : 667705447,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NzcwNTQ0Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-02T17:57:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/667705447",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15133828?v=4",
         "events_url" : "https://api.github.com/users/jakeleventhal/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jakeleventhal/followers",
         "following_url" : "https://api.github.com/users/jakeleventhal/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jakeleventhal/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jakeleventhal",
         "id" : 15133828,
         "login" : "jakeleventhal",
         "node_id" : "MDQ6VXNlcjE1MTMzODI4",
         "organizations_url" : "https://api.github.com/users/jakeleventhal/orgs",
         "received_events_url" : "https://api.github.com/users/jakeleventhal/received_events",
         "repos_url" : "https://api.github.com/users/jakeleventhal/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jakeleventhal/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jakeleventhal/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jakeleventhal"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "It seems that passing --enable-posixmutexes is sufficient to get configure to continue and the build to succeed. This finds /POSIX/pthreads/private when looking for mutexes. Not sure if the build libdb behaves properly though.",
      "created_at" : "2020-09-21T12:14:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-696075232",
      "id" : 696075232,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NjA3NTIzMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-21T12:14:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/696075232",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/388177?v=4",
         "events_url" : "https://api.github.com/users/BioMike/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BioMike/followers",
         "following_url" : "https://api.github.com/users/BioMike/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BioMike/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BioMike",
         "id" : 388177,
         "login" : "BioMike",
         "node_id" : "MDQ6VXNlcjM4ODE3Nw==",
         "organizations_url" : "https://api.github.com/users/BioMike/orgs",
         "received_events_url" : "https://api.github.com/users/BioMike/received_events",
         "repos_url" : "https://api.github.com/users/BioMike/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BioMike/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BioMike/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BioMike"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "It seems that passing --enable-posixmutexes is sufficient to get configure to continue and the build to succeed. This finds /POSIX/pthreads/private when looking for mutexes. Not sure if the build libdb behaves properly though.",
      "created_at" : "2020-09-21T12:14:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-696075288",
      "id" : 696075288,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NjA3NTI4OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-21T12:14:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/696075288",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/388177?v=4",
         "events_url" : "https://api.github.com/users/BioMike/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BioMike/followers",
         "following_url" : "https://api.github.com/users/BioMike/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BioMike/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BioMike",
         "id" : 388177,
         "login" : "BioMike",
         "node_id" : "MDQ6VXNlcjM4ODE3Nw==",
         "organizations_url" : "https://api.github.com/users/BioMike/orgs",
         "received_events_url" : "https://api.github.com/users/BioMike/received_events",
         "repos_url" : "https://api.github.com/users/BioMike/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BioMike/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BioMike/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BioMike"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@BioMike I tried `contrib/install_db4.sh . --enable-posixmutexes` but it still fails for me with `checking for mutexes... configure: error: unable to find POSIX 1003.1 mutex interfaces`",
      "created_at" : "2020-09-22T10:41:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-696642445",
      "id" : 696642445,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NjY0MjQ0NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-22T10:41:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/696642445",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@Sjors Did you solve it? I'm stuck as you at this same error after tried with --enable-posixmutexes",
      "created_at" : "2020-09-24T20:12:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-698564291",
      "id" : 698564291,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5ODU2NDI5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-24T20:12:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/698564291",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/46746362?v=4",
         "events_url" : "https://api.github.com/users/Original-Tasty/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Original-Tasty/followers",
         "following_url" : "https://api.github.com/users/Original-Tasty/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Original-Tasty/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Original-Tasty",
         "id" : 46746362,
         "login" : "Original-Tasty",
         "node_id" : "MDQ6VXNlcjQ2NzQ2MzYy",
         "organizations_url" : "https://api.github.com/users/Original-Tasty/orgs",
         "received_events_url" : "https://api.github.com/users/Original-Tasty/received_events",
         "repos_url" : "https://api.github.com/users/Original-Tasty/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Original-Tasty/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Original-Tasty/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Original-Tasty"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "How about --with-mutex=Darwin/_spin_lock_try?",
      "created_at" : "2020-09-25T10:04:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-698843771",
      "id" : 698843771,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5ODg0Mzc3MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-25T10:04:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/698843771",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/388177?v=4",
         "events_url" : "https://api.github.com/users/BioMike/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BioMike/followers",
         "following_url" : "https://api.github.com/users/BioMike/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BioMike/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BioMike",
         "id" : 388177,
         "login" : "BioMike",
         "node_id" : "MDQ6VXNlcjM4ODE3Nw==",
         "organizations_url" : "https://api.github.com/users/BioMike/orgs",
         "received_events_url" : "https://api.github.com/users/BioMike/received_events",
         "repos_url" : "https://api.github.com/users/BioMike/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BioMike/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BioMike/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BioMike"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Mmm, that's at least a different error:\r\n```\r\n./libtool --mode=compile cc -c -I. -I/Users/sjors/dev/bitcoin/db4/db-4.8.30.NC/dist/..  -O3  /Users/sjors/dev/bitcoin/db4/db-4.8.30.NC/dist/../mutex/mut_tas.c\r\nlibtool: compile:  cc -c -I. -I/Users/sjors/dev/bitcoin/db4/db-4.8.30.NC/dist/.. -O3 /Users/sjors/dev/bitcoin/db4/db-4.8.30.NC/dist/../mutex/mut_tas.c  -fno-common -DPIC -o mut_tas.o\r\n/Users/sjors/dev/bitcoin/db4/db-4.8.30.NC/dist/../mutex/mut_tas.c:140:34: error: implicit declaration of function 'atomic_compare_exchange' is invalid in C99 [-Werror,-Wimplicit-function-declaration]\r\n                if (MUTEXP_IS_BUSY(mutexp) || !MUTEXP_ACQUIRE(mutexp)) {\r\n                                               ^\r\n/Users/sjors/dev/bitcoin/db4/db-4.8.30.NC/dist/../dbinc/mutex_int.h:1056:2: note: expanded from macro 'MUTEXP_ACQUIRE'\r\n        atomic_compare_exchange(env,                            \\\r\n        ^\r\n/Users/sjors/dev/bitcoin/db4/db-4.8.30.NC/dist/../mutex/mut_tas.c:336:8: error: implicit declaration of function 'atomic_compare_exchange' is invalid in C99 [-Werror,-Wimplicit-function-declaration]\r\n                    !atomic_compare_exchange(env,\r\n                     ^\r\n2 errors generated.\r\nmake: *** [mut_tas.o] Error 1\r\n```",
      "created_at" : "2020-09-28T15:00:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-700063324",
      "id" : 700063324,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwMDA2MzMyNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-28T15:00:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/700063324",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@Sjors I just upgraded to Big Sur and saw this issue mentioned in the meeting...\r\n\r\nI can get this to compile by using brew-installed llvm like so:\r\n\r\n```\r\nbrew install llvm\r\nexport LLVM_PREFIX=$(brew --prefix llvm)\r\nCC=$LLVM_PREFIX/bin/clang CXX=$LLVM_PREFIX/bin/clang++ LDFLAGS=\"-L$LLVM_PREFIX/opt/llvm/lib -Wl,-rpath,$LLVM_PREFIX/opt/llvm/lib\" ./contrib/install_db4.sh .\r\n```",
      "created_at" : "2020-10-08T19:26:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-705775164",
      "id" : 705775164,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwNTc3NTE2NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-08T19:29:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/705775164",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I assume you upgraded to the latest beta version 9? This workaround seems to work on macOS 10.15.7 Catalina as well, with Xcode 12.0.1 and llvm 10.0.1 via Homebrew. At least it doesn't break any wallet tests.",
      "created_at" : "2020-10-09T08:58:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-706060591",
      "id" : 706060591,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwNjA2MDU5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-09T08:58:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/706060591",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@Sjors yes I am on Version 11 Beta (20A5384c) and latest Xcode Beta.\r\n\r\nNot really a satisfying fix, but at least good to have _some_ sort of workaround in the iterim. I will try a bit more tomorrow to see if I can find what the issue is with system compiler and libs...",
      "created_at" : "2020-10-11T18:03:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-706743304",
      "id" : 706743304,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwNjc0MzMwNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-11T18:03:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/706743304",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "~~Another (simpler) workaround:~~\r\n\r\n```bash\r\n./install_db4.sh . --disable-mutexsupport\r\n```\r\n~~All wallet tests still pass, but the implications of no mutexes in the wallet db are, scary?~~\r\n**EDIT: wallet tests do not pass** (Was using the wrong db to build Bitcoin Core, had one in src/ and one in src/contrib/)\r\n\r\nI notice that Core has a specific pthread m4 in `build-aux/m4/ax_pthread.m4`, which seems to be the offending header in the BDB configure, so might investigate the differences if I don't have any other luck.\r\n\r\nMore promising I think might be to investigate this [known issue](https://developer.apple.com/documentation/macos-release-notes/macos-big-sur-11-beta-release-notes) of Big Sur:\r\n\r\n>New in macOS Big Sur 11 beta, the system ships with a built-in dynamic linker cache of all system-provided libraries. As part of this change, copies of dynamic libraries are no longer present on the filesystem. Code that attempts to check for dynamic library presence by looking for a file at a path or enumerating a directory will fail. Instead, check for library presence by attempting to dlopen() the path, which will correctly check for the library in the cache. (62986286)\r\n\r\n",
      "created_at" : "2020-10-12T10:17:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-707028729",
      "id" : 707028729,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwNzAyODcyOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-12T10:54:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/707028729",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Some progress towards identifying a fix:\r\n\r\n* Modify `./contrib/install_db4.sh` to break at line 91 then run once with `./contrib/install_db4.sh .`\r\n\r\n* Modify `db4/db-4.8.30.NC/dist/aclocal/mutex.m4` with the following patch (I believe `AC_TRY_RUN`... was silently failing without `#include <stdlib.h>`???):\r\n\r\n```\r\n--- mutex-orig.m4\t2020-10-13 11:17:55.000000000 +0100\r\n+++ mutex.m4\t2020-10-13 11:15:56.000000000 +0100\r\n@@ -4,6 +4,7 @@\r\n AC_DEFUN(AM_PTHREADS_SHARED, [\r\n AC_TRY_RUN([\r\n #include <pthread.h>\r\n+#include <stdlib.h>\r\n main() {\r\n \tpthread_cond_t cond;\r\n \tpthread_mutex_t mutex;\r\n@@ -24,7 +25,8 @@\r\n \tpthread_mutexattr_destroy(&mutexattr));\r\n }], [db_cv_mutex=\"$1\"],,\r\n AC_TRY_LINK([\r\n-#include <pthread.h>],[\r\n+#include <pthread.h>\r\n+#include <stdlib.h>],[\r\n \tpthread_cond_t cond;\r\n \tpthread_mutex_t mutex;\r\n \tpthread_condattr_t condattr;\r\n@@ -46,6 +48,7 @@\r\n AC_DEFUN(AM_PTHREADS_PRIVATE, [\r\n AC_TRY_RUN([\r\n #include <pthread.h>\r\n+#include <stdlib.h>\r\n main() {\r\n \tpthread_cond_t cond;\r\n \tpthread_mutex_t mutex;\r\n@@ -65,6 +68,7 @@\r\n }], [db_cv_mutex=\"$1\"],,\r\n AC_TRY_LINK([\r\n #include <pthread.h>],[\r\n+#include <stdlib.h>\r\n \tpthread_cond_t cond;\r\n \tpthread_mutex_t mutex;\r\n \tpthread_condattr_t condattr;\r\n```\r\n\r\n\r\n* Next:\r\n```\r\ncd db4/db-4.8.30.NC/dist/\r\nsudo rm -Rf autom4te.cache/ configure\r\nsudo autoreconf -i\r\n```\r\nThis results in the following warnings:\r\n[autoreconf_output.txt](https://github.com/bitcoin/bitcoin/files/5370976/autoreconf_output.txt)\r\n\r\n* Comment out lines 28-67 and 70-88 and re-run `./contrib/install_db4.sh .`\r\n\r\nThis gets us past configure mutex checks successfully:\r\n```\r\nchecking for mutexes... POSIX/pthreads/library\r\nchecking pthread.h usability... yes\r\nchecking pthread.h presence... yes\r\nchecking for pthread.h... yes\r\nchecking for main in -lpthread... yes\r\n...\r\nchecking for fcntl/F_SETFD... yes\r\n```\r\n\r\n* Comment out lines 28-67 and 70-88 and re-run `./contrib/install_db4.sh .`\r\n\r\nThis however still results in the following error:\r\n\r\n```\r\nlibtool: compile:  cc -c -I. -I/Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/.. -O3 /Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/../env/env_method.c  -fno-common -DPIC -o env_method.o\r\n./libtool --mode=compile cc -c -I. -I/Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/..  -O3  /Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/../env/env_name.c\r\nlibtool: compile:  cc -c -I. -I/Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/.. -O3 /Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/../env/env_name.c  -fno-common -DPIC -o env_name.o\r\n./libtool --mode=compile cc -c -I. -I/Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/..  -O3  /Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/../env/env_open.c\r\nlibtool: compile:  cc -c -I. -I/Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/.. -O3 /Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/../env/env_open.c  -fno-common -DPIC -o env_open.o\r\n/Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/../env/env_open.c:33:14: error: use of undeclared identifier\r\n      '__EDIT_DB_VERSION_MAJOR__'\r\n                *majverp = DB_VERSION_MAJOR;\r\n                           ^\r\n./db.h:45:26: note: expanded from macro 'DB_VERSION_MAJOR'\r\n#define DB_VERSION_MAJOR        __EDIT_DB_VERSION_MAJOR__\r\n                                ^\r\n/Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/../env/env_open.c:35:14: error: use of undeclared identifier\r\n      '__EDIT_DB_VERSION_MINOR__'\r\n                *minverp = DB_VERSION_MINOR;\r\n                           ^\r\n./db.h:46:26: note: expanded from macro 'DB_VERSION_MINOR'\r\n#define DB_VERSION_MINOR        __EDIT_DB_VERSION_MINOR__\r\n                                ^\r\n/Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/../env/env_open.c:37:13: error: use of undeclared identifier\r\n      '__EDIT_DB_VERSION_PATCH__'\r\n                *patchp = DB_VERSION_PATCH;\r\n                          ^\r\n./db.h:47:26: note: expanded from macro 'DB_VERSION_PATCH'\r\n#define DB_VERSION_PATCH        __EDIT_DB_VERSION_PATCH__\r\n                                ^\r\n3 errors generated.\r\nmake: *** [env_open.o] Error 1\r\n```\r\n\r\nRunning `clang -x c -v -E /dev/null` shows the default clang config:\r\n\r\n```\r\nApple clang version 12.0.0 (clang-1200.0.32.6)\r\nTarget: x86_64-apple-darwin20.1.0\r\nThread model: posix\r\nInstalledDir: /Library/Developer/CommandLineTools/usr/bin\r\n \"/Library/Developer/CommandLineTools/usr/bin/clang\" -cc1 -triple x86_64-apple-macosx11.0.0 -Wdeprecated-objc-isa-usage -Werror=deprecated-objc-isa-usage -Werror=implicit-function-declaration -E -disable-free -disable-llvm-verifier -discard-value-names -main-file-name null -mrelocation-model pic -pic-level 2 -mthread-model posix -mframe-pointer=all -fno-strict-return -masm-verbose -munwind-tables -target-sdk-version=11.0 -target-cpu penryn -dwarf-column-info -debugger-tuning=lldb -target-linker-version 609.5 -v -resource-dir /Library/Developer/CommandLineTools/usr/lib/clang/12.0.0 -isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk -I/usr/local/include -internal-isystem /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/local/include -internal-isystem /Library/Developer/CommandLineTools/usr/lib/clang/12.0.0/include -internal-externc-isystem /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include -internal-externc-isystem /Library/Developer/CommandLineTools/usr/include -Wno-reorder-init-list -Wno-implicit-int-float-conversion -Wno-c99-designator -Wno-final-dtor-non-final-class -Wno-extra-semi-stmt -Wno-misleading-indentation -Wno-quoted-include-in-framework-header -Wno-implicit-fallthrough -Wno-enum-enum-conversion -Wno-enum-float-conversion -fdebug-compilation-dir /Users/will/src/bitcoin -ferror-limit 19 -fmessage-length 126 -stack-protector 1 -fstack-check -mdarwin-stkchk-strong-link -fblocks -fencode-extended-block-signature -fregister-global-dtors-with-atexit -fgnuc-version=4.2.1 -fobjc-runtime=macosx-11.0.0 -fmax-type-align=16 -fdiagnostics-show-option -fcolor-diagnostics -o - -x c /dev/null\r\nclang -cc1 version 12.0.0 (clang-1200.0.32.6) default target x86_64-apple-darwin20.1.0\r\nignoring nonexistent directory \"/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/local/include\"\r\nignoring nonexistent directory \"/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/Library/Frameworks\"\r\n#include \"...\" search starts here:\r\n#include <...> search starts here:\r\n /usr/local/include\r\n /Library/Developer/CommandLineTools/usr/lib/clang/12.0.0/include\r\n /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include\r\n /Library/Developer/CommandLineTools/usr/include\r\n /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/Frameworks (framework directory)\r\nEnd of search list.\r\n# 1 \"/dev/null\"\r\n# 1 \"<built-in>\" 1\r\n# 1 \"<built-in>\" 3\r\n# 366 \"<built-in>\" 3\r\n# 1 \"<command line>\" 1\r\n# 1 \"<built-in>\" 2\r\n# 1 \"/dev/null\" 2\r\n```",
      "created_at" : "2020-10-13T11:26:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-707675414",
      "id" : 707675414,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwNzY3NTQxNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-13T11:26:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/707675414",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Possible improvement and simplification, only requiring `set -Ux CPPFLAGS  \"-include stdlib.h\"` (bash: `export CPPFLAGS=\"-include stdlib.h\"`) before running `./contrib/install_db4.sh .`\r\n\r\nWith this method it runs successfully until:\r\n\r\n```\r\nlibtool: compile:  cc -c -I. -I/Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/.. -include stdlib.h -O3 /Users/will/src/bitcoin/db4/db-4.8.30.NC/dist/../mutex/mut_stat.c  -fno-common -DPIC -o mut_stat.o\r\nmake: *** No rule to make target `abort.o', needed by `libdb-4.8.a'.  Stop.\r\n```\r\n\r\nIt's interesting because the Makefile already includes this line which should be doing the same thing:\r\n`CPPFLAGS=Â»Â·Â·-I$(builddir) -I$(srcdir) -include stdlib.h`\r\n\r\nBranch tracking progress here: https://github.com/willcl-ark/bitcoin/tree/build_bdb_big_sur",
      "created_at" : "2020-10-13T12:16:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-707698954",
      "id" : 707698954,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwNzY5ODk1NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-13T14:44:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/707698954",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I can see that `configure.ac` is listing `abort.o` as a `LIBOBJS`, so configure thinks the system ones should be replaced:\r\n\r\n`LIBOBJS=' ${LIBOBJDIR}abort$U.o ${LIBOBJDIR}atoi$U.o ${LIBOBJDIR}atol$U.o ${LIBOBJDIR}getenv$U.o ${LIBOBJDIR}qsort$U.o ${LIBOBJDIR}rand$U.o ${LIBOBJDIR}strtol$U.o ${LIBOBJDIR}strtoul$U.o'\r\n`\r\n\r\nconfig.log shows:\r\n\r\n```\r\nconfigure:20634: checking for abort\r\nconfigure:20634: cc -o conftest -O3  -include stdlib.h  conftest.c  -lpthread >&5\r\nconftest.c:75:6: error: conflicting types for 'abort'\r\nchar abort ();\r\n     ^\r\n/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/stdlib.h:131:7: note: previous declaration is here\r\nvoid     abort(void) __cold __dead2;\r\n         ^\r\nconftest.c:86:8: error: returning 'void' from a function with incompatible result type 'int'\r\nreturn abort ();\r\n       ^~~~~~~~\r\n2 errors generated.\r\n```\r\n\r\n...which is why I assume it want to replace it.\r\n\r\n(full log section: [abort.txt](https://github.com/bitcoin/bitcoin/files/5372248/abort.txt))\r\n\r\n",
      "created_at" : "2020-10-13T14:49:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-707792716",
      "id" : 707792716,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwNzc5MjcxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-13T15:06:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/707792716",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Command line tools for Xcode 12.2 Beta 3 (Oct 13th) does not solve the issue.",
      "created_at" : "2020-10-13T20:50:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-708001588",
      "id" : 708001588,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwODAwMTU4OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-13T20:50:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/708001588",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Brew-installed clang passes the same configure tests for `abort`, `atoi`, `atol` etc.:\r\n\r\n```\r\nconfigure:20634: checking for abort\r\nconfigure:20634: /usr/local/opt/llvm/bin/clang -o conftest -O3   -L/usr/local/opt/llvm/lib -Wl,-rpath,/usr/local/opt/llvm/lib conftest.c  -lpthread >&5\r\nconftest.c:75:6: warning: incompatible redeclaration of library function 'abort' [-Wincompatible-library-redeclaration]\r\nchar abort ();\r\n     ^\r\nconftest.c:75:6: note: 'abort' is a builtin with type 'void (void) __attribute__((noreturn))'\r\n1 warning generated.\r\nconfigure:20634: $? = 0\r\nconfigure:20634: result: yes\r\nconfigure:20634: checking for atoi\r\nconfigure:20634: /usr/local/opt/llvm/bin/clang -o conftest -O3   -L/usr/local/opt/llvm/lib -Wl,-rpath,/usr/local/opt/llvm/lib conftest.c  -lpthread >&5\r\nconfigure:20634: $? = 0\r\nconfigure:20634: result: yes\r\n```\r\n\r\nvs system-installed clang (with `CPPFLAGS=\"-include stdlib.h\"`):\r\n\r\n```\r\nconfigure:20634: checking for abort\r\nconfigure:20634: cc -o conftest -O3  -I/usr/local/opt/llvm/include -include stdlib.h -L/usr/local/opt/llvm/lib -Wl,-rpath,/usr/local/opt/llvm/lib conftest.c  -lpthread >&5\r\nconftest.c:75:6: error: conflicting types for 'abort'\r\nchar abort ();\r\n     ^\r\n/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/stdlib.h:131:7: note: previous declaration is here\r\nvoid     abort(void) __cold __dead2;\r\n         ^\r\nconftest.c:86:8: error: returning 'void' from a function with incompatible result type 'int'\r\nreturn abort ();\r\n       ^~~~~~~~\r\n2 errors generated.\r\nconfigure:20634: $? = 1\r\nconfigure: failed program was:\r\n| /* confdefs.h */\r\n| #define PACKAGE_NAME \"Berkeley DB\"\r\n| #define PACKAGE_TARNAME \"db-4.8.30\"\r\n| #define PACKAGE_VERSION \"4.8.30\"\r\n| #define PACKAGE_STRING \"Berkeley DB 4.8.30\"\r\n| #define PACKAGE_BUGREPORT \"Oracle Technology Network Berkeley DB forum\"\r\n| #define PACKAGE_URL \"\"\r\n| #define HAVE_UPGRADE_SUPPORT 1\r\n| #define STDC_HEADERS 1\r\n| #define HAVE_SYS_TYPES_H 1\r\n| #define HAVE_SYS_STAT_H 1\r\n| #define HAVE_STDLIB_H 1\r\n| #define HAVE_STRING_H 1\r\n| #define HAVE_MEMORY_H 1\r\n| #define HAVE_STRINGS_H 1\r\n| #define HAVE_INTTYPES_H 1\r\n| #define HAVE_STDINT_H 1\r\n| #define HAVE_UNISTD_H 1\r\n| #define HAVE_DLFCN_H 1\r\n| #define LT_OBJDIR \".libs/\"\r\n| #define HAVE_SYSTEM_INCLUDE_FILES 1\r\n| #define TIME_WITH_SYS_TIME 1\r\n| #define HAVE_DIRENT_H 1\r\n| #define HAVE_EXECINFO_H 1\r\n| #define HAVE_SYS_SELECT_H 1\r\n| #define HAVE_SYS_SOCKET_H 1\r\n| #define HAVE_SYS_TIME_H 1\r\n| #define HAVE_STRUCT_STAT_ST_BLKSIZE 1\r\n| #define SIZEOF_CHAR 1\r\n| #define SIZEOF_UNSIGNED_CHAR 1\r\n| #define SIZEOF_SHORT 2\r\n| #define SIZEOF_UNSIGNED_SHORT 2\r\n| #define SIZEOF_INT 4\r\n| #define SIZEOF_UNSIGNED_INT 4\r\n| #define SIZEOF_LONG 8\r\n| #define SIZEOF_UNSIGNED_LONG 8\r\n| #define SIZEOF_LONG_LONG 8\r\n| #define SIZEOF_UNSIGNED_LONG_LONG 8\r\n| #define SIZEOF_CHAR_P 8\r\n| #define SIZEOF_SIZE_T 8\r\n| #define HAVE_EXIT_SUCCESS 1\r\n| #define HAVE_GETOPT_OPTRESET 1\r\n| #define HAVE_MUTEX_PTHREADS 1\r\n| #define HAVE_MUTEX_X86_64_GCC_ASSEMBLY 1\r\n| #define HAVE_MUTEX_SUPPORT 1\r\n| #define HAVE_SHARED_LATCHES 1\r\n| #define HAVE_MUTEX_HYBRID 1\r\n| #define HAVE_SIMPLE_THREAD_TYPE 1\r\n| #define HAVE_ATOMIC_SUPPORT 1\r\n| #define HAVE_ATOMIC_X86_GCC_ASSEMBLY 1\r\n| /* end confdefs.h.  */\r\n| /* Define abort to an innocuous variant, in case <limits.h> declares abort.\r\n|    For example, HP-UX 11i <limits.h> declares gettimeofday.  */\r\n| #define abort innocuous_abort\r\n| \r\n| /* System header to define __stub macros and hopefully few prototypes,\r\n|     which can conflict with char abort (); below.\r\n|     Prefer <limits.h> to <assert.h> if __STDC__ is defined, since\r\n|     <limits.h> exists even on freestanding compilers.  */\r\n| \r\n| #ifdef __STDC__\r\n| # include <limits.h>\r\n| #else\r\n| # include <assert.h>\r\n| #endif\r\n| \r\n| #undef abort\r\n| \r\n| /* Override any GCC internal prototype to avoid an error.\r\n|    Use char because int might match the return type of a GCC\r\n|    builtin and then its argument prototype would still apply.  */\r\n| #ifdef __cplusplus\r\n| extern \"C\"\r\n| #endif\r\n| char abort ();\r\n| /* The GNU C library defines this for functions which it implements\r\n|     to always fail with ENOSYS.  Some functions are actually named\r\n|     something starting with __ and the normal name is an alias.  */\r\n| #if defined __stub_abort || defined __stub___abort\r\n| choke me\r\n| #endif\r\n| \r\n| int\r\n| main ()\r\n| {\r\n| return abort ();\r\n|   ;\r\n|   return 0;\r\n| }\r\nconfigure:20634: result: no\r\nconfigure:20634: checking for atoi\r\nconfigure:20634: cc -o conftest -O3  -I/usr/local/opt/llvm/include -include stdlib.h -L/usr/local/opt/llvm/lib -Wl,-rpath,/usr/local/opt/llvm/lib conftest.c  -lpthread >&5\r\nconftest.c:75:6: error: conflicting types for 'atoi'\r\nchar atoi ();\r\n     ^\r\n/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/stdlib.h:135:6: note: previous declaration is here\r\nint      atoi(const char *);\r\n         ^\r\nconftest.c:86:14: error: too few arguments to function call, expected 1, have 0\r\nreturn atoi ();\r\n       ~~~~  ^\r\n/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/stdlib.h:135:1: note: 'atoi' declared here\r\nint      atoi(const char *);\r\n^\r\n2 errors generated.\r\nconfigure:20634: $? = 1\r\nconfigure: failed program was:\r\n| /* confdefs.h */\r\n| #define PACKAGE_NAME \"Berkeley DB\"\r\n| #define PACKAGE_TARNAME \"db-4.8.30\"\r\n| #define PACKAGE_VERSION \"4.8.30\"\r\n| #define PACKAGE_STRING \"Berkeley DB 4.8.30\"\r\n| #define PACKAGE_BUGREPORT \"Oracle Technology Network Berkeley DB forum\"\r\n| #define PACKAGE_URL \"\"\r\n| #define HAVE_UPGRADE_SUPPORT 1\r\n| #define STDC_HEADERS 1\r\n| #define HAVE_SYS_TYPES_H 1\r\n| #define HAVE_SYS_STAT_H 1\r\n| #define HAVE_STDLIB_H 1\r\n| #define HAVE_STRING_H 1\r\n| #define HAVE_MEMORY_H 1\r\n| #define HAVE_STRINGS_H 1\r\n| #define HAVE_INTTYPES_H 1\r\n| #define HAVE_STDINT_H 1\r\n| #define HAVE_UNISTD_H 1\r\n| #define HAVE_DLFCN_H 1\r\n| #define LT_OBJDIR \".libs/\"\r\n| #define HAVE_SYSTEM_INCLUDE_FILES 1\r\n| #define TIME_WITH_SYS_TIME 1\r\n| #define HAVE_DIRENT_H 1\r\n| #define HAVE_EXECINFO_H 1\r\n| #define HAVE_SYS_SELECT_H 1\r\n| #define HAVE_SYS_SOCKET_H 1\r\n| #define HAVE_SYS_TIME_H 1\r\n| #define HAVE_STRUCT_STAT_ST_BLKSIZE 1\r\n| #define SIZEOF_CHAR 1\r\n| #define SIZEOF_UNSIGNED_CHAR 1\r\n| #define SIZEOF_SHORT 2\r\n| #define SIZEOF_UNSIGNED_SHORT 2\r\n| #define SIZEOF_INT 4\r\n| #define SIZEOF_UNSIGNED_INT 4\r\n| #define SIZEOF_LONG 8\r\n| #define SIZEOF_UNSIGNED_LONG 8\r\n| #define SIZEOF_LONG_LONG 8\r\n| #define SIZEOF_UNSIGNED_LONG_LONG 8\r\n| #define SIZEOF_CHAR_P 8\r\n| #define SIZEOF_SIZE_T 8\r\n| #define HAVE_EXIT_SUCCESS 1\r\n| #define HAVE_GETOPT_OPTRESET 1\r\n| #define HAVE_MUTEX_PTHREADS 1\r\n| #define HAVE_MUTEX_X86_64_GCC_ASSEMBLY 1\r\n| #define HAVE_MUTEX_SUPPORT 1\r\n| #define HAVE_SHARED_LATCHES 1\r\n| #define HAVE_MUTEX_HYBRID 1\r\n| #define HAVE_SIMPLE_THREAD_TYPE 1\r\n| #define HAVE_ATOMIC_SUPPORT 1\r\n| #define HAVE_ATOMIC_X86_GCC_ASSEMBLY 1\r\n| /* end confdefs.h.  */\r\n| /* Define atoi to an innocuous variant, in case <limits.h> declares atoi.\r\n|    For example, HP-UX 11i <limits.h> declares gettimeofday.  */\r\n| #define atoi innocuous_atoi\r\n| \r\n| /* System header to define __stub macros and hopefully few prototypes,\r\n|     which can conflict with char atoi (); below.\r\n|     Prefer <limits.h> to <assert.h> if __STDC__ is defined, since\r\n|     <limits.h> exists even on freestanding compilers.  */\r\n| \r\n| #ifdef __STDC__\r\n| # include <limits.h>\r\n| #else\r\n| # include <assert.h>\r\n| #endif\r\n| \r\n| #undef atoi\r\n| \r\n| /* Override any GCC internal prototype to avoid an error.\r\n|    Use char because int might match the return type of a GCC\r\n|    builtin and then its argument prototype would still apply.  */\r\n| #ifdef __cplusplus\r\n| extern \"C\"\r\n| #endif\r\n| char atoi ();\r\n| /* The GNU C library defines this for functions which it implements\r\n|     to always fail with ENOSYS.  Some functions are actually named\r\n|     something starting with __ and the normal name is an alias.  */\r\n| #if defined __stub_atoi || defined __stub___atoi\r\n| choke me\r\n| #endif\r\n| \r\n| int\r\n| main ()\r\n| {\r\n| return atoi ();\r\n|   ;\r\n|   return 0;\r\n| }\r\nconfigure:20634: result: no\r\n```\r\n\r\nI think the mandatory include of <stdlib.h> in every function test is causing configure to fail on these functions where they should be replaced, perhaps patching `mutex.m4` and fixing the `DB_VERSION` error might end up being \"cleaner\"?",
      "created_at" : "2020-10-14T08:47:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19411#issuecomment-708257136",
      "id" : 708257136,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19411",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwODI1NzEzNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-14T08:47:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/708257136",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   }
]
