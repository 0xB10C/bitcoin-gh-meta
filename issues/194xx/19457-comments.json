[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19137 (wallettool: Add dump and createfromdump commands by achow101)\n* #19077 (wallet: Add sqlite as an alternative wallet database and use it for new descriptor wallets by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-07-06T19:24:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19457#issuecomment-654421452",
      "id" : 654421452,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19457",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NDQyMTQ1Mg==",
      "updated_at" : "2020-07-06T19:24:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/654421452",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19457#discussion_r450736655"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/450736655"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any reason to ask translators to waste effort when these were previously untranslated and the new translations are unused?",
      "commit_id" : "7dcb47bf89729d3959efd18a9d6808175b6b85ca",
      "created_at" : "2020-07-07T09:37:22Z",
      "diff_hunk" : "@@ -15,13 +16,13 @@ static const char *HEADER_END = \"HEADER=END\";\n static const char *DATA_END = \"DATA=END\";\n typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyValPair;\n \n-bool RecoverDatabaseFile(const fs::path& file_path)\n+bool RecoverDatabaseFile(const fs::path& file_path, bilingual_str& error, std::vector<bilingual_str>& warnings)\n {\n     std::string filename;\n     std::shared_ptr<BerkeleyEnvironment> env = GetWalletEnv(file_path, filename);\n \n     if (!env->Open(true /* retry */)) {\n-        tfm::format(std::cerr, \"Error initializing wallet database environment %s!\", env->Directory());\n+        error = strprintf(_(\"Error initializing wallet database environment %s!\"), env->Directory());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19457#discussion_r450736655",
      "id" : 450736655,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDczNjY1NQ==",
      "original_commit_id" : "e3243b232aade4b9615db247762d20b0d8d88c4a",
      "original_line" : 25,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/wallet/salvage.cpp",
      "position" : null,
      "pull_request_review_id" : 443726292,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19457",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-15T16:37:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/450736655",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19457#discussion_r450918303"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/450918303"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Since these are utility functions, we might add them to the gui in the future. Or maybe add a gui to the wallettool to make it more user friendly. I wanted to make sure that we could use these in the gui if we wanted to.",
      "commit_id" : "7dcb47bf89729d3959efd18a9d6808175b6b85ca",
      "created_at" : "2020-07-07T14:42:13Z",
      "diff_hunk" : "@@ -15,13 +16,13 @@ static const char *HEADER_END = \"HEADER=END\";\n static const char *DATA_END = \"DATA=END\";\n typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyValPair;\n \n-bool RecoverDatabaseFile(const fs::path& file_path)\n+bool RecoverDatabaseFile(const fs::path& file_path, bilingual_str& error, std::vector<bilingual_str>& warnings)\n {\n     std::string filename;\n     std::shared_ptr<BerkeleyEnvironment> env = GetWalletEnv(file_path, filename);\n \n     if (!env->Open(true /* retry */)) {\n-        tfm::format(std::cerr, \"Error initializing wallet database environment %s!\", env->Directory());\n+        error = strprintf(_(\"Error initializing wallet database environment %s!\"), env->Directory());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19457#discussion_r450918303",
      "id" : 450918303,
      "in_reply_to_id" : 450736655,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MDkxODMwMw==",
      "original_commit_id" : "e3243b232aade4b9615db247762d20b0d8d88c4a",
      "original_line" : 25,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/wallet/salvage.cpp",
      "position" : null,
      "pull_request_review_id" : 443960697,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19457",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-15T16:37:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/450918303",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19457#discussion_r455038868"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/455038868"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'd prefer to err on the side of not adding a translation message if it's not currently used. This can always be done when necessary.",
      "commit_id" : "7dcb47bf89729d3959efd18a9d6808175b6b85ca",
      "created_at" : "2020-07-15T13:11:26Z",
      "diff_hunk" : "@@ -15,13 +16,13 @@ static const char *HEADER_END = \"HEADER=END\";\n static const char *DATA_END = \"DATA=END\";\n typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyValPair;\n \n-bool RecoverDatabaseFile(const fs::path& file_path)\n+bool RecoverDatabaseFile(const fs::path& file_path, bilingual_str& error, std::vector<bilingual_str>& warnings)\n {\n     std::string filename;\n     std::shared_ptr<BerkeleyEnvironment> env = GetWalletEnv(file_path, filename);\n \n     if (!env->Open(true /* retry */)) {\n-        tfm::format(std::cerr, \"Error initializing wallet database environment %s!\", env->Directory());\n+        error = strprintf(_(\"Error initializing wallet database environment %s!\"), env->Directory());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19457#discussion_r455038868",
      "id" : 455038868,
      "in_reply_to_id" : 450736655,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTAzODg2OA==",
      "original_commit_id" : "e3243b232aade4b9615db247762d20b0d8d88c4a",
      "original_line" : 25,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/wallet/salvage.cpp",
      "position" : null,
      "pull_request_review_id" : 448936992,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19457",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-15T16:37:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/455038868",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19457#discussion_r455146536"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/455146536"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I've changed these to use `Untranslated`.",
      "commit_id" : "7dcb47bf89729d3959efd18a9d6808175b6b85ca",
      "created_at" : "2020-07-15T15:36:35Z",
      "diff_hunk" : "@@ -15,13 +16,13 @@ static const char *HEADER_END = \"HEADER=END\";\n static const char *DATA_END = \"DATA=END\";\n typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyValPair;\n \n-bool RecoverDatabaseFile(const fs::path& file_path)\n+bool RecoverDatabaseFile(const fs::path& file_path, bilingual_str& error, std::vector<bilingual_str>& warnings)\n {\n     std::string filename;\n     std::shared_ptr<BerkeleyEnvironment> env = GetWalletEnv(file_path, filename);\n \n     if (!env->Open(true /* retry */)) {\n-        tfm::format(std::cerr, \"Error initializing wallet database environment %s!\", env->Directory());\n+        error = strprintf(_(\"Error initializing wallet database environment %s!\"), env->Directory());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19457#discussion_r455146536",
      "id" : 455146536,
      "in_reply_to_id" : 450736655,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1NTE0NjUzNg==",
      "original_commit_id" : "e3243b232aade4b9615db247762d20b0d8d88c4a",
      "original_line" : 25,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/wallet/salvage.cpp",
      "position" : null,
      "pull_request_review_id" : 449079160,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19457",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-15T16:37:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/455146536",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19457#discussion_r458546966"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/458546966"
         }
      },
      "author_association" : "MEMBER",
      "body" : "style nit in commit \"wallettool: ...\"\r\n\r\nA range based for loop does not need to be guarded by a size check, so you can remove the `if (warnings.size() > 0)`",
      "commit_id" : "7dcb47bf89729d3959efd18a9d6808175b6b85ca",
      "created_at" : "2020-07-22T05:41:22Z",
      "diff_hunk" : "@@ -147,7 +126,20 @@ bool ExecuteWalletToolFunc(const std::string& command, const std::string& name)\n             WalletShowInfo(wallet_instance.get());\n             wallet_instance->Flush(true);\n         } else if (command == \"salvage\") {\n-            return SalvageWallet(path);\n+            bilingual_str error;\n+            std::vector<bilingual_str> warnings;\n+            bool ret = RecoverDatabaseFile(path, error, warnings);\n+            if (!ret) {\n+                if (warnings.size() > 0) {\n+                    for (const auto warning : warnings) {\n+                        tfm::format(std::cerr, \"%s\\n\", warning.original);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19457#discussion_r458546966",
      "id" : 458546966,
      "line" : 135,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODU0Njk2Ng==",
      "original_commit_id" : "7dcb47bf89729d3959efd18a9d6808175b6b85ca",
      "original_line" : 135,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/wallet/wallettool.cpp",
      "position" : 39,
      "pull_request_review_id" : 453008867,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19457",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-22T05:42:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/458546966",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
