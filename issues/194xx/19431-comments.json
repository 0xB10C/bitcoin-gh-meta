[
   {
      "author_association" : "MEMBER",
      "body" : "@sipsorcery Any thoughts on this?\r\n\r\nAlso, unrelated, I was wondering how to enable C++17 in appveyor. I.e. how to pass down this option: https://docs.microsoft.com/en-us/cpp/build/reference/std-specify-language-standard-version?view=vs-2019",
      "created_at" : "2020-07-02T13:17:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19431#issuecomment-653000287",
      "id" : 653000287,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19431",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1MzAwMDI4Nw==",
      "updated_at" : "2020-07-02T13:17:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/653000287",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke the appveyor cache is being used to store dependencies not the build results:\r\n\r\n````\r\ncache:\r\n- C:\\tools\\vcpkg\\installed -> build_msvc\\vcpkg-packages.txt\r\n- C:\\Qt5.9.8_x64_static_vs2019\r\n````\r\n\r\nIf the cache is wiped out by setting `APPVEYOR_SAVE_CACHE_ON_ERROR: false` then the next build after a failure will have to restore all the dependencies. This will more than likely result in the build never being able to complete since restoring dependencies, building Bitcoin Core and running the tests is unlikely to fit within the appveyor time limit (depending on what the time limit currently allocated to Bitcoin Core is). I'd strongly advise against merging this change. After the first failed build it's likely all subsequent appveyor builds will fail with a timeout.\r\n\r\nAt one point [clcache](https://github.com/frerich/clcache) was used to cache the build results but during my testing I was never convinced it reduced the build time (the project seems to be discontinued now so perhaps I wasn't the only one with that finding).\r\n\r\nFor the C++17 build it will need a compiler option set in `common.init.vcxproj`. I can test and submit a PR for that if you like? I can remove the `CLCACHE_SERVER: 1` variable at the same time.",
      "created_at" : "2020-07-02T20:46:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19431#issuecomment-653212928",
      "id" : 653212928,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19431",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1MzIxMjkyOA==",
      "updated_at" : "2020-07-02T20:46:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/653212928",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/197660?v=4",
         "events_url" : "https://api.github.com/users/sipsorcery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipsorcery/followers",
         "following_url" : "https://api.github.com/users/sipsorcery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipsorcery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipsorcery",
         "id" : 197660,
         "login" : "sipsorcery",
         "node_id" : "MDQ6VXNlcjE5NzY2MA==",
         "organizations_url" : "https://api.github.com/users/sipsorcery/orgs",
         "received_events_url" : "https://api.github.com/users/sipsorcery/received_events",
         "repos_url" : "https://api.github.com/users/sipsorcery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipsorcery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipsorcery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipsorcery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> This will more than likely result in the build never being able to complete\r\n\r\nI have concluded the opposite:\r\n\r\n* The same cache is wiped when `build_msvc/vcpkg-packages.txt` changes. So if builds never could succeed from scratch, then how did we get the first compilation to finish? Or how could we change packages in the future if the cache never gets invalidated?\r\n* If a build times out, why would there be any time to upload the cache? I think `APPVEYOR_SAVE_CACHE_ON_ERROR` refers to a build or test error, not a timeout.\r\n* This morning a pull request failed to build and seemingly corrupted the cache. See the picture and links below.\r\n\r\nFirst failure (pull): https://ci.appveyor.com/project/DrahtBot/bitcoin/builds/33856815\r\nFirst passing build (The pull that fixed it by removing the cache): https://ci.appveyor.com/project/DrahtBot/bitcoin/builds/33867492\r\n\r\nInterestingly the first passing build with the invalidated cache took the same time to build as it takes other builds to run, so maybe the cache is not needed after all?\r\n\r\n![Screenshot_2020-07-02 Bitcoin Core - AppVeyor](https://user-images.githubusercontent.com/6399679/86409390-c7af1080-bc86-11ea-8753-06e028bd8968.png)\r\n",
      "created_at" : "2020-07-02T21:15:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19431#issuecomment-653223434",
      "id" : 653223434,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19431",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1MzIyMzQzNA==",
      "updated_at" : "2020-07-02T21:15:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/653223434",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
