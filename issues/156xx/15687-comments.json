[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15687#discussion_r270115880"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15687"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270115880"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Use single quotes here like the rest of the file.",
      "commit_id" : "6d9b033e3d2261d753f29b8c970583978c595430",
      "created_at" : "2019-03-28T17:26:08Z",
      "diff_hunk" : "@@ -36,8 +39,29 @@ def assert_tool_output(self, output, *args):\n         assert_equal(stderr, '')\n         assert_equal(stdout, output)\n \n-    def run_test(self):\n+    def wallet_path(self):\n+        return os.path.join(self.nodes[0].datadir, \"regtest\", \"wallets\", \"wallet.dat\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15687#discussion_r270115880",
      "id" : 270115880,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDExNTg4MA==",
      "original_commit_id" : "6d9b033e3d2261d753f29b8c970583978c595430",
      "original_position" : 22,
      "path" : "test/functional/tool_wallet.py",
      "position" : 22,
      "pull_request_review_id" : 220167521,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15687",
      "updated_at" : "2019-03-28T17:26:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270115880",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15424](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15424.html) ([wallet] wallet-tool: command to remove key metadata by Sjors)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-03-28T18:48:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15687#issuecomment-477725049",
      "id" : 477725049,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15687",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3NzcyNTA0OQ==",
      "updated_at" : "2019-03-28T18:48:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/477725049",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15687#discussion_r270194549"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15687"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270194549"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: instead of logging the timestamps and whether they changed, you might use `assert_equal` (or explicitly comment it out, if it currently fails)",
      "commit_id" : "6d9b033e3d2261d753f29b8c970583978c595430",
      "created_at" : "2019-03-28T20:52:32Z",
      "diff_hunk" : "@@ -36,8 +39,29 @@ def assert_tool_output(self, output, *args):\n         assert_equal(stderr, '')\n         assert_equal(stdout, output)\n \n-    def run_test(self):\n+    def wallet_path(self):\n+        return os.path.join(self.nodes[0].datadir, \"regtest\", \"wallets\", \"wallet.dat\")\n+\n+    def wallet_shasum(self):\n+        h = hashlib.sha1()\n+        ba = bytearray(128*1024)\n+        mv = memoryview(ba)\n+        with open(self.wallet_path(), 'rb', buffering=0) as f:\n+            for n in iter(lambda : f.readinto(mv), 0):\n+                h.update(mv[:n])\n+        return h.hexdigest()\n+\n+    def wallet_timestamp(self, op):\n+        timestamp = os.path.getmtime(self.wallet_path())\n+        self.log.info('Wallet file timestamp {0}: {1}'.format(op, timestamp))\n+        return timestamp\n \n+    def log_wallet_timestamp_comparison(self, new, old):\n+        result = 'unchanged' if new == old else 'increased! **FIX ME**'\n+        self.log.info('Wallet file timestamp {0}\\n'.format(result))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15687#discussion_r270194549",
      "id" : 270194549,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDE5NDU0OQ==",
      "original_commit_id" : "6d9b033e3d2261d753f29b8c970583978c595430",
      "original_position" : 40,
      "path" : "test/functional/tool_wallet.py",
      "position" : 40,
      "pull_request_review_id" : 220267894,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15687",
      "updated_at" : "2019-03-28T20:52:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270194549",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15687#discussion_r270194858"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15687"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270194858"
         }
      },
      "author_association" : "MEMBER",
      "body" : "TODO's shouldn't be logged, but added as inline comments",
      "commit_id" : "6d9b033e3d2261d753f29b8c970583978c595430",
      "created_at" : "2019-03-28T20:53:28Z",
      "diff_hunk" : "@@ -46,9 +70,23 @@ def run_test(self):\n         self.assert_raises_tool_error('Error loading wallet.dat. Is wallet being used by other process?', '-wallet=wallet.dat', 'info')\n         self.assert_raises_tool_error('Error: no wallet file at nonexistent.dat', '-wallet=nonexistent.dat', 'info')\n \n-        # stop the node to close the wallet to call info command\n+        # Stop the node to close the wallet to call the info command.\n+        self.log.info('Stop node\\n')\n         self.stop_node(0)\n \n+        # Wallet tool info should work with wallet file permissions set to read-only.\n+        # This needs to be fixed.\n+        self.log.info('Set wallet file permissions to read-only')\n+        os.chmod(self.wallet_path(), 0o400)\n+        self.log.info('Call wallet tool info')\n+        self.assert_raises_tool_error('Error loading . Is wallet being used by another process?', 'info')\n+        self.log.info('Wallet tool info command raises loading error! **FIX ME**')",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15687#discussion_r270194858",
      "id" : 270194858,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDE5NDg1OA==",
      "original_commit_id" : "6d9b033e3d2261d753f29b8c970583978c595430",
      "original_position" : 62,
      "path" : "test/functional/tool_wallet.py",
      "position" : 62,
      "pull_request_review_id" : 220268348,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15687",
      "updated_at" : "2019-03-28T20:53:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270194858",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
