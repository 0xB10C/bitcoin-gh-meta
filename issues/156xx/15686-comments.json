[
   {
      "author_association" : "MEMBER",
      "body" : "Very nice! Do you have any numbers to share? :-)",
      "created_at" : "2019-03-28T16:51:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15686#issuecomment-477680634",
      "id" : 477680634,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15686",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3NzY4MDYzNA==",
      "updated_at" : "2019-03-28T16:51:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/477680634",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Very nice! Do you have any numbers to share? :-)\r\n\r\n~30 minutes -> ~4 minutes on my machine.\r\n\r\n(I should have mentioned that this is #10591 resurrected)",
      "created_at" : "2019-03-28T16:59:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15686#issuecomment-477683462",
      "id" : 477683462,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15686",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3NzY4MzQ2Mg==",
      "updated_at" : "2019-03-28T16:59:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/477683462",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15686#discussion_r270127761"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15686"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270127761"
         }
      },
      "author_association" : "MEMBER",
      "body" : "one hand clapping: can a coinbase tx ever be \"non-standard\"? :) ",
      "commit_id" : "3ce84d764f28c17faa790fc9ff038626a9291a3b",
      "created_at" : "2019-03-28T17:52:28Z",
      "diff_hunk" : "@@ -21,19 +24,60 @@\n # compatible with pruning based on key creation time.\n TIMESTAMP_WINDOW = 2 * 60 * 60\n \n+def mine_large_blocks(node, n):\n+    # Make a large scriptsig for the coinbase transaction. This is OP_RETURN\n+    # followed by 950k of OP_NOP. This is a non-standard transaction but it",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15686#discussion_r270127761",
      "id" : 270127761,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDEyNzc2MQ==",
      "original_commit_id" : "3ce84d764f28c17faa790fc9ff038626a9291a3b",
      "original_position" : 24,
      "path" : "test/functional/feature_pruning.py",
      "position" : 24,
      "pull_request_review_id" : 220182126,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15686",
      "updated_at" : "2019-03-28T17:52:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270127761",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15686#discussion_r270129390"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15686"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270129390"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`block_hex`? I also think a simple `.hex()` is kosher on master now(or at least I see many incantations of it!)",
      "commit_id" : "3ce84d764f28c17faa790fc9ff038626a9291a3b",
      "created_at" : "2019-03-28T17:56:04Z",
      "diff_hunk" : "@@ -21,19 +24,60 @@\n # compatible with pruning based on key creation time.\n TIMESTAMP_WINDOW = 2 * 60 * 60\n \n+def mine_large_blocks(node, n):\n+    # Make a large scriptsig for the coinbase transaction. This is OP_RETURN\n+    # followed by 950k of OP_NOP. This is a non-standard transaction but it\n+    # is consensus valid.\n+    # This could probably be made faster by submitting the block over P2P.\n+\n+    # Get the block parameters for the first block\n+    big_script = CScript([OP_RETURN] + [OP_NOP] * 950000)\n+    best_block = node.getblock(node.getbestblockhash())\n+    height = int(best_block[\"height\"]) + 1\n+    try:\n+        # Static variable ensures that time is monotonicly increasing and is therefore\n+        # different for each block created => blockhash is unique.\n+        mine_large_blocks.nTime = min(mine_large_blocks.nTime, int(best_block[\"time\"])) + 1\n+    except AttributeError:\n+        mine_large_blocks.nTime = int(best_block[\"time\"]) + 1\n+    previousblockhash = int(best_block[\"hash\"], 16)\n+\n+    for _ in range(n):\n+        # Build the coinbase transaction (with large scriptsig)\n+        coinbase_tx = create_coinbase(height)\n+        coinbase_tx.vin[0].nSequence = 2 ** 32 - 1\n+        coinbase_tx.vout[0].scriptPubKey = big_script\n+        coinbase_tx.rehash()\n+\n+        # Build the block\n+        block = CBlock()\n+        block.nVersion = best_block[\"version\"]\n+        block.hashPrevBlock = previousblockhash\n+        block.nTime = mine_large_blocks.nTime\n+        block.nBits = int('207fffff', 16)\n+        block.nNonce = 0\n+        block.vtx = [coinbase_tx]\n+        block.hashMerkleRoot = block.calc_merkle_root()\n+        block.solve()\n+        block_binary = (b2a_hex(block.serialize()).decode('ascii'))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15686#discussion_r270129390",
      "id" : 270129390,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDEyOTM5MA==",
      "original_commit_id" : "3ce84d764f28c17faa790fc9ff038626a9291a3b",
      "original_position" : 57,
      "path" : "test/functional/feature_pruning.py",
      "position" : 57,
      "pull_request_review_id" : 220184189,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15686",
      "updated_at" : "2019-03-28T18:12:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270129390",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15686#discussion_r270132578"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15686"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270132578"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think all coinbases are \"non-standard\", since we never relay them. :)",
      "commit_id" : "3ce84d764f28c17faa790fc9ff038626a9291a3b",
      "created_at" : "2019-03-28T18:03:32Z",
      "diff_hunk" : "@@ -21,19 +24,60 @@\n # compatible with pruning based on key creation time.\n TIMESTAMP_WINDOW = 2 * 60 * 60\n \n+def mine_large_blocks(node, n):\n+    # Make a large scriptsig for the coinbase transaction. This is OP_RETURN\n+    # followed by 950k of OP_NOP. This is a non-standard transaction but it",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15686#discussion_r270132578",
      "id" : 270132578,
      "in_reply_to_id" : 270127761,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDEzMjU3OA==",
      "original_commit_id" : "3ce84d764f28c17faa790fc9ff038626a9291a3b",
      "original_position" : 24,
      "path" : "test/functional/feature_pruning.py",
      "position" : 24,
      "pull_request_review_id" : 220188362,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15686",
      "updated_at" : "2019-03-28T18:03:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270132578",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15686#discussion_r270132660"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15686"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270132660"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Also just as test belt and suspenders, make sure the blocks you are making are actually the size you think they are:\r\n\r\n`assert_greater_than(len(block_hex), len(big_script)*2)`\r\n\r\nor there abouts",
      "commit_id" : "3ce84d764f28c17faa790fc9ff038626a9291a3b",
      "created_at" : "2019-03-28T18:03:43Z",
      "diff_hunk" : "@@ -21,19 +24,60 @@\n # compatible with pruning based on key creation time.\n TIMESTAMP_WINDOW = 2 * 60 * 60\n \n+def mine_large_blocks(node, n):\n+    # Make a large scriptsig for the coinbase transaction. This is OP_RETURN\n+    # followed by 950k of OP_NOP. This is a non-standard transaction but it\n+    # is consensus valid.\n+    # This could probably be made faster by submitting the block over P2P.\n+\n+    # Get the block parameters for the first block\n+    big_script = CScript([OP_RETURN] + [OP_NOP] * 950000)\n+    best_block = node.getblock(node.getbestblockhash())\n+    height = int(best_block[\"height\"]) + 1\n+    try:\n+        # Static variable ensures that time is monotonicly increasing and is therefore\n+        # different for each block created => blockhash is unique.\n+        mine_large_blocks.nTime = min(mine_large_blocks.nTime, int(best_block[\"time\"])) + 1\n+    except AttributeError:\n+        mine_large_blocks.nTime = int(best_block[\"time\"]) + 1\n+    previousblockhash = int(best_block[\"hash\"], 16)\n+\n+    for _ in range(n):\n+        # Build the coinbase transaction (with large scriptsig)\n+        coinbase_tx = create_coinbase(height)\n+        coinbase_tx.vin[0].nSequence = 2 ** 32 - 1\n+        coinbase_tx.vout[0].scriptPubKey = big_script\n+        coinbase_tx.rehash()\n+\n+        # Build the block\n+        block = CBlock()\n+        block.nVersion = best_block[\"version\"]\n+        block.hashPrevBlock = previousblockhash\n+        block.nTime = mine_large_blocks.nTime\n+        block.nBits = int('207fffff', 16)\n+        block.nNonce = 0\n+        block.vtx = [coinbase_tx]\n+        block.hashMerkleRoot = block.calc_merkle_root()\n+        block.solve()\n+        block_binary = (b2a_hex(block.serialize()).decode('ascii'))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15686#discussion_r270132660",
      "id" : 270132660,
      "in_reply_to_id" : 270129390,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDEzMjY2MA==",
      "original_commit_id" : "3ce84d764f28c17faa790fc9ff038626a9291a3b",
      "original_position" : 57,
      "path" : "test/functional/feature_pruning.py",
      "position" : 57,
      "pull_request_review_id" : 220184189,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15686",
      "updated_at" : "2019-03-28T18:12:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270132660",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   }
]
