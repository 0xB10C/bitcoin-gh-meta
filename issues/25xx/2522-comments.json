[
   {
      "body" : "Seems people are experiencing the same problem on other Unixes. It's not just MacOSX:\r\nhttps://code.google.com/p/leveldb/issues/detail?id=60\r\n\r\nInterestingly, Mike Hearn already mentions this problem in his first post about using LevelDB for Bitcoin:\r\n\r\n    Another gotcha was the number of file descriptors, LevelDB defaults to\r\n    1000 per DB. We originally used multiple DBs, one for each of the\r\n    indices, but it was easy enough to combine everything into one table,\r\n    thereby solving the fd issue. (Lowering the file descriptor limit also\r\n    works of course, but if you lower it too much, LevelDB will start to\r\n    spend a lot of time opening and closing files, so I believe combining\r\n    your tables into one is the better option.)\r\n\r\n1000 is still too many even on Linux, as Bitcoin potentially uses lots of FDs for the network connections as well, both P2P and RPC.\r\n\r\nChanging the limit per database is a matter of setting `options.max_open_files` where the database is created. What would be a safe number? \r\n\r\nMaybe it would it be an idea to query the OS's limit using ulimit, then set it to a percentage of that? This leaves the number of allowed FDs as a tuning knob to the user on the OS level.",
      "created_at" : "2013-04-14T08:28:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2522#issuecomment-16347743",
      "id" : 16347743,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2522",
      "updated_at" : "2013-04-14T08:28:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/16347743",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Anyone feel like benchmarking with options.max_open_files set to 50 or 100 or so? My guess: no difference.",
      "created_at" : "2013-04-23T20:42:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2522#issuecomment-16885083",
      "id" : 16885083,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2522",
      "updated_at" : "2013-04-23T20:42:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/16885083",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Closed via #2557 and #2568 ",
      "created_at" : "2013-04-29T23:28:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2522#issuecomment-17201087",
      "id" : 17201087,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2522",
      "updated_at" : "2013-04-29T23:28:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/17201087",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
