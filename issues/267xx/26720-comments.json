[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26661](https://github.com/bitcoin/bitcoin/pull/26661) (wallet: Coin Selection, return accurate error messages by furszy)\n* [#25982](https://github.com/bitcoin/bitcoin/pull/25982) (wallet: Guard against undefined behaviour by yancyribbens)\n* [#25806](https://github.com/bitcoin/bitcoin/pull/25806) (wallet: group outputs only once, decouple it from Coin Selection by furszy)\n* [#23475](https://github.com/bitcoin/bitcoin/pull/23475) (wallet: add config to prioritize a solution that doesn't create change in coin selection by brunoerg)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-12-18T14:02:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26720#issuecomment-1356805855",
      "id" : 1356805855,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26720",
      "node_id" : "IC_kwDOABII585Q3zbf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1356805855/reactions"
      },
      "updated_at" : "2022-12-24T20:52:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1356805855",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-01-04T00:26:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26720#issuecomment-1370359536",
      "id" : 1370359536,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26720",
      "node_id" : "IC_kwDOABII585Rrgbw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1370359536/reactions"
      },
      "updated_at" : "2023-01-04T00:26:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1370359536",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26720#discussion_r1067478225"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26720"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067478225"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm not sure I get how that else branch is reached. Is `util::Error()` falsy?",
      "commit_id" : "4c249f83f436dac93a78e61495bc523e6ba3685e",
      "created_at" : "2023-01-11T21:34:01Z",
      "diff_hunk" : "@@ -544,27 +544,36 @@ util::Result<SelectionResult> ChooseSelectionResult(const CWallet& wallet, const\n {\n     // Vector of results. We will choose the best one based on waste.\n     std::vector<SelectionResult> results;\n+    std::vector<util::Result<SelectionResult>> errors;\n+    auto append_error = [&] (const util::Result<SelectionResult>& result) {\n+        // If any specific error message appears here, then something different from a simple \"no selection found\" happened.\n+        // Let's save it, so it can be retrieved to the user if no other selection algorithm succeeded.\n+        if (HasErrorMsg(result)) {\n+            errors.emplace_back(result);\n+        }\n+    };\n \n     std::vector<OutputGroup> positive_groups = GroupOutputs(wallet, available_coins, coin_selection_params, eligibility_filter, /*positive_only=*/true);\n     if (auto bnb_result{SelectCoinsBnB(positive_groups, nTargetValue, coin_selection_params.m_cost_of_change)}) {\n         results.push_back(*bnb_result);\n-    }\n+    } else append_error(bnb_result);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26720#discussion_r1067478225",
      "id" : 1067478225,
      "line" : 562,
      "node_id" : "PRRC_kwDOABII584_oGzR",
      "original_commit_id" : "56f0c212d245c3a65e57891cf8f4a2c26aa05ef0",
      "original_line" : 559,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 17,
      "pull_request_review_id" : 1244644716,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26720",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067478225/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-01-11T22:10:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067478225",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26720#discussion_r1067487616"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26720"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067487616"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this introduces a low chance failure of the test. The feerate is 0 which means that input sets with multiple inputs have a better waste score than one with only one input. It seems to me that all coin selection algorithms are being run, so if SRD finds a solution with 675 or fewer inputs, it should get preferred. While I agree that SRD should be improved in that we should curb excessive input sets like this, I think the test was correct previously and is incorrect now.",
      "commit_id" : "4c249f83f436dac93a78e61495bc523e6ba3685e",
      "created_at" : "2023-01-11T21:45:32Z",
      "diff_hunk" : "@@ -997,7 +1005,10 @@ BOOST_AUTO_TEST_CASE(check_max_weight)\n             chain, m_args);\n \n         BOOST_CHECK(result);\n-        BOOST_CHECK(has_coin(result->GetInputSet(), CAmount(50 * COIN)));\n+        // Verify that only the 50 BTC UTXO was selected\n+        const auto& selection_res = result->GetInputSet();\n+        BOOST_CHECK(selection_res.size() == 1);\n+        BOOST_CHECK(selection_res.begin()->GetEffectiveValue() == 50 * COIN);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26720#discussion_r1067487616",
      "id" : 1067487616,
      "line" : 1017,
      "node_id" : "PRRC_kwDOABII584_oJGA",
      "original_commit_id" : "595cbc02f4b95502d46dacc0258fa31f033fb09b",
      "original_line" : 1011,
      "original_position" : 23,
      "original_start_line" : 1000,
      "path" : "src/wallet/test/coinselector_tests.cpp",
      "position" : 23,
      "pull_request_review_id" : 1244644716,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26720",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067487616/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1000,
      "start_side" : "LEFT",
      "updated_at" : "2023-01-11T22:10:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067487616",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26720#discussion_r1067491914"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26720"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067491914"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "A better way to improve SRD would perhaps be to keep all the selected inputs in a min-effective-value heap, and to kick out the least valuable inputs while the selected weight exceeds max_weight during selection.",
      "commit_id" : "4c249f83f436dac93a78e61495bc523e6ba3685e",
      "created_at" : "2023-01-11T21:51:31Z",
      "diff_hunk" : "@@ -188,9 +189,16 @@ util::Result<SelectionResult> SelectCoinsSRD(const std::vector<OutputGroup>& utx\n     Shuffle(indexes.begin(), indexes.end(), rng);\n \n     CAmount selected_eff_value = 0;\n+    int weight = 0;\n     for (const size_t i : indexes) {\n         const OutputGroup& group = utxo_pool.at(i);\n         Assume(group.GetSelectionAmount() > 0);\n+\n+        // If the selection weight exceeds the maximum allowed size, the random selection failed.\n+        weight += group.m_weight;\n+        if (weight > max_weight) return ErrorMaxWeightExceeded();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26720#discussion_r1067491914",
      "id" : 1067491914,
      "line" : 210,
      "node_id" : "PRRC_kwDOABII584_oKJK",
      "original_commit_id" : "d1f67afc60962c59ff1873a2e3915d4f00b46e61",
      "original_line" : 199,
      "original_position" : 21,
      "original_start_line" : 198,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 21,
      "pull_request_review_id" : 1244644716,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26720",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067491914/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 209,
      "start_side" : "RIGHT",
      "updated_at" : "2023-01-11T22:10:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067491914",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26720#discussion_r1067501918"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26720"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067501918"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "We should not continue searching a subtree when the selection already exceeds the `max_weight`. Instead of only checking it when we have selected sufficient funds, I would add `curr_selection_weight > max_weight` as a backtrack reason before `else if (curr_value >= selection_target)`:\r\n\r\n        if (curr_value + curr_available_value < selection_target || // Cannot possibly reach target with the amount remaining in the curr_available_value.\r\n            curr_value > selection_target + cost_of_change || // Selected value is out of range, go back and try other branch\r\n            (curr_waste > best_waste && is_feerate_high)) { // Don't select things which we know will be more wasteful if the waste is increasing\r\n            backtrack = true;\r\n        } else if (curr_selection_weight > max_weight) { // Exceeding weight for standard tx, cannot find more solutions by adding more inputs\r\n            max_tx_size_exceeded = true; // at least one selection attempt exceeded the max weight\r\n            backtrack = true;\r\n        } else if (curr_value >= selection_target) {       // Selected value is within range\r\n",
      "commit_id" : "4c249f83f436dac93a78e61495bc523e6ba3685e",
      "created_at" : "2023-01-11T22:05:23Z",
      "diff_hunk" : "@@ -105,8 +115,14 @@ std::optional<SelectionResult> SelectCoinsBnB(std::vector<OutputGroup>& utxo_poo\n             // value. Adding any more UTXOs will be just burning the UTXO; it will go entirely to fees. Thus we aren't going to\n             // explore any more UTXOs to avoid burning money like that.\n             if (curr_waste <= best_waste) {\n-                best_selection = curr_selection;\n-                best_waste = curr_waste;\n+                // Don't add the selection if the max weight was exceeded\n+                if (curr_selection_weight > max_weight) {\n+                    max_tx_size_exceeded = true; // at least one result exceeds the max weight\n+                } else {\n+                    // Set best selection\n+                    best_selection = curr_selection;\n+                    best_waste = curr_waste;\n+                }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26720#discussion_r1067501918",
      "id" : 1067501918,
      "line" : 125,
      "node_id" : "PRRC_kwDOABII584_oMle",
      "original_commit_id" : "4c249f83f436dac93a78e61495bc523e6ba3685e",
      "original_line" : 125,
      "original_position" : 59,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 59,
      "pull_request_review_id" : 1244644716,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26720",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067501918/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-01-11T22:10:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067501918",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26720#discussion_r1067557383"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26720"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067557383"
         }
      },
      "author_association" : "MEMBER",
      "body" : "yeah. Internally the result class contains a variant and the bool operator returns true/false depending on what the variant is holding.\r\n\r\nsmall extra note: this will look much better after #25806.",
      "commit_id" : "4c249f83f436dac93a78e61495bc523e6ba3685e",
      "created_at" : "2023-01-11T23:22:06Z",
      "diff_hunk" : "@@ -544,27 +544,36 @@ util::Result<SelectionResult> ChooseSelectionResult(const CWallet& wallet, const\n {\n     // Vector of results. We will choose the best one based on waste.\n     std::vector<SelectionResult> results;\n+    std::vector<util::Result<SelectionResult>> errors;\n+    auto append_error = [&] (const util::Result<SelectionResult>& result) {\n+        // If any specific error message appears here, then something different from a simple \"no selection found\" happened.\n+        // Let's save it, so it can be retrieved to the user if no other selection algorithm succeeded.\n+        if (HasErrorMsg(result)) {\n+            errors.emplace_back(result);\n+        }\n+    };\n \n     std::vector<OutputGroup> positive_groups = GroupOutputs(wallet, available_coins, coin_selection_params, eligibility_filter, /*positive_only=*/true);\n     if (auto bnb_result{SelectCoinsBnB(positive_groups, nTargetValue, coin_selection_params.m_cost_of_change)}) {\n         results.push_back(*bnb_result);\n-    }\n+    } else append_error(bnb_result);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26720#discussion_r1067557383",
      "id" : 1067557383,
      "in_reply_to_id" : 1067478225,
      "line" : 562,
      "node_id" : "PRRC_kwDOABII584_oaIH",
      "original_commit_id" : "56f0c212d245c3a65e57891cf8f4a2c26aa05ef0",
      "original_line" : 559,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 17,
      "pull_request_review_id" : 1244760755,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26720",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067557383/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-01-11T23:23:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067557383",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26720#discussion_r1067634860"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26720"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067634860"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah cool, thanks for explaining",
      "commit_id" : "4c249f83f436dac93a78e61495bc523e6ba3685e",
      "created_at" : "2023-01-12T02:09:36Z",
      "diff_hunk" : "@@ -544,27 +544,36 @@ util::Result<SelectionResult> ChooseSelectionResult(const CWallet& wallet, const\n {\n     // Vector of results. We will choose the best one based on waste.\n     std::vector<SelectionResult> results;\n+    std::vector<util::Result<SelectionResult>> errors;\n+    auto append_error = [&] (const util::Result<SelectionResult>& result) {\n+        // If any specific error message appears here, then something different from a simple \"no selection found\" happened.\n+        // Let's save it, so it can be retrieved to the user if no other selection algorithm succeeded.\n+        if (HasErrorMsg(result)) {\n+            errors.emplace_back(result);\n+        }\n+    };\n \n     std::vector<OutputGroup> positive_groups = GroupOutputs(wallet, available_coins, coin_selection_params, eligibility_filter, /*positive_only=*/true);\n     if (auto bnb_result{SelectCoinsBnB(positive_groups, nTargetValue, coin_selection_params.m_cost_of_change)}) {\n         results.push_back(*bnb_result);\n-    }\n+    } else append_error(bnb_result);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26720#discussion_r1067634860",
      "id" : 1067634860,
      "in_reply_to_id" : 1067478225,
      "line" : 562,
      "node_id" : "PRRC_kwDOABII584_otCs",
      "original_commit_id" : "56f0c212d245c3a65e57891cf8f4a2c26aa05ef0",
      "original_line" : 559,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 17,
      "pull_request_review_id" : 1244865844,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26720",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067634860/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-01-12T02:09:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1067634860",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   }
]
