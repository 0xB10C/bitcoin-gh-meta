[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12151#discussion_r161026738"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12151"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161026738"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why? You can just do a GetAncestor for blockindex->nHeight here, no?",
      "commit_id" : "f88df2e9c986ff49f9bf5c13838087ba0ef96858",
      "created_at" : "2018-01-11T17:46:47Z",
      "diff_hunk" : "@@ -78,20 +78,22 @@ double GetDifficulty(const CChain& chain, const CBlockIndex* blockindex)\n     return dDiff;\n }\n \n-double GetDifficulty(const CBlockIndex* blockindex)\n+static int ComputeBlockConfirmations(const CBlockIndex* tip, const CBlockIndex* blockindex, const CBlockIndex*& next)\n {\n-    return GetDifficulty(chainActive, blockindex);\n+    next = tip->GetAncestor(blockindex->nHeight + 1);\n+    if (next && next->pprev == blockindex) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12151#discussion_r161026738",
      "id" : 161026738,
      "original_commit_id" : "f88df2e9c986ff49f9bf5c13838087ba0ef96858",
      "original_position" : 27,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 27,
      "pull_request_review_id" : 88248888,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12151",
      "updated_at" : "2018-01-11T17:49:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161026738",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12151#discussion_r161027116"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12151"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161027116"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "No need to change these unless you're gonna actually kill the cs_main held for the whole time, I'd think, no (and little reason to, its not like its being held for an extended period)?",
      "commit_id" : "f88df2e9c986ff49f9bf5c13838087ba0ef96858",
      "created_at" : "2018-01-11T17:48:15Z",
      "diff_hunk" : "@@ -1185,20 +1182,21 @@ UniValue getblockchaininfo(const JSONRPCRequest& request)\n \n     LOCK(cs_main);\n \n+    const CBlockIndex* tip = chainActive.Tip();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12151#discussion_r161027116",
      "id" : 161027116,
      "original_commit_id" : "f88df2e9c986ff49f9bf5c13838087ba0ef96858",
      "original_position" : 143,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 143,
      "pull_request_review_id" : 88248888,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12151",
      "updated_at" : "2018-01-11T17:49:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161027116",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12151#discussion_r161034204"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12151"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161034204"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This way you get next of blockindex.",
      "commit_id" : "f88df2e9c986ff49f9bf5c13838087ba0ef96858",
      "created_at" : "2018-01-11T18:16:44Z",
      "diff_hunk" : "@@ -78,20 +78,22 @@ double GetDifficulty(const CChain& chain, const CBlockIndex* blockindex)\n     return dDiff;\n }\n \n-double GetDifficulty(const CBlockIndex* blockindex)\n+static int ComputeBlockConfirmations(const CBlockIndex* tip, const CBlockIndex* blockindex, const CBlockIndex*& next)\n {\n-    return GetDifficulty(chainActive, blockindex);\n+    next = tip->GetAncestor(blockindex->nHeight + 1);\n+    if (next && next->pprev == blockindex) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12151#discussion_r161034204",
      "id" : 161034204,
      "in_reply_to_id" : 161026738,
      "original_commit_id" : "f88df2e9c986ff49f9bf5c13838087ba0ef96858",
      "original_position" : 27,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 27,
      "pull_request_review_id" : 88257771,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12151",
      "updated_at" : "2018-01-11T18:16:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161034204",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12151#discussion_r161034615"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12151"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161034615"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This moves up tip variable declared below.",
      "commit_id" : "f88df2e9c986ff49f9bf5c13838087ba0ef96858",
      "created_at" : "2018-01-11T18:18:13Z",
      "diff_hunk" : "@@ -1185,20 +1182,21 @@ UniValue getblockchaininfo(const JSONRPCRequest& request)\n \n     LOCK(cs_main);\n \n+    const CBlockIndex* tip = chainActive.Tip();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12151#discussion_r161034615",
      "id" : 161034615,
      "in_reply_to_id" : 161027116,
      "original_commit_id" : "f88df2e9c986ff49f9bf5c13838087ba0ef96858",
      "original_position" : 143,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 143,
      "pull_request_review_id" : 88258212,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12151",
      "updated_at" : "2018-01-11T18:18:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161034615",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12151#discussion_r161034671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12151"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161034671"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ohoh, sorry, missed its use in blockheaderToJSON.",
      "commit_id" : "f88df2e9c986ff49f9bf5c13838087ba0ef96858",
      "created_at" : "2018-01-11T18:18:28Z",
      "diff_hunk" : "@@ -78,20 +78,22 @@ double GetDifficulty(const CChain& chain, const CBlockIndex* blockindex)\n     return dDiff;\n }\n \n-double GetDifficulty(const CBlockIndex* blockindex)\n+static int ComputeBlockConfirmations(const CBlockIndex* tip, const CBlockIndex* blockindex, const CBlockIndex*& next)\n {\n-    return GetDifficulty(chainActive, blockindex);\n+    next = tip->GetAncestor(blockindex->nHeight + 1);\n+    if (next && next->pprev == blockindex) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12151#discussion_r161034671",
      "id" : 161034671,
      "in_reply_to_id" : 161026738,
      "original_commit_id" : "f88df2e9c986ff49f9bf5c13838087ba0ef96858",
      "original_position" : 27,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 27,
      "pull_request_review_id" : 88258294,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12151",
      "updated_at" : "2018-01-11T18:18:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161034671",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Best reviewed commit by commit",
      "created_at" : "2018-01-11T18:19:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12151#issuecomment-357015434",
      "id" : 357015434,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12151",
      "updated_at" : "2018-01-11T18:19:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357015434",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   }
]
