[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #17526 (Use Single Random Draw In addition to knapsack as coin selection fallback by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-11-13T02:01:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#issuecomment-553202841",
      "id" : 553202841,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17458",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MzIwMjg0MQ==",
      "updated_at" : "2020-05-28T00:30:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/553202841",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-11-22T20:02:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#issuecomment-557674065",
      "id" : 557674065,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17458",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NzY3NDA2NQ==",
      "updated_at" : "2019-11-22T20:02:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557674065",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r354983896"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354983896"
         }
      },
      "author_association" : "MEMBER",
      "body" : "this only isn't a reachable \"bug\" because before this PR the values are the same, yes?",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2019-12-06T19:02:14Z",
      "diff_hunk" : "@@ -299,7 +299,7 @@ bool KnapsackSolver(const CAmount& nTargetValue, std::vector<OutputGroup>& group\n void OutputGroup::Insert(const CInputCoin& output, int depth, bool from_me, size_t ancestors, size_t descendants) {\n     m_outputs.push_back(output);\n     m_from_me &= from_me;\n-    m_value += output.effective_value;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r354983896",
      "id" : 354983896,
      "line" : 305,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NDk4Mzg5Ng==",
      "original_commit_id" : "ef9d0f24aa3bf6b80052c1a4a2a36f079574ad04",
      "original_line" : 305,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 12,
      "pull_request_review_id" : 328397345,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354983896",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r354987133"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354987133"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This commit makes `effective_value` a bit ambiguous to the reader now that both short and long-range fees are being stored.",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2019-12-06T19:10:43Z",
      "diff_hunk" : "@@ -36,6 +36,8 @@ class CInputCoin {\n     COutPoint outpoint;\n     CTxOut txout;\n     CAmount effective_value;\n+    CAmount m_fee;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r354987133",
      "id" : 354987133,
      "line" : 41,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NDk4NzEzMw==",
      "original_commit_id" : "d9b985a852adb408661509312aeee1ef3dbb4bee",
      "original_line" : 41,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.h",
      "position" : 13,
      "pull_request_review_id" : 328397345,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354987133",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r354997799"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354997799"
         }
      },
      "author_association" : "MEMBER",
      "body" : "hmm actually no, this happens for any `OutputGroup`, which includes Bnb?",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2019-12-06T19:37:29Z",
      "diff_hunk" : "@@ -299,7 +299,7 @@ bool KnapsackSolver(const CAmount& nTargetValue, std::vector<OutputGroup>& group\n void OutputGroup::Insert(const CInputCoin& output, int depth, bool from_me, size_t ancestors, size_t descendants) {\n     m_outputs.push_back(output);\n     m_from_me &= from_me;\n-    m_value += output.effective_value;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r354997799",
      "id" : 354997799,
      "in_reply_to_id" : 354983896,
      "line" : 305,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NDk5Nzc5OQ==",
      "original_commit_id" : "ef9d0f24aa3bf6b80052c1a4a2a36f079574ad04",
      "original_line" : 305,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 12,
      "pull_request_review_id" : 328415649,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/354997799",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r355005876"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355005876"
         }
      },
      "author_association" : "MEMBER",
      "body" : "it isn't reachable because the values are the same as the outputs' effective values aren't ever actually to their effective values.",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2019-12-06T19:57:25Z",
      "diff_hunk" : "@@ -299,7 +299,7 @@ bool KnapsackSolver(const CAmount& nTargetValue, std::vector<OutputGroup>& group\n void OutputGroup::Insert(const CInputCoin& output, int depth, bool from_me, size_t ancestors, size_t descendants) {\n     m_outputs.push_back(output);\n     m_from_me &= from_me;\n-    m_value += output.effective_value;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r355005876",
      "id" : 355005876,
      "in_reply_to_id" : 354983896,
      "line" : 305,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NTAwNTg3Ng==",
      "original_commit_id" : "ef9d0f24aa3bf6b80052c1a4a2a36f079574ad04",
      "original_line" : 305,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 12,
      "pull_request_review_id" : 328426099,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355005876",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r355007695"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355007695"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It makes everything easier to precompute and store these since they are used  in multiple places.",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2019-12-06T20:01:58Z",
      "diff_hunk" : "@@ -36,6 +36,8 @@ class CInputCoin {\n     COutPoint outpoint;\n     CTxOut txout;\n     CAmount effective_value;\n+    CAmount m_fee;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r355007695",
      "id" : 355007695,
      "in_reply_to_id" : 354987133,
      "line" : 41,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NTAwNzY5NQ==",
      "original_commit_id" : "d9b985a852adb408661509312aeee1ef3dbb4bee",
      "original_line" : 41,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.h",
      "position" : 13,
      "pull_request_review_id" : 328428381,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355007695",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r355008088"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355008088"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ah I see, it's being set externally in `SelectCoinsMinConf`. Ok, this set of changes makes it much easier to understand.",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2019-12-06T20:03:05Z",
      "diff_hunk" : "@@ -299,7 +299,7 @@ bool KnapsackSolver(const CAmount& nTargetValue, std::vector<OutputGroup>& group\n void OutputGroup::Insert(const CInputCoin& output, int depth, bool from_me, size_t ancestors, size_t descendants) {\n     m_outputs.push_back(output);\n     m_from_me &= from_me;\n-    m_value += output.effective_value;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r355008088",
      "id" : 355008088,
      "in_reply_to_id" : 354983896,
      "line" : 305,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NTAwODA4OA==",
      "original_commit_id" : "ef9d0f24aa3bf6b80052c1a4a2a36f079574ad04",
      "original_line" : 305,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 12,
      "pull_request_review_id" : 328428906,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355008088",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK https://github.com/bitcoin/bitcoin/pull/17458/commits/693cfa66d10c916d4554c7639dc772727248c9fd",
      "created_at" : "2019-12-06T20:04:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#issuecomment-562718496",
      "id" : 562718496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17458",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MjcxODQ5Ng==",
      "updated_at" : "2019-12-06T20:04:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/562718496",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r355008697"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355008697"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I understand the motivation, my nitting is about naming since we're expanding the \"scope\" of what is being cached.",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2019-12-06T20:04:43Z",
      "diff_hunk" : "@@ -36,6 +36,8 @@ class CInputCoin {\n     COutPoint outpoint;\n     CTxOut txout;\n     CAmount effective_value;\n+    CAmount m_fee;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r355008697",
      "id" : 355008697,
      "in_reply_to_id" : 354987133,
      "line" : 41,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NTAwODY5Nw==",
      "original_commit_id" : "d9b985a852adb408661509312aeee1ef3dbb4bee",
      "original_line" : 41,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.h",
      "position" : 13,
      "pull_request_review_id" : 328429726,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355008697",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r389749045"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/389749045"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Should the reverse not also be added to the `Insert` method above?",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2020-03-09T15:02:50Z",
      "diff_hunk" : "@@ -317,6 +318,8 @@ std::vector<CInputCoin>::iterator OutputGroup::Discard(const CInputCoin& output)\n     if (it == m_outputs.end()) return it;\n     m_value -= output.txout.nValue;\n     effective_value -= output.effective_value;\n+    fee -= output.m_fee;\n+    long_term_fee -= output.m_long_term_fee;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r389749045",
      "id" : 389749045,
      "line" : 327,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc0OTA0NQ==",
      "original_commit_id" : "693cfa66d10c916d4554c7639dc772727248c9fd",
      "original_line" : 327,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 35,
      "pull_request_review_id" : 371260888,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/389749045",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r389765666"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/389765666"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, but no. The `OutputGroup`s are created (and `Insert` is called) before the fees are set. But `Discard` is called after the fees are set. So not incrementing `fee` and `long_term_fee` in `Insert` is safe because they are 0 at that time. I guess it still should for consistency.",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2020-03-09T15:26:25Z",
      "diff_hunk" : "@@ -317,6 +318,8 @@ std::vector<CInputCoin>::iterator OutputGroup::Discard(const CInputCoin& output)\n     if (it == m_outputs.end()) return it;\n     m_value -= output.txout.nValue;\n     effective_value -= output.effective_value;\n+    fee -= output.m_fee;\n+    long_term_fee -= output.m_long_term_fee;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r389765666",
      "id" : 389765666,
      "in_reply_to_id" : 389749045,
      "line" : 327,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4OTc2NTY2Ng==",
      "original_commit_id" : "693cfa66d10c916d4554c7639dc772727248c9fd",
      "original_line" : 327,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 35,
      "pull_request_review_id" : 371282304,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/389765666",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r429572035"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429572035"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "To me this method looks overly complicated and doesn't fit so well with the rest of the API. I would suggest simplifying it like this: https://github.com/fjahr/bitcoin/commit/404e7f2516778510f98b69a4651141d0a5944cbd\r\n\r\nTests passed for me with this change.",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2020-05-23T19:29:37Z",
      "diff_hunk" : "@@ -326,3 +329,35 @@ bool OutputGroup::EligibleForSpending(const CoinEligibilityFilter& eligibility_f\n         && m_ancestors <= eligibility_filter.max_ancestors\n         && m_descendants <= eligibility_filter.max_descendants;\n }\n+\n+void OutputGroup::SetFees(const CFeeRate effective_feerate, const CFeeRate long_term_feerate)\n+{\n+    fee = 0;\n+    long_term_fee = 0;\n+    effective_value = 0;\n+    for (CInputCoin& coin : m_outputs) {\n+        coin.m_fee = coin.m_input_bytes < 0 ? 0 : effective_feerate.GetFee(coin.m_input_bytes);\n+        fee += coin.m_fee;\n+\n+        coin.m_long_term_fee = coin.m_input_bytes < 0 ? 0 : long_term_feerate.GetFee(coin.m_input_bytes);\n+        long_term_fee += coin.m_long_term_fee;\n+\n+        coin.effective_value = coin.txout.nValue - coin.m_fee;\n+        effective_value += coin.effective_value;\n+    }\n+}\n+\n+OutputGroup OutputGroup::GetPositiveOnlyGroup()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r429572035",
      "id" : 429572035,
      "line" : 355,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU3MjAzNQ==",
      "original_commit_id" : "693cfa66d10c916d4554c7639dc772727248c9fd",
      "original_line" : 355,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 61,
      "pull_request_review_id" : 417302903,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429572035",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r429572421"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429572421"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, I think it would be better if it was added. Otherwise, bugs could be introduced if `Insert` is used differently in the future.",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2020-05-23T19:35:07Z",
      "diff_hunk" : "@@ -317,6 +318,8 @@ std::vector<CInputCoin>::iterator OutputGroup::Discard(const CInputCoin& output)\n     if (it == m_outputs.end()) return it;\n     m_value -= output.txout.nValue;\n     effective_value -= output.effective_value;\n+    fee -= output.m_fee;\n+    long_term_fee -= output.m_long_term_fee;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r429572421",
      "id" : 429572421,
      "in_reply_to_id" : 389749045,
      "line" : 327,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU3MjQyMQ==",
      "original_commit_id" : "693cfa66d10c916d4554c7639dc772727248c9fd",
      "original_line" : 327,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 35,
      "pull_request_review_id" : 417302903,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429572421",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r430614504"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430614504"
         }
      },
      "author_association" : "MEMBER",
      "body" : "My understanding was that this was not safe and could result in undefined behavior because we are actively iterating through the vector while also modifying at the same time (`Discard` erases from the vector). So the safe way to do this is to use iterators.",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2020-05-26T18:18:26Z",
      "diff_hunk" : "@@ -326,3 +329,35 @@ bool OutputGroup::EligibleForSpending(const CoinEligibilityFilter& eligibility_f\n         && m_ancestors <= eligibility_filter.max_ancestors\n         && m_descendants <= eligibility_filter.max_descendants;\n }\n+\n+void OutputGroup::SetFees(const CFeeRate effective_feerate, const CFeeRate long_term_feerate)\n+{\n+    fee = 0;\n+    long_term_fee = 0;\n+    effective_value = 0;\n+    for (CInputCoin& coin : m_outputs) {\n+        coin.m_fee = coin.m_input_bytes < 0 ? 0 : effective_feerate.GetFee(coin.m_input_bytes);\n+        fee += coin.m_fee;\n+\n+        coin.m_long_term_fee = coin.m_input_bytes < 0 ? 0 : long_term_feerate.GetFee(coin.m_input_bytes);\n+        long_term_fee += coin.m_long_term_fee;\n+\n+        coin.effective_value = coin.txout.nValue - coin.m_fee;\n+        effective_value += coin.effective_value;\n+    }\n+}\n+\n+OutputGroup OutputGroup::GetPositiveOnlyGroup()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r430614504",
      "id" : 430614504,
      "in_reply_to_id" : 429572035,
      "line" : 355,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYxNDUwNA==",
      "original_commit_id" : "693cfa66d10c916d4554c7639dc772727248c9fd",
      "original_line" : 355,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 61,
      "pull_request_review_id" : 418559082,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430614504",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r430621004"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430621004"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I've added it to insert.",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2020-05-26T18:29:23Z",
      "diff_hunk" : "@@ -317,6 +318,8 @@ std::vector<CInputCoin>::iterator OutputGroup::Discard(const CInputCoin& output)\n     if (it == m_outputs.end()) return it;\n     m_value -= output.txout.nValue;\n     effective_value -= output.effective_value;\n+    fee -= output.m_fee;\n+    long_term_fee -= output.m_long_term_fee;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r430621004",
      "id" : 430621004,
      "in_reply_to_id" : 389749045,
      "line" : 327,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYyMTAwNA==",
      "original_commit_id" : "693cfa66d10c916d4554c7639dc772727248c9fd",
      "original_line" : 327,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 35,
      "pull_request_review_id" : 418567151,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T18:29:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430621004",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r430636423"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430636423"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Comment on what this is doing would be :ok_hand: ",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2020-05-26T18:55:58Z",
      "diff_hunk" : "@@ -93,6 +95,8 @@ struct OutputGroup\n     void Insert(const CInputCoin& output, int depth, bool from_me, size_t ancestors, size_t descendants);\n     std::vector<CInputCoin>::iterator Discard(const CInputCoin& output);\n     bool EligibleForSpending(const CoinEligibilityFilter& eligibility_filter) const;\n+    void SetFees(const CFeeRate effective_feerate, const CFeeRate long_term_feerate);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r430636423",
      "id" : 430636423,
      "line" : 98,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzNjQyMw==",
      "original_commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "original_line" : 98,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.h",
      "position" : 22,
      "pull_request_review_id" : 418586338,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T19:07:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430636423",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r430637875"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430637875"
         }
      },
      "author_association" : "MEMBER",
      "body" : "please annotate arg since you're throwing a special(weird) value at it",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2020-05-26T18:58:33Z",
      "diff_hunk" : "@@ -2265,27 +2265,14 @@ bool CWallet::SelectCoinsMinConf(const CAmount& nTargetValue, const CoinEligibil\n         for (OutputGroup& group : groups) {\n             if (!group.EligibleForSpending(eligibility_filter)) continue;\n \n-            group.fee = 0;\n-            group.long_term_fee = 0;\n-            group.effective_value = 0;\n-            for (auto it = group.m_outputs.begin(); it != group.m_outputs.end(); ) {\n-                const CInputCoin& coin = *it;\n-                CAmount effective_value = coin.txout.nValue - (coin.m_input_bytes < 0 ? 0 : coin_selection_params.effective_fee.GetFee(coin.m_input_bytes));\n-                // Only include outputs that are positive effective value (i.e. not dust)\n-                if (effective_value > 0) {\n-                    group.fee += coin.m_input_bytes < 0 ? 0 : coin_selection_params.effective_fee.GetFee(coin.m_input_bytes);\n-                    group.long_term_fee += coin.m_input_bytes < 0 ? 0 : long_term_feerate.GetFee(coin.m_input_bytes);\n-                    if (coin_selection_params.m_subtract_fee_outputs) {\n-                        group.effective_value += coin.txout.nValue;\n-                    } else {\n-                        group.effective_value += effective_value;\n-                    }\n-                    ++it;\n-                } else {\n-                    it = group.Discard(coin);\n-                }\n+            if (coin_selection_params.m_subtract_fee_outputs) {\n+                group.SetFees(CFeeRate(0), long_term_feerate);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r430637875",
      "id" : 430637875,
      "line" : 2269,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDYzNzg3NQ==",
      "original_commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "original_line" : 2269,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 24,
      "pull_request_review_id" : 418586338,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T19:07:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430637875",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There seems to be a random sigabrt in the BnBExhaustion benchmark.",
      "created_at" : "2020-05-26T20:02:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#issuecomment-634248868",
      "id" : 634248868,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17458",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDI0ODg2OA==",
      "updated_at" : "2020-05-26T20:02:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634248868",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r430681932"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430681932"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "You are right! I think this is still a bit of an improvement but only if you have to retouch https://github.com/fjahr/bitcoin/commit/a4388848b7ba409275bf1424dfd724ac1f3e15f9",
      "commit_id" : "6a6d19e0e5d91673a0d361ffa732b6dc43890034",
      "created_at" : "2020-05-26T20:15:25Z",
      "diff_hunk" : "@@ -326,3 +329,35 @@ bool OutputGroup::EligibleForSpending(const CoinEligibilityFilter& eligibility_f\n         && m_ancestors <= eligibility_filter.max_ancestors\n         && m_descendants <= eligibility_filter.max_descendants;\n }\n+\n+void OutputGroup::SetFees(const CFeeRate effective_feerate, const CFeeRate long_term_feerate)\n+{\n+    fee = 0;\n+    long_term_fee = 0;\n+    effective_value = 0;\n+    for (CInputCoin& coin : m_outputs) {\n+        coin.m_fee = coin.m_input_bytes < 0 ? 0 : effective_feerate.GetFee(coin.m_input_bytes);\n+        fee += coin.m_fee;\n+\n+        coin.m_long_term_fee = coin.m_input_bytes < 0 ? 0 : long_term_feerate.GetFee(coin.m_input_bytes);\n+        long_term_fee += coin.m_long_term_fee;\n+\n+        coin.effective_value = coin.txout.nValue - coin.m_fee;\n+        effective_value += coin.effective_value;\n+    }\n+}\n+\n+OutputGroup OutputGroup::GetPositiveOnlyGroup()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#discussion_r430681932",
      "id" : 430681932,
      "in_reply_to_id" : 429572035,
      "line" : 355,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDY4MTkzMg==",
      "original_commit_id" : "693cfa66d10c916d4554c7639dc772727248c9fd",
      "original_line" : 355,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/wallet/coinselection.cpp",
      "position" : 61,
      "pull_request_review_id" : 418646021,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17458",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-26T20:15:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430681932",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK 6a6d19e0e5d91673a0d361ffa732b6dc43890034\r\n\r\nTests run fine for me locally.",
      "created_at" : "2020-06-14T12:22:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17458#issuecomment-643759427",
      "id" : 643759427,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17458",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0Mzc1OTQyNw==",
      "updated_at" : "2020-06-14T12:22:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/643759427",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   }
]
