[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#18077](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/18077.html) (net: Add NAT-PMP port forwarding support by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-11-09T23:42:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-552147683",
      "id" : 552147683,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MjE0NzY4Mw==",
      "updated_at" : "2020-02-08T00:58:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/552147683",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Don't think this should get in the way of implementing something like this, but have to note here, as it's a significant change of behavior from before: reconnecting to peers \"aggressively\", was, up to now, the reserve of spy nodes and mass-connectors and such. For normal nodes the chance of making the same outgoing connection twice was pretty low. Historically this has been one of the ways used to detect these.",
      "created_at" : "2019-11-10T11:03:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-552184378",
      "id" : 552184378,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MjE4NDM3OA==",
      "updated_at" : "2019-11-10T11:05:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/552184378",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It would be really good to limit it so that an honest node won't attempt to connect twice to the same peer through this mechanism for some prudent amount of time... like two minutes.\r\n\r\nI don't think it would cause any harm to the intent of this mechanism to not bring them up as fast as possible, and it would avoid  tripping up detection of aggressive mass connectors.",
      "created_at" : "2019-11-13T18:11:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-553531390",
      "id" : 553531390,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MzUzMTM5MA==",
      "updated_at" : "2019-11-13T18:11:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/553531390",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Not sure if Iâm misreading this code (I havenât tested it), but it looks like on restart we would only  attempt to connect once to each anchor, and then it gets removed from consideration.  Does that satisfy the concern about rapid reconnects?  I guess if a user rapidly restarted their node, we could see rapid connections to the same peers, but that seems pretty weird.\r\n\r\nAnyway I just skimmed the discussion in #17326.  I think Greg or Matt commented that we shouldnât do this with all our block-relay-only connections, but since we only have 2 at the moment, perhaps itâs fine for now.  And then in the future if we expand to say 8 block-relay peers we might still cap the anchors at 2.  Does that reflect the thinking of others as well?",
      "created_at" : "2019-11-14T20:49:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-554073351",
      "id" : 554073351,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NDA3MzM1MQ==",
      "updated_at" : "2019-11-14T20:49:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554073351",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r346539871"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346539871"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think by putting this logic down here, youâre bypassing some important filtering that happens in the loop above, where we skip over some entries that addrMan gives us (for instance, the `IsReachable()â check).  I think the best thing would be to move this logic up to that loop (similar to the tried table collision selector) so that all those other criteria are still enforced.",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2019-11-14T20:52:30Z",
      "diff_hunk" : "@@ -1863,11 +1863,28 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             // well for sanity.)\n             bool block_relay_only = nOutboundBlockRelay < m_max_outbound_block_relay && !fFeeler && nOutboundFullRelay >= m_max_outbound_full_relay;\n \n+            if (block_relay_only && !m_anchors.empty()) {\n+                addrConnect = m_anchors.back();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r346539871",
      "id" : 346539871,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0NjUzOTg3MQ==",
      "original_commit_id" : "99d6f6fc6c11c7797dcf232be75d1803d7cacfa1",
      "original_position" : 5,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 317252129,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346539871",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r348988284"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/348988284"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2019-11-21T09:53:23Z",
      "diff_hunk" : "@@ -1863,11 +1863,28 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             // well for sanity.)\n             bool block_relay_only = nOutboundBlockRelay < m_max_outbound_block_relay && !fFeeler && nOutboundFullRelay >= m_max_outbound_full_relay;\n \n+            if (block_relay_only && !m_anchors.empty()) {\n+                addrConnect = m_anchors.back();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r348988284",
      "id" : 348988284,
      "in_reply_to_id" : 346539871,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0ODk4ODI4NA==",
      "original_commit_id" : "99d6f6fc6c11c7797dcf232be75d1803d7cacfa1",
      "original_position" : 5,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 320757443,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/348988284",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@sdaftuar \r\n\r\nThank you for your review. Your comment has been addressed.\r\n\r\nAlso, an additional safety check added to \"p2p: Integrate ReadAnchors() into CConnman()\" commit in the latest push.",
      "created_at" : "2019-11-21T09:56:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-557008273",
      "id" : 557008273,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NzAwODI3Mw==",
      "updated_at" : "2019-11-21T09:56:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557008273",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r367057240"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367057240"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why clear the whole instead of picking randomly `m_max_outbound_block_relay` among the anchors set? If one of our most recent anchors isn't reliable we should be allowed to pick up among older anchors to still of the counter-measure. ",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-15T19:14:13Z",
      "diff_hunk" : "@@ -2176,12 +2176,19 @@ void CConnman::SetNetworkActive(bool active)\n     uiInterface.NotifyNetworkActiveChanged(fNetworkActive);\n }\n \n-CConnman::CConnman(uint64_t nSeed0In, uint64_t nSeed1In) : nSeed0(nSeed0In), nSeed1(nSeed1In)\n+CConnman::CConnman(uint64_t nSeed0In, uint64_t nSeed1In)\n+    : m_anchors_db_path{GetDataDir() / \"anchors.dat\"}, nSeed0(nSeed0In), nSeed1(nSeed1In)\n {\n     SetTryNewOutboundPeer(false);\n \n     Options connOptions;\n     Init(connOptions);\n+\n+    m_anchors = ReadAnchors(m_anchors_db_path);\n+    if (m_anchors.size() > m_max_outbound_block_relay) {\n+        // Keep our policy safe.\n+        m_anchors.clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r367057240",
      "id" : 367057240,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzA1NzI0MA==",
      "original_commit_id" : "ea5a307eaf1a2325b33df6a2a35ea6df783f4e6b",
      "original_position" : 16,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 343456401,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367057240",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r367058564"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367058564"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: isn't cleaner to avoid read() in CConnman constructor and instead do it in CConnman::Start like we do for peers.dat?",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-15T19:17:03Z",
      "diff_hunk" : "@@ -2176,12 +2176,19 @@ void CConnman::SetNetworkActive(bool active)\n     uiInterface.NotifyNetworkActiveChanged(fNetworkActive);\n }\n \n-CConnman::CConnman(uint64_t nSeed0In, uint64_t nSeed1In) : nSeed0(nSeed0In), nSeed1(nSeed1In)\n+CConnman::CConnman(uint64_t nSeed0In, uint64_t nSeed1In)\n+    : m_anchors_db_path{GetDataDir() / \"anchors.dat\"}, nSeed0(nSeed0In), nSeed1(nSeed1In)\n {\n     SetTryNewOutboundPeer(false);\n \n     Options connOptions;\n     Init(connOptions);\n+\n+    m_anchors = ReadAnchors(m_anchors_db_path);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r367058564",
      "id" : 367058564,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzA1ODU2NA==",
      "original_commit_id" : "ea5a307eaf1a2325b33df6a2a35ea6df783f4e6b",
      "original_position" : 13,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 343456401,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367058564",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r367073224"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367073224"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "May we check here also `nOutboundFullRelay`, and so keep same connection order, i.e full-relay then block-only or is there any advantage to invert order ?",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-15T19:48:43Z",
      "diff_hunk" : "@@ -1805,11 +1807,24 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             if (nTries > 100)\n                 break;\n \n-            CAddrInfo addr = addrman.SelectTriedCollision();\n+            CAddress addr;\n+            if (!m_anchors.empty() && (nOutboundBlockRelay < m_max_outbound_block_relay) && !fFeeler) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r367073224",
      "id" : 367073224,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzA3MzIyNA==",
      "original_commit_id" : "d405145e8f935b454ba77e23cf7327515b85151e",
      "original_position" : 15,
      "path" : "src/net.cpp",
      "position" : 34,
      "pull_request_review_id" : 343456401,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367073224",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r367081001"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367081001"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What do you think about waiting some time like 24hours or one block announcement before to qualify node as anchor? That would require at least some good behavior from it, that said and may favor too much well-reliable nodes and decay network-wide connectivity..\r\n\r\nnit: you may use scheduler for DumpAnchors like we do for DumpAddresses, that would avoid file syscalls while holding cs_main",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-15T20:05:50Z",
      "diff_hunk" : "@@ -2088,6 +2088,9 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n                       pfrom->nVersion.load(), pfrom->nStartingHeight,\n                       pfrom->GetId(), (fLogIPs ? strprintf(\", peeraddr=%s\", pfrom->addr.ToString()) : \"\"),\n                       pfrom->m_tx_relay == nullptr ? \"block-relay\" : \"full-relay\");\n+            if (!pfrom->m_tx_relay) {\n+                DumpAnchors(connman->m_anchors_db_path, connman->GetBlockRelayNodeAddresses());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r367081001",
      "id" : 367081001,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzA4MTAwMQ==",
      "original_commit_id" : "a41cf3dedb70f418d3003b182ce1d925576161eb",
      "original_position" : 5,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 343456401,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367081001",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Added 0.20 milestone as this mitigates a security issue so it would be good to have.",
      "created_at" : "2020-01-20T20:09:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-576415049",
      "id" : 576415049,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3NjQxNTA0OQ==",
      "updated_at" : "2020-01-20T20:09:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/576415049",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r369783170"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/369783170"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can use [`logging/timer.h`](https://github.com/bitcoin/bitcoin/blob/master/src/logging/timer.h#L96-L101) if you care to. [(example)](https://github.com/bitcoin/bitcoin/blob/master/src/validation.cpp#L2296)",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-22T20:21:48Z",
      "diff_hunk" : "@@ -165,3 +165,10 @@ std::vector<CAddress> ReadAnchors(const fs::path& anchors_db_path)\n \n     return ret;\n }\n+\n+void DumpAnchors(const fs::path& anchors_db_path, const std::vector<CAddress>& anchors)\n+{\n+    int64_t start = GetTimeMillis();\n+    SerializeFileDB(\"anchors\", anchors_db_path, anchors);\n+    LogPrintf(\"Flushed %d anchor outbound peer addresses to anchors.dat in %d ms\\n\", anchors.size(), GetTimeMillis() - start);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r369783170",
      "id" : 369783170,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTc4MzE3MA==",
      "original_commit_id" : "161dfb8aa4c534c2faea403bd515a26d10c952fe",
      "original_position" : 9,
      "path" : "src/addrdb.cpp",
      "position" : null,
      "pull_request_review_id" : 346876682,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/369783170",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r369789242"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/369789242"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I like the idea of moving this onto the scheduler thread, but not a huge deal given this only happens once per blocks-only connection.",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-22T20:36:26Z",
      "diff_hunk" : "@@ -2088,6 +2088,9 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n                       pfrom->nVersion.load(), pfrom->nStartingHeight,\n                       pfrom->GetId(), (fLogIPs ? strprintf(\", peeraddr=%s\", pfrom->addr.ToString()) : \"\"),\n                       pfrom->m_tx_relay == nullptr ? \"block-relay\" : \"full-relay\");\n+            if (!pfrom->m_tx_relay) {\n+                DumpAnchors(connman->m_anchors_db_path, connman->GetBlockRelayNodeAddresses());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r369789242",
      "id" : 369789242,
      "in_reply_to_id" : 367081001,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTc4OTI0Mg==",
      "original_commit_id" : "a41cf3dedb70f418d3003b182ce1d925576161eb",
      "original_position" : 5,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 346876682,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/369789242",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ariard \r\n\r\nThe only idea of this PR is to make a node to try restore outbound block-relay-only connections as they were just before node restart. It is expected that this change in node behavior mitigates restart-based eclipse attacks without significant other tradeoffs.\r\n\r\n> IMO before to go forward we need to agree on a) the scope of anchors: full-relay, block-relay, both...\r\n\r\nAnchoring as a new procedure, or anchors as \"seemingly safe\" nodes are out of the scope of this PR.\r\n\r\n>  b) anchors selection & lifecyle, i.e after how much time do we select them or based on any metrics, do we prune them from anchors.dat, do we keep a bigger file and select randomly from it\r\n\r\nWith an idea _to make a node to try restore outbound block-relay-only connections as they were just before node restart_, anchors are the last known outbound block-relay-only connections only.\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/17428#discussion_r367081001\r\n> What do you think about waiting some time like 24hours or one block announcement before to qualify node as anchor? That would require at least some good behavior from it, that said and may favor too much well-reliable nodes and decay network-wide connectivity..\r\n\r\nIn this PR anchors are considered as the last known outbound block-relay-only connections, not as \"presumable safe\" ones.",
      "created_at" : "2020-01-26T13:09:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-578500393",
      "id" : 578500393,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3ODUwMDM5Mw==",
      "updated_at" : "2020-01-26T13:09:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/578500393",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r371009058"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371009058"
         }
      },
      "author_association" : "MEMBER",
      "body" : "~I'd prefer to initialize `m_anchors` member in constructor.~",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-26T15:46:26Z",
      "diff_hunk" : "@@ -2176,12 +2176,19 @@ void CConnman::SetNetworkActive(bool active)\n     uiInterface.NotifyNetworkActiveChanged(fNetworkActive);\n }\n \n-CConnman::CConnman(uint64_t nSeed0In, uint64_t nSeed1In) : nSeed0(nSeed0In), nSeed1(nSeed1In)\n+CConnman::CConnman(uint64_t nSeed0In, uint64_t nSeed1In)\n+    : m_anchors_db_path{GetDataDir() / \"anchors.dat\"}, nSeed0(nSeed0In), nSeed1(nSeed1In)\n {\n     SetTryNewOutboundPeer(false);\n \n     Options connOptions;\n     Init(connOptions);\n+\n+    m_anchors = ReadAnchors(m_anchors_db_path);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r371009058",
      "id" : 371009058,
      "in_reply_to_id" : 367058564,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAwOTA1OA==",
      "original_commit_id" : "ea5a307eaf1a2325b33df6a2a35ea6df783f4e6b",
      "original_position" : 13,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 348387692,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371009058",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r371009626"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371009626"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The worst case is assumed. If condition `m_anchors.size() > m_max_outbound_block_relay` is satisfied, we could suppose that the `anchors.dat` file is wrong or corrupted.",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-26T15:53:38Z",
      "diff_hunk" : "@@ -2176,12 +2176,19 @@ void CConnman::SetNetworkActive(bool active)\n     uiInterface.NotifyNetworkActiveChanged(fNetworkActive);\n }\n \n-CConnman::CConnman(uint64_t nSeed0In, uint64_t nSeed1In) : nSeed0(nSeed0In), nSeed1(nSeed1In)\n+CConnman::CConnman(uint64_t nSeed0In, uint64_t nSeed1In)\n+    : m_anchors_db_path{GetDataDir() / \"anchors.dat\"}, nSeed0(nSeed0In), nSeed1(nSeed1In)\n {\n     SetTryNewOutboundPeer(false);\n \n     Options connOptions;\n     Init(connOptions);\n+\n+    m_anchors = ReadAnchors(m_anchors_db_path);\n+    if (m_anchors.size() > m_max_outbound_block_relay) {\n+        // Keep our policy safe.\n+        m_anchors.clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r371009626",
      "id" : 371009626,
      "in_reply_to_id" : 367057240,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAwOTYyNg==",
      "original_commit_id" : "ea5a307eaf1a2325b33df6a2a35ea6df783f4e6b",
      "original_position" : 16,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 348388178,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371009626",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r371020152"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371020152"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The order is not inverted. The first target \"anchors\" is added, and was not present before, i.e., the new order is \"anchors\" then \"full-relay\" then \"block-relay-only\".\r\nIf anchors would not the first, they could be connected as other type nodes, and anchoring could not happen.",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-26T18:31:04Z",
      "diff_hunk" : "@@ -1805,11 +1807,24 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             if (nTries > 100)\n                 break;\n \n-            CAddrInfo addr = addrman.SelectTriedCollision();\n+            CAddress addr;\n+            if (!m_anchors.empty() && (nOutboundBlockRelay < m_max_outbound_block_relay) && !fFeeler) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r371020152",
      "id" : 371020152,
      "in_reply_to_id" : 367073224,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyMDE1Mg==",
      "original_commit_id" : "d405145e8f935b454ba77e23cf7327515b85151e",
      "original_position" : 15,
      "path" : "src/net.cpp",
      "position" : 34,
      "pull_request_review_id" : 348396951,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371020152",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r371021403"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371021403"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> nit: you may use scheduler for DumpAnchors like we do for DumpAddresses, that would avoid file syscalls while holding cs_main\r\n\r\n> I like the idea of moving this onto the scheduler thread, but not a huge deal given this only happens once per blocks-only connection.\r\n\r\nAgree that using `CScheduler.scheduleFromNow()` for `DumpAnchors` is an improvement. Let's leave it for follow ups.",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-26T18:52:21Z",
      "diff_hunk" : "@@ -2088,6 +2088,9 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n                       pfrom->nVersion.load(), pfrom->nStartingHeight,\n                       pfrom->GetId(), (fLogIPs ? strprintf(\", peeraddr=%s\", pfrom->addr.ToString()) : \"\"),\n                       pfrom->m_tx_relay == nullptr ? \"block-relay\" : \"full-relay\");\n+            if (!pfrom->m_tx_relay) {\n+                DumpAnchors(connman->m_anchors_db_path, connman->GetBlockRelayNodeAddresses());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r371021403",
      "id" : 371021403,
      "in_reply_to_id" : 367081001,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyMTQwMw==",
      "original_commit_id" : "a41cf3dedb70f418d3003b182ce1d925576161eb",
      "original_position" : 5,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 348397982,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371021403",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r371023351"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371023351"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done in the latest push.",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-26T19:24:53Z",
      "diff_hunk" : "@@ -2176,12 +2176,19 @@ void CConnman::SetNetworkActive(bool active)\n     uiInterface.NotifyNetworkActiveChanged(fNetworkActive);\n }\n \n-CConnman::CConnman(uint64_t nSeed0In, uint64_t nSeed1In) : nSeed0(nSeed0In), nSeed1(nSeed1In)\n+CConnman::CConnman(uint64_t nSeed0In, uint64_t nSeed1In)\n+    : m_anchors_db_path{GetDataDir() / \"anchors.dat\"}, nSeed0(nSeed0In), nSeed1(nSeed1In)\n {\n     SetTryNewOutboundPeer(false);\n \n     Options connOptions;\n     Init(connOptions);\n+\n+    m_anchors = ReadAnchors(m_anchors_db_path);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r371023351",
      "id" : 371023351,
      "in_reply_to_id" : 367058564,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyMzM1MQ==",
      "original_commit_id" : "ea5a307eaf1a2325b33df6a2a35ea6df783f4e6b",
      "original_position" : 13,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 348399659,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371023351",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r371023391"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371023391"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks. Done in the latest push.",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-26T19:25:36Z",
      "diff_hunk" : "@@ -165,3 +165,10 @@ std::vector<CAddress> ReadAnchors(const fs::path& anchors_db_path)\n \n     return ret;\n }\n+\n+void DumpAnchors(const fs::path& anchors_db_path, const std::vector<CAddress>& anchors)\n+{\n+    int64_t start = GetTimeMillis();\n+    SerializeFileDB(\"anchors\", anchors_db_path, anchors);\n+    LogPrintf(\"Flushed %d anchor outbound peer addresses to anchors.dat in %d ms\\n\", anchors.size(), GetTimeMillis() - start);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r371023391",
      "id" : 371023391,
      "in_reply_to_id" : 369783170,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTAyMzM5MQ==",
      "original_commit_id" : "161dfb8aa4c534c2faea403bd515a26d10c952fe",
      "original_position" : 9,
      "path" : "src/addrdb.cpp",
      "position" : null,
      "pull_request_review_id" : 348399689,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-29T20:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371023391",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated d405145e8f935b454ba77e23cf7327515b85151e -> f2b4cfdc75952e61ba98eeffe26b2f86a78a45c9 ([pr17428.02](https://github.com/hebasto/bitcoin/commits/pr17428.02) -> [pr17428.03](https://github.com/hebasto/bitcoin/commits/pr17428.03), [compare](https://github.com/hebasto/bitcoin/compare/pr17428.02..pr17428.03)).\r\n\r\n@ariard @jamesob \r\n\r\nThank you for your reviews. Your comments have been addressed.\r\n\r\n\r\n@jamesob\r\n> ... seeing some strange behavior locally.\r\n\r\nAdded additional logging when connecting to an anchor fails.",
      "created_at" : "2020-01-26T19:37:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-578535216",
      "id" : 578535216,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3ODUzNTIxNg==",
      "updated_at" : "2020-01-26T19:37:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/578535216",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Pushed a fixup. Ready for testing and (re)reviewing now.",
      "created_at" : "2020-01-26T20:38:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-578540792",
      "id" : 578540792,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3ODU0MDc5Mg==",
      "updated_at" : "2020-01-26T20:38:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/578540792",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Couldn't there be a risk here, that if one of the anchor peers is malicious and knows a DoS vulnerability, this ensures they can keep repeatedly crashing your node, even if you setup a watchdog to restart it?",
      "created_at" : "2020-01-29T03:53:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-579580035",
      "id" : 579580035,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3OTU4MDAzNQ==",
      "updated_at" : "2020-01-29T03:53:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/579580035",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2020-01-29T13:28:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-579754482",
      "id" : 579754482,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3OTc1NDQ4Mg==",
      "updated_at" : "2020-01-29T13:28:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/579754482",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased after #16702 has been merged.",
      "created_at" : "2020-01-29T20:13:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-579938535",
      "id" : 579938535,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3OTkzODUzNQ==",
      "updated_at" : "2020-01-29T20:13:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/579938535",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@luke-jr \r\n> Couldn't there be a risk here, that if one of the anchor peers is malicious and knows a DoS vulnerability, this ensures they can keep repeatedly crashing your node, even if you setup a watchdog to restart it?\r\n\r\n~Could manual deletion of the `anchors.dat` file be a remedy?~ See: https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-582890916",
      "created_at" : "2020-01-29T20:14:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-579939131",
      "id" : 579939131,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3OTkzOTEzMQ==",
      "updated_at" : "2020-02-06T12:49:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/579939131",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r372715777"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/372715777"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "No you're melting 2 different problems, tracking the anchors set and connecting to peers among this one. I don't understand why reaching the `m_max_outbound_block_relay` means we have to delete our whole repository of maybe-good anchors peers. \r\n\r\nIn the scenario you're aiming, if victim restarts and the 2 anchors peers are honest but unreliable, you're going to drop them and pick maybe new outbound peers from attacker-provided ones. You can avoid this if you have a bigger set of _potential_ anchor peers.\r\n",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-30T01:12:22Z",
      "diff_hunk" : "@@ -2176,12 +2176,19 @@ void CConnman::SetNetworkActive(bool active)\n     uiInterface.NotifyNetworkActiveChanged(fNetworkActive);\n }\n \n-CConnman::CConnman(uint64_t nSeed0In, uint64_t nSeed1In) : nSeed0(nSeed0In), nSeed1(nSeed1In)\n+CConnman::CConnman(uint64_t nSeed0In, uint64_t nSeed1In)\n+    : m_anchors_db_path{GetDataDir() / \"anchors.dat\"}, nSeed0(nSeed0In), nSeed1(nSeed1In)\n {\n     SetTryNewOutboundPeer(false);\n \n     Options connOptions;\n     Init(connOptions);\n+\n+    m_anchors = ReadAnchors(m_anchors_db_path);\n+    if (m_anchors.size() > m_max_outbound_block_relay) {\n+        // Keep our policy safe.\n+        m_anchors.clear();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r372715777",
      "id" : 372715777,
      "in_reply_to_id" : 367057240,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxNTc3Nw==",
      "original_commit_id" : "ea5a307eaf1a2325b33df6a2a35ea6df783f4e6b",
      "original_position" : 16,
      "path" : "src/net.cpp",
      "position" : null,
      "pull_request_review_id" : 350530344,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-30T01:12:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/372715777",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r372718282"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/372718282"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "But anchors nodes are block-only, so now you have block-only-as-anchors, full-relay, block-only-classics. You can still test addresses returned from `addrman` against `m_anchors` andon continue in case of equality to avoid the problem you're describing, but don't think that changes something, do we favor first-connected nodes in anyway ?",
      "commit_id" : "a2822de7c042454a73e8f9a357e3539f89562f5e",
      "created_at" : "2020-01-30T01:22:56Z",
      "diff_hunk" : "@@ -1805,11 +1807,24 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             if (nTries > 100)\n                 break;\n \n-            CAddrInfo addr = addrman.SelectTriedCollision();\n+            CAddress addr;\n+            if (!m_anchors.empty() && (nOutboundBlockRelay < m_max_outbound_block_relay) && !fFeeler) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#discussion_r372718282",
      "id" : 372718282,
      "in_reply_to_id" : 367073224,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjcxODI4Mg==",
      "original_commit_id" : "d405145e8f935b454ba77e23cf7327515b85151e",
      "original_position" : 15,
      "path" : "src/net.cpp",
      "position" : 34,
      "pull_request_review_id" : 350533306,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17428",
      "updated_at" : "2020-01-30T01:22:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/372718282",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@hebasto \r\n\r\nConcept ACK, reading your comment I do understand that this PR is really-scoped, so don't mind https://github.com/bitcoin/bitcoin/issues/17326#issuecomment-580033087 and https://github.com/bitcoin/bitcoin/pull/17428#discussion_r372715777 but would happily review future work to make anchors better (sorry for the noise)\r\n\r\nA note explaining the exact attack scenario mitigated near to m_anchors or somewhere else would be cool to avoid future reviewers relying on wrong-scoped security assumptions.\r\n\r\nGoign to test PR soon.",
      "created_at" : "2020-01-30T01:50:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-580047275",
      "id" : 580047275,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MDA0NzI3NQ==",
      "updated_at" : "2020-01-30T01:50:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/580047275",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@luke-jr oy. uh. forget them if you uncleanly exit?",
      "created_at" : "2020-01-30T08:15:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-580134777",
      "id" : 580134777,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MDEzNDc3Nw==",
      "updated_at" : "2020-01-30T08:15:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/580134777",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2020-02-05T13:51:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-582416644",
      "id" : 582416644,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MjQxNjY0NA==",
      "updated_at" : "2020-02-05T13:51:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/582416644",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased after #18023 has been merged.",
      "created_at" : "2020-02-05T21:36:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-582624214",
      "id" : 582624214,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MjYyNDIxNA==",
      "updated_at" : "2020-02-05T21:36:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/582624214",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@luke-jr \r\n> Couldn't there be a risk here, that if one of the anchor peers is malicious and knows a DoS vulnerability, this ensures they can keep repeatedly crashing your node, even if you setup a watchdog to restart it?\r\n\r\nIf an exploitable DoS vulnerability would exist, this risk would come true, unfortunately.\r\nAs a DoS attack timing is unpredictable, it seems infeasible to prevent such a risk in the scope of this PR. This might be prevented by means of detecting a particular DoS attack, no?",
      "created_at" : "2020-02-06T12:49:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-582890916",
      "id" : 582890916,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4Mjg5MDkxNg==",
      "updated_at" : "2020-02-06T12:49:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/582890916",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">If an exploitable DoS vulnerability would exist, this risk would come true, unfortunately.\r\n\r\nThis is probably among the more common vulnerability types.\r\n\r\n(Let's go with @gmaxwell's suggestion to address it.)",
      "created_at" : "2020-02-06T13:33:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-582907316",
      "id" : 582907316,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MjkwNzMxNg==",
      "updated_at" : "2020-02-06T13:33:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/582907316",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "After a consideration of @luke-jr's concerns and @gmaxwell's suggestion, I'm going to close this PR.\r\n\r\nThe initial idea to mitigate eclipse attacks based on node restarts, included ones initiated by adversary, introduces a [new risk](https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-579580035).\r\n\r\n@gmaxwell's [suggestion](https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-580134777) nullifies the initial idea by making anchoring usable only for clean (user initiated) restarts. The long-term impact of such changes on the entire p2p network is unclear, and requires further study.",
      "created_at" : "2020-02-08T13:34:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-583737058",
      "id" : 583737058,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzczNzA1OA==",
      "updated_at" : "2020-02-08T13:34:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583737058",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think closing this is a mistake.  Not saving state across crashes in no way nullifies the advantage of preserving connections, and it's also a natural implementation-- e.g. the software will fail to write out the latest peers.dat across a crash.",
      "created_at" : "2020-02-08T14:42:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-583742368",
      "id" : 583742368,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4Mzc0MjM2OA==",
      "updated_at" : "2020-02-08T14:42:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583742368",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gmaxwell \r\n> I think closing this is a mistake. Not saving state across crashes in no way nullifies the advantage of preserving connections, and it's also a natural implementation-- e.g. the software will fail to write out the latest peers.dat across a crash.\r\n\r\nReopened. Going to implement your suggestion soon.\r\n\r\nDefinitely, the OP requires an update.",
      "created_at" : "2020-02-08T14:49:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17428#issuecomment-583743029",
      "id" : 583743029,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17428",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4Mzc0MzAyOQ==",
      "updated_at" : "2020-02-08T14:49:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583743029",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   }
]
