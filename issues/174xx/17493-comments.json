[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#17812](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17812.html) (config, test: asmap functional tests and feature refinements by jonatack)\n* [#17783](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17783.html) (util: Fix -norpcwhitelist, -norpcallowip, and similar corner case behavior by ryanofsky)\n* [#17482](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17482.html) (util: Disallow network-qualified command line options by ryanofsky)\n* [#17106](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17106.html) (Chainparams: Decouple AllowSetMockTime from MineBlocksOnDemand by jtimon)\n* [#17032](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17032.html) (Tests: Chainparams: Make regtest almost fully customizable by jtimon)\n* [#16673](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16673.html) (Relog configuration args on debug.log rotation by LarryRuane)\n* [#16545](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16545.html) (refactor: Implement missing error checking for ArgsManager flags by ryanofsky)\n* [#16411](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16411.html) (BIP-325: Signet support by kallewoof)\n* [#16115](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16115.html) (On bitcoind startup, write config args to debug.log by LarryRuane)\n* [#15761](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15761.html) (Replace -upgradewallet startup option with upgradewallet RPC by achow101)\n* [#15367](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15367.html) (feature: Added ability for users to add a startup command by benthecarman)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-11-16T00:31:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17493#issuecomment-554581928",
      "id" : 554581928,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17493",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NDU4MTkyOA==",
      "updated_at" : "2020-01-08T00:04:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554581928",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17493#discussion_r347614438"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17493"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347614438"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Perhaps only err if the value differs?",
      "commit_id" : "e81c6ea28d72bba266eb8416550ea1776e72c726",
      "created_at" : "2019-11-18T21:18:45Z",
      "diff_hunk" : "@@ -744,13 +803,16 @@ bool ArgsManager::ReadConfigStream(std::istream& stream, const std::string& file\n     for (const std::pair<std::string, std::string>& option : options) {\n         std::string section;\n         std::string key = option.first;\n-        util::SettingsValue value = InterpretOption(section, key, option.second);\n-        const unsigned int flags = FlagsOfKnownArg(key);\n+        bool negated = !InterpretKey(section, key, &option.second);\n+        Optional<unsigned int> flags = GetArgFlags('-' + key);\n         if (flags) {\n-            if (!CheckValid(key, value, flags, error)) {\n+            if (!(*flags & ALLOW_LIST) && m_settings.ro_config[section].count(key)) {\n+                error = strprintf(\"Multiple values specified for -%s in same section of config file.\", key);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17493#discussion_r347614438",
      "id" : 347614438,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0NzYxNDQzOA==",
      "original_commit_id" : "e81c6ea28d72bba266eb8416550ea1776e72c726",
      "original_position" : 335,
      "path" : "src/util/system.cpp",
      "position" : 335,
      "pull_request_review_id" : 318636254,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17493",
      "updated_at" : "2019-11-18T21:23:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347614438",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-12-19T20:15:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17493#issuecomment-567646199",
      "id" : 567646199,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17493",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2NzY0NjE5OQ==",
      "updated_at" : "2019-12-19T20:15:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/567646199",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Weak concept NACK on this, precedence in config files might be confusing but it's not ambiguous and specifying `setting=1 \\n setting=2` is something you might plausibly see in the wild, so this change has the potential to cause systems to not restart correctly... Maybe having a warning rather than an error for a release would be better? Still, better to make the change once for everything than gradually as things get switched away from ALLOW_ANY to something more specific.",
      "created_at" : "2020-01-09T05:16:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17493#issuecomment-572391776",
      "id" : 572391776,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17493",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MjM5MTc3Ng==",
      "updated_at" : "2020-01-09T05:16:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/572391776",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> so this change has the potential to cause systems to not restart correctly...\r\n\r\nThis description sounds a little misleading to me. It is true that if someone had an ambiguous config file, and they updated to a new bitcoin version and then restarted without testing, they would see a \"Multiple values specified for -foo in same section of config file\" init error. But there wouldn't be a question of correctness, or risk that the new version would start up using different settings than the old version.\r\n\r\nPersonally, I don't think a debug log warning would be as good as an error here, given experience with issues like #15629 where warnings have seemed pretty easy to miss. I understand your concern about the case where someone upgrades their version of bitcoin and sees an error about an insignificant ambiguity in their config file. But I wouldn't want to forget about cases where someone could upgrade bitcoin be prompted to fix config errors that actually affected their privacy or security.\r\n\r\nI wonder what you think about Jeremy's suggestion to prevent errors in more spurious cases where a setting is repeated but the value doesn't change: https://github.com/bitcoin/bitcoin/pull/17493#pullrequestreview-318636254. It'd be pretty easy to tweak the PR to avoid triggering errors in these cases.",
      "created_at" : "2020-01-09T20:18:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17493#issuecomment-572736951",
      "id" : 572736951,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17493",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MjczNjk1MQ==",
      "updated_at" : "2020-01-09T20:18:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/572736951",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
