[
   {
      "body" : "Very nice! Before looking over the work itself, I wanted to be sure that libevent was viable for all of our build targets.\r\n\r\nSee here for the build-system work. This should be enough to get Travis passing, I'd think:\r\nhttps://github.com/theuni/bitcoin/commits/5677",
      "created_at" : "2015-01-20T03:49:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70600574",
      "id" : 70600574,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T03:49:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70600574",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@cfields Will pull that in, thanks a lot!",
      "created_at" : "2015-01-20T05:00:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70604873",
      "id" : 70604873,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T05:00:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70604873",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Hm, nothing special needed for longpolling?",
      "created_at" : "2015-01-20T05:04:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70605115",
      "id" : 70605115,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T05:04:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70605115",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@luke-jr I don't think so. The current implementation should work. Of course it would be more optimal to release the worker thread while longpolling, and change \"new block\" it into an event-trigger, but I leave that as a challenge for later.",
      "created_at" : "2015-01-20T05:14:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70605676",
      "id" : 70605676,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T05:14:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70605676",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "The fail in \"32-bit + dash\" is strange\r\n\r\n    FAIL: qt/test/test_bitcoin-qt\r\n\r\nI'm not sure how this can be affected at all (passes fine here), but I'll check.\r\n\r\nOn Win32/64 it still tries to link against libevent_pthread. IIRC there is no specific thread library for windows, `evthread_use_windows_threads` is part of the core library there.\r\n\r\n    /usr/bin/x86_64-w64-mingw32-ld: cannot find -levent_pthreads\r\n",
      "created_at" : "2015-01-20T06:37:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70610849",
      "id" : 70610849,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T06:39:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70610849",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Blah, sorry, missed that one.",
      "created_at" : "2015-01-20T06:45:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70611391",
      "id" : 70611391,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T06:45:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70611391",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "It's easy to miss those sneaky qt unit tests. Windows passes now!\r\n\r\nThat leaves the `32-bit + dash` case, which is not an intermittent issue\r\n```\r\nFAIL! : PaymentServerTests::paymentServerTests() Compared values are not the same\r\nActual (merchant):\r\nExpected (QString(\"testmerchant.org\")): testmerchant.org\r\nLoc: [qt/test/paymentservertests.cpp(84)]\r\n```\r\n... no clue how this happens yet. The Qt tests don't use the RPC mechanism. My gut feeling is some interaction with OpenSSL which, absent verification, is now an indirect dependency through Qt? Not sure, and why it only happens in this test is a mystery to me.\r\n",
      "created_at" : "2015-01-20T07:21:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70613765",
      "id" : 70613765,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T07:21:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70613765",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj Yes, it has some interaction with qt:\r\n- ./configure --with-gui=qt4: fine.\r\n- ./configure --with-gui=qt5: fine.\r\n- make -C depends; ./configure --prefix=\\`pwd\\`/depends/x86_64-unknown-linux-gnu: busted\r\n- make -C depends USE_LINUX_STATIC_QT5=1;  ./configure --prefix=\\`pwd\\`/depends/x86_64-unknown-linux-gnu: fine.",
      "created_at" : "2015-01-20T08:23:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70619366",
      "id" : 70619366,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T08:23:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70619366",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "tested gitian build.\r\nBinaries to test: https://builds.jonasschnelli.ch/pulls/5677/",
      "created_at" : "2015-01-20T15:11:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70668199",
      "id" : 70668199,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-20T15:11:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70668199",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Concept ACK",
      "created_at" : "2015-01-21T14:28:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-70845949",
      "id" : 70845949,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-21T14:28:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/70845949",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Now that the code is stable it is time for some benchmarking.\r\nI found a nice scriptable framework for HTTP benchmarking, [wrk](https://github.com/wg/wrk). Some results.\r\nThese benchmarks were taken at the default settings (4 worker threads, 16 depth work queue).\r\n\r\n### GET request to invalid URL\r\nThese are handled by evhttp itself, so this is the baseline.\r\n```\r\n$  ./wrk -t12 -c15 -d10s http://127.0.0.1:18332/inv\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   375.53us   66.86us   6.31ms   93.03%\r\n    Req/Sec     2.67k   121.28     3.11k    80.98%\r\n  303293 requests in 10.00s, 36.73MB read\r\n  Non-2xx or 3xx responses:\r\n    404: 303293\r\nRequests/sec:  30343.08\r\nTransfer/sec:      3.68MB\r\n```\r\nAs expected, we get 404s.\r\n### GET request to /\r\n\r\nThese are dispatched to a worker thread. Some more latency is expected. In the worker thread these error out early, as GET is not a valid method for JSON RPC.\r\n```\r\n$ ./wrk -t12 -c15 -d10s http://127.0.0.1:18332/\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   472.96us   44.12us   1.28ms   93.31%\r\n    Req/Sec     2.14k   127.02     2.33k    82.90%\r\n  245025 requests in 10.00s, 41.59MB read\r\n  Non-2xx or 3xx responses:\r\n    405: 245025\r\nRequests/sec:  24514.30\r\nTransfer/sec:      4.16MB\r\n```\r\nAs expected: lots of 405 (invalid method for URL) results.\r\n### RPC getgenerate requests\r\nPost `getgenerate` requests. This is an extremely cheap RPC call.\r\nScript:\r\n```lua\r\nwrk.method = \"POST\"\r\nwrk.body   = \"{\\\"method\\\":\\\"getgenerate\\\",\\\"params\\\":[],\\\"id\\\":1}\\n\"\r\nwrk.headers[\"Content-Type\"] = \"application/json\"\r\nwrk.headers[\"Authorization\"] = \"Basic XXX\"\r\n```\r\n```\r\n$ ./wrk -t12 -c15 -d10s -s getgenerate.lua http://127.0.0.1:18332/\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   571.28us   59.77us   2.09ms   91.89%\r\n    Req/Sec     1.82k   110.56     2.00k    80.32%\r\n  204481 requests in 9.99s, 28.28MB read\r\n  Non-2xx or 3xx responses:\r\nRequests/sec:  20463.77\r\nTransfer/sec:      2.83MB\r\n```\r\nAll responses succesful.\r\n### RPC getinfo requests\r\nPost `getinfo` requests. This is a more expensive RPC call.\r\n```lua\r\nwrk.method = \"POST\"\r\nwrk.body   = \"{\\\"method\\\":\\\"getinfo\\\",\\\"params\\\":[],\\\"id\\\":1}\\n\"\r\nwrk.headers[\"Content-Type\"] = \"application/json\"\r\nwrk.headers[\"Authorization\"] = \"Basic XXX\r\n```\r\n```\r\n$ ./wrk -t12 -c15 -d10s -s getinfo.lua http://127.0.0.1:18332/\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency     1.69ms  572.87us  15.39ms   95.21%\r\n    Req/Sec   626.46     81.57     1.00k    84.26%\r\n  71245 requests in 9.99s, 37.17MB read\r\n  Non-2xx or 3xx responses:\r\nRequests/sec:   7128.48\r\nTransfer/sec:      3.72MB\r\n```\r\nAlthough the performance goes down, no errors happen. The maximum queue depth is never reached.\r\n\r\n### RPC requests w/ invalid authentication\r\nPost `getinfo` requests with invalid authentication. This will trigger a 250ms delay, and thus we can trigger worker queue-full conditions with enough threads.\r\n```lua\r\nwrk.method = \"POST\"\r\nwrk.body   = \"{\\\"method\\\":\\\"getinfo\\\",\\\"params\\\":[],\\\"id\\\":1}\\n\"\r\nwrk.headers[\"Content-Type\"] = \"application/json\"\r\nwrk.headers[\"Authorization\"] = \"Basic YYY\r\n```\r\n```\r\n$ ./wrk -t12 -c15 -d10s -s getinfo_unauth.lua http://127.0.0.1:18332/\r\nThread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   751.03ms  323.38us 752.15ms   81.82%\r\n    Req/Sec     1.05      0.65     2.00     58.33%\r\n  156 requests in 10.00s, 19.80KB read\r\n  Non-2xx or 3xx responses:\r\n    401: 156\r\nRequests/sec:     15.60\r\nTransfer/sec:      1.98KB\r\n```\r\nIncreasing the load further, we can exceed the work queue depth:\r\n```\r\n$ ./wrk -t12 -c45 -d10s -s getinfo_unauth.lua http://127.0.0.1:18332/\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   204.35ms  462.08ms   1.25s    83.72%\r\n    Req/Sec     2.42k     1.53k    6.00k    75.64%\r\n  277072 requests in 10.00s, 43.59MB read\r\n  Non-2xx or 3xx responses:\r\n    401: 156\r\n    500: **276916**\r\nRequests/sec:  27706.71\r\nTransfer/sec:      4.36MB\r\n```\r\n\r\nLooks good. Nothing unexpected, it's clear the evhttp is not the bottleneck, and the work queue works as expected. Will try this with the old asio-based HTTP server shortly.\r\n",
      "created_at" : "2015-01-23T10:26:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71174411",
      "id" : 71174411,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T10:26:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71174411",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "## Old http server\r\nSame steps as above, repeated with the old server as of commit 944c256.\r\n\r\n### GET request to invalid URL\r\n```\r\n$  ./wrk -t12 -c15 -d10s http://127.0.0.1:18332/inv\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   502.17us   94.60us   2.65ms   74.77%\r\n    Req/Sec     1.89k   119.76     2.33k    83.38%\r\n  214864 requests in 9.99s, 37.50MB read\r\n  Responses:\r\n    404: 214864\r\nRequests/sec:  21502.28\r\nTransfer/sec:      3.75MB\r\n```\r\n### GET request to /\r\n\r\n```\r\n$ ./wrk -t12 -c15 -d10s http://127.0.0.1:18332/\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   502.58us   92.30us   2.07ms   73.39%\r\n    Req/Sec     1.89k   118.97     2.22k    83.36%\r\n  214269 requests in 9.99s, 103.40MB read\r\n  Responses:\r\n    401: 214269\r\nRequests/sec:  21447.93\r\nTransfer/sec:     10.35MB\r\n```\r\n\r\n### RPC getgenerate requests\r\n```\r\n$ ./wrk -t12 -c15 -d10s -s getgenerate.lua http://127.0.0.1:18332/\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency    93.68us   24.84us   1.27ms   89.23%\r\n    Req/Sec    10.06k   616.30    11.78k    64.49%\r\n  380211 requests in 10.00s, 78.32MB read\r\n  Socket errors: connect 0, read 0, write 0, timeout 39\r\n  Responses:\r\n    200: 380211\r\nRequests/sec:  38006.24\r\nTransfer/sec:      7.83MB\r\n```\r\n### RPC getinfo requests\r\n```\r\n$ ./wrk -t12 -c15 -d10s -s getinfo.lua http://127.0.0.1:18332/\r\nRunning 10s test @ http://127.0.0.1:18332/\r\n  12 threads and 15 connections\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   544.15us  187.74us   4.03ms   79.81%\r\n    Req/Sec     1.89k   188.50     2.90k    63.09%\r\n  71480 requests in 10.00s, 42.13MB read\r\n  Socket errors: connect 0, read 0, write 0, timeout 39\r\n  Responses:\r\n    200: 71480\r\nRequests/sec:   7144.83\r\nTransfer/sec:      4.21MB\r\n```\r\n### RPC requests w/ invalid authentication\r\n```\r\n$ ./wrk -t12 -c15 -d10s -s getinfo_unauth.lua http://127.0.0.1:18332/\r\n  12 threads and 15 connections\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency   751.75ms  161.83us 752.03ms   73.91%\r\n    Req/Sec     0.94      0.66     2.00     56.52%\r\n  156 requests in 10.00s, 77.09KB read\r\n  Responses:\r\n    401: 156\r\nRequests/sec:     15.60\r\nTransfer/sec:      7.71KB\r\n```\r\n```\r\n$ ./wrk -t12 -c45 -d10s -s getinfo_unauth.lua http://127.0.0.1:18332/\r\nRunning 10s test @ http://127.0.0.1:18332/\r\n  12 threads and 45 connections\r\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\r\n    Latency     2.19s   309.47ms   2.26s    95.24%\r\n    Req/Sec     0.90      1.56     6.00     87.30%\r\n  156 requests in 10.01s, 77.09KB read\r\n  Socket errors: connect 0, read 0, write 0, timeout 24\r\n  Responses:\r\n    401: 156\r\nRequests/sec:     15.59\r\nTransfer/sec:      7.70KB\r\n```\r\n\r\n## Summary\r\n\r\n```\r\nTestcase                      Old (r/s) New (r/s)\r\n================================================\r\nGET request to invalid URL    21502     30343\r\nGET request to /              21448     24514\r\nRPC getgenerate requests      38006*    20463\r\nRPC getinfo requests           7144*     7128\r\nRPC requests w/ invalid auth     16*       16\r\n\r\n* with timeout errors.\r\n```\r\n\r\n- The new server wins on the base http requests front. Even to /, which are dispatched to the worker threads.\r\n\r\n- The old server is currently much faster with `getgenerate` requests. I am curious why. Also: how can getgenerate requests be faster than simple `GET /`'s? I suspect a measurement error that has to do with the timeouts (**edit**: this is because the old server disconnects after errors, so those don't utilize keepalive).\r\n\r\n- `getinfo` requests are, as expected, ~ the same speed. Processing overhead dominates.\r\n\r\n- Same for unauthenticated requests. The requests take 250ms to handle so the number seen is exactly as expected.\r\n\r\nTake into account that it's not entirely a fair comparison: the new http server can service a large number of connections at the same time, whereas the old server can have a maximum of four (or, `-rpcthreads`) and starves additional.connections (thanks to keep-alive). There is some overhead in multiplexing that is absent in a one-to-one scenario. This is also a purely a local benchmark. I/O bandwidth doesn't come into it, and the benchmark tool competes for the same CPU as the server.",
      "created_at" : "2015-01-23T11:09:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71179035",
      "id" : 71179035,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T14:57:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71179035",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Why are we dropping SSL support for RPC?",
      "created_at" : "2015-01-23T11:20:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71180158",
      "id" : 71180158,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T11:20:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71180158",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r23444511"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23444511"
         }
      },
      "body" : "Just to understand why are you explicitly using == NULL here and for base above just !var?",
      "commit_id" : "6f1259a8cf186466e113f93175c58663c83f0ecd",
      "created_at" : "2015-01-23T11:25:12Z",
      "diff_hunk" : "@@ -104,48 +143,59 @@ Object CallRPC(const string& strMethod, const Array& params)\n               \"If the file does not exist, create it with owner-readable-only file permissions.\"),\n                 GetConfigFile().string().c_str()));\n \n-    // Connect to localhost\n-    bool fUseSSL = GetBoolArg(\"-rpcssl\", false);\n-    boost::asio::io_service io_service;\n-    boost::asio::ssl::context context(io_service, boost::asio::ssl::context::sslv23);\n-    context.set_options(boost::asio::ssl::context::no_sslv2 | boost::asio::ssl::context::no_sslv3);\n-    boost::asio::ssl::stream<boost::asio::ip::tcp::socket> sslStream(io_service, context);\n-    SSLIOStreamDevice<boost::asio::ip::tcp> d(sslStream, fUseSSL);\n-    boost::iostreams::stream< SSLIOStreamDevice<boost::asio::ip::tcp> > stream(d);\n-\n-    const bool fConnected = d.connect(GetArg(\"-rpcconnect\", \"127.0.0.1\"), GetArg(\"-rpcport\", itostr(BaseParams().RPCPort())));\n-    if (!fConnected)\n+    std::string host = GetArg(\"-rpcconnect\", \"127.0.0.1\");\n+    int port = GetArg(\"-rpcport\", BaseParams().RPCPort());\n+\n+    // Create event base\n+    struct event_base *base = event_base_new(); // XXX RAII\n+    if (!base)\n+        throw runtime_error(\"cannot create event_base\");\n+\n+    // Synchronously look up hostname\n+    struct evhttp_connection *evcon = evhttp_connection_base_new(base, NULL, host.c_str(), port); // XXX RAII\n+    if (evcon == NULL)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r23444511",
      "id" : 23444511,
      "original_commit_id" : "6f1259a8cf186466e113f93175c58663c83f0ecd",
      "original_position" : 94,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 94,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-01-23T11:25:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23444511",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r23444540"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23444540"
         }
      },
      "body" : "Perhaps use some constant or struct for such strings and use a speaking name in the code?",
      "commit_id" : "6f1259a8cf186466e113f93175c58663c83f0ecd",
      "created_at" : "2015-01-23T11:26:08Z",
      "diff_hunk" : "@@ -104,48 +143,59 @@ Object CallRPC(const string& strMethod, const Array& params)\n               \"If the file does not exist, create it with owner-readable-only file permissions.\"),\n                 GetConfigFile().string().c_str()));\n \n-    // Connect to localhost\n-    bool fUseSSL = GetBoolArg(\"-rpcssl\", false);\n-    boost::asio::io_service io_service;\n-    boost::asio::ssl::context context(io_service, boost::asio::ssl::context::sslv23);\n-    context.set_options(boost::asio::ssl::context::no_sslv2 | boost::asio::ssl::context::no_sslv3);\n-    boost::asio::ssl::stream<boost::asio::ip::tcp::socket> sslStream(io_service, context);\n-    SSLIOStreamDevice<boost::asio::ip::tcp> d(sslStream, fUseSSL);\n-    boost::iostreams::stream< SSLIOStreamDevice<boost::asio::ip::tcp> > stream(d);\n-\n-    const bool fConnected = d.connect(GetArg(\"-rpcconnect\", \"127.0.0.1\"), GetArg(\"-rpcport\", itostr(BaseParams().RPCPort())));\n-    if (!fConnected)\n+    std::string host = GetArg(\"-rpcconnect\", \"127.0.0.1\");\n+    int port = GetArg(\"-rpcport\", BaseParams().RPCPort());\n+\n+    // Create event base\n+    struct event_base *base = event_base_new(); // XXX RAII\n+    if (!base)\n+        throw runtime_error(\"cannot create event_base\");\n+\n+    // Synchronously look up hostname\n+    struct evhttp_connection *evcon = evhttp_connection_base_new(base, NULL, host.c_str(), port); // XXX RAII\n+    if (evcon == NULL)\n+        throw runtime_error(\"create connection failed\");\n+    evhttp_connection_set_timeout(evcon, GetArg(\"-rpctimeout\", 30));\n+\n+    HTTPReply response;\n+    struct evhttp_request *req = evhttp_request_new(http_request_done, (void*)&response); // XXX RAII\n+    if (req == NULL)\n+        throw runtime_error(\"create http request failed\");\n+\n+    struct evkeyvalq *output_headers = evhttp_request_get_output_headers(req);\n+    assert(output_headers);\n+    evhttp_add_header(output_headers, \"Host\", host.c_str());\n+    evhttp_add_header(output_headers, \"Connection\", \"close\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r23444540",
      "id" : 23444540,
      "original_commit_id" : "6f1259a8cf186466e113f93175c58663c83f0ecd",
      "original_position" : 106,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 106,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-01-23T11:26:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23444540",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@diapolo Re: this pull: because I don't feel like implementing it.\r\n\r\nIn the longer term I (and many others) would also argue it is better to drop it:\r\n- Makes it possible to drop OpenSSL dependency from bitcoind completely, after secp256k1 verification is used. Simplifies the code overall.\r\n- I've never heard of anyone using SSL with RPC. It may also be better not to know; after all, this invites opening up the RPC port reachable to the internet or other untrusted networks. The limited amount of configurability of rpcssl almost guarantees this will be an insecure setup.\r\n- If you *really* need to use RPC remotely over an untrusted network, it is easy enough to set up stunnel or a SSH tunnel, or even e.g. OpenVPN, with the full power of those tools available you may have a chance of doing so securely.\r\n",
      "created_at" : "2015-01-23T11:29:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71181146",
      "id" : 71181146,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T14:52:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71181146",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r23444766"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23444766"
         }
      },
      "body" : "@diapolo  `== NULL` and `!evcon` are equivalent in this case so purely a matter to taste.  The pull clearly states [PoC] as for proof-of-concept, please don't report all these minor things but only critical or high-level issues,",
      "commit_id" : "6f1259a8cf186466e113f93175c58663c83f0ecd",
      "created_at" : "2015-01-23T11:32:43Z",
      "diff_hunk" : "@@ -104,48 +143,59 @@ Object CallRPC(const string& strMethod, const Array& params)\n               \"If the file does not exist, create it with owner-readable-only file permissions.\"),\n                 GetConfigFile().string().c_str()));\n \n-    // Connect to localhost\n-    bool fUseSSL = GetBoolArg(\"-rpcssl\", false);\n-    boost::asio::io_service io_service;\n-    boost::asio::ssl::context context(io_service, boost::asio::ssl::context::sslv23);\n-    context.set_options(boost::asio::ssl::context::no_sslv2 | boost::asio::ssl::context::no_sslv3);\n-    boost::asio::ssl::stream<boost::asio::ip::tcp::socket> sslStream(io_service, context);\n-    SSLIOStreamDevice<boost::asio::ip::tcp> d(sslStream, fUseSSL);\n-    boost::iostreams::stream< SSLIOStreamDevice<boost::asio::ip::tcp> > stream(d);\n-\n-    const bool fConnected = d.connect(GetArg(\"-rpcconnect\", \"127.0.0.1\"), GetArg(\"-rpcport\", itostr(BaseParams().RPCPort())));\n-    if (!fConnected)\n+    std::string host = GetArg(\"-rpcconnect\", \"127.0.0.1\");\n+    int port = GetArg(\"-rpcport\", BaseParams().RPCPort());\n+\n+    // Create event base\n+    struct event_base *base = event_base_new(); // XXX RAII\n+    if (!base)\n+        throw runtime_error(\"cannot create event_base\");\n+\n+    // Synchronously look up hostname\n+    struct evhttp_connection *evcon = evhttp_connection_base_new(base, NULL, host.c_str(), port); // XXX RAII\n+    if (evcon == NULL)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#discussion_r23444766",
      "id" : 23444766,
      "original_commit_id" : "6f1259a8cf186466e113f93175c58663c83f0ecd",
      "original_position" : 94,
      "path" : "src/bitcoin-cli.cpp",
      "position" : 94,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/5677",
      "updated_at" : "2015-01-23T11:32:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/23444766",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I agree with @laanwj. SSL support could lead somebody to believe it's \"save\". IMO it currently a bad idea to expose bitcoind RPC to a public accessible area. Nevertheless, If one like to do this, he could still do a apache ssl enable reverse proxy to bitcoind's RPC.",
      "created_at" : "2015-01-23T12:05:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71184656",
      "id" : 71184656,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T12:05:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71184656",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Also SSL in the RPC massively increases the attack surface we have exposed (if you also expose it to the outside world) and we've had to push updates previously on account of it-- even though we believe its a feature virtually no one uses.  As mentioned it can be better accomplished via stunnel (or any of several other tools)",
      "created_at" : "2015-01-23T14:27:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71200027",
      "id" : 71200027,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T14:27:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71200027",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "I agree, it was a mistake to add SSL support to the RPC (mea culpa-- I wrote the original version of that code).\r\n",
      "created_at" : "2015-01-23T16:13:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-71217270",
      "id" : 71217270,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-01-23T16:13:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/71217270",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "concept ACK.\r\nneeds rebase.",
      "created_at" : "2015-02-04T15:07:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-72870617",
      "id" : 72870617,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-02-04T15:07:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/72870617",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "If I might chime in on the SSL discussion: I am not sure whether it should be removed. In terms of integrating bitcoin core into a bigger system, I would expect that it offers SSL in order to protect credentials. This has not much to do with publicly available access, I habitually do this for any service that sends credentials over any network (and I think that this is quite advisable for a bitcoin wallet). Of course, setting up an encrypted tunnel might be an option, but it's cumbersome and error-prone.\r\n\r\nI would maybe propose a different route: leave the core's RPC functions unauthenticated, and add authentication and SSL to the wallet.",
      "created_at" : "2015-02-21T07:47:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-75360870",
      "id" : 75360870,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-02-21T07:47:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/75360870",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/179920?v=3",
         "events_url" : "https://api.github.com/users/arnuschky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/arnuschky/followers",
         "following_url" : "https://api.github.com/users/arnuschky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/arnuschky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/arnuschky",
         "id" : 179920,
         "login" : "arnuschky",
         "organizations_url" : "https://api.github.com/users/arnuschky/orgs",
         "received_events_url" : "https://api.github.com/users/arnuschky/received_events",
         "repos_url" : "https://api.github.com/users/arnuschky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/arnuschky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/arnuschky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/arnuschky"
      }
   },
   {
      "body" : "@arnuschky There is no secure way to expose RPC to an untrusted network, whether you use the wallet or not. Although perhaps with a libevent-based server maybe that changes...",
      "created_at" : "2015-02-21T07:58:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-75361175",
      "id" : 75361175,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-02-21T07:58:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/75361175",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@arnuschky The HTTP REST interface provides unauthenticated access to public blockchain data: https://github.com/bitcoin/bitcoin/blob/master/doc/REST-interface.md",
      "created_at" : "2015-02-21T15:46:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-75377248",
      "id" : 75377248,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-02-21T15:46:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/75377248",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "@luke-jr What are you referring to? \r\n\r\nSorry, it seems that I haven't made myself clear. I agree that it is advisable to get rid of the openssl dependency in bitcoin core. However, losing the SSL feature for wallet RPC is a bit annoying from the system integrator's point of view - it just makes deployment more complex. I don't agree with the black-and-white consideration of a \"trusted\" vs \"untrusted\" network. Even in a so-called \"trusted\" network, there might be bad actors (hoster, employees, compromised servers etc). Thus, running a wallet RPC access without encryption in a \"trusted\" network is a bad idea, IMO. \r\n\r\nOf course, a tunnel or a reverse proxy is an option, but increases complexity of deployment and is error-prone. Furthermore, if the default is insecure people just run with it. I would even argue the opposite: disable unencrypted RPC (except on 127.0.0.1) - this is also what btcd does, and I find it quite sensible.\r\n\r\nMaybe encrypted RPC could be broken out into the wallet with the upcoming modularization of the wallet code? On the long run, I find the design of btcd or for example the cryptonote coins quite sensible: a unauthenticated RPC for public blockchain data (what is now offered by the REST interface), and on a different port an authenticated, encrypted RPC for wallet access.\r\n\r\nPS: sorry if I am taking this a bit OT here, maybe this should be discussed somewhere else\r\n\r\n",
      "created_at" : "2015-02-22T09:42:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-75427534",
      "id" : 75427534,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-02-22T09:43:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/75427534",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/179920?v=3",
         "events_url" : "https://api.github.com/users/arnuschky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/arnuschky/followers",
         "following_url" : "https://api.github.com/users/arnuschky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/arnuschky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/arnuschky",
         "id" : 179920,
         "login" : "arnuschky",
         "organizations_url" : "https://api.github.com/users/arnuschky/orgs",
         "received_events_url" : "https://api.github.com/users/arnuschky/received_events",
         "repos_url" : "https://api.github.com/users/arnuschky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/arnuschky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/arnuschky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/arnuschky"
      }
   },
   {
      "body" : "Don't let this go unmaintained :)",
      "created_at" : "2015-03-03T12:26:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-76936251",
      "id" : 76936251,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-03-03T12:26:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/76936251",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Needs rebase. I'm willing to help (testing, fixing, etc.).",
      "created_at" : "2015-03-05T08:37:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-77325968",
      "id" : 77325968,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-03-05T08:37:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/77325968",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "I think this also solves https://github.com/bitcoin/bitcoin/issues/5526",
      "created_at" : "2015-03-10T14:15:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-78061333",
      "id" : 78061333,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-03-10T14:15:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/78061333",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Continued +1 on this.\r\n",
      "created_at" : "2015-05-02T19:17:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-98389333",
      "id" : 98389333,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-05-02T19:17:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/98389333",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "This was straightforward to rebase onto master.  While playing with it, this message got printed to the console once:\r\n\r\n    [warn] event_active: event has no event_base set.\r\n\r\nI haven't been able to reproduce it, but I'm banging on it now.",
      "created_at" : "2015-05-05T19:51:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/5677#issuecomment-99201956",
      "id" : 99201956,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5677",
      "updated_at" : "2015-05-05T19:51:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/99201956",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/430315?v=3",
         "events_url" : "https://api.github.com/users/ajweiss/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajweiss/followers",
         "following_url" : "https://api.github.com/users/ajweiss/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajweiss/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajweiss",
         "id" : 430315,
         "login" : "ajweiss",
         "organizations_url" : "https://api.github.com/users/ajweiss/orgs",
         "received_events_url" : "https://api.github.com/users/ajweiss/received_events",
         "repos_url" : "https://api.github.com/users/ajweiss/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajweiss/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajweiss/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajweiss"
      }
   }
]
