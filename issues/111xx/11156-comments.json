[
   {
      "body" : "`CFArrayGetCount` dereferences `listSnapshot` and if it's `nullptr` then it crashes, so how have you tested this?",
      "created_at" : "2017-08-28T11:22:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11156#issuecomment-325327586",
      "id" : 325327586,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11156",
      "updated_at" : "2017-08-28T11:22:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325327586",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "@promag Not sure I understand the question, do you mean\r\n```\r\n+    if (listSnapshot == nullptr) {\r\n+        return nullptr;\r\n+    }\r\n```\r\nadded at 784-786?\r\n\r\nThis is just for safety, it's not really expected for `listSnapshot` to be `nullptr`. I think it makes sense to add this safety in the context of not doing `CFRelease` on `nullptr` at the end. You're right that even without the added lines above, in case of `listSnapshot == nullptr` there will probably be a crash even before we get to the `CFRelease`. Still, seems cleaner to me. \r\n\r\nAlso, in the unlikely case that `listSnapshot` *is* set to `nullptr`, we will return `nullptr` instead of crashing, which is probably nicer behavior anyway. (though, it's up to the caller whether it itself would crash or not)",
      "created_at" : "2017-08-28T20:26:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11156#issuecomment-325470786",
      "id" : 325470786,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11156",
      "updated_at" : "2017-08-28T20:26:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325470786",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/84245?v=4",
         "events_url" : "https://api.github.com/users/danra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/danra/followers",
         "following_url" : "https://api.github.com/users/danra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/danra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/danra",
         "id" : 84245,
         "login" : "danra",
         "organizations_url" : "https://api.github.com/users/danra/orgs",
         "received_events_url" : "https://api.github.com/users/danra/received_events",
         "repos_url" : "https://api.github.com/users/danra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/danra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/danra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/danra"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@ryanofsky I agree, just didn't want to do two things at once - introduce such a class as well as fix problematic code.\r\nOnce this is merged I'm for doing a separate pull requests with a commit that introduces such a class, followed by commits which make use of it.",
      "created_at" : "2017-08-30T07:39:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11156#issuecomment-325909178",
      "id" : 325909178,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11156",
      "updated_at" : "2017-08-30T07:39:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325909178",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/84245?v=4",
         "events_url" : "https://api.github.com/users/danra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/danra/followers",
         "following_url" : "https://api.github.com/users/danra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/danra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/danra",
         "id" : 84245,
         "login" : "danra",
         "organizations_url" : "https://api.github.com/users/danra/orgs",
         "received_events_url" : "https://api.github.com/users/danra/received_events",
         "repos_url" : "https://api.github.com/users/danra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/danra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/danra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/danra"
      }
   }
]
