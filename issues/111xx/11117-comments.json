[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134646607"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134646607"
         }
      },
      "body" : "Block instead?\r\n```cpp\r\nif (...) {\r\n  throw ...;\r\n}\r\n```",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-23T02:47:42Z",
      "diff_hunk" : "@@ -271,11 +271,9 @@ static void MutateTxAddOutAddr(CMutableTransaction& tx, const std::string& strIn\n \n     // extract and validate ADDRESS\n     std::string strAddr = vStrInputParts[1];\n-    CBitcoinAddress addr(strAddr);\n-    if (!addr.IsValid())\n-        throw std::runtime_error(\"invalid TX output address\");\n-    // build standard output script via GetScriptForDestination()\n-    CScript scriptPubKey = GetScriptForDestination(addr.Get());\n+    CTxDestination destination = DecodeDestination(strAddr);\n+    if (!IsValidDestination(destination)) throw std::runtime_error(\"invalid TX output address\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134646607",
      "id" : 134646607,
      "original_commit_id" : "36eb9f2c1a5f979a07e619852c2bf7c8777f9410",
      "original_position" : 10,
      "path" : "src/bitcoin-tx.cpp",
      "position" : null,
      "pull_request_review_id" : 57961836,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134646607",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134647726"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134647726"
         }
      },
      "body" : "Change to\r\n```cpp\r\nif (!destinations.insert(destination).second) {\r\n```",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-23T02:59:37Z",
      "diff_hunk" : "@@ -393,15 +393,17 @@ UniValue createrawtransaction(const JSONRPCRequest& request)\n             CTxOut out(0, CScript() << OP_RETURN << data);\n             rawTx.vout.push_back(out);\n         } else {\n-            CBitcoinAddress address(name_);\n-            if (!address.IsValid())\n-                throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, std::string(\"Invalid Bitcoin address: \")+name_);\n+            CTxDestination destination = DecodeDestination(name_);\n+            if (!IsValidDestination(destination)) {\n+                throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, std::string(\"Invalid Bitcoin address: \") + name_);\n+            }\n \n-            if (setAddress.count(address))\n-                throw JSONRPCError(RPC_INVALID_PARAMETER, std::string(\"Invalid parameter, duplicated address: \")+name_);\n-            setAddress.insert(address);\n+            if (destinations.count(destination)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134647726",
      "id" : 134647726,
      "original_commit_id" : "36eb9f2c1a5f979a07e619852c2bf7c8777f9410",
      "original_position" : 24,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 57961836,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134647726",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134648199"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134648199"
         }
      },
      "body" : "Nit, kind of unrelated, use `.find()` to avoid 2nd lookup below.",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-23T03:04:57Z",
      "diff_hunk" : "@@ -275,24 +275,25 @@ UniValue setaccount(const JSONRPCRequest& request)\n \n     LOCK2(cs_main, pwallet->cs_wallet);\n \n-    CBitcoinAddress address(request.params[0].get_str());\n-    if (!address.IsValid())\n+    CTxDestination dest = DecodeDestination(request.params[0].get_str());\n+    if (!IsValidDestination(dest)) {\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid Bitcoin address\");\n+    }\n \n     std::string strAccount;\n     if (!request.params[1].isNull())\n         strAccount = AccountFromValue(request.params[1]);\n \n     // Only add the account if the address is yours.\n-    if (IsMine(*pwallet, address.Get())) {\n+    if (IsMine(*pwallet, dest)) {\n         // Detect when changing the account of an address that is the 'unused current key' of another account:\n-        if (pwallet->mapAddressBook.count(address.Get())) {\n-            std::string strOldAccount = pwallet->mapAddressBook[address.Get()].name;\n-            if (address == GetAccountAddress(pwallet, strOldAccount)) {\n+        if (pwallet->mapAddressBook.count(dest)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134648199",
      "id" : 134648199,
      "original_commit_id" : "36eb9f2c1a5f979a07e619852c2bf7c8777f9410",
      "original_position" : 62,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 62,
      "pull_request_review_id" : 57961836,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134648199",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134648405"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134648405"
         }
      },
      "body" : "Follow up, should the error message be `Invalid destination address`? ",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-23T03:07:34Z",
      "diff_hunk" : "@@ -451,9 +454,10 @@ UniValue sendtoaddress(const JSONRPCRequest& request)\n \n     LOCK2(cs_main, pwallet->cs_wallet);\n \n-    CBitcoinAddress address(request.params[0].get_str());\n-    if (!address.IsValid())\n+    CTxDestination dest = DecodeDestination(request.params[0].get_str());\n+    if (!IsValidDestination(dest)) {\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid Bitcoin address\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134648405",
      "id" : 134648405,
      "original_commit_id" : "36eb9f2c1a5f979a07e619852c2bf7c8777f9410",
      "original_position" : 115,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 48,
      "pull_request_review_id" : 57961836,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134648405",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134648552"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134648552"
         }
      },
      "body" : "Replace with `.insert().second` like above.",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-23T03:09:28Z",
      "diff_hunk" : "@@ -2695,18 +2704,20 @@ UniValue listunspent(const JSONRPCRequest& request)\n         nMaxDepth = request.params[1].get_int();\n     }\n \n-    std::set<CBitcoinAddress> setAddress;\n+    std::set<CTxDestination> destinations;\n     if (!request.params[2].isNull()) {\n         RPCTypeCheckArgument(request.params[2], UniValue::VARR);\n         UniValue inputs = request.params[2].get_array();\n         for (unsigned int idx = 0; idx < inputs.size(); idx++) {\n             const UniValue& input = inputs[idx];\n-            CBitcoinAddress address(input.get_str());\n-            if (!address.IsValid())\n-                throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, std::string(\"Invalid Bitcoin address: \")+input.get_str());\n-            if (setAddress.count(address))\n-                throw JSONRPCError(RPC_INVALID_PARAMETER, std::string(\"Invalid parameter, duplicated address: \")+input.get_str());\n-           setAddress.insert(address);\n+            CTxDestination dest = DecodeDestination(input.get_str());\n+            if (!IsValidDestination(dest)) {\n+                throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, std::string(\"Invalid Bitcoin address: \") + input.get_str());\n+            }\n+            if (destinations.count(dest)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134648552",
      "id" : 134648552,
      "original_commit_id" : "36eb9f2c1a5f979a07e619852c2bf7c8777f9410",
      "original_position" : 346,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 57961836,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134648552",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134653190"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134653190"
         }
      },
      "body" : "An address is just the string-encoded form of a CTxDestination, so no. I think the \"destination\" name should be internal.",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-23T04:07:41Z",
      "diff_hunk" : "@@ -451,9 +454,10 @@ UniValue sendtoaddress(const JSONRPCRequest& request)\n \n     LOCK2(cs_main, pwallet->cs_wallet);\n \n-    CBitcoinAddress address(request.params[0].get_str());\n-    if (!address.IsValid())\n+    CTxDestination dest = DecodeDestination(request.params[0].get_str());\n+    if (!IsValidDestination(dest)) {\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid Bitcoin address\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134653190",
      "id" : 134653190,
      "original_commit_id" : "36eb9f2c1a5f979a07e619852c2bf7c8777f9410",
      "original_position" : 115,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 48,
      "pull_request_review_id" : 57969073,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134653190",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134653255"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134653255"
         }
      },
      "body" : "Trying to keep this as much of a straightforward change as possible, as it may need backporting.",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-23T04:08:27Z",
      "diff_hunk" : "@@ -275,24 +275,25 @@ UniValue setaccount(const JSONRPCRequest& request)\n \n     LOCK2(cs_main, pwallet->cs_wallet);\n \n-    CBitcoinAddress address(request.params[0].get_str());\n-    if (!address.IsValid())\n+    CTxDestination dest = DecodeDestination(request.params[0].get_str());\n+    if (!IsValidDestination(dest)) {\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid Bitcoin address\");\n+    }\n \n     std::string strAccount;\n     if (!request.params[1].isNull())\n         strAccount = AccountFromValue(request.params[1]);\n \n     // Only add the account if the address is yours.\n-    if (IsMine(*pwallet, address.Get())) {\n+    if (IsMine(*pwallet, dest)) {\n         // Detect when changing the account of an address that is the 'unused current key' of another account:\n-        if (pwallet->mapAddressBook.count(address.Get())) {\n-            std::string strOldAccount = pwallet->mapAddressBook[address.Get()].name;\n-            if (address == GetAccountAddress(pwallet, strOldAccount)) {\n+        if (pwallet->mapAddressBook.count(dest)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134653255",
      "id" : 134653255,
      "original_commit_id" : "36eb9f2c1a5f979a07e619852c2bf7c8777f9410",
      "original_position" : 62,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 62,
      "pull_request_review_id" : 57969142,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134653255",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134654401"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134654401"
         }
      },
      "body" : "Off topic, just `Invalid address` as it seems irrelevant to have `Bitcoin` in the error message?",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-23T04:22:29Z",
      "diff_hunk" : "@@ -451,9 +454,10 @@ UniValue sendtoaddress(const JSONRPCRequest& request)\n \n     LOCK2(cs_main, pwallet->cs_wallet);\n \n-    CBitcoinAddress address(request.params[0].get_str());\n-    if (!address.IsValid())\n+    CTxDestination dest = DecodeDestination(request.params[0].get_str());\n+    if (!IsValidDestination(dest)) {\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid Bitcoin address\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134654401",
      "id" : 134654401,
      "original_commit_id" : "36eb9f2c1a5f979a07e619852c2bf7c8777f9410",
      "original_position" : 115,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 48,
      "pull_request_review_id" : 57970358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134654401",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134654485"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134654485"
         }
      },
      "body" : "Oh, sure!",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-23T04:23:40Z",
      "diff_hunk" : "@@ -451,9 +454,10 @@ UniValue sendtoaddress(const JSONRPCRequest& request)\n \n     LOCK2(cs_main, pwallet->cs_wallet);\n \n-    CBitcoinAddress address(request.params[0].get_str());\n-    if (!address.IsValid())\n+    CTxDestination dest = DecodeDestination(request.params[0].get_str());\n+    if (!IsValidDestination(dest)) {\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid Bitcoin address\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r134654485",
      "id" : 134654485,
      "original_commit_id" : "36eb9f2c1a5f979a07e619852c2bf7c8777f9410",
      "original_position" : 115,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 48,
      "pull_request_review_id" : 57970443,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134654485",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "> What about:\r\n> \r\n> ```c++\r\n> CTxDestination dest;\r\n> if (!DecodeDestination(str, dest)) {\r\n> ```\r\n\r\nThere are plenty of cases where the result of decoding can just be passed to something else, and `Function(DecodeDestination(addr))` is far cleaner than `CTxDestination dest; DecodeDestination(addr, dest); Function(dest);`, so I prefer to keep that possible.\r\n\r\nThe current pattern is indeed a bit verbose, but once we rewrite `CTxDestination` to be a native type (rather than a `boost::variant`; see follow-up plans in the PR description), it could at least simplify to `dest.IsValid()` or so.",
      "created_at" : "2017-08-23T06:38:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#issuecomment-324235865",
      "id" : 324235865,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11117",
      "updated_at" : "2017-08-23T06:39:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324235865",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa sure, I just wanted to question that \"style\" because it's used elsewhere.\r\n\r\nACK 8363a2c.",
      "created_at" : "2017-08-23T10:10:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#issuecomment-324284520",
      "id" : 324284520,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11117",
      "updated_at" : "2017-08-23T10:10:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324284520",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "utACK 8363a2ccaffba793068db4f97184121730707104",
      "created_at" : "2017-08-23T10:45:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#issuecomment-324292279",
      "id" : 324292279,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11117",
      "updated_at" : "2017-08-23T10:45:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324292279",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Added 0.15.1 milestone",
      "created_at" : "2017-08-23T20:11:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#issuecomment-324448577",
      "id" : 324448577,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11117",
      "updated_at" : "2017-08-23T20:11:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324448577",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135028452"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135028452"
         }
      },
      "body" : "I've stared at this for 5 min now. What trickery made this work before?",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-24T14:22:44Z",
      "diff_hunk" : "@@ -82,14 +82,14 @@ class AddressTablePriv\n             LOCK(wallet->cs_wallet);\n             for (const std::pair<CTxDestination, CAddressBookData>& item : wallet->mapAddressBook)\n             {\n-                const CBitcoinAddress& address = item.first;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135028452",
      "id" : 135028452,
      "original_commit_id" : "4b1249999ba18a7a7666b6f04037c8202837337c",
      "original_position" : 4,
      "path" : "src/qt/addresstablemodel.cpp",
      "position" : 4,
      "pull_request_review_id" : 58393378,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135028452",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135034714"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135034714"
         }
      },
      "body" : "!keyID",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-24T14:42:33Z",
      "diff_hunk" : "@@ -117,16 +117,14 @@ void SignVerifyMessageDialog::on_signMessageButton_SM_clicked()\n     /* Clear old signature to ensure users don't get confused on error with an old signature displayed */\n     ui->signatureOut_SM->clear();\n \n-    CBitcoinAddress addr(ui->addressIn_SM->text().toStdString());\n-    if (!addr.IsValid())\n-    {\n+    CTxDestination destination = DecodeDestination(ui->addressIn_SM->text().toStdString());\n+    if (!IsValidDestination(destination)) {\n         ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n         ui->statusLabel_SM->setText(tr(\"The entered address is invalid.\") + QString(\" \") + tr(\"Please check the address and try again.\"));\n         return;\n     }\n-    CKeyID keyID;\n-    if (!addr.GetKeyID(keyID))\n-    {\n+    const CKeyID* keyID = boost::get<CKeyID>(&destination);\n+    if (keyID) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135034714",
      "id" : 135034714,
      "original_commit_id" : "4b1249999ba18a7a7666b6f04037c8202837337c",
      "original_position" : 17,
      "path" : "src/qt/signverifymessagedialog.cpp",
      "position" : null,
      "pull_request_review_id" : 58393378,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135034714",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135040915"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135040915"
         }
      },
      "body" : "Maybe add a quick comment that this is CNoDestination so it comes up when grepping for future changes.",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-24T15:03:13Z",
      "diff_hunk" : "@@ -317,3 +317,7 @@ CScript GetScriptForWitness(const CScript& redeemscript)\n     ret << OP_0 << ToByteVector(hash);\n     return ret;\n }\n+\n+bool IsValidDestination(const CTxDestination& dest) {\n+    return dest.which() != 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135040915",
      "id" : 135040915,
      "original_commit_id" : "4b1249999ba18a7a7666b6f04037c8202837337c",
      "original_position" : 6,
      "path" : "src/script/standard.cpp",
      "position" : 6,
      "pull_request_review_id" : 58393378,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135040915",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135041298"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135041298"
         }
      },
      "body" : "got it. ignore last nit.",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-24T15:04:44Z",
      "diff_hunk" : "@@ -77,10 +77,13 @@ class CNoDestination {\n  *  * CNoDestination: no destination set\n  *  * CKeyID: TX_PUBKEYHASH destination\n  *  * CScriptID: TX_SCRIPTHASH destination\n- *  A CTxDestination is the internal data type encoded in a CBitcoinAddress\n+ *  A CTxDestination is the internal data type encoded in a bitcoin address\n  */\n typedef boost::variant<CNoDestination, CKeyID, CScriptID> CTxDestination;\n \n+/** Check whether a CTxDestination is a CNoDestination. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135041298",
      "id" : 135041298,
      "original_commit_id" : "4b1249999ba18a7a7666b6f04037c8202837337c",
      "original_position" : 9,
      "path" : "src/script/standard.h",
      "position" : 9,
      "pull_request_review_id" : 58393378,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135041298",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135051638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135051638"
         }
      },
      "body" : "heh.",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-24T15:39:20Z",
      "diff_hunk" : "@@ -529,16 +533,16 @@ UniValue listaddressgroupings(const JSONRPCRequest& request)\n \n     UniValue jsonGroupings(UniValue::VARR);\n     std::map<CTxDestination, CAmount> balances = pwallet->GetAddressBalances();\n-    for (std::set<CTxDestination> grouping : pwallet->GetAddressGroupings()) {\n+    for (const std::set<CTxDestination>& grouping : pwallet->GetAddressGroupings()) {\n         UniValue jsonGrouping(UniValue::VARR);\n-        for (CTxDestination address : grouping)\n+        for (const CTxDestination& address : grouping)\n         {\n             UniValue addressInfo(UniValue::VARR);\n-            addressInfo.push_back(CBitcoinAddress(address).ToString());\n+            addressInfo.push_back(EncodeDestination(address));\n             addressInfo.push_back(ValueFromAmount(balances[address]));\n             {\n-                if (pwallet->mapAddressBook.find(CBitcoinAddress(address).Get()) != pwallet->mapAddressBook.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135051638",
      "id" : 135051638,
      "original_commit_id" : "4b1249999ba18a7a7666b6f04037c8202837337c",
      "original_position" : 145,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 145,
      "pull_request_review_id" : 58393378,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135051638",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135060603"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135060603"
         }
      },
      "body" : "Good catch.",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-24T16:11:26Z",
      "diff_hunk" : "@@ -117,16 +117,14 @@ void SignVerifyMessageDialog::on_signMessageButton_SM_clicked()\n     /* Clear old signature to ensure users don't get confused on error with an old signature displayed */\n     ui->signatureOut_SM->clear();\n \n-    CBitcoinAddress addr(ui->addressIn_SM->text().toStdString());\n-    if (!addr.IsValid())\n-    {\n+    CTxDestination destination = DecodeDestination(ui->addressIn_SM->text().toStdString());\n+    if (!IsValidDestination(destination)) {\n         ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n         ui->statusLabel_SM->setText(tr(\"The entered address is invalid.\") + QString(\" \") + tr(\"Please check the address and try again.\"));\n         return;\n     }\n-    CKeyID keyID;\n-    if (!addr.GetKeyID(keyID))\n-    {\n+    const CKeyID* keyID = boost::get<CKeyID>(&destination);\n+    if (keyID) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135060603",
      "id" : 135060603,
      "original_commit_id" : "4b1249999ba18a7a7666b6f04037c8202837337c",
      "original_position" : 17,
      "path" : "src/qt/signverifymessagedialog.cpp",
      "position" : null,
      "pull_request_review_id" : 58429780,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135060603",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135089262"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135089262"
         }
      },
      "body" : "It was creating a temporary of type CBitcoinAddress by converting the CTxDestination initializer, using the implicit `CBitcoinAddress(const CTxDestination &dest)` constructor. That temporary's lifetime was then extended by taking a reference to it, named `address`.",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-24T18:08:51Z",
      "diff_hunk" : "@@ -82,14 +82,14 @@ class AddressTablePriv\n             LOCK(wallet->cs_wallet);\n             for (const std::pair<CTxDestination, CAddressBookData>& item : wallet->mapAddressBook)\n             {\n-                const CBitcoinAddress& address = item.first;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135089262",
      "id" : 135089262,
      "original_commit_id" : "4b1249999ba18a7a7666b6f04037c8202837337c",
      "original_position" : 4,
      "path" : "src/qt/addresstablemodel.cpp",
      "position" : 4,
      "pull_request_review_id" : 58462422,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135089262",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135089886"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135089886"
         }
      },
      "body" : "It took me a while to figure out what this `CBitcoinAddress` was doing. Answer: nothing at all.",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-24T18:11:25Z",
      "diff_hunk" : "@@ -529,16 +533,16 @@ UniValue listaddressgroupings(const JSONRPCRequest& request)\n \n     UniValue jsonGroupings(UniValue::VARR);\n     std::map<CTxDestination, CAmount> balances = pwallet->GetAddressBalances();\n-    for (std::set<CTxDestination> grouping : pwallet->GetAddressGroupings()) {\n+    for (const std::set<CTxDestination>& grouping : pwallet->GetAddressGroupings()) {\n         UniValue jsonGrouping(UniValue::VARR);\n-        for (CTxDestination address : grouping)\n+        for (const CTxDestination& address : grouping)\n         {\n             UniValue addressInfo(UniValue::VARR);\n-            addressInfo.push_back(CBitcoinAddress(address).ToString());\n+            addressInfo.push_back(EncodeDestination(address));\n             addressInfo.push_back(ValueFromAmount(balances[address]));\n             {\n-                if (pwallet->mapAddressBook.find(CBitcoinAddress(address).Get()) != pwallet->mapAddressBook.end()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135089886",
      "id" : 135089886,
      "original_commit_id" : "4b1249999ba18a7a7666b6f04037c8202837337c",
      "original_position" : 145,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 145,
      "pull_request_review_id" : 58463181,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135089886",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135090175"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135090175"
         }
      },
      "body" : "Wow, thanks :S",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-24T18:12:30Z",
      "diff_hunk" : "@@ -117,16 +117,14 @@ void SignVerifyMessageDialog::on_signMessageButton_SM_clicked()\n     /* Clear old signature to ensure users don't get confused on error with an old signature displayed */\n     ui->signatureOut_SM->clear();\n \n-    CBitcoinAddress addr(ui->addressIn_SM->text().toStdString());\n-    if (!addr.IsValid())\n-    {\n+    CTxDestination destination = DecodeDestination(ui->addressIn_SM->text().toStdString());\n+    if (!IsValidDestination(destination)) {\n         ui->statusLabel_SM->setStyleSheet(\"QLabel { color: red; }\");\n         ui->statusLabel_SM->setText(tr(\"The entered address is invalid.\") + QString(\" \") + tr(\"Please check the address and try again.\"));\n         return;\n     }\n-    CKeyID keyID;\n-    if (!addr.GetKeyID(keyID))\n-    {\n+    const CKeyID* keyID = boost::get<CKeyID>(&destination);\n+    if (keyID) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135090175",
      "id" : 135090175,
      "original_commit_id" : "4b1249999ba18a7a7666b6f04037c8202837337c",
      "original_position" : 17,
      "path" : "src/qt/signverifymessagedialog.cpp",
      "position" : null,
      "pull_request_review_id" : 58463514,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:12:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135090175",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135092929"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135092929"
         }
      },
      "body" : "Interesting, I didn't know an implicit conversion could be done when extending the lifetime of a const ref. Scary!",
      "commit_id" : "7e7a025a988ccff20bdc45ab8ad2ba2d8b9c0b30",
      "created_at" : "2017-08-24T18:22:58Z",
      "diff_hunk" : "@@ -82,14 +82,14 @@ class AddressTablePriv\n             LOCK(wallet->cs_wallet);\n             for (const std::pair<CTxDestination, CAddressBookData>& item : wallet->mapAddressBook)\n             {\n-                const CBitcoinAddress& address = item.first;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11117#discussion_r135092929",
      "id" : 135092929,
      "original_commit_id" : "4b1249999ba18a7a7666b6f04037c8202837337c",
      "original_position" : 4,
      "path" : "src/qt/addresstablemodel.cpp",
      "position" : 4,
      "pull_request_review_id" : 58466568,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11117",
      "updated_at" : "2017-08-24T18:22:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/135092929",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   }
]
