[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12979#discussion_r181830064"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12979"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/181830064"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit 16e4c4bed66e436be606b9cfc6fa982819f00b86: Should say \"changes\"?",
      "commit_id" : "db156ea327577fb1455049efe047e5722a18b1ab",
      "created_at" : "2018-04-16T17:50:32Z",
      "diff_hunk" : "@@ -93,12 +107,22 @@ class CValidationInterface {\n     /**\n      * Notifies listeners of a block being disconnected\n      *\n+     * The ordering of BlockDisconnected and TransactionRemovedFromMempool\n+     * (for transactions removed due to memory constraints or lock time/\n+     * coinbase maturity chenges during the disconnection/reorg) is undefined,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12979#discussion_r181830064",
      "id" : 181830064,
      "original_commit_id" : "16e4c4bed66e436be606b9cfc6fa982819f00b86",
      "original_position" : 36,
      "path" : "src/validationinterface.h",
      "position" : 141,
      "pull_request_review_id" : 112522481,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12979",
      "updated_at" : "2018-04-16T19:58:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/181830064",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12979#discussion_r181844101"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12979"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/181844101"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit ff936aeea569a2ae56a3d9096a486fbd94b6dde7: I don't understand what this comment means. Mind to elaborate or remove?",
      "commit_id" : "db156ea327577fb1455049efe047e5722a18b1ab",
      "created_at" : "2018-04-16T18:39:30Z",
      "diff_hunk" : "@@ -575,15 +580,18 @@ void CTxMemPool::removeForBlock(const std::vector<CTransactionRef>& vtx, unsigne\n     }\n     // Before the txs in the new block have been removed from the mempool, update policy estimates\n     if (minerPolicyEstimator) {minerPolicyEstimator->processBlock(nBlockHeight, entries);}\n+    std::vector<CTransactionRef> txn_conflicts, txn_removed_in_block;\n+    txn_removed_in_block.reserve(vtx.size());\n     for (const auto& tx : vtx)\n     {\n         txiter it = mapTx.find(tx->GetHash());\n         if (it != mapTx.end()) {\n             setEntries stage;\n             stage.insert(it);\n             RemoveStaged(stage, true, MemPoolRemovalReason::BLOCK);\n+            txn_removed_in_block.push_back(tx); // Use the block's copy",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12979#discussion_r181844101",
      "id" : 181844101,
      "original_commit_id" : "ff936aeea569a2ae56a3d9096a486fbd94b6dde7",
      "original_position" : 36,
      "path" : "src/txmempool.cpp",
      "position" : 132,
      "pull_request_review_id" : 112522481,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12979",
      "updated_at" : "2018-04-16T19:58:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/181844101",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12979#discussion_r181859836"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12979"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/181859836"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in commit db156ea327577fb1455049efe047e5722a18b1ab: Could add a semicolon, dot or new line to indicate the start of a new sentence. (before REPLACED)",
      "commit_id" : "db156ea327577fb1455049efe047e5722a18b1ab",
      "created_at" : "2018-04-16T19:34:41Z",
      "diff_hunk" : "@@ -418,8 +418,10 @@ bool CTxMemPool::addUnchecked(const uint256& hash, const CTxMemPoolEntry &entry,\n \n void CTxMemPool::removeUnchecked(txiter it, MemPoolRemovalReason reason)\n {\n-    if (reason != MemPoolRemovalReason::BLOCK && reason != MemPoolRemovalReason::CONFLICT) {\n-        // BLOCK and CONFLICT callbacks are generated in removeForBlock\n+    if (reason != MemPoolRemovalReason::BLOCK && reason != MemPoolRemovalReason::CONFLICT &&\n+        reason != MemPoolRemovalReason::REPLACED) {\n+        // BLOCK and CONFLICT callbacks are generated in removeForBlock REPLACED",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12979#discussion_r181859836",
      "id" : 181859836,
      "original_commit_id" : "6b4e2a79e41401c6a39f7039b469d04e13fd3c83",
      "original_position" : 8,
      "path" : "src/txmempool.cpp",
      "position" : null,
      "pull_request_review_id" : 112522481,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12979",
      "updated_at" : "2018-04-16T19:58:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/181859836",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12979#discussion_r181864451"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12979"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/181864451"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in commit 6b4e2a79e41401c6a39f7039b469d04e13fd3c83: Could add a comment to explain why `txn_replaced` is dropped?",
      "commit_id" : "db156ea327577fb1455049efe047e5722a18b1ab",
      "created_at" : "2018-04-16T19:52:17Z",
      "diff_hunk" : "@@ -165,18 +165,22 @@ void CZMQNotificationInterface::TransactionAddedToMempool(const CTransactionRef&\n     }\n }\n \n+void CZMQNotificationInterface::TransactionAddedToMempool(const CTransactionRef& ptx, const std::vector<CTransactionRef>& txn_replaced) {\n+    NotifyTransaction(ptx);\n+}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12979#discussion_r181864451",
      "id" : 181864451,
      "original_commit_id" : "6b4e2a79e41401c6a39f7039b469d04e13fd3c83",
      "original_position" : 15,
      "path" : "src/zmq/zmqnotificationinterface.cpp",
      "position" : null,
      "pull_request_review_id" : 112522481,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12979",
      "updated_at" : "2018-04-16T19:58:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/181864451",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12979#discussion_r181865943"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12979"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/181865943"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit db156ea327577fb1455049efe047e5722a18b1ab: You pass the block height, but it doesn't appear to be used anywhere?",
      "commit_id" : "db156ea327577fb1455049efe047e5722a18b1ab",
      "created_at" : "2018-04-16T19:58:03Z",
      "diff_hunk" : "@@ -599,7 +599,7 @@ void CTxMemPool::removeForBlock(const std::vector<CTransactionRef>& vtx, unsigne\n         removeConflicts(*tx, txn_conflicts);\n         ClearPrioritisation(tx->GetHash());\n     }\n-    GetMainSignals().MempoolUpdatedForBlockConnect(std::move(txn_removed_in_block), std::move(txn_conflicts));\n+    GetMainSignals().MempoolUpdatedForBlockConnect(std::move(txn_removed_in_block), std::move(txn_conflicts), nBlockHeight);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12979#discussion_r181865943",
      "id" : 181865943,
      "original_commit_id" : "db156ea327577fb1455049efe047e5722a18b1ab",
      "original_position" : 5,
      "path" : "src/txmempool.cpp",
      "position" : null,
      "pull_request_review_id" : 112522481,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12979",
      "updated_at" : "2018-04-16T19:58:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/181865943",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
