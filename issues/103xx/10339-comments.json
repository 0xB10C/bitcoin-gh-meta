[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10339#discussion_r114867160"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10339"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114867160"
         }
      },
      "body" : "Just use blockHash?",
      "commit_id" : "21ed5e3ab8b1b17f6106d8de0ebd57af7641987b",
      "created_at" : "2017-05-04T19:27:31Z",
      "diff_hunk" : "@@ -2392,15 +2393,16 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n     {\n         std::shared_ptr<CBlock> pblock = std::make_shared<CBlock>();\n         vRecv >> *pblock;\n+        const uint256& blockHash = pblock->GetHash();\n \n-        LogPrint(BCLog::NET, \"received block %s peer=%d\\n\", pblock->GetHash().ToString(), pfrom->id);\n+        LogPrint(BCLog::NET, \"received block %s peer=%d\\n\", blockHash.ToString(), pfrom->id);\n \n         // Process all blocks from whitelisted peers, even if not requested,\n         // unless we're still syncing with the network.\n         // Such an unrequested block may still be processed, subject to the\n         // conditions in AcceptBlock().\n         bool forceProcessing = pfrom->fWhitelisted && !IsInitialBlockDownload();\n-        const uint256 hash(pblock->GetHash());\n+        const uint256 hash(blockHash);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10339#discussion_r114867160",
      "id" : 114867160,
      "original_commit_id" : "ce6d1b2776b2ad9a5d711fb06b0a8be54ca158da",
      "original_position" : 45,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 36364443,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10339",
      "updated_at" : "2017-05-04T21:13:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114867160",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10339#discussion_r114869900"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10339"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114869900"
         }
      },
      "body" : "Thanks, I saw this and then forgot about it",
      "commit_id" : "21ed5e3ab8b1b17f6106d8de0ebd57af7641987b",
      "created_at" : "2017-05-04T19:41:42Z",
      "diff_hunk" : "@@ -2392,15 +2393,16 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n     {\n         std::shared_ptr<CBlock> pblock = std::make_shared<CBlock>();\n         vRecv >> *pblock;\n+        const uint256& blockHash = pblock->GetHash();\n \n-        LogPrint(BCLog::NET, \"received block %s peer=%d\\n\", pblock->GetHash().ToString(), pfrom->id);\n+        LogPrint(BCLog::NET, \"received block %s peer=%d\\n\", blockHash.ToString(), pfrom->id);\n \n         // Process all blocks from whitelisted peers, even if not requested,\n         // unless we're still syncing with the network.\n         // Such an unrequested block may still be processed, subject to the\n         // conditions in AcceptBlock().\n         bool forceProcessing = pfrom->fWhitelisted && !IsInitialBlockDownload();\n-        const uint256 hash(pblock->GetHash());\n+        const uint256 hash(blockHash);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10339#discussion_r114869900",
      "id" : 114869900,
      "original_commit_id" : "ce6d1b2776b2ad9a5d711fb06b0a8be54ca158da",
      "original_position" : 45,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 36367583,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10339",
      "updated_at" : "2017-05-04T21:13:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114869900",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10339#discussion_r114870270"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10339"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114870270"
         }
      },
      "body" : "Please rename this while you're at it. CheckBlockHeader is a terrible name if basically just compares 2 values :)",
      "commit_id" : "21ed5e3ab8b1b17f6106d8de0ebd57af7641987b",
      "created_at" : "2017-05-04T19:43:43Z",
      "diff_hunk" : "@@ -2820,10 +2820,10 @@ bool FindUndoPos(CValidationState &state, int nFile, CDiskBlockPos &pos, unsigne\n     return true;\n }\n \n-bool CheckBlockHeader(const CBlockHeader& block, CValidationState& state, const Consensus::Params& consensusParams, bool fCheckPOW)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10339#discussion_r114870270",
      "id" : 114870270,
      "original_commit_id" : "2049a1f3b9236586fc88c59d7766a23d295742ac",
      "original_position" : 4,
      "path" : "src/validation.cpp",
      "position" : 44,
      "pull_request_review_id" : 36368020,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10339",
      "updated_at" : "2017-05-04T21:13:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114870270",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10339#discussion_r114871570"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10339"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114871570"
         }
      },
      "body" : "Heh, nevermind. I see that's been suggested in #9717",
      "commit_id" : "21ed5e3ab8b1b17f6106d8de0ebd57af7641987b",
      "created_at" : "2017-05-04T19:50:22Z",
      "diff_hunk" : "@@ -2820,10 +2820,10 @@ bool FindUndoPos(CValidationState &state, int nFile, CDiskBlockPos &pos, unsigne\n     return true;\n }\n \n-bool CheckBlockHeader(const CBlockHeader& block, CValidationState& state, const Consensus::Params& consensusParams, bool fCheckPOW)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10339#discussion_r114871570",
      "id" : 114871570,
      "original_commit_id" : "2049a1f3b9236586fc88c59d7766a23d295742ac",
      "original_position" : 4,
      "path" : "src/validation.cpp",
      "position" : 44,
      "pull_request_review_id" : 36369493,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10339",
      "updated_at" : "2017-05-04T21:13:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114871570",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10339#discussion_r114872243"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10339"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114872243"
         }
      },
      "body" : "This hash doesn't match the one that's ultimately reconstructed.",
      "commit_id" : "21ed5e3ab8b1b17f6106d8de0ebd57af7641987b",
      "created_at" : "2017-05-04T19:53:53Z",
      "diff_hunk" : "@@ -2020,6 +2020,7 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n         // Keep a CBlock for \"optimistic\" compactblock reconstructions (see\n         // below)\n         std::shared_ptr<CBlock> pblock = std::make_shared<CBlock>();\n+        const uint256& blockHash = pblock->GetHash();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10339#discussion_r114872243",
      "id" : 114872243,
      "original_commit_id" : "ce6d1b2776b2ad9a5d711fb06b0a8be54ca158da",
      "original_position" : 4,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 36370265,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10339",
      "updated_at" : "2017-05-04T21:13:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114872243",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10339#discussion_r114887298"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10339"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114887298"
         }
      },
      "body" : "The discussion there was more about fully removing it and inlining it, which I prefer not to do for now. Just renaming is fine and as you point out it's free to do it now. Renaming to CheckProof (not with CheckProofOfWork to avoid confusing it with the version without CValidationState).",
      "commit_id" : "21ed5e3ab8b1b17f6106d8de0ebd57af7641987b",
      "created_at" : "2017-05-04T21:03:31Z",
      "diff_hunk" : "@@ -2820,10 +2820,10 @@ bool FindUndoPos(CValidationState &state, int nFile, CDiskBlockPos &pos, unsigne\n     return true;\n }\n \n-bool CheckBlockHeader(const CBlockHeader& block, CValidationState& state, const Consensus::Params& consensusParams, bool fCheckPOW)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10339#discussion_r114887298",
      "id" : 114887298,
      "original_commit_id" : "2049a1f3b9236586fc88c59d7766a23d295742ac",
      "original_position" : 4,
      "path" : "src/validation.cpp",
      "position" : 44,
      "pull_request_review_id" : 36387035,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10339",
      "updated_at" : "2017-05-04T21:13:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114887298",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Fixed 3 nits by @theuni added a commit for TestBlockValidity, with a tiny optimization on getblocktemplate, and not much extra disruption.",
      "created_at" : "2017-05-04T21:16:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10339#issuecomment-299311670",
      "id" : 299311670,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10339",
      "updated_at" : "2017-05-04T21:16:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/299311670",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   }
]
