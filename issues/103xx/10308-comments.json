[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10308#discussion_r114186169"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10308"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114186169"
         }
      },
      "body" : "I don't believe anything in C++ can actually guarantee this.",
      "commit_id" : "2ac544531d8fd50807f9a8d98b576e3a49a6402c",
      "created_at" : "2017-05-01T19:43:52Z",
      "diff_hunk" : "@@ -8,6 +8,8 @@\n \n #include <stdlib.h>\n \n+// Securely erase a span of memory in a way guaranteed not to be",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10308#discussion_r114186169",
      "id" : 114186169,
      "original_commit_id" : "2ac544531d8fd50807f9a8d98b576e3a49a6402c",
      "original_position" : 4,
      "path" : "src/support/cleanse.h",
      "position" : 4,
      "pull_request_review_id" : 35632137,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10308",
      "updated_at" : "2017-05-01T22:34:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114186169",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10308#discussion_r114212690"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10308"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114212690"
         }
      },
      "body" : "Style nit: brace on the same line as the if.",
      "commit_id" : "2ac544531d8fd50807f9a8d98b576e3a49a6402c",
      "created_at" : "2017-05-01T22:08:47Z",
      "diff_hunk" : "@@ -180,22 +180,23 @@ class CDB\n         Dbt datValue;\n         datValue.set_flags(DB_DBT_MALLOC);\n         int ret = pdb->get(activeTxn, &datKey, &datValue, 0);\n-        memset(datKey.get_data(), 0, datKey.get_size());\n-        if (datValue.get_data() == NULL)\n-            return false;\n-\n-        // Unserialize value\n-        try {\n-            CDataStream ssValue((char*)datValue.get_data(), (char*)datValue.get_data() + datValue.get_size(), SER_DISK, CLIENT_VERSION);\n-            ssValue >> value;\n-        } catch (const std::exception&) {\n-            return false;\n+        memory_cleanse(datKey.get_data(), datKey.get_size());\n+        bool success = false;\n+        if (datValue.get_data() != NULL)\n+        {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10308#discussion_r114212690",
      "id" : 114212690,
      "original_commit_id" : "2ac544531d8fd50807f9a8d98b576e3a49a6402c",
      "original_position" : 17,
      "path" : "src/wallet/db.h",
      "position" : 17,
      "pull_request_review_id" : 35632137,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10308",
      "updated_at" : "2017-05-01T22:34:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114212690",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10308#discussion_r114312369"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10308"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114312369"
         }
      },
      "body" : "Silently ignored exceptions are one of the larger frustrations when troubleshooting C++ code. Checking more closely it seems this is ok: please add a comment e.g. `/* success = false */` here to show what is happening.",
      "commit_id" : "2ac544531d8fd50807f9a8d98b576e3a49a6402c",
      "created_at" : "2017-05-02T13:03:08Z",
      "diff_hunk" : "@@ -180,22 +180,23 @@ class CDB\n         Dbt datValue;\n         datValue.set_flags(DB_DBT_MALLOC);\n         int ret = pdb->get(activeTxn, &datKey, &datValue, 0);\n-        memset(datKey.get_data(), 0, datKey.get_size());\n-        if (datValue.get_data() == NULL)\n-            return false;\n-\n-        // Unserialize value\n-        try {\n-            CDataStream ssValue((char*)datValue.get_data(), (char*)datValue.get_data() + datValue.get_size(), SER_DISK, CLIENT_VERSION);\n-            ssValue >> value;\n-        } catch (const std::exception&) {\n-            return false;\n+        memory_cleanse(datKey.get_data(), datKey.get_size());\n+        bool success = false;\n+        if (datValue.get_data() != NULL)\n+        {\n+            // Unserialize value\n+            try {\n+                CDataStream ssValue((char*)datValue.get_data(), (char*)datValue.get_data() + datValue.get_size(), SER_DISK, CLIENT_VERSION);\n+                ssValue >> value;\n+                success = true;\n+            } catch (const std::exception&) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10308#discussion_r114312369",
      "id" : 114312369,
      "original_commit_id" : "2ac544531d8fd50807f9a8d98b576e3a49a6402c",
      "original_position" : 23,
      "path" : "src/wallet/db.h",
      "position" : 23,
      "pull_request_review_id" : 35766694,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10308",
      "updated_at" : "2017-05-02T13:03:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/114312369",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "LGTM, utACK, as we have the `memory_cleanse` function anyway let's use it where it makes sense.",
      "created_at" : "2017-05-02T13:07:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10308#issuecomment-298630019",
      "id" : 298630019,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10308",
      "updated_at" : "2017-05-02T13:07:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/298630019",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "utACK 2ac544531d8fd50807f9a8d98b576e3a49a6402c",
      "created_at" : "2017-05-02T13:11:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10308#issuecomment-298631101",
      "id" : 298631101,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10308",
      "updated_at" : "2017-05-02T13:11:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/298631101",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   }
]
