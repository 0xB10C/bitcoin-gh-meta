[
   {
      "body" : "I'm concerned this might make RPC code that implicitly assumes the RPC is single-threaded deadlock or crash.  How much testing did you do-- has this been tested on an in-production, high-RPC-traffic server?\r\n",
      "created_at" : "2011-08-10T14:33:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-1773030",
      "id" : 1773030,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-08-10T14:33:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1773030",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "It currently still is single-threaded, i.e. all code is still executed from ThreadRPCServer2 via the \"io_service.run_one()\" construct.\r\n\r\nThe way it basically works is that certain actions are started (using 'async_*' methods), and get passed along with them an event handler to be called upon that action's completion. The io_service object manages these actions, waits for any of them to complete then dispatches the appropriate event handler.\r\n\r\nAll of that happens *only* within the threads from which you call io_service.run(), io_service.run_one(), io_service.poll() or io_service.poll_one(). As a result this allows future expansion into multiple threads by simple invoking io_service.run() in a new thread, but *doesn't* inherently add more threads (just allows for it).",
      "created_at" : "2011-08-10T15:37:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-1773629",
      "id" : 1773629,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-08-10T15:37:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1773629",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "PS The main reason for using asynchronous I/O is to allow binding to multiple addresses for RPC without requiring one thread for every socket. This is what enables a dual IPv4/IPv6 stack.",
      "created_at" : "2011-08-10T16:42:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-1774261",
      "id" : 1774261,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-08-10T16:42:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1774261",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "I don't know nuthin about IPv6/boost::asio stuff.  General comment is it seems like this maybe should be part of a larger \"support IPv6\" branch.\r\n",
      "created_at" : "2011-08-11T17:39:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-1783949",
      "id" : 1783949,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-08-11T17:39:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1783949",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Well, all that can be supported about IPv6 for RPC is in this branch. So that's exactly what this branch is: a \"support IPv6 for RPC\" branch.\r\n\r\nGiven that the RPC code is completely separate from any other networking code it actually makes sense to migrate it separately. That's why I'm not even trying to support IPv6 across all of bitcoin at once, incremental changes tend to work better in my experience.",
      "created_at" : "2011-08-11T22:44:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-1786723",
      "id" : 1786723,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-08-11T22:44:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1786723",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "I've rebased the branch against master to make it easy to merge in.",
      "created_at" : "2011-09-04T14:02:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-1991389",
      "id" : 1991389,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-09-04T14:02:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1991389",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "This conflicts with threaded JSON-RPC which is needed by many people. Can you make an IPv6-only version?",
      "created_at" : "2011-10-12T18:08:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-2382453",
      "id" : 2382453,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-10-12T18:08:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/2382453",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "agree w/ first half of luke-jr's comment.  second half... not sure we want an IPv6-only version?",
      "created_at" : "2011-12-19T17:03:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-3205994",
      "id" : 3205994,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-12-19T17:03:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3205994",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "I meant a patch that only adds IPv6, without the conflicting async stuff.",
      "created_at" : "2011-12-19T17:07:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-3206070",
      "id" : 3206070,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-12-19T17:07:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3206070",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Adding IPv6 (or any other protocol that requires an additional listening socket) *requires* event-driven (aka asynchronous I/O). That or a separate thread per listening socket, wich conflicts with the RPC's assumption that RPC code is single threaded...\r\n\r\nAdditionally event-driven approaches tend to scale better (less context switching, locking and per-thread resources overhead).",
      "created_at" : "2011-12-19T18:07:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-3206945",
      "id" : 3206945,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-12-19T18:07:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3206945",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "Can we do async for listening only, then? Threads are needed for actual RPC calls since some may block.",
      "created_at" : "2011-12-19T18:16:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-3207083",
      "id" : 3207083,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-12-19T18:16:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3207083",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Another (probably better) solution would be to have a select(2)-like event-based processing loop. It would have the single-thread advantage of asynchronous I/O but the simplicity of a callback-less design. As I assume that the addition of callbacks in my current implementation is what you like least? (Please confirm/deny that last question/statement.)\r\n\r\nThat should localise most of the changes to the place where current code calls listener.accept(socket). This solution I should be able to implement rather quickly in the weekend.",
      "created_at" : "2011-12-20T17:21:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-3221992",
      "id" : 3221992,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-12-20T17:21:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3221992",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "I dislike the fact that a 'getwork' call will block all other JSON-RPC until it completes.",
      "created_at" : "2011-12-20T17:26:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-3222056",
      "id" : 3222056,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-12-20T17:26:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3222056",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Yes, but that is unrelated to my patch.\r\n\r\nThe alternate implementation of IPv6 support I'm thinking of would look somewhat like this pseudocode:\r\n\r\n * create listener sockets (IPv4 and IPv6)\r\n * asynchronously accept a connection on both listeners (acceptor's in Asio's terminology)\r\n * from the accept callbacks: place the newly connected socket in a queue, then start a new async accept op\r\n\r\nthe mainloop would then be this:\r\n\r\n * wait for a single event to occur (io_service.run_one())\r\n * handle all connections in the queue until queue is empty\r\n * restart loop\r\n\r\nThat approach would still have a single callback, but only to accept tue connection, not to handle it. If there are no objections to this approach I'll implement it this weekend.",
      "created_at" : "2011-12-21T21:02:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-3239572",
      "id" : 3239572,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-12-21T21:06:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3239572",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "It's related, because your patch conflicts with it. Instead of conflicting, why not implement IPv6 RPC on top of the existing multithreaded JSON-RPC branch (#568)?",
      "created_at" : "2011-12-21T22:40:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-3240785",
      "id" : 3240785,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-12-21T22:40:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3240785",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "The reason it conflicts with it is simple of course: there was no multithreaded RPC patch when I wrote this patch.\r\n\r\nAs for resolving those conflicts by implementing on top of #568, no promises but I'll look at it in the weekend. Right now I'm going to get some much needed sleep.",
      "created_at" : "2011-12-22T20:19:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-3254297",
      "id" : 3254297,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-12-22T20:20:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3254297",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "Current branch is on top of #568. I've used the approach outlined above (using a connection queue).",
      "created_at" : "2011-12-24T15:31:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-3268074",
      "id" : 3268074,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-12-24T15:31:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3268074",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "ACK: Tested fine for me in 'next-test'",
      "created_at" : "2011-12-24T18:35:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-3268629",
      "id" : 3268629,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2011-12-24T18:36:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3268629",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "For some reason, if -rpcallowip is used, it sees local connections as ::ffff:127.0.0.1 and sends a 403 instead of allowing the connection.\r\n\r\n(side note: #568 has been rebased)",
      "created_at" : "2012-02-05T22:57:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-3821590",
      "id" : 3821590,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-02-05T22:57:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/3821590",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Request rebase on top of #1101...  we certainly do want to support IPv6 RPC.",
      "created_at" : "2012-05-08T21:04:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-5586369",
      "id" : 5586369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-05-08T21:04:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5586369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "@jgarzik I'll work on updating this pull request next Thursday (Ascension Day, national holiday so I'll have some time off).",
      "created_at" : "2012-05-13T17:13:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-5677751",
      "id" : 5677751,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-05-13T17:13:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5677751",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "Thanks!\n\nNote that pull #1101 is now upstream, and will be in upcoming version 0.7",
      "created_at" : "2012-05-13T18:49:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-5678448",
      "id" : 5678448,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-05-13T18:49:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5678448",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Please don't forget to fix the -rpcallowip issue.",
      "created_at" : "2012-05-13T19:42:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-5678847",
      "id" : 5678847,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-05-13T19:42:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5678847",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@luke-jr This also contains a change (in 652eebf08e7f0e32d686d4e36475742fa27f71cc) to treat IPv4-mapped IPv6 addresses (::127.0.0.1 is one) as IPv4 addresses.",
      "created_at" : "2012-05-20T13:19:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-5808816",
      "id" : 5808816,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-05-20T13:19:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5808816",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/457#discussion_r850291"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850291"
         }
      },
      "body" : "This strikes me as flawed by design, though perhaps that's inherited from boost... does it not have any kind of \"is loopback\" method?\nEven IPv4 has 16,777,216 unique loopback addresses.",
      "commit_id" : "5b1462211031934437afef7da1382766c3570770",
      "created_at" : "2012-05-20T13:38:06Z",
      "diff_hunk" : "@@ -2510,10 +2515,19 @@ void ErrorReply(std::ostream& stream, const Object& objError, const Value& id)\n     stream << HTTPReply(nStatus, strReply, false) << std::flush;\n }\n \n-bool ClientAllowed(const string& strAddress)\n+bool ClientAllowed(const boost::asio::ip::address& address)\n {\n-    if (strAddress == asio::ip::address_v4::loopback().to_string())\n+    // Make sure that IPv4-compatible and IPv4-mapped IPv6 addresses are treated as IPv4 addresses\n+    if (address.is_v6()\n+     && (address.to_v6().is_v4_compatible()\n+      || address.to_v6().is_v4_mapped()))\n+        return ClientAllowed(address.to_v6().to_v4());\n+\n+    if (address == asio::ip::address_v4::loopback()\n+     || address == asio::ip::address_v6::loopback())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#discussion_r850291",
      "id" : 850291,
      "original_commit_id" : "5413893f3b6770d687f4b48616a1ca588ab9da77",
      "original_position" : 34,
      "path" : "src/bitcoinrpc.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/457",
      "updated_at" : "2012-06-24T13:12:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850291",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/457#discussion_r850295"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/457"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850295"
         }
      },
      "body" : "No, it doesn't. As for IPv6, that only has a single loopback address. (::1/128).\n\nAnd while I agree that that ^^ code doesn't address all loopback cases. It *does* address all loopback cases covered by the previous version of that code.\n\nThat being said, I'll gladly add another commit to improve the IPv4 case (using a netmask check against 127.0.0.0/8).",
      "commit_id" : "5b1462211031934437afef7da1382766c3570770",
      "created_at" : "2012-05-20T13:44:32Z",
      "diff_hunk" : "@@ -2510,10 +2515,19 @@ void ErrorReply(std::ostream& stream, const Object& objError, const Value& id)\n     stream << HTTPReply(nStatus, strReply, false) << std::flush;\n }\n \n-bool ClientAllowed(const string& strAddress)\n+bool ClientAllowed(const boost::asio::ip::address& address)\n {\n-    if (strAddress == asio::ip::address_v4::loopback().to_string())\n+    // Make sure that IPv4-compatible and IPv4-mapped IPv6 addresses are treated as IPv4 addresses\n+    if (address.is_v6()\n+     && (address.to_v6().is_v4_compatible()\n+      || address.to_v6().is_v4_mapped()))\n+        return ClientAllowed(address.to_v6().to_v4());\n+\n+    if (address == asio::ip::address_v4::loopback()\n+     || address == asio::ip::address_v6::loopback())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#discussion_r850295",
      "id" : 850295,
      "original_commit_id" : "5413893f3b6770d687f4b48616a1ca588ab9da77",
      "original_position" : 34,
      "path" : "src/bitcoinrpc.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/457",
      "updated_at" : "2012-06-24T13:12:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/850295",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "I believe that this pull request is ready for merging.",
      "created_at" : "2012-05-21T16:11:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-5826601",
      "id" : 5826601,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-05-21T16:11:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5826601",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "ACK",
      "created_at" : "2012-06-09T20:23:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-6223190",
      "id" : 6223190,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-06-09T20:23:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6223190",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "NACK until the last commit is clarified.\n\n@muggenhor Wait, what are you doing there to the shutdown ... we had a long discussion and merged a patch a few days ago. Your last commit is likely to break sth. or at least change the current behaviour once more, see #1439.",
      "created_at" : "2012-06-17T21:31:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-6385032",
      "id" : 6385032,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-06-17T21:41:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6385032",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "basic_socket_acceptor needs -lmswsock added to Windows builds:\n- bitcoin-qt.pro\n- src/makefile.linux-mingw\n- src/makefile.mingw",
      "created_at" : "2012-06-22T15:51:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-6511023",
      "id" : 6511023,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-06-22T15:51:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6511023",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Did anyone mind reading my comment above lukes...? I'm sure the last commit can cause trouble.",
      "created_at" : "2012-06-22T16:18:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-6511831",
      "id" : 6511831,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-06-22T16:18:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6511831",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@luke-jr it's been long since I've done windows development, but don't you mean ws2_32 ? And isn't that linked to already?\n\n@Diapolo yes, I did read your comment. I however have a day job which doesn't leave me much time during the week to reply *immediately*. So being patient enough to wait till the next weekend following your comment might be nice.\n\nThen as for the actual content of your comment:\n> Your last commit is likely to break sth\n\nPlease elaborate, because I've carefully checked *how* my change would affect existing code. As far as I could see there should be no difference except the *location* from where the shutdown thread gets started.\n\n> or at least change the current behaviour once more\n\nAs explained above: shutdown behaviour should not be changed for existing/untouched code. It should only affect the termination of the RPC handling's shutdown sequence.\n\nI.e. the RPC code *needs* to be interrupted by a signal in order to terminate it. Setting a variable that can be polled (fShutdown) isn't enough because we're blocking until some kind of event (network I/O or internal operation on io_service or one of the sockets) occurs.",
      "created_at" : "2012-06-24T09:37:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-6531684",
      "id" : 6531684,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-06-24T09:37:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6531684",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "@muggenhor I didn't want to hurry you the feedback of another dev would have been sufficient, too. I didn't want to offend you. That said ``StartShutdown()`` is currently used in bitcoinrpc, main, net and test_bitcoin.\n\nGUI:\n\nStartShutdown() ->  uiInterface.QueueShutdown() -> quit() for QCoreApplication (Qt event loop) -> Shutdown(NULL); in bitcoin.cpp (no exit here) -> return 0; (Bitcoin-Qt exit)\n\nNOUI:\nStartShutdown() -> CreateThread(Shutdown, NULL); -> Shutdown(NULL) -> exit(0);\n\nWhat happens if StartShutdown is called in e.g. net.cpp with your patch using the NOUI version? Perhaps you can explain to me the new flow with your patch for the NOUI version. I'm not that advanced with the boost signal thing ;). Just want to ensure nothing get's broken.",
      "created_at" : "2012-06-24T10:34:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-6531916",
      "id" : 6531916,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-06-24T10:34:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6531916",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@Diapolo as you correctly seem to have noticed nothing is changed for the GUI case (outside of the RPC code).\n\nFor the NOUI case the flow is changed to:\nStartShutdown() -> raise QueueShutdown() signal -> CreateThread(Shutdown, NULL); -> Shutdown(NULL) -> exit(0);\n\nIn addition to that, for both GUI/NOUI the RPC code now uses the QueueShutdown() signal to stop listening for new connections:\nQueueShutdown() signal -> for each listening socket as acceptor -> acceptor.cancel().\n\nAs for the CreateThread call. That's registered with the QueueShutdown signal, so will get called immediately (along with other signal handlers) when the signal is raised/emitted/sent. (calling a signal is done by an immediate for-loop on all slots/handlers).",
      "created_at" : "2012-06-24T11:36:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-6532199",
      "id" : 6532199,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-06-24T11:36:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6532199",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "It does seem to simplify the shutdown code. @Diapolo: any reason to assume things will break with this patch?\n\nBoth bitcoin-qt and bitcoind seem to shutdown fine with this, via RPC stop, UI quit, or SIGINT.",
      "created_at" : "2012-06-24T11:56:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-6532303",
      "id" : 6532303,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-06-24T11:56:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6532303",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@muggenhor basic_socket_acceptor uses [AcceptEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms737524.aspx), which is defined in mswsock",
      "created_at" : "2012-06-24T12:11:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-6532382",
      "id" : 6532382,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-06-24T12:12:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6532382",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@luke-jr basic_socket_acceptor is already used in mainline, so the problem should exist already. Regardless, I've fixed it as well in my branch.",
      "created_at" : "2012-06-24T12:18:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-6532411",
      "id" : 6532411,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-06-24T12:18:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6532411",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/484066?v=3",
         "events_url" : "https://api.github.com/users/muggenhor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/muggenhor/followers",
         "following_url" : "https://api.github.com/users/muggenhor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/muggenhor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/muggenhor",
         "id" : 484066,
         "login" : "muggenhor",
         "organizations_url" : "https://api.github.com/users/muggenhor/orgs",
         "received_events_url" : "https://api.github.com/users/muggenhor/received_events",
         "repos_url" : "https://api.github.com/users/muggenhor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/muggenhor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/muggenhor"
      }
   },
   {
      "body" : "I have no further doubts after reading the explanations above. Thanks for clarification!",
      "created_at" : "2012-06-24T15:16:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/457#issuecomment-6533629",
      "id" : 6533629,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/457",
      "updated_at" : "2012-06-24T15:16:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/6533629",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   }
]
