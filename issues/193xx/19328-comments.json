[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "cc @Sjors ",
      "created_at" : "2020-06-19T14:01:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#issuecomment-646653238",
      "id" : 646653238,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19328",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NjY1MzIzOA==",
      "updated_at" : "2020-06-19T14:01:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/646653238",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442943981"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442943981"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit in commit 87dd07e0382c6398d118d88c88b0c9ef24251e37\r\n\r\n```suggestion\r\nstatic bool GetUTXOStats(CCoinsView* view, CCoinsStats& stats, T hash_obj, const std::function<void()>& interruption_point)\r\n```",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T16:43:38Z",
      "diff_hunk" : "@@ -42,19 +42,21 @@ static void ApplyStats(CCoinsStats &stats, CHashWriter& ss, const uint256& hash,\n }\n \n //! Calculate statistics about the unspent transaction output set\n-bool GetUTXOStats(CCoinsView* view, CCoinsStats& stats, const std::function<void()>& interruption_point)\n+template <typename T>\n+bool GetUTXOStats(CCoinsView* view, CCoinsStats& stats, T hash_obj, const std::function<void()>& interruption_point)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442943981",
      "id" : 442943981,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk0Mzk4MQ==",
      "original_commit_id" : "87dd07e0382c6398d118d88c88b0c9ef24251e37",
      "original_line" : 46,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/node/coinstats.cpp",
      "position" : null,
      "pull_request_review_id" : 434213865,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:29:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442943981",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442944374"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442944374"
         }
      },
      "author_association" : "MEMBER",
      "body" : "87dd07e0382c6398d118d88c88b0c9ef24251e37:\r\n\r\nAccording to the developer notes, assert(false) and with the appropriate comment",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T16:44:33Z",
      "diff_hunk" : "@@ -75,9 +77,33 @@ bool GetUTXOStats(CCoinsView* view, CCoinsStats& stats, const std::function<void\n         pcursor->Next();\n     }\n     if (!outputs.empty()) {\n-        ApplyStats(stats, ss, prevkey, outputs);\n+        ApplyStats(stats, hash_obj, prevkey, outputs);\n     }\n-    stats.hashSerialized = ss.GetHash();\n+\n+    FinalizeHash(hash_obj, stats);\n+\n     stats.nDiskSize = view->EstimateSize();\n     return true;\n }\n+\n+bool GetUTXOStats(CCoinsView *view, CCoinsStats &stats, CoinStatsHashType hash_type, const std::function<void()>& interruption_point)\n+{\n+    switch(hash_type) {\n+        case(CoinStatsHashType::HASH_SERIALIZED): {\n+            CHashWriter ss(SER_GETHASH, PROTOCOL_VERSION);\n+            return GetUTXOStats(view, stats, ss, interruption_point);\n+        }\n+    }\n+    return false; // Unreachable code",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442944374",
      "id" : 442944374,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk0NDM3NA==",
      "original_commit_id" : "87dd07e0382c6398d118d88c88b0c9ef24251e37",
      "original_line" : 97,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/node/coinstats.cpp",
      "position" : null,
      "pull_request_review_id" : 434213865,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:29:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442944374",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442944942"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442944942"
         }
      },
      "author_association" : "MEMBER",
      "body" : "87dd07e0382c6398d118d88c88b0c9ef24251e37\r\n\r\nwhy is this needed? Looks like a str to me",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T16:45:45Z",
      "diff_hunk" : "@@ -123,6 +123,7 @@ static const CRPCConvertParam vRPCConvertParams[] =\n     { \"gettxout\", 1, \"n\" },\n     { \"gettxout\", 2, \"include_mempool\" },\n     { \"gettxoutproof\", 0, \"txids\" },\n+    { \"gettxoutsetinfo\", 0, \"hash_type\" },",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442944942",
      "id" : 442944942,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk0NDk0Mg==",
      "original_commit_id" : "87dd07e0382c6398d118d88c88b0c9ef24251e37",
      "original_line" : 126,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/rpc/client.cpp",
      "position" : null,
      "pull_request_review_id" : 434213865,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:29:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442944942",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442945625"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442945625"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit ea41a5bdcc49566be0c23ef9362781e70f557bad:\r\n\r\nwhy is this not changed to NONE?",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T16:47:26Z",
      "diff_hunk" : "@@ -2316,7 +2331,7 @@ UniValue dumptxoutset(const JSONRPCRequest& request)\n \n         ::ChainstateActive().ForceFlushStateToDisk();\n \n-        if (!GetUTXOStats(&::ChainstateActive().CoinsDB(), stats, RpcInterruptionPoint)) {\n+        if (!GetUTXOStats(&::ChainstateActive().CoinsDB(), stats, CoinStatsHashType::HASH_SERIALIZED, RpcInterruptionPoint)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442945625",
      "id" : 442945625,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk0NTYyNQ==",
      "original_commit_id" : "87dd07e0382c6398d118d88c88b0c9ef24251e37",
      "original_line" : 2334,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 434213865,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:29:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442945625",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442947356"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442947356"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit ea41a5bdcc49566be0c23ef9362781e70f557bad\r\n\r\n```suggestion\r\nstatic void ApplyStats(CCoinsStats& stats, nullptr_t, const uint256& hash, const std::map<uint32_t, Coin>& outputs)\r\n```",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T16:51:16Z",
      "diff_hunk" : "@@ -41,6 +41,17 @@ static void ApplyStats(CCoinsStats &stats, CHashWriter& ss, const uint256& hash,\n     ss << VARINT(0u);\n }\n \n+static void ApplyStats(CCoinsStats &stats, nullptr_t, const uint256& hash, const std::map<uint32_t, Coin>& outputs)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442947356",
      "id" : 442947356,
      "line" : 44,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk0NzM1Ng==",
      "original_commit_id" : "ea41a5bdcc49566be0c23ef9362781e70f557bad",
      "original_line" : 44,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/node/coinstats.cpp",
      "position" : 37,
      "pull_request_review_id" : 434213865,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:29:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442947356",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442952980"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442952980"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Indeed, this should be dropped (try: `bitcoin-cli gettxoutsetinfo none`, it works without this line).",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T17:04:20Z",
      "diff_hunk" : "@@ -123,6 +123,7 @@ static const CRPCConvertParam vRPCConvertParams[] =\n     { \"gettxout\", 1, \"n\" },\n     { \"gettxout\", 2, \"include_mempool\" },\n     { \"gettxoutproof\", 0, \"txids\" },\n+    { \"gettxoutsetinfo\", 0, \"hash_type\" },",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442952980",
      "id" : 442952980,
      "in_reply_to_id" : 442944942,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk1Mjk4MA==",
      "original_commit_id" : "87dd07e0382c6398d118d88c88b0c9ef24251e37",
      "original_line" : 126,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/rpc/client.cpp",
      "position" : null,
      "pull_request_review_id" : 434225573,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:29:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442952980",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442957494"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442957494"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Agreed, this hash is unused in UTXO snapshots, as judged by the code as well as the hardcoded UTXO set has in `rpc_dumptxoutset.py`.",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T17:15:08Z",
      "diff_hunk" : "@@ -2316,7 +2331,7 @@ UniValue dumptxoutset(const JSONRPCRequest& request)\n \n         ::ChainstateActive().ForceFlushStateToDisk();\n \n-        if (!GetUTXOStats(&::ChainstateActive().CoinsDB(), stats, RpcInterruptionPoint)) {\n+        if (!GetUTXOStats(&::ChainstateActive().CoinsDB(), stats, CoinStatsHashType::HASH_SERIALIZED, RpcInterruptionPoint)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442957494",
      "id" : 442957494,
      "in_reply_to_id" : 442945625,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk1NzQ5NA==",
      "original_commit_id" : "87dd07e0382c6398d118d88c88b0c9ef24251e37",
      "original_line" : 2334,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 434225573,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:29:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442957494",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442959103"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442959103"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe open a separate PR to see if there's support for deprecating `hash_serialized_2` and switch the default to `NONE` (pre-ACK, unless we find someone who actually uses this)",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T17:18:33Z",
      "diff_hunk" : "@@ -981,7 +983,7 @@ static UniValue gettxoutsetinfo(const JSONRPCRequest& request)\n                         {RPCResult::Type::NUM, \"transactions\", \"The number of transactions with unspent outputs\"},\n                         {RPCResult::Type::NUM, \"txouts\", \"The number of unspent transaction outputs\"},\n                         {RPCResult::Type::NUM, \"bogosize\", \"A meaningless metric for UTXO set size\"},\n-                        {RPCResult::Type::STR_HEX, \"hash_serialized_2\", \"The serialized hash\"},\n+                        {RPCResult::Type::STR_HEX, \"hash_serialized_2\", \"The serialized hash (only present if 'hash_serialized_2' hash_type is chosen)\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r442959103",
      "id" : 442959103,
      "line" : 986,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Mjk1OTEwMw==",
      "original_commit_id" : "e884c98996b135eee51e5d3994ae604110c797fd",
      "original_line" : 986,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 16,
      "pull_request_review_id" : 434225573,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:29:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/442959103",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19323 (gui: Fix regression in *txoutset* in GUI console by hebasto)\n* #19145 (Add hash_type options for gettxoutsetinfo by fjahr)\n* #13462 (Make SER_GETHASH implicit for CHashWriter and SerializeHash by Empact)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-06-19T19:59:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#issuecomment-646839415",
      "id" : 646839415,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19328",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NjgzOTQxNQ==",
      "updated_at" : "2020-06-19T19:59:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/646839415",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443065869"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443065869"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T22:29:44Z",
      "diff_hunk" : "@@ -42,19 +42,21 @@ static void ApplyStats(CCoinsStats &stats, CHashWriter& ss, const uint256& hash,\n }\n \n //! Calculate statistics about the unspent transaction output set\n-bool GetUTXOStats(CCoinsView* view, CCoinsStats& stats, const std::function<void()>& interruption_point)\n+template <typename T>\n+bool GetUTXOStats(CCoinsView* view, CCoinsStats& stats, T hash_obj, const std::function<void()>& interruption_point)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443065869",
      "id" : 443065869,
      "in_reply_to_id" : 442943981,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NTg2OQ==",
      "original_commit_id" : "87dd07e0382c6398d118d88c88b0c9ef24251e37",
      "original_line" : 46,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/node/coinstats.cpp",
      "position" : null,
      "pull_request_review_id" : 434367406,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:29:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443065869",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443065888"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443065888"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T22:29:52Z",
      "diff_hunk" : "@@ -75,9 +77,33 @@ bool GetUTXOStats(CCoinsView* view, CCoinsStats& stats, const std::function<void\n         pcursor->Next();\n     }\n     if (!outputs.empty()) {\n-        ApplyStats(stats, ss, prevkey, outputs);\n+        ApplyStats(stats, hash_obj, prevkey, outputs);\n     }\n-    stats.hashSerialized = ss.GetHash();\n+\n+    FinalizeHash(hash_obj, stats);\n+\n     stats.nDiskSize = view->EstimateSize();\n     return true;\n }\n+\n+bool GetUTXOStats(CCoinsView *view, CCoinsStats &stats, CoinStatsHashType hash_type, const std::function<void()>& interruption_point)\n+{\n+    switch(hash_type) {\n+        case(CoinStatsHashType::HASH_SERIALIZED): {\n+            CHashWriter ss(SER_GETHASH, PROTOCOL_VERSION);\n+            return GetUTXOStats(view, stats, ss, interruption_point);\n+        }\n+    }\n+    return false; // Unreachable code",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443065888",
      "id" : 443065888,
      "in_reply_to_id" : 442944374,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NTg4OA==",
      "original_commit_id" : "87dd07e0382c6398d118d88c88b0c9ef24251e37",
      "original_line" : 97,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "src/node/coinstats.cpp",
      "position" : null,
      "pull_request_review_id" : 434367431,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:29:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443065888",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443065925"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443065925"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T22:30:00Z",
      "diff_hunk" : "@@ -123,6 +123,7 @@ static const CRPCConvertParam vRPCConvertParams[] =\n     { \"gettxout\", 1, \"n\" },\n     { \"gettxout\", 2, \"include_mempool\" },\n     { \"gettxoutproof\", 0, \"txids\" },\n+    { \"gettxoutsetinfo\", 0, \"hash_type\" },",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443065925",
      "id" : 443065925,
      "in_reply_to_id" : 442944942,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NTkyNQ==",
      "original_commit_id" : "87dd07e0382c6398d118d88c88b0c9ef24251e37",
      "original_line" : 126,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/rpc/client.cpp",
      "position" : null,
      "pull_request_review_id" : 434367467,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:30:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443065925",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443065960"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443065960"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T22:30:09Z",
      "diff_hunk" : "@@ -2316,7 +2331,7 @@ UniValue dumptxoutset(const JSONRPCRequest& request)\n \n         ::ChainstateActive().ForceFlushStateToDisk();\n \n-        if (!GetUTXOStats(&::ChainstateActive().CoinsDB(), stats, RpcInterruptionPoint)) {\n+        if (!GetUTXOStats(&::ChainstateActive().CoinsDB(), stats, CoinStatsHashType::HASH_SERIALIZED, RpcInterruptionPoint)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443065960",
      "id" : 443065960,
      "in_reply_to_id" : 442945625,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NTk2MA==",
      "original_commit_id" : "87dd07e0382c6398d118d88c88b0c9ef24251e37",
      "original_line" : 2334,
      "original_position" : 55,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : null,
      "pull_request_review_id" : 434367501,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:30:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443065960",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443065982"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443065982"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "done",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T22:30:16Z",
      "diff_hunk" : "@@ -41,6 +41,17 @@ static void ApplyStats(CCoinsStats &stats, CHashWriter& ss, const uint256& hash,\n     ss << VARINT(0u);\n }\n \n+static void ApplyStats(CCoinsStats &stats, nullptr_t, const uint256& hash, const std::map<uint32_t, Coin>& outputs)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443065982",
      "id" : 443065982,
      "in_reply_to_id" : 442947356,
      "line" : 44,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NTk4Mg==",
      "original_commit_id" : "ea41a5bdcc49566be0c23ef9362781e70f557bad",
      "original_line" : 44,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/node/coinstats.cpp",
      "position" : 37,
      "pull_request_review_id" : 434367534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:30:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443065982",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443066599"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443066599"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should be identical to the other cases to make it grep-able. See dev-notes example:\r\n\r\n```cpp\r\nenum class Tabs {\r\n    INFO,\r\n    CONSOLE,\r\n    GRAPH,\r\n    PEERS\r\n};\r\n\r\nint GetInt(Tabs tab)\r\n{\r\n    switch (tab) {\r\n    case Tabs::INFO: return 0;\r\n    case Tabs::CONSOLE: return 1;\r\n    case Tabs::GRAPH: return 2;\r\n    case Tabs::PEERS: return 3;\r\n    } // no default case, so the compiler can warn about missing cases\r\n    assert(false);\r\n}\r\n```\r\n```suggestion\r\n    assert(false);\r\n```",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T22:33:12Z",
      "diff_hunk" : "@@ -66,9 +88,38 @@ bool GetUTXOStats(CCoinsView* view, CCoinsStats& stats, const std::function<void\n         pcursor->Next();\n     }\n     if (!outputs.empty()) {\n-        ApplyStats(stats, ss, prevkey, outputs);\n+        ApplyStats(stats, hash_obj, prevkey, outputs);\n     }\n-    stats.hashSerialized = ss.GetHash();\n+\n+    FinalizeHash(hash_obj, stats);\n+\n     stats.nDiskSize = view->EstimateSize();\n     return true;\n }\n+\n+bool GetUTXOStats(CCoinsView *view, CCoinsStats& stats, CoinStatsHashType hash_type, const std::function<void()>& interruption_point)\n+{\n+    switch(hash_type) {\n+        case(CoinStatsHashType::HASH_SERIALIZED): {\n+            CHashWriter ss(SER_GETHASH, PROTOCOL_VERSION);\n+            return GetUTXOStats(view, stats, ss, interruption_point);\n+        }\n+        case(CoinStatsHashType::NONE): {\n+            return GetUTXOStats(view, stats, nullptr, interruption_point);\n+        }\n+    }\n+    assert(false); // Unreachable code",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443066599",
      "id" : 443066599,
      "line" : 111,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2NjU5OQ==",
      "original_commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "original_line" : 111,
      "original_position" : 105,
      "original_start_line" : null,
      "path" : "src/node/coinstats.cpp",
      "position" : 105,
      "pull_request_review_id" : 434368218,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:34:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443066599",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443068432"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443068432"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Hm, at least BTCPayServer uses it for FastSync: https://github.com/btcpayserver/btcpayserver-docker/tree/master/contrib/FastSync. They say in the docs to compare the whole `gettxoutsetinfo` but the hash is really what ensures there is nothing malicious going on. But I am not sure how much that feature is actually used. I will reach out to them to get an opinion.",
      "commit_id" : "0ca3ad17f3be381ee7844ffafc38fc38ce162893",
      "created_at" : "2020-06-19T22:41:33Z",
      "diff_hunk" : "@@ -981,7 +983,7 @@ static UniValue gettxoutsetinfo(const JSONRPCRequest& request)\n                         {RPCResult::Type::NUM, \"transactions\", \"The number of transactions with unspent outputs\"},\n                         {RPCResult::Type::NUM, \"txouts\", \"The number of unspent transaction outputs\"},\n                         {RPCResult::Type::NUM, \"bogosize\", \"A meaningless metric for UTXO set size\"},\n-                        {RPCResult::Type::STR_HEX, \"hash_serialized_2\", \"The serialized hash\"},\n+                        {RPCResult::Type::STR_HEX, \"hash_serialized_2\", \"The serialized hash (only present if 'hash_serialized_2' hash_type is chosen)\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19328#discussion_r443068432",
      "id" : 443068432,
      "in_reply_to_id" : 442959103,
      "line" : 986,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzA2ODQzMg==",
      "original_commit_id" : "e884c98996b135eee51e5d3994ae604110c797fd",
      "original_line" : 986,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 16,
      "pull_request_review_id" : 434370137,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19328",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-19T22:41:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443068432",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   }
]
