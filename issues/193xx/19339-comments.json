[
   {
      "author_association" : "MEMBER",
      "body" : "Absurd fees aren't even close to the only policy being enforced in ATMP... It doesn't make sense to split just this one out.",
      "created_at" : "2020-06-20T19:39:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19339#issuecomment-647037491",
      "id" : 647037491,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19339",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzAzNzQ5MQ==",
      "updated_at" : "2020-06-20T19:39:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647037491",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Absurd fees aren't even close to the only policy being enforced in ATMP... It doesn't make sense to split just this one out.\r\n\r\n@luke-jr Sorry ð   I'm a beginner so I don't know very much. Do you mean that there are other things that should be taken out too, or that it's not worth doing so at all?",
      "created_at" : "2020-06-20T19:42:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19339#issuecomment-647037802",
      "id" : 647037802,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19339",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzAzNzgwMg==",
      "updated_at" : "2020-06-20T19:42:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647037802",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/gzhao408/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gzhao408/followers",
         "following_url" : "https://api.github.com/users/gzhao408/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gzhao408/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gzhao408",
         "id" : 25183001,
         "login" : "gzhao408",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/gzhao408/orgs",
         "received_events_url" : "https://api.github.com/users/gzhao408/received_events",
         "repos_url" : "https://api.github.com/users/gzhao408/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gzhao408/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gzhao408/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gzhao408"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It might be worth doing, but I'm not sure if the costs outweigh the benefits, and if/when done, it should be splitting all policy from all consensus checks, not just one policy from the rest.",
      "created_at" : "2020-06-20T19:45:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19339#issuecomment-647038107",
      "id" : 647038107,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19339",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzAzODEwNw==",
      "updated_at" : "2020-06-20T19:45:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647038107",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Check out https://github.com/bitcoin/bitcoin/compare/0.20...luke-jr:sendraw_force-0.20+knots#diff-24efdb00bfbe56b140fb006b562cc70bR578\r\n\r\nThis changes all the policy checks to conditionals, while leaving the non-policy checks as strictly enforced. So a split would be on the same criteria. Note that reordering stuff may not always be a good idea, however...",
      "created_at" : "2020-06-20T19:50:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19339#issuecomment-647038586",
      "id" : 647038586,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19339",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzAzODU4Ng==",
      "updated_at" : "2020-06-20T19:50:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647038586",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19306 (refactor: Replace RecursiveMutex with Mutex in CTxMemPool by hebasto)\n* #19093 (RPC: testmempoolaccept returns transaction fee by rajarshimaitra)\n* #18354 (Use shared pointers only in validation interface by bvbfan)\n* #18044 (Use wtxid for transaction relay by sdaftuar)\n* #18027 (\"PSBT Operations\" dialog by gwillen)\n* #15719 (Wallet passive startup by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-06-20T19:54:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19339#issuecomment-647038926",
      "id" : 647038926,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19339",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzAzODkyNg==",
      "updated_at" : "2020-06-20T19:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647038926",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@luke-jr okay, I see what you're saying. Agree that refactoring consensus/policy should be as a whole + may or may not be worth it. I could be completely mistaken, but I thought that this was more... a user's preference rather than node's fee policy, since it's pretty much only used in RPC and wallet. It seems to be set to 0 in other places?",
      "created_at" : "2020-06-20T19:57:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19339#issuecomment-647039237",
      "id" : 647039237,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19339",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzAzOTIzNw==",
      "updated_at" : "2020-06-20T19:57:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647039237",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/gzhao408/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gzhao408/followers",
         "following_url" : "https://api.github.com/users/gzhao408/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gzhao408/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gzhao408",
         "id" : 25183001,
         "login" : "gzhao408",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/gzhao408/orgs",
         "received_events_url" : "https://api.github.com/users/gzhao408/received_events",
         "repos_url" : "https://api.github.com/users/gzhao408/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gzhao408/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gzhao408/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gzhao408"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think you're correct in the abstract on this one @gzhao408, but concretely this behavior is probably desirable as it's a belt-and-suspenders check of preventing things getting into the mempool that are *almost certainly* a mistake.\r\n\r\nEven though mining/accepting these things should be done, and our node shouldn't really do 'deep transaction inspection', the case of absurd fees is pretty clearly accidental, so we add this redundant check (which can be disabled afaict via `allowhighfees`) even though clients should ultimately be responsible for this and not *rely* on absurd fees being rejected.\r\n\r\nI think if you wanted to move the logic somewhere else (e.g., to just RPC layer) you could do that too, but the most convenient place for that logic is in ATMP as we load the required context to check fees there already.\r\n\r\nClient side absurd fee problems should generally improve post-taproot & with the segwit fixes as signers should be more aware of how much fees their txn is spending as they can be made aware of all the inputs values they are signing for.",
      "created_at" : "2020-06-20T20:59:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19339#issuecomment-647044823",
      "id" : 647044823,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19339",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzA0NDgyMw==",
      "updated_at" : "2020-06-20T20:59:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647044823",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gzhao408 You may be right - it's a good point that we don't enforce it on other stuff. Maybe we should really be checking it before even calling ATMP.\r\n\r\n@JeremyRubin This is needed for GUI transactions too, at least.",
      "created_at" : "2020-06-20T21:21:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19339#issuecomment-647046700",
      "id" : 647046700,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19339",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzA0NjcwMA==",
      "updated_at" : "2020-06-20T21:21:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647046700",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "One approach might be to introduce a redundant layer of logic to all the places we actually want to perform the absurdfee check, and then in a follow up PR (or commit if you want to do it in one), remove the now redundant ATMP check. I agree that ATMP is later than ideal for checking this property.",
      "created_at" : "2020-06-20T21:31:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19339#issuecomment-647047694",
      "id" : 647047694,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19339",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzA0NzY5NA==",
      "updated_at" : "2020-06-20T21:31:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647047694",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I agree with removing the absurd fee check from ATMP, but we should still have it somewhere instead of removing it completely. Since it only is used for transactions sent by the node, the ideal place to move this to would be `BroadcastTransaction` in `src/node/transaction.cpp`. The RPC and wallet (GUI goes through the wallet) both use `BroadcastTransaction`.",
      "created_at" : "2020-06-20T22:08:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19339#issuecomment-647050678",
      "id" : 647050678,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19339",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzA1MDY3OA==",
      "updated_at" : "2020-06-20T22:08:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647050678",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
