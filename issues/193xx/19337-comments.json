[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2020-06-20T13:54:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-646998291",
      "id" : 646998291,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19337",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0Njk5ODI5MQ==",
      "updated_at" : "2020-06-20T13:54:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/646998291",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r443132759"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443132759"
         }
      },
      "author_association" : "MEMBER",
      "body" : "no need to add dead code or code that is only used in tests",
      "commit_id" : "401d3b759e14a96332a033485257d2e993c2b944",
      "created_at" : "2020-06-20T13:54:46Z",
      "diff_hunk" : "@@ -166,10 +206,16 @@ static void pop_lock()\n     }\n }\n \n-void EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry)\n+template <typename MutexType>\n+void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry)\n {\n     push_lock(cs, CLockLocation(pszName, pszFile, nLine, fTry, util::ThreadGetInternalName()));\n }\n+template void EnterCritical(const char*, const char*, int, Mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, RecursiveMutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::recursive_mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, boost::mutex*, bool);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r443132759",
      "id" : 443132759,
      "line" : 218,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzEzMjc1OQ==",
      "original_commit_id" : "401d3b759e14a96332a033485257d2e993c2b944",
      "original_line" : 218,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/sync.cpp",
      "position" : 86,
      "pull_request_review_id" : 434429994,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-20T13:54:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443132759",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r443133836"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443133836"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "These instantiations are required even if tests do not exist. Without them it wouldn't link with errors like:\r\n```\r\nld: error: undefined symbol: void EnterCritical<boost::mutex>(char const*, char const*, int, boost::mutex*, bool)\r\n>>> referenced by checkqueue.h:184 (src/checkqueue.h:184)\r\n>>>               libbitcoin_server_a-validation.o:(CCheckQueueControl<CScriptCheck>::CCheckQueueControl(CCheckQueue<CScriptCheck>*)) in archive libbitcoin_server.a\r\n```",
      "commit_id" : "401d3b759e14a96332a033485257d2e993c2b944",
      "created_at" : "2020-06-20T14:10:45Z",
      "diff_hunk" : "@@ -166,10 +206,16 @@ static void pop_lock()\n     }\n }\n \n-void EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry)\n+template <typename MutexType>\n+void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry)\n {\n     push_lock(cs, CLockLocation(pszName, pszFile, nLine, fTry, util::ThreadGetInternalName()));\n }\n+template void EnterCritical(const char*, const char*, int, Mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, RecursiveMutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::recursive_mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, boost::mutex*, bool);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r443133836",
      "id" : 443133836,
      "in_reply_to_id" : 443132759,
      "line" : 218,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzEzMzgzNg==",
      "original_commit_id" : "401d3b759e14a96332a033485257d2e993c2b944",
      "original_line" : 218,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/sync.cpp",
      "position" : 86,
      "pull_request_review_id" : 434430918,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-20T14:10:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443133836",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r443134518"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443134518"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, this is solved in #18710 :)\r\n\r\nEDIT: I mean `boost::mutex`",
      "commit_id" : "401d3b759e14a96332a033485257d2e993c2b944",
      "created_at" : "2020-06-20T14:20:32Z",
      "diff_hunk" : "@@ -166,10 +206,16 @@ static void pop_lock()\n     }\n }\n \n-void EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry)\n+template <typename MutexType>\n+void EnterCritical(const char* pszName, const char* pszFile, int nLine, MutexType* cs, bool fTry)\n {\n     push_lock(cs, CLockLocation(pszName, pszFile, nLine, fTry, util::ThreadGetInternalName()));\n }\n+template void EnterCritical(const char*, const char*, int, Mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, RecursiveMutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, std::recursive_mutex*, bool);\n+template void EnterCritical(const char*, const char*, int, boost::mutex*, bool);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19337#discussion_r443134518",
      "id" : 443134518,
      "in_reply_to_id" : 443132759,
      "line" : 218,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MzEzNDUxOA==",
      "original_commit_id" : "401d3b759e14a96332a033485257d2e993c2b944",
      "original_line" : 218,
      "original_position" : 86,
      "original_start_line" : null,
      "path" : "src/sync.cpp",
      "position" : 86,
      "pull_request_review_id" : 434431505,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19337",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-20T14:22:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/443134518",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Travis error:\r\n- https://travis-ci.org/github/bitcoin/bitcoin/jobs/700351407#L4430",
      "created_at" : "2020-06-20T14:53:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-647005655",
      "id" : 647005655,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19337",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzAwNTY1NQ==",
      "updated_at" : "2020-06-20T14:53:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647005655",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Travis error:\r\n> \r\n>  - https://travis-ci.org/github/bitcoin/bitcoin/jobs/700351407#L4430\r\n\r\nIt is reliably reproducible locally.",
      "created_at" : "2020-06-20T15:33:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-647010420",
      "id" : 647010420,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19337",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzAxMDQyMA==",
      "updated_at" : "2020-06-20T15:33:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647010420",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > Travis error:\r\n> > \r\n> > * https://travis-ci.org/github/bitcoin/bitcoin/jobs/700351407#L4430\r\n> \r\n> It is reliably reproducible locally.\r\n\r\n@vasild \r\n~idk exactly why but~ moving the `potential_deadlock_detected` test case to the end fixes the problem.\r\n\r\nUPDATE: at the end of the `potential_deadlock_detected` test case the lock stack is not empty.",
      "created_at" : "2020-06-20T15:48:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19337#issuecomment-647012158",
      "id" : 647012158,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19337",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzAxMjE1OA==",
      "updated_at" : "2020-06-20T15:58:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647012158",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   }
]
