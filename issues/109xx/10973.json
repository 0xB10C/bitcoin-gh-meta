{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "This is a refactoring PR that does not change behavior in any way. This change:\r\n\r\n1. Creates an abstract [`Chain`](https://github.com/ryanofsky/bitcoin/blob/pr/wipc-sep/src/interfaces/chain.h) interface in [`src/interfaces/`](https://github.com/ryanofsky/bitcoin/tree/pr/wipc-sep/src/interfaces).\r\n1. Updates wallet code to call the new interface. This largely consists of diffs of the form:\r\n\r\n```diff\r\n-    wtx.nTimeReceived = GetAdjustedTime();\r\n+    wtx.nTimeReceived = m_chain->getAdjustedTime();\r\n```\r\n\r\nThe main exception being commit [`4ca088052d` Remove uses of chainActive and mapBlockIndex in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/4ca088052d13992ca5f61edec64384fd3975f068), which is also largely mechanical, but is more complicated because it involves getting rid of `CBlockIndex` pointers and replacing them with block heights and hashes.\r\n\r\nThis change allows followup PR #10102 (multiprocess gui & wallet PR) to work without any significant updates to wallet code. Additionally:\r\n\r\n* It provides a single place to describe the interface between wallet and node code.\r\n* It can make better wallet testing possible, because the Chain object consists of virtual methods that can be overloaded for mocking.\r\n\r\nCommits:\r\n\r\n- [`6f94698195` Add skeleton chain and client classes](https://github.com/bitcoin/bitcoin/pull/10973/commits/6f94698195db4130e6ec553013e62cc15c6657d0)\r\n- [`c887bb2f2d` Pass chain and client variables where needed](https://github.com/bitcoin/bitcoin/pull/10973/commits/c887bb2f2d2e9182249a2d05998bd9cfc94a2f58)\r\n- [`401c26d087` Remove direct node->wallet calls in init.cpp](https://github.com/bitcoin/bitcoin/pull/10973/commits/401c26d0879f2f034659d78a07f79a86203aa299)\r\n- [`3f85018a7c` Remove uses of cs_main in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/3f85018a7c3764f24cc8d92ee12bea10ecbdf5de)\r\n- [`034f03ceaa` Pass chain locked variables where needed](https://github.com/bitcoin/bitcoin/pull/10973/commits/034f03ceaab8307de13e28a3539417a0af7cc774)\r\n- [`4ca088052d` Remove uses of chainActive and mapBlockIndex in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/4ca088052d13992ca5f61edec64384fd3975f068)\r\n- [`df574e8de9` Remove uses of CheckFinalTx in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/df574e8de983d5511e7006b4f4cbf3b508e05c6b)\r\n- [`7ed6f91f70` Remove use of AcceptToMemoryPool in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/7ed6f91f703ba12a572262b9e3abfb35ac48ccc2)\r\n- [`342faa4524` Remove uses of GetVirtualTransactionSize in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/342faa45241cd86e2115ae74da1dfcb0ee4253e6)\r\n- [`a2abcf4fe0` Remove use of IsRBFOptIn in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/a2abcf4fe0023a8969b2b69b2fd11ea53cc02fcc)\r\n- [`a2f7015c87` Remove use of GetCountWithDescendants in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/a2f7015c878e79cf3e0d63129932d9937646dd31)\r\n- [`906957b10c` Remove use of g_connman / PushInventory in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/906957b10cf902e650c10803373546bd005fdca7)\r\n- [`bd244ff4f2` Remove use of GetTransactionAncestry in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/bd244ff4f2831a9804af4141c42f0bc7d8adaa1e)\r\n- [`e4012f925b` Remove use of CalculateMemPoolAncestors in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/e4012f925be407f7795af416697558a5a6298ea3)\r\n- [`9b6399db18` Remove uses of fee globals in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/9b6399db1840d800a8e45dd02760de5c11412d7d)\r\n- [`a57912bd72` Remove uses of fPruneMode in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/a57912bd7237ee72dfe8c50e2d58b76a813d482c)\r\n- [`f56f2e308c` Remove uses of g_connman in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/f56f2e308c5aa5740b396c616e21c7f90010c81e)\r\n- [`14a96e1f0e` Remove uses of GetAdjustedTime in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/14a96e1f0ebea9e75dc7e8becc3f261cbc1c58ba)\r\n- [`107d7457ea` Remove uses of InitMessage/Warning/Error in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/107d7457eabbb488d510b978688c18bdb30c8dc5)\r\n- [`189290fb3a` Remove use CValidationInterface in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/189290fb3abd1f63975256c62deb1a81f4b0cab7)\r\n- [`92b29f4bbc` Remove use of CRPCTable::appendCommand in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/92b29f4bbc84bc2b6ea39bc89f0d0becceeda71d)\r\n- [`1b0c1d5ddc` Remove use of generateBlocks in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/1b0c1d5ddc0428305f334f12ddd99bc7023c2275)\r\n- [`25414cee31` Remove uses of ParseConfirmTarget in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/25414cee31b9a48962ca118f39249606b403fb73)\r\n- [`48fa94eb2a` Remove use of uiInterface.LoadWallet in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/48fa94eb2ad0ee255a1ba4a33376cb8bbe446d80)\r\n- [`e9ad5e5898` Remove use of IsInitialBlockDownload in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/e9ad5e58988559a3acc57361d2fde155da9d442b)\r\n- [`16b749727a` Remove use of StartShutdown in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/16b749727a516e0198a4d0c92ba376792126ca97)\r\n- [`2da040ee45` Remove use of CCoinsViewMemPool::GetCoin in wallet code](https://github.com/bitcoin/bitcoin/pull/10973/commits/2da040ee454e1393050607921d625a9d60a0f960)",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 20,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10973/comments",
   "created_at" : "2017-08-01T22:17:26Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10973/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/10973",
   "id" : 247218529,
   "labels" : [
      {
         "color" : "cccccc",
         "default" : false,
         "id" : 955867938,
         "name" : "Needs rebase",
         "node_id" : "MDU6TGFiZWw5NTU4Njc5Mzg=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20rebase"
      },
      {
         "color" : "E6F6D6",
         "default" : false,
         "id" : 135961,
         "name" : "Refactoring",
         "node_id" : "MDU6TGFiZWwxMzU5NjE=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Refactoring"
      },
      {
         "color" : "08a781",
         "default" : false,
         "id" : 149424,
         "name" : "Wallet",
         "node_id" : "MDU6TGFiZWwxNDk0MjQ=",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10973/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDExOlB1bGxSZXF1ZXN0MTMzNTg0NTYw",
   "number" : 10973,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/10973.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10973",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/10973.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10973"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Refactor: separate wallet from node",
   "updated_at" : "2018-09-13T16:00:45Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10973",
   "user" : {
      "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
      "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
      "followers_url" : "https://api.github.com/users/ryanofsky/followers",
      "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/ryanofsky",
      "id" : 7133040,
      "login" : "ryanofsky",
      "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
      "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
      "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
      "repos_url" : "https://api.github.com/users/ryanofsky/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/ryanofsky"
   }
}
