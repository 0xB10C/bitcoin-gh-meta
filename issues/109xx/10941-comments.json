[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129814005"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129814005"
         }
      },
      "body" : "Without sleep sometimes the file doesn't have all blocks because `runCommand()` is aync. Any idea to avoid the sleep without pooling or blocking reads?",
      "commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "created_at" : "2017-07-27T11:13:13Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove\n+from tempfile import mkstemp\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_jsonrpc\n+from time import sleep\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        (fd, path) = mkstemp(text = True)\n+        os.close(fd)\n+\n+        self.path = path\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % path]]\n+\n+    def run_test(self):\n+        # generate 5 blocks\n+        blocks = self.nodes[0].generate(5)\n+        sleep(1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129814005",
      "id" : 129814005,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 32,
      "path" : "test/functional/blocknotify.py",
      "position" : 32,
      "pull_request_review_id" : 52624772,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-27T11:13:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129814005",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821628"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821628"
         }
      },
      "body" : "Replace with `import os`. `os.close` and `os.remove` is used below :-)",
      "commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "created_at" : "2017-07-27T11:57:14Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821628",
      "id" : 129821628,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 9,
      "path" : "test/functional/blocknotify.py",
      "position" : 9,
      "pull_request_review_id" : 52633117,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-27T11:57:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821628",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821681"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821681"
         }
      },
      "body" : "Remove `assert_raises_jsonrpc`. Not used :-)",
      "commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "created_at" : "2017-07-27T11:57:31Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove\n+from tempfile import mkstemp\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_jsonrpc",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821681",
      "id" : 129821681,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 12,
      "path" : "test/functional/blocknotify.py",
      "position" : 12,
      "pull_request_review_id" : 52633180,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-27T11:57:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821681",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821828"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821828"
         }
      },
      "body" : "Nit: `fd, path = mkstemp(text=True)` will do :-)",
      "commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "created_at" : "2017-07-27T11:58:18Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove\n+from tempfile import mkstemp\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_jsonrpc\n+from time import sleep\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        (fd, path) = mkstemp(text = True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821828",
      "id" : 129821828,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 21,
      "path" : "test/functional/blocknotify.py",
      "position" : 21,
      "pull_request_review_id" : 52633345,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-27T12:00:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821828",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "Concept ACK :-)",
      "created_at" : "2017-07-27T11:59:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-318341525",
      "id" : 318341525,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-07-27T11:59:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/318341525",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129822139"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129822139"
         }
      },
      "body" : "Lol yes. What do you guys prefer? Import module or symbols?",
      "commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "created_at" : "2017-07-27T12:00:02Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129822139",
      "id" : 129822139,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 9,
      "path" : "test/functional/blocknotify.py",
      "position" : 9,
      "pull_request_review_id" : 52633701,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-27T12:00:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129822139",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129823979"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129823979"
         }
      },
      "body" : "We have a winner:\r\n\r\n```\r\n$ git grep -E \"(import os|from os)\" -- \"*.py\" | cut -f2 -d: | sort | uniq -c\r\n     25 import os\r\n      2 import os.path\r\n```",
      "commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "created_at" : "2017-07-27T12:10:21Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129823979",
      "id" : 129823979,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 9,
      "path" : "test/functional/blocknotify.py",
      "position" : 9,
      "pull_request_review_id" : 52635789,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-27T12:10:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129823979",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   }
]
