[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129814005"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129814005"
         }
      },
      "body" : "Without sleep sometimes the file doesn't have all blocks because `runCommand()` is aync. Any idea to avoid the sleep without pooling or blocking reads?",
      "commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-07-27T11:13:13Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove\n+from tempfile import mkstemp\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_jsonrpc\n+from time import sleep\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        (fd, path) = mkstemp(text = True)\n+        os.close(fd)\n+\n+        self.path = path\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % path]]\n+\n+    def run_test(self):\n+        # generate 5 blocks\n+        blocks = self.nodes[0].generate(5)\n+        sleep(1)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129814005",
      "id" : 129814005,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 32,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52624772,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-31T21:13:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129814005",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821628"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821628"
         }
      },
      "body" : "Replace with `import os`. `os.close` and `os.remove` is used below :-)",
      "commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-07-27T11:57:14Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821628",
      "id" : 129821628,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 9,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52633117,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-31T21:13:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821628",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821681"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821681"
         }
      },
      "body" : "Remove `assert_raises_jsonrpc`. Not used :-)",
      "commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-07-27T11:57:31Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove\n+from tempfile import mkstemp\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_jsonrpc",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821681",
      "id" : 129821681,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 12,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52633180,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-31T21:13:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821681",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821828"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821828"
         }
      },
      "body" : "Nit: `fd, path = mkstemp(text=True)` will do :-)",
      "commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-07-27T11:58:18Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove\n+from tempfile import mkstemp\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_jsonrpc\n+from time import sleep\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        (fd, path) = mkstemp(text = True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129821828",
      "id" : 129821828,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 21,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52633345,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-31T21:13:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129821828",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "Concept ACK :-)",
      "created_at" : "2017-07-27T11:59:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-318341525",
      "id" : 318341525,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-07-27T11:59:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/318341525",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129822139"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129822139"
         }
      },
      "body" : "Lol yes. What do you guys prefer? Import module or symbols?",
      "commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-07-27T12:00:02Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129822139",
      "id" : 129822139,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 9,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52633701,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-31T21:13:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129822139",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129823979"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129823979"
         }
      },
      "body" : "We have a winner:\r\n\r\n```\r\n$ git grep -E \"(import os|from os)\" -- \"*.py\" | cut -f2 -d: | sort | uniq -c\r\n     25 import os\r\n      2 import os.path\r\n```",
      "commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-07-27T12:10:21Z",
      "diff_hunk" : "@@ -0,0 +1,42 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+from os import close, remove",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r129823979",
      "id" : 129823979,
      "original_commit_id" : "cebf6e05dac7f68452646264f27878b3883e4662",
      "original_position" : 9,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52635789,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-31T21:13:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/129823979",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "@practicalswift thanks for the review. Added a few comments and fixed the nits.",
      "created_at" : "2017-07-27T21:35:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-318493215",
      "id" : 318493215,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-07-27T21:35:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/318493215",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130046354"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130046354"
         }
      },
      "body" : "Please use `self.options.tmpdir`, so that files are contained in a single tree for each test.\r\n\r\nAlso nit: Please no whitespace for named args. (`text=True`)",
      "commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-07-28T09:13:55Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import tempfile\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        fd, path = tempfile.mkstemp(text = True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130046354",
      "id" : 130046354,
      "original_commit_id" : "4e9b9b22ac00dd05817edeabd200b5188defaf8a",
      "original_position" : 24,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52881207,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-31T21:13:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130046354",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130046878"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130046878"
         }
      },
      "body" : "Please no fixed sleeps. This might be too much time on a fast system or too less time on a slow io system.\r\n\r\nYou could wrap it into a while loop with timeout on failure and break on success. Alternatively there should be some helper function `wait_until` if I am not mistaken.",
      "commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-07-28T09:16:37Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import tempfile\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        fd, path = tempfile.mkstemp(text = True)\n+        os.close(fd)\n+\n+        self.path = path\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+        # the command will append the block hash to file\n+        self.extra_args = [['-blocknotify=echo -n %%s >> %s' % path]]\n+\n+    def run_test(self):\n+        # generate 3 blocks\n+        blocks = self.nodes[0].generate(3)\n+\n+        # wait while the command runs asynchronously\n+        time.sleep(3)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130046878",
      "id" : 130046878,
      "original_commit_id" : "4e9b9b22ac00dd05817edeabd200b5188defaf8a",
      "original_position" : 39,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52881207,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-31T21:13:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130046878",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130048943"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130048943"
         }
      },
      "body" : "nit: whitespace.\r\n\r\nConsider using a linter to catch nits.",
      "commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-07-28T09:26:51Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import tempfile\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        fd, path = tempfile.mkstemp(text = True)\n+        os.close(fd)\n+\n+        self.path = path\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+        # the command will append the block hash to file\n+        self.extra_args = [['-blocknotify=echo -n %%s >> %s' % path]]\n+\n+    def run_test(self):\n+        # generate 3 blocks\n+        blocks = self.nodes[0].generate(3)\n+\n+        # wait while the command runs asynchronously\n+        time.sleep(3)\n+\n+        # file content should equal the generated blocks hashes\n+        with open(self.path, 'r') as f:\n+            assert_equal(''.join(blocks), f.read())\n+        ",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130048943",
      "id" : 130048943,
      "original_commit_id" : "4e9b9b22ac00dd05817edeabd200b5188defaf8a",
      "original_position" : 44,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52884053,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-31T21:13:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130048943",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130049444"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130049444"
         }
      },
      "body" : "can assign `self.path` above rather than assign to a local variable `path`",
      "commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-07-28T09:29:15Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import tempfile\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        fd, path = tempfile.mkstemp(text = True)\n+        os.close(fd)\n+\n+        self.path = path",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130049444",
      "id" : 130049444,
      "original_commit_id" : "4e9b9b22ac00dd05817edeabd200b5188defaf8a",
      "original_position" : 27,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52884053,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-31T21:13:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130049444",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130057474"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130057474"
         }
      },
      "body" : "`self.options` is not defined at this point.",
      "commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-07-28T10:13:12Z",
      "diff_hunk" : "@@ -0,0 +1,49 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import tempfile\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        # get a temporary file path to store the notified blocks\n+        fd, path = tempfile.mkstemp(text = True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130057474",
      "id" : 130057474,
      "original_commit_id" : "4e9b9b22ac00dd05817edeabd200b5188defaf8a",
      "original_position" : 24,
      "path" : "test/functional/blocknotify.py",
      "position" : null,
      "pull_request_review_id" : 52893737,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-07-31T21:13:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130057474",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "@MarcoFalke done. However can't get tmpdir in the constructor. Any other suggestion?",
      "created_at" : "2017-07-31T20:05:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-319180756",
      "id" : 319180756,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-07-31T20:05:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/319180756",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "You could try to overwrite setup_network:\n\n```py\ndef setup_network():\n    self.extra_args = [bla]\n    super().setup_network()\n```\n\nOn Mon, Jul 31, 2017 at 10:06 PM, JoÃÂ£o Barbosa <notifications@github.com>\nwrote:\n\n> @MarcoFalke <https://github.com/marcofalke> done. However can't get\n> tmpdir in the constructor. Any other suggestion?\n>\n> Ã¢ÂÂ\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-319180756>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AGGmv0EceWaRTPKc4AFnANOaqKf4O_Jqks5sTjOogaJpZM4OlIuV>\n> .\n>\n",
      "created_at" : "2017-07-31T20:15:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-319183328",
      "id" : 319183328,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-07-31T20:15:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/319183328",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "@MarcoFalke ty, all comments addressed.",
      "created_at" : "2017-07-31T20:54:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-319193521",
      "id" : 319193521,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-07-31T20:54:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/319193521",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "body" : "utACK d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-08-01T04:51:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#issuecomment-319267063",
      "id" : 319267063,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10941",
      "updated_at" : "2017-08-01T04:51:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/319267063",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130944628"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130944628"
         }
      },
      "body" : "A few comments on this loop:\r\n\r\n- I'd make the sleep longer (say 0.1 seconds). I'm also not sure you need the back-off. Just a `time.sleep(0.1)` should be fine.\r\n- The total time allowed for the file to be written is 0.45 seconds. That needs to be longer (up to 10 seconds) since Travis can block i/o for many seconds at a time. See #10072.\r\n- Please make the comment clear about the total time allowed for the loop.",
      "commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "created_at" : "2017-08-02T17:37:59Z",
      "diff_hunk" : "@@ -0,0 +1,47 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+\"\"\"Test blocknotify.\n+\n+Verify that a bitcoind node calls the given command for each block\n+\"\"\"\n+\n+import os\n+import time\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+class BlockNotifyTest(BitcoinTestFramework):\n+\n+    def __init__(self):\n+        super().__init__()\n+\n+        self.setup_clean_chain = False\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.path = os.path.join(self.options.tmpdir, 'blocks.txt')\n+\n+        # the command will append the notified block hash to file\n+        self.extra_args = [['-blocknotify=echo %%s >> %s' % self.path]]\n+        super().setup_network()\n+\n+    def run_test(self):\n+        block_count = 10\n+        blocks = self.nodes[0].generate(block_count)\n+\n+        # wait for expected data length",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10941#discussion_r130944628",
      "id" : 130944628,
      "original_commit_id" : "d2c730c77f9b4011040e30f2bc2a4c8c6deb13f2",
      "original_position" : 36,
      "path" : "test/functional/blocknotify.py",
      "position" : 36,
      "pull_request_review_id" : 53875475,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10941",
      "updated_at" : "2017-08-02T17:38:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/130944628",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
