[
   {
      "author_association" : "OWNER",
      "body" : "I managed to hit this issue twice on master as of a week ago, OOMing a 32 GiB RAM system - but not since.",
      "created_at" : "2017-12-04T08:39:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11822#issuecomment-348894841",
      "id" : 348894841,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11822",
      "updated_at" : "2017-12-04T08:39:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/348894841",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "A fairly quick and rather unscientific git bisect says that e545dedf72bff2bd41c93c93eb576929fce37112 (part of #10286) is the commit that introduces the problem",
      "created_at" : "2017-12-04T09:18:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11822#issuecomment-348903894",
      "id" : 348903894,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11822",
      "updated_at" : "2017-12-04T09:18:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/348903894",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I've recently hit OOM kills and surprisingly lengthy reindexing times while running `-reindex` at https://github.com/bitcoin/bitcoin/commit/a89221873a3ee2451c73b41bbe2d99d36f439d31. Can dig up old syslog output if that would be helpful.\r\n\r\nEdit: machine OOM'd was 8GB RAM.",
      "created_at" : "2017-12-04T20:10:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11822#issuecomment-349089938",
      "id" : 349089938,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11822",
      "updated_at" : "2017-12-04T20:12:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/349089938",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This appears to be an unbounded queue rather than a memory leak. [From IRC](https://botbot.me/freenode/bitcoin-core-dev/2017-12-04/?msg=94245820&page=4)\r\n\r\n```\r\n<BlueMatt> validation running ahead of validationinterface, you end up with a deep queue of shared_ptr<CBlock>s of all the shit you connected\r\n<BlueMatt> not normally an issue, but reindex is particularly easy to hit there\r\n```",
      "created_at" : "2017-12-04T21:15:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11822#issuecomment-349107856",
      "id" : 349107856,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11822",
      "updated_at" : "2017-12-04T21:15:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/349107856",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "#11824 definitely fixes some of the issue, but I'm still seeing characteristics of a leak. I've had HEAD of  @TheBlueMatt's branch running for roughly 20 hours and just hit another OOM kill an hour and a half ago.\r\n\r\nCurrently, bitcoind is consuming ~4GB of memory (and climbing) despite being configured with `dbcache=2048`.\r\n\r\n![selection_912](https://user-images.githubusercontent.com/73197/33676597-feea1ac8-da6a-11e7-932b-dd1c125026ab.png)\r\n\r\nAlso currently, bitcoind is in the middle of a flurry of `UpdateTip` calls: \r\n```\r\n2017-12-06 17:51:26 UpdateTip: new best=000000000000000004d83a24935d4cbeac752a6694c54b6b7458adbfad597930 height=353991 version=0x00000003 log2_work=82.693085 tx=66925319 date='2015-04-27 21:53:03' progress=0.241454 cache=1354.9MiB(9831263txo)\r\n2017-12-06 17:51:26   - Connect postprocess: 3.43ms [71.70s (2.66ms/blk)]\r\n2017-12-06 17:51:26 - Connect block: 190.19ms [4649.96s (172.82ms/blk)]\r\n2017-12-06 17:51:26   - Load block from disk: 84.67ms [950.08s]\r\n2017-12-06 17:51:26     - Sanity checks: 28.50ms [295.75s (10.99ms/blk)]\r\n2017-12-06 17:51:26     - Fork checks: 0.35ms [5.42s (0.20ms/blk)]\r\n2017-12-06 17:51:26       - Connect 1485 transactions: 146.39ms (0.099ms/tx, 0.035ms/txin) [2062.80s (76.66ms/blk)]\r\n2017-12-06 17:51:26     - Verify 4230 txins: 146.72ms (0.035ms/txin) [2068.85s (76.89ms/blk)]\r\n2017-12-06 17:51:26     - Index writing: 74.44ms [898.25s (33.38ms/blk)]\r\n2017-12-06 17:51:26     - Callbacks: 0.39ms [5.49s (0.20ms/blk)]\r\n2017-12-06 17:51:26   - Connect total: 251.71ms [3293.98s (122.42ms/blk)]\r\n2017-12-06 17:51:27   - Flush: 32.85ms [326.96s (12.15ms/blk)]\r\n2017-12-06 17:51:27   - Writing chainstate: 0.82ms [7.61s (0.28ms/blk)]\r\n```",
      "created_at" : "2017-12-06T17:53:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11822#issuecomment-349721581",
      "id" : 349721581,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11822",
      "updated_at" : "2017-12-06T17:55:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/349721581",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   }
]
