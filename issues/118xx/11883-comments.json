[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11883#discussion_r156538344"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11883"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156538344"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Did you mean `if **not** arg.startswith(\"-datadir\")`?",
      "commit_id" : "d1498f98ab32813a780ae41518a569a7b315c8d4",
      "created_at" : "2017-12-13T00:48:54Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test various command line arguments and configuration file parameters.\"\"\"\n+\n+import os\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_raises_rpc_error\n+\n+class ConfArgsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def run_test(self):\n+        self.stop_node(0)\n+        # Remove the -datadir argument so it doesn't override the config file\n+        self.nodes[0].args = [arg for arg in self.nodes[0].args if arg.startswith(\"-datadir\")]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11883#discussion_r156538344",
      "id" : 156538344,
      "original_commit_id" : "49bfddddebba28f7fd5e895603afcdcfabf1088b",
      "original_position" : 20,
      "path" : "test/functional/conf_args.py",
      "position" : null,
      "pull_request_review_id" : 83032320,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11883",
      "updated_at" : "2017-12-13T01:22:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156538344",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11883#discussion_r156538430"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11883"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156538430"
         }
      },
      "author_association" : "MEMBER",
      "body" : "femto-nit: missing space after assert, redundant round braces.",
      "commit_id" : "d1498f98ab32813a780ae41518a569a7b315c8d4",
      "created_at" : "2017-12-13T00:49:42Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test various command line arguments and configuration file parameters.\"\"\"\n+\n+import os\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_raises_rpc_error\n+\n+class ConfArgsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def run_test(self):\n+        self.stop_node(0)\n+        # Remove the -datadir argument so it doesn't override the config file\n+        self.nodes[0].args = [arg for arg in self.nodes[0].args if arg.startswith(\"-datadir\")]\n+\n+        default_data_dir = os.path.join(self.options.tmpdir, 'node0')\n+        new_data_dir = os.path.join(default_data_dir, 'newdatadir')\n+        new_data_dir_2 = os.path.join(default_data_dir, 'newdatadir2')\n+\n+        # Check that using -datadir argument on non-existant directory fails\n+        self.assert_start_raises_init_error(0, ['-datadir='+new_data_dir], 'Error: Specified data directory \"' + new_data_dir + '\" does not exist.')\n+\n+        # Check that using non-existant datadir in conf file fails\n+        with open(os.path.join(default_data_dir, \"bitcoin.conf\"), 'a', encoding='utf8') as f:\n+            f.write(\"datadir=\" + new_data_dir + \"\\n\")\n+        self.assert_start_raises_init_error(0, [], 'Error reading configuration file: specified data directory \"' + new_data_dir + '\" does not exist.')\n+\n+        # Create the directory and ensure the config file now works\n+        os.mkdir(new_data_dir)\n+        self.start_node(0, ['-wallet=w1'])\n+        assert(os.path.isfile(os.path.join(new_data_dir, 'wallets', 'w1')))\n+        self.stop_node(0)\n+\n+        # Ensure command line argument overrides datadir in conf\n+        os.mkdir(new_data_dir_2)\n+        self.start_node(0, ['-datadir='+new_data_dir_2, '-wallet=w2'])\n+        assert(os.path.isfile(os.path.join(new_data_dir_2, 'wallets', 'w2')))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11883#discussion_r156538430",
      "id" : 156538430,
      "original_commit_id" : "49bfddddebba28f7fd5e895603afcdcfabf1088b",
      "original_position" : 43,
      "path" : "test/functional/conf_args.py",
      "position" : null,
      "pull_request_review_id" : 83032423,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11883",
      "updated_at" : "2017-12-13T01:22:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156538430",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11883#discussion_r156542920"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11883"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156542920"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Doh, yes, oops :)",
      "commit_id" : "d1498f98ab32813a780ae41518a569a7b315c8d4",
      "created_at" : "2017-12-13T01:22:28Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test various command line arguments and configuration file parameters.\"\"\"\n+\n+import os\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_raises_rpc_error\n+\n+class ConfArgsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+\n+    def run_test(self):\n+        self.stop_node(0)\n+        # Remove the -datadir argument so it doesn't override the config file\n+        self.nodes[0].args = [arg for arg in self.nodes[0].args if arg.startswith(\"-datadir\")]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11883#discussion_r156542920",
      "id" : 156542920,
      "in_reply_to_id" : 156538344,
      "original_commit_id" : "49bfddddebba28f7fd5e895603afcdcfabf1088b",
      "original_position" : 20,
      "path" : "test/functional/conf_args.py",
      "position" : null,
      "pull_request_review_id" : 83037281,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11883",
      "updated_at" : "2017-12-13T01:22:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/156542920",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   }
]
