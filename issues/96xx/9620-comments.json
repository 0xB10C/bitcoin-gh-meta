[
   {
      "body" : "Just to clarify: that address is yours (ie no money was lost, only isnt being displayed by a normal \"getbalance\" rpc call (ie getunconfirmedbalance is correct)?",
      "created_at" : "2017-01-24T02:39:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9620#issuecomment-274684906",
      "id" : 274684906,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9620",
      "updated_at" : "2017-01-24T02:39:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274684906",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "The money isn't showing in either `getunconfirmedbalance` or `getbalance`. I'll let you know what happens after it confirms, but I strongly suspect it'll arrive back in my (visible) wallet. I have the private key for the address it's in (I double checked that :P), so there's absolutely no risk in that sense.\r\n\r\nI've never had a problem with the wallet and unconfirmed change, but it seems to have been triggered by the spending of spending unconfirmed change, if I had to guess.\r\n\r\n\r\nBut my big concern is, what would happen if the transaction chain never confirmed? Seems like it's possible someone could \"lose\" money this way",
      "created_at" : "2017-01-24T04:04:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9620#issuecomment-274704309",
      "id" : 274704309,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9620",
      "updated_at" : "2017-01-24T04:12:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274704309",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9326759?v=3",
         "events_url" : "https://api.github.com/users/RHavar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RHavar/followers",
         "following_url" : "https://api.github.com/users/RHavar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RHavar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RHavar",
         "id" : 9326759,
         "login" : "RHavar",
         "organizations_url" : "https://api.github.com/users/RHavar/orgs",
         "received_events_url" : "https://api.github.com/users/RHavar/received_events",
         "repos_url" : "https://api.github.com/users/RHavar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RHavar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RHavar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RHavar"
      }
   },
   {
      "body" : "Also not sure if it's relevant, but sometimes I send money to myself.  (because sometimes my users make on-chain payments to each other). So in that case, both the change output and the other output are owned by my wallet.\r\n\r\nThe (sole) input that f600e0... is sourcing is one of those cases. It sources  702a1bfe235405069e50340c10e0b8236e25124ab5bab89a87ab3859a4f97f3b:0  which is owned by my wallet (non change ouput). And 702a1bfe235405069e50340c10e0b8236e25124ab5bab89a87ab3859a4f97f3b:1 was the change in that case.\r\n\r\nNot sure if it's relevant, I suspect not, but just throwing that out there. I strongly suspect the issue was triggered by 702a1bfe235405069e50340c10e0b8236e25124ab5bab89a87ab3859a4f97f3b when it sourced a bunch of unconfirmed change outputs, (who also might have sourced unconfirmed change outputs?)",
      "created_at" : "2017-01-24T04:32:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9620#issuecomment-274707290",
      "id" : 274707290,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9620",
      "updated_at" : "2017-01-24T04:33:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274707290",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9326759?v=3",
         "events_url" : "https://api.github.com/users/RHavar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RHavar/followers",
         "following_url" : "https://api.github.com/users/RHavar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RHavar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RHavar",
         "id" : 9326759,
         "login" : "RHavar",
         "organizations_url" : "https://api.github.com/users/RHavar/orgs",
         "received_events_url" : "https://api.github.com/users/RHavar/received_events",
         "repos_url" : "https://api.github.com/users/RHavar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RHavar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RHavar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RHavar"
      }
   },
   {
      "body" : "I assume you are running 0.13.2, right?\n",
      "created_at" : "2017-01-24T14:15:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9620#issuecomment-274813456",
      "id" : 274813456,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9620",
      "updated_at" : "2017-01-24T14:15:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274813456",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "Yeah.\r\nAlso the problem is much worse than I thought, that transaction has confirmed and the funds are no where to be seen.\r\n\r\n$ bitcoin-cli listunspent 0 | grep f600e0a64f2166deb03804499c09e1b3c07636a2d5725f4a10852774da02dd8a\r\n\r\nreturn nothing as well. However, that change address is actually in my wallet.",
      "created_at" : "2017-01-24T14:23:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9620#issuecomment-274815741",
      "id" : 274815741,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9620",
      "updated_at" : "2017-01-24T14:24:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274815741",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9326759?v=3",
         "events_url" : "https://api.github.com/users/RHavar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RHavar/followers",
         "following_url" : "https://api.github.com/users/RHavar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RHavar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RHavar",
         "id" : 9326759,
         "login" : "RHavar",
         "organizations_url" : "https://api.github.com/users/RHavar/orgs",
         "received_events_url" : "https://api.github.com/users/RHavar/received_events",
         "repos_url" : "https://api.github.com/users/RHavar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RHavar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RHavar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RHavar"
      }
   },
   {
      "body" : "Well the good news is that I ran `bitcoind -rescan` and it found my money =)",
      "created_at" : "2017-01-24T15:36:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9620#issuecomment-274838662",
      "id" : 274838662,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9620",
      "updated_at" : "2017-01-24T15:36:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274838662",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9326759?v=3",
         "events_url" : "https://api.github.com/users/RHavar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RHavar/followers",
         "following_url" : "https://api.github.com/users/RHavar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RHavar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RHavar",
         "id" : 9326759,
         "login" : "RHavar",
         "organizations_url" : "https://api.github.com/users/RHavar/orgs",
         "received_events_url" : "https://api.github.com/users/RHavar/received_events",
         "repos_url" : "https://api.github.com/users/RHavar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RHavar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RHavar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RHavar"
      }
   },
   {
      "body" : "Can you elaborate on what kinds of action you've done with this wallet? (RPCs, GUI operations, copying files around...). Balances disappearing is very serious, and we should figure out what caused this.",
      "created_at" : "2017-01-24T15:39:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9620#issuecomment-274839625",
      "id" : 274839625,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9620",
      "updated_at" : "2017-01-24T15:39:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274839625",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "I don't have the gui installed, so I don't do anything weird with that. I only interact with it over rpc, 99% of the time itor do anything weird. But I use it as a backend for my service and it gets hit by a lot of rpc calls to `sendtoaddress`.\r\n\r\nAs far as I know, this is the first time it's ever really been forced to spend from a chain of unconfirmed transactions -- so I believe this is what must have triggered it.\r\n\r\nNot sure if it matters, but the wallet itself is a few years old (so it's non-hd) and I have `txindex=1` set",
      "created_at" : "2017-01-24T15:40:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9620#issuecomment-274840035",
      "id" : 274840035,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9620",
      "updated_at" : "2017-01-24T15:43:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274840035",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9326759?v=3",
         "events_url" : "https://api.github.com/users/RHavar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RHavar/followers",
         "following_url" : "https://api.github.com/users/RHavar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RHavar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RHavar",
         "id" : 9326759,
         "login" : "RHavar",
         "organizations_url" : "https://api.github.com/users/RHavar/orgs",
         "received_events_url" : "https://api.github.com/users/RHavar/received_events",
         "repos_url" : "https://api.github.com/users/RHavar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RHavar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RHavar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RHavar"
      }
   },
   {
      "body" : "I'm also using totally default settings regarding spending unconfirmed funds.\r\n\r\n\r\nI suspect it's related to this transaction: 702a1bfe235405069e50340c10e0b8236e25124ab5bab89a87ab3859a4f97f3b\r\n\r\nWhich was generated via rpc `sendtoaddress 1JyZ2dJq2tz6RDTuNQfwg498Qu2CoCp7TG 66.6` where the interesting thing is that `1JyZ2dJq2tz6RDTuNQfwg498Qu2CoCp7TG` is actually part of my wallet. It's also worth noting that in order to create that transaction, it needed to source a bunch of unconfirmed transactions itself.\r\n\r\nThe next transaction was generated via rpc `sendtoaddress 1GUJWXTG9bCL72G2nPjEaWpSLC9FG5vfF2 0.0997`  actually sourced that unconfirmed money from the \"main\" output of 702a1bfe235405069e50340c10e0b8236e25124ab5bab89a87ab3859a4f97f3b  (I guess because it trusts it, because it comes from me, even though it's not a change output?).\r\n\r\nAnd it was the change from _that_ send (that arrived in 19pozzqPQ6tmubTPGY5KXy3GR5agAaAedA) which appeared to have been permanently lost until I rescanned the wallet.\r\n\r\n---\r\n\r\nIt also seems like a pretty rare case. My wallet has made 126,591 sends and this appears to be the only case of it. I was kind of hoping it happened more often, and found all these lost riches after I did the rescan :(",
      "created_at" : "2017-01-24T15:55:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9620#issuecomment-274844632",
      "id" : 274844632,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9620",
      "updated_at" : "2017-01-24T16:09:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274844632",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9326759?v=3",
         "events_url" : "https://api.github.com/users/RHavar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RHavar/followers",
         "following_url" : "https://api.github.com/users/RHavar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RHavar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RHavar",
         "id" : 9326759,
         "login" : "RHavar",
         "organizations_url" : "https://api.github.com/users/RHavar/orgs",
         "received_events_url" : "https://api.github.com/users/RHavar/received_events",
         "repos_url" : "https://api.github.com/users/RHavar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RHavar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RHavar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RHavar"
      }
   },
   {
      "body" : "I know you've already said this, but to just be 100% explicit, which getbalance call were you using?\r\n\r\n`getbalance` ?\r\n\r\nnot `getbalance '*'` or `getbalance ''`?\r\n\r\n",
      "created_at" : "2017-01-24T15:59:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9620#issuecomment-274845980",
      "id" : 274845980,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9620",
      "updated_at" : "2017-01-24T15:59:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274845980",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "body" : "Yeah, I was using just normal `bitcoin-cli getbalance`. The actual reason I noticed was that my site couldn't process any more withdrawals, even though the wallet should've had lots of funds in it. (I don't programmatically query the balance, I just blindly fire off `sendtoaddress` rpc requests)\r\n\r\nWhen doing `bitcoin-cli listunspent 0` it also didn't show the output, both before and after the transaction had confirmed. (Although after the -rescan, it did)",
      "created_at" : "2017-01-24T16:00:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9620#issuecomment-274846412",
      "id" : 274846412,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9620",
      "updated_at" : "2017-01-24T16:06:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274846412",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9326759?v=3",
         "events_url" : "https://api.github.com/users/RHavar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RHavar/followers",
         "following_url" : "https://api.github.com/users/RHavar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RHavar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RHavar",
         "id" : 9326759,
         "login" : "RHavar",
         "organizations_url" : "https://api.github.com/users/RHavar/orgs",
         "received_events_url" : "https://api.github.com/users/RHavar/received_events",
         "repos_url" : "https://api.github.com/users/RHavar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RHavar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RHavar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RHavar"
      }
   },
   {
      "body" : "Could you check your debug.log for \r\n`AddToWallet f600e0a64f2166deb03804499c09e1b3c07636a2d5725f4a10852774da02dd8a`?\r\n\r\nIt should have appeared when you placed the transaction, again when that transaction was confirmed in a block, and again when you did the rescan and it got to that block.\r\n\r\n\r\n\r\n",
      "created_at" : "2017-01-24T16:26:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/9620#issuecomment-274854915",
      "id" : 274854915,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9620",
      "updated_at" : "2017-01-24T16:26:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274854915",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4360349?v=3",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   }
]
