[
   {
      "author_association" : "MEMBER",
      "body" : "ACK 6b04aff38c06ee9db74132c783fde3e72c117ca0 -- diff looks correct\r\n\r\nThanks for fixing this!",
      "created_at" : "2020-01-27T12:42:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18008#issuecomment-578729489",
      "id" : 578729489,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18008",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3ODcyOTQ4OQ==",
      "updated_at" : "2020-01-27T12:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/578729489",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18008#discussion_r371417906"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18008"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371417906"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What is the point of declaring main here if it is already declared in libFuzzer?\r\n\r\nI guess we could save us all of this `__attribute__` wrangling with a simple compile time check:\r\n\r\n```cpp\r\n#if defined(__AFL_COMPILER)\r\nstatic bool read_stdin(std::vector<uint8_t>& data) { ... }\r\nint main(int argc, char** argv) { ... }\r\n#endif ",
      "commit_id" : "6b04aff38c06ee9db74132c783fde3e72c117ca0",
      "created_at" : "2020-01-27T18:50:57Z",
      "diff_hunk" : "@@ -46,6 +46,9 @@ extern \"C\" int LLVMFuzzerInitialize(int* argc, char*** argv)\n \n // Declare main(...) \"weak\" to allow for libFuzzer linking. libFuzzer provides\n // the main(...) function.\n+#if defined(MAC_OSX) && !defined(__AFL_COMPILER)\n+extern int main(int argc, char** argv) __attribute__((weak_import));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18008#discussion_r371417906",
      "id" : 371417906,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTQxNzkwNg==",
      "original_commit_id" : "6b04aff38c06ee9db74132c783fde3e72c117ca0",
      "original_position" : 14,
      "path" : "src/test/fuzz/fuzz.cpp",
      "position" : 14,
      "pull_request_review_id" : 348893710,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18008",
      "updated_at" : "2020-01-27T18:50:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371417906",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "ACK 6b04aff38c06ee9db74132c783fde3e72c117ca0\r\n\r\nTested both AFL and libFuzzer using documentation from https://github.com/bitcoin/bitcoin/pull/17942\r\n\r\nBoth AFL and libFuzzer build and run without issues.",
      "created_at" : "2020-01-27T20:37:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18008#issuecomment-578941147",
      "id" : 578941147,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18008",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3ODk0MTE0Nw==",
      "updated_at" : "2020-01-27T20:37:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/578941147",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/20860124?v=4",
         "events_url" : "https://api.github.com/users/eriknylund/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eriknylund/followers",
         "following_url" : "https://api.github.com/users/eriknylund/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eriknylund/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eriknylund",
         "id" : 20860124,
         "login" : "eriknylund",
         "node_id" : "MDQ6VXNlcjIwODYwMTI0",
         "organizations_url" : "https://api.github.com/users/eriknylund/orgs",
         "received_events_url" : "https://api.github.com/users/eriknylund/received_events",
         "repos_url" : "https://api.github.com/users/eriknylund/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eriknylund/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eriknylund/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eriknylund"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK 6b04aff38c06ee9db74132c783fde3e72c117ca0\r\n\r\nTested compiling fuzzer tests with libFuzzer which had not been working previously.",
      "created_at" : "2020-01-27T21:11:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18008#issuecomment-578954245",
      "id" : 578954245,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18008",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3ODk1NDI0NQ==",
      "updated_at" : "2020-01-27T21:11:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/578954245",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18008#discussion_r371688017"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18008"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371688017"
         }
      },
      "author_association" : "MEMBER",
      "body" : "We could leave out the `main` declaration entirely, I just thought it might be clearer in regards to it being weak linked. If you prefer I can replace it with a comment as to why we special case libFuzzer on macOS.",
      "commit_id" : "6b04aff38c06ee9db74132c783fde3e72c117ca0",
      "created_at" : "2020-01-28T09:26:50Z",
      "diff_hunk" : "@@ -46,6 +46,9 @@ extern \"C\" int LLVMFuzzerInitialize(int* argc, char*** argv)\n \n // Declare main(...) \"weak\" to allow for libFuzzer linking. libFuzzer provides\n // the main(...) function.\n+#if defined(MAC_OSX) && !defined(__AFL_COMPILER)\n+extern int main(int argc, char** argv) __attribute__((weak_import));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18008#discussion_r371688017",
      "id" : 371688017,
      "in_reply_to_id" : 371417906,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTY4ODAxNw==",
      "original_commit_id" : "6b04aff38c06ee9db74132c783fde3e72c117ca0",
      "original_position" : 14,
      "path" : "src/test/fuzz/fuzz.cpp",
      "position" : 14,
      "pull_request_review_id" : 349228121,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18008",
      "updated_at" : "2020-01-28T09:26:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371688017",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18008#discussion_r371826368"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18008"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371826368"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> I can replace it with a comment as to why we special case libFuzzer on macOS\r\n\r\nMy point is that we don't need to special case libFuzzer on macOS. I think, we can have the same simple code (a single compile time check) for all operating systems. There would be no need for `_attribute__` and `#if defined(MAC_OSX)` wrangling.",
      "commit_id" : "6b04aff38c06ee9db74132c783fde3e72c117ca0",
      "created_at" : "2020-01-28T14:15:29Z",
      "diff_hunk" : "@@ -46,6 +46,9 @@ extern \"C\" int LLVMFuzzerInitialize(int* argc, char*** argv)\n \n // Declare main(...) \"weak\" to allow for libFuzzer linking. libFuzzer provides\n // the main(...) function.\n+#if defined(MAC_OSX) && !defined(__AFL_COMPILER)\n+extern int main(int argc, char** argv) __attribute__((weak_import));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18008#discussion_r371826368",
      "id" : 371826368,
      "in_reply_to_id" : 371417906,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTgyNjM2OA==",
      "original_commit_id" : "6b04aff38c06ee9db74132c783fde3e72c117ca0",
      "original_position" : 14,
      "path" : "src/test/fuzz/fuzz.cpp",
      "position" : 14,
      "pull_request_review_id" : 349405221,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18008",
      "updated_at" : "2020-01-28T14:15:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371826368",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "What error am I supposed to be seeing on master (I run into plenty of problems, but don't know if that's because not following instructions correctly)?\r\n\r\nOn macOS 10.15.2 with llvm/9.0.1 (homebrew) I followed the instructions in #17942, first on master then on this PR. On master I ran into `subprocess timed out: Currently only libFuzzer is supported`. With this branch it just exits after `Fuzz targets selected: ['bech32']`. And then I'm able to run `src/test/fuzz/bech32` and watch a bunch of cryptic info scroll by.",
      "created_at" : "2020-01-28T17:04:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18008#issuecomment-579353310",
      "id" : 579353310,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18008",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3OTM1MzMxMA==",
      "updated_at" : "2020-01-28T17:10:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/579353310",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> What error am I supposed to be seeing on master (I run into plenty of problems, but don't know if that's because not following instructions correctly)?\r\n\r\nFor me the fuzzers compile when following the instructions from #17942 but when I start any of the fuzzers, they just hang. There is not output and they don't stop until interrupted manually. Running them through the python harness gives an error message about only AFL being supported but that's because the fuzzer hangs and the harness has a timeout built in (error message could be improved though).",
      "created_at" : "2020-01-28T17:11:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18008#issuecomment-579356294",
      "id" : 579356294,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18008",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3OTM1NjI5NA==",
      "updated_at" : "2020-01-28T17:12:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/579356294",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1322187?v=4",
         "events_url" : "https://api.github.com/users/fjahr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fjahr/followers",
         "following_url" : "https://api.github.com/users/fjahr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fjahr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fjahr",
         "id" : 1322187,
         "login" : "fjahr",
         "node_id" : "MDQ6VXNlcjEzMjIxODc=",
         "organizations_url" : "https://api.github.com/users/fjahr/orgs",
         "received_events_url" : "https://api.github.com/users/fjahr/received_events",
         "repos_url" : "https://api.github.com/users/fjahr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fjahr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fjahr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18008#discussion_r371965117"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18008"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371965117"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Also, not having a main function should fix the issue where compilation and linking succeeds and the fuzzer just runs \"blank\", I think.",
      "commit_id" : "6b04aff38c06ee9db74132c783fde3e72c117ca0",
      "created_at" : "2020-01-28T18:00:29Z",
      "diff_hunk" : "@@ -46,6 +46,9 @@ extern \"C\" int LLVMFuzzerInitialize(int* argc, char*** argv)\n \n // Declare main(...) \"weak\" to allow for libFuzzer linking. libFuzzer provides\n // the main(...) function.\n+#if defined(MAC_OSX) && !defined(__AFL_COMPILER)\n+extern int main(int argc, char** argv) __attribute__((weak_import));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18008#discussion_r371965117",
      "id" : 371965117,
      "in_reply_to_id" : 371417906,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MTk2NTExNw==",
      "original_commit_id" : "6b04aff38c06ee9db74132c783fde3e72c117ca0",
      "original_position" : 14,
      "path" : "src/test/fuzz/fuzz.cpp",
      "position" : 14,
      "pull_request_review_id" : 349585443,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18008",
      "updated_at" : "2020-01-28T18:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/371965117",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
