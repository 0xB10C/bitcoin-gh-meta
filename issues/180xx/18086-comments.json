[
   {
      "author_association" : "MEMBER",
      "body" : "@sdaftuar You may be interested in this for #18044 - it should be easy to use this to determine how much an extra index adds.",
      "created_at" : "2020-02-07T02:23:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583204148",
      "id" : 583204148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzIwNDE0OA==",
      "updated_at" : "2020-02-07T02:23:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583204148",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#18044](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/18044.html) (Use wtxid for transaction relay by sdaftuar)\n* [#18017](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/18017.html) (txmempool: split epoch logic into class by ajtowns)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-02-07T03:07:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583213275",
      "id" : 583213275,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzIxMzI3NQ==",
      "updated_at" : "2020-02-07T03:07:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583213275",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa can you take a look at https://github.com/JeremyRubin/bitcoin/pull/7?\r\n\r\nIt looks like when we get rid of mapTxLinks we'd then want to use an accounting allocator on the new child sets and get some DynamicMemoryUsage added to the cached inner usage?\r\n\r\nAt some point I also want to better break down the cachedInnerUsage tracking into buckets as it makes it easier to trace bugs.",
      "created_at" : "2020-02-07T03:26:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583217146",
      "id" : 583217146,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzIxNzE0Ng==",
      "updated_at" : "2020-02-07T03:26:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583217146",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm happy to rebase this on top of a removal of mapLinks, if that'd go in first. It looks pretty like I'd just need to remove mapLinks from this as well.\r\n\r\nI don't know if breaking down cachedInnerUsage is all that meaningful, as the Check() function can verify its correctness in aggregate.\r\n\r\nThere are plenty more options of shuffling things with AccountingAllocators... I don't have any particular preference apart from minimizing code changes.",
      "created_at" : "2020-02-07T03:45:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583220934",
      "id" : 583220934,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzIyMDkzNA==",
      "updated_at" : "2020-02-07T03:45:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583220934",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Don't you need to make TxLinks sets use accounting allocators in this patch too?",
      "created_at" : "2020-02-07T03:53:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583222441",
      "id" : 583222441,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzIyMjQ0MQ==",
      "updated_at" : "2020-02-07T03:53:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583222441",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@JeremyRubin Ah, that seems reasonable. My priority was the things that use a boost multiindex as guessing memory usage there is very hard, but no reason why it can't be extended to also the sets there.",
      "created_at" : "2020-02-07T04:04:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583224572",
      "id" : 583224572,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzIyNDU3Mg==",
      "updated_at" : "2020-02-07T04:04:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583224572",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Do you know if we were over or underestimating before?",
      "created_at" : "2020-02-07T04:45:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583231821",
      "id" : 583231821,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzIzMTgyMQ==",
      "updated_at" : "2020-02-07T04:45:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583231821",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "In mapTx we were overestimating slightly for realistic mempool size, but underestimating for near-empty ones.",
      "created_at" : "2020-02-07T04:47:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583232326",
      "id" : 583232326,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzIzMjMyNg==",
      "updated_at" : "2020-02-07T04:47:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583232326",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok the near empty case doesn't really matter... w.r.t. the realistic size one, here's a question just to be detailed/pedantic with what this change does:\r\n\r\nGiven that we were previously overestimating, if I set my mempool to 100MB then I actually was getting (let's say) 99 MB, if the \"slightly\" was by 1%. If *after* this change, I am now actually using a little bit more memory is this enough to be concerned? E.g., are we going to see a bunch of raspberry pi users complaining of OOMs?",
      "created_at" : "2020-02-07T05:16:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583238193",
      "id" : 583238193,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzIzODE5Mw==",
      "updated_at" : "2020-02-07T05:16:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583238193",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Our memory accounting has never been more accurate than in the orders of 10s of MBs. A tiny change like this shouldn't matter.\n\nAnd probably on the long term, it helps: it's likely the case that in some scenarios we were off more than others (e.g. many tiny transactions vs a few big ones) - better estimations means that experimentally-determined max memory limits need less margin.",
      "created_at" : "2020-02-07T05:33:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583241485",
      "id" : 583241485,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzI0MTQ4NQ==",
      "updated_at" : "2020-02-07T05:33:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583241485",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The mempool tests happen to be very fragile -- I've noticed that sometimes when I made the mempool more memory efficient (e.g., in removing mapLinks) there are a bunch of failures because the tests depend on evictions happening because it's out of space.\r\n\r\nI'm not positive that's why your tests are failing, but it could be related.",
      "created_at" : "2020-02-07T05:57:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583246497",
      "id" : 583246497,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzI0NjQ5Nw==",
      "updated_at" : "2020-02-07T05:57:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583246497",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yes, they're failing because the mempool limits now work slightly differently. The test makes rather silly assumptions on the menory usage of transaction entries.",
      "created_at" : "2020-02-07T06:02:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583247641",
      "id" : 583247641,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzI0NzY0MQ==",
      "updated_at" : "2020-02-07T06:02:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583247641",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
