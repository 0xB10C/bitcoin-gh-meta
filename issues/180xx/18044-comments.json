[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#18038](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/18038.html) (P2P: Mempool tracks locally submitted transactions to improve privacy by amitiuttarwar)\n* [#17997](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17997.html) (refactor: Remove mempool global from net by MarcoFalke)\n* [#17785](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17785.html) (p2p: Unify Send and Receive protocol versions by hebasto)\n* [#17303](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17303.html) (p2p: Stop relaying non-mempool txs, improve tx privacy slightly by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-01-31T17:55:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18044#issuecomment-580840274",
      "id" : 580840274,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18044",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MDg0MDI3NA==",
      "updated_at" : "2020-02-03T23:52:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/580840274",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r373735577"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373735577"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You're dereferencing `it` here after it has been incremented (see Travis failure). I think you want to use `inv.type` instead.",
      "commit_id" : "c4a23a1ffc588064f2fbffa9259335322a296a1b",
      "created_at" : "2020-02-01T00:02:11Z",
      "diff_hunk" : "@@ -1601,12 +1632,13 @@ void static ProcessGetData(CNode* pfrom, const CChainParams& chainparams, CConnm\n             // Send stream from relay memory\n             bool push = false;\n             auto mi = mapRelay.find(inv.hash);\n+            // WTX and WITNESS_TX imply we serialize with witness\n             int nSendFlags = (inv.type == MSG_TX ? SERIALIZE_TRANSACTION_NO_WITNESS : 0);\n             if (mi != mapRelay.end()) {\n                 connman->PushMessage(pfrom, msgMaker.Make(nSendFlags, NetMsgType::TX, *mi->second));\n                 push = true;\n             } else {\n-                auto txinfo = mempool.info(inv.hash);\n+                auto txinfo = mempool.info(inv.hash, it->type == MSG_WTX);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r373735577",
      "id" : 373735577,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MzczNTU3Nw==",
      "original_commit_id" : "310aafa76bc460f05ff061d24eb8ea6954a54fe4",
      "original_position" : 197,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 351841019,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044",
      "updated_at" : "2020-02-05T16:40:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373735577",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r373775307"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373775307"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks, fixed.",
      "commit_id" : "c4a23a1ffc588064f2fbffa9259335322a296a1b",
      "created_at" : "2020-02-01T11:37:12Z",
      "diff_hunk" : "@@ -1601,12 +1632,13 @@ void static ProcessGetData(CNode* pfrom, const CChainParams& chainparams, CConnm\n             // Send stream from relay memory\n             bool push = false;\n             auto mi = mapRelay.find(inv.hash);\n+            // WTX and WITNESS_TX imply we serialize with witness\n             int nSendFlags = (inv.type == MSG_TX ? SERIALIZE_TRANSACTION_NO_WITNESS : 0);\n             if (mi != mapRelay.end()) {\n                 connman->PushMessage(pfrom, msgMaker.Make(nSendFlags, NetMsgType::TX, *mi->second));\n                 push = true;\n             } else {\n-                auto txinfo = mempool.info(inv.hash);\n+                auto txinfo = mempool.info(inv.hash, it->type == MSG_WTX);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r373775307",
      "id" : 373775307,
      "in_reply_to_id" : 373735577,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NTMwNw==",
      "original_commit_id" : "310aafa76bc460f05ff061d24eb8ea6954a54fe4",
      "original_position" : 197,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 351880462,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044",
      "updated_at" : "2020-02-05T16:40:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373775307",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r373775416"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373775416"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I wonder if this should be sent immediately in response to a VERSION message, rather than in response to a VERACK.  It looks like the way I've done it here creates a race condition where a peer could send a txid-based inv to us before it gets this message, which I think would cause relay of that transaction to fail.\r\n\r\nhttps://travis-ci.org/bitcoin/bitcoin/jobs/644609638?utm_medium=notification&utm_source=github_status",
      "commit_id" : "c4a23a1ffc588064f2fbffa9259335322a296a1b",
      "created_at" : "2020-02-01T11:39:03Z",
      "diff_hunk" : "@@ -2175,6 +2175,10 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n             nCMPCTBLOCKVersion = 1;\n             connman->PushMessage(pfrom, msgMaker.Make(NetMsgType::SENDCMPCT, fAnnounceUsingCMPCTBLOCK, nCMPCTBLOCKVersion));\n         }\n+\n+        if (pfrom->nVersion >= WTXID_RELAY_VERSION) {\n+            connman->PushMessage(pfrom, msgMaker.Make(NetMsgType::WTXIDRELAY));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r373775416",
      "id" : 373775416,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzc3NTQxNg==",
      "original_commit_id" : "ee29e7debcb14fa335e8482888a5cc0294bb8dc8",
      "original_position" : 6,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 351880546,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044",
      "updated_at" : "2020-02-05T16:40:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373775416",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r374576703"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/374576703"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Seeing a build warning here:\r\n```\r\nnet_processing.cpp: In member function âvirtual bool PeerLogicValidation::SendMessages(CNode*)â:\r\nnet_processing.cpp:4135:42: warning: enumeral and non-enumeral type in conditional expression [-Wextra]\r\n             CInv inv(state.m_wtxid_relay ? MSG_WTX : (MSG_TX | GetFetchFlags(pto)), txid);\r\n                      ~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\n```",
      "commit_id" : "c4a23a1ffc588064f2fbffa9259335322a296a1b",
      "created_at" : "2020-02-04T10:04:03Z",
      "diff_hunk" : "@@ -4057,7 +4132,7 @@ bool PeerLogicValidation::SendMessages(CNode* pto)\n             // Erase this entry from tx_process_time (it may be added back for\n             // processing at a later time, see below)\n             tx_process_time.erase(tx_process_time.begin());\n-            CInv inv(MSG_TX | GetFetchFlags(pto), txid);\n+            CInv inv(state.m_wtxid_relay ? MSG_WTX : (MSG_TX | GetFetchFlags(pto)), txid);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r374576703",
      "id" : 374576703,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDU3NjcwMw==",
      "original_commit_id" : "fd2c3f257e416323dc6cc1351af65a4026057716",
      "original_position" : 449,
      "path" : "src/net_processing.cpp",
      "position" : 450,
      "pull_request_review_id" : 352852514,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044",
      "updated_at" : "2020-02-05T16:40:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/374576703",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r374697402"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/374697402"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah I saw that too, but I think the code is correct?",
      "commit_id" : "c4a23a1ffc588064f2fbffa9259335322a296a1b",
      "created_at" : "2020-02-04T14:21:25Z",
      "diff_hunk" : "@@ -4057,7 +4132,7 @@ bool PeerLogicValidation::SendMessages(CNode* pto)\n             // Erase this entry from tx_process_time (it may be added back for\n             // processing at a later time, see below)\n             tx_process_time.erase(tx_process_time.begin());\n-            CInv inv(MSG_TX | GetFetchFlags(pto), txid);\n+            CInv inv(state.m_wtxid_relay ? MSG_WTX : (MSG_TX | GetFetchFlags(pto)), txid);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r374697402",
      "id" : 374697402,
      "in_reply_to_id" : 374576703,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDY5NzQwMg==",
      "original_commit_id" : "fd2c3f257e416323dc6cc1351af65a4026057716",
      "original_position" : 449,
      "path" : "src/net_processing.cpp",
      "position" : 450,
      "pull_request_review_id" : 353010926,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044",
      "updated_at" : "2020-02-05T16:40:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/374697402",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Wrote up a short BIP draft here: https://github.com/sdaftuar/bips/blob/2020-02-wtxid-relay/bip-wtxid-relay.mediawiki, which this PR implements. \r\n\r\nI'll wait for some concept ACKs here before I send to the mailing list.",
      "created_at" : "2020-02-04T14:23:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18044#issuecomment-581932930",
      "id" : 581932930,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18044",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MTkzMjkzMA==",
      "updated_at" : "2020-02-04T14:23:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/581932930",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Nice -- will add a link to the BIP draft in the review club notes. Currently reviewing. Can someone add a `Review club` label?",
      "created_at" : "2020-02-04T14:38:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18044#issuecomment-581939690",
      "id" : 581939690,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18044",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MTkzOTY5MA==",
      "updated_at" : "2020-02-04T14:38:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/581939690",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Cocnept ACK. Ran standard tests. All passing. Overall agreed with the idea of using wtxid for everything. Will try to try out the huristic and report some results.   ",
      "created_at" : "2020-02-04T18:27:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18044#issuecomment-582049318",
      "id" : 582049318,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18044",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MjA0OTMxOA==",
      "updated_at" : "2020-02-04T18:27:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/582049318",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/codeShark149/events{/privacy}",
         "followers_url" : "https://api.github.com/users/codeShark149/followers",
         "following_url" : "https://api.github.com/users/codeShark149/following{/other_user}",
         "gists_url" : "https://api.github.com/users/codeShark149/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/codeShark149",
         "id" : 36541669,
         "login" : "codeShark149",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/codeShark149/orgs",
         "received_events_url" : "https://api.github.com/users/codeShark149/received_events",
         "repos_url" : "https://api.github.com/users/codeShark149/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/codeShark149/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/codeShark149/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/codeShark149"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r374846097"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/374846097"
         }
      },
      "author_association" : "NONE",
      "body" : "Doesn't this comment needs update in light of the changed condition? We are now accepting txs containg witness in recentRejects.  ",
      "commit_id" : "c4a23a1ffc588064f2fbffa9259335322a296a1b",
      "created_at" : "2020-02-04T18:29:58Z",
      "diff_hunk" : "@@ -2604,14 +2604,15 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n                 // We will continue to reject this tx since it has rejected\n                 // parents so avoid re-requesting it from other peers.\n                 recentRejects->insert(tx.GetHash());\n+                recentRejects->insert(tx.GetWitnessHash());\n             }\n         } else {\n-            if (!tx.HasWitness() && state.GetResult() != TxValidationResult::TX_WITNESS_MUTATED) {\n+            if (tx.HasWitness() || state.GetResult() != TxValidationResult::TX_WITNESS_MUTATED) {\n                 // Do not use rejection cache for witness transactions or\n                 // witness-stripped transactions, as they can have been malleated.\n                 // See https://github.com/bitcoin/bitcoin/issues/8279 for details.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r374846097",
      "id" : 374846097,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDg0NjA5Nw==",
      "original_commit_id" : "fb1b69dba63ff9911a2520cdae8f5aab78f26ec0",
      "original_position" : 26,
      "path" : "src/net_processing.cpp",
      "position" : 348,
      "pull_request_review_id" : 353203516,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044",
      "updated_at" : "2020-02-05T16:40:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/374846097",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/36541669?v=4",
         "events_url" : "https://api.github.com/users/codeShark149/events{/privacy}",
         "followers_url" : "https://api.github.com/users/codeShark149/followers",
         "following_url" : "https://api.github.com/users/codeShark149/following{/other_user}",
         "gists_url" : "https://api.github.com/users/codeShark149/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/codeShark149",
         "id" : 36541669,
         "login" : "codeShark149",
         "node_id" : "MDQ6VXNlcjM2NTQxNjY5",
         "organizations_url" : "https://api.github.com/users/codeShark149/orgs",
         "received_events_url" : "https://api.github.com/users/codeShark149/received_events",
         "repos_url" : "https://api.github.com/users/codeShark149/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/codeShark149/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/codeShark149/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/codeShark149"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Reference [IRC discussion](http://www.erisian.com.au/bitcoin-core-dev/log-2020-02-05.html#l-336) for further context around the VERSION/VERACK messages.",
      "created_at" : "2020-02-06T19:47:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18044#issuecomment-583078254",
      "id" : 583078254,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18044",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU4MzA3ODI1NA==",
      "updated_at" : "2020-02-06T19:47:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583078254",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/755825?v=4",
         "events_url" : "https://api.github.com/users/adamjonas/events{/privacy}",
         "followers_url" : "https://api.github.com/users/adamjonas/followers",
         "following_url" : "https://api.github.com/users/adamjonas/following{/other_user}",
         "gists_url" : "https://api.github.com/users/adamjonas/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/adamjonas",
         "id" : 755825,
         "login" : "adamjonas",
         "node_id" : "MDQ6VXNlcjc1NTgyNQ==",
         "organizations_url" : "https://api.github.com/users/adamjonas/orgs",
         "received_events_url" : "https://api.github.com/users/adamjonas/received_events",
         "repos_url" : "https://api.github.com/users/adamjonas/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/adamjonas/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/adamjonas/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/adamjonas"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r376195717"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376195717"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it's treating `MSG_WTX` as `enum GetDataMsg` and `MSG_TX | GetFetchFlags()` as `uint32_t` (match `GetFetchFlags` return type). Changing `GetFetchFlags()` to return `GetDataMsg` (and casting its result correspondingly), and making it `enum GetDataMsg : uint32_t` makes the warning go away. Actually, just saying `enum GetDataMsg : uint32_t` makes the warning go away too by the looks.",
      "commit_id" : "c4a23a1ffc588064f2fbffa9259335322a296a1b",
      "created_at" : "2020-02-07T03:12:30Z",
      "diff_hunk" : "@@ -4057,7 +4132,7 @@ bool PeerLogicValidation::SendMessages(CNode* pto)\n             // Erase this entry from tx_process_time (it may be added back for\n             // processing at a later time, see below)\n             tx_process_time.erase(tx_process_time.begin());\n-            CInv inv(MSG_TX | GetFetchFlags(pto), txid);\n+            CInv inv(state.m_wtxid_relay ? MSG_WTX : (MSG_TX | GetFetchFlags(pto)), txid);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18044#discussion_r376195717",
      "id" : 376195717,
      "in_reply_to_id" : 374576703,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NjE5NTcxNw==",
      "original_commit_id" : "fd2c3f257e416323dc6cc1351af65a4026057716",
      "original_position" : 449,
      "path" : "src/net_processing.cpp",
      "position" : 450,
      "pull_request_review_id" : 354909544,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18044",
      "updated_at" : "2020-02-07T03:12:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/376195717",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   }
]
