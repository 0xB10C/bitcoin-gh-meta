[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [furszy](https://github.com/bitcoin/bitcoin/pull/27914#pullrequestreview-1497104793) |\n| Concept ACK | [dimitaracev](https://github.com/bitcoin/bitcoin/pull/27914#issuecomment-1597677258), [luke-jr](https://github.com/bitcoin/bitcoin/pull/27914#pullrequestreview-1496658921) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n",
      "created_at" : "2023-06-19T18:39:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27914#issuecomment-1597607523",
      "id" : 1597607523,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27914",
      "node_id" : "IC_kwDOABII585fOY5j",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1597607523/reactions"
      },
      "updated_at" : "2023-06-25T14:52:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1597607523",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2023-06-19T19:45:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27914#issuecomment-1597677258",
      "id" : 1597677258,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27914",
      "node_id" : "IC_kwDOABII585fOp7K",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1597677258/reactions"
      },
      "updated_at" : "2023-06-19T19:45:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1597677258",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/33068296?v=4",
         "events_url" : "https://api.github.com/users/dimitaracev/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dimitaracev/followers",
         "following_url" : "https://api.github.com/users/dimitaracev/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dimitaracev/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dimitaracev",
         "id" : 33068296,
         "login" : "dimitaracev",
         "node_id" : "MDQ6VXNlcjMzMDY4Mjk2",
         "organizations_url" : "https://api.github.com/users/dimitaracev/orgs",
         "received_events_url" : "https://api.github.com/users/dimitaracev/received_events",
         "repos_url" : "https://api.github.com/users/dimitaracev/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dimitaracev/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dimitaracev/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dimitaracev"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">  this does bring up a larger question of how we should handle such large feerates in fuzzing.\r\n\r\nI think this particular issue is using the RPC interface, not the fuzzing interface. (Although it was found by fuzzing). Generally, if the RPC (and all other interfaces) had a guard against large values, then the fuzzing interface can also guard the values to the appropriate range. If one interface doesn't have a guard, the fuzzing shouldn't guard either.",
      "created_at" : "2023-06-20T07:09:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27914#issuecomment-1598231773",
      "id" : 1598231773,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27914",
      "node_id" : "IC_kwDOABII585fQxTd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1598231773/reactions"
      },
      "updated_at" : "2023-06-20T07:09:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1598231773",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> although this does bring up a larger question of how we should handle such large feerates in fuzzing.\r\n\r\nWe use the `fee_a Ã vsize_b > fee_b Ã vsize_a` trick in a bunch of places. On the other hand, fee is calculated from `vsize Ã feerate`. So, in fuzzing based on a feerate input, we should limit the feerate to prevent integer overflows with `int64_t` to `max_feerate = int64_t_max / (max_vsizeÂ²)`?\r\n\r\nIf we assume that our code does not have to deal with transactions greater than 100_000â¯vB:\r\n\r\n`9_223_372_036_854_775_807Ã·(100_000Â²) = 922_337_203_685â¯[á¹©/kvB] â 922_337_203â¯[á¹©/vB]  â 9_223â¯â¿/kvB`\r\n\r\nIf we assume that our code should be able to handle transactions of up to 1_000_000â¯vB, weâd restrict ourselves to 1/100 of that, i.e. `9_223_372_036â¯á¹©/kvB` or `9_223_372â¯á¹©/vB`",
      "created_at" : "2023-06-26T14:42:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27914#issuecomment-1607637305",
      "id" : 1607637305,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27914",
      "node_id" : "IC_kwDOABII585f0pk5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1607637305/reactions"
      },
      "updated_at" : "2023-06-26T15:10:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1607637305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> We use the fee_a Ã vsize_b > fee_b Ã vsize_a trick in a bunch of places. On the other hand, fee is calculated from vsize Ã feerate. So, in fuzzing based on a feerate input, we should limit the feerate to prevent integer overflows with int64_t to max_feerate = int64_t_max / (max_vsizeÂ²)?\r\n\r\nI'd say no, because the tricks use `double`, not `int64_t`, no? Also, this is an rpc interface bug, not a fuzzing bug, see https://github.com/bitcoin/bitcoin/pull/27914#issuecomment-1598231773",
      "created_at" : "2023-06-26T14:56:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27914#issuecomment-1607661240",
      "id" : 1607661240,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27914",
      "node_id" : "IC_kwDOABII585f0va4",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1607661240/reactions"
      },
      "updated_at" : "2023-06-26T14:56:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1607661240",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh, I meant to reply to the âlarger questionâ. I recently also bumped into an integer overflow when fuzzing coin selection stuff due to feerates being too large, and I figured that the underlying issue was the same.",
      "created_at" : "2023-06-26T15:12:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27914#issuecomment-1607693447",
      "id" : 1607693447,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27914",
      "node_id" : "IC_kwDOABII585f03SH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1607693447/reactions"
      },
      "updated_at" : "2023-06-26T15:14:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1607693447",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   }
]
