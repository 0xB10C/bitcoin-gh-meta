[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [ryanofsky](https://github.com/bitcoin/bitcoin/pull/27927#pullrequestreview-1501082371), [sipa](https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1609784685), [achow101](https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1611928229) |\n| Concept ACK | [theuni](https://github.com/bitcoin/bitcoin/pull/27927#pullrequestreview-1491377490) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.\n",
      "created_at" : "2023-06-21T14:30:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1600948132",
      "id" : 1600948132,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27927",
      "node_id" : "IC_kwDOABII585fbIek",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1600948132/reactions"
      },
      "updated_at" : "2023-06-28T19:01:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1600948132",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237381343"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237381343"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Use `static_assert` or `enable_if` to make this more obvious to the caller?",
      "commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "created_at" : "2023-06-21T17:55:48Z",
      "diff_hunk" : "@@ -274,12 +274,20 @@ Span<std::byte> MakeWritableByteSpan(V&& v) noexcept\n // Helper functions to safely cast to unsigned char pointers.\n inline unsigned char* UCharCast(char* c) { return (unsigned char*)c; }\n inline unsigned char* UCharCast(unsigned char* c) { return c; }\n+inline unsigned char* UCharCast(std::byte* c) { return reinterpret_cast<unsigned char*>(c); }\n inline const unsigned char* UCharCast(const char* c) { return (unsigned char*)c; }\n inline const unsigned char* UCharCast(const unsigned char* c) { return c; }\n inline const unsigned char* UCharCast(const std::byte* c) { return reinterpret_cast<const unsigned char*>(c); }\n \n // Helper function to safely convert a Span to a Span<[const] unsigned char>.\n template <typename T> constexpr auto UCharSpanCast(Span<T> s) -> Span<typename std::remove_pointer<decltype(UCharCast(s.data()))>::type> { return {UCharCast(s.data()), s.size()}; }\n+// Helper function to safely convert a Span to a Span<[const] std::byte>.\n+template <typename B>\n+auto ByteSpanCast(Span<B> s)\n+{\n+    // Use UCharCast to enforce B is a byte-like type.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237381343",
      "id" : 1237381343,
      "line" : 288,
      "node_id" : "PRRC_kwDOABII585JwPDf",
      "original_commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "original_line" : 288,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/span.h",
      "position" : 24,
      "pull_request_review_id" : 1491377490,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237381343/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-21T18:00:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237381343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237382754"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237382754"
         }
      },
      "author_association" : "MEMBER",
      "body" : "These seem too greedy I think. I guess you're counting on `ByteSpanCast` to enforce that it's byte-like?",
      "commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "created_at" : "2023-06-21T17:57:16Z",
      "diff_hunk" : "@@ -201,8 +202,7 @@ template<typename Stream> inline void Serialize(Stream& s, int64_t a ) { ser_wri\n template<typename Stream> inline void Serialize(Stream& s, uint64_t a) { ser_writedata64(s, a); }\n template<typename Stream, int N> inline void Serialize(Stream& s, const char (&a)[N]) { s.write(MakeByteSpan(a)); }\n template<typename Stream, int N> inline void Serialize(Stream& s, const unsigned char (&a)[N]) { s.write(MakeByteSpan(a)); }\n-template<typename Stream> inline void Serialize(Stream& s, const Span<const unsigned char>& span) { s.write(AsBytes(span)); }\n-template<typename Stream> inline void Serialize(Stream& s, const Span<unsigned char>& span) { s.write(AsBytes(span)); }\n+template <typename Stream, typename B> void Serialize(Stream& s, Span<B> span) { s.write(ByteSpanCast(span)); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237382754",
      "id" : 1237382754,
      "line" : 205,
      "node_id" : "PRRC_kwDOABII585JwPZi",
      "original_commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "original_line" : 205,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 14,
      "pull_request_review_id" : 1491377490,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237382754/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-21T18:00:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237382754",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237418132"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237418132"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> I guess you're counting on ByteSpanCast to enforce that it's byte-like?\r\n\r\nYes, if `ByteSpanCast` accepts non-byte spans, there are likely bugs in other places as well, which should be fixed.\r\n\r\n> These seem too greedy I think.\r\n\r\nI think it is fine, because non-byte spans can not be serialized without a formatter for the elements. Happy to add a comment here as well, if you think it helps?",
      "commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "created_at" : "2023-06-21T18:29:01Z",
      "diff_hunk" : "@@ -201,8 +202,7 @@ template<typename Stream> inline void Serialize(Stream& s, int64_t a ) { ser_wri\n template<typename Stream> inline void Serialize(Stream& s, uint64_t a) { ser_writedata64(s, a); }\n template<typename Stream, int N> inline void Serialize(Stream& s, const char (&a)[N]) { s.write(MakeByteSpan(a)); }\n template<typename Stream, int N> inline void Serialize(Stream& s, const unsigned char (&a)[N]) { s.write(MakeByteSpan(a)); }\n-template<typename Stream> inline void Serialize(Stream& s, const Span<const unsigned char>& span) { s.write(AsBytes(span)); }\n-template<typename Stream> inline void Serialize(Stream& s, const Span<unsigned char>& span) { s.write(AsBytes(span)); }\n+template <typename Stream, typename B> void Serialize(Stream& s, Span<B> span) { s.write(ByteSpanCast(span)); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237418132",
      "id" : 1237418132,
      "in_reply_to_id" : 1237382754,
      "line" : 205,
      "node_id" : "PRRC_kwDOABII585JwYCU",
      "original_commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "original_line" : 205,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 14,
      "pull_request_review_id" : 1491437943,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237418132/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-21T18:29:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237418132",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237418169"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237418169"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think it should already be obvious to the developer? `static_assert` or `enable_if` in this context can only turn one compile failure error message into another compile failure error message, because there are no other overloads for `ByteSpanCast` and I don't expect there to ever be ones. As this is not (standard) library code, any error message should be fine.\r\n\r\nCurrently I get:\r\n\r\n```\r\n./span.h:289:27: error: no matching function for call to 'UCharCast'\r\n    return Span{AsBytePtr(UCharCast(s.data())), s.size_bytes()};\r\n                          ^~~~~~~~~\r\nnote: in instantiation of function template specialization 'ByteSpanCast<const unsigned long>'...\r\n```\r\n\r\nHappy to move the code comment you commented on the same line as the return to include it in the error message if you think it helps?",
      "commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "created_at" : "2023-06-21T18:29:03Z",
      "diff_hunk" : "@@ -274,12 +274,20 @@ Span<std::byte> MakeWritableByteSpan(V&& v) noexcept\n // Helper functions to safely cast to unsigned char pointers.\n inline unsigned char* UCharCast(char* c) { return (unsigned char*)c; }\n inline unsigned char* UCharCast(unsigned char* c) { return c; }\n+inline unsigned char* UCharCast(std::byte* c) { return reinterpret_cast<unsigned char*>(c); }\n inline const unsigned char* UCharCast(const char* c) { return (unsigned char*)c; }\n inline const unsigned char* UCharCast(const unsigned char* c) { return c; }\n inline const unsigned char* UCharCast(const std::byte* c) { return reinterpret_cast<const unsigned char*>(c); }\n \n // Helper function to safely convert a Span to a Span<[const] unsigned char>.\n template <typename T> constexpr auto UCharSpanCast(Span<T> s) -> Span<typename std::remove_pointer<decltype(UCharCast(s.data()))>::type> { return {UCharCast(s.data()), s.size()}; }\n+// Helper function to safely convert a Span to a Span<[const] std::byte>.\n+template <typename B>\n+auto ByteSpanCast(Span<B> s)\n+{\n+    // Use UCharCast to enforce B is a byte-like type.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237418169",
      "id" : 1237418169,
      "in_reply_to_id" : 1237381343,
      "line" : 288,
      "node_id" : "PRRC_kwDOABII585JwYC5",
      "original_commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "original_line" : 288,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/span.h",
      "position" : 24,
      "pull_request_review_id" : 1491437986,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237418169/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-21T18:30:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237418169",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237425344"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237425344"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's only obvious because the implementation happens to be just below the definition :)\r\n\r\nBut sure, I guess that's good enough.",
      "commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "created_at" : "2023-06-21T18:34:35Z",
      "diff_hunk" : "@@ -274,12 +274,20 @@ Span<std::byte> MakeWritableByteSpan(V&& v) noexcept\n // Helper functions to safely cast to unsigned char pointers.\n inline unsigned char* UCharCast(char* c) { return (unsigned char*)c; }\n inline unsigned char* UCharCast(unsigned char* c) { return c; }\n+inline unsigned char* UCharCast(std::byte* c) { return reinterpret_cast<unsigned char*>(c); }\n inline const unsigned char* UCharCast(const char* c) { return (unsigned char*)c; }\n inline const unsigned char* UCharCast(const unsigned char* c) { return c; }\n inline const unsigned char* UCharCast(const std::byte* c) { return reinterpret_cast<const unsigned char*>(c); }\n \n // Helper function to safely convert a Span to a Span<[const] unsigned char>.\n template <typename T> constexpr auto UCharSpanCast(Span<T> s) -> Span<typename std::remove_pointer<decltype(UCharCast(s.data()))>::type> { return {UCharCast(s.data()), s.size()}; }\n+// Helper function to safely convert a Span to a Span<[const] std::byte>.\n+template <typename B>\n+auto ByteSpanCast(Span<B> s)\n+{\n+    // Use UCharCast to enforce B is a byte-like type.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237425344",
      "id" : 1237425344,
      "in_reply_to_id" : 1237381343,
      "line" : 288,
      "node_id" : "PRRC_kwDOABII585JwZzA",
      "original_commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "original_line" : 288,
      "original_position" : 24,
      "original_start_line" : null,
      "path" : "src/span.h",
      "position" : 24,
      "pull_request_review_id" : 1491450108,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237425344/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-21T18:34:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237425344",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237441495"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237441495"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Just a difference of opinion/style I guess. I'd rather not consider the function in the first place, but I suppose anything that causes a compile failure wfm.",
      "commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "created_at" : "2023-06-21T18:48:09Z",
      "diff_hunk" : "@@ -201,8 +202,7 @@ template<typename Stream> inline void Serialize(Stream& s, int64_t a ) { ser_wri\n template<typename Stream> inline void Serialize(Stream& s, uint64_t a) { ser_writedata64(s, a); }\n template<typename Stream, int N> inline void Serialize(Stream& s, const char (&a)[N]) { s.write(MakeByteSpan(a)); }\n template<typename Stream, int N> inline void Serialize(Stream& s, const unsigned char (&a)[N]) { s.write(MakeByteSpan(a)); }\n-template<typename Stream> inline void Serialize(Stream& s, const Span<const unsigned char>& span) { s.write(AsBytes(span)); }\n-template<typename Stream> inline void Serialize(Stream& s, const Span<unsigned char>& span) { s.write(AsBytes(span)); }\n+template <typename Stream, typename B> void Serialize(Stream& s, Span<B> span) { s.write(ByteSpanCast(span)); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237441495",
      "id" : 1237441495,
      "in_reply_to_id" : 1237382754,
      "line" : 205,
      "node_id" : "PRRC_kwDOABII585JwdvX",
      "original_commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "original_line" : 205,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 14,
      "pull_request_review_id" : 1491475605,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237441495/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-21T18:48:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237441495",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "node_id" : "MDQ6VXNlcjQxNzA0Mw==",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237503001"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237503001"
         }
      },
      "author_association" : "MEMBER",
      "body" : "C++20 Constraints and Concepts is probably going to fix the compiler errors in the long run. May even be less than 5 years until we can switch to that.",
      "commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "created_at" : "2023-06-21T19:06:06Z",
      "diff_hunk" : "@@ -201,8 +202,7 @@ template<typename Stream> inline void Serialize(Stream& s, int64_t a ) { ser_wri\n template<typename Stream> inline void Serialize(Stream& s, uint64_t a) { ser_writedata64(s, a); }\n template<typename Stream, int N> inline void Serialize(Stream& s, const char (&a)[N]) { s.write(MakeByteSpan(a)); }\n template<typename Stream, int N> inline void Serialize(Stream& s, const unsigned char (&a)[N]) { s.write(MakeByteSpan(a)); }\n-template<typename Stream> inline void Serialize(Stream& s, const Span<const unsigned char>& span) { s.write(AsBytes(span)); }\n-template<typename Stream> inline void Serialize(Stream& s, const Span<unsigned char>& span) { s.write(AsBytes(span)); }\n+template <typename Stream, typename B> void Serialize(Stream& s, Span<B> span) { s.write(ByteSpanCast(span)); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#discussion_r1237503001",
      "id" : 1237503001,
      "in_reply_to_id" : 1237382754,
      "line" : 205,
      "node_id" : "PRRC_kwDOABII585JwswZ",
      "original_commit_id" : "faa17da7ef42c5a67a6660c71ca2c5a418c45136",
      "original_line" : 205,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 14,
      "pull_request_review_id" : 1491560314,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27927",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237503001/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-21T19:06:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1237503001",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK. It makes sense to allow `Span<std::byte>` to serialize fixed size blobs, like `Span<unsigned char>` already does so there is no need for serialize callers to cast to `unsigned char` if they are already using `std::byte`.\r\n\r\nI also think it is nice that the implementation uses a `Span<T>` parameter type instead of `Span<std::byte>` or `Span<unsigned char>` so you can tell just by looking at the Serialize declaration that an actual `Span` argument needs to be passed, not some argument that can be implicitly converted to span. It is true as you pointed out in your earlier comment https://github.com/bitcoin/bitcoin/pull/27790#discussion_r1236743050 that the presence of the `Serialize(Stream& os, const T& a)` overload below already prevents implicit conversions, but it's nice if you can look directly at a declaration and see that it doesn't allow implicit conversions, without having to look at other overloads.\r\n\r\nLooking at surrounding code, I also think there are some followups that could be done to make it cleaner / safer / nicer (but would probably save these for a followup PR):\r\n\r\n1. I think it's not ideal that ByteSpanCast is using UCharCast cast internally. Now code is using `std::byte`, I think would be good to drop the `UCharCast` function and replace it with a similar function that accepts `char`, `unsigned char` and `std::byte` pointers, but returns a `std::byte` pointer rather than an `unsigned char` pointer. Doing this would remove an unnecessary series of casts from byte to char and back to byte again in ByteSpanCast, and also just generally move code further in the direction of using `std::byte` over `char`\r\n2. I think it might be good to refuse the serialize `Span<char>` and `Span<unsigned char>` arguments, and only serialize `Span<std::byte>` arguments as fixed size blobs. Again it would push code more in direction of using `std::byte` over `char` for binary data. It could also perhaps avoid cases where someone is trying to serialize a variable sized string and ends up through some misunderstood conversions accidentally serializing a fixed size span.\r\n3. I think it would be good to drop the `AsBytePtr` function, which looks like a safe conversion but actually can cast any pointer to a byte pointer, is not actually safe or useful to call on most object types. I think if suggestion 1 above is implemented, some uses of `AsBytePtr` would no longer be necessary, and the other uses would be clearer if they just used `reinterpret_cast` directly instead of `AsBytePtr`",
      "created_at" : "2023-06-21T20:00:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1601590517",
      "id" : 1601590517,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27927",
      "node_id" : "IC_kwDOABII585fdlT1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1601590517/reactions"
      },
      "updated_at" : "2023-06-21T20:00:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1601590517",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> `I think it's not ideal that ByteSpanCast is using UCharCast cast internally. Now code is using std::byte, I think would be good to drop the UCharCast function and replace it with a similar function that accepts char, unsigned char and std::byte pointers, but returns a std::byte pointer rather than an unsigned char pointer. Doing this would remove an unnecessary series of casts from byte to char and back to byte again in ByteSpanCast, and also just generally move code further in the direction of using std::byte over char`\r\n\r\nI thought about this, but concluded it isn't worth it. `UCharCast` won't be going away, because it is needed to speak with libbitcoinconsensus or libsecp256k1, see for example the conflicting pull. So adding the same 8 function to only differ in return type seems bloaty and verbose. However, I agree with you that new code shouldn't use `UCharCast` unless necessary.\r\n\r\n> `I think it might be good to refuse the serialize Span<char> and Span<unsigned char> arguments, and only serialize Span<std::byte> arguments as fixed size blobs. Again it would push code more in direction of using std::byte over char for binary data. It could also perhaps avoid cases where someone is trying to serialize a variable sized string and ends up through some misunderstood conversions accidentally serializing a fixed size span.`\r\n\r\n\r\nThis may be a bit too much hand-holding, with a small benefit. Also, it would make code more bloaty, as there are quite a few cases in the current code base where a `std::string(_view)` is serialized via `Span<char>`, or a view on `unsigned char` is serialized via `Span<unsigned char>`.\r\n\r\nAlso, `Span<B>` could be used internally to serialize byte-holding (pre)vectors. In fact this is likely a performance bug-fix, because currently, serialization accepts `std::vector<B>` for `B=signed char`, or `B=int8_t`. (`B=char` is deleted). However, serialization seems to only apply the optimization to only call `write` once for `B=unsigned char`. See https://github.com/bitcoin/bitcoin/blob/f1b4975461364d5d40d2bfafc6b165dd5d7eec30/src/serialize.h#L651\r\nIt may be good to treat all byte-like types the same, which can be achieved with `Span<B>`, or alternatively also delete the other `B`-types that are not special-cased, or alternatively delete the special-case code to treat all vectors the same.\r\n\r\n> `I think it would be good to drop the AsBytePtr function, which looks like a safe conversion but actually can cast any pointer to a byte pointer, is not actually safe or useful to call on most object types. I think if suggestion 1 above is implemented, some uses of AsBytePtr would no longer be necessary, and the other uses would be clearer if they just used reinterpret_cast directly instead of AsBytePtr`\r\n\r\nI don't think this is possible either. It is required to speak with libsqlite3, libbdb, and internally in serialize.h. I think we should instead think about nuking the `AsBytes` span helpers. While they are ported from the standard library, I don't think they are appropriate for us, because they are likely architecture dependent when it comes to endian-ness. ",
      "created_at" : "2023-06-22T08:07:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1602200826",
      "id" : 1602200826,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27927",
      "node_id" : "IC_kwDOABII585ff6T6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1602200826/reactions"
      },
      "updated_at" : "2023-06-22T08:07:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1602200826",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased on https://github.com/bitcoin/bitcoin/pull/27973 for now, please review that first.",
      "created_at" : "2023-06-26T09:19:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1607060383",
      "id" : 1607060383,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27927",
      "node_id" : "IC_kwDOABII585fycuf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1607060383/reactions"
      },
      "updated_at" : "2023-06-26T09:19:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1607060383",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-06-26T22:59:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1608429650",
      "id" : 1608429650,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27927",
      "node_id" : "IC_kwDOABII585f3rBS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1608429650/reactions"
      },
      "updated_at" : "2023-06-26T22:59:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1608429650",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Did a rebase on clean master to drop the unneeded dependency.",
      "created_at" : "2023-06-27T09:30:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1609131921",
      "id" : 1609131921,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27927",
      "node_id" : "IC_kwDOABII585f6WeR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1609131921/reactions"
      },
      "updated_at" : "2023-06-27T09:30:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1609131921",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Fix that by introducing a helper to convert any byte-like span to a std::byte-span, which is then accepted by serialization.\r\n\r\nCan drop this line from PR description (https://github.com/bitcoin/bitcoin/pull/27927#issue-1767744286)",
      "created_at" : "2023-06-27T14:42:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1609650746",
      "id" : 1609650746,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27927",
      "node_id" : "IC_kwDOABII585f8VI6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1609650746/reactions"
      },
      "updated_at" : "2023-06-27T14:42:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1609650746",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1602200826\r\n\r\nThanks for the responses. You convinced me there probably little benefit to preventing serialization of char spans, and it would just add boilerplate and not make things safer.\r\n\r\nI do think we can drop the AsBytePtr function, though, so I tried to do that in #27978.\r\n\r\nI also still think in the longer run it would be good to convert more internal code to use `std::byte` instead of `unsigned char` and replace `UCharCast` with a `ByteCast` alternative and `MakeUCharSpan` with a safer `MakeUCharSpan` alternative. If code calling leveldb or libsecp needs uchar functions, it implement them locally, or we could keep existing functions, but implement them in terms of `ByteCast`. Not suggesting to do this now. I just think we might end up doing it when more code uses `std::byte`.",
      "created_at" : "2023-06-27T15:18:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1609727952",
      "id" : 1609727952,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27927",
      "node_id" : "IC_kwDOABII585f8n_Q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1609727952/reactions"
      },
      "updated_at" : "2023-06-27T15:19:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1609727952",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK fa38d862358b87219b12bf31236c52f28d9fc5d6\r\n\r\nI do wonder: is there any reason why we wouldn't want to support serializing `Span`s in general (where its serialization is defined as the concatenation of the serialization of its elements)? ",
      "created_at" : "2023-06-27T15:45:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1609784685",
      "id" : 1609784685,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27927",
      "node_id" : "IC_kwDOABII585f811t",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1609784685/reactions"
      },
      "updated_at" : "2023-06-27T15:45:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1609784685",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I do wonder: is there any reason why we wouldn't want to support serializing Spans in general (where its serialization is defined as the concatenation of the serialization of its elements)?\r\n\r\nI think that should be fine to add, once there is a use case. Or is there already one?",
      "created_at" : "2023-06-27T15:54:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1609799341",
      "id" : 1609799341,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27927",
      "node_id" : "IC_kwDOABII585f85at",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1609799341/reactions"
      },
      "updated_at" : "2023-06-27T15:54:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1609799341",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK fa38d862358b87219b12bf31236c52f28d9fc5d6",
      "created_at" : "2023-06-28T19:01:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27927#issuecomment-1611928229",
      "id" : 1611928229,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27927",
      "node_id" : "IC_kwDOABII585gFBKl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1611928229/reactions"
      },
      "updated_at" : "2023-06-28T19:01:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1611928229",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
