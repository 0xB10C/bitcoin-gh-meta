[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24363#discussion_r808710482"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24363"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/808710482"
         }
      },
      "author_association" : "MEMBER",
      "body" : "any need for this condition?",
      "commit_id" : "c72462eecdecf606f5bc5f7f90b7f732f404607b",
      "created_at" : "2022-02-17T06:25:28Z",
      "diff_hunk" : "@@ -13,7 +13,13 @@ for b_name in {\"${BASE_OUTDIR}/bin\"/*,src/secp256k1/*tests,src/minisketch/test{,\n         echo \"Wrap $b ...\"\n         mv \"$b\" \"${b}_orig\"\n         echo '#!/usr/bin/env bash' > \"$b\"\n-        echo \"( wine \\\"${b}_orig\\\" \\\"\\$@\\\" ) || ( sleep 1 && wine \\\"${b}_orig\\\" \\\"\\$@\\\" )\" >> \"$b\"\n+        if test \"$(basename \"$b\")\" = \"test_bitcoin.exe\"; then",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24363#discussion_r808710482",
      "id" : 808710482,
      "line" : 16,
      "node_id" : "PRRC_kwDOABII584wM_FS",
      "original_commit_id" : "c72462eecdecf606f5bc5f7f90b7f732f404607b",
      "original_line" : 16,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "ci/test/wrap-wine.sh",
      "position" : 5,
      "pull_request_review_id" : 885488526,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24363",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/808710482/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-17T06:25:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/808710482",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24363#discussion_r808714045"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24363"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/808714045"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes. Without it python tests in test/util got crazy. Did not investigate further though. ",
      "commit_id" : "c72462eecdecf606f5bc5f7f90b7f732f404607b",
      "created_at" : "2022-02-17T06:33:22Z",
      "diff_hunk" : "@@ -13,7 +13,13 @@ for b_name in {\"${BASE_OUTDIR}/bin\"/*,src/secp256k1/*tests,src/minisketch/test{,\n         echo \"Wrap $b ...\"\n         mv \"$b\" \"${b}_orig\"\n         echo '#!/usr/bin/env bash' > \"$b\"\n-        echo \"( wine \\\"${b}_orig\\\" \\\"\\$@\\\" ) || ( sleep 1 && wine \\\"${b}_orig\\\" \\\"\\$@\\\" )\" >> \"$b\"\n+        if test \"$(basename \"$b\")\" = \"test_bitcoin.exe\"; then",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24363#discussion_r808714045",
      "id" : 808714045,
      "in_reply_to_id" : 808710482,
      "line" : 16,
      "node_id" : "PRRC_kwDOABII584wM_89",
      "original_commit_id" : "c72462eecdecf606f5bc5f7f90b7f732f404607b",
      "original_line" : 16,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "ci/test/wrap-wine.sh",
      "position" : 5,
      "pull_request_review_id" : 885493329,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24363",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/808714045/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-17T06:33:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/808714045",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24363#discussion_r810149674"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24363"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/810149674"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"ci: Catch assertion error message into logs for test_bitcoin.exe\" (c72462eecdecf606f5bc5f7f90b7f732f404607b)\r\n\r\nOne problem with using _script_ here is that it combines stdout and stderr into the same stream. This works for how we call test_bitcoin, but not surprising it would be broken for other binaries.\r\n\r\nProbably it would be more ideal to fix this by using _script_ in `src/Makefile.test.include` instead of the less reliable `> $<.log 2>&1 || (cat $<.log && false)` which could cause buffered output to be lost on other platforms, not just windows. If _script_ were used there, the changes here could be reverted.",
      "commit_id" : "c72462eecdecf606f5bc5f7f90b7f732f404607b",
      "created_at" : "2022-02-18T16:21:31Z",
      "diff_hunk" : "@@ -13,7 +13,13 @@ for b_name in {\"${BASE_OUTDIR}/bin\"/*,src/secp256k1/*tests,src/minisketch/test{,\n         echo \"Wrap $b ...\"\n         mv \"$b\" \"${b}_orig\"\n         echo '#!/usr/bin/env bash' > \"$b\"\n-        echo \"( wine \\\"${b}_orig\\\" \\\"\\$@\\\" ) || ( sleep 1 && wine \\\"${b}_orig\\\" \\\"\\$@\\\" )\" >> \"$b\"\n+        if test \"$(basename \"$b\")\" = \"test_bitcoin.exe\"; then",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24363#discussion_r810149674",
      "id" : 810149674,
      "in_reply_to_id" : 808710482,
      "line" : 16,
      "node_id" : "PRRC_kwDOABII584wSecq",
      "original_commit_id" : "c72462eecdecf606f5bc5f7f90b7f732f404607b",
      "original_line" : 16,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "ci/test/wrap-wine.sh",
      "position" : 5,
      "pull_request_review_id" : 887491082,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24363",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/810149674/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-18T16:47:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/810149674",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24363#discussion_r810169119"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24363"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/810169119"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"ci: Catch assertion error message into logs for test_bitcoin.exe\" (c72462eecdecf606f5bc5f7f90b7f732f404607b)\r\n\r\nIf arguments contain whitespace or shell characters they won't be escaped here correctly. It's probably not important to fix this, but you could probably do with with \r\n\r\n```bash\r\necho \"COMMAND=\\\"wine ${b}_orig\\$(printf \\\" %q\\\" \\\"\\$@\\\")\\\"\" >> \"$b\"\r\n```\r\n\r\nBut still better would be to follow earlier comment and revert this\r\n",
      "commit_id" : "c72462eecdecf606f5bc5f7f90b7f732f404607b",
      "created_at" : "2022-02-18T16:45:06Z",
      "diff_hunk" : "@@ -13,7 +13,13 @@ for b_name in {\"${BASE_OUTDIR}/bin\"/*,src/secp256k1/*tests,src/minisketch/test{,\n         echo \"Wrap $b ...\"\n         mv \"$b\" \"${b}_orig\"\n         echo '#!/usr/bin/env bash' > \"$b\"\n-        echo \"( wine \\\"${b}_orig\\\" \\\"\\$@\\\" ) || ( sleep 1 && wine \\\"${b}_orig\\\" \\\"\\$@\\\" )\" >> \"$b\"\n+        if test \"$(basename \"$b\")\" = \"test_bitcoin.exe\"; then\n+          # Using `script` allows to catch assertion error messages into logs.\n+          echo \"COMMAND=\\\"wine ${b}_orig \\$@\\\"\" >> \"$b\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24363#discussion_r810169119",
      "id" : 810169119,
      "line" : 18,
      "node_id" : "PRRC_kwDOABII584wSjMf",
      "original_commit_id" : "c72462eecdecf606f5bc5f7f90b7f732f404607b",
      "original_line" : 18,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "ci/test/wrap-wine.sh",
      "position" : 7,
      "pull_request_review_id" : 887491082,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24363",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/810169119/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-18T16:47:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/810169119",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
