[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [MarcoFalke](https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1646016856), [achow101](https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1654108231) |\n| Concept ACK | [dergoegge](https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591381981) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26573](https://github.com/bitcoin/bitcoin/pull/26573) (Wallet: don't underestimate the fees when spending a Taproot output by darosior)\n* [#26567](https://github.com/bitcoin/bitcoin/pull/26567) (Wallet: estimate the size of signed inputs using descriptors by darosior)\n* [#22838](https://github.com/bitcoin/bitcoin/pull/22838) (descriptors: Be able to specify change and receiving in a single descriptor string by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-06-14T13:13:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591186541",
      "id" : 1591186541,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585e15Rt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591186541/reactions"
      },
      "updated_at" : "2023-07-27T17:47:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591186541",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Looks like this touches non-fuzz code? No opinion if people want this, but a much simpler implementation would be to just create a copy of the buffer and inject the pre-generated static string into it. (This is basically what a fuzz engine does automatically, with the difference that you can now provide the string dictionary yourself, directly in the fuzz target).\r\n\r\nthe fuzz target would look like:\r\n\r\n```cpp\r\nauto str{fdp.ConsumeString()};\r\nif (fdp.ConsumeBool()) {\r\n  str = MockDescriptor(str);\r\n}\r\nconst auto desc = Parse(str);\r\n```\r\n\r\nWith `MockDescriptor` doing a search of `pk(xx)` and then replacing it with `pk(yy)`, where `yy=raw_pubkeys[int(xx) % raw_pubkeys.size()]` (already hex encoded).\r\n\r\nThis has the benefits of not mocking out the parsing logic, which for `GetXOnlyPubKey` is actually worthy to fuzz? Also, it allows to print the fuzz input, if needed, and use it over RPC for debugging. Finally, it doesn't touch real code, only test code.",
      "created_at" : "2023-06-14T14:09:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591285878",
      "id" : 1591285878,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585e2Rh2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591285878/reactions"
      },
      "updated_at" : "2023-06-14T14:09:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591285878",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "In what you suggest `MockDescriptor`Â would basically have to reimplement all of the descriptor parsing logic to be able to detect when is a key expected and replace the hex-encoded byte by an actual key. I figured the slight modification to the descriptor code to make key parsing mockable was preferable. (Note that's what we have already in Miniscript which allows us to have an efficient `miniscript_string` fuzz target.)\r\n\r\nTo be clear this is not only about mocking `pk()` expressions but anywhere we'd expect a key.",
      "created_at" : "2023-06-14T14:20:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591314299",
      "id" : 1591314299,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585e2Yd7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591314299/reactions"
      },
      "updated_at" : "2023-06-14T14:21:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591314299",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ok, I see. I guess another alternative would be to randomly inject random pre-generated keys at random positions in the string, absent of any logic. Then let the fuzz engine figure out the right positions via coverage feedback.\r\n\r\nNo strong opinion, just leaving random ideas that can be implemented with less code.",
      "created_at" : "2023-06-14T14:49:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591379997",
      "id" : 1591379997,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585e2ogd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591379997/reactions"
      },
      "updated_at" : "2023-06-14T14:49:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591379997",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK\r\n\r\nMocking seems fine to me, but I wonder if we could achieve something similar by placing (in)valid encoded keys in a fuzz dictionary (e.g. https://github.com/bitcoin-core/qa-assets/pull/122), which is also almost the same as Marco's suggestion. This would be less efficient compared to what is in this PR but the inputs would still be available for debugging over RPC. We can of course also just do both since adding to the dictionaries is very easy.",
      "created_at" : "2023-06-14T14:50:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591381981",
      "id" : 1591381981,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585e2o_d",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591381981/reactions"
      },
      "updated_at" : "2023-06-14T14:50:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591381981",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8077169?v=4",
         "events_url" : "https://api.github.com/users/dergoegge/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dergoegge/followers",
         "following_url" : "https://api.github.com/users/dergoegge/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dergoegge/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dergoegge",
         "id" : 8077169,
         "login" : "dergoegge",
         "node_id" : "MDQ6VXNlcjgwNzcxNjk=",
         "organizations_url" : "https://api.github.com/users/dergoegge/orgs",
         "received_events_url" : "https://api.github.com/users/dergoegge/received_events",
         "repos_url" : "https://api.github.com/users/dergoegge/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dergoegge/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dergoegge/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dergoegge"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks both for throwing in ideas. Note i don't have strong opinions here either, it's just some review code that i figured could be helpful having in too. However i still don't think the approaches suggested here would be better:\r\n- Inserting valid keys at random positions in the input. I'm assuming you describe something that looks like 1) get the number of keys from the fuzzer output 2) get the positions to insert each at from the fuzzer output. I may be underestimating the fuzzer's capabilities but it sounds much less efficient.\r\n- Including valid keys in a dictionary. Again, i'm not very familiar with the inernals of fuzzing engines but i suspect this would make the fuzzer grind the key with virtually no chance of finding another valid one, wasting a lot of cycles.\r\n- I don't think keeping the raw seed human readable for debugging over RPC should generally be a goal, especially not at the expense of efficiency. To get something readable you can simply run `./src/test/fuzz/fuzz ./crash-XXXXX` with a `ToString()` printed to stdout.",
      "created_at" : "2023-06-14T15:16:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591450310",
      "id" : 1591450310,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585e25rG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591450310/reactions"
      },
      "updated_at" : "2023-06-14T15:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591450310",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Another alternative may be to just perform search-replace in the fuzz-read string before handing it to the parser? Eg anything of the form \"%XX\" where XX is two hex characters, is replaced by a lookup in a table.",
      "created_at" : "2023-06-14T15:19:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591459495",
      "id" : 1591459495,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585e276n",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591459495/reactions"
      },
      "updated_at" : "2023-06-14T15:19:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591459495",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Hmm good point. Using a distinguishable character fixes the issue of having to \"basically reimplement descriptor parsing logic\".\n------- Original Message -------\nOn Wednesday, June 14th, 2023 at 5:19 PM, Pieter Wuille ***@***.***> wrote:\n\n> Another alternative may be to just perform search-replace in the fuzz-read string before handing it to the parser? Eg anything of the form \"%XX\" where XX is two hex characters, is replaced by a lookup in a table.\n>\n> â\n> Reply to this email directly, [view it on GitHub](https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591459495), or [unsubscribe](https://github.com/notifications/unsubscribe-auth/AFLK3F3PYOENOE2ZPE75HITXLHI7ZANCNFSM6AAAAAAZGLFYQU).\n> You are receiving this because you authored the thread.Message ID: ***@***.***>",
      "created_at" : "2023-06-14T15:21:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591465134",
      "id" : 1591465134,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585e29Su",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591465134/reactions"
      },
      "updated_at" : "2023-06-14T15:21:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591465134",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I may be underestimating the fuzzer's capabilities but it sounds much less efficient.\r\n\r\nI am happy to run a bench, if you happen to have a bug laying around :)",
      "created_at" : "2023-06-14T15:31:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591485898",
      "id" : 1591485898,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585e3CXK",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591485898/reactions"
      },
      "updated_at" : "2023-06-14T15:31:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591485898",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I don't, but i think Pieter settled the debate anyways. :)\n------- Original Message -------\nOn Wednesday, June 14th, 2023 at 5:31 PM, MacrabFalke ***@***.***> wrote:\n\n>> I may be underestimating the fuzzer's capabilities but it sounds much less efficient.\n>\n> I am happy to run a bench, if you happen to have a crash+bug laying around :)\n>\n> â\n> Reply to this email directly, [view it on GitHub](https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591485898), or [unsubscribe](https://github.com/notifications/unsubscribe-auth/AFLK3F75QKRNVW44OITSYKLXLHKO5ANCNFSM6AAAAAAZGLFYQU).\n> You are receiving this because you authored the thread.Message ID: ***@***.***>",
      "created_at" : "2023-06-14T15:35:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1591491404",
      "id" : 1591491404,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585e3DtM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591491404/reactions"
      },
      "updated_at" : "2023-06-14T15:35:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1591491404",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated following @sipa's suggestion of using a marker to be able to search and replace in the descriptor string directly.\r\n\r\nThe diff is now twice smaller, and this does not touch the descriptor parsing logic anymore. After running the new `mocked_descriptor_parse` target for half a hour on my laptop i get more branch coverage for `descriptor.cpp` than with the existing corpus for `descriptor_parse`.\r\n\r\n#### [ `descriptor_parse`](http://download.darosior.ninja/dump/desc_coverage_not_mocked/src/script/index.html)\r\n![image](https://github.com/bitcoin/bitcoin/assets/22457751/0829ab07-2151-4489-8381-39d78ad827f0)\r\n\r\n####  [`mocked_descriptor_parse`](http://download.darosior.ninja/dump/desc_coverage_mocked/src/script/index.html)\r\n![image](https://github.com/bitcoin/bitcoin/assets/22457751/f8b586b8-1b5d-469d-87f4-e577df2fb930)\r\n",
      "created_at" : "2023-06-15T14:42:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1593201932",
      "id" : 1593201932,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585e9lUM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1593201932/reactions"
      },
      "updated_at" : "2023-06-15T15:16:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1593201932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1231322655"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1231322655"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In 845810d94df83747634a60ff59635a670bba1124 \"fuzz: add a new, more efficient, descriptor parsing target\"\r\n\r\nPerhaps also include uncompressed keys?",
      "commit_id" : "fad60fc6f6486d3b28de4bbe937e293f65d5cbd5",
      "created_at" : "2023-06-15T17:08:30Z",
      "diff_hunk" : "@@ -3,11 +3,109 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{5};\n+//! How many keys we'll generate in total.\n+static constexpr uint8_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max()};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (uint8_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1231322655",
      "id" : 1231322655,
      "line" : 48,
      "node_id" : "PRRC_kwDOABII585JZH4f",
      "original_commit_id" : "845810d94df83747634a60ff59635a670bba1124",
      "original_line" : 48,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : 46,
      "pull_request_review_id" : 1482059834,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1231322655/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-15T17:12:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1231322655",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1231966560"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1231966560"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good call, done.",
      "commit_id" : "fad60fc6f6486d3b28de4bbe937e293f65d5cbd5",
      "created_at" : "2023-06-16T08:43:54Z",
      "diff_hunk" : "@@ -3,11 +3,109 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{5};\n+//! How many keys we'll generate in total.\n+static constexpr uint8_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max()};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (uint8_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1231966560",
      "id" : 1231966560,
      "in_reply_to_id" : 1231322655,
      "line" : 48,
      "node_id" : "PRRC_kwDOABII585JblFg",
      "original_commit_id" : "845810d94df83747634a60ff59635a670bba1124",
      "original_line" : 48,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : 46,
      "pull_request_review_id" : 1483016214,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1231966560/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-16T08:43:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1231966560",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1232532164"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1232532164"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In fad60fc6f6486d3b28de4bbe937e293f65d5cbd5 \"fuzz: increase coverage of the descriptor targets\"\r\n\r\nThe second argument of `Set` is the compressedness, so this can be simplified a bit:\r\n\r\n```suggestion\r\n                privkey.Set(key_data, key_data + 32, IdIsCompPubKey(i));\r\n                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\r\n                    CPubKey pubkey{privkey.GetPubKey()};\r\n                    keys_str[i] = HexStr(pubkey);\r\n```",
      "commit_id" : "fad60fc6f6486d3b28de4bbe937e293f65d5cbd5",
      "created_at" : "2023-06-16T17:22:43Z",
      "diff_hunk" : "@@ -3,11 +3,111 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr uint8_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max()};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (uint8_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, true);\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    if (IdIsUnCompPubKey(i)) assert(pubkey.Decompress());\n+                    keys_str[i] = HexStr(pubkey);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1232532164",
      "id" : 1232532164,
      "line" : 52,
      "node_id" : "PRRC_kwDOABII585JdvLE",
      "original_commit_id" : "bf1d242e44b25cecb9fc25fca4c16c4ab56d5841",
      "original_line" : 52,
      "original_position" : 50,
      "original_start_line" : 48,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : 50,
      "pull_request_review_id" : 1483996768,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1232532164/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 48,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-06-16T17:22:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1232532164",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1233270597"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1233270597"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.\r\n```patch\r\ndiff --git a/src/test/fuzz/descriptor_parse.cpp b/src/test/fuzz/descriptor_parse.cpp\r\nindex 9a7b6ea308..529dadadc1 100644\r\n--- a/src/test/fuzz/descriptor_parse.cpp\r\n+++ b/src/test/fuzz/descriptor_parse.cpp\r\n@@ -45,10 +45,9 @@ public:\r\n             // an extended one.\r\n             if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\r\n                 CKey privkey;\r\n-                privkey.Set(key_data, key_data + 32, true);\r\n+                privkey.Set(key_data, key_data + 32, !IdIsUnCompPubKey(i));\r\n                 if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\r\n                     CPubKey pubkey{privkey.GetPubKey()};\r\n-                    if (IdIsUnCompPubKey(i)) assert(pubkey.Decompress());\r\n                     keys_str[i] = HexStr(pubkey);\r\n                 } else if (IdIsXOnlyPubKey(i)) {\r\n                     const XOnlyPubKey pubkey{privkey.GetPubKey()};\r\n```",
      "commit_id" : "b23c2e2639bb1676238e0cbd0fbd2f8bd8693380",
      "created_at" : "2023-06-18T12:16:46Z",
      "diff_hunk" : "@@ -3,11 +3,111 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr uint8_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max()};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (uint8_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, true);\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    if (IdIsUnCompPubKey(i)) assert(pubkey.Decompress());\n+                    keys_str[i] = HexStr(pubkey);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1233270597",
      "id" : 1233270597,
      "in_reply_to_id" : 1232532164,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585JgjdF",
      "original_commit_id" : "bf1d242e44b25cecb9fc25fca4c16c4ab56d5841",
      "original_line" : 51,
      "original_position" : 50,
      "original_start_line" : 48,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : null,
      "pull_request_review_id" : 1485063609,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1233270597/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-06-18T12:16:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1233270597",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Suggest putting \"Fuzz\" in title, and labelling.",
      "created_at" : "2023-06-24T14:11:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1605526732",
      "id" : 1605526732,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585fsmTM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1605526732/reactions"
      },
      "updated_at" : "2023-06-24T14:11:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1605526732",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-07-17T13:00:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1638096203",
      "id" : 1638096203,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585ho11L",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1638096203/reactions"
      },
      "updated_at" : "2023-07-17T13:00:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1638096203",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "For testing I've injected a bug in currently uncovered code:\r\n\r\n\r\n```diff\r\ndiff --git a/src/script/descriptor.cpp b/src/script/descriptor.cpp\r\nindex 09ded5fc61..b69db182ab 100644\r\n--- a/src/script/descriptor.cpp\r\n+++ b/src/script/descriptor.cpp\r\n@@ -509,7 +509,7 @@ public:\r\n         out = \"[\" + origin_str + \"]\" + EncodeExtPubKey(xpub) + FormatHDKeypath(end_path);\r\n         if (IsRange()) {\r\n             out += \"/*\";\r\n-            assert(m_derive == DeriveType::UNHARDENED);\r\n+            assert(m_derive != DeriveType::UNHARDENED); // Injected BUG!! (bad)\r\n         }\r\n         return true;\r\n     }\r\n```\r\n\r\n...\r\n\r\nBut it looks like the fuzz target just crashed immediately anyway (see CI)\r\n",
      "created_at" : "2023-07-21T10:42:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1645380531",
      "id" : 1645380531,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585iEoOz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1645380531/reactions"
      },
      "updated_at" : "2023-07-21T10:42:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1645380531",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for testing. Fixed the issue. I also introduced the bug you shared and it does make the target crash.",
      "created_at" : "2023-07-21T12:44:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1645525854",
      "id" : 1645525854,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585iFLte",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1645525854/reactions"
      },
      "updated_at" : "2023-07-21T12:44:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1645525854",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Did quick check to see how many iterations it would take to find my injected bug with libfuzzer:\r\n\r\n* `-use_value_profile=1`:\r\n![pull_uvp1](https://github.com/bitcoin/bitcoin/assets/6399679/1e213972-8ac3-4c87-8dde-fa89411cfd71)\r\n\r\n* `-use_value_profile=0`:\r\n![pull_uvp0](https://github.com/bitcoin/bitcoin/assets/6399679/11c74a2f-107f-4f48-bbc9-a2b72025e91d)\r\n",
      "created_at" : "2023-07-21T16:44:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1645976254",
      "id" : 1645976254,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585iG5q-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1645976254/reactions"
      },
      "updated_at" : "2023-07-21T17:00:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1645976254",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270890988"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270890988"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: If you make `key_data` `std::byte`, you can avoid the c-style cast:\r\n\r\n\r\n```diff\r\ndiff --git a/src/test/fuzz/descriptor_parse.cpp b/src/test/fuzz/descriptor_parse.cpp\r\nindex 1d2b672260..84dc005575 100644\r\n--- a/src/test/fuzz/descriptor_parse.cpp\r\n+++ b/src/test/fuzz/descriptor_parse.cpp\r\n@@ -36,16 +36,16 @@ public:\r\n     //! When initializing the target, populate the list of keys.\r\n     void Init() {\r\n         // The data to use as a private key or a seed for an xprv.\r\n-        uint8_t key_data[32] = {1};\r\n+        std::array<std::byte, 32> key_data{std::byte{1}};\r\n         // Generate keys of all kinds and store them in the keys array.\r\n         for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\r\n-            key_data[31] = i;\r\n+            key_data[31] = std::byte(i);\r\n \r\n             // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\r\n             // an extended one.\r\n             if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\r\n                 CKey privkey;\r\n-                privkey.Set(key_data, key_data + 32, !IdIsUnCompPubKey(i));\r\n+                privkey.Set(UCharCast(key_data.begin()), UCharCast(key_data.end()), !IdIsUnCompPubKey(i));\r\n                 if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\r\n                     CPubKey pubkey{privkey.GetPubKey()};\r\n                     keys_str[i] = HexStr(pubkey);\r\n@@ -57,7 +57,7 @@ public:\r\n                 }\r\n             } else {\r\n                 CExtKey ext_privkey;\r\n-                ext_privkey.SetSeed({(std::byte *)key_data, 32});\r\n+                ext_privkey.SetSeed(key_data);\r\n                 if (IdIsXprv(i)) {\r\n                     keys_str[i] = EncodeExtKey(ext_privkey);\r\n                 } else {\r\n",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-21T16:55:22Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed({(std::byte *)key_data, 32});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270890988",
      "id" : 1270890988,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LwEHs",
      "original_commit_id" : "84dee4fe690e08a5adaad1c78530666da07075d8",
      "original_line" : 60,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : null,
      "pull_request_review_id" : 1541508735,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270890988/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-21T17:00:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270890988",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270892632"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270892632"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        // The actual, descriptor string to be returned.\r\n```\r\n\r\npretty sure it is not valid",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-21T16:57:27Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed({(std::byte *)key_data, 32});\n+                if (IdIsXprv(i)) {\n+                    keys_str[i] = EncodeExtKey(ext_privkey);\n+                } else {\n+                    const CExtPubKey ext_pubkey{ext_privkey.Neuter()};\n+                    keys_str[i] = EncodeExtPubKey(ext_pubkey);\n+                }\n+            }\n+        }\n+    }\n+\n+    //! Parse an id in the keys vectors from a 2-characters hex string.\n+    std::optional<uint8_t> IdxFromHex(std::string_view hex_characters) const {\n+        if (hex_characters.size() != 2) return {};\n+        auto idx = ParseHex(hex_characters);\n+        if (idx.size() != 1) return {};\n+        return idx[0];\n+    }\n+\n+    //! Get a valid descriptor string from a descriptor string whose keys were mocked.\n+    std::optional<std::string> GetDescriptor(std::string_view mocked_desc) const {\n+        // The smallest fragment would be \"pk(%00)\"\n+        if (mocked_desc.size() < 7) return {};\n+\n+        // The actual, valid, descriptor string to be returned.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270892632",
      "id" : 1270892632,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LwEhY",
      "original_commit_id" : "84dee4fe690e08a5adaad1c78530666da07075d8",
      "original_line" : 84,
      "original_position" : 82,
      "original_start_line" : null,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : null,
      "pull_request_review_id" : 1541508735,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270892632/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-21T17:00:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270892632",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270901466"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270901466"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's not avoiding them, it's hiding them behind `UCharCast`? :p \r\n\r\nIt boils down to choosing between casting to `uint8_t` or to `std::byte`, and i went for the option with less casts.",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-21T17:07:13Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed({(std::byte *)key_data, 32});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270901466",
      "id" : 1270901466,
      "in_reply_to_id" : 1270890988,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LwGra",
      "original_commit_id" : "84dee4fe690e08a5adaad1c78530666da07075d8",
      "original_line" : 60,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : null,
      "pull_request_review_id" : 1541525589,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270901466/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-21T17:07:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270901466",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270902655"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270902655"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done, thanks. (And also in the function's doc comment.)",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-21T17:08:45Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed({(std::byte *)key_data, 32});\n+                if (IdIsXprv(i)) {\n+                    keys_str[i] = EncodeExtKey(ext_privkey);\n+                } else {\n+                    const CExtPubKey ext_pubkey{ext_privkey.Neuter()};\n+                    keys_str[i] = EncodeExtPubKey(ext_pubkey);\n+                }\n+            }\n+        }\n+    }\n+\n+    //! Parse an id in the keys vectors from a 2-characters hex string.\n+    std::optional<uint8_t> IdxFromHex(std::string_view hex_characters) const {\n+        if (hex_characters.size() != 2) return {};\n+        auto idx = ParseHex(hex_characters);\n+        if (idx.size() != 1) return {};\n+        return idx[0];\n+    }\n+\n+    //! Get a valid descriptor string from a descriptor string whose keys were mocked.\n+    std::optional<std::string> GetDescriptor(std::string_view mocked_desc) const {\n+        // The smallest fragment would be \"pk(%00)\"\n+        if (mocked_desc.size() < 7) return {};\n+\n+        // The actual, valid, descriptor string to be returned.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270902655",
      "id" : 1270902655,
      "in_reply_to_id" : 1270892632,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LwG9_",
      "original_commit_id" : "84dee4fe690e08a5adaad1c78530666da07075d8",
      "original_line" : 84,
      "original_position" : 82,
      "original_start_line" : null,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : null,
      "pull_request_review_id" : 1541527480,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270902655/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-21T17:08:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270902655",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270903253"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270903253"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah this doesn't matter for the fuzz tests.\r\n\r\nI only left the comment, so that it would be easier if CKey::Set was changed to take `std::byte`, it would be a smaller diff in the future.",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-21T17:09:32Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed({(std::byte *)key_data, 32});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270903253",
      "id" : 1270903253,
      "in_reply_to_id" : 1270890988,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LwHHV",
      "original_commit_id" : "84dee4fe690e08a5adaad1c78530666da07075d8",
      "original_line" : 60,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : null,
      "pull_request_review_id" : 1541528403,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270903253/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-21T17:11:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270903253",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270904211"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270904211"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Happy to do it then.",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-21T17:10:41Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed({(std::byte *)key_data, 32});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270904211",
      "id" : 1270904211,
      "in_reply_to_id" : 1270890988,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LwHWT",
      "original_commit_id" : "84dee4fe690e08a5adaad1c78530666da07075d8",
      "original_line" : 60,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : null,
      "pull_request_review_id" : 1541529800,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270904211/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-21T17:10:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270904211",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270904366"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270904366"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done in the wrong commit, though? :sweat_smile: ",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-21T17:10:55Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed({(std::byte *)key_data, 32});\n+                if (IdIsXprv(i)) {\n+                    keys_str[i] = EncodeExtKey(ext_privkey);\n+                } else {\n+                    const CExtPubKey ext_pubkey{ext_privkey.Neuter()};\n+                    keys_str[i] = EncodeExtPubKey(ext_pubkey);\n+                }\n+            }\n+        }\n+    }\n+\n+    //! Parse an id in the keys vectors from a 2-characters hex string.\n+    std::optional<uint8_t> IdxFromHex(std::string_view hex_characters) const {\n+        if (hex_characters.size() != 2) return {};\n+        auto idx = ParseHex(hex_characters);\n+        if (idx.size() != 1) return {};\n+        return idx[0];\n+    }\n+\n+    //! Get a valid descriptor string from a descriptor string whose keys were mocked.\n+    std::optional<std::string> GetDescriptor(std::string_view mocked_desc) const {\n+        // The smallest fragment would be \"pk(%00)\"\n+        if (mocked_desc.size() < 7) return {};\n+\n+        // The actual, valid, descriptor string to be returned.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270904366",
      "id" : 1270904366,
      "in_reply_to_id" : 1270892632,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LwHYu",
      "original_commit_id" : "84dee4fe690e08a5adaad1c78530666da07075d8",
      "original_line" : 84,
      "original_position" : 82,
      "original_start_line" : null,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : null,
      "pull_request_review_id" : 1541530069,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270904366/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-21T17:10:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270904366",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270906119"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270906119"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done.\r\n\r\n(However i just checked and `UCharCast` does indeed use C-style casts)\r\nhttps://github.com/bitcoin/bitcoin/blob/d23fda05842ba4539b225bbab01b94df0060f697/src/span.h#L272\r\n\r\nEDIT: (Oh but the const version doesn't)\r\nhttps://github.com/bitcoin/bitcoin/blob/d23fda05842ba4539b225bbab01b94df0060f697/src/span.h#L275\r\n\r\nEDIT2: should call pastapastapasta to fix this mess",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-21T17:13:14Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed({(std::byte *)key_data, 32});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270906119",
      "id" : 1270906119,
      "in_reply_to_id" : 1270890988,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LwH0H",
      "original_commit_id" : "84dee4fe690e08a5adaad1c78530666da07075d8",
      "original_line" : 60,
      "original_position" : 58,
      "original_start_line" : null,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : null,
      "pull_request_review_id" : 1541532825,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 1,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270906119/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-21T17:17:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270906119",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270906387"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270906387"
         }
      },
      "author_association" : "MEMBER",
      "body" : ":facepalm: ",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-21T17:13:36Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed({(std::byte *)key_data, 32});\n+                if (IdIsXprv(i)) {\n+                    keys_str[i] = EncodeExtKey(ext_privkey);\n+                } else {\n+                    const CExtPubKey ext_pubkey{ext_privkey.Neuter()};\n+                    keys_str[i] = EncodeExtPubKey(ext_pubkey);\n+                }\n+            }\n+        }\n+    }\n+\n+    //! Parse an id in the keys vectors from a 2-characters hex string.\n+    std::optional<uint8_t> IdxFromHex(std::string_view hex_characters) const {\n+        if (hex_characters.size() != 2) return {};\n+        auto idx = ParseHex(hex_characters);\n+        if (idx.size() != 1) return {};\n+        return idx[0];\n+    }\n+\n+    //! Get a valid descriptor string from a descriptor string whose keys were mocked.\n+    std::optional<std::string> GetDescriptor(std::string_view mocked_desc) const {\n+        // The smallest fragment would be \"pk(%00)\"\n+        if (mocked_desc.size() < 7) return {};\n+\n+        // The actual, valid, descriptor string to be returned.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270906387",
      "id" : 1270906387,
      "in_reply_to_id" : 1270892632,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LwH4T",
      "original_commit_id" : "84dee4fe690e08a5adaad1c78530666da07075d8",
      "original_line" : 84,
      "original_position" : 82,
      "original_start_line" : null,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : null,
      "pull_request_review_id" : 1541533290,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270906387/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-21T17:13:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270906387",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270907877"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270907877"
         }
      },
      "author_association" : "MEMBER",
      "body" : "And i can't even blame it on anything but myself this time! Fixed.",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-21T17:15:33Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        uint8_t key_data[32] = {1};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = i;\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(key_data, key_data + 32, !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed({(std::byte *)key_data, 32});\n+                if (IdIsXprv(i)) {\n+                    keys_str[i] = EncodeExtKey(ext_privkey);\n+                } else {\n+                    const CExtPubKey ext_pubkey{ext_privkey.Neuter()};\n+                    keys_str[i] = EncodeExtPubKey(ext_pubkey);\n+                }\n+            }\n+        }\n+    }\n+\n+    //! Parse an id in the keys vectors from a 2-characters hex string.\n+    std::optional<uint8_t> IdxFromHex(std::string_view hex_characters) const {\n+        if (hex_characters.size() != 2) return {};\n+        auto idx = ParseHex(hex_characters);\n+        if (idx.size() != 1) return {};\n+        return idx[0];\n+    }\n+\n+    //! Get a valid descriptor string from a descriptor string whose keys were mocked.\n+    std::optional<std::string> GetDescriptor(std::string_view mocked_desc) const {\n+        // The smallest fragment would be \"pk(%00)\"\n+        if (mocked_desc.size() < 7) return {};\n+\n+        // The actual, valid, descriptor string to be returned.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1270907877",
      "id" : 1270907877,
      "in_reply_to_id" : 1270892632,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585LwIPl",
      "original_commit_id" : "84dee4fe690e08a5adaad1c78530666da07075d8",
      "original_line" : 84,
      "original_position" : 82,
      "original_start_line" : null,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : null,
      "pull_request_review_id" : 1541535645,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270907877/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-21T17:15:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1270907877",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "re-ACK 131314b62e899f95d1863083d303b489b3212b16  ð\r\n\r\n<details><summary>Show signature</summary>\r\n\r\nSignature:\r\n\r\n```\r\nuntrusted comment: signature from minisign secret key on empty file; verify via: minisign -Vm \"${path_to_any_empty_file}\" -P RWTRmVTMeKV5noAMqVlsMugDDCyyTSbA3Re5AkUrhvLVln0tSaFWglOw -x \"${path_to_this_whole_four_line_signature_blob}\"\r\nRUTRmVTMeKV5npGrKx1nqXCw5zeVHdtdYURB/KlyA/LMFgpNCs+SkW9a8N95d+U4AP1RJMi+krxU1A3Yux4bpwZNLvVBKy0wLgM=\r\ntrusted comment: re-ACK 131314b62e899f95d1863083d303b489b3212b16  ð\r\nPiOVYYPtzobuHwHpzUHpihKOhhWkacXf+ZxTpk/y7EwMzhRSE9kfEk+pz/XQl8QIUv2W4fuwNKvY2pFyASt8Bg==\r\n```\r\n\r\n</details>\r\n",
      "created_at" : "2023-07-21T17:18:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1646016856",
      "id" : 1646016856,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585iHDlY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1646016856/reactions"
      },
      "updated_at" : "2023-07-21T17:18:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1646016856",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-27T17:47:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1654108231",
      "id" : 1654108231,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27888",
      "node_id" : "IC_kwDOABII585il7BH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1654108231/reactions"
      },
      "updated_at" : "2023-07-27T17:47:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1654108231",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1277247979"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1277247979"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could just use the raw (single) byte here, but that would interfere with libFuzzer `-only_ascii=1`, which makes me wonder if this is the first ascii fuzz target and whether we should set the option somewhere somehow during input generation?",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-28T08:11:30Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        std::array<std::byte, 32> key_data{std::byte{1}};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = std::byte(i);\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(UCharCast(key_data.begin()), UCharCast(key_data.end()), !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed(key_data);\n+                if (IdIsXprv(i)) {\n+                    keys_str[i] = EncodeExtKey(ext_privkey);\n+                } else {\n+                    const CExtPubKey ext_pubkey{ext_privkey.Neuter()};\n+                    keys_str[i] = EncodeExtPubKey(ext_pubkey);\n+                }\n+            }\n+        }\n+    }\n+\n+    //! Parse an id in the keys vectors from a 2-characters hex string.\n+    std::optional<uint8_t> IdxFromHex(std::string_view hex_characters) const {\n+        if (hex_characters.size() != 2) return {};\n+        auto idx = ParseHex(hex_characters);\n+        if (idx.size() != 1) return {};\n+        return idx[0];\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1277247979",
      "id" : 1277247979,
      "line" : 77,
      "node_id" : "PRRC_kwDOABII585MIUHr",
      "original_commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "original_line" : 77,
      "original_position" : 75,
      "original_start_line" : 72,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : 75,
      "pull_request_review_id" : 1551590071,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1277247979/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 72,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-28T08:11:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1277247979",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1277370453"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1277370453"
         }
      },
      "author_association" : "MEMBER",
      "body" : "![Fuzz inputs until crash](https://github.com/bitcoin/bitcoin/assets/6399679/d8e5e3ca-f5be-45e0-8803-8f8950690624)\r\n\r\n\r\nFunny how `-only_ascii=1` performs worse than `-only_ascii=0` (https://github.com/bitcoin/bitcoin/pull/27888#issuecomment-1645976254).",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-28T10:14:48Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        std::array<std::byte, 32> key_data{std::byte{1}};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = std::byte(i);\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(UCharCast(key_data.begin()), UCharCast(key_data.end()), !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed(key_data);\n+                if (IdIsXprv(i)) {\n+                    keys_str[i] = EncodeExtKey(ext_privkey);\n+                } else {\n+                    const CExtPubKey ext_pubkey{ext_privkey.Neuter()};\n+                    keys_str[i] = EncodeExtPubKey(ext_pubkey);\n+                }\n+            }\n+        }\n+    }\n+\n+    //! Parse an id in the keys vectors from a 2-characters hex string.\n+    std::optional<uint8_t> IdxFromHex(std::string_view hex_characters) const {\n+        if (hex_characters.size() != 2) return {};\n+        auto idx = ParseHex(hex_characters);\n+        if (idx.size() != 1) return {};\n+        return idx[0];\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1277370453",
      "id" : 1277370453,
      "in_reply_to_id" : 1277247979,
      "line" : 77,
      "node_id" : "PRRC_kwDOABII585MIyBV",
      "original_commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "original_line" : 77,
      "original_position" : 75,
      "original_start_line" : 72,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : 75,
      "pull_request_review_id" : 1551788045,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1277370453/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 72,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-28T10:16:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1277370453",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1277371055"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1277371055"
         }
      },
      "author_association" : "MEMBER",
      "body" : "(or at least, not significantly better)",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-28T10:15:27Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        std::array<std::byte, 32> key_data{std::byte{1}};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = std::byte(i);\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(UCharCast(key_data.begin()), UCharCast(key_data.end()), !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed(key_data);\n+                if (IdIsXprv(i)) {\n+                    keys_str[i] = EncodeExtKey(ext_privkey);\n+                } else {\n+                    const CExtPubKey ext_pubkey{ext_privkey.Neuter()};\n+                    keys_str[i] = EncodeExtPubKey(ext_pubkey);\n+                }\n+            }\n+        }\n+    }\n+\n+    //! Parse an id in the keys vectors from a 2-characters hex string.\n+    std::optional<uint8_t> IdxFromHex(std::string_view hex_characters) const {\n+        if (hex_characters.size() != 2) return {};\n+        auto idx = ParseHex(hex_characters);\n+        if (idx.size() != 1) return {};\n+        return idx[0];\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1277371055",
      "id" : 1277371055,
      "in_reply_to_id" : 1277247979,
      "line" : 77,
      "node_id" : "PRRC_kwDOABII585MIyKv",
      "original_commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "original_line" : 77,
      "original_position" : 75,
      "original_start_line" : 72,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : 75,
      "pull_request_review_id" : 1551788979,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1277371055/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 72,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-28T10:15:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1277371055",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1277371969"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1277371969"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe the target returning early on non-ASCII has basically the same effect?",
      "commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "created_at" : "2023-07-28T10:16:39Z",
      "diff_hunk" : "@@ -3,28 +3,167 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <chainparams.h>\n+#include <key_io.h>\n #include <pubkey.h>\n #include <script/descriptor.h>\n #include <test/fuzz/fuzz.h>\n #include <util/chaintype.h>\n \n+//! Types are raw (un)compressed pubkeys, raw xonly pubkeys, raw privkeys (WIF), xpubs, xprvs.\n+static constexpr uint8_t KEY_TYPES_COUNT{6};\n+//! How many keys we'll generate in total.\n+static constexpr size_t TOTAL_KEYS_GENERATED{std::numeric_limits<uint8_t>::max() + 1};\n+\n+/**\n+ * Converts a mocked descriptor string to a valid one. Every key in a mocked descriptor key is\n+ * represented by 2 hex characters preceded by the '%' character. We parse the two hex characters\n+ * as an index in a list of pre-generated keys. This list contains keys of the various types\n+ * accepted in descriptor keys expressions.\n+ */\n+class MockedDescriptorConverter {\n+    //! 256 keys of various types.\n+    std::array<std::string, TOTAL_KEYS_GENERATED> keys_str;\n+\n+public:\n+    // We derive the type of key to generate from the 1-byte id parsed from hex.\n+    bool IdIsCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 0; }\n+    bool IdIsUnCompPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 1; }\n+    bool IdIsXOnlyPubKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 2; }\n+    bool IdIsConstPrivKey(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 3; }\n+    bool IdIsXpub(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 4; }\n+    bool IdIsXprv(uint8_t idx) const { return idx % KEY_TYPES_COUNT == 5; }\n+\n+    //! When initializing the target, populate the list of keys.\n+    void Init() {\n+        // The data to use as a private key or a seed for an xprv.\n+        std::array<std::byte, 32> key_data{std::byte{1}};\n+        // Generate keys of all kinds and store them in the keys array.\n+        for (size_t i{0}; i < TOTAL_KEYS_GENERATED; i++) {\n+            key_data[31] = std::byte(i);\n+\n+            // If this is a \"raw\" key, generate a normal privkey. Otherwise generate\n+            // an extended one.\n+            if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i) || IdIsXOnlyPubKey(i) || IdIsConstPrivKey(i)) {\n+                CKey privkey;\n+                privkey.Set(UCharCast(key_data.begin()), UCharCast(key_data.end()), !IdIsUnCompPubKey(i));\n+                if (IdIsCompPubKey(i) || IdIsUnCompPubKey(i)) {\n+                    CPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else if (IdIsXOnlyPubKey(i)) {\n+                    const XOnlyPubKey pubkey{privkey.GetPubKey()};\n+                    keys_str[i] = HexStr(pubkey);\n+                } else {\n+                    keys_str[i] = EncodeSecret(privkey);\n+                }\n+            } else {\n+                CExtKey ext_privkey;\n+                ext_privkey.SetSeed(key_data);\n+                if (IdIsXprv(i)) {\n+                    keys_str[i] = EncodeExtKey(ext_privkey);\n+                } else {\n+                    const CExtPubKey ext_pubkey{ext_privkey.Neuter()};\n+                    keys_str[i] = EncodeExtPubKey(ext_pubkey);\n+                }\n+            }\n+        }\n+    }\n+\n+    //! Parse an id in the keys vectors from a 2-characters hex string.\n+    std::optional<uint8_t> IdxFromHex(std::string_view hex_characters) const {\n+        if (hex_characters.size() != 2) return {};\n+        auto idx = ParseHex(hex_characters);\n+        if (idx.size() != 1) return {};\n+        return idx[0];\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27888#discussion_r1277371969",
      "id" : 1277371969,
      "in_reply_to_id" : 1277247979,
      "line" : 77,
      "node_id" : "PRRC_kwDOABII585MIyZB",
      "original_commit_id" : "131314b62e899f95d1863083d303b489b3212b16",
      "original_line" : 77,
      "original_position" : 75,
      "original_start_line" : 72,
      "path" : "src/test/fuzz/descriptor_parse.cpp",
      "position" : 75,
      "pull_request_review_id" : 1551790486,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27888",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1277371969/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 72,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-28T10:16:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1277371969",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22457751?v=4",
         "events_url" : "https://api.github.com/users/darosior/events{/privacy}",
         "followers_url" : "https://api.github.com/users/darosior/followers",
         "following_url" : "https://api.github.com/users/darosior/following{/other_user}",
         "gists_url" : "https://api.github.com/users/darosior/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/darosior",
         "id" : 22457751,
         "login" : "darosior",
         "node_id" : "MDQ6VXNlcjIyNDU3NzUx",
         "organizations_url" : "https://api.github.com/users/darosior/orgs",
         "received_events_url" : "https://api.github.com/users/darosior/received_events",
         "repos_url" : "https://api.github.com/users/darosior/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/darosior/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/darosior/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/darosior"
      }
   }
]
