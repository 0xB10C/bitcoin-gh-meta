[
   {
      "body" : "Concept ACK.\r\nCan you add a tool test for that?",
      "created_at" : "2017-07-19T08:15:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10871#issuecomment-316307749",
      "id" : 316307749,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10871",
      "updated_at" : "2017-07-19T08:15:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316307749",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "> Can you add a tool test for that?\r\n\r\nA simple tool-test like -tx's wont work here as it requires a running bitcoind.\r\nBetter to wait for bitcoin-cli testing infrastructure to be in place I guess (#10798)?",
      "created_at" : "2017-07-20T08:31:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10871#issuecomment-316634879",
      "id" : 316634879,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10871",
      "updated_at" : "2017-07-20T08:31:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316634879",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "rebased",
      "created_at" : "2017-08-15T21:39:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10871#issuecomment-322597386",
      "id" : 322597386,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10871",
      "updated_at" : "2017-08-15T21:39:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322597386",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "body" : "bad rebase:\r\n\r\n```\r\nbitcoin-cli.cpp: In function Ã¢ÂÂint CommandLineRPC(int, char**)Ã¢ÂÂ:\r\nbitcoin-cli.cpp:393:41: error: Ã¢ÂÂGetBoolArgÃ¢ÂÂ was not declared in this scope\r\n         if (GetBoolArg(\"-getinfo\", false)) {\r\n                                         ^\r\n```\r\n\r\n#10798 is now rebased and ready for merge. It should be fairly straightforward to rebase this on top of that to add a functional test.",
      "created_at" : "2017-08-15T22:05:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10871#issuecomment-322602965",
      "id" : 322602965,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10871",
      "updated_at" : "2017-08-15T22:05:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/322602965",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "Test here if you want it:  https://github.com/jnewbery/bitcoin/tree/pr10871_test\r\n\r\nBuilds on top of #10798. Test currently fails because the output for `bitcoin-cli getinfo` and `bitcoin-cli -getinfo` is different in `keypoolsize` and `unlocked_until`. See https://github.com/bitcoin/bitcoin/pull/8843#discussion_r127599074 for information about `keypoolsize` discrepancy.",
      "created_at" : "2017-08-23T18:32:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10871#issuecomment-324423353",
      "id" : 324423353,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10871",
      "updated_at" : "2017-08-23T18:32:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324423353",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "body" : "I think the docs should at least mention something about atomicity. Every other API to Bitcoin Core is atomic, so it feels very strange to add a new one which is not.",
      "created_at" : "2017-08-23T18:59:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10871#issuecomment-324431201",
      "id" : 324431201,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10871",
      "updated_at" : "2017-08-23T18:59:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324431201",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "> I think the docs should at least mention something about atomicity. Every other API to Bitcoin Core is atomic, so it feels very strange to add a new one which is not.\r\n\r\nI know you don't like this particular changej, but this is reaching FUD levels here, what *exactly* are you concerned about happening here? `-getinfo` pulls the following information:\r\n```\r\ngetnetworkinfo:\r\n\"version\"\r\n\"protocolversion\"\r\n\"timeoffset\"\r\n\"connections\"\r\n\"proxy\"\r\n\"relayfee\"\r\n\"errors\"\r\n\r\ngetblockchaininfo:\r\n\"blocks\"\r\n\"difficulty\"\r\n\"testnet\"\r\n\r\ngetwalletinfo:\r\n\"walletversion\"\r\n\"balance\"\r\n\"keypoololdest\"\r\n\"keypoolsize\"\r\n\"unlocked_until\"\r\n\"paytxfee\"\r\n```\r\nWithin a group, the values are as atomic as ever. Some of these don't change at runtime at all, some hardly change.\r\n\r\nCan you indicate exactly between which two you're afraid non-atomicity is going to give a problem, in practice?\r\n\r\nIf not, let's please leave this behind us.",
      "created_at" : "2017-08-23T19:26:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10871#issuecomment-324437840",
      "id" : 324437840,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10871",
      "updated_at" : "2017-08-23T19:26:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324437840",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "My only real atomicity concern is between blocks and balance - ie that you may call getinfo, see a balance and assume that it is current as of a given block height. It may be of lesser concern in just bitcoin-cli, as its not intended to be used in scripts, hence my note that I'd be ok with just documenting this behavior, though I could still see someone fucking it up in some way.",
      "created_at" : "2017-08-24T16:38:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10871#issuecomment-324689680",
      "id" : 324689680,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10871",
      "updated_at" : "2017-08-24T16:38:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324689680",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "> My only real atomicity concern is between blocks and balance - ie that you may call getinfo, see a balance and assume that it is current as of a given block height.\r\n\r\nYes, that's a valid concern. Also outside this PR - there is currently no way to query up to which height the wallet has processed. Especially when the wallet and node are decoupled further w/ threads or even processes. We should add a `curheight` or such to `getwalletinfo`.",
      "created_at" : "2017-08-24T16:47:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10871#issuecomment-324692066",
      "id" : 324692066,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10871",
      "updated_at" : "2017-08-24T16:47:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324692066",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "> there is currently no way to query up to which height the wallet has processed\r\n\r\nI believe that `getinfo` itself could be misleading here. `balance` could be for a different height than `blocks`.\r\n\r\nThere's been discussion of adding the wallet's best block to `getwalletinfo` on IRC: https://botbot.me/freenode/bitcoin-core-dev/2017-08-11/?msg=89723092&page=2 and I have a branch to do that, which I'm going to PR after #10286 ",
      "created_at" : "2017-08-24T17:17:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10871#issuecomment-324699582",
      "id" : 324699582,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10871",
      "updated_at" : "2017-08-24T17:17:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324699582",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
