[
   {
      "body" : "Do we actually enforce that on Travis? Its nice to have the auto-checker stuff, but AFAIR its (barely) hooked up anywhere?",
      "created_at" : "2017-07-18T20:57:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-316195434",
      "id" : 316195434,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-18T20:57:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316195434",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "@TheBlueMatt Travis is currently not compiling with [Clang Thread Safety Analysis](https://clang.llvm.org/docs/ThreadSafetyAnalysis.html) warnings (`-Wthread-safety-analysis`) enabled. (Do we want to change that?)\r\n\r\nPersonally I build daily using `clang` with `-Wthread-safety-analysis` enabled.\r\n\r\nIn the general case we want to fix all warnings emitted when compiling with `-Wthread-safety-analysis`, don't we? :-)\r\n\r\n<details>\r\n<summary>Click to expand: Current thread safety warnings</summary>\r\n<pre>\r\nnet_processing.cpp:587:10: warning: reading variable 'vExtraTxnForCompact' requires holding mutex 'cs_main' [-Wthread-safety-analysis]\r\n    if (!vExtraTxnForCompact.size())\r\n         ^\r\nnet_processing.cpp:60:57: note: Guarded_by declared here.\r\nstatic std::vector<std::pair<uint256, CTransactionRef>> vExtraTxnForCompact GUARDED_BY(cs_main);\r\n                                                        ^\r\nnet_processing.cpp:583:1: note: Thread warning in function 'AddToCompactExtraTransactions'\r\n{\r\n^\r\nnet_processing.cpp:588:9: warning: reading variable 'vExtraTxnForCompact' requires holding mutex 'cs_main' [-Wthread-safety-analysis]\r\n        vExtraTxnForCompact.resize(max_extra_txn);\r\n        ^\r\nnet_processing.cpp:60:57: note: Guarded_by declared here.\r\nstatic std::vector<std::pair<uint256, CTransactionRef>> vExtraTxnForCompact GUARDED_BY(cs_main);\r\n                                                        ^\r\nnet_processing.cpp:583:1: note: Thread warning in function 'AddToCompactExtraTransactions'\r\n{\r\n^\r\nnet_processing.cpp:589:5: warning: reading variable 'vExtraTxnForCompact' requires holding mutex 'cs_main' [-Wthread-safety-analysis]\r\n    vExtraTxnForCompact[vExtraTxnForCompactIt] = std::make_pair(tx->GetWitnessHash(), tx);\r\n    ^\r\nnet_processing.cpp:60:57: note: Guarded_by declared here.\r\nstatic std::vector<std::pair<uint256, CTransactionRef>> vExtraTxnForCompact GUARDED_BY(cs_main);\r\n                                                        ^\r\nnet_processing.cpp:583:1: note: Thread warning in function 'AddToCompactExtraTransactions'\r\n{\r\n^\r\n</pre>\r\n</details>",
      "created_at" : "2017-07-18T21:24:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-316202564",
      "id" : 316202564,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-18T22:02:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316202564",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "If we're going to revive this safety checking infrastructure (it was introduced in #2003, and I don't think updated much since), there are probably many other places to add annotations.",
      "created_at" : "2017-07-19T00:39:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-316238630",
      "id" : 316238630,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-19T00:40:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316238630",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Agree with @sipa.\r\n@practicalswift whats the reason of only add the safety checking infrastructure to `AddToCompactExtraTransactions`?",
      "created_at" : "2017-07-19T09:49:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-316332960",
      "id" : 316332960,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-19T09:49:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316332960",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "The reason I'm starting with `AddToCompactExtraTransactions(Ã¢ÂÂ¦)` is simply to fix the only current warning when building with `clang`'s `-Wthread-safety-analysis` enabled:\r\n\r\n```\r\nnet_processing.cpp:587:10: warning: reading variable 'vExtraTxnForCompact' requires holding mutex 'cs_main' [-Wthread-safety-analysis]\r\n```\r\n\r\nThe reason for the warning is that `vExtraTxnForCompact` is marked as guarded by the `cs_main`-mutex:\r\n\r\n```c++\r\nstatic std::vector<std::pair<uint256, CTransactionRef>> vExtraTxnForCompact \r\n    GUARDED_BY(cs_main);\r\n```\r\n\r\n`clang` detects that `vExtraTxnForCompact` is accessed in `AddToCompactExtraTransactions(Ã¢ÂÂ¦)` and that this function lacks the `EXCLUSIVE_LOCKS_REQUIRED(cs_main)` annotation that logically should follow from such access (if intentional).\r\n\r\nThis PR fixes that and after applying this PR the code base is free from `-Wthread-safety-analysis` warnings.\r\n\r\nI'd be glad to extend the usage of `GUARDED_BY(Ã¢ÂÂ¦)` annotations (and the corresponding `EXCLUSIVE_LOCKS_REQUIRED(Ã¢ÂÂ¦)` annotations) in the code base, but that is a larger undertaking that probably belongs in a follow-up PR.\r\n\r\nI guess one reason not to fix the current warning is if we for some reason instead would want to remove this thread-safety infrastructure. Let me know if that is the case :-)",
      "created_at" : "2017-07-19T14:50:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-316412165",
      "id" : 316412165,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-19T14:52:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316412165",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "Additional reading: The [\"C/C++ Thread Safety Analysis\"](https://research.google.com/pubs/archive/42958.pdf) paper (Hutchins, Ballman & Sutherland, 2014) paper describing `clang` thread-safety analysis and how it is used for the Google C++ codebase:\r\n\r\n> They essentially provide a static type system for threads, and can detect potential race conditions and deadlocks. This paper describes Clang Thread Safety Analysis, a tool which uses annotations to declare and enforce thread safety policies in C and C++ programs.\r\n> [Ã¢ÂÂ¦]\r\n> It has been deployed on a large scale at Google; all C++ code at Google is now compiled with thread safety analysis enabled by default.\r\n> [Ã¢ÂÂ¦]\r\n> The GUARDED_BY attribute declares that a thread must lock `mu` before it can read or write to `balance`, thus ensuring that the increment and decrement operations are atomic. Similarly,\r\nREQUIRES declares that the calling thread must lock mu before calling `withdrawImpl`. Because the caller is assumed to have locked `mu,` it is safe to modify `balance` within the body of the method.",
      "created_at" : "2017-07-19T15:06:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-316417209",
      "id" : 316417209,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-19T15:21:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316417209",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "Ah! Didn't realize its to fix a warning, yea, lets a) do this and b) can you add a -Werror=thread-safety-analysis here, too? I was informed travis already does a clang build for OSX, so it should be able to catch errors here :).",
      "created_at" : "2017-07-19T22:12:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-316533985",
      "id" : 316533985,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-19T22:12:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316533985",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "@TheBlueMatt Sure! I've updated the PR title to make things more clear :-)",
      "created_at" : "2017-07-19T22:26:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-316537015",
      "id" : 316537015,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-19T22:26:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/316537015",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "I think we really should make travis enforce this. It shouldnt be hard cause we already have --enable-werror by default, just need to hook up -Werror=thread-safety-analysis if the compiler supports it (which our clang-osx build should).",
      "created_at" : "2017-07-24T15:31:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-317460836",
      "id" : 317460836,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-24T15:31:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/317460836",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "@TheBlueMatt Would something along the lines of the following do the trick for Travis?\r\n\r\n```diff\r\ndiff --git a/.travis.yml b/.travis.yml\r\nindex a79428f..423b04e 100644\r\n--- a/.travis.yml\r\n+++ b/.travis.yml\r\n@@ -34,7 +34,7 @@ env:\r\n # No wallet\r\n     - HOST=x86_64-unknown-linux-gnu PACKAGES=\"python3\" DEP_OPTS=\"NO_WALLET=1\" RUN_TESTS=true GOAL=\"install\" BITCOIN_CONFIG=\"--enable-glibc-back-compat --enable-reduce-exports\"\r\n # Cross-Mac\r\n-    - HOST=x86_64-apple-darwin11 PACKAGES=\"cmake imagemagick libcap-dev librsvg2-bin libz-dev libbz2-dev libtiff-tools python-dev\" BITCOIN_CONFIG=\"--enable-gui --enable-reduce-exports\" OSX_SDK=10.11 GOAL=\"deploy\"\r\n+    - HOST=x86_64-apple-darwin11 PACKAGES=\"cmake imagemagick libcap-dev librsvg2-bin libz-dev libbz2-dev libtiff-tools python-dev\" BITCOIN_CONFIG=\"--enable-gui --enable-reduce-exports\" OSX_SDK=10.11 GOAL=\"deploy\" CPPFLAGS=\"-Werror=thread-safety-analysis\"\r\n\r\n before_install:\r\n     - export PATH=$(echo $PATH | tr ':' \"\\n\" | sed '/\\/opt\\/python/d' | tr \"\\n\" \":\" | sed \"s|::|:|g\")\r\n```\r\n\r\nOr did you mean always enabling that warning if the compiler supports it?",
      "created_at" : "2017-07-24T15:56:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-317468538",
      "id" : 317468538,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-24T16:01:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/317468538",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "@practicalswift I was referring to the -Werror support we already have in configure.ac. Best to use that, I'd think.",
      "created_at" : "2017-07-24T20:57:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-317552353",
      "id" : 317552353,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-24T20:57:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/317552353",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "@TheBlueMatt Got it! What about this:\r\n\r\n```diff\r\ndiff --git a/configure.ac b/configure.ac\r\nindex aea5d71..ec3877d 100644\r\n--- a/configure.ac\r\n+++ b/configure.ac\r\n@@ -241,6 +241,7 @@ if test \"x$enable_werror\" = \"xyes\"; then\r\n     AC_MSG_ERROR(\"enable-werror set but -Werror is not usable\")\r\n   fi\r\n   AX_CHECK_COMPILE_FLAG([-Werror=vla],[ERROR_CXXFLAGS=\"$ERROR_CXXFLAGS -Werror=vla\"],,[[$CXXFLAG_WERROR]])\r\n+  AX_CHECK_COMPILE_FLAG([-Werror=thread-safety-analysis],[ERROR_CXXFLAGS=\"$ERROR_CXXFLAGS -Werror=thread-safety-analysis\"],,[[$CXXFLAG_WERROR]])\r\n fi\r\n\r\n if test \"x$CXXFLAGS_overridden\" = \"xno\"; then\r\n@@ -249,6 +250,7 @@ if test \"x$CXXFLAGS_overridden\" = \"xno\"; then\r\n   AX_CHECK_COMPILE_FLAG([-Wformat],[CXXFLAGS=\"$CXXFLAGS -Wformat\"],,[[$CXXFLAG_WERROR]])\r\n   AX_CHECK_COMPILE_FLAG([-Wvla],[CXXFLAGS=\"$CXXFLAGS -Wvla\"],,[[$CXXFLAG_WERROR]])\r\n   AX_CHECK_COMPILE_FLAG([-Wformat-security],[CXXFLAGS=\"$CXXFLAGS -Wformat-security\"],,[[$CXXFLAG_WERROR]])\r\n+  AX_CHECK_COMPILE_FLAG([-Wthread-safety-analysis],[CXXFLAGS=\"$CXXFLAGS -Wthread-safety-analysis\"],,[[$CXXFLAG_WERROR]])\r\n\r\n   ## Some compilers (gcc) ignore unknown -Wno-* options, but warn about all\r\n   ## unknown options if any other warning is produced. Test the -Wfoo case, and\r\n```\r\n\r\nLooks good? :-)",
      "created_at" : "2017-07-24T21:57:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-317567066",
      "id" : 317567066,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-24T22:07:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/317567066",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "Heh, I figured you'd incldue it in this PR. Anyway, utACK this pr by itself.",
      "created_at" : "2017-07-25T20:00:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-317854805",
      "id" : 317854805,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-25T20:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/317854805",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "utACK ef2aca6c12efc48ce557a87c90ecf2d96ad4885e",
      "created_at" : "2017-07-31T14:18:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-319080566",
      "id" : 319080566,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-07-31T14:18:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/319080566",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "utACK ef2aca6c12efc48ce557a87c90ecf2d96ad4885e, though its useful to hold off merging this until #10923 is ready as a test for #10923.",
      "created_at" : "2017-08-01T15:01:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-319397367",
      "id" : 319397367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-08-01T15:01:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/319397367",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Cherry-picked 9df85380aae4219920ccca80efac2bdf408519d8 into this PR as suggested by @TheBlueMatt in #10923!\r\n\r\n@TheBlueMatt, looks good? :-)",
      "created_at" : "2017-08-18T13:50:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-323359026",
      "id" : 323359026,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-08-18T14:06:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/323359026",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "body" : "@ptracticalswift maybe rebase on #10923 and take the patches from https://github.com/TheBlueMatt/bitcoin/commits/2017-08-test-10923 (squashed, of course)?",
      "created_at" : "2017-08-18T21:40:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-323467121",
      "id" : 323467121,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-08-18T21:40:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/323467121",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "@TheBlueMatt Does this PR look good now? Please check my attempt to summarize your changes in the commit message for https://github.com/bitcoin/bitcoin/pull/10866/commits/695fe315e8c4191bd5e9e98a8ce6d2be8c6aff96. Let me know if anything should be changed or if you'd rather squash your commits in your branch and have me cherry pick the resulting commit as-is :-)",
      "created_at" : "2017-08-19T17:07:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-323535396",
      "id" : 323535396,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-08-19T17:08:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/323535396",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10866#discussion_r134746407"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10866"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134746407"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This change is already in master",
      "commit_id" : "b22210337da62047290fcb2658b2c45117c7efa9",
      "created_at" : "2017-08-23T13:10:55Z",
      "diff_hunk" : "@@ -34,7 +34,7 @@ env:\n # x86_64 Linux, No wallet\n     - HOST=x86_64-unknown-linux-gnu PACKAGES=\"python3\" DEP_OPTS=\"NO_WALLET=1\" RUN_TESTS=true GOAL=\"install\" BITCOIN_CONFIG=\"--enable-glibc-back-compat --enable-reduce-exports\"\n # Cross-Mac\n-    - HOST=x86_64-apple-darwin11 PACKAGES=\"cmake imagemagick libcap-dev librsvg2-bin libz-dev libbz2-dev libtiff-tools python-dev\" BITCOIN_CONFIG=\"--enable-gui --enable-reduce-exports\" OSX_SDK=10.11 GOAL=\"deploy\"\n+    - HOST=x86_64-apple-darwin11 PACKAGES=\"cmake imagemagick libcap-dev librsvg2-bin libz-dev libbz2-dev libtiff-tools python-dev\" BITCOIN_CONFIG=\"--enable-gui --enable-reduce-exports --enable-werror\" OSX_SDK=10.11 GOAL=\"deploy\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#discussion_r134746407",
      "id" : 134746407,
      "original_commit_id" : "eeee7c12d4963a3f0bccfd1b8b5b43e574874da1",
      "original_position" : 5,
      "path" : ".travis.yml",
      "position" : null,
      "pull_request_review_id" : 58073275,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10866",
      "updated_at" : "2017-09-06T07:06:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/134746407",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "@MarcoFalke Thanks! Rebased on top of `master`, so the already merged commit is now excluded from this PR :-)",
      "created_at" : "2017-08-23T15:30:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-324373178",
      "id" : 324373178,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-08-23T15:32:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/324373178",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@practicalswift \r\nNACK\r\n1) Transaction time check was changed:\r\n-            checktxtime = boost::get_system_time() + boost::posix_time::minutes(1);\r\n +            checktxtime = std::chrono::steady_clock::now() + std::chrono::seconds(1);\r\n\r\n2) IMO there are too many things going on in the first commit at once, making it hard to review and bug-prone. Switching the primitives in the sync module from boost to std should be done in an atomic commit, without doing any other change.\r\n\r\nI didn't know about this pull request before opening issue #11166 (from which you referred me here), I'm pretty close to having that ready to open a pull request, (just changing boost to std). Will update here when it's ready. I think it'd be better if that were reviewed and merged, and only then follow up with other changes. \r\nEDIT: Opened pull request #11199 ",
      "created_at" : "2017-08-30T19:06:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-326088724",
      "id" : 326088724,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-08-30T19:48:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/326088724",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/84245?v=4",
         "events_url" : "https://api.github.com/users/danra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/danra/followers",
         "following_url" : "https://api.github.com/users/danra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/danra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/danra",
         "id" : 84245,
         "login" : "danra",
         "organizations_url" : "https://api.github.com/users/danra/orgs",
         "received_events_url" : "https://api.github.com/users/danra/received_events",
         "repos_url" : "https://api.github.com/users/danra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/danra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/danra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/danra"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@danra Are you referring to @TheBlueMatt:s commit f01ea9326bc69d4f731a5904881740308c5e4271?\r\n\r\nThis PR contains three commits. Please consider reviewing d77d9ccd1ad35f550c8dcdc3b83e65bad8c51c48 and 0c7115c56fdbe25257aee23ae002dc5af3238bb7 too :-)",
      "created_at" : "2017-09-01T07:42:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-326513048",
      "id" : 326513048,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-01T07:42:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/326513048",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa @TheBlueMatt @jonasschnelli @theuni I have some follow-up work which depends on this PR. Do you have time reviewing this PR?\r\n\r\nThe follow-up work is a PR adding `GUARDED_BY(Ã¢ÂÂ¦)` and `EXCLUSIVE_LOCKS_REQUIRED(Ã¢ÂÂ¦)` annotations where appropriate.",
      "created_at" : "2017-09-01T07:46:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-326513832",
      "id" : 326513832,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-01T07:47:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/326513832",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@practicalswift Yes, referring to f01ea93",
      "created_at" : "2017-09-01T09:26:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-326534428",
      "id" : 326534428,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-01T09:26:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/326534428",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/84245?v=4",
         "events_url" : "https://api.github.com/users/danra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/danra/followers",
         "following_url" : "https://api.github.com/users/danra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/danra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/danra",
         "id" : 84245,
         "login" : "danra",
         "organizations_url" : "https://api.github.com/users/danra/orgs",
         "received_events_url" : "https://api.github.com/users/danra/received_events",
         "repos_url" : "https://api.github.com/users/danra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/danra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/danra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/danra"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@TheBlueMatt Do you have any input on @danra:s review?",
      "created_at" : "2017-09-01T09:29:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-326535153",
      "id" : 326535153,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-01T09:29:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/326535153",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Please see #11226 for the follow-up PR which adds `GUARDED_BY(Ã¢ÂÂ¦)` and `EXCLUSIVE_LOCKS_REQUIRED(Ã¢ÂÂ¦)` annotations.",
      "created_at" : "2017-09-03T17:04:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-326817382",
      "id" : 326817382,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-03T17:04:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/326817382",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@danra Indeed, the minutes -> seconds change was a mistake, should probably be fixed. Indeed, the first commit was originally several different commits, but they werent logically split up so it was easier to squash them than to manually re-split them. Personally I find the first commit not-too-hard to review cause the changes are pretty clearly along file boundaries, but then I also wrote it, so I cant speak....\r\n\r\nutACK 0c7115c56fdbe25257aee23ae002dc5af3238bb7 (I went back and re-checked that nothing currently needing boost interruption support should be effected by this change).",
      "created_at" : "2017-09-04T22:16:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-327033991",
      "id" : 327033991,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-04T22:16:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/327033991",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@TheBlueMatt I've now added a commit fixing the minutes/seconds mix-up. Looks good? :-)",
      "created_at" : "2017-09-05T06:17:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-327081361",
      "id" : 327081361,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-05T06:17:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/327081361",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Yup, needs a squash though.",
      "created_at" : "2017-09-06T00:50:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-327342903",
      "id" : 327342903,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-06T00:50:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/327342903",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@TheBlueMatt Squashed! Looks good? :-)",
      "created_at" : "2017-09-06T07:06:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-327394883",
      "id" : 327394883,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-06T07:06:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/327394883",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Anyone willing to review? :-)\r\n\r\nHaving this PR merged would simplify the work on follow-up PR:s such as #11226.",
      "created_at" : "2017-09-15T12:51:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-329773866",
      "id" : 329773866,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-15T12:51:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/329773866",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@practicalswift generally, when squashing, please try to avoid rebasing as it makes it much easier for reviewers to track which changes you made between two commits of a PR.\r\n\r\nre-utACK b22210337da62047290fcb2658b2c45117c7efa9",
      "created_at" : "2017-09-15T19:18:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-329875597",
      "id" : 329875597,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-15T19:18:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/329875597",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10866#discussion_r139252430"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10866"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/139252430"
         }
      },
      "author_association" : "MEMBER",
      "body" : "cvBlockChange needs to be notified in Interrupt() in init, otherwise we'll hang here at shutdown.",
      "commit_id" : "b22210337da62047290fcb2658b2c45117c7efa9",
      "created_at" : "2017-09-15T21:19:12Z",
      "diff_hunk" : "@@ -472,17 +472,17 @@ UniValue getblocktemplate(const JSONRPCRequest& request)\n         // Release the wallet and main lock while waiting\n         LEAVE_CRITICAL_SECTION(cs_main);\n         {\n-            checktxtime = boost::get_system_time() + boost::posix_time::minutes(1);\n+            checktxtime = std::chrono::steady_clock::now() + std::chrono::minutes(1);\n \n-            boost::unique_lock<boost::mutex> lock(csBestBlock);\n+            CWaitableLock lock(csBestBlock);\n             while (chainActive.Tip()->GetBlockHash() == hashWatchedChain && IsRPCRunning())\n             {\n-                if (!cvBlockChange.timed_wait(lock, checktxtime))\n+                if (cvBlockChange.wait_until(lock, checktxtime) == std::cv_status::timeout)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#discussion_r139252430",
      "id" : 139252430,
      "original_commit_id" : "b22210337da62047290fcb2658b2c45117c7efa9",
      "original_position" : 21,
      "path" : "src/rpc/mining.cpp",
      "position" : 21,
      "pull_request_review_id" : 63165589,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10866",
      "updated_at" : "2017-09-15T21:19:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/139252430",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@TheBlueMatt \r\n> Personally I find the first commit not-too-hard to review cause the changes are pretty clearly along file boundaries, but then I also wrote it, so I cant speak....\r\n\r\nIMHO the fact that there were a few utACKs before fixing the minutes-seconds bug demonstrates that the commit was doing too many things at once to review easily.\r\n\r\nSo it's still a NACK from me until it's split to smaller commits. Of course, you're welcome to use my own PR #11199 which does just the move from `boost` to `std` locks part.",
      "created_at" : "2017-09-15T21:28:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-329908560",
      "id" : 329908560,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-15T21:28:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/329908560",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/84245?v=4",
         "events_url" : "https://api.github.com/users/danra/events{/privacy}",
         "followers_url" : "https://api.github.com/users/danra/followers",
         "following_url" : "https://api.github.com/users/danra/following{/other_user}",
         "gists_url" : "https://api.github.com/users/danra/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/danra",
         "id" : 84245,
         "login" : "danra",
         "organizations_url" : "https://api.github.com/users/danra/orgs",
         "received_events_url" : "https://api.github.com/users/danra/received_events",
         "repos_url" : "https://api.github.com/users/danra/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/danra/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/danra/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/danra"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK other than my comment above. I think the commits here are ok. Either way, with #11199 or this one, we're going to need some follow-ups to tidy up afterwards.",
      "created_at" : "2017-09-15T21:37:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10866#issuecomment-329910036",
      "id" : 329910036,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10866",
      "updated_at" : "2017-09-15T21:37:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/329910036",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   }
]
