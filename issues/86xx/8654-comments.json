[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8654#discussion_r77369779"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8654"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/77369779"
         }
      },
      "body" : "s/12/6/ ?",
      "commit_id" : "6ed0c9c18feeb117e74590c4247e33397f8533d3",
      "created_at" : "2016-09-02T15:56:01Z",
      "diff_hunk" : "@@ -105,6 +105,24 @@ struct PrecomputedTransactionData\n     PrecomputedTransactionData(const CTransaction& tx);\n };\n \n+struct SigHashCache\n+{\n+    bool set[6];\n+    uint256 value[6];\n+\n+    void Clear()\n+    {\n+        for (int i=0; i<12; i++) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8654#discussion_r77369779",
      "id" : 77369779,
      "original_commit_id" : "498d52f8064ff0d0f45ee8ab8a1522f5864812df",
      "original_position" : 11,
      "path" : "src/script/interpreter.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8654",
      "updated_at" : "2016-09-06T06:56:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/77369779",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8654#discussion_r77370902"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8654"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/77370902"
         }
      },
      "body" : "Perhaps add a comment here that sigversion is not used in the `entry` calculation because we know there will only be one sigversion across an entire input. Also, if future extra sighashes are defined, this may need extension (or, alternatively, cache read/write could be skipped for sigversion != 0).",
      "commit_id" : "6ed0c9c18feeb117e74590c4247e33397f8533d3",
      "created_at" : "2016-09-02T16:03:14Z",
      "diff_hunk" : "@@ -1229,7 +1231,12 @@ bool TransactionSignatureChecker::CheckSig(const vector<unsigned char>& vchSigIn\n     int nHashType = vchSig.back();\n     vchSig.pop_back();\n \n-    uint256 sighash = SignatureHash(scriptCode, *txTo, nIn, nHashType, amount, sigversion, this->txdata);\n+    int entry = ((nHashType & 0x1F) == SIGHASH_SINGLE ? 0 : ((nHashType & 0x1F) == SIGHASH_NONE ? 1 : 2)) + ((nHashType & 0x80) ? 3 : 0);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8654#discussion_r77370902",
      "id" : 77370902,
      "original_commit_id" : "498d52f8064ff0d0f45ee8ab8a1522f5864812df",
      "original_position" : 48,
      "path" : "src/script/interpreter.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8654",
      "updated_at" : "2016-09-06T06:56:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/77370902",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8654#discussion_r77376814"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8654"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/77376814"
         }
      },
      "body" : "yes, I changed that to 12 as I thought there are 12 combinations (sw and pre-sw). Later I figured out that was not needed but forgot to change it back",
      "commit_id" : "6ed0c9c18feeb117e74590c4247e33397f8533d3",
      "created_at" : "2016-09-02T16:46:20Z",
      "diff_hunk" : "@@ -1229,7 +1231,12 @@ bool TransactionSignatureChecker::CheckSig(const vector<unsigned char>& vchSigIn\n     int nHashType = vchSig.back();\n     vchSig.pop_back();\n \n-    uint256 sighash = SignatureHash(scriptCode, *txTo, nIn, nHashType, amount, sigversion, this->txdata);\n+    int entry = ((nHashType & 0x1F) == SIGHASH_SINGLE ? 0 : ((nHashType & 0x1F) == SIGHASH_NONE ? 1 : 2)) + ((nHashType & 0x80) ? 3 : 0);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8654#discussion_r77376814",
      "id" : 77376814,
      "original_commit_id" : "498d52f8064ff0d0f45ee8ab8a1522f5864812df",
      "original_position" : 48,
      "path" : "src/script/interpreter.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8654",
      "updated_at" : "2016-09-06T06:56:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/77376814",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8403418?v=3",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8654#discussion_r77377987"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8654"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/77377987"
         }
      },
      "body" : "fixed",
      "commit_id" : "6ed0c9c18feeb117e74590c4247e33397f8533d3",
      "created_at" : "2016-09-02T16:55:07Z",
      "diff_hunk" : "@@ -105,6 +105,24 @@ struct PrecomputedTransactionData\n     PrecomputedTransactionData(const CTransaction& tx);\n };\n \n+struct SigHashCache\n+{\n+    bool set[6];\n+    uint256 value[6];\n+\n+    void Clear()\n+    {\n+        for (int i=0; i<12; i++) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8654#discussion_r77377987",
      "id" : 77377987,
      "original_commit_id" : "498d52f8064ff0d0f45ee8ab8a1522f5864812df",
      "original_position" : 11,
      "path" : "src/script/interpreter.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8654",
      "updated_at" : "2016-09-06T06:56:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/77377987",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8403418?v=3",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "body" : "fixed a bug in  #4562. It requires 256 cache slots instead of just 6 for the common types, since the nHashType is part of the sighash so each one is unique.\r\n\r\nNeed more tests for witness txs.",
      "created_at" : "2016-09-05T06:23:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8654#issuecomment-244667034",
      "id" : 244667034,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8654",
      "updated_at" : "2016-09-05T06:23:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/244667034",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8403418?v=3",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "body" : "Nice work with the tests so far!",
      "created_at" : "2016-09-05T15:17:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8654#issuecomment-244769823",
      "id" : 244769823,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8654",
      "updated_at" : "2016-09-05T15:17:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/244769823",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Test updated to cover #8524 \r\n\r\nBenchmarking with and without #8524/#8654: https://gist.github.com/jl2012/f3262fd7cf47664ce43f036b9539e831",
      "created_at" : "2016-09-06T06:48:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8654#issuecomment-244863872",
      "id" : 244863872,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8654",
      "updated_at" : "2016-09-06T06:48:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/244863872",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8403418?v=3",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8654#discussion_r77580635"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8654"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/77580635"
         }
      },
      "body" : "See #8667",
      "commit_id" : "6ed0c9c18feeb117e74590c4247e33397f8533d3",
      "created_at" : "2016-09-06T06:49:45Z",
      "diff_hunk" : "@@ -882,7 +882,7 @@ def SignatureHash(script, txTo, inIdx, hashtype):\n         tmp = txtmp.vout[outIdx]\n         txtmp.vout = []\n         for i in range(outIdx):\n-            txtmp.vout.append(CTxOut())\n+            txtmp.vout.append(CTxOut(-1))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8654#discussion_r77580635",
      "id" : 77580635,
      "original_commit_id" : "93b2d5c2e1eb1002ddffa4e1cbaea224f857715e",
      "original_position" : 5,
      "path" : "qa/rpc-tests/test_framework/script.py",
      "position" : 5,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8654",
      "updated_at" : "2016-09-06T06:56:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/77580635",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8403418?v=3",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   }
]
