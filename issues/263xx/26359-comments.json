[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26359#discussion_r1001578644"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26359"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1001578644"
         }
      },
      "author_association" : "MEMBER",
      "body" : "cfd5c27dcdc39cf7a65c56c3dbf3bf60ea0c475f:\r\n\r\nThere are several unrelated things:\r\n\r\n* If this feeler check isn't dead code here, it should probably be moved to the previous section that initializes the TxRelay struct. (And maybe in a separate pull request, as it would change non-erlay code?) This would mean that the tx relay struct isn't initialized and also m_relays_txs isn't set, which is then checked in this line here.\r\n* Unrelated, I wonder if `RejectIncomingTxs` should be used here. The difference is that the `Relay` permission will be carved out. I don't know the answer, I just wanted to raise the point.",
      "commit_id" : "15962a8eea8cbadb302453ae0960132c1a3cfc4d",
      "created_at" : "2022-10-21T09:30:08Z",
      "diff_hunk" : "@@ -3273,8 +3273,9 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             // - protocol version per the VERSION message supports WTXID_RELAY;\n             // - we intended to exchange transactions over this connection while establishing it\n             //   and the peer indicated support for transaction relay in the VERSION message;\n-            // - we are not in -blocksonly mode.\n-            if (pfrom.m_relays_txs && !m_ignore_incoming_txs) {\n+            // - we are not in -blocksonly mode;\n+            // - this is not a feeler.\n+            if (pfrom.m_relays_txs && !m_ignore_incoming_txs && !pfrom.IsFeelerConn()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26359#discussion_r1001578644",
      "id" : 1001578644,
      "line" : 3278,
      "node_id" : "PRRC_kwDOABII5847suCU",
      "original_commit_id" : "cfd5c27dcdc39cf7a65c56c3dbf3bf60ea0c475f",
      "original_line" : 3278,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 8,
      "pull_request_review_id" : 1150648334,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26359",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1001578644/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-21T09:30:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1001578644",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25572](https://github.com/bitcoin/bitcoin/pull/25572) (refactor: Introduce EvictionManager and use it for the inbound eviction logic by dergoegge)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-10-21T10:18:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26359#issuecomment-1286753334",
      "id" : 1286753334,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26359",
      "node_id" : "IC_kwDOABII585Mskw2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1286753334/reactions"
      },
      "updated_at" : "2022-10-21T10:18:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1286753334",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26359#discussion_r1001625212"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26359"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1001625212"
         }
      },
      "author_association" : "MEMBER",
      "body" : "good point, i'll look closer.",
      "commit_id" : "15962a8eea8cbadb302453ae0960132c1a3cfc4d",
      "created_at" : "2022-10-21T10:20:13Z",
      "diff_hunk" : "@@ -3273,8 +3273,9 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             // - protocol version per the VERSION message supports WTXID_RELAY;\n             // - we intended to exchange transactions over this connection while establishing it\n             //   and the peer indicated support for transaction relay in the VERSION message;\n-            // - we are not in -blocksonly mode.\n-            if (pfrom.m_relays_txs && !m_ignore_incoming_txs) {\n+            // - we are not in -blocksonly mode;\n+            // - this is not a feeler.\n+            if (pfrom.m_relays_txs && !m_ignore_incoming_txs && !pfrom.IsFeelerConn()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26359#discussion_r1001625212",
      "id" : 1001625212,
      "in_reply_to_id" : 1001578644,
      "line" : 3278,
      "node_id" : "PRRC_kwDOABII5847s5Z8",
      "original_commit_id" : "cfd5c27dcdc39cf7a65c56c3dbf3bf60ea0c475f",
      "original_line" : 3278,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 8,
      "pull_request_review_id" : 1150717088,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26359",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1001625212/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-21T10:20:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1001625212",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26359#discussion_r1001842102"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26359"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1001842102"
         }
      },
      "author_association" : "MEMBER",
      "body" : "1. From my understanding, this code isn't dead. The feeler check could indeed be moved above. Not sure what's the best way to attack this w.r.t. this PR (surely, a separate PR is the best option, but is that gonna get merged sooner...)\r\n2. Yeah checking for tx relay support is kinda ugly in general. `RejectIncomingTxs` is of course relevant, but not 100% match, if you just look at the name. I'd better keep the code as-is now, and refactor this separately (dunno how yet)",
      "commit_id" : "15962a8eea8cbadb302453ae0960132c1a3cfc4d",
      "created_at" : "2022-10-21T14:14:38Z",
      "diff_hunk" : "@@ -3273,8 +3273,9 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             // - protocol version per the VERSION message supports WTXID_RELAY;\n             // - we intended to exchange transactions over this connection while establishing it\n             //   and the peer indicated support for transaction relay in the VERSION message;\n-            // - we are not in -blocksonly mode.\n-            if (pfrom.m_relays_txs && !m_ignore_incoming_txs) {\n+            // - we are not in -blocksonly mode;\n+            // - this is not a feeler.\n+            if (pfrom.m_relays_txs && !m_ignore_incoming_txs && !pfrom.IsFeelerConn()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26359#discussion_r1001842102",
      "id" : 1001842102,
      "in_reply_to_id" : 1001578644,
      "line" : 3278,
      "node_id" : "PRRC_kwDOABII5847tuW2",
      "original_commit_id" : "cfd5c27dcdc39cf7a65c56c3dbf3bf60ea0c475f",
      "original_line" : 3278,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 8,
      "pull_request_review_id" : 1151036674,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26359",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1001842102/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-21T14:14:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1001842102",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26359#discussion_r1002071153"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26359"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1002071153"
         }
      },
      "author_association" : "MEMBER",
      "body" : "By the latter I mean that even `RejectIncomingTxs`-ing (whatever that could mean) doesn't necessarily mean we should reject reconciling. Might be useful to reconcile even if we \"should reject\". Not 100% sure (certainly not how Erlay intends to work in the default case).\r\n\r\nAnyway, not changing the code until further consideration.",
      "commit_id" : "15962a8eea8cbadb302453ae0960132c1a3cfc4d",
      "created_at" : "2022-10-21T18:20:16Z",
      "diff_hunk" : "@@ -3273,8 +3273,9 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             // - protocol version per the VERSION message supports WTXID_RELAY;\n             // - we intended to exchange transactions over this connection while establishing it\n             //   and the peer indicated support for transaction relay in the VERSION message;\n-            // - we are not in -blocksonly mode.\n-            if (pfrom.m_relays_txs && !m_ignore_incoming_txs) {\n+            // - we are not in -blocksonly mode;\n+            // - this is not a feeler.\n+            if (pfrom.m_relays_txs && !m_ignore_incoming_txs && !pfrom.IsFeelerConn()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26359#discussion_r1002071153",
      "id" : 1002071153,
      "in_reply_to_id" : 1001578644,
      "line" : 3278,
      "node_id" : "PRRC_kwDOABII5847umRx",
      "original_commit_id" : "cfd5c27dcdc39cf7a65c56c3dbf3bf60ea0c475f",
      "original_line" : 3278,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 8,
      "pull_request_review_id" : 1151382479,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26359",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1002071153/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-21T18:31:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1002071153",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26359#discussion_r1004664239"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26359"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004664239"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> Not sure what's the best way to attack this w.r.t. this PR \r\n\r\nHappy to work on this, unless you want to",
      "commit_id" : "0ba8bd18bf0473b8a8239954310919e1a33ab671",
      "created_at" : "2022-10-25T15:47:47Z",
      "diff_hunk" : "@@ -3273,8 +3273,9 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             // - protocol version per the VERSION message supports WTXID_RELAY;\n             // - we intended to exchange transactions over this connection while establishing it\n             //   and the peer indicated support for transaction relay in the VERSION message;\n-            // - we are not in -blocksonly mode.\n-            if (pfrom.m_relays_txs && !m_ignore_incoming_txs) {\n+            // - we are not in -blocksonly mode;\n+            // - this is not a feeler.\n+            if (pfrom.m_relays_txs && !m_ignore_incoming_txs && !pfrom.IsFeelerConn()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26359#discussion_r1004664239",
      "id" : 1004664239,
      "in_reply_to_id" : 1001578644,
      "line" : 3278,
      "node_id" : "PRRC_kwDOABII58474fWv",
      "original_commit_id" : "cfd5c27dcdc39cf7a65c56c3dbf3bf60ea0c475f",
      "original_line" : 3278,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 8,
      "pull_request_review_id" : 1155070256,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26359",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004664239/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-25T15:47:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004664239",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
