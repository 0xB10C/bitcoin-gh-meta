[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Changes look good, is there a reason it's in draft?\n> \n> Also, is there a way to add a test for this?\n\nI made it a draft because I haven't written a test yet. I'll mark it as ready for review after I add some tests. ",
      "created_at" : "2022-10-21T13:29:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26347#issuecomment-1286963633",
      "id" : 1286963633,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26347",
      "node_id" : "IC_kwDOABII585MtYGx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1286963633/reactions"
      },
      "updated_at" : "2022-10-21T13:29:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1286963633",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#22838](https://github.com/bitcoin/bitcoin/pull/22838) (descriptors: Be able to specify change and receiving in a single descriptor string by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-10-23T22:57:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26347#issuecomment-1288221666",
      "id" : 1288221666,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26347",
      "node_id" : "IC_kwDOABII585MyLPi",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1288221666/reactions"
      },
      "updated_at" : "2022-10-23T22:57:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1288221666",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The test seems to create intermittent failures. I also cherry-picked the test on master and the results seem to be the same.\r\n`seq 100 | xargs -i -P 5 python test/functional/wallet_importdescriptors.py --descriptors` will execute the test in parallel batches of 5.",
      "created_at" : "2022-10-24T09:31:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26347#issuecomment-1288729227",
      "id" : 1288729227,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26347",
      "node_id" : "IC_kwDOABII585M0HKL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1288729227/reactions"
      },
      "updated_at" : "2022-10-24T09:31:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1288729227",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The test seems to create intermittent failures. I also cherry-picked the test on master and the results seem to be the same. `seq 100 | xargs -i -P 5 python test/functional/wallet_importdescriptors.py --descriptors` will execute the test in parallel batches of 5.\r\n\r\nThanks for taking a look at this, that should be fixed now. There is still a problem of the passphrase timing out on certain systems before `importdescriptors` is even run, but I'm not sure how to fix that.",
      "created_at" : "2022-10-24T18:34:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26347#issuecomment-1289436203",
      "id" : 1289436203,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26347",
      "node_id" : "IC_kwDOABII585M2zwr",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1289436203/reactions"
      },
      "updated_at" : "2022-10-24T18:34:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1289436203",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1003661127"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1003661127"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In b8952bd7d3b3f745109506223f829c5dd91e638f \"wallet: ensure that the passphrase is not deleted from memory when being used to rescan\"\r\n\r\nI think this is the wrong place to grab this mutex. I think it would be better to put it `CWallet::Lock` (in addition to the `LOCK(cs_wallet)` already there) as that is the underlying locking function that is called in a variety of places and so would offer stronger protection.",
      "commit_id" : "25b8736431677f9e24fc0bbf93a7f2fc1de55502",
      "created_at" : "2022-10-24T19:12:40Z",
      "diff_hunk" : "@@ -90,6 +90,7 @@ RPCHelpMan walletpassphrase()\n     std::weak_ptr<CWallet> weak_wallet = wallet;\n     pwallet->chain().rpcRunLater(strprintf(\"lockwallet(%s)\", pwallet->GetName()), [weak_wallet, relock_time] {\n         if (auto shared_wallet = weak_wallet.lock()) {\n+            LOCK(shared_wallet->m_relock_mutex);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1003661127",
      "id" : 1003661127,
      "line" : 93,
      "node_id" : "PRRC_kwDOABII58470qdH",
      "original_commit_id" : "b8952bd7d3b3f745109506223f829c5dd91e638f",
      "original_line" : 93,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/encrypt.cpp",
      "position" : 4,
      "pull_request_review_id" : 1153640639,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1003661127/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-24T19:41:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1003661127",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1003662424"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1003662424"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In b8952bd7d3b3f745109506223f829c5dd91e638f \"wallet: ensure that the passphrase is not deleted from memory when being used to rescan\"\r\n\r\nThe mutex should be grabbed before ensuring the wallet is unlocked. There could be a race condition where the wallet is locked by the scheduler in between checking that the wallet is unlocked, and grabbing `m_relock_mutex`. By grabbing the mutex first, we can be sure that the scheduler will not be able to lock the wallet before we check that the wallet is unlocked.\r\n\r\nAlso, use `LOCK2` to grab 2 locks at the same time.",
      "commit_id" : "25b8736431677f9e24fc0bbf93a7f2fc1de55502",
      "created_at" : "2022-10-24T19:14:18Z",
      "diff_hunk" : "@@ -875,6 +875,7 @@ RPCHelpMan rescanblockchain()\n     uint256 start_block;\n \n     EnsureWalletIsUnlocked(*pwallet);\n+    LOCK(pwallet->m_relock_mutex);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1003662424",
      "id" : 1003662424,
      "line" : 878,
      "node_id" : "PRRC_kwDOABII58470qxY",
      "original_commit_id" : "b8952bd7d3b3f745109506223f829c5dd91e638f",
      "original_line" : 878,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/transactions.cpp",
      "position" : 4,
      "pull_request_review_id" : 1153640639,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1003662424/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-24T19:41:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1003662424",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1003683930"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1003683930"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In ad8d139d6237ffa556e90d2d87ec43c209c89dc9 \"test: test rescanning encrypted wallets\"\r\n\r\n10000 is running into the rpc timeout for me for the `importdescriptors` calls. I think this could be reduced to 4000. That seems to not hit the rpc timeout, but still consistently fails this test on master.",
      "commit_id" : "25b8736431677f9e24fc0bbf93a7f2fc1de55502",
      "created_at" : "2022-10-24T19:40:42Z",
      "diff_hunk" : "@@ -666,5 +666,28 @@ def run_test(self):\n                               success=True,\n                               warnings=[\"Unknown output type, cannot set descriptor to active.\"])\n \n+        self.log.info(\"Test importing a descriptor to an encrypted wallet\")\n+\n+        descriptor = {\"desc\": descsum_create(\"pkh(\" + xpriv + \"/1h/*h)\"),\n+                              \"timestamp\": \"now\",\n+                              \"active\": True,\n+                              \"range\": [0,10000],\n+                              \"next_index\": 10000}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1003683930",
      "id" : 1003683930,
      "line" : 675,
      "node_id" : "PRRC_kwDOABII58470wBa",
      "original_commit_id" : "25b8736431677f9e24fc0bbf93a7f2fc1de55502",
      "original_line" : 675,
      "original_position" : 10,
      "original_start_line" : 674,
      "path" : "test/functional/wallet_importdescriptors.py",
      "position" : 10,
      "pull_request_review_id" : 1153640639,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1003683930/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 674,
      "start_side" : "RIGHT",
      "updated_at" : "2022-10-24T19:41:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1003683930",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1003938284"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1003938284"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "How would using `LOCK2` work for grabbing `cs_wallet` and `m_relock_mutex` at the same time if the whole point of having `m_relock_mutex` is that we don't want to be holding `cs_wallet` during the time of the rescan since it can be time consuming?",
      "commit_id" : "25b8736431677f9e24fc0bbf93a7f2fc1de55502",
      "created_at" : "2022-10-25T02:32:04Z",
      "diff_hunk" : "@@ -875,6 +875,7 @@ RPCHelpMan rescanblockchain()\n     uint256 start_block;\n \n     EnsureWalletIsUnlocked(*pwallet);\n+    LOCK(pwallet->m_relock_mutex);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1003938284",
      "id" : 1003938284,
      "in_reply_to_id" : 1003662424,
      "line" : 878,
      "node_id" : "PRRC_kwDOABII58471uHs",
      "original_commit_id" : "b8952bd7d3b3f745109506223f829c5dd91e638f",
      "original_line" : 878,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/transactions.cpp",
      "position" : 4,
      "pull_request_review_id" : 1154044419,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1003938284/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-25T02:32:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1003938284",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/75942586?v=4",
         "events_url" : "https://api.github.com/users/ishaanam/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ishaanam/followers",
         "following_url" : "https://api.github.com/users/ishaanam/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ishaanam/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ishaanam",
         "id" : 75942586,
         "login" : "ishaanam",
         "node_id" : "MDQ6VXNlcjc1OTQyNTg2",
         "organizations_url" : "https://api.github.com/users/ishaanam/orgs",
         "received_events_url" : "https://api.github.com/users/ishaanam/received_events",
         "repos_url" : "https://api.github.com/users/ishaanam/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ishaanam/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ishaanam/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ishaanam"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1004878542"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004878542"
         }
      },
      "author_association" : "NONE",
      "body" : "10000 runs fine for me, but I agree with lowering it to 4000.",
      "commit_id" : "25b8736431677f9e24fc0bbf93a7f2fc1de55502",
      "created_at" : "2022-10-25T19:19:36Z",
      "diff_hunk" : "@@ -666,5 +666,28 @@ def run_test(self):\n                               success=True,\n                               warnings=[\"Unknown output type, cannot set descriptor to active.\"])\n \n+        self.log.info(\"Test importing a descriptor to an encrypted wallet\")\n+\n+        descriptor = {\"desc\": descsum_create(\"pkh(\" + xpriv + \"/1h/*h)\"),\n+                              \"timestamp\": \"now\",\n+                              \"active\": True,\n+                              \"range\": [0,10000],\n+                              \"next_index\": 10000}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1004878542",
      "id" : 1004878542,
      "in_reply_to_id" : 1003683930,
      "line" : 675,
      "node_id" : "PRRC_kwDOABII58475TrO",
      "original_commit_id" : "25b8736431677f9e24fc0bbf93a7f2fc1de55502",
      "original_line" : 675,
      "original_position" : 10,
      "original_start_line" : 674,
      "path" : "test/functional/wallet_importdescriptors.py",
      "position" : 10,
      "pull_request_review_id" : 1155372541,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004878542/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 674,
      "start_side" : "RIGHT",
      "updated_at" : "2022-10-25T19:31:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004878542",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/87907936?v=4",
         "events_url" : "https://api.github.com/users/hernanmarino/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hernanmarino/followers",
         "following_url" : "https://api.github.com/users/hernanmarino/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hernanmarino/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hernanmarino",
         "id" : 87907936,
         "login" : "hernanmarino",
         "node_id" : "MDQ6VXNlcjg3OTA3OTM2",
         "organizations_url" : "https://api.github.com/users/hernanmarino/orgs",
         "received_events_url" : "https://api.github.com/users/hernanmarino/received_events",
         "repos_url" : "https://api.github.com/users/hernanmarino/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hernanmarino/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hernanmarino/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hernanmarino"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1004879850"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004879850"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`LOCK2` only needs to be used in the places when both locks are being acquired, e.g. in `CWallet::Lock`.",
      "commit_id" : "25b8736431677f9e24fc0bbf93a7f2fc1de55502",
      "created_at" : "2022-10-25T19:21:10Z",
      "diff_hunk" : "@@ -875,6 +875,7 @@ RPCHelpMan rescanblockchain()\n     uint256 start_block;\n \n     EnsureWalletIsUnlocked(*pwallet);\n+    LOCK(pwallet->m_relock_mutex);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1004879850",
      "id" : 1004879850,
      "in_reply_to_id" : 1003662424,
      "line" : 878,
      "node_id" : "PRRC_kwDOABII58475T_q",
      "original_commit_id" : "b8952bd7d3b3f745109506223f829c5dd91e638f",
      "original_line" : 878,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/transactions.cpp",
      "position" : 4,
      "pull_request_review_id" : 1155374313,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004879850/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-25T19:21:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004879850",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1004887893"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004887893"
         }
      },
      "author_association" : "NONE",
      "body" : "I have some doubts about the proper location for grabbing the mutex, but I am not an expert in wallet code, some take my ideas with care. @achow101 's suggestion seems like a nice \"natural\" way to lock mutexes, and initially I agreed with it. But since this pr creates a new mutex, I see no conflict on grabbing it elsewhere, like here. Also I'm a little bit concerned that other calls to `CWallet::Lock` might unnecessarily lock this unrelated mutex, blocking execution.",
      "commit_id" : "25b8736431677f9e24fc0bbf93a7f2fc1de55502",
      "created_at" : "2022-10-25T19:31:08Z",
      "diff_hunk" : "@@ -90,6 +90,7 @@ RPCHelpMan walletpassphrase()\n     std::weak_ptr<CWallet> weak_wallet = wallet;\n     pwallet->chain().rpcRunLater(strprintf(\"lockwallet(%s)\", pwallet->GetName()), [weak_wallet, relock_time] {\n         if (auto shared_wallet = weak_wallet.lock()) {\n+            LOCK(shared_wallet->m_relock_mutex);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26347#discussion_r1004887893",
      "id" : 1004887893,
      "in_reply_to_id" : 1003661127,
      "line" : 93,
      "node_id" : "PRRC_kwDOABII58475V9V",
      "original_commit_id" : "b8952bd7d3b3f745109506223f829c5dd91e638f",
      "original_line" : 93,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/encrypt.cpp",
      "position" : 4,
      "pull_request_review_id" : 1155372541,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26347",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004887893/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-10-25T19:31:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1004887893",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/87907936?v=4",
         "events_url" : "https://api.github.com/users/hernanmarino/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hernanmarino/followers",
         "following_url" : "https://api.github.com/users/hernanmarino/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hernanmarino/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hernanmarino",
         "id" : 87907936,
         "login" : "hernanmarino",
         "node_id" : "MDQ6VXNlcjg3OTA3OTM2",
         "organizations_url" : "https://api.github.com/users/hernanmarino/orgs",
         "received_events_url" : "https://api.github.com/users/hernanmarino/received_events",
         "repos_url" : "https://api.github.com/users/hernanmarino/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hernanmarino/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hernanmarino/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hernanmarino"
      }
   }
]
