{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "The recently introduced `scanblocks` RPC uses BIP157 block filters for quickly determining which blocks contain a specified set of output scripts. By nature this can lead to false-positive results, i.e. the filter set matches the block filter even though none of the contained txs spend or create UTXOs with the specified set of scriptPubKeys.\r\n\r\nCan be reproduced on testnet with address `tb1qcxf2gv93c26s6mqz7y6etpqdf70zmn67dualgr` :\r\n\r\n```\r\n$ ./src/bitcoin-cli -testnet scanblocks start '[\"addr(tb1qcxf2gv93c26s6mqz7y6etpqdf70zmn67dualgr)\"]'\r\n{\r\n  \"from_height\": 0,\r\n  \"to_height\": 2375004,\r\n  \"relevant_blocks\": [\r\n    \"000000000001bc35077dec4104e0ab1f667ae27059bd907f9a8fac55c802ae36\",\r\n    \"00000000000120a9c50542d73248fb7c37640c252850f0cf273134ad9febaf61\",\r\n    \"0000000000000082f7af3835da8b6146b0bfb243b8842f09c495fa1e74d454ed\",\r\n    \"0000000000000094c32651728193bfbe91f6789683b8d6ac6ae2d22ebd3cb5d3\"\r\n  ],\r\n  \"completed\": true\r\n}\r\n```\r\n\r\nLooking closer at the first returned block 000000000001bc35077dec4104e0ab1f667ae27059bd907f9a8fac55c802ae36 (https://mempool.space/de/testnet/address/tb1qcxf2gv93c26s6mqz7y6etpqdf70zmn67dualgr), one can see that the contained single (coinbase) transaction is not related to the passed address:\r\n\r\n```\r\n$ ./src/bitcoin-cli -testnet getblock 000000000001bc35077dec4104e0ab1f667ae27059bd907f9a8fac55c802ae36 3\r\n...\r\n      \"vout\": [\r\n        {\r\n          \"value\": 12.50000000,\r\n          \"n\": 0,\r\n          \"scriptPubKey\": {\r\n            \"asm\": \"OP_DUP OP_HASH160 ad0050c5a24b9496e34e34410f35c735f66584ca OP_EQUALVERIFY OP_CHECKSIG\",\r\n            \"desc\": \"addr(mwHhaAQuafCYjJocy6qEzRg6sBLT6KCdaB)#shkcfhzk\",\r\n            \"hex\": \"76a914ad0050c5a24b9496e34e34410f35c735f66584ca88ac\",\r\n            \"address\": \"mwHhaAQuafCYjJocy6qEzRg6sBLT6KCdaB\",\r\n            \"type\": \"pubkeyhash\"\r\n          }\r\n        }\r\n      ],\r\n...\r\n```\r\n\r\nIt might make sense to introduce an option that actives a second pass phase in which the found\r\nblocks are inspected in order to filter out these false-positives.\r\n\r\nI guess it is debatable if this can really be considered a bug (in practice it shouldn't be a problem),\r\nbut at the very least we should mention the possibility of false-positives in the RPC help to not confuse users.",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 0,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26322/comments",
   "created_at" : "2022-10-15T18:16:28Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26322/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/26322",
   "id" : 1410249819,
   "labels" : [
      {
         "color" : "FBBAAB",
         "default" : false,
         "description" : null,
         "id" : 64585,
         "name" : "Bug",
         "node_id" : "MDU6TGFiZWw2NDU4NQ==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Bug"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26322/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "I_kwDOABII585UDrRb",
   "number" : 26322,
   "performed_via_github_app" : null,
   "reactions" : {
      "+1" : 1,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 1,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26322/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26322/timeline",
   "title" : "`scanblocks` RPC result includes false-positives",
   "updated_at" : "2022-10-15T19:02:06Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26322",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
      "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
      "followers_url" : "https://api.github.com/users/theStack/followers",
      "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
      "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/theStack",
      "id" : 91535,
      "login" : "theStack",
      "node_id" : "MDQ6VXNlcjkxNTM1",
      "organizations_url" : "https://api.github.com/users/theStack/orgs",
      "received_events_url" : "https://api.github.com/users/theStack/received_events",
      "repos_url" : "https://api.github.com/users/theStack/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/theStack"
   }
}
