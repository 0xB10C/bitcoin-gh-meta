[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Because of the refactoring this will conflict heavily with other changes to versionbits. I've rebased #21377 on top of this and there's a height based variant at #21392. I think it should be possible to adapt to cover the rest of #19573, but haven't tried. It would require some refactoring of the bip8 code in order to be able to catch bugs in the MUST_SIGNAL handling, but maybe that's worthwhile anyway.\r\n\r\nParticularly interested in additional checks that could be added, or better ways of converting fuzz data into interesting chains to test. I've just hardcoded the intervals at 10 minutes, and currently the BIP9 timeouts will precisely match some block's time, which could be missing edge cases? So far it seems pretty reasonable though.",
      "created_at" : "2021-03-07T12:46:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21380#issuecomment-792273605",
      "id" : 792273605,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MjI3MzYwNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-09T09:53:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/792273605",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21401 (Refactor versionbits deployments to avoid potential uninitialized variables by achow101)\n* #21399 (Genericide BIP9 in variable/type names and comments by luke-jr)\n* #21393 (BIP 341: Add Speedy Trial activation parameters by achow101)\n* #21392 (Implement BIP 8 based Speedy Trial activation by achow101)\n* #21391 ([Bundle 5/n] Prune g_chainman usage in RPC modules by dongcarl)\n* #21378 (Convert taproot to flag day activation by ajtowns)\n* #21142 (fuzz: Add tx_pool fuzz target by MarcoFalke)\n* #19438 (Introduce deploymentstatus by ajtowns)\n* #19259 (fuzz: Add fuzzing harness for LoadMempool(...) and DumpMempool(...) by practicalswift)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-03-07T17:25:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21380#issuecomment-792316498",
      "id" : 792316498,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MjMxNjQ5OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-10T04:59:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/792316498",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Particularly interested in additional checks that could be added\r\n\r\nMaybe some simple reorg testing, e.g. just invalidateblock around various thresholds to ensure we return to the previous state, then add a new block with a different timestamp to ensure we either advance or don't advance to the next state as is appropriate?",
      "created_at" : "2021-03-07T17:42:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21380#issuecomment-792321707",
      "id" : 792321707,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MjMyMTcwNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-07T17:42:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/792321707",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/61096?v=4",
         "events_url" : "https://api.github.com/users/harding/events{/privacy}",
         "followers_url" : "https://api.github.com/users/harding/followers",
         "following_url" : "https://api.github.com/users/harding/following{/other_user}",
         "gists_url" : "https://api.github.com/users/harding/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/harding",
         "id" : 61096,
         "login" : "harding",
         "node_id" : "MDQ6VXNlcjYxMDk2",
         "organizations_url" : "https://api.github.com/users/harding/orgs",
         "received_events_url" : "https://api.github.com/users/harding/received_events",
         "repos_url" : "https://api.github.com/users/harding/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/harding/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/harding/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/harding"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Strong Concept ACK\r\n\r\nVery excited to see the versionbits implementation more thoroughly fuzzed :)\r\n\r\nThanks!",
      "created_at" : "2021-03-07T18:34:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21380#issuecomment-792330157",
      "id" : 792330157,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MjMzMDE1Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-07T18:34:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/792330157",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Maybe some simple reorg testing, e.g. just invalidateblock around various thresholds to ensure we return to the previous state, then add a new block with a different timestamp to ensure we either advance or don't advance to the next state as is appropriate?\r\n\r\nThat would make sense if versionbits knew about tips or cached blocks based on height, but it caches based on block hash and just relies on being able to query ancestors of whatever `CBlockIndex*` is passed in. Neither the fuzz tester nor the existing unit test set up the scenario sufficiently for invalidateblock to work.",
      "created_at" : "2021-03-07T23:26:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21380#issuecomment-792373952",
      "id" : 792373952,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MjM3Mzk1Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-07T23:26:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/792373952",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code Review ACK 9c08af24e77980673efa30b5101451c3c8b20b1b\r\n\r\nThe cleanups to versionbits handling are nice. Skimmed over the fuzzer part, but did run it. It did catch a possible corner case in #21392.",
      "created_at" : "2021-03-09T04:23:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21380#issuecomment-793365701",
      "id" : 793365701,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MzM2NTcwMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-09T04:23:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/793365701",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 9c08af24e77980673efa30b5101451c3c8b20b1b\r\n\r\nI managed to run the fuzzer (on linux), but haven't studied it in much detail. We should probably improve it in followups, so the PR's that build on top of the refactoring commits here can continue without rebase headaches.",
      "created_at" : "2021-03-09T12:21:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21380#issuecomment-793807435",
      "id" : 793807435,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MzgwNzQzNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-09T12:21:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/793807435",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I am not sure if it is good to hide validation code refactoring in a \"Add fuzzing harness\" pull",
      "created_at" : "2021-03-12T09:29:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21380#issuecomment-797361955",
      "id" : 797361955,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5NzM2MTk1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-12T09:29:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/797361955",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I am not sure if it is good to hide validation code refactoring in a \"Add fuzzing harness\" pull\r\n\r\nIt's not mean to be hidden; the commits aren't subtle, it's called out in the description, and the labels are all there... The reason it's a single PR is that (I don't think) the fuzzer works without the refactoring, and without the fuzzer, there's not a lot of other tests to ensure the refactoring is correct...",
      "created_at" : "2021-03-12T21:40:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21380#issuecomment-797771240",
      "id" : 797771240,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5Nzc3MTI0MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-12T21:40:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/797771240",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Maybe the title could be changed to \"Refactor versionbits to add fuzzing harness\" or so?",
      "created_at" : "2021-03-13T07:44:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21380#issuecomment-797884708",
      "id" : 797884708,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5Nzg4NDcwOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-13T07:44:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/797884708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
