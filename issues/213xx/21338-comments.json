[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK\r\n\r\nI was thinking this should be a `p2p_` test rather than a `feature_` test but maybe you're right...\r\n\r\n",
      "created_at" : "2021-03-02T14:10:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#issuecomment-788935905",
      "id" : 788935905,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21338",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4ODkzNTkwNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-02T14:10:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788935905",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I added feature_anchors.py in BASE_SCRIPTS",
      "created_at" : "2021-03-02T14:54:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#issuecomment-788965587",
      "id" : 788965587,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21338",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4ODk2NTU4Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-02T14:54:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788965587",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "CI Tests are failing for two reasons so far:\r\n\r\n1. The following scripts are not being run: `['feature_anchors.py']`. Check the test lists in `test_runner.py`\r\n2. Some lint errors\r\n```\r\nfeature_anchors.py:31:1: W293 blank line contains whitespace\r\nfeature_anchors.py:77:25: W292 no newline at end of file\r\n```",
      "created_at" : "2021-03-02T14:54:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#issuecomment-788965917",
      "id" : 788965917,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21338",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4ODk2NTkxNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-02T14:54:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788965917",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7918067?v=4",
         "events_url" : "https://api.github.com/users/jaonoctus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jaonoctus/followers",
         "following_url" : "https://api.github.com/users/jaonoctus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jaonoctus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jaonoctus",
         "id" : 7918067,
         "login" : "jaonoctus",
         "node_id" : "MDQ6VXNlcjc5MTgwNjc=",
         "organizations_url" : "https://api.github.com/users/jaonoctus/orgs",
         "received_events_url" : "https://api.github.com/users/jaonoctus/received_events",
         "repos_url" : "https://api.github.com/users/jaonoctus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jaonoctus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jaonoctus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jaonoctus"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, @jaonoctus. Fixed!",
      "created_at" : "2021-03-02T14:57:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#issuecomment-788967916",
      "id" : 788967916,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21338",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4ODk2NzkxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-02T14:57:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788967916",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585649640"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585649640"
         }
      },
      "author_association" : "NONE",
      "body" : "```suggestion\r\n        for line in open(os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat'), 'rb', encoding='utf8'):\r\n```",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-02T15:14:06Z",
      "diff_hunk" : "@@ -0,0 +1,77 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.info(f\"block-relay-only: {i}\")\n+            self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=i, connection_type=\"block-relay-only\")\n+\n+        self.log.info(\"Add 5 inbound connections to node 0\")\n+        for i in range(5):\n+            self.log.info(f\"inbound: {i}\")\n+            self.nodes[0].add_p2p_connection(P2PInterface())\n+\n+        self.log.info(\"Check node 0 connections\")\n+        check_node_connections(node=self.nodes[0], num_in=5, num_out=2)\n+\n+        # 127.0.0.1\n+        ip = '7f000001'\n+\n+        # Since the ip is always 127.0.0.1 for this case, we store only the port to identify the peers\n+        block_relay_nodes_port = []\n+        inbound_nodes_port = []\n+        for p in self.nodes[0].getpeerinfo():\n+            addr_split = p['addr'].split(':')\n+            if p['connection_type'] == 'block-relay-only':\n+                block_relay_nodes_port.append(hex(int(addr_split[1]))[2:])\n+            else:\n+                inbound_nodes_port.append(hex(int(addr_split[1]))[2:])\n+\n+        self.log.info(\"Stop node 0\")\n+        self.stop_node(0)\n+\n+        self.log.info(\"Check anchors.dat file in the node directory\")\n+        assert os.path.exists(os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat'))\n+\n+        # It should contains only the block-relay-only addresses\n+        self.log.info(\"Check the addresses in anchors.dat\")\n+        for line in open(os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat'), 'rb'):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585649640",
      "id" : 585649640,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTY0OTY0MA==",
      "original_commit_id" : "13762cda77f5ec159cf0c722daa61951c69bf5f0",
      "original_line" : 61,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 601928729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585649640",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7918067?v=4",
         "events_url" : "https://api.github.com/users/jaonoctus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jaonoctus/followers",
         "following_url" : "https://api.github.com/users/jaonoctus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jaonoctus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jaonoctus",
         "id" : 7918067,
         "login" : "jaonoctus",
         "node_id" : "MDQ6VXNlcjc5MTgwNjc=",
         "organizations_url" : "https://api.github.com/users/jaonoctus/orgs",
         "received_events_url" : "https://api.github.com/users/jaonoctus/received_events",
         "repos_url" : "https://api.github.com/users/jaonoctus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jaonoctus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jaonoctus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jaonoctus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585680413"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585680413"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it won't work because it's binary mode.",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-02T15:48:12Z",
      "diff_hunk" : "@@ -0,0 +1,77 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.info(f\"block-relay-only: {i}\")\n+            self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=i, connection_type=\"block-relay-only\")\n+\n+        self.log.info(\"Add 5 inbound connections to node 0\")\n+        for i in range(5):\n+            self.log.info(f\"inbound: {i}\")\n+            self.nodes[0].add_p2p_connection(P2PInterface())\n+\n+        self.log.info(\"Check node 0 connections\")\n+        check_node_connections(node=self.nodes[0], num_in=5, num_out=2)\n+\n+        # 127.0.0.1\n+        ip = '7f000001'\n+\n+        # Since the ip is always 127.0.0.1 for this case, we store only the port to identify the peers\n+        block_relay_nodes_port = []\n+        inbound_nodes_port = []\n+        for p in self.nodes[0].getpeerinfo():\n+            addr_split = p['addr'].split(':')\n+            if p['connection_type'] == 'block-relay-only':\n+                block_relay_nodes_port.append(hex(int(addr_split[1]))[2:])\n+            else:\n+                inbound_nodes_port.append(hex(int(addr_split[1]))[2:])\n+\n+        self.log.info(\"Stop node 0\")\n+        self.stop_node(0)\n+\n+        self.log.info(\"Check anchors.dat file in the node directory\")\n+        assert os.path.exists(os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat'))\n+\n+        # It should contains only the block-relay-only addresses\n+        self.log.info(\"Check the addresses in anchors.dat\")\n+        for line in open(os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat'), 'rb'):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585680413",
      "id" : 585680413,
      "in_reply_to_id" : 585649640,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTY4MDQxMw==",
      "original_commit_id" : "13762cda77f5ec159cf0c722daa61951c69bf5f0",
      "original_line" : 61,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 601969547,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585680413",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585686937"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585686937"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Anyway, all of the linters must pass.",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-02T15:55:37Z",
      "diff_hunk" : "@@ -0,0 +1,77 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.info(f\"block-relay-only: {i}\")\n+            self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=i, connection_type=\"block-relay-only\")\n+\n+        self.log.info(\"Add 5 inbound connections to node 0\")\n+        for i in range(5):\n+            self.log.info(f\"inbound: {i}\")\n+            self.nodes[0].add_p2p_connection(P2PInterface())\n+\n+        self.log.info(\"Check node 0 connections\")\n+        check_node_connections(node=self.nodes[0], num_in=5, num_out=2)\n+\n+        # 127.0.0.1\n+        ip = '7f000001'\n+\n+        # Since the ip is always 127.0.0.1 for this case, we store only the port to identify the peers\n+        block_relay_nodes_port = []\n+        inbound_nodes_port = []\n+        for p in self.nodes[0].getpeerinfo():\n+            addr_split = p['addr'].split(':')\n+            if p['connection_type'] == 'block-relay-only':\n+                block_relay_nodes_port.append(hex(int(addr_split[1]))[2:])\n+            else:\n+                inbound_nodes_port.append(hex(int(addr_split[1]))[2:])\n+\n+        self.log.info(\"Stop node 0\")\n+        self.stop_node(0)\n+\n+        self.log.info(\"Check anchors.dat file in the node directory\")\n+        assert os.path.exists(os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat'))\n+\n+        # It should contains only the block-relay-only addresses\n+        self.log.info(\"Check the addresses in anchors.dat\")\n+        for line in open(os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat'), 'rb'):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585686937",
      "id" : 585686937,
      "in_reply_to_id" : 585649640,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTY4NjkzNw==",
      "original_commit_id" : "13762cda77f5ec159cf0c722daa61951c69bf5f0",
      "original_line" : 61,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 601978170,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585686937",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2021-03-02T15:55:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#issuecomment-789011205",
      "id" : 789011205,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21338",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4OTAxMTIwNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-02T15:55:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/789011205",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585758757"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585758757"
         }
      },
      "author_association" : "NONE",
      "body" : "Tested ACK. I'm pretty sure It's a false-flag.\r\n- OS: Ubuntu 20.10\r\n\r\n### Without `encoding` - passes\r\n![Screenshot from 2021-03-02 14-07-31](https://user-images.githubusercontent.com/7918067/109687248-d32e4080-7b61-11eb-86d5-0e73cb6de557.png)\r\n\r\n### With `encoding` - fail\r\n![Screenshot from 2021-03-02 14-15-21](https://user-images.githubusercontent.com/7918067/109687265-d6c1c780-7b61-11eb-89db-9e8c930ea052.png)\r\n\r\n---\r\n\r\nI also have checked other tests that are reading binaries. Such as [p2p_message_capture.py (line 37)](https://github.com/bitcoin/bitcoin/blob/b9f41df1ead4b6a83a51fc41966b111c8459c313/test/functional/p2p_message_capture.py#L37) or [rpc_dumptxoutset.py (line 40)](https://github.com/bitcoin/bitcoin/blob/b9f41df1ead4b6a83a51fc41966b111c8459c313/test/functional/rpc_dumptxoutset.py#L40). None have the encoding parameter, which makes sense.",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-02T17:20:45Z",
      "diff_hunk" : "@@ -0,0 +1,77 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.info(f\"block-relay-only: {i}\")\n+            self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=i, connection_type=\"block-relay-only\")\n+\n+        self.log.info(\"Add 5 inbound connections to node 0\")\n+        for i in range(5):\n+            self.log.info(f\"inbound: {i}\")\n+            self.nodes[0].add_p2p_connection(P2PInterface())\n+\n+        self.log.info(\"Check node 0 connections\")\n+        check_node_connections(node=self.nodes[0], num_in=5, num_out=2)\n+\n+        # 127.0.0.1\n+        ip = '7f000001'\n+\n+        # Since the ip is always 127.0.0.1 for this case, we store only the port to identify the peers\n+        block_relay_nodes_port = []\n+        inbound_nodes_port = []\n+        for p in self.nodes[0].getpeerinfo():\n+            addr_split = p['addr'].split(':')\n+            if p['connection_type'] == 'block-relay-only':\n+                block_relay_nodes_port.append(hex(int(addr_split[1]))[2:])\n+            else:\n+                inbound_nodes_port.append(hex(int(addr_split[1]))[2:])\n+\n+        self.log.info(\"Stop node 0\")\n+        self.stop_node(0)\n+\n+        self.log.info(\"Check anchors.dat file in the node directory\")\n+        assert os.path.exists(os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat'))\n+\n+        # It should contains only the block-relay-only addresses\n+        self.log.info(\"Check the addresses in anchors.dat\")\n+        for line in open(os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat'), 'rb'):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585758757",
      "id" : 585758757,
      "in_reply_to_id" : 585649640,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTc1ODc1Nw==",
      "original_commit_id" : "13762cda77f5ec159cf0c722daa61951c69bf5f0",
      "original_line" : 61,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 602072355,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585758757",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7918067?v=4",
         "events_url" : "https://api.github.com/users/jaonoctus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jaonoctus/followers",
         "following_url" : "https://api.github.com/users/jaonoctus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jaonoctus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jaonoctus",
         "id" : 7918067,
         "login" : "jaonoctus",
         "node_id" : "MDQ6VXNlcjc5MTgwNjc=",
         "organizations_url" : "https://api.github.com/users/jaonoctus/orgs",
         "received_events_url" : "https://api.github.com/users/jaonoctus/received_events",
         "repos_url" : "https://api.github.com/users/jaonoctus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jaonoctus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jaonoctus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jaonoctus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585828542"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585828542"
         }
      },
      "author_association" : "MEMBER",
      "body" : "could make the path a named variable to avoid repeating the join three times?",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-02T18:59:40Z",
      "diff_hunk" : "@@ -0,0 +1,77 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.info(f\"block-relay-only: {i}\")\n+            self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=i, connection_type=\"block-relay-only\")\n+\n+        self.log.info(\"Add 5 inbound connections to node 0\")\n+        for i in range(5):\n+            self.log.info(f\"inbound: {i}\")\n+            self.nodes[0].add_p2p_connection(P2PInterface())\n+\n+        self.log.info(\"Check node 0 connections\")\n+        check_node_connections(node=self.nodes[0], num_in=5, num_out=2)\n+\n+        # 127.0.0.1\n+        ip = '7f000001'\n+\n+        # Since the ip is always 127.0.0.1 for this case, we store only the port to identify the peers\n+        block_relay_nodes_port = []\n+        inbound_nodes_port = []\n+        for p in self.nodes[0].getpeerinfo():\n+            addr_split = p['addr'].split(':')\n+            if p['connection_type'] == 'block-relay-only':\n+                block_relay_nodes_port.append(hex(int(addr_split[1]))[2:])\n+            else:\n+                inbound_nodes_port.append(hex(int(addr_split[1]))[2:])\n+\n+        self.log.info(\"Stop node 0\")\n+        self.stop_node(0)\n+\n+        self.log.info(\"Check anchors.dat file in the node directory\")\n+        assert os.path.exists(os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat'))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585828542",
      "id" : 585828542,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTgyODU0Mg==",
      "original_commit_id" : "b1a5e04be46255937af1e29c5c229daaf60d709e",
      "original_line" : 57,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 602161668,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585828542",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585845419"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585845419"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, no problem! thanks!",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-02T19:26:38Z",
      "diff_hunk" : "@@ -0,0 +1,77 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.info(f\"block-relay-only: {i}\")\n+            self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=i, connection_type=\"block-relay-only\")\n+\n+        self.log.info(\"Add 5 inbound connections to node 0\")\n+        for i in range(5):\n+            self.log.info(f\"inbound: {i}\")\n+            self.nodes[0].add_p2p_connection(P2PInterface())\n+\n+        self.log.info(\"Check node 0 connections\")\n+        check_node_connections(node=self.nodes[0], num_in=5, num_out=2)\n+\n+        # 127.0.0.1\n+        ip = '7f000001'\n+\n+        # Since the ip is always 127.0.0.1 for this case, we store only the port to identify the peers\n+        block_relay_nodes_port = []\n+        inbound_nodes_port = []\n+        for p in self.nodes[0].getpeerinfo():\n+            addr_split = p['addr'].split(':')\n+            if p['connection_type'] == 'block-relay-only':\n+                block_relay_nodes_port.append(hex(int(addr_split[1]))[2:])\n+            else:\n+                inbound_nodes_port.append(hex(int(addr_split[1]))[2:])\n+\n+        self.log.info(\"Stop node 0\")\n+        self.stop_node(0)\n+\n+        self.log.info(\"Check anchors.dat file in the node directory\")\n+        assert os.path.exists(os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat'))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585845419",
      "id" : 585845419,
      "in_reply_to_id" : 585828542,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTg0NTQxOQ==",
      "original_commit_id" : "b1a5e04be46255937af1e29c5c229daaf60d709e",
      "original_line" : 57,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 602183720,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585845419",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585851030"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585851030"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done! ",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-02T19:35:12Z",
      "diff_hunk" : "@@ -0,0 +1,77 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.info(f\"block-relay-only: {i}\")\n+            self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=i, connection_type=\"block-relay-only\")\n+\n+        self.log.info(\"Add 5 inbound connections to node 0\")\n+        for i in range(5):\n+            self.log.info(f\"inbound: {i}\")\n+            self.nodes[0].add_p2p_connection(P2PInterface())\n+\n+        self.log.info(\"Check node 0 connections\")\n+        check_node_connections(node=self.nodes[0], num_in=5, num_out=2)\n+\n+        # 127.0.0.1\n+        ip = '7f000001'\n+\n+        # Since the ip is always 127.0.0.1 for this case, we store only the port to identify the peers\n+        block_relay_nodes_port = []\n+        inbound_nodes_port = []\n+        for p in self.nodes[0].getpeerinfo():\n+            addr_split = p['addr'].split(':')\n+            if p['connection_type'] == 'block-relay-only':\n+                block_relay_nodes_port.append(hex(int(addr_split[1]))[2:])\n+            else:\n+                inbound_nodes_port.append(hex(int(addr_split[1]))[2:])\n+\n+        self.log.info(\"Stop node 0\")\n+        self.stop_node(0)\n+\n+        self.log.info(\"Check anchors.dat file in the node directory\")\n+        assert os.path.exists(os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat'))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r585851030",
      "id" : 585851030,
      "in_reply_to_id" : 585828542,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NTg1MTAzMA==",
      "original_commit_id" : "b1a5e04be46255937af1e29c5c229daaf60d709e",
      "original_line" : 57,
      "original_position" : 57,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 602190985,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/585851030",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@leonardojobim Amazing review! I'm working on it at this moment! Thank you!",
      "created_at" : "2021-03-02T21:00:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#issuecomment-789212085",
      "id" : 789212085,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21338",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4OTIxMjA4NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-02T21:00:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/789212085",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@leonardojobim fixed! could you please test it again?",
      "created_at" : "2021-03-02T21:04:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#issuecomment-789214460",
      "id" : 789214460,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21338",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4OTIxNDQ2MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-02T21:04:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/789214460",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19521 (Coinstats Index by fjahr)\n* #18795 (Test: wallet issue with orphaned rewards by domob1812)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-03-02T21:31:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#issuecomment-789230281",
      "id" : 789230281,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21338",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4OTIzMDI4MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-02T21:31:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/789230281",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588877690"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588877690"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, per PEP8 and `test/functional/README.md`, this import should be before the framework ones (separated by a blank line)",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-06T12:40:38Z",
      "diff_hunk" : "@@ -0,0 +1,82 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588877690",
      "id" : 588877690,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODg3NzY5MA==",
      "original_commit_id" : "a83908f9f72ea2979a02ab051e1fc0846d0262af",
      "original_line" : 11,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 605754125,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588877690",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588877760"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588877760"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n            self.log.debug(f\"block-relay-only: {i}\")\r\n```",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-06T12:41:36Z",
      "diff_hunk" : "@@ -0,0 +1,82 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.info(f\"block-relay-only: {i}\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588877760",
      "id" : 588877760,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODg3Nzc2MA==",
      "original_commit_id" : "a83908f9f72ea2979a02ab051e1fc0846d0262af",
      "original_line" : 29,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 605754125,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588877760",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588877772"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588877772"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n            self.debug.info(f\"inbound: {i}\")\r\n```",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-06T12:41:52Z",
      "diff_hunk" : "@@ -0,0 +1,82 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.info(f\"block-relay-only: {i}\")\n+            self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=i, connection_type=\"block-relay-only\")\n+\n+        self.log.info(\"Add 5 inbound connections to node 0\")\n+        for i in range(5):\n+            self.log.info(f\"inbound: {i}\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588877772",
      "id" : 588877772,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODg3Nzc3Mg==",
      "original_commit_id" : "a83908f9f72ea2979a02ab051e1fc0846d0262af",
      "original_line" : 34,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 605754125,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588877772",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588878404"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588878404"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        # It should contain only the block-relay-only addresses\r\n```",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-06T12:47:59Z",
      "diff_hunk" : "@@ -0,0 +1,82 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.info(f\"block-relay-only: {i}\")\n+            self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=i, connection_type=\"block-relay-only\")\n+\n+        self.log.info(\"Add 5 inbound connections to node 0\")\n+        for i in range(5):\n+            self.log.info(f\"inbound: {i}\")\n+            self.nodes[0].add_p2p_connection(P2PInterface())\n+\n+        self.log.info(\"Check node 0 connections\")\n+        check_node_connections(node=self.nodes[0], num_in=5, num_out=2)\n+\n+        # 127.0.0.1\n+        ip = '7f000001'\n+\n+        # Since the ip is always 127.0.0.1 for this case, we store only the port to identify the peers\n+        block_relay_nodes_port = []\n+        inbound_nodes_port = []\n+        for p in self.nodes[0].getpeerinfo():\n+            addr_split = p['addr'].split(':')\n+            if p['connection_type'] == 'block-relay-only':\n+                block_relay_nodes_port.append(hex(int(addr_split[1]))[2:])\n+            else:\n+                inbound_nodes_port.append(hex(int(addr_split[1]))[2:])\n+\n+        self.log.info(\"Stop node 0\")\n+        self.stop_node(0)\n+\n+        node0_anchors_path = os.path.join(self.nodes[0].datadir + '/regtest', 'anchors.dat')\n+\n+        self.log.info(\"Check anchors.dat file in the node directory\")\n+        assert os.path.exists(node0_anchors_path)\n+\n+        # It should contains only the block-relay-only addresses",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588878404",
      "id" : 588878404,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODg3ODQwNA==",
      "original_commit_id" : "a83908f9f72ea2979a02ab051e1fc0846d0262af",
      "original_line" : 61,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 605754125,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588878404",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588878990"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588878990"
         }
      },
      "author_association" : "MEMBER",
      "body" : "https://www.python.org/dev/peps/pep-0008/#imports\r\n\r\nImports should be grouped in the following order:\r\n\r\n-   Standard library imports.\r\n-    Related third party imports.\r\n-    Local application/library specific imports.\r\n\r\nYou should put a blank line between each group of imports.",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-06T12:54:02Z",
      "diff_hunk" : "@@ -0,0 +1,82 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588878990",
      "id" : 588878990,
      "in_reply_to_id" : 588877690,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODg3ODk5MA==",
      "original_commit_id" : "a83908f9f72ea2979a02ab051e1fc0846d0262af",
      "original_line" : 11,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 605754932,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588878990",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588881992"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588881992"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, just fixed! ",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-06T13:24:05Z",
      "diff_hunk" : "@@ -0,0 +1,82 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588881992",
      "id" : 588881992,
      "in_reply_to_id" : 588877690,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODg4MTk5Mg==",
      "original_commit_id" : "a83908f9f72ea2979a02ab051e1fc0846d0262af",
      "original_line" : 11,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 605756637,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588881992",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588883189"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588883189"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just changed it, it's better _debug_ instead of _info_ for this case.",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-06T13:35:46Z",
      "diff_hunk" : "@@ -0,0 +1,82 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.info(f\"block-relay-only: {i}\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588883189",
      "id" : 588883189,
      "in_reply_to_id" : 588877760,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODg4MzE4OQ==",
      "original_commit_id" : "a83908f9f72ea2979a02ab051e1fc0846d0262af",
      "original_line" : 29,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 605757303,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:39:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588883189",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588883796"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588883796"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just changed it, but the right format is `self.log.debug` as you suggested above I guess.",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-06T13:42:08Z",
      "diff_hunk" : "@@ -0,0 +1,82 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+import os\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.info(f\"block-relay-only: {i}\")\n+            self.nodes[0].add_outbound_p2p_connection(P2PInterface(), p2p_idx=i, connection_type=\"block-relay-only\")\n+\n+        self.log.info(\"Add 5 inbound connections to node 0\")\n+        for i in range(5):\n+            self.log.info(f\"inbound: {i}\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r588883796",
      "id" : 588883796,
      "in_reply_to_id" : 588877772,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4ODg4Mzc5Ng==",
      "original_commit_id" : "a83908f9f72ea2979a02ab051e1fc0846d0262af",
      "original_line" : 34,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : null,
      "pull_request_review_id" : 605757668,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-06T13:42:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/588883796",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the review @jonatack. Just pushed some fixes!",
      "created_at" : "2021-03-06T13:43:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#issuecomment-791944309",
      "id" : 791944309,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21338",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MTk0NDMwOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-06T13:43:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/791944309",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r589098479"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589098479"
         }
      },
      "author_association" : "NONE",
      "body" : "Hello Bruno. I think we should concatenate regtest sub directory using the os.path.join() function instead of using + \"/regtest\" (just to avoid assuming the test is running in a Unix based OS).\r\n` node0_anchors_path = os.path.join(\r\n            self.nodes[0].datadir, \"regtest\", \"anchors.dat\"\r\n)`",
      "commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "created_at" : "2021-03-07T22:29:28Z",
      "diff_hunk" : "@@ -0,0 +1,88 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test Anchors functionality\"\"\"\n+\n+import os\n+\n+from test_framework.p2p import P2PInterface\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+\n+def check_node_connections(*, node, num_in, num_out):\n+    info = node.getnetworkinfo()\n+    assert_equal(info[\"connections_in\"], num_in)\n+    assert_equal(info[\"connections_out\"], num_out)\n+\n+\n+class AnchorsTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_network(self):\n+        self.setup_nodes()\n+\n+    def run_test(self):\n+        self.log.info(\"Add 2 block-relay-only connections to node 0\")\n+        for i in range(2):\n+            self.log.debug(f\"block-relay-only: {i}\")\n+            self.nodes[0].add_outbound_p2p_connection(\n+                P2PInterface(), p2p_idx=i, connection_type=\"block-relay-only\"\n+            )\n+\n+        self.log.info(\"Add 5 inbound connections to node 0\")\n+        for i in range(5):\n+            self.log.debug(f\"inbound: {i}\")\n+            self.nodes[0].add_p2p_connection(P2PInterface())\n+\n+        self.log.info(\"Check node 0 connections\")\n+        check_node_connections(node=self.nodes[0], num_in=5, num_out=2)\n+\n+        # 127.0.0.1\n+        ip = \"7f000001\"\n+\n+        # Since the ip is always 127.0.0.1 for this case, we store only the port to identify the peers\n+        block_relay_nodes_port = []\n+        inbound_nodes_port = []\n+        for p in self.nodes[0].getpeerinfo():\n+            addr_split = p[\"addr\"].split(\":\")\n+            if p[\"connection_type\"] == \"block-relay-only\":\n+                block_relay_nodes_port.append(hex(int(addr_split[1]))[2:])\n+            else:\n+                inbound_nodes_port.append(hex(int(addr_split[1]))[2:])\n+\n+        self.log.info(\"Stop node 0\")\n+        self.stop_node(0)\n+\n+        node0_anchors_path = os.path.join(\n+            self.nodes[0].datadir + \"/regtest\", \"anchors.dat\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21338#discussion_r589098479",
      "id" : 589098479,
      "line" : 60,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4OTA5ODQ3OQ==",
      "original_commit_id" : "9ef15a0af225fe0e8de94864f7b4e92c6f84bdc4",
      "original_line" : 60,
      "original_position" : 60,
      "original_start_line" : null,
      "path" : "test/functional/feature_anchors.py",
      "position" : 60,
      "pull_request_review_id" : 605892332,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21338",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-07T22:30:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/589098479",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/30988000?v=4",
         "events_url" : "https://api.github.com/users/aarmoa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aarmoa/followers",
         "following_url" : "https://api.github.com/users/aarmoa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aarmoa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aarmoa",
         "id" : 30988000,
         "login" : "aarmoa",
         "node_id" : "MDQ6VXNlcjMwOTg4MDAw",
         "organizations_url" : "https://api.github.com/users/aarmoa/orgs",
         "received_events_url" : "https://api.github.com/users/aarmoa/received_events",
         "repos_url" : "https://api.github.com/users/aarmoa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aarmoa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aarmoa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aarmoa"
      }
   }
]
