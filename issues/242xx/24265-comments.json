[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Also it became possible to re-enable Windows tests which were disabled in #20744. So this PR, apparently, is an alternative to the #24251.\r\n\r\nThis all sounds good. IMO, it would be good to merge #24251 before this PR. #24251 has two very simple fixes for the regressions caused by #20744 yesterday. This PR should be trivial to rebase if #24251 is merged first, and should become a little simpler, too.",
      "created_at" : "2022-02-04T21:25:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24265#issuecomment-1030361159",
      "id" : 1030361159,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24265",
      "node_id" : "IC_kwDOABII5849ahBH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1030361159/reactions"
      },
      "updated_at" : "2022-02-04T21:25:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1030361159",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24265#discussion_r799827698"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24265"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/799827698"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"util: Add ArgsManager::GetNormalPath() function\" (034f12a115e21b4205b532a3f946b129e83505d9)\r\n\r\nMinor: Would vote for calling this `GetPathArg` to be consistent with `GetIntArg` `GetBoolArg`, instead of `GetNormalPath`",
      "commit_id" : "e69ab379283af554d60c484d5715112b887fa0c3",
      "created_at" : "2022-02-04T21:39:54Z",
      "diff_hunk" : "@@ -264,6 +264,16 @@ class ArgsManager\n      */\n     std::optional<const Command> GetCommand() const;\n \n+    /**\n+     * Get a normalized path from a specified pathlike argument\n+     *\n+     * It is guaranteed that the returned path has no trailing slashes.\n+     *\n+     * @param pathlike_arg Pathlike argument to get a path from (e.g., \"-datadir\", \"-blocksdir\" or \"-walletdir\")\n+     * @return Normalized path which is get from a specified pathlike argument\n+     */\n+    fs::path GetNormalPath(std::string pathlike_arg) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24265#discussion_r799827698",
      "id" : 799827698,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vrGby",
      "original_commit_id" : "034f12a115e21b4205b532a3f946b129e83505d9",
      "original_line" : 275,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/util/system.h",
      "position" : null,
      "pull_request_review_id" : 873599636,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24265",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/799827698/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-04T21:48:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/799827698",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24265#discussion_r799831115"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24265"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/799831115"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"util: Add ArgsManager::GetNormalPath() function\" (034f12a115e21b4205b532a3f946b129e83505d9)\r\n\r\nI think previous approach which avoids direct string manipulation and avoids assuming \"/\" is a path separator is a little cleaner. Would suggest something like:\r\n\r\n```c++\r\nfs::path result = fs::PathFromString(path_str).lexically_normal(); // Collapse slashes and dots\r\nreturn result.has_filename() ? result : result.parent_path(); // Remove trailing slash, if present\r\n```\r\n\r\nAlso it would be great to write a simple unit test for this new function.",
      "commit_id" : "e69ab379283af554d60c484d5715112b887fa0c3",
      "created_at" : "2022-02-04T21:46:24Z",
      "diff_hunk" : "@@ -399,6 +399,15 @@ std::optional<unsigned int> ArgsManager::GetArgFlags(const std::string& name) co\n     return std::nullopt;\n }\n \n+fs::path ArgsManager::GetNormalPath(std::string pathlike_arg) const\n+{\n+    const std::string path_str{GetArg(pathlike_arg, \"\")};\n+    if (path_str.empty()) return {};\n+    // Adding a slash followed by parent_path() call\n+    // guaranties no trailing slashes in the resulted path.\n+    return fs::PathFromString(path_str + \"/\").lexically_normal().parent_path();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24265#discussion_r799831115",
      "id" : 799831115,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vrHRL",
      "original_commit_id" : "034f12a115e21b4205b532a3f946b129e83505d9",
      "original_line" : 408,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/util/system.cpp",
      "position" : null,
      "pull_request_review_id" : 873599636,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24265",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/799831115/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-04T21:48:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/799831115",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ryanofsky \r\n\r\nThanks for your suggestions! Most of them are implemented.\r\n\r\n> Also it would be great to write a simple unit test for this new function.\r\n\r\nWill add in the morning :)",
      "created_at" : "2022-02-04T22:35:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24265#issuecomment-1030404670",
      "id" : 1030404670,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24265",
      "node_id" : "IC_kwDOABII5849aro-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1030404670/reactions"
      },
      "updated_at" : "2022-02-04T22:35:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1030404670",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24265#discussion_r799859388"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24265"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/799859388"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks! [Done](https://github.com/bitcoin/bitcoin/pull/24265#issuecomment-1030404670).",
      "commit_id" : "e69ab379283af554d60c484d5715112b887fa0c3",
      "created_at" : "2022-02-04T22:36:39Z",
      "diff_hunk" : "@@ -264,6 +264,16 @@ class ArgsManager\n      */\n     std::optional<const Command> GetCommand() const;\n \n+    /**\n+     * Get a normalized path from a specified pathlike argument\n+     *\n+     * It is guaranteed that the returned path has no trailing slashes.\n+     *\n+     * @param pathlike_arg Pathlike argument to get a path from (e.g., \"-datadir\", \"-blocksdir\" or \"-walletdir\")\n+     * @return Normalized path which is get from a specified pathlike argument\n+     */\n+    fs::path GetNormalPath(std::string pathlike_arg) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24265#discussion_r799859388",
      "id" : 799859388,
      "in_reply_to_id" : 799827698,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vrOK8",
      "original_commit_id" : "034f12a115e21b4205b532a3f946b129e83505d9",
      "original_line" : 275,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/util/system.h",
      "position" : null,
      "pull_request_review_id" : 873647710,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24265",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/799859388/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-04T22:36:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/799859388",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> This all sounds good. IMO, it would be good to merge https://github.com/bitcoin/bitcoin/pull/24251 before this PR.\r\n\r\nI agree, we'll merge #24251 first. Maybe rebase on top?",
      "created_at" : "2022-02-05T03:01:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24265#issuecomment-1030508503",
      "id" : 1030508503,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24265",
      "node_id" : "IC_kwDOABII5849bE_X",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1030508503/reactions"
      },
      "updated_at" : "2022-02-05T03:01:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1030508503",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
