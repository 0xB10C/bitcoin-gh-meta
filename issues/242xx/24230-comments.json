[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-02-01T17:54:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1027125114",
      "id" : 1027125114,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24230",
      "node_id" : "IC_kwDOABII5849OK96",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027125114/reactions"
      },
      "updated_at" : "2022-02-01T17:54:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027125114",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased 8d8cdcb37005030f646ba3c45f7f54f556efb8bf -> 1fcfc73ba4e8180a8667868529774ab7b302ab5d ([`pr/indexy.1`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.1) -> [`pr/indexy.2`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.2), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.1-rebase..pr/indexy.2)) due to conflict with #22932. Also fixed some bugs in the last commit ð\r\n",
      "created_at" : "2022-02-01T21:47:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1027319018",
      "id" : 1027319018,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24230",
      "node_id" : "IC_kwDOABII5849O6Tq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027319018/reactions"
      },
      "updated_at" : "2022-02-01T21:47:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027319018",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#24273](https://github.com/bitcoin/bitcoin/pull/24273) (p2p: Split network logging into two categories #24247 by anshu-khare-design)\n* [#24150](https://github.com/bitcoin/bitcoin/pull/24150) (refactor: move index class members from protected to private by jonatack)\n* [#24138](https://github.com/bitcoin/bitcoin/pull/24138) (index: Commit MuHash and best block together for coinstatsindex by mzumsande)\n* [#24117](https://github.com/bitcoin/bitcoin/pull/24117) (index: make indices robust against init aborts by mzumsande)\n* [#23997](https://github.com/bitcoin/bitcoin/pull/23997) (wallet: avoid rescans under assumed-valid blocks by jamesob)\n* [#22485](https://github.com/bitcoin/bitcoin/pull/22485) (index: doc/log BaseIndex sync behavior with empty datadir by jamesob)\n* [#21726](https://github.com/bitcoin/bitcoin/pull/21726) (Improve Indices on pruned nodes via prune blockers by fjahr)\n* [#19888](https://github.com/bitcoin/bitcoin/pull/19888) (rpc, test: Improve getblockstats for unspendables by fjahr)\n* [#15606](https://github.com/bitcoin/bitcoin/pull/15606) (assumeutxo by jamesob)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-02-02T04:02:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1027553252",
      "id" : 1027553252,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24230",
      "node_id" : "IC_kwDOABII5849Pzfk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027553252/reactions"
      },
      "updated_at" : "2022-02-05T22:05:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027553252",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated 1fcfc73ba4e8180a8667868529774ab7b302ab5d -> c5be433bf3f1a2b5b96cbe00608eff24136e6f51 ([`pr/indexy.2`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.2) -> [`pr/indexy.3`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.3), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.2..pr/indexy.3)) fixing asan error https://cirrus-ci.com/task/5137882733084672 and lint error https://cirrus-ci.com/task/5208251477262336. Did not look into tsan failure https://cirrus-ci.com/task/4574932779663360 and multiprocess blockfilter_index_tests segfault https://cirrus-ci.com/task/4856407756374016, but I think they may be addressed by the asan fix",
      "created_at" : "2022-02-02T20:55:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1028349864",
      "id" : 1028349864,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24230",
      "node_id" : "IC_kwDOABII5849S1-o",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1028349864/reactions"
      },
      "updated_at" : "2022-02-02T20:55:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1028349864",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated c5be433bf3f1a2b5b96cbe00608eff24136e6f51 -> 3ab1ebeff4328dc1a456a3323d8a41f0200d7be2 ([`pr/indexy.3`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.3) -> [`pr/indexy.4`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.4), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.3..pr/indexy.4)) fixing `blockfilter_index_initial_sync` crash that I could not produce locally but I believe was causing CI failures https://cirrus-ci.com/task/6670649857933312, https://cirrus-ci.com/task/5755856183623680, and https://cirrus-ci.com/task/4981799997669376",
      "created_at" : "2022-02-03T22:39:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1029467943",
      "id" : 1029467943,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24230",
      "node_id" : "IC_kwDOABII5849XG8n",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1029467943/reactions"
      },
      "updated_at" : "2022-02-03T22:39:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1029467943",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801627743"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801627743"
         }
      },
      "author_association" : "MEMBER",
      "body" : "dc4675ddaca8d0d1d40847191cb21ccd116a6a3c : why bother with a pointer here? To make it consistent with `phashBlock` in `CBlockIndex`? I assume it's not just to shave 31 bytes of the `BlockInfo` size?",
      "commit_id" : "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "created_at" : "2022-02-08T13:26:37Z",
      "diff_hunk" : "@@ -67,6 +68,20 @@ class FoundBlock\n     mutable bool found = false;\n };\n \n+//! Block data sent with blockConnected, blockDisconnected notifications.\n+struct BlockInfo {\n+    const uint256& hash;\n+    const uint256* prev_hash = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801627743",
      "id" : 801627743,
      "line" : 83,
      "node_id" : "PRRC_kwDOABII584vx95f",
      "original_commit_id" : "dc4675ddaca8d0d1d40847191cb21ccd116a6a3c",
      "original_line" : 83,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/interfaces/chain.h",
      "position" : 43,
      "pull_request_review_id" : 876022016,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801627743/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-08T15:31:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801627743",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801653113"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801653113"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ae26ae5d3a1d32ce212d66477b71a5ac03354338: you're using `context()` here, but `src/interfaces/chain.h` suggests that should only be done in a test. Does this need a TODO? Is this resolved in one of the followup PRs?",
      "commit_id" : "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "created_at" : "2022-02-08T13:52:54Z",
      "diff_hunk" : "@@ -345,9 +350,9 @@ void BaseIndex::Interrupt()\n     m_interrupt();\n }\n \n-bool BaseIndex::Start(CChainState& active_chainstate)\n+bool BaseIndex::Start()\n {\n-    m_chainstate = &active_chainstate;\n+    m_chainstate = &m_chain->context()->chainman->ActiveChainstate();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801653113",
      "id" : 801653113,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vyEF5",
      "original_commit_id" : "ae26ae5d3a1d32ce212d66477b71a5ac03354338",
      "original_line" : 355,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/index/base.cpp",
      "position" : null,
      "pull_request_review_id" : 876022016,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801653113/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-08T15:31:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801653113",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801675097"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801675097"
         }
      },
      "author_association" : "MEMBER",
      "body" : "515a1dbce29078a1e90dc3f97bf25b309face9bb: this might warrant a TODO (or note in the commit message) that this `CBlockIndex` is going away in a later commit.",
      "commit_id" : "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "created_at" : "2022-02-08T14:14:33Z",
      "diff_hunk" : "@@ -209,22 +210,23 @@ size_t BlockFilterIndex::WriteFilterToDisk(FlatFilePos& pos, const BlockFilter&\n     return data_size;\n }\n \n-bool BlockFilterIndex::WriteBlock(const CBlock& block, const CBlockIndex* pindex)\n+bool BlockFilterIndex::CustomAppend(const interfaces::BlockInfo& block)\n {\n     CBlockUndo block_undo;\n     uint256 prev_header;\n \n-    if (pindex->nHeight > 0) {\n+    if (block.height > 0) {\n+        const CBlockIndex* pindex = WITH_LOCK(cs_main, return m_chainstate->m_blockman.LookupBlockIndex(block.hash));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801675097",
      "id" : 801675097,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vyJdZ",
      "original_commit_id" : "515a1dbce29078a1e90dc3f97bf25b309face9bb",
      "original_line" : 219,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/index/blockfilterindex.cpp",
      "position" : null,
      "pull_request_review_id" : 876022016,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801675097/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-08T15:31:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801675097",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801691396"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801691396"
         }
      },
      "author_association" : "MEMBER",
      "body" : "15398b1677362f4d98ffc786f1ae9976ad595ea8: comment above needs update",
      "commit_id" : "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "created_at" : "2022-02-08T14:29:51Z",
      "diff_hunk" : "@@ -28,7 +30,7 @@ struct IndexSummary {\n  * CValidationInterface and ensures blocks are indexed sequentially according\n  * to their position in the active chain.\n  */\n-class BaseIndex : public CValidationInterface",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801691396",
      "id" : 801691396,
      "line" : 27,
      "node_id" : "PRRC_kwDOABII584vyNcE",
      "original_commit_id" : "15398b1677362f4d98ffc786f1ae9976ad595ea8",
      "original_line" : 27,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/index/base.h",
      "position" : 30,
      "pull_request_review_id" : 876022016,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801691396/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-08T15:31:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801691396",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801711644"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801711644"
         }
      },
      "author_association" : "MEMBER",
      "body" : "15398b1677362f4d98ffc786f1ae9976ad595ea8 nit: \"and reindex\" (I haven't checked if re-index nukes all the indexes, or if it leaves them alone until the previous best block is reached again)",
      "commit_id" : "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "created_at" : "2022-02-08T14:46:41Z",
      "diff_hunk" : "@@ -81,6 +81,8 @@ struct BlockInfo {\n     unsigned undo_pos = 0;\n     const CBlock* data = nullptr;\n     const CBlockUndo* undo_data = nullptr;\n+    //! Block is from the tip of the chain (always true except during initial sync)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801711644",
      "id" : 801711644,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vySYc",
      "original_commit_id" : "15398b1677362f4d98ffc786f1ae9976ad595ea8",
      "original_line" : 84,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/interfaces/chain.h",
      "position" : null,
      "pull_request_review_id" : 876022016,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801711644/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-08T15:31:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801711644",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801842132"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801842132"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801627743\r\n\r\n> [dc4675d](https://github.com/bitcoin/bitcoin/commit/dc4675ddaca8d0d1d40847191cb21ccd116a6a3c) : why bother with a pointer here? To make it consistent with `phashBlock` in `CBlockIndex`? I assume it's not just to shave 31 bytes of the `BlockInfo` size?\r\n\r\nYes, hash is a reference and prev_hash is a pointer to minimize copying and make the struct small. C++ doesn't provide named arguments, so I'm defining the struct as a substitute for named arguments, to make block connected and disconnected declarations more readable and the argument list easier to change in the future.\r\n\r\nThe field types are the same as the argument types that would be used otherwise. `const uint256& hash` could be replaced by `uint256 hash`, and  `const uint256* prev_hash` could be `std::optional<uint256>`, and `const CBlock*` could be `shared_ptr<CBlock>`, but the various block connected and disconnected method implementations don't benefit from getting copies instead of references, or optional instead of pointers, or smart pointers instead of plain pointers, so I'm opting for the cheapest and simplest passing style in each case.",
      "commit_id" : "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "created_at" : "2022-02-08T16:45:22Z",
      "diff_hunk" : "@@ -67,6 +68,20 @@ class FoundBlock\n     mutable bool found = false;\n };\n \n+//! Block data sent with blockConnected, blockDisconnected notifications.\n+struct BlockInfo {\n+    const uint256& hash;\n+    const uint256* prev_hash = nullptr;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801842132",
      "id" : 801842132,
      "in_reply_to_id" : 801627743,
      "line" : 83,
      "node_id" : "PRRC_kwDOABII584vyyPU",
      "original_commit_id" : "dc4675ddaca8d0d1d40847191cb21ccd116a6a3c",
      "original_line" : 83,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/interfaces/chain.h",
      "position" : 43,
      "pull_request_review_id" : 876331979,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801842132/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T01:10:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801842132",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801912127"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801912127"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801653113\r\n\r\n> [ae26ae5](https://github.com/bitcoin/bitcoin/commit/ae26ae5d3a1d32ce212d66477b71a5ac03354338): you're using `context()` here, but `src/interfaces/chain.h` suggests that should only be done in a test. Does this need a TODO? Is this resolved in one of the followup PRs?\r\n\r\nGood catch. Now removed this in the last commit and added comment about it being temporary",
      "commit_id" : "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "created_at" : "2022-02-08T17:56:52Z",
      "diff_hunk" : "@@ -345,9 +350,9 @@ void BaseIndex::Interrupt()\n     m_interrupt();\n }\n \n-bool BaseIndex::Start(CChainState& active_chainstate)\n+bool BaseIndex::Start()\n {\n-    m_chainstate = &active_chainstate;\n+    m_chainstate = &m_chain->context()->chainman->ActiveChainstate();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801912127",
      "id" : 801912127,
      "in_reply_to_id" : 801653113,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vzDU_",
      "original_commit_id" : "ae26ae5d3a1d32ce212d66477b71a5ac03354338",
      "original_line" : 355,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/index/base.cpp",
      "position" : null,
      "pull_request_review_id" : 876331979,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801912127/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T01:10:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801912127",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801912871"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801912871"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801675097\r\n\r\n> [515a1db](https://github.com/bitcoin/bitcoin/commit/515a1dbce29078a1e90dc3f97bf25b309face9bb): this might warrant a TODO (or note in the commit message) that this `CBlockIndex` is going away in a later commit.\r\n\r\nGood suggestion, added comments to clarify",
      "commit_id" : "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "created_at" : "2022-02-08T17:57:40Z",
      "diff_hunk" : "@@ -209,22 +210,23 @@ size_t BlockFilterIndex::WriteFilterToDisk(FlatFilePos& pos, const BlockFilter&\n     return data_size;\n }\n \n-bool BlockFilterIndex::WriteBlock(const CBlock& block, const CBlockIndex* pindex)\n+bool BlockFilterIndex::CustomAppend(const interfaces::BlockInfo& block)\n {\n     CBlockUndo block_undo;\n     uint256 prev_header;\n \n-    if (pindex->nHeight > 0) {\n+    if (block.height > 0) {\n+        const CBlockIndex* pindex = WITH_LOCK(cs_main, return m_chainstate->m_blockman.LookupBlockIndex(block.hash));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801912871",
      "id" : 801912871,
      "in_reply_to_id" : 801675097,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vzDgn",
      "original_commit_id" : "515a1dbce29078a1e90dc3f97bf25b309face9bb",
      "original_line" : 219,
      "original_position" : 20,
      "original_start_line" : null,
      "path" : "src/index/blockfilterindex.cpp",
      "position" : null,
      "pull_request_review_id" : 876331979,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801912871/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T01:10:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801912871",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801913300"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801913300"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801691396\r\n\r\n> [15398b1](https://github.com/bitcoin/bitcoin/commit/15398b1677362f4d98ffc786f1ae9976ad595ea8): comment above needs update\r\n\r\nGood catch, updated",
      "commit_id" : "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "created_at" : "2022-02-08T17:58:12Z",
      "diff_hunk" : "@@ -28,7 +30,7 @@ struct IndexSummary {\n  * CValidationInterface and ensures blocks are indexed sequentially according\n  * to their position in the active chain.\n  */\n-class BaseIndex : public CValidationInterface",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801913300",
      "id" : 801913300,
      "in_reply_to_id" : 801691396,
      "line" : 27,
      "node_id" : "PRRC_kwDOABII584vzDnU",
      "original_commit_id" : "15398b1677362f4d98ffc786f1ae9976ad595ea8",
      "original_line" : 27,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/index/base.h",
      "position" : 30,
      "pull_request_review_id" : 876331979,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801913300/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T01:10:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801913300",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801913814"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801913814"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801711644\r\n\r\n> [15398b1](https://github.com/bitcoin/bitcoin/commit/15398b1677362f4d98ffc786f1ae9976ad595ea8) nit: \"and reindex\" (I haven't checked if re-index nukes all the indexes, or if it leaves them alone until the previous best block is reached again)\r\n\r\nRephrased the comment to avoid the word sync. This isn't referring to IBD or reindexing globally. It's just referring to notifications from the attachChain / ThreadSync code that runs when the index is loaded. For example if we added an RPC method to start and stop indexes. `chain_tip` would be false for the blocks read after the index was first started, until the sync thread caught up. This would be independent of whether node itself was syncing to the network.",
      "commit_id" : "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "created_at" : "2022-02-08T17:58:47Z",
      "diff_hunk" : "@@ -81,6 +81,8 @@ struct BlockInfo {\n     unsigned undo_pos = 0;\n     const CBlock* data = nullptr;\n     const CBlockUndo* undo_data = nullptr;\n+    //! Block is from the tip of the chain (always true except during initial sync)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r801913814",
      "id" : 801913814,
      "in_reply_to_id" : 801711644,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vzDvW",
      "original_commit_id" : "15398b1677362f4d98ffc786f1ae9976ad595ea8",
      "original_line" : 84,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/interfaces/chain.h",
      "position" : null,
      "pull_request_review_id" : 876331979,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801913814/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T01:10:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/801913814",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the review!",
      "created_at" : "2022-02-09T01:10:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1033225564",
      "id" : 1033225564,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24230",
      "node_id" : "IC_kwDOABII5849lcVc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1033225564/reactions"
      },
      "updated_at" : "2022-02-09T01:10:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1033225564",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Updated d27072d58207b2648d8f1bf273389aee86db3001 -> 2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5 ([`pr/indexy.5`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.5) -> [`pr/indexy.6`](https://github.com/ryanofsky/bitcoin/commits/pr/indexy.6), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/indexy.5..pr/indexy.6)) to fix ubsan error https://cirrus-ci.com/task/5606579763412992?logs=ci#L4848",
      "created_at" : "2022-02-09T03:33:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1033309727",
      "id" : 1033309727,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24230",
      "node_id" : "IC_kwDOABII5849lw4f",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1033309727/reactions"
      },
      "updated_at" : "2022-02-09T03:33:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1033309727",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r802668917"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802668917"
         }
      },
      "author_association" : "MEMBER",
      "body" : "11310351345e844ae22f9bc00bed00eff7197500 : this constraint of `BLOCK_HAVE_DATA | BLOCK_HAVE_UNDO` makes sense in the context of indexes, because an index is updated after a block is connected, at which point it will always have undo data. But if we ever need it in other places, it seems a bit odd. Maybe add a comment? Alternatively maybe we should just add `nStatus` or bools for the individual flags we care about? ",
      "commit_id" : "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "created_at" : "2022-02-09T13:37:52Z",
      "diff_hunk" : "@@ -0,0 +1,24 @@\n+// Copyright (c) 2022 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <chain.h>\n+#include <interfaces/chain.h>\n+#include <uint256.h>\n+\n+namespace node {\n+interfaces::BlockInfo MakeBlockInfo(const CBlockIndex* index, const CBlock* data)\n+{\n+    interfaces::BlockInfo info{index ? *index->phashBlock : uint256::ZERO};\n+    if (index) {\n+        info.prev_hash = index->pprev ? index->pprev->phashBlock : nullptr;\n+        info.height = index->nHeight;\n+        LOCK(::cs_main);\n+        info.file_number = index->nStatus & (BLOCK_HAVE_DATA | BLOCK_HAVE_UNDO) ? index->nFile : -1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r802668917",
      "id" : 802668917,
      "line" : 22,
      "node_id" : "PRRC_kwDOABII584v18F1",
      "original_commit_id" : "11310351345e844ae22f9bc00bed00eff7197500",
      "original_line" : 17,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/node/chain.cpp",
      "position" : 17,
      "pull_request_review_id" : 877470452,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802668917/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T14:19:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802668917",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r802678422"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802678422"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ade3f4306bba6e40197d645774097c78a5e0681a: this is a nice addition, e.g. `block->hash` is more readable than before when `block` would be a hash.",
      "commit_id" : "2acbc24a0ebcb2dc9f73f5a18964e796507e8ab5",
      "created_at" : "2022-02-09T13:48:02Z",
      "diff_hunk" : "@@ -38,6 +38,12 @@ namespace interfaces {\n class Handler;\n class Wallet;\n \n+//! Hash/height pair to help track and identify blocks.\n+struct BlockKey {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#discussion_r802678422",
      "id" : 802678422,
      "line" : 42,
      "node_id" : "PRRC_kwDOABII584v1-aW",
      "original_commit_id" : "ade3f4306bba6e40197d645774097c78a5e0681a",
      "original_line" : 42,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/interfaces/chain.h",
      "position" : 5,
      "pull_request_review_id" : 877470452,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24230",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802678422/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T14:19:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802678422",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I did review with `--color-moved=dimmed_zebra`, though without `dimmed_zebra` it's slightly more clear and a bigger monitor helps too.\r\n\r\nIt helped to notice that `Init()` is only called from `Start()`. The first four lines that set `locator` are just moved.\r\n\r\nThe two lines after that, which obtain the lock and set `active_chain` are turned into a new function `checkBlocks()` which is called from another new function `attachChain()`.  The end of the original `Init()` function comes back in that the only way `attachChain` can return null is with a prune violation. The middle part is more complicated.\r\n\r\nOne job of `Init()` was to set `m_best_block_index` and `m_synced`. That task has been moved to `blockConnected()`, which is called once by `attachChain()`. That part is a bit hard to follow, though it does look right. Part of the problem is that you need to understand the original logic. \r\n\r\nOnce those two are set, it continue on to find a prune violation. That part is a clear move to `checkBlocks`.\r\n\r\nYou might be able to introduce `checkBlocks()` in a commit before this. If wouldn't make things simpler, but the diff would be more focussed on the boiler plate changes.\r\n\r\n> I wonder if there is something specific which is confusing about this commit, or if you just don't like the boilerplate it adds?\r\n\r\nI'm probably fine with the end result; we'll see when I get to later commits, but I'm not worried about that. It's indeed the change itself that's a bit confusing.",
      "created_at" : "2022-02-10T10:38:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24230#issuecomment-1034759315",
      "id" : 1034759315,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24230",
      "node_id" : "IC_kwDOABII5849rSyT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1034759315/reactions"
      },
      "updated_at" : "2022-02-10T10:38:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1034759315",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
