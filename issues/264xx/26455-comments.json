[
   {
      "author_association" : "NONE",
      "body" : "also getting similar internal errors for the past few days. MacOS DiskUtility doesn't report any problems. No other apps are having file IO issues. Tried v24.0.0rc3 and same issue. Able to check blocks for a few minutes then crashes. I recently updated to Ventura but don't know enough to decide if they changed something which would cause this. Let me know if you need more info.\r\n\r\n\r\nCrashed Thread:        0  Dispatch queue: com.apple.main-thread\r\n\r\nException Type:        EXC_BAD_ACCESS (SIGSEGV)\r\nException Codes:       KERN_INVALID_ADDRESS at 0x0100000100000012 -> 0x0000000100000012 (possible pointer authentication failure)\r\nException Codes:       0x0000000000000001, 0x0100000100000012\r\n\r\nTermination Reason:    Namespace SIGNAL, Code 11 Segmentation fault: 11\r\nTerminating Process:   exc handler [37021]\r\n\r\nVM Region Info: 0x100000012 is not in any region.  Bytes before following region: 15368174\r\n      REGION TYPE                    START - END         [ VSIZE] PRT/MAX SHRMOD  REGION DETAIL\r\n      UNUSED SPACE AT START\r\n--->  \r\n      __TEXT                      100ea8000-10282c000    [ 25.5M] r-x/r-x SM=COW  ...OS/Bitcoin-Qt\r\n\r\nKernel Triage:\r\nVM - pmap_enter retried due to resource shortage\r\nVM - pmap_enter retried due to resource shortage",
      "created_at" : "2022-11-06T01:07:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26455#issuecomment-1304685375",
      "id" : 1304685375,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26455",
      "node_id" : "IC_kwDOABII585Nw-s_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1304685375/reactions"
      },
      "updated_at" : "2022-11-06T01:10:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1304685375",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/910676?v=4",
         "events_url" : "https://api.github.com/users/brl4n/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brl4n/followers",
         "following_url" : "https://api.github.com/users/brl4n/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brl4n/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brl4n",
         "id" : 910676,
         "login" : "brl4n",
         "node_id" : "MDQ6VXNlcjkxMDY3Ng==",
         "organizations_url" : "https://api.github.com/users/brl4n/orgs",
         "received_events_url" : "https://api.github.com/users/brl4n/received_events",
         "repos_url" : "https://api.github.com/users/brl4n/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brl4n/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brl4n/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brl4n"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Update on the issue. The current Bitcoin Core software, V0.22 & V0.23, are not working well with the new Mac Software update 13.0 Ventura. I went back to the previous version, Monterey 12.6, and the software works just fine. How can i help to make the new bitcoin core version, V0.24, more compatible with Mac? Thank you!",
      "created_at" : "2022-11-12T00:55:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26455#issuecomment-1312293061",
      "id" : 1312293061,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26455",
      "node_id" : "IC_kwDOABII585OOADF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1312293061/reactions"
      },
      "updated_at" : "2022-11-12T00:55:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1312293061",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/117485255?v=4",
         "events_url" : "https://api.github.com/users/aureliusltd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureliusltd/followers",
         "following_url" : "https://api.github.com/users/aureliusltd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureliusltd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureliusltd",
         "id" : 117485255,
         "login" : "aureliusltd",
         "node_id" : "U_kgDOBwCuxw",
         "organizations_url" : "https://api.github.com/users/aureliusltd/orgs",
         "received_events_url" : "https://api.github.com/users/aureliusltd/received_events",
         "repos_url" : "https://api.github.com/users/aureliusltd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureliusltd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureliusltd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureliusltd"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Update on the issue. The current Bitcoin Core software, V0.22 & V0.23, are not working well with the new Mac Software update 13.0 Ventura.\r\n\r\nLooks similar to #26400.\r\n\r\nhttps://github.com/bitcoin/bitcoin/issues/26400#issuecomment-1294866176:\r\n\r\n> Using external drives is not a configuration which is extensively tested and guaranteed to work in all circumstances. For example, https://github.com/bitcoin/bitcoin/issues/26397#issuecomment-1292300303.\r\n>\r\n> Please try to reproduce the issue while using local drives only. You could use pruning to limit block storage space.",
      "created_at" : "2022-11-12T10:33:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26455#issuecomment-1312449689",
      "id" : 1312449689,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26455",
      "node_id" : "IC_kwDOABII585OOmSZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1312449689/reactions"
      },
      "updated_at" : "2022-11-12T10:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1312449689",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> The current Bitcoin Core software, V0.22 & V0.23, are not working well with the new Mac Software update 13.0 Ventura. I went back to the previous version, Monterey 12.6, and the software works just fine.\r\n\r\nI've updated the issue title.",
      "created_at" : "2022-11-18T15:12:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26455#issuecomment-1320158147",
      "id" : 1320158147,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26455",
      "node_id" : "IC_kwDOABII585OsAPD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1320158147/reactions"
      },
      "updated_at" : "2022-11-18T15:12:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1320158147",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@aureliusltd @mateusgalasso\r\n\r\nWhat are filesystems on your external drives?",
      "created_at" : "2022-11-18T15:35:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26455#issuecomment-1320186787",
      "id" : 1320186787,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26455",
      "node_id" : "IC_kwDOABII585OsHOj",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1320186787/reactions"
      },
      "updated_at" : "2022-11-18T15:35:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1320186787",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> @aureliusltd @mateusgalasso\r\n> \r\n> What are filesystems on your external drives?\r\n\r\nExFAT",
      "created_at" : "2022-11-18T17:20:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26455#issuecomment-1320309813",
      "id" : 1320309813,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26455",
      "node_id" : "IC_kwDOABII585OslQ1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1320309813/reactions"
      },
      "updated_at" : "2022-11-18T17:20:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1320309813",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3990028?v=4",
         "events_url" : "https://api.github.com/users/mateusgalasso/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mateusgalasso/followers",
         "following_url" : "https://api.github.com/users/mateusgalasso/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mateusgalasso/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mateusgalasso",
         "id" : 3990028,
         "login" : "mateusgalasso",
         "node_id" : "MDQ6VXNlcjM5OTAwMjg=",
         "organizations_url" : "https://api.github.com/users/mateusgalasso/orgs",
         "received_events_url" : "https://api.github.com/users/mateusgalasso/received_events",
         "repos_url" : "https://api.github.com/users/mateusgalasso/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mateusgalasso/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mateusgalasso/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mateusgalasso"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It looks like other projects ([LevelDB](https://github.com/google/leveldb/commit/296de8d5b8e4e57bd1e46c981114dfbe58a8c4fa), [SQLite](https://sqlite.org/src/file?name=src/os_unix.c&ci=5c669f5f399fe899#:~:text=If%20the%20FULLFSYNC%20failed%2C%20fall%20back%20to%20attempting%20an%20fsync()), etc.) have had similar issues with `fcntl` using `F_FULLFSYNC`. Apparently there are certain external drives / filesystems that don't support it, so they return an error. I can only speculate why it seems to be only showing up on macOS Ventura. \r\n\r\nThose projects have all used the same strategy: fallback to `fsync` on error (see previous links or this [helpful twitter thread](https://twitter.com/TigerBeetleDB/status/1422855270716293123)). It seems like the error is specifically `ENOTTY` in this case, so we could check for that and try `fsync`.\r\n\r\nI've created a branch that does that. Happy to submit as a PR if this approach seems sound.\r\n\r\nhttps://github.com/john-moffett/bitcoin/blob/d99a8bee66656d29017b42fb2c0935de768ccd70/src/util/system.cpp#L1187-L1200",
      "created_at" : "2022-11-18T19:21:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26455#issuecomment-1320435665",
      "id" : 1320435665,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26455",
      "node_id" : "IC_kwDOABII585OtD_R",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1320435665/reactions"
      },
      "updated_at" : "2022-11-18T19:21:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1320435665",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/116917595?v=4",
         "events_url" : "https://api.github.com/users/john-moffett/events{/privacy}",
         "followers_url" : "https://api.github.com/users/john-moffett/followers",
         "following_url" : "https://api.github.com/users/john-moffett/following{/other_user}",
         "gists_url" : "https://api.github.com/users/john-moffett/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/john-moffett",
         "id" : 116917595,
         "login" : "john-moffett",
         "node_id" : "U_kgDOBvgFWw",
         "organizations_url" : "https://api.github.com/users/john-moffett/orgs",
         "received_events_url" : "https://api.github.com/users/john-moffett/received_events",
         "repos_url" : "https://api.github.com/users/john-moffett/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/john-moffett/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/john-moffett/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/john-moffett"
      }
   }
]
