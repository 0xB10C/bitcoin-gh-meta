[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26486#discussion_r1020066568"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26486"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1020066568"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can you explain why it is safe to change the order of responses? From a first impression, I think it is possible that a peer sends us a `getdata` [1], then a `ping`, then they would receive the `pong` first, and then the `notfound`, no? Previously they should be in order.\r\n\r\nIf this is safe to change, it might be good to explain. Also, then it would be better to move this out of the cs_main scope here, because the lock is not needed.\r\n\r\nIf it is not safe to change, I guess you can just move the send to the process function?\r\n\r\n[1] This should happen intermittently whenever there is `fPauseSend` backpressure, or you can force it deterministically by sending an unknown getdata type.",
      "commit_id" : "ad393c2d130b593b671b66e6a84c244664c3fd4c",
      "created_at" : "2022-11-11T10:01:50Z",
      "diff_hunk" : "@@ -5820,10 +5830,14 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n                 m_txrequest.ForgetTxHash(gtxid.GetHash());\n             }\n         }\n-\n-\n         if (!vGetData.empty())\n             m_connman.PushMessage(pto, msgMaker.Make(NetMsgType::GETDATA, vGetData));\n+\n+        // Message: notfound\n+        if (!peer->m_notfounds_to_send.empty()) {\n+            m_connman.PushMessage(pto, msgMaker.Make(NetMsgType::NOTFOUND, peer->m_notfounds_to_send));\n+            peer->m_notfounds_to_send.clear();\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26486#discussion_r1020066568",
      "id" : 1020066568,
      "line" : 5840,
      "node_id" : "PRRC_kwDOABII5848zPsI",
      "original_commit_id" : "ad393c2d130b593b671b66e6a84c244664c3fd4c",
      "original_line" : 5840,
      "original_position" : 123,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : 123,
      "pull_request_review_id" : 1177114470,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26486",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1020066568/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-11T10:01:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1020066568",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26140](https://github.com/bitcoin/bitcoin/pull/26140) (refactor: Move CNodeState members guarded by g_msgproc_mutex to Peer by dergoegge)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-11-11T23:59:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26486#issuecomment-1312274035",
      "id" : 1312274035,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26486",
      "node_id" : "IC_kwDOABII585ON7Zz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1312274035/reactions"
      },
      "updated_at" : "2022-11-11T23:59:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1312274035",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
