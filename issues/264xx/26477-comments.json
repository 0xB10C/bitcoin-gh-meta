[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26477#discussion_r1018311287"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26477"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1018311287"
         }
      },
      "author_association" : "MEMBER",
      "body" : "All this churn here is because of the mypy linter. I tried `assert isinstance(timeout, float)` and `assert timeout is not None` to no avail.",
      "commit_id" : "b3a7afcd28c73bf8163c5e26e8b31cb62945adab",
      "created_at" : "2022-11-09T19:01:06Z",
      "diff_hunk" : "@@ -255,11 +255,12 @@ def wait_until_helper(predicate, *, attempts=float('inf'), timeout=float('inf'),\n     properly scaled. Furthermore, `wait_until()` from `P2PInterface` class in\n     `p2p.py` has a preset lock.\n     \"\"\"\n-    if attempts == float('inf') and timeout == float('inf'):\n-        timeout = 60\n-    timeout = timeout * timeout_factor\n+    timeout_float = float(timeout if timeout is not None else 'inf')\n+    if attempts == float('inf') and timeout_float == float('inf'):\n+        timeout_float = 60\n+    timeout_float = timeout_float * timeout_factor",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26477#discussion_r1018311287",
      "id" : 1018311287,
      "line" : 261,
      "node_id" : "PRRC_kwDOABII5848sjJ3",
      "original_commit_id" : "b3a7afcd28c73bf8163c5e26e8b31cb62945adab",
      "original_line" : 261,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/util.py",
      "position" : 19,
      "pull_request_review_id" : 1174597566,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26477",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1018311287/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-09T19:01:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1018311287",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> As for the fix, this reminds me a bit of https://github.com/bitcoin/bitcoin/commit/290ff5ef6d3886409e5e8688f7d28a4c8246c617, so I think what should really be done is some kind of saturating parser.\r\n\r\nThis sounds less simple and immediately accessible than the one-line fix here. \r\n\r\nRight now master is broken; for usages that worked prior to https://github.com/bitcoin/bitcoin/commit/faf44876db555f7488c8df96db9fa88b793f897c, bitcoind now crashes. IMO the priority should be addressing that and then moving on to less immediate issues, like what the aesthetically preferable fix should be.\r\n\r\nI agree with you that probably some more substantial change is needed to avoid similar issues in the future, but this change is probably the simplest thing that could be done to unbreak master, and it introduces test coverage.\r\n\r\nIn the spirit of forward progress (and not having a broken master!), I would recommend that either we merge this as-is or you propose an alternative in short order, because I have other stuff to do in the immediate term besides rethink integer parsing across the codebase, and I'd like to e.g. be able to rebase assumeutxo on master and test it without crashing.",
      "created_at" : "2022-11-10T13:38:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26477#issuecomment-1310294416",
      "id" : 1310294416,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26477",
      "node_id" : "IC_kwDOABII585OGYGQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1310294416/reactions"
      },
      "updated_at" : "2022-11-10T13:38:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1310294416",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26477#discussion_r1019633252"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26477"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019633252"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why not simply use `Now<NodeSeconds>()`, which does the same in less code?",
      "commit_id" : "b3a7afcd28c73bf8163c5e26e8b31cb62945adab",
      "created_at" : "2022-11-10T21:34:42Z",
      "diff_hunk" : "@@ -1541,7 +1541,8 @@ bool Chainstate::IsInitialBlockDownload() const\n     if (m_chain.Tip()->nChainWork < m_chainman.MinimumChainWork()) {\n         return true;\n     }\n-    if (m_chain.Tip()->Time() < NodeClock::now() - m_chainman.m_options.max_tip_age) {\n+    if (m_chain.Tip()->Time() <\n+            std::chrono::time_point_cast<std::chrono::seconds>(NodeClock::now()) - m_chainman.m_options.max_tip_age) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26477#discussion_r1019633252",
      "id" : 1019633252,
      "line" : 1545,
      "node_id" : "PRRC_kwDOABII5848xl5k",
      "original_commit_id" : "b3a7afcd28c73bf8163c5e26e8b31cb62945adab",
      "original_line" : 1545,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 6,
      "pull_request_review_id" : 1176524669,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26477",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019633252/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-10T21:37:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019633252",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26477#discussion_r1019634013"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26477"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019634013"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can you explain why this is changed? If you locally want to change the timeout, you can use `--timeout-factor`. Changing it in the code may result in CI sanitizer timeouts.",
      "commit_id" : "b3a7afcd28c73bf8163c5e26e8b31cb62945adab",
      "created_at" : "2022-11-10T21:35:45Z",
      "diff_hunk" : "@@ -22,23 +22,24 @@ def set_test_params(self):\n         self.setup_clean_chain = True\n         self.num_nodes = 2\n \n-    def test_maxtipage(self, maxtipage, set_parameter=True):\n+    def test_maxtipage(self, maxtipage, set_parameter=True, test_deltas=True):\n         node_miner = self.nodes[0]\n         node_ibd = self.nodes[1]\n \n         self.restart_node(1, [f'-maxtipage={maxtipage}'] if set_parameter else None)\n-        self.connect_nodes(0, 1)\n-\n-        # tips older than maximum age -> stay in IBD\n+        self.connect_nodes(0, 1, timeout=5)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26477#discussion_r1019634013",
      "id" : 1019634013,
      "line" : 30,
      "node_id" : "PRRC_kwDOABII5848xmFd",
      "original_commit_id" : "b3a7afcd28c73bf8163c5e26e8b31cb62945adab",
      "original_line" : 30,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "test/functional/feature_maxtipage.py",
      "position" : 13,
      "pull_request_review_id" : 1176524669,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26477",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019634013/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-10T21:37:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019634013",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26477#discussion_r1019634851"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26477"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019634851"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is printing a value that went out of scope (maybe we should use rust to write tests?)\r\n\r\nAlso, the value is not the max, as claimed here.\r\n\r\nYou can take commit 0d3b7631af03ecc4d6b9e56a74ac2abfe8977291, where I fixed this.",
      "commit_id" : "b3a7afcd28c73bf8163c5e26e8b31cb62945adab",
      "created_at" : "2022-11-10T21:36:58Z",
      "diff_hunk" : "@@ -51,6 +52,9 @@ def run_test(self):\n             self.log.info(f\"Test IBD with maximum tip age of {hours} hours (-maxtipage={maxtipage}).\")\n             self.test_maxtipage(maxtipage)\n \n+        self.log.info(f\"Test IBD with max. allowable maximum tip age ({maxtipage}).\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26477#discussion_r1019634851",
      "id" : 1019634851,
      "line" : 55,
      "node_id" : "PRRC_kwDOABII5848xmSj",
      "original_commit_id" : "b3a7afcd28c73bf8163c5e26e8b31cb62945adab",
      "original_line" : 55,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "test/functional/feature_maxtipage.py",
      "position" : 39,
      "pull_request_review_id" : 1176524669,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26477",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019634851/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-10T21:37:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1019634851",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "For reference, I tried to fix the overflow via ccccee014f8dae70f760c9ce3ab8a5db73aa446a, but this only fixes it for large values, not small ones. The pull here also fixes it only for large ones, which is fine, because underflow was the behaviour previously as well.",
      "created_at" : "2022-11-11T09:07:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26477#issuecomment-1311423361",
      "id" : 1311423361,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26477",
      "node_id" : "IC_kwDOABII585OKruB",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311423361/reactions"
      },
      "updated_at" : "2022-11-11T09:07:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1311423361",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
