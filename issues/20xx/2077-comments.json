[
   {
      "body" : "This is a known side effect of the new database layout in v0.8. There is no global transaction index anyone, only one for unspent transactions, since that is all that is needed for normal operation. The intention is to add a full index, but make it optional for people who need getrawtransaction for any transaction.",
      "created_at" : "2012-12-05T20:17:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2077#issuecomment-11058578",
      "id" : 11058578,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2077",
      "updated_at" : "2012-12-05T20:17:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11058578",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Oh, I did not know that, but it obviously makes perfect sense when using the client as a wallet. I am using this particular instance as a transaction and block sniffer and as such need to have all the transaction data.\r\n\r\nI assume that, since I don't have anything on this instance's wallet, as wallets get broadcasted all spent transactions are trimmed away from the db, which should be a simple thing to prevent? I'll look at the code as soon as I have a moment, but any pointers are obviously welcome.",
      "created_at" : "2012-12-05T20:22:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2077#issuecomment-11058774",
      "id" : 11058774,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2077",
      "updated_at" : "2012-12-05T20:22:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11058774",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1436304?v=3",
         "events_url" : "https://api.github.com/users/nelisky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/nelisky/followers",
         "following_url" : "https://api.github.com/users/nelisky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/nelisky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/nelisky",
         "id" : 1436304,
         "login" : "nelisky",
         "organizations_url" : "https://api.github.com/users/nelisky/orgs",
         "received_events_url" : "https://api.github.com/users/nelisky/received_events",
         "repos_url" : "https://api.github.com/users/nelisky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/nelisky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/nelisky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/nelisky"
      }
   },
   {
      "body" : "It has nothing to do with wallets - the block validation system and the wallet system are quite separate. Wallets keep whatever information they need themselves.\r\n\r\nIt's just how the new validation engine is designed: there is never need for more information than unspent transactions outputs, so that is the only piece of data that is kept. Changing this would break it.\r\n\r\nHowever, we still have all full blocks around on disk. All that is needed is adding an extra database with a transaction index like we used to have, which is only used for getrawtransaction.",
      "created_at" : "2012-12-05T20:52:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2077#issuecomment-11059961",
      "id" : 11059961,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2077",
      "updated_at" : "2012-12-05T20:52:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11059961",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Ok, so when parsing and validating a block the client does what it needs to do and then stores the unspent transactions for validating future blocks only, and when these are marked as spent they get removed from the database. Is this correct?\r\n\r\nNot removing spent transactions would break the validation engine because it is assuming all transactions in the db have unspent outputs? My initial thought was that if the spent transactions weren't removed from the db, it would be the simplest solution to my needs but that would imply them being properly marked as spent or not for the validation engine, of course.",
      "created_at" : "2012-12-05T21:01:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2077#issuecomment-11060269",
      "id" : 11060269,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2077",
      "updated_at" : "2012-12-05T21:01:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11060269",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1436304?v=3",
         "events_url" : "https://api.github.com/users/nelisky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/nelisky/followers",
         "following_url" : "https://api.github.com/users/nelisky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/nelisky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/nelisky",
         "id" : 1436304,
         "login" : "nelisky",
         "organizations_url" : "https://api.github.com/users/nelisky/orgs",
         "received_events_url" : "https://api.github.com/users/nelisky/received_events",
         "repos_url" : "https://api.github.com/users/nelisky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/nelisky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/nelisky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/nelisky"
      }
   },
   {
      "body" : "There is currently *NO* transaction index at all. The fact that getrawtransaction works, is because we can use the UTXO database to find (for unspent transaction) the confirmations of the transaction, calculate which height that corresponds to, search the block index for the disk location of the block at that height, read that entire block from disk, and look for the transaction you wanted in it. This is not fast, and doesn't work well at all, but it works a bit. However, this database was never designed to do this well. The only thing it is good at is verifying transactions very quickly.\r\n\r\nIf you need the ability to look up transactions in the block chain, the only real solution is an index. I really prefer not to mess with the UTXO database to be able to deal with such queries in a bad way.",
      "created_at" : "2012-12-05T21:15:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2077#issuecomment-11060888",
      "id" : 11060888,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2077",
      "updated_at" : "2012-12-05T21:15:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11060888",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Fair enough, thanks for all the explaining. I might get my hands dirty on the transaction index, but I'm well served with 0.7.1 for now, just wanted to get some testing on the development version.",
      "created_at" : "2012-12-05T21:19:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2077#issuecomment-11061011",
      "id" : 11061011,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2077",
      "updated_at" : "2012-12-05T21:19:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11061011",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1436304?v=3",
         "events_url" : "https://api.github.com/users/nelisky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/nelisky/followers",
         "following_url" : "https://api.github.com/users/nelisky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/nelisky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/nelisky",
         "id" : 1436304,
         "login" : "nelisky",
         "organizations_url" : "https://api.github.com/users/nelisky/orgs",
         "received_events_url" : "https://api.github.com/users/nelisky/received_events",
         "repos_url" : "https://api.github.com/users/nelisky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/nelisky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/nelisky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/nelisky"
      }
   },
   {
      "body" : "How about another approach for getting the raw transactions through the API when the block is known to the client:\r\n\r\nAdd third optional \"blockhash\" parameter to \"getrawtransaction\". The parameter could be used to specify the block which is used to look up the raw transaction.\r\n\r\nOr alternatively: Introduce optional \"verbose\" bool flag to \"getblock\", which would output all the included transactions in full instead of just their IDs.\r\n\r\nWhat do you think? This would work without the additional index. Which approach would be better?",
      "created_at" : "2013-03-08T22:46:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2077#issuecomment-14650653",
      "id" : 14650653,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2077",
      "updated_at" : "2013-03-08T22:47:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/14650653",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/867559?v=3",
         "events_url" : "https://api.github.com/users/snabb/events{/privacy}",
         "followers_url" : "https://api.github.com/users/snabb/followers",
         "following_url" : "https://api.github.com/users/snabb/following{/other_user}",
         "gists_url" : "https://api.github.com/users/snabb/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/snabb",
         "id" : 867559,
         "login" : "snabb",
         "organizations_url" : "https://api.github.com/users/snabb/orgs",
         "received_events_url" : "https://api.github.com/users/snabb/received_events",
         "repos_url" : "https://api.github.com/users/snabb/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/snabb/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/snabb/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/snabb"
      }
   },
   {
      "body" : "Hi! \r\nBlockhash parameter on getrawtransaction is good help for any transaction inspector.\r\nRegards!",
      "created_at" : "2013-03-27T10:11:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2077#issuecomment-15515059",
      "id" : 15515059,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2077",
      "updated_at" : "2013-03-27T10:11:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15515059",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/155036?v=3",
         "events_url" : "https://api.github.com/users/silvioq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/silvioq/followers",
         "following_url" : "https://api.github.com/users/silvioq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/silvioq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/silvioq",
         "id" : 155036,
         "login" : "silvioq",
         "organizations_url" : "https://api.github.com/users/silvioq/orgs",
         "received_events_url" : "https://api.github.com/users/silvioq/received_events",
         "repos_url" : "https://api.github.com/users/silvioq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/silvioq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/silvioq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/silvioq"
      }
   },
   {
      "body" : "Hi!\r\nI generated a commit usefull for me. I sent a pull request https://github.com/bitcoin/bitcoin/pull/2421\r\nRegards!",
      "created_at" : "2013-03-29T01:50:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/2077#issuecomment-15625349",
      "id" : 15625349,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/2077",
      "updated_at" : "2013-03-29T01:50:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/15625349",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/155036?v=3",
         "events_url" : "https://api.github.com/users/silvioq/events{/privacy}",
         "followers_url" : "https://api.github.com/users/silvioq/followers",
         "following_url" : "https://api.github.com/users/silvioq/following{/other_user}",
         "gists_url" : "https://api.github.com/users/silvioq/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/silvioq",
         "id" : 155036,
         "login" : "silvioq",
         "organizations_url" : "https://api.github.com/users/silvioq/orgs",
         "received_events_url" : "https://api.github.com/users/silvioq/received_events",
         "repos_url" : "https://api.github.com/users/silvioq/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/silvioq/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/silvioq/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/silvioq"
      }
   }
]
