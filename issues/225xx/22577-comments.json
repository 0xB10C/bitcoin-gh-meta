[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The easiest way to reproduce this problem is to apply this patch, and then start `bitcoind` normally. This delays the main thread from loading the block index for 60 seconds.\r\n```diff\r\n--- a/src/init.cpp\r\n+++ b/src/init.cpp\r\n@@ -1343,6 +1343,7 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\r\n         bilingual_str strLoadError;\r\n \r\n         uiInterface.InitMessage(_(\"Loading block indexâ¦\").translated);\r\n+        UninterruptibleSleep(std::chrono::milliseconds{60000});\r\n \r\n         do {\r\n             const int64_t load_block_index_start_time = GetTimeMillis();\r\n```",
      "created_at" : "2021-07-28T22:33:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22577#issuecomment-888664132",
      "id" : 888664132,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22577",
      "node_id" : "IC_kwDOABII58409_BE",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-28T22:33:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/888664132",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20295 by Sjors\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-07-29T03:33:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22577#issuecomment-888774167",
      "id" : 888774167,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22577",
      "node_id" : "IC_kwDOABII5840-Z4X",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-30T22:54:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/888774167",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I have also received this failure when running the functional tests under ASAN in parallel.",
      "created_at" : "2021-07-29T18:01:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22577#issuecomment-889348674",
      "id" : 889348674,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22577",
      "node_id" : "IC_kwDOABII5841AmJC",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-29T18:01:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889348674",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Wouldn't it make more sense to delay scheduling until later? Identical to how Connman does it?",
      "created_at" : "2021-07-30T09:34:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22577#issuecomment-889769312",
      "id" : 889769312,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22577",
      "node_id" : "IC_kwDOABII5841CM1g",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-30T09:34:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889769312",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke\r\n> Wouldn't it make more sense to delay scheduling until later? Identical to how Connman does it?\r\n\r\nGood idea, thanks! After more investigation, I think the root problem is that the peer manager's background tasks are started from `PeerManagerImpl()` constructor. The new version separates the starting of these background tasks from the constructor. It's done from a new method, `StartScheduledTasks()`, which is called at the end of `AppInitMain()` (startup). It should always be safe to delay (within reason) anything that runs in the background.\r\n\r\nForce-pushed ([previous version](https://github.com/LarryRuane/bitcoin/commit/c0f913de644bf5516bcfae0cc8a87c449ba80596)).",
      "created_at" : "2021-07-30T22:42:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22577#issuecomment-890223175",
      "id" : 890223175,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22577",
      "node_id" : "IC_kwDOABII5841D7pH",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-30T23:24:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/890223175",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Can we reproduce the crash with the new commit, or should it never occur now? I expected to see some removed code. Cheers.",
      "created_at" : "2021-07-31T01:23:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22577#issuecomment-890271631",
      "id" : 890271631,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22577",
      "node_id" : "IC_kwDOABII5841EHeP",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-31T01:23:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/890271631",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8435003?v=4",
         "events_url" : "https://api.github.com/users/tryphe/events{/privacy}",
         "followers_url" : "https://api.github.com/users/tryphe/followers",
         "following_url" : "https://api.github.com/users/tryphe/following{/other_user}",
         "gists_url" : "https://api.github.com/users/tryphe/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/tryphe",
         "id" : 8435003,
         "login" : "tryphe",
         "node_id" : "MDQ6VXNlcjg0MzUwMDM=",
         "organizations_url" : "https://api.github.com/users/tryphe/orgs",
         "received_events_url" : "https://api.github.com/users/tryphe/received_events",
         "repos_url" : "https://api.github.com/users/tryphe/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/tryphe/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/tryphe/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/tryphe"
      }
   }
]
