[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22523#discussion_r674484577"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22523"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/674484577"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n\r\n> :information_source: **NOTE:** Importing wallets is disabled when blocks are pruned\r\n```",
      "commit_id" : "0a5494d2f6df561261f916c9913b72e1e0048fa7",
      "created_at" : "2021-07-22T03:57:30Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+# Managing The Wallet\n+\n+## 1. Backing Up and Restoring The Wallet\n+\n+### 1.1 Creating The Wallet\n+\n+Since version 0.21, Bitcoin Core no longer has a default wallet.\n+Wallets can be created with the RPC command `createwallet`. More information about this command can be found running `bitcoin-cli help createwallet`.\n+\n+The following command, for example, creates a descriptor wallet:\n+\n+`$ bitcoin-cli -named createwallet wallet_name=\"wallet01\" descriptors=true`\n+\n+If the node is running on testnet network, `-testnet` parameter should be added. Or `-signet` if on signet.\n+\n+`$ bitcoin-cli -testnet -named createwallet wallet_name=\"wallet01\" descriptors=true`\n+\n+The `descriptors` parameter can be omitted if the intention is to create a legacy wallet.\n+\n+For now, the default type is the legacy wallet, but that should change in the near future.\n+\n+By default, wallets are created in the `~/.bitcoin/wallets/wallet_name` folder. If the node is running on testnet, the wallets are created in `~/.bitcoin/testnet3/wallets/wallet_name` or if signet, `~/.bitcoin/signet/wallets/wallet_name`.\n+\n+### 1.2 Encrypting The Wallet\n+\n+The `wallet.dat` file is not encrypted by default and is, therefore, vulnerable if an attacker gains access to the device where the wallet or the backups are stored.\n+\n+The wallet must be encrypted with the following command:\n+\n+`$ bitcoin-cli -rpcwallet=\"wallet-01\" encryptwallet \"passphrase\"`\n+\n+The `encryptwallet` command is used only when the wallet has not been encrypted yet. Otherwise, the `walletpassphrasechange` command should be used.\n+\n+`$ bitcoin-cli -rpcwallet=\"wallet-01\" walletpassphrasechange \"oldpassphrase\" \"newpassphrase\"`\n+\n+The `-rpcwallet` is the name of the wallet that will be encrypted.\n+\n+The term \"encrypt the wallet\" used here is not very accurate. This command only encrypts only the private key. All other wallet information, such as transactions, is still visible.\n+\n+Note that if the passphrase is lost, all the coins in the wallet will also be lost forever.\n+\n+### 1.3 Backing Up The Wallet\n+\n+Wallets can be safely copied to another destination. This backup file should be stored offline, such as on a USB drive, another computer, or an external hard drive.\n+\n+If the wallet and backup are lost for any reason, the bitcoins related to this wallet will become permanently inaccessible.\n+\n+The command is `bitcoin-cli backupwallet \"destination\"`. The destination parameter must include the name of the file. Otherwise, the command will return an error message like \"Error: Wallet backup failed!\" for descriptor wallets. If it is a legacy wallet, it will be copied and a file will be created with the default file name `wallet.dat`.\n+\n+`$ bitcoin-cli -rpcwallet=\"wallet-01\" backupwallet /home/node01/Backups/backup01.dat`\n+\n+### 1.4 Backup Frequency\n+\n+The Bitcoin Core wallet was originally a collection of unrelated private keys with their associated addresses. If a non-HD wallet had generated a key/address, had given that address out and then had restored a backup from before that key's generation, then any funds sent to that address would have been lost definitively.\n+\n+However, [version 0.13](https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes/release-notes-0.13.0.md) introduced HD wallets. Users no longer lose funds when restoring old backups, as long as the addresses used were from the wallet's HD seed (since all private keys can be derived from the seed).\n+\n+So, theoretically, a single backup is enough. But it is recommended to make regular backups (1 time a day or a week) or when there is a relevant amount of new transactions in the wallet.\n+\n+### 1.5 Restoring The Wallet From a Backup\n+\n+To restore a wallet, an empty one must be created  first.  The backup file then rewrites the `wallet.dat` of this new wallet.\n+\n+The user must unload the wallet and load it again after replacing the file.\n+\n+```\n+$ bitcoin-cli createwallet \"restored_wallet\"\n+$ bitcoin-cli unloadwallet \"restored_wallet\"\n+$ cp ~/Backups/backup01.dat ~/.bitcoin/wallets/restored_wallet/wallet.dat\n+$ bitcoin-cli loadwallet \"restored_wallet\"\n+```\n+\n+After these steps, the wallet balance can be checked.\n+\n+`$ bitcoin-cli -rpcwallet=\"restored_wallet\" getbalance`\n+\n+### 1.6 `-rescan` and `-reindex`\n+\n+The `-rescan` argument rescans the blockchain for missing wallet transactions during startup.\n+\n+`$ bitcoind -rescan`\n+\n+This is only necessary if there are missing transactions after restoring the wallet.\n+\n+A pruned node, however, is incompatible with the `-rescan` option, since it does not have the data to check for relevant transactions.\n+\n+In that case, it is necessary to restart the node with the `-reindex` command-line option to start over with the initial sync. The wallet will scan for relevant transactions during the synchronization and rediscover the funds and transaction history of the wallet.\n+\n+`$ bitcoind -reindex`\n+\n+### 1.7 Dumping The Wallet\n+\n+Alternatively, the `dumpwallet` command can be used to backup the wallet. It dumps all wallet keys (including the master private key) in a human-readable format into a file.\n+\n+Note that this file is not encrypted and the keys are exposed. An attacker in possession of the file could recreate the wallet and gain access to the keys.\n+\n+The file is generated on the server-side and so the user must have access to the server folders.\n+\n+`$ bitcoin-cli -rpcwallet=\"wallet-01\" dumpwallet /home/node01/Backups/dump01.txt`\n+\n+### 1.8 Importing The Wallet From a Dump File\n+\n+The command `importwallet` imports keys from a wallet dump file.\n+\n+The first step is to create a new wallet.\n+\n+`$ bitcoin-cli createwallet \"from_dump_file\"`\n+\n+Then this command can be called.\n+\n+`$ bitcoin-cli -rpcwallet=\"from_dump_file\" importwallet /home/node01/Backups/dump01.txt`\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22523#discussion_r674484577",
      "id" : 674484577,
      "line" : 112,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NDQ4NDU3Nw==",
      "original_commit_id" : "0a5494d2f6df561261f916c9913b72e1e0048fa7",
      "original_line" : 112,
      "original_position" : 112,
      "original_start_line" : null,
      "path" : "doc/managing_wallet.md",
      "position" : 112,
      "pull_request_review_id" : 712347591,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22523",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-22T03:57:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/674484577",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22523#discussion_r674484959"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22523"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/674484959"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\nThe command `importwallet` imports keys from a wallet dump file. Importing wallets is disabled when blocks are pruned.\r\n```\r\n\r\nOR\r\n\r\nSuggestion for L112",
      "commit_id" : "0a5494d2f6df561261f916c9913b72e1e0048fa7",
      "created_at" : "2021-07-22T03:59:06Z",
      "diff_hunk" : "@@ -0,0 +1,115 @@\n+# Managing The Wallet\n+\n+## 1. Backing Up and Restoring The Wallet\n+\n+### 1.1 Creating The Wallet\n+\n+Since version 0.21, Bitcoin Core no longer has a default wallet.\n+Wallets can be created with the RPC command `createwallet`. More information about this command can be found running `bitcoin-cli help createwallet`.\n+\n+The following command, for example, creates a descriptor wallet:\n+\n+`$ bitcoin-cli -named createwallet wallet_name=\"wallet01\" descriptors=true`\n+\n+If the node is running on testnet network, `-testnet` parameter should be added. Or `-signet` if on signet.\n+\n+`$ bitcoin-cli -testnet -named createwallet wallet_name=\"wallet01\" descriptors=true`\n+\n+The `descriptors` parameter can be omitted if the intention is to create a legacy wallet.\n+\n+For now, the default type is the legacy wallet, but that should change in the near future.\n+\n+By default, wallets are created in the `~/.bitcoin/wallets/wallet_name` folder. If the node is running on testnet, the wallets are created in `~/.bitcoin/testnet3/wallets/wallet_name` or if signet, `~/.bitcoin/signet/wallets/wallet_name`.\n+\n+### 1.2 Encrypting The Wallet\n+\n+The `wallet.dat` file is not encrypted by default and is, therefore, vulnerable if an attacker gains access to the device where the wallet or the backups are stored.\n+\n+The wallet must be encrypted with the following command:\n+\n+`$ bitcoin-cli -rpcwallet=\"wallet-01\" encryptwallet \"passphrase\"`\n+\n+The `encryptwallet` command is used only when the wallet has not been encrypted yet. Otherwise, the `walletpassphrasechange` command should be used.\n+\n+`$ bitcoin-cli -rpcwallet=\"wallet-01\" walletpassphrasechange \"oldpassphrase\" \"newpassphrase\"`\n+\n+The `-rpcwallet` is the name of the wallet that will be encrypted.\n+\n+The term \"encrypt the wallet\" used here is not very accurate. This command only encrypts only the private key. All other wallet information, such as transactions, is still visible.\n+\n+Note that if the passphrase is lost, all the coins in the wallet will also be lost forever.\n+\n+### 1.3 Backing Up The Wallet\n+\n+Wallets can be safely copied to another destination. This backup file should be stored offline, such as on a USB drive, another computer, or an external hard drive.\n+\n+If the wallet and backup are lost for any reason, the bitcoins related to this wallet will become permanently inaccessible.\n+\n+The command is `bitcoin-cli backupwallet \"destination\"`. The destination parameter must include the name of the file. Otherwise, the command will return an error message like \"Error: Wallet backup failed!\" for descriptor wallets. If it is a legacy wallet, it will be copied and a file will be created with the default file name `wallet.dat`.\n+\n+`$ bitcoin-cli -rpcwallet=\"wallet-01\" backupwallet /home/node01/Backups/backup01.dat`\n+\n+### 1.4 Backup Frequency\n+\n+The Bitcoin Core wallet was originally a collection of unrelated private keys with their associated addresses. If a non-HD wallet had generated a key/address, had given that address out and then had restored a backup from before that key's generation, then any funds sent to that address would have been lost definitively.\n+\n+However, [version 0.13](https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes/release-notes-0.13.0.md) introduced HD wallets. Users no longer lose funds when restoring old backups, as long as the addresses used were from the wallet's HD seed (since all private keys can be derived from the seed).\n+\n+So, theoretically, a single backup is enough. But it is recommended to make regular backups (1 time a day or a week) or when there is a relevant amount of new transactions in the wallet.\n+\n+### 1.5 Restoring The Wallet From a Backup\n+\n+To restore a wallet, an empty one must be created  first.  The backup file then rewrites the `wallet.dat` of this new wallet.\n+\n+The user must unload the wallet and load it again after replacing the file.\n+\n+```\n+$ bitcoin-cli createwallet \"restored_wallet\"\n+$ bitcoin-cli unloadwallet \"restored_wallet\"\n+$ cp ~/Backups/backup01.dat ~/.bitcoin/wallets/restored_wallet/wallet.dat\n+$ bitcoin-cli loadwallet \"restored_wallet\"\n+```\n+\n+After these steps, the wallet balance can be checked.\n+\n+`$ bitcoin-cli -rpcwallet=\"restored_wallet\" getbalance`\n+\n+### 1.6 `-rescan` and `-reindex`\n+\n+The `-rescan` argument rescans the blockchain for missing wallet transactions during startup.\n+\n+`$ bitcoind -rescan`\n+\n+This is only necessary if there are missing transactions after restoring the wallet.\n+\n+A pruned node, however, is incompatible with the `-rescan` option, since it does not have the data to check for relevant transactions.\n+\n+In that case, it is necessary to restart the node with the `-reindex` command-line option to start over with the initial sync. The wallet will scan for relevant transactions during the synchronization and rediscover the funds and transaction history of the wallet.\n+\n+`$ bitcoind -reindex`\n+\n+### 1.7 Dumping The Wallet\n+\n+Alternatively, the `dumpwallet` command can be used to backup the wallet. It dumps all wallet keys (including the master private key) in a human-readable format into a file.\n+\n+Note that this file is not encrypted and the keys are exposed. An attacker in possession of the file could recreate the wallet and gain access to the keys.\n+\n+The file is generated on the server-side and so the user must have access to the server folders.\n+\n+`$ bitcoin-cli -rpcwallet=\"wallet-01\" dumpwallet /home/node01/Backups/dump01.txt`\n+\n+### 1.8 Importing The Wallet From a Dump File\n+\n+The command `importwallet` imports keys from a wallet dump file.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22523#discussion_r674484959",
      "id" : 674484959,
      "line" : 103,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NDQ4NDk1OQ==",
      "original_commit_id" : "0a5494d2f6df561261f916c9913b72e1e0048fa7",
      "original_line" : 103,
      "original_position" : 103,
      "original_start_line" : null,
      "path" : "doc/managing_wallet.md",
      "position" : 103,
      "pull_request_review_id" : 712348027,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22523",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-22T04:00:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/674484959",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   }
]
