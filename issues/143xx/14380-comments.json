[
   {
      "author_association" : "MEMBER",
      "body" : "Opening this to see if people think this is the right solution.",
      "created_at" : "2018-10-03T05:45:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#issuecomment-426518487",
      "id" : 426518487,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNjUxODQ4Nw==",
      "updated_at" : "2018-10-03T05:45:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/426518487",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Very nice find!",
      "created_at" : "2018-10-03T07:57:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#issuecomment-426545512",
      "id" : 426545512,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNjU0NTUxMg==",
      "updated_at" : "2018-10-03T07:57:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/426545512",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The code wants to know the change signature size so it can figure out if it would have created change that was worthless to spend (because the spending will take more fees than the output is worth). \r\n\r\nAssuming the size is smallest plausible signature size would be conservative: it'll overvalue the change, at a risk of keeping change it could have eliminated.  I think doing that would be strictly superior to not using BnB at all, since preventing BnB will always keep change it should eliminate. \r\n\r\nSo, e.g. assuming any spend of an unknown type will take at least 32(txid)+4(vout)+4(sequence)+1(len)+64*0.25(signature) = 57 bytes would work. (don't assume my math is right. :) )",
      "created_at" : "2018-10-03T23:45:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#issuecomment-426839366",
      "id" : 426839366,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNjgzOTM2Ng==",
      "updated_at" : "2018-10-03T23:57:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/426839366",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Hm yes I suppose you're right. Not running BnB is admitting defeat even if we actually end up being able to discard a larger value. I'll take a look at constructing something that makes a minimal segwit input weight.",
      "created_at" : "2018-10-03T23:52:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#issuecomment-426840639",
      "id" : 426840639,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNjg0MDYzOQ==",
      "updated_at" : "2018-10-03T23:52:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/426840639",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--32850dd3fdea838b4049e64f46995ea2-->\n| Coverage  | Change ([pull 14380](https://drahtbot.github.io/reports/coverage/bitcoin/bitcoin/14380/total.coverage/index.html)) | Reference ([master](https://drahtbot.github.io/reports/coverage/bitcoin/bitcoin/master/total.coverage/index.html))   |\n|-----------|-------------------------|--------------------|\n| Lines     | -0.0083 %            | 87.0471 %        |\n| Functions | +0.0154 %            | 84.1130 %        |\n| Branches  | +0.0057 %            | 51.5403 %        |\n",
      "created_at" : "2018-10-04T05:47:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#issuecomment-426892864",
      "id" : 426892864,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNjg5Mjg2NA==",
      "updated_at" : "2018-10-04T05:47:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/426892864",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14380#discussion_r222598779"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14380"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/222598779"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`change_spend_size` is `size_t` and thus cannot be `-1` :-)",
      "commit_id" : "5db87a1a141d0a52fa5934367916cbdac62b2ee9",
      "created_at" : "2018-10-04T09:29:57Z",
      "diff_hunk" : "@@ -2730,6 +2728,10 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CTransac\n                     nValueIn = 0;\n                     setCoins.clear();\n                     coin_selection_params.change_spend_size = CalculateMaximumSignedInputSize(change_prototype_txout, this);\n+                    // If the wallet doesn't know how to sign change output, don't rely on it\n+                    if (coin_selection_params.change_spend_size == -1) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#discussion_r222598779",
      "id" : 222598779,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMjU5ODc3OQ==",
      "original_commit_id" : "268f4952d9c56d8056b9ef3a6995509591ef3153",
      "original_position" : 14,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 161521938,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14380",
      "updated_at" : "2018-10-06T05:22:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/222598779",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Isn't the problem that `coin_selection_params.change_spend_size` is set to `std::numeric_limits<size_t>::max() ` (`SIZE_MAX`) instead of the intended `-1` since `change_spend_size` is of type `size_t`? \r\n\r\n```\r\n[cling]$ size_t change_spend_size = -1;\r\n[cling]$ change_spend_size\r\n(unsigned long) 18446744073709551615\r\n[cling]$ (size_t)-1\r\n(unsigned long) 18446744073709551615\r\n[cling]$ #include <limits>\r\n[cling]$ std::numeric_limits<size_t>::max()\r\n(unsigned long) 18446744073709551615\r\n```\r\n\r\nThe definition of `change_spend_size`:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/b012bbe358311cc4a73300ccca41b64272250277/src/wallet/wallet.h#L573\r\n\r\n`CalculateMaximumSignedInputSize(Ã¢ÂÂ¦)` returns `-1` here:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/b012bbe358311cc4a73300ccca41b64272250277/src/wallet/wallet.cpp#L1510-L1520\r\n\r\nThe`change_spend_size` assignment is performed here:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/b012bbe358311cc4a73300ccca41b64272250277/src/wallet/wallet.cpp#L2725\r\n\r\nRelated open pull requests in need of review:\r\n* #14252 Ã¢ÂÂ build: Run functional tests and benchmarks under the undefined behaviour sanitizer (UBSan) (includes `-fsanitize=integer` which tackles unsigned integer wraparounds (non-UB!))\r\n* #14226 Ã¢ÂÂ mempool: Fix unintended unsigned integer wraparound in `CTxMemPool::UpdateAncestorsOf(bool add, Ã¢ÂÂ¦)` when `add` is `false`\r\n* #14224 Ã¢ÂÂ Document intentional and unintentional unsigned integer overflows (wraparounds) using annotations\r\n* #11551 Ã¢ÂÂ Fix unsigned integer wrap-around in `GetBlockProofEquivalentTime`\r\n* #11535 Ã¢ÂÂ Avoid unintentional unsigned integer wraparounds\r\n\r\nPlease help reviewing those :-)",
      "created_at" : "2018-10-04T09:42:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#issuecomment-426953724",
      "id" : 426953724,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNjk1MzcyNA==",
      "updated_at" : "2018-10-04T11:33:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/426953724",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@practicalswift yes that's why the assert is finally hit, but it's faulty logic regardless",
      "created_at" : "2018-10-05T03:40:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#issuecomment-427236948",
      "id" : 427236948,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzIzNjk0OA==",
      "updated_at" : "2018-10-05T03:40:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427236948",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Pushed a fix in line with @gmaxwell suggestions. It's pretty hardcoded, so I'd rather make this more programmatic, perhaps giving a \"hint\" to the dummy signer of what type it should be?",
      "created_at" : "2018-10-05T05:20:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#issuecomment-427249454",
      "id" : 427249454,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzI0OTQ1NA==",
      "updated_at" : "2018-10-05T05:20:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427249454",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14380#discussion_r222907749"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14380"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/222907749"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Make this `constexpr` :-)\r\n\r\nOpt-in to internal linkage using `static` or use the unnamed namespace.",
      "commit_id" : "5db87a1a141d0a52fa5934367916cbdac62b2ee9",
      "created_at" : "2018-10-05T06:55:49Z",
      "diff_hunk" : "@@ -1514,13 +1514,19 @@ int64_t CalculateMaximumSignedTxSize(const CTransaction &tx, const CWallet *wall\n     return GetVirtualTransactionSize(txNew);\n }\n \n+/* Prevout(32*4+4*4) + sequence(4*4) + scriptsig len(1*4) + scriptsig(22*4)\n+* witness signature(1*71) + pubkey(1*33) + witness stack extra bytes(3)\n+* converted to virtual size. This is used when estimating change spend size that\n+* the wallet doesn't own or know how to sign for. */\n+int EstimateP2SHP2WPKHInputSize() {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#discussion_r222907749",
      "id" : 222907749,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMjkwNzc0OQ==",
      "original_commit_id" : "9bde981dd0a72114b8f3d4232d6bd7ad7c753e9b",
      "original_position" : 8,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 161909188,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14380",
      "updated_at" : "2018-10-06T05:22:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/222907749",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14380#discussion_r222908040"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14380"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/222908040"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Add whitespace to improve readability: `return (128 + 16 + 16 + 4 + 88 + 71 + 33 + 3) / 4;`",
      "commit_id" : "5db87a1a141d0a52fa5934367916cbdac62b2ee9",
      "created_at" : "2018-10-05T06:57:04Z",
      "diff_hunk" : "@@ -1514,13 +1514,19 @@ int64_t CalculateMaximumSignedTxSize(const CTransaction &tx, const CWallet *wall\n     return GetVirtualTransactionSize(txNew);\n }\n \n+/* Prevout(32*4+4*4) + sequence(4*4) + scriptsig len(1*4) + scriptsig(22*4)\n+* witness signature(1*71) + pubkey(1*33) + witness stack extra bytes(3)\n+* converted to virtual size. This is used when estimating change spend size that\n+* the wallet doesn't own or know how to sign for. */\n+int EstimateP2SHP2WPKHInputSize() {\n+    return (128+16+16+4+88+71+33+3)/4;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#discussion_r222908040",
      "id" : 222908040,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMjkwODA0MA==",
      "original_commit_id" : "9bde981dd0a72114b8f3d4232d6bd7ad7c753e9b",
      "original_position" : 9,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 161909466,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14380",
      "updated_at" : "2018-10-06T05:22:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/222908040",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14380#discussion_r222908122"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14380"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/222908122"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Make this implicit conversion explicit :-)",
      "commit_id" : "5db87a1a141d0a52fa5934367916cbdac62b2ee9",
      "created_at" : "2018-10-05T06:57:28Z",
      "diff_hunk" : "@@ -2729,7 +2735,14 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CTransac\n                 if (pick_new_inputs) {\n                     nValueIn = 0;\n                     setCoins.clear();\n-                    coin_selection_params.change_spend_size = CalculateMaximumSignedInputSize(change_prototype_txout, this);\n+                    int change_spend_size = CalculateMaximumSignedInputSize(change_prototype_txout, this);\n+                    // If the wallet doesn't know how to sign change output, assume p2sh-p2wpkh\n+                    // as lower-bound to allow BnB to do it's thing\n+                    if (change_spend_size == -1) {\n+                        coin_selection_params.change_spend_size = EstimateP2SHP2WPKHInputSize();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#discussion_r222908122",
      "id" : 222908122,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMjkwODEyMg==",
      "original_commit_id" : "9bde981dd0a72114b8f3d4232d6bd7ad7c753e9b",
      "original_position" : 31,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 161909583,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14380",
      "updated_at" : "2018-10-06T05:22:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/222908122",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14380#discussion_r222908151"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14380"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/222908151"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same here :-)",
      "commit_id" : "5db87a1a141d0a52fa5934367916cbdac62b2ee9",
      "created_at" : "2018-10-05T06:57:39Z",
      "diff_hunk" : "@@ -2729,7 +2735,14 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CTransac\n                 if (pick_new_inputs) {\n                     nValueIn = 0;\n                     setCoins.clear();\n-                    coin_selection_params.change_spend_size = CalculateMaximumSignedInputSize(change_prototype_txout, this);\n+                    int change_spend_size = CalculateMaximumSignedInputSize(change_prototype_txout, this);\n+                    // If the wallet doesn't know how to sign change output, assume p2sh-p2wpkh\n+                    // as lower-bound to allow BnB to do it's thing\n+                    if (change_spend_size == -1) {\n+                        coin_selection_params.change_spend_size = EstimateP2SHP2WPKHInputSize();\n+                    } else {\n+                        coin_selection_params.change_spend_size = change_spend_size;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#discussion_r222908151",
      "id" : 222908151,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMjkwODE1MQ==",
      "original_commit_id" : "9bde981dd0a72114b8f3d4232d6bd7ad7c753e9b",
      "original_position" : 33,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 161909626,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14380",
      "updated_at" : "2018-10-06T05:22:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/222908151",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->No more conflicts as of last run.",
      "created_at" : "2018-10-05T10:47:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#issuecomment-427322704",
      "id" : 427322704,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzMyMjcwNA==",
      "updated_at" : "2018-10-06T13:14:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427322704",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2018-10-05T22:42:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#issuecomment-427517552",
      "id" : 427517552,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzUxNzU1Mg==",
      "updated_at" : "2018-10-05T22:42:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427517552",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Updated the PR to use a function that uses DummySigner flow with an arbitrary valid pubkey as the P2SH-P2WPKH target to estimate the size more programatically.",
      "created_at" : "2018-10-06T05:23:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#issuecomment-427547609",
      "id" : 427547609,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14380",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzU0NzYwOQ==",
      "updated_at" : "2018-10-06T08:31:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427547609",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14380#discussion_r223206667"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14380"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/223206667"
         }
      },
      "author_association" : "MEMBER",
      "body" : "We should handle the case of `-1` here too, or if `CalculateNestedKeyhashInputSize` is guaranteed to never return negative values it should return an unsigned type? :-)",
      "commit_id" : "5db87a1a141d0a52fa5934367916cbdac62b2ee9",
      "created_at" : "2018-10-07T09:31:50Z",
      "diff_hunk" : "@@ -2729,7 +2762,14 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CTransac\n                 if (pick_new_inputs) {\n                     nValueIn = 0;\n                     setCoins.clear();\n-                    coin_selection_params.change_spend_size = CalculateMaximumSignedInputSize(change_prototype_txout, this);\n+                    int change_spend_size = CalculateMaximumSignedInputSize(change_prototype_txout, this);\n+                    // If the wallet doesn't know how to sign change output, assume p2sh-p2wpkh\n+                    // as lower-bound to allow BnB to do it's thing\n+                    if (change_spend_size == -1) {\n+                        coin_selection_params.change_spend_size = (size_t)CalculateNestedKeyhashInputSize(false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14380#discussion_r223206667",
      "id" : 223206667,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMzIwNjY2Nw==",
      "original_commit_id" : "5db87a1a141d0a52fa5934367916cbdac62b2ee9",
      "original_position" : 58,
      "path" : "src/wallet/wallet.cpp",
      "position" : 58,
      "pull_request_review_id" : 162283764,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14380",
      "updated_at" : "2018-10-07T09:31:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/223206667",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   }
]
