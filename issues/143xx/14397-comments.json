[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "cr-ack 6d1779d -- one of my earlier versions looked a lot like that. \r\n\r\nI'd also suggest another optimization to make the vector a prevector with say 20 outputs so we can avoid the allocation on most txns.\r\n\r\nMay I suggest using adjacent_find with std::equal instead of your own loop?\r\nhttps://en.cppreference.com/w/cpp/algorithm/adjacent_find\r\n\r\n",
      "created_at" : "2018-10-05T06:53:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14397#issuecomment-427264404",
      "id" : 427264404,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14397",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzI2NDQwNA==",
      "updated_at" : "2018-10-05T06:53:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427264404",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I prefer this to #14387, but I have the same question for @sipa as I asked Jeremy in that PR:\r\n\r\n> This makes block propagation faster, but do we have an understanding of how much these milliseconds matter? Is there a way we can determine whether the increased complexity introduced is a reasonable price to pay for the performance win?\r\n\r\nGranted, the complexity added here is minimal compared to 14387, but I'd still like to understand the cost/benefit analysis.",
      "created_at" : "2018-10-05T07:04:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14397#issuecomment-427266540",
      "id" : 427266540,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14397",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzI2NjU0MA==",
      "updated_at" : "2018-10-05T07:04:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427266540",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jnewbery Yeah, that's fair. I just wanted to show an alternative which is a smaller improvement but at much lower review complexity. I'm not convinced we need either approach.",
      "created_at" : "2018-10-05T07:06:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14397#issuecomment-427267103",
      "id" : 427267103,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14397",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzI2NzEwMw==",
      "updated_at" : "2018-10-05T07:06:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427267103",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "For what it's worth, bitcoinperf [didn't show any significant performance regression](https://bitcoinperf.com/changes/?rev=d926a87fde&exe=4&env=5) for IBD or reindex after the merge of #14247, so it's not clear that either changeset is needed.",
      "created_at" : "2018-10-05T07:43:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14397#issuecomment-427275334",
      "id" : 427275334,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14397",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzI3NTMzNA==",
      "updated_at" : "2018-10-05T07:43:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427275334",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "node_id" : "MDQ6VXNlcjczMTk3",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jamesob I think this is not so much about ibd but rather propagation",
      "created_at" : "2018-10-05T07:50:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14397#issuecomment-427276985",
      "id" : 427276985,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14397",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzI3Njk4NQ==",
      "updated_at" : "2018-10-05T07:50:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427276985",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke correct.\r\n\r\nIt's something like 13ms slower.",
      "created_at" : "2018-10-05T08:00:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14397#issuecomment-427279584",
      "id" : 427279584,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14397",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzI3OTU4NA==",
      "updated_at" : "2018-10-05T08:00:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427279584",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->Reviewers, this pull request conflicts with the following ones:\n\n* #14400 (Add Benchmark to test input de-duplication worst case by JeremyRubin)\n* #14387 (Faster Input Deduplication Algorithm by JeremyRubin)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-10-05T10:42:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14397#issuecomment-427321696",
      "id" : 427321696,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14397",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzMyMTY5Ng==",
      "updated_at" : "2018-10-05T10:42:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427321696",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Even block propagation is no longer critical for this:  When the prior optimization went in, we didn't have relay-before-validate.   I'm not opposed to this change-- as it's pretty straight forward to review-- but since this particular validity criteria is pure (a function of the tx itself with no dependency on external state) effort might be better spent reorging things so that this test ends up covered by the wtxid validity caching which, although complementary, would likely give a bigger improvement.\r\n",
      "created_at" : "2018-10-05T23:08:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14397#issuecomment-427521630",
      "id" : 427521630,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14397",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzUyMTYzMA==",
      "updated_at" : "2018-10-05T23:08:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427521630",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Is there an explanation of what purpose the duplicate input check will serve if the connect block code is fixed to check for valid spends?",
      "created_at" : "2018-10-06T03:05:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14397#issuecomment-427541098",
      "id" : 427541098,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14397",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzU0MTA5OA==",
      "updated_at" : "2018-10-06T03:05:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427541098",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ryanofsky  Making block connection alone check for duplicate inputs isn't sufficient: The whole reason this code was initially added in PR #443 was to keep duplicate inputs out of the mempool-- block connection did originally prevent the dupes.  If both block-connection and mempool processing prevented duplicate inputs, then, indeed, there should be no reason for this code.\r\n",
      "created_at" : "2018-10-07T16:43:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14397#issuecomment-427667520",
      "id" : 427667520,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14397",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQyNzY2NzUyMA==",
      "updated_at" : "2018-10-07T16:43:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427667520",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   }
]
