[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased.",
      "created_at" : "2017-12-15T22:10:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11639#issuecomment-352124547",
      "id" : 352124547,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11639",
      "updated_at" : "2017-12-15T22:10:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/352124547",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11639#discussion_r158033628"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11639"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158033628"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Also BOOST_CHECK_EQUAL?",
      "commit_id" : "f303f12fdd350ed30c663be24fbef1c1f6d7012f",
      "created_at" : "2017-12-20T14:15:55Z",
      "diff_hunk" : "@@ -53,9 +53,8 @@ BOOST_FIXTURE_TEST_CASE(tx_mempool_reject_coinbase, TestChain100Setup)\n     BOOST_CHECK(state.IsInvalid());\n     BOOST_CHECK_EQUAL(state.GetRejectReason(), \"coinbase\");\n \n-    int nDoS;\n-    BOOST_CHECK_EQUAL(state.IsInvalid(nDoS), true);\n-    BOOST_CHECK_EQUAL(nDoS, 100);\n+    BOOST_CHECK_EQUAL(state.IsInvalid(), true);\n+    BOOST_CHECK(state.GetReason() == ValidationInvalidReason::CONSENSUS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11639#discussion_r158033628",
      "id" : 158033628,
      "original_commit_id" : "09dca76d6769cd3f1c8954f649fac5fd4c88c1a2",
      "original_position" : 8,
      "path" : "src/test/txvalidation_tests.cpp",
      "position" : 8,
      "pull_request_review_id" : 84774914,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11639",
      "updated_at" : "2017-12-24T16:45:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158033628",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11639#discussion_r158036096"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11639"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158036096"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Make it `CONSENSUS` only if `NOT_STANDARD`? I know that atm only those 2 are set but, imo, it's more clear to do so inside that condition:\r\n```cpp\r\nif (state.GetReason() == ValidationInvalidReason::NOT_STANDARD) {\r\n    state.Invalid(ValidationInvalidReason::CONSENSUS, ...);\r\n}\r\n```\r\nThe same happens in line 1951.",
      "commit_id" : "f303f12fdd350ed30c663be24fbef1c1f6d7012f",
      "created_at" : "2017-12-20T14:25:50Z",
      "diff_hunk" : "@@ -1906,11 +1907,15 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n         {\n             CAmount txfee = 0;\n             if (!Consensus::CheckTxInputs(tx, state, view, pindex->nHeight, txfee)) {\n+                // CheckTxInputs may return MISSING_INPUTS but we can't return that, as\n+                // its nonsense for a block, so we reset the reason flag to CONSENSUS here.\n+                state.Invalid(ValidationInvalidReason::CONSENSUS, false,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11639#discussion_r158036096",
      "id" : 158036096,
      "original_commit_id" : "09dca76d6769cd3f1c8954f649fac5fd4c88c1a2",
      "original_position" : 244,
      "path" : "src/validation.cpp",
      "position" : 244,
      "pull_request_review_id" : 84774914,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11639",
      "updated_at" : "2017-12-24T16:45:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158036096",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11639#discussion_r158605611"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11639"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158605611"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Doesn't compile as GetReason() can't be printed.",
      "commit_id" : "f303f12fdd350ed30c663be24fbef1c1f6d7012f",
      "created_at" : "2017-12-24T16:27:58Z",
      "diff_hunk" : "@@ -53,9 +53,8 @@ BOOST_FIXTURE_TEST_CASE(tx_mempool_reject_coinbase, TestChain100Setup)\n     BOOST_CHECK(state.IsInvalid());\n     BOOST_CHECK_EQUAL(state.GetRejectReason(), \"coinbase\");\n \n-    int nDoS;\n-    BOOST_CHECK_EQUAL(state.IsInvalid(nDoS), true);\n-    BOOST_CHECK_EQUAL(nDoS, 100);\n+    BOOST_CHECK_EQUAL(state.IsInvalid(), true);\n+    BOOST_CHECK(state.GetReason() == ValidationInvalidReason::CONSENSUS);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11639#discussion_r158605611",
      "id" : 158605611,
      "in_reply_to_id" : 158033628,
      "original_commit_id" : "09dca76d6769cd3f1c8954f649fac5fd4c88c1a2",
      "original_position" : 8,
      "path" : "src/test/txvalidation_tests.cpp",
      "position" : 8,
      "pull_request_review_id" : 85444994,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11639",
      "updated_at" : "2017-12-24T16:45:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158605611",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/11639#discussion_r158605955"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11639"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158605955"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done.",
      "commit_id" : "f303f12fdd350ed30c663be24fbef1c1f6d7012f",
      "created_at" : "2017-12-24T16:45:29Z",
      "diff_hunk" : "@@ -1906,11 +1907,15 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n         {\n             CAmount txfee = 0;\n             if (!Consensus::CheckTxInputs(tx, state, view, pindex->nHeight, txfee)) {\n+                // CheckTxInputs may return MISSING_INPUTS but we can't return that, as\n+                // its nonsense for a block, so we reset the reason flag to CONSENSUS here.\n+                state.Invalid(ValidationInvalidReason::CONSENSUS, false,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11639#discussion_r158605955",
      "id" : 158605955,
      "in_reply_to_id" : 158036096,
      "original_commit_id" : "09dca76d6769cd3f1c8954f649fac5fd4c88c1a2",
      "original_position" : 244,
      "path" : "src/validation.cpp",
      "position" : 244,
      "pull_request_review_id" : 85445303,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11639",
      "updated_at" : "2017-12-24T16:45:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/158605955",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   }
]
