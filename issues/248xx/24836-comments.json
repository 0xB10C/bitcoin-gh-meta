[
   {
      "author_association" : "MEMBER",
      "body" : "TODOs (probably for future PRs):\r\n\r\n- Automatically build the package using the child transaction, i.e. when we already have unconfirmed parents in the mempool or `mapWallet`. I expect to have this before package relay (users shouldn't be expected to construct packages themselves imo), but just haven't implemented it yet. LMK if this is something you want now.\r\n- Add `maxfeerate` to allow users to set a maximum package feerate. This just requires adding a `TestPackage` codepath separate from testmempoolaccept so we can say \"just kidding\" if the validation succeeds.\r\n",
      "created_at" : "2022-04-12T16:34:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24836#issuecomment-1096948837",
      "id" : 1096948837,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24836",
      "node_id" : "IC_kwDOABII585BYhxl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1096948837/reactions"
      },
      "updated_at" : "2022-04-12T16:34:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1096948837",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">It could be unsafe/confusing to create an actual mainnet interface while package relay doesn't exist.\r\n\r\nHow so?\r\n\r\n> However, it's currently very inconvenient for wallet/application devs to try to test current package policies. \r\n\r\nThey shouldn't need to. No assumptions should be made about user package policies...",
      "created_at" : "2022-04-13T02:29:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24836#issuecomment-1097487355",
      "id" : 1097487355,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24836",
      "node_id" : "IC_kwDOABII585BalP7",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1097487355/reactions"
      },
      "updated_at" : "2022-04-13T02:29:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1097487355",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24836#discussion_r849163198"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24836"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/849163198"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        {\"hidden\", &submitrawpackage},\r\n```\r\n\r\nnit?",
      "commit_id" : "f09106314119577d5716bb1cb57d7b575c7f4218",
      "created_at" : "2022-04-13T07:26:06Z",
      "diff_hunk" : "@@ -682,6 +810,7 @@ void RegisterMempoolRPCCommands(CRPCTable& t)\n         {\"blockchain\", &getmempoolinfo},\n         {\"blockchain\", &getrawmempool},\n         {\"blockchain\", &savemempool},\n+        {\"hidden\", &submitrawpackage,},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24836#discussion_r849163198",
      "id" : 849163198,
      "line" : 813,
      "node_id" : "PRRC_kwDOABII584ynTO-",
      "original_commit_id" : "f09106314119577d5716bb1cb57d7b575c7f4218",
      "original_line" : 813,
      "original_position" : 146,
      "original_start_line" : null,
      "path" : "src/rpc/mempool.cpp",
      "position" : 146,
      "pull_request_review_id" : 940524052,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24836",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/849163198/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-13T07:28:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/849163198",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24836#discussion_r849164846"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24836"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/849164846"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        {\r\n```\r\n\r\nnit: I accidentally didn't fix the whitespace when creating this file, but I think it is fine for new code to use the right amount of spaces.",
      "commit_id" : "f09106314119577d5716bb1cb57d7b575c7f4218",
      "created_at" : "2022-04-13T07:28:08Z",
      "diff_hunk" : "@@ -669,6 +670,133 @@ static RPCHelpMan savemempool()\n     };\n }\n \n+static RPCHelpMan submitrawpackage()\n+{\n+    return RPCHelpMan{\"submitrawpackage\",\n+        \"\\nSubmit a package of raw transactions (serialized, hex-encoded) to local node (-regtest only). Experimental, API may be unstable.\\n\"\n+        \"\\nThe package will be validated and accepted to mempool if it passes consensus and mempool policy rules. Throws a JSONRPCError if anything goes wrong.\\n\"\n+        \"\\nWarning: successful submission does not mean the transaction will propagate to other nodes on the network.\\n\",\n+        {\n+            {\"package\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"An array of raw transactions.\\n\",\n+                {\n+                    {\"rawtx\", RPCArg::Type::STR_HEX, RPCArg::Optional::OMITTED, \"\"},\n+                },\n+            },\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+            {\n+                {RPCResult::Type::OBJ_DYN, \"tx-results\", \"transaction results keyed by wtxid\",\n+                {\n+                    {RPCResult::Type::OBJ, \"xxxx\", \"transaction wtxid\", {\n+                        {RPCResult::Type::STR_HEX, \"txid\", \"The transaction hash in hex\"},\n+                        {RPCResult::Type::STR_HEX, \"wtxid\", \"The transaction witness hash in hex\"},\n+                        {RPCResult::Type::NUM, \"vsize\", \"Virtual transaction size as defined in BIP 141.\"},\n+                        {RPCResult::Type::OBJ, \"fees\", \"Transaction fees (only present if result=\\\"valid\\\")\", {\n+                            {RPCResult::Type::STR_AMOUNT, \"base\", \"transaction fee in \" + CURRENCY_UNIT},\n+                        }},\n+                    }}\n+                }},\n+                {RPCResult::Type::STR_AMOUNT, \"package-feerate\", /*optional=*/ true, \"package feerate in \" + CURRENCY_UNIT + \" per KvB. Not always available.\"},\n+                {RPCResult::Type::ARR, \"replaced-transactions\", /*optional=*/ true, \"List of txids of replaced transactions\",\n+                {\n+                    {RPCResult::Type::STR_HEX, \"\", \"The transaction id\"},\n+                }},\n+            },\n+        },\n+        RPCExamples{\n+            HelpExampleCli(\"testmempoolaccept\", \"[rawtx1, rawtx2]\") +\n+            HelpExampleCli(\"submitrawtransaction\", \"[rawtx1, rawtx2]\")\n+        },\n+        [&](const RPCHelpMan& self, const JSONRPCRequest& request) -> UniValue\n+{",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24836#discussion_r849164846",
      "id" : 849164846,
      "line" : 712,
      "node_id" : "PRRC_kwDOABII584ynTou",
      "original_commit_id" : "f09106314119577d5716bb1cb57d7b575c7f4218",
      "original_line" : 712,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/rpc/mempool.cpp",
      "position" : 51,
      "pull_request_review_id" : 940524052,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24836",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/849164846/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-13T07:28:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/849164846",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > It could be unsafe/confusing to create an actual mainnet interface while package relay doesn't exist.\r\n\r\n> How so?\r\n\r\nUntil package relay, it's unreasonable to assume that anything submitted to the mempool this way will propagate. For example, package cpfp allows 0-fee transactions to be accepted to the mempool if they have a high-fee child. But this likely won't go much further than the user's mempool, since most nodes will reject 0-fee transactions.\r\n\r\n>>    However, it's currently very inconvenient for wallet/application devs to try to test current package policies.\r\n\r\n> They shouldn't need to. No assumptions should be made about user package policies...\r\n\r\nThe point here is to encourage testing. Even if they aren't supposed to rely on the interface, the reality is that most nodes run bitcoind and don't configure their nodes differently, it's a good idea for wallet/application devs to write a test suite for what their expectations are. I would also prefer to know as early as possible (i.e. PR comment or in RC testing, not catastrophic bug after release) if we're going to accidentally harm LN tx propagation with a policy restriction, as >$100 billion of the network is in it.",
      "created_at" : "2022-04-13T15:02:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24836#issuecomment-1098161866",
      "id" : 1098161866,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24836",
      "node_id" : "IC_kwDOABII585BdJ7K",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1098161866/reactions"
      },
      "updated_at" : "2022-04-13T15:02:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1098161866",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   }
]
