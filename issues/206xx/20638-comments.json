[
   {
      "author_association" : "MEMBER",
      "body" : "Needs backport to all branches that we plan on making further releases from.\r\n\r\nWe also need to verify that after doing the code signing that the behavior is what we expect, so @jonasschnelli will need to make a code signature for this PR.",
      "created_at" : "2020-12-12T16:59:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20638#issuecomment-743783927",
      "id" : 743783927,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20638",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0Mzc4MzkyNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-12T16:59:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/743783927",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20638#discussion_r541673242"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20638"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/541673242"
         }
      },
      "author_association" : "MEMBER",
      "body" : "an aside but 500k is crazy large for a cryptographic signature, i only know some of the quantum-hard signature algorithms produce such large signatures, is it known what algorithm they're using?",
      "commit_id" : "73d1a541147e72b07ce0e6c3a23ca6e94f74c3ce",
      "created_at" : "2020-12-12T17:10:58Z",
      "diff_hunk" : "@@ -130,6 +131,23 @@ script: |\n     make ${MAKEOPTS} -C src check-symbols\n     make install-strip DESTDIR=${INSTALLPATH}\n \n+    # Hack to work around differences in the behavior of native_cctools' codesign_allocate and Apple distributed codesign and codesign_allocate.\n+    # Specifically, the signature is created by appending it to the end of the binary and then updating the size for the section __LINKEDIT\n+    # The \"vmsize\" attribute of this section is rounded to 0x1000, 0x2000, or 0x4000 depending on the architecture. For some reason, this also happens\n+    # to differ between what we can build ourselves in native_cctools (which uses Apple's published source code) and what Apple distributes\n+    # as \"Xcode command line tools\". It appears that the Apple distributed tool rounds to 0x2000.\n+    #\n+    # Fortunately codesign_allocate will not reduce the \"vmsize\" attribute, and when the signature is appended, the difference in actual size and\n+    # \"vmsize\" will not be present in the final binary.\n+    #\n+    # Thus we can workaround this by calculating an overestimate of what the signature will be and then using codesign_allocate to preallocate\n+    # space for the code signature. Because the same codesign_allocate is used in this step, the rounding problem will not be present.\n+    # Since the space allocated for the signature should be way larger than actually needed, the signing step will not reduce \"vmsize\" so we\n+    # won't have any problems there. We use a fixed overestimate because that's easier. Looking at previous releases, the largest MacOS\n+    # code signature since 0.12.1 was ~408000 bytes, so using 500000 should be sufficiently large.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20638#discussion_r541673242",
      "id" : 541673242,
      "line" : 150,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY3MzI0Mg==",
      "original_commit_id" : "ba8a52725f43019f0d3bebc7d187247020a9d9ea",
      "original_line" : 150,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "contrib/gitian-descriptors/gitian-osx.yml",
      "position" : 26,
      "pull_request_review_id" : 550846137,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20638",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-12T17:33:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/541673242",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, thanks for investigating this weird problem.",
      "created_at" : "2020-12-12T17:22:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20638#issuecomment-743786830",
      "id" : 743786830,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20638",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0Mzc4NjgzMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-12T17:22:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/743786830",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20638#discussion_r541684017"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20638"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/541684017"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I assume it's just because without --pagesize 0, it splits the binary into pages, and signs every page separately. If a page is 4 kB by default (I don't know what the default is), it's not too surprising to get a huge result.\n\nWith --pagesize 0 the signature is just 20 kB. I believe it has still that size because \"resources\" that are embedded in the binary are still signed separately.",
      "commit_id" : "73d1a541147e72b07ce0e6c3a23ca6e94f74c3ce",
      "created_at" : "2020-12-12T17:31:44Z",
      "diff_hunk" : "@@ -130,6 +131,23 @@ script: |\n     make ${MAKEOPTS} -C src check-symbols\n     make install-strip DESTDIR=${INSTALLPATH}\n \n+    # Hack to work around differences in the behavior of native_cctools' codesign_allocate and Apple distributed codesign and codesign_allocate.\n+    # Specifically, the signature is created by appending it to the end of the binary and then updating the size for the section __LINKEDIT\n+    # The \"vmsize\" attribute of this section is rounded to 0x1000, 0x2000, or 0x4000 depending on the architecture. For some reason, this also happens\n+    # to differ between what we can build ourselves in native_cctools (which uses Apple's published source code) and what Apple distributes\n+    # as \"Xcode command line tools\". It appears that the Apple distributed tool rounds to 0x2000.\n+    #\n+    # Fortunately codesign_allocate will not reduce the \"vmsize\" attribute, and when the signature is appended, the difference in actual size and\n+    # \"vmsize\" will not be present in the final binary.\n+    #\n+    # Thus we can workaround this by calculating an overestimate of what the signature will be and then using codesign_allocate to preallocate\n+    # space for the code signature. Because the same codesign_allocate is used in this step, the rounding problem will not be present.\n+    # Since the space allocated for the signature should be way larger than actually needed, the signing step will not reduce \"vmsize\" so we\n+    # won't have any problems there. We use a fixed overestimate because that's easier. Looking at previous releases, the largest MacOS\n+    # code signature since 0.12.1 was ~408000 bytes, so using 500000 should be sufficiently large.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20638#discussion_r541684017",
      "id" : 541684017,
      "in_reply_to_id" : 541673242,
      "line" : 150,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY4NDAxNw==",
      "original_commit_id" : "ba8a52725f43019f0d3bebc7d187247020a9d9ea",
      "original_line" : 150,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "contrib/gitian-descriptors/gitian-osx.yml",
      "position" : 26,
      "pull_request_review_id" : 550847650,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20638",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-12T17:33:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/541684017",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20638#discussion_r541697807"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20638"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/541697807"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I believe it's RSA. The reason the signature is so big is because it's actually multiple signatures. By default, the binary is signed in page sized chunks with each piece getting its own signature. Or at least I think that's what the code is doing.",
      "commit_id" : "73d1a541147e72b07ce0e6c3a23ca6e94f74c3ce",
      "created_at" : "2020-12-12T18:00:57Z",
      "diff_hunk" : "@@ -130,6 +131,23 @@ script: |\n     make ${MAKEOPTS} -C src check-symbols\n     make install-strip DESTDIR=${INSTALLPATH}\n \n+    # Hack to work around differences in the behavior of native_cctools' codesign_allocate and Apple distributed codesign and codesign_allocate.\n+    # Specifically, the signature is created by appending it to the end of the binary and then updating the size for the section __LINKEDIT\n+    # The \"vmsize\" attribute of this section is rounded to 0x1000, 0x2000, or 0x4000 depending on the architecture. For some reason, this also happens\n+    # to differ between what we can build ourselves in native_cctools (which uses Apple's published source code) and what Apple distributes\n+    # as \"Xcode command line tools\". It appears that the Apple distributed tool rounds to 0x2000.\n+    #\n+    # Fortunately codesign_allocate will not reduce the \"vmsize\" attribute, and when the signature is appended, the difference in actual size and\n+    # \"vmsize\" will not be present in the final binary.\n+    #\n+    # Thus we can workaround this by calculating an overestimate of what the signature will be and then using codesign_allocate to preallocate\n+    # space for the code signature. Because the same codesign_allocate is used in this step, the rounding problem will not be present.\n+    # Since the space allocated for the signature should be way larger than actually needed, the signing step will not reduce \"vmsize\" so we\n+    # won't have any problems there. We use a fixed overestimate because that's easier. Looking at previous releases, the largest MacOS\n+    # code signature since 0.12.1 was ~408000 bytes, so using 500000 should be sufficiently large.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20638#discussion_r541697807",
      "id" : 541697807,
      "in_reply_to_id" : 541673242,
      "line" : 150,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY5NzgwNw==",
      "original_commit_id" : "ba8a52725f43019f0d3bebc7d187247020a9d9ea",
      "original_line" : 150,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "contrib/gitian-descriptors/gitian-osx.yml",
      "position" : 26,
      "pull_request_review_id" : 550849872,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20638",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-12T18:00:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/541697807",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "MacOS Gitian build of 73d1a541147e72b07ce0e6c3a23ca6e94f74c3ce\r\n\r\n```\r\nbf682a0e960d153a6c862ad4af4f7fce584df3139ee74ecfd6c864ea91bf5c63  bitcoin-73d1a541147e-osx-unsigned.dmg\r\n836a13543e82062074400b7ef82d4e62ffc16a4f030c3e89e500e6164dca58ab  bitcoin-73d1a541147e-osx-unsigned.tar.gz\r\n87ba11ddf0fe08c531afd50ba2e638b1d74a857fcbf3f9a2a1dac1c2c515881e  bitcoin-73d1a541147e-osx64.tar.gz\r\ne6ee88e761dc0894daf6b094768453f9baea5a26209ecb64b44000cc6030dbdd  src/bitcoin-73d1a541147e.tar.gz\r\n```",
      "created_at" : "2020-12-12T18:02:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20638#issuecomment-743793161",
      "id" : 743793161,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20638",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0Mzc5MzE2MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-12T18:02:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/743793161",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20638#discussion_r541699717"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20638"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/541699717"
         }
      },
      "author_association" : "MEMBER",
      "body" : "thanks!\r\nyes 20kB isn't that surprising to me for RSA+metadata, and if it signs every page separately that definitely explains things",
      "commit_id" : "73d1a541147e72b07ce0e6c3a23ca6e94f74c3ce",
      "created_at" : "2020-12-12T18:06:17Z",
      "diff_hunk" : "@@ -130,6 +131,23 @@ script: |\n     make ${MAKEOPTS} -C src check-symbols\n     make install-strip DESTDIR=${INSTALLPATH}\n \n+    # Hack to work around differences in the behavior of native_cctools' codesign_allocate and Apple distributed codesign and codesign_allocate.\n+    # Specifically, the signature is created by appending it to the end of the binary and then updating the size for the section __LINKEDIT\n+    # The \"vmsize\" attribute of this section is rounded to 0x1000, 0x2000, or 0x4000 depending on the architecture. For some reason, this also happens\n+    # to differ between what we can build ourselves in native_cctools (which uses Apple's published source code) and what Apple distributes\n+    # as \"Xcode command line tools\". It appears that the Apple distributed tool rounds to 0x2000.\n+    #\n+    # Fortunately codesign_allocate will not reduce the \"vmsize\" attribute, and when the signature is appended, the difference in actual size and\n+    # \"vmsize\" will not be present in the final binary.\n+    #\n+    # Thus we can workaround this by calculating an overestimate of what the signature will be and then using codesign_allocate to preallocate\n+    # space for the code signature. Because the same codesign_allocate is used in this step, the rounding problem will not be present.\n+    # Since the space allocated for the signature should be way larger than actually needed, the signing step will not reduce \"vmsize\" so we\n+    # won't have any problems there. We use a fixed overestimate because that's easier. Looking at previous releases, the largest MacOS\n+    # code signature since 0.12.1 was ~408000 bytes, so using 500000 should be sufficiently large.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20638#discussion_r541699717",
      "id" : 541699717,
      "in_reply_to_id" : 541673242,
      "line" : 150,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MTY5OTcxNw==",
      "original_commit_id" : "ba8a52725f43019f0d3bebc7d187247020a9d9ea",
      "original_line" : 150,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "contrib/gitian-descriptors/gitian-osx.yml",
      "position" : 26,
      "pull_request_review_id" : 550850236,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20638",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-12T18:06:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/541699717",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
