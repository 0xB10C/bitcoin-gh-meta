[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. I have a branch that does almost exactly the same as this.\r\n\r\nI don't think we even need to store`m_best_height` in `PeerManager`. We can just call `::ChainActive().Height()` whenever we want to send a `version` message.",
      "created_at" : "2020-12-14T11:34:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20649#issuecomment-744380778",
      "id" : 744380778,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20649",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0NDM4MDc3OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-14T11:34:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/744380778",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> just call ::ChainActive().Height() whenever we want to send a version message.\r\n\r\nI was thinking that it would be nice (in the future) if most message handling could be done without `cs_main`.",
      "created_at" : "2020-12-14T11:47:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20649#issuecomment-744387126",
      "id" : 744387126,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20649",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0NDM4NzEyNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-14T11:47:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/744387126",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I was thinking that it would be nice (in the future) if most message handling could be done without cs_main.\r\n\r\nThis would definitely be nice! At the moment, both places we send a `version` message require cs_main at some point, so we're quite far off at the moment.\r\n\r\nI have a preference for not caching the block height in PeerManager since I think it makes isolating and testing behaviour more difficult, but either way, this is clearly a big improvement over the current code.",
      "created_at" : "2020-12-14T12:51:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20649#issuecomment-744418340",
      "id" : 744418340,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20649",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0NDQxODM0MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-14T12:51:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/744418340",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\nðµï¸ @sipa has been requested to review this pull request as specified in the REVIEWERS file.",
      "created_at" : "2020-12-14T19:12:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20649#issuecomment-744649776",
      "id" : 744649776,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20649",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0NDY0OTc3Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-14T19:12:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/744649776",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20653 (doc: Move addr relay comment in net to correct place by MarcoFalke)\n* #20437 (fuzz: Avoid time-based \"non-determinism\" in fuzzing harnesses by using mocked GetTime() by practicalswift)\n* #20373 (refactor, net: Increase CNode data member encapsulation by hebasto)\n* #20370 (DRAFT fuzz: Permission flags in net_processing fuzzers by MarcoFalke)\n* #20253 (net: use std::chrono throughout maxOutbound logic by fanquake)\n* #20228 (addrman: Make addrman a top-level component by jnewbery)\n* #20210 (net: ensure CNode::m_inbound_onion is inbound, add getter, unit tests by jonatack)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-12-14T20:12:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20649#issuecomment-744682281",
      "id" : 744682281,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20649",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0NDY4MjI4MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-14T20:12:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/744682281",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK fa7afc076328ef3fbc56b51f62f7afae24701dae",
      "created_at" : "2020-12-15T10:54:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20649#issuecomment-745212651",
      "id" : 745212651,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20649",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0NTIxMjY1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-15T10:54:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/745212651",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
