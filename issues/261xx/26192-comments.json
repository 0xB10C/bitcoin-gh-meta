[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25722](https://github.com/bitcoin/bitcoin/pull/25722) (refactor: Use util::Result class for wallet loading by ryanofsky)\n* [#20892](https://github.com/bitcoin/bitcoin/pull/20892) (tests: Run both descriptor and legacy tests within a single test invocation by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-09-28T14:59:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26192#issuecomment-1261043300",
      "id" : 1261043300,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26192",
      "node_id" : "IC_kwDOABII585LKf5k",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261043300/reactions"
      },
      "updated_at" : "2022-09-28T14:59:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1261043300",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26192#discussion_r984010822"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26192"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984010822"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"rpc: Improve error when wallet is already loaded\" (ca8eba38a19a3c1eac8fc41ae7f9f9a17660710c)\r\n\r\nNote for other reviewers: it seemed like a potential concern that this test is dropping coverage for the \"Unable to obtain an exclusive lock\" error, which can still be triggered. But it looks like there is another check for that error in  in `feature_filelock.py`, so this should be ok.",
      "commit_id" : "ca8eba38a19a3c1eac8fc41ae7f9f9a17660710c",
      "created_at" : "2022-09-29T20:49:18Z",
      "diff_hunk" : "@@ -304,9 +304,9 @@ def wallet_file(name):\n         # Fail to load duplicate wallets\n         path = os.path.join(self.options.tmpdir, \"node0\", \"regtest\", \"wallets\", \"w1\", \"wallet.dat\")\n         if self.options.descriptors:\n-            assert_raises_rpc_error(-4, f\"Wallet file verification failed. SQLiteDatabase: Unable to obtain an exclusive lock on the database, is it being used by another instance of {self.config['environment']['PACKAGE_NAME']}?\", self.nodes[0].loadwallet, wallet_names[0])\n+            assert_raises_rpc_error(-35, f\"Wallet file verification failed. Wallet \\\"{wallet_names[0]}\\\" is already loaded.\", self.nodes[0].loadwallet, wallet_names[0])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26192#discussion_r984010822",
      "id" : 984010822,
      "line" : 307,
      "node_id" : "PRRC_kwDOABII5846ptBG",
      "original_commit_id" : "ca8eba38a19a3c1eac8fc41ae7f9f9a17660710c",
      "original_line" : 307,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "test/functional/wallet_multiwallet.py",
      "position" : 5,
      "pull_request_review_id" : 1125980827,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26192",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984010822/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-29T20:51:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984010822",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26192#discussion_r984014455"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26192"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984014455"
         }
      },
      "author_association" : "MEMBER",
      "body" : "forgot to remove this, will remove if this gets concept acked",
      "commit_id" : "ca8eba38a19a3c1eac8fc41ae7f9f9a17660710c",
      "created_at" : "2022-09-29T20:54:27Z",
      "diff_hunk" : "@@ -2784,6 +2784,20 @@ std::unique_ptr<WalletDatabase> MakeWalletDatabase(const std::string& name, cons\n         status = DatabaseStatus::FAILED_BAD_PATH;\n         return nullptr;\n     }\n+\n+    {\n+        LOCK(context.wallets_mutex);\n+        if (std::any_of(context.wallets.begin(), context.wallets.end(), [&wallet_path](const auto& wallet) {\n+                // fs::equivalent alternative\n+                // return SQLiteDataFile(wallet_path) == wallet->GetDatabase().Filename();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26192#discussion_r984014455",
      "id" : 984014455,
      "line" : 2792,
      "node_id" : "PRRC_kwDOABII5846pt53",
      "original_commit_id" : "ca8eba38a19a3c1eac8fc41ae7f9f9a17660710c",
      "original_line" : 2792,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 36,
      "pull_request_review_id" : 1125987112,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26192",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984014455/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-29T20:54:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/984014455",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   }
]
