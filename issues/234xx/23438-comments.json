[
   {
      "author_association" : "MEMBER",
      "body" : "Oh, `std::byte` is already in C++17!",
      "created_at" : "2021-11-04T14:57:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23438#issuecomment-961114306",
      "id" : 961114306,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23438",
      "node_id" : "IC_kwDOABII5845SXDC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 1,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/961114306/reactions"
      },
      "updated_at" : "2021-11-04T14:57:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/961114306",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r742926098"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742926098"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This probably needs `std::enable_if_t<std::is_const_v<T>, Span<std::byte>>` as return type, to prevent using this on const spans.",
      "commit_id" : "fafbcfb000583ea5314a6c9bce67641ea278d979",
      "created_at" : "2021-11-04T15:03:27Z",
      "diff_hunk" : "@@ -236,11 +237,35 @@ T& SpanPopBack(Span<T>& span)\n     return back;\n }\n \n+// From C++20 as_bytes and as_writeable_bytes\n+template <typename T>\n+Span<const std::byte> AsBytes(Span<T> s) noexcept\n+{\n+    return {reinterpret_cast<const std::byte*>(s.data()), s.size_bytes()};\n+}\n+template <typename T>\n+Span<std::byte> AsWriteableBytes(Span<T> s) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r742926098",
      "id" : 742926098,
      "line" : 247,
      "node_id" : "PRRC_kwDOABII584sSCcS",
      "original_commit_id" : "fab18b8b12c3d2351f9927fc728b0510afe92cda",
      "original_line" : 247,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/span.h",
      "position" : 19,
      "pull_request_review_id" : 797865865,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742926098/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-04T15:03:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742926098",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r742935246"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742935246"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Post-#23413, this could also be written as `s.write(AsBytes(Span{&obj,1}));`. Before it's a bit uglier.\r\n\r\nI'm not sure it's better, but it does avoid the need to explicitly list the size of the type.",
      "commit_id" : "fafbcfb000583ea5314a6c9bce67641ea278d979",
      "created_at" : "2021-11-04T15:13:02Z",
      "diff_hunk" : "@@ -47,87 +47,85 @@ static const unsigned int MAX_VECTOR_ALLOCATE = 5000000;\n struct deserialize_type {};\n constexpr deserialize_type deserialize {};\n \n-//! Safely convert odd char pointer types to standard ones.\n-inline char* CharCast(char* c) { return c; }\n-inline char* CharCast(unsigned char* c) { return (char*)c; }\n-inline const char* CharCast(const char* c) { return c; }\n-inline const char* CharCast(const unsigned char* c) { return (const char*)c; }\n+//! Safely convert a data pointer to a std::byte data pointer.\n+inline std::byte* BytePtr(void* data) { return reinterpret_cast<std::byte*>(data); }\n+inline const std::byte* BytePtr(const void* data) { return reinterpret_cast<const std::byte*>(data); }\n \n /*\n  * Lowest-level serialization and conversion.\n  * @note Sizes of these types are verified in the tests\n  */\n template<typename Stream> inline void ser_writedata8(Stream &s, uint8_t obj)\n {\n-    s.write((char*)&obj, 1);\n+    s.write({BytePtr(&obj), 1});\n }\n template<typename Stream> inline void ser_writedata16(Stream &s, uint16_t obj)\n {\n     obj = htole16(obj);\n-    s.write((char*)&obj, 2);\n+    s.write({BytePtr(&obj), 2});\n }\n template<typename Stream> inline void ser_writedata16be(Stream &s, uint16_t obj)\n {\n     obj = htobe16(obj);\n-    s.write((char*)&obj, 2);\n+    s.write({BytePtr(&obj), 2});\n }\n template<typename Stream> inline void ser_writedata32(Stream &s, uint32_t obj)\n {\n     obj = htole32(obj);\n-    s.write((char*)&obj, 4);\n+    s.write({BytePtr(&obj), 4});\n }\n template<typename Stream> inline void ser_writedata32be(Stream &s, uint32_t obj)\n {\n     obj = htobe32(obj);\n-    s.write((char*)&obj, 4);\n+    s.write({BytePtr(&obj), 4});\n }\n template<typename Stream> inline void ser_writedata64(Stream &s, uint64_t obj)\n {\n     obj = htole64(obj);\n-    s.write((char*)&obj, 8);\n+    s.write({BytePtr(&obj), 8});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r742935246",
      "id" : 742935246,
      "line" : 85,
      "node_id" : "PRRC_kwDOABII584sSErO",
      "original_commit_id" : "fa441780ee51250df4b8c50852ebe3b83d158f21",
      "original_line" : 85,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 50,
      "pull_request_review_id" : 797879027,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742935246/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-04T15:13:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742935246",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r742947533"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742947533"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`reinterpret_cast` can not be used to remove constness. This will fail with something like:\r\n\r\n```\r\n./span.h:249:13: error: reinterpret_cast from 'const unsigned char *' to 'std::byte *' casts away qualifiers\r\n    return {reinterpret_cast<std::byte*>(s.data()), s.size_bytes()};\r\n            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\r\nnote: in instantiation of function template specialization 'AsWriteableBytes<const unsigned char>' requested here\r\n",
      "commit_id" : "fafbcfb000583ea5314a6c9bce67641ea278d979",
      "created_at" : "2021-11-04T15:25:37Z",
      "diff_hunk" : "@@ -236,11 +237,35 @@ T& SpanPopBack(Span<T>& span)\n     return back;\n }\n \n+// From C++20 as_bytes and as_writeable_bytes\n+template <typename T>\n+Span<const std::byte> AsBytes(Span<T> s) noexcept\n+{\n+    return {reinterpret_cast<const std::byte*>(s.data()), s.size_bytes()};\n+}\n+template <typename T>\n+Span<std::byte> AsWriteableBytes(Span<T> s) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r742947533",
      "id" : 742947533,
      "in_reply_to_id" : 742926098,
      "line" : 247,
      "node_id" : "PRRC_kwDOABII584sSHrN",
      "original_commit_id" : "fab18b8b12c3d2351f9927fc728b0510afe92cda",
      "original_line" : 247,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/span.h",
      "position" : 19,
      "pull_request_review_id" : 797896552,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742947533/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-04T15:25:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742947533",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r742950474"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742950474"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Interesting, I wasn't aware of that.\r\n\r\nStill, the C++20 `std::as_writable_bytes` definition (at least on cppreference) does state:\r\n\r\n> as_writable_bytes only participates in overload resolution if `std::is_const_v<T>` is `false`.\r\n\r\nSo I don't think this really changes behavior in any way, but the error you'd get is different (the c++20 one will fail to match the function; the current code here will fail at substitution).",
      "commit_id" : "fafbcfb000583ea5314a6c9bce67641ea278d979",
      "created_at" : "2021-11-04T15:28:37Z",
      "diff_hunk" : "@@ -236,11 +237,35 @@ T& SpanPopBack(Span<T>& span)\n     return back;\n }\n \n+// From C++20 as_bytes and as_writeable_bytes\n+template <typename T>\n+Span<const std::byte> AsBytes(Span<T> s) noexcept\n+{\n+    return {reinterpret_cast<const std::byte*>(s.data()), s.size_bytes()};\n+}\n+template <typename T>\n+Span<std::byte> AsWriteableBytes(Span<T> s) noexcept",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r742950474",
      "id" : 742950474,
      "in_reply_to_id" : 742926098,
      "line" : 247,
      "node_id" : "PRRC_kwDOABII584sSIZK",
      "original_commit_id" : "fab18b8b12c3d2351f9927fc728b0510afe92cda",
      "original_line" : 247,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/span.h",
      "position" : 19,
      "pull_request_review_id" : 797900701,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742950474/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-04T15:28:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742950474",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r742951110"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742951110"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, the current version is closer to a refactor (only touching the type of the pointer). Happy to adjust though, if #23413 makes it in in the meantime. I think both versions are equally acceptable.",
      "commit_id" : "fafbcfb000583ea5314a6c9bce67641ea278d979",
      "created_at" : "2021-11-04T15:29:17Z",
      "diff_hunk" : "@@ -47,87 +47,85 @@ static const unsigned int MAX_VECTOR_ALLOCATE = 5000000;\n struct deserialize_type {};\n constexpr deserialize_type deserialize {};\n \n-//! Safely convert odd char pointer types to standard ones.\n-inline char* CharCast(char* c) { return c; }\n-inline char* CharCast(unsigned char* c) { return (char*)c; }\n-inline const char* CharCast(const char* c) { return c; }\n-inline const char* CharCast(const unsigned char* c) { return (const char*)c; }\n+//! Safely convert a data pointer to a std::byte data pointer.\n+inline std::byte* BytePtr(void* data) { return reinterpret_cast<std::byte*>(data); }\n+inline const std::byte* BytePtr(const void* data) { return reinterpret_cast<const std::byte*>(data); }\n \n /*\n  * Lowest-level serialization and conversion.\n  * @note Sizes of these types are verified in the tests\n  */\n template<typename Stream> inline void ser_writedata8(Stream &s, uint8_t obj)\n {\n-    s.write((char*)&obj, 1);\n+    s.write({BytePtr(&obj), 1});\n }\n template<typename Stream> inline void ser_writedata16(Stream &s, uint16_t obj)\n {\n     obj = htole16(obj);\n-    s.write((char*)&obj, 2);\n+    s.write({BytePtr(&obj), 2});\n }\n template<typename Stream> inline void ser_writedata16be(Stream &s, uint16_t obj)\n {\n     obj = htobe16(obj);\n-    s.write((char*)&obj, 2);\n+    s.write({BytePtr(&obj), 2});\n }\n template<typename Stream> inline void ser_writedata32(Stream &s, uint32_t obj)\n {\n     obj = htole32(obj);\n-    s.write((char*)&obj, 4);\n+    s.write({BytePtr(&obj), 4});\n }\n template<typename Stream> inline void ser_writedata32be(Stream &s, uint32_t obj)\n {\n     obj = htobe32(obj);\n-    s.write((char*)&obj, 4);\n+    s.write({BytePtr(&obj), 4});\n }\n template<typename Stream> inline void ser_writedata64(Stream &s, uint64_t obj)\n {\n     obj = htole64(obj);\n-    s.write((char*)&obj, 8);\n+    s.write({BytePtr(&obj), 8});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r742951110",
      "id" : 742951110,
      "in_reply_to_id" : 742935246,
      "line" : 85,
      "node_id" : "PRRC_kwDOABII584sSIjG",
      "original_commit_id" : "fa441780ee51250df4b8c50852ebe3b83d158f21",
      "original_line" : 85,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 50,
      "pull_request_review_id" : 797901624,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742951110/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-04T15:29:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/742951110",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "There seems to be a bug on msvc, because it doesn't eat the code I prepared. There is also no error. Any ideas @sipsorcery ?",
      "created_at" : "2021-11-04T16:06:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23438#issuecomment-961189440",
      "id" : 961189440,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23438",
      "node_id" : "IC_kwDOABII5845SpZA",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/961189440/reactions"
      },
      "updated_at" : "2021-11-04T16:06:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/961189440",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r744072184"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/744072184"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this could just be `s.ignore(len);`.",
      "commit_id" : "fafbcfb000583ea5314a6c9bce67641ea278d979",
      "created_at" : "2021-11-06T04:09:21Z",
      "diff_hunk" : "@@ -136,22 +136,22 @@ class CPubKey\n     {\n         unsigned int len = size();\n         ::WriteCompactSize(s, len);\n-        s.write((char*)vch, len);\n+        s.write({BytePtr(vch), len});\n     }\n     template <typename Stream>\n     void Unserialize(Stream& s)\n     {\n         unsigned int len = ::ReadCompactSize(s);\n         if (len <= SIZE) {\n-            s.read((char*)vch, len);\n+            s.read({BytePtr(vch), len});\n             if (len != size()) {\n                 Invalidate();\n             }\n         } else {\n             // invalid pubkey, skip available data",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r744072184",
      "id" : 744072184,
      "line" : 151,
      "node_id" : "PRRC_kwDOABII584sWaP4",
      "original_commit_id" : "fa6bde9649bc2ca640a65a9f59cedb8d7e73d1b7",
      "original_line" : 151,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/pubkey.h",
      "position" : 18,
      "pull_request_review_id" : 799414412,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/744072184/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-06T04:09:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/744072184",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r744072273"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/744072273"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any plan to make hash interfaces also use `Span<std::byte>` based arguments?",
      "commit_id" : "fafbcfb000583ea5314a6c9bce67641ea278d979",
      "created_at" : "2021-11-06T04:09:56Z",
      "diff_hunk" : "@@ -111,8 +111,9 @@ class CHashWriter\n     int GetType() const { return nType; }\n     int GetVersion() const { return nVersion; }\n \n-    void write(const char *pch, size_t size) {\n-        ctx.Write((const unsigned char*)pch, size);\n+    void write(Span<const std::byte> src)\n+    {\n+        ctx.Write(UCharCast(src.data()), src.size());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r744072273",
      "id" : 744072273,
      "line" : 116,
      "node_id" : "PRRC_kwDOABII584sWaRR",
      "original_commit_id" : "fa6bde9649bc2ca640a65a9f59cedb8d7e73d1b7",
      "original_line" : 116,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/hash.h",
      "position" : 8,
      "pull_request_review_id" : 799414471,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/744072273/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-06T04:09:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/744072273",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r744102216"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/744102216"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe if I am bored over the holiday season, but not now and not in this pull :sweat_smile: ",
      "commit_id" : "fafbcfb000583ea5314a6c9bce67641ea278d979",
      "created_at" : "2021-11-06T08:59:01Z",
      "diff_hunk" : "@@ -111,8 +111,9 @@ class CHashWriter\n     int GetType() const { return nType; }\n     int GetVersion() const { return nVersion; }\n \n-    void write(const char *pch, size_t size) {\n-        ctx.Write((const unsigned char*)pch, size);\n+    void write(Span<const std::byte> src)\n+    {\n+        ctx.Write(UCharCast(src.data()), src.size());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r744102216",
      "id" : 744102216,
      "in_reply_to_id" : 744072273,
      "line" : 116,
      "node_id" : "PRRC_kwDOABII584sWhlI",
      "original_commit_id" : "fa6bde9649bc2ca640a65a9f59cedb8d7e73d1b7",
      "original_line" : 116,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/hash.h",
      "position" : 8,
      "pull_request_review_id" : 799429500,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/744102216/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-06T08:59:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/744102216",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r744152394"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/744152394"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good idea. Done in https://github.com/bitcoin/bitcoin/pull/23451",
      "commit_id" : "fafbcfb000583ea5314a6c9bce67641ea278d979",
      "created_at" : "2021-11-06T18:05:52Z",
      "diff_hunk" : "@@ -136,22 +136,22 @@ class CPubKey\n     {\n         unsigned int len = size();\n         ::WriteCompactSize(s, len);\n-        s.write((char*)vch, len);\n+        s.write({BytePtr(vch), len});\n     }\n     template <typename Stream>\n     void Unserialize(Stream& s)\n     {\n         unsigned int len = ::ReadCompactSize(s);\n         if (len <= SIZE) {\n-            s.read((char*)vch, len);\n+            s.read({BytePtr(vch), len});\n             if (len != size()) {\n                 Invalidate();\n             }\n         } else {\n             // invalid pubkey, skip available data",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23438#discussion_r744152394",
      "id" : 744152394,
      "in_reply_to_id" : 744072184,
      "line" : 151,
      "node_id" : "PRRC_kwDOABII584sWt1K",
      "original_commit_id" : "fa6bde9649bc2ca640a65a9f59cedb8d7e73d1b7",
      "original_line" : 151,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/pubkey.h",
      "position" : 18,
      "pull_request_review_id" : 799464996,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/23438",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/744152394/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-11-06T18:05:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/744152394",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
