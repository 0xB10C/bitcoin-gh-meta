[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Additional information that may be relevant for reviewers:\r\n\r\n- I've documented my progress on including `sys/sdt.h` in https://github.com/bitcoin/bitcoin/issues/23297\r\n- Build support for the USDT was initially added in https://github.com/bitcoin/bitcoin/pull/19866. Some initial discussion on tracepoints in release builds took place in this thread https://github.com/bitcoin/bitcoin/pull/19866#discussion_r483774808. Some more discussion in a [bitcoin-core-dev meeting January 2021](https://bitcoin.jonasschnelli.ch/ircmeetings/logs/bitcoin-core-dev/2021/bitcoin-core-dev.2021-01-21-19.00.moin.txt).\r\n- There was a [PR review club](https://bitcoincore.reviews/22006) on #22006 \r\n- We have documentation listing tracepoints in a binary in [`doc/tracing.md`](https://github.com/bitcoin/bitcoin/blob/master/doc/tracing.md#listing-available-tracepoints).\r\n- The tracepoints are currently not automatically/CI tested (#23296). Merging this _now_ could leave us with broken tracepoints in a release build.\r\n\r\nI've tested the GUIX binaries on `aarch64-linux-gnu`, `arm-linux-gnueabihf`, `x86_64-linux-gnu` and on `x86_64-w64-mingw32`. I don't have hardware to test on `x86_64-apple-darwin19`, `powerpc64le-linux-gnu`, `powerpc64-linux-gnu`, or `powerpc64-linux-gnu` (though I might try running the binaries in qemu). Any help testing on these platforms would be appreciated. Of course, testing and review on the already tested platforms is welcome too!\r\n\r\n|        platform       \t| binary contains tracepoints \t|                synced signet                \t|        tracepoints tested and working       \t|\r\n|:---------------------:\t|:---------------------------:\t|:-------------------------------------------:\t|:-------------------------------------------:\t|\r\n|   aarch64-linux-gnu   \t|      :heavy_check_mark:     \t|              :heavy_check_mark:             \t|              :heavy_check_mark:             \t|\r\n|  arm-linux-gnueabihf  \t|      :heavy_check_mark:     \t|              :heavy_check_mark:             \t|            :grey_exclamation: **            \t|\r\n|  powerpc64-linux-gnu  \t|      :heavy_check_mark:     \t|                                             \t|                                             \t|\r\n| powerpc64le-linux-gnu \t|      :heavy_check_mark:     \t|                                             \t|                                             \t|\r\n|   riscv64-linux-gnu   \t|      :heavy_check_mark:     \t| [:heavy_check_mark: (laanwj)][laanwj-riscv] \t| [:grey_exclamation: (laanwj)][laanwj-riscv] \t|\r\n|    x86_64-linux-gnu   \t|      :heavy_check_mark:     \t|              :heavy_check_mark:             \t|                    on it                    \t|\r\n| x86_64-apple-darwin19 \t|            - ***            \t|                                             \t|                                             \t|\r\n|   x86_64-w64-mingw32  \t|              -              \t|              :heavy_check_mark:             \t|                      -                      \t|\r\n\r\n[laanwj-riscv]: https://github.com/bitcoin/bitcoin/pull/23724#issuecomment-993847365\r\n\r\n\r\n** bpftrace isn't available on Ubuntu 21.10 for `armhf`. BCC is available, but compiling the C code didn't work. Presumably it only worrks on 64-bit? Needs further testing.\r\n*** ~Maybe the `x86_64-apple-darwin19` binaries contain tracepoints that can be listed with e.g. dtrace on macOS?~ No, tracepoints aren't compiled in as [this check](https://github.com/bitcoin/bitcoin/blob/9015d118425df4a5b34455da15334901ece85ed3/configure.ac#L1347-L1357) fails. This is OK, we currently only support tracepoints on Linux.\r\n\r\n---\r\n\r\n@DrahtBot !request_GUIX_build ",
      "created_at" : "2021-12-09T15:17:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23724#issuecomment-989947889",
      "id" : 989947889,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23724",
      "node_id" : "IC_kwDOABII5847AWfx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989947889/reactions"
      },
      "updated_at" : "2021-12-14T18:51:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989947889",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> There has been light conceptual agreement on including the Userspace, Statically Defined Tracing tracepoints in Bitcoin Core release builds. This, for example, enables user to hook into production deployments, if they need to\r\n\r\nBig concept ACK",
      "created_at" : "2021-12-09T15:20:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23724#issuecomment-989950707",
      "id" : 989950707,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23724",
      "node_id" : "IC_kwDOABII5847AXLz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989950707/reactions"
      },
      "updated_at" : "2021-12-09T15:20:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/989950707",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#22555](https://github.com/bitcoin/bitcoin/pull/22555) (build: Fix `make apk` for Android w/ non-default SOURCES_PATH in depends by hebasto)\n* [#22552](https://github.com/bitcoin/bitcoin/pull/22552) (build: Improve depends build system robustness by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-12-10T17:57:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23724#issuecomment-991177844",
      "id" : 991177844,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23724",
      "node_id" : "IC_kwDOABII5847FCx0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/991177844/reactions"
      },
      "updated_at" : "2021-12-10T17:57:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/991177844",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Any help testing on these platforms would be appreciated. \r\n\r\nAs I have a running RV64 system (SiFive Unmatched) I can give it a try on `riscv64-linux-gnu`. Which steps did you follow for \"synced signet\" and \"tracepoints tested\"? Literally just sync signet, and try the tracepoint examples?",
      "created_at" : "2021-12-13T16:24:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23724#issuecomment-992645502",
      "id" : 992645502,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23724",
      "node_id" : "IC_kwDOABII5847KpF-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/992645502/reactions"
      },
      "updated_at" : "2021-12-13T16:24:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/992645502",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK, will test soon",
      "created_at" : "2021-12-13T16:45:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23724#issuecomment-992666598",
      "id" : 992666598,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23724",
      "node_id" : "IC_kwDOABII5847KuPm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/992666598/reactions"
      },
      "updated_at" : "2021-12-13T16:45:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/992666598",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I can give it a try on `riscv64-linux-gnu`.\r\n\r\nThanks @laanwj! That would be awesome!\r\n\r\n> Which steps did you follow for \"synced signet\" and \"tracepoints tested\"? Literally just sync signet, and try the tracepoint examples?\r\n\r\nYes. By syncing signet I just wanted to make sure nothing is horribly broken on that arch (I see no reason why it should be). Running the tests suits should work as well. I ran the `p2p_monitor.py` and a `bpftrace` example to test the tracepoints. Happy to do further testing if needed!",
      "created_at" : "2021-12-13T17:25:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23724#issuecomment-992703038",
      "id" : 992703038,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23724",
      "node_id" : "IC_kwDOABII5847K3I-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/992703038/reactions"
      },
      "updated_at" : "2021-12-14T15:43:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/992703038",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "We'll be discussing this PR in the BItcoin Core PR review club this Wednesday at 17:00 UTC: https://bitcoincore.reviews/23724",
      "created_at" : "2021-12-13T17:28:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23724#issuecomment-992705074",
      "id" : 992705074,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23724",
      "node_id" : "IC_kwDOABII5847K3oy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/992705074/reactions"
      },
      "updated_at" : "2021-12-13T17:28:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/992705074",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Tested on riscv64-linux-gnu:\r\n\r\n- :heavy_check_mark: Tracepoints are present in the binary (checked only `bitcoind` and `bitcoin-qt`)\r\n```\r\n$ gdb bitcoind\r\nGNU gdb (Debian 10.1-2) 10.1.90.20210103-git\r\n(gdb) info probes\r\nType Provider   Name             Where              Semaphore Object\r\nstap net        inbound_message  0x00000000000ea198           /â¦/bitcoin-070570806404/bin/bitcoind\r\nâ¦\r\n```\r\n- :heavy_check_mark: Signet sync from scratch to successful to height=68616\r\n- :woman_shrugging: Tracepoints tested\r\n\r\nNo bcc or bpftrace packages exist for RISC-V debian, so I had to build them from source (against clang13).\r\n\r\nBcc builds successfully (including python module), unfortunately, bpftrace doesn't support riscv64 at the moment:\r\n```\r\nCMake Error at src/arch/CMakeLists.txt:14 (message):\r\n  Unsupported architecture: riscv64\r\n```\r\n\r\nTrying to run the python scripts runs into parse errors:\r\n```\r\n# ./log_raw_p2p_msgs.py â¦/bitcoin-070570806404/bin/bitcoind\r\nParse error:\r\n    -8@s2 8@s3 8@a0 8@24(s1) 8@a5 8@a4\r\n---------^\r\nParse error:\r\n    -8@s2 8@s3 8@a0 8@24(s1) 8@a5 8@a4\r\n--------------^\r\nParse error:\r\n    -8@s2 8@s3 8@a0 8@24(s1) 8@a5 8@a4\r\n-------------------^\r\nParse error:\r\n    -8@s2 8@s3 8@a0 8@24(s1) 8@a5 8@a4\r\n```\r\n\r\nSo I think this is a no-go for now.",
      "created_at" : "2021-12-14T18:13:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/23724#issuecomment-993847365",
      "id" : 993847365,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/23724",
      "node_id" : "IC_kwDOABII5847POhF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 1,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 2,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/993847365/reactions"
      },
      "updated_at" : "2021-12-14T18:32:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/993847365",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
