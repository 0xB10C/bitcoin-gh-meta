[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This PR was suggested by @hebasto https://github.com/bitcoin/bitcoin/pull/16981#issuecomment-669658597 (thank you!)",
      "created_at" : "2020-08-10T03:50:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-671150925",
      "id" : 671150925,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MTE1MDkyNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-10T03:50:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671150925",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r467746632"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/467746632"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, join with above line.",
      "commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "created_at" : "2020-08-10T08:09:41Z",
      "diff_hunk" : "@@ -832,12 +832,21 @@ class CBufferedFile\n \n     //! search for a given byte in the stream, and remain positioned on it\n     void FindByte(char ch) {\n+        // start is the index into vchBuf[] at which to start searching\n+        size_t start = nReadPos % vchBuf.size();\n         while (true) {\n             if (nReadPos == nSrcPos)\n                 Fill();\n-            if (vchBuf[nReadPos % vchBuf.size()] == ch)\n-                break;\n-            nReadPos++;\n+            size_t n = vchBuf.size() - start;\n+            if (n > nSrcPos - nReadPos)\n+                n = nSrcPos - nReadPos;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r467746632",
      "id" : 467746632,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2Nzc0NjYzMg==",
      "original_commit_id" : "ab412ec3071dd056bad362aa78c88d02d5a46c3b",
      "original_line" : 842,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/streams.h",
      "position" : null,
      "pull_request_review_id" : 464028727,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-05T01:10:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/467746632",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@LarryRuane \r\n> ... improving its CPU runtime by a factor of about 25 in typical use.\r\n\r\nHow was it measured?\r\n\r\n",
      "created_at" : "2020-08-10T11:10:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-671293857",
      "id" : 671293857,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MTI5Mzg1Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-10T11:10:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671293857",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Any idea *why* this is so much faster? As far as I know, there is no faster algorithm to look for the first occurrence of a single byte in a memory array than a linear iteration over it. I'd expect `std::find` of a byte to simply unroll into a loop.",
      "created_at" : "2020-08-10T11:38:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-671305132",
      "id" : 671305132,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MTMwNTEzMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-10T11:38:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671305132",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> How was it measured?\r\n\r\nI ran:\r\n```\r\ntime src/test/test_bitcoin --run_test=streams_tests/streams_findbyte\r\n```\r\nwith master (1m20s) and with master + PR (3s).\r\n\r\n> Any idea _why_ this is so much faster? \r\n\r\nI think you're correct that there's no faster way than a loop with runtime proportional to the number of bytes to scan, but I assume `std::find()` on a char vector is highly optimized, probably using `memchr()` or `memcmp()`, which are implemented in assembly language. Also, the master version does a few things each byte (testing `nReadPos == nSrcPos`, remainder calculation (`%`), incrementing `nReadPos`) that the PR does once for each large run of bytes.\r\n\r\nI just noticed that the repetition count on the test is set to a large number (50000000) and I meant to reduce it for the commit (3 seconds is too long to add to the unit test suite). I'll reduce that number in force push in a minute. This test doesn't really need to be in this PR (`FindByte()`'s functionality is tested very well in another test), but it helps reviewers verify the performance improvement.",
      "created_at" : "2020-08-10T14:38:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-671395708",
      "id" : 671395708,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MTM5NTcwOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-10T14:38:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671395708",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Force-push ([diff](https://github.com/bitcoin/bitcoin/compare/ab412ec3071dd056bad362aa78c88d02d5a46c3b..a31aa3255499ba8878ba98e4ac5a22a408c68da0)) small fix to the test, so it doesn't take 3 seconds to run.",
      "created_at" : "2020-08-10T14:46:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-671400344",
      "id" : 671400344,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MTQwMDM0NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-10T14:46:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671400344",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> but I assume std::find() on a char vector is highly optimized, probably using memchr() or memcmp(), which are implemented in assembly language\r\n\r\nThat's true, it's possible to optimize that with assembly language (definitely with specific instruction sets).\r\n\r\nit still surprises me because you'd expect the I/O, to read the data from disk, to dominate greatly in the block importing. Not looking for a character already in memory! It just seems out of proportion.\r\n",
      "created_at" : "2020-08-10T16:43:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-671464582",
      "id" : 671464582,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MTQ2NDU4Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-10T16:43:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671464582",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r468123489"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/468123489"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I don't fully understand how the performance increase is so significant, but why not a bench if you're worried about burdening the unit tests? I [tried](https://github.com/gzhao408/bitcoin/blob/c3f7075f538cca89f44923d9489403581650edc8/src/bench/streams_findbyte.cpp) to do this but I must be doing something wrong because I can't seem to reproduce the speedup. ð ",
      "commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "created_at" : "2020-08-10T19:19:00Z",
      "diff_hunk" : "@@ -445,4 +445,29 @@ BOOST_AUTO_TEST_CASE(streams_buffered_file_rand)\n     fs::remove(\"streams_test_tmp\");\n }\n \n+// This test helps compare the performance of FindByte() implementations;\n+// its functionality is tested in the test above. Set the repetition\n+// limit (500) to a larger value and then time the test.\n+BOOST_AUTO_TEST_CASE(streams_findbyte)\n+{\n+    FILE* file = fsbridge::fopen(\"streams_test_tmp\", \"w+b\");\n+    const size_t fileSize = 200;\n+    uint8_t b = 0;\n+    for (size_t i = 0; i < fileSize; ++i) {\n+        fwrite(&b, 1, 1, file);\n+    }\n+    b = 1;\n+    fwrite(&b, 1, 1, file);\n+    rewind(file);\n+    CBufferedFile bf(file, fileSize * 2, fileSize, 0, 0);\n+    for (int rep = 0; rep < 100; ++rep) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r468123489",
      "id" : 468123489,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODEyMzQ4OQ==",
      "original_commit_id" : "a31aa3255499ba8878ba98e4ac5a22a408c68da0",
      "original_line" : 463,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/test/streams_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 464505498,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-05T01:10:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/468123489",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> it still surprises me because you'd expect the I/O, to read the data from disk, to dominate greatly in the block importing.\r\n\r\n`FindByte()` only reads from disk by calling `Fill()` (when the buffer is empty), which is rare. In this test, `Fill()` gets called only once, the first time `FindByte()` runs, because I wanted to isolate the modified part of the code.",
      "created_at" : "2020-08-10T20:08:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-671562959",
      "id" : 671562959,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MTU2Mjk1OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-10T20:08:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671562959",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r468154617"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/468154617"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The performance impact may be very compiler/architecture/stdlib dependent. I'm kind of surprised std::find has optimizations beyond the naive loop implementation in the first place on some platforms, so I certainly wouldn't be surprised if others don't have it.",
      "commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "created_at" : "2020-08-10T20:12:43Z",
      "diff_hunk" : "@@ -445,4 +445,29 @@ BOOST_AUTO_TEST_CASE(streams_buffered_file_rand)\n     fs::remove(\"streams_test_tmp\");\n }\n \n+// This test helps compare the performance of FindByte() implementations;\n+// its functionality is tested in the test above. Set the repetition\n+// limit (500) to a larger value and then time the test.\n+BOOST_AUTO_TEST_CASE(streams_findbyte)\n+{\n+    FILE* file = fsbridge::fopen(\"streams_test_tmp\", \"w+b\");\n+    const size_t fileSize = 200;\n+    uint8_t b = 0;\n+    for (size_t i = 0; i < fileSize; ++i) {\n+        fwrite(&b, 1, 1, file);\n+    }\n+    b = 1;\n+    fwrite(&b, 1, 1, file);\n+    rewind(file);\n+    CBufferedFile bf(file, fileSize * 2, fileSize, 0, 0);\n+    for (int rep = 0; rep < 100; ++rep) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r468154617",
      "id" : 468154617,
      "in_reply_to_id" : 468123489,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODE1NDYxNw==",
      "original_commit_id" : "a31aa3255499ba8878ba98e4ac5a22a408c68da0",
      "original_line" : 463,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/test/streams_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 464554332,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-05T01:10:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/468154617",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r468201206"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/468201206"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@gzhao408, thank you, I wasn't aware of `bench`. I suspect the iteration count, 100, is far too low and the difference is swamped by the noise. I increased the iteration count to 10m (`1e7`) and it showed the expected difference, master: 1,659.30 ns/op, PR: 52.66 ns/op (ratio is about 31).\r\n\r\nI just force-pushed ([diff](https://github.com/bitcoin/bitcoin/compare/a31aa3255499ba8878ba98e4ac5a22a408c68da0..8b07e17cb2a20db8c803cfbb8491ae51a75bd450)) to remove the unit test (which was only for benchmarking, not really testing anything) and cherry-pick Gloria's benchmark. I added one more commit to increase the iteration count.",
      "commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "created_at" : "2020-08-10T21:39:25Z",
      "diff_hunk" : "@@ -445,4 +445,29 @@ BOOST_AUTO_TEST_CASE(streams_buffered_file_rand)\n     fs::remove(\"streams_test_tmp\");\n }\n \n+// This test helps compare the performance of FindByte() implementations;\n+// its functionality is tested in the test above. Set the repetition\n+// limit (500) to a larger value and then time the test.\n+BOOST_AUTO_TEST_CASE(streams_findbyte)\n+{\n+    FILE* file = fsbridge::fopen(\"streams_test_tmp\", \"w+b\");\n+    const size_t fileSize = 200;\n+    uint8_t b = 0;\n+    for (size_t i = 0; i < fileSize; ++i) {\n+        fwrite(&b, 1, 1, file);\n+    }\n+    b = 1;\n+    fwrite(&b, 1, 1, file);\n+    rewind(file);\n+    CBufferedFile bf(file, fileSize * 2, fileSize, 0, 0);\n+    for (int rep = 0; rep < 100; ++rep) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r468201206",
      "id" : 468201206,
      "in_reply_to_id" : 468123489,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2ODIwMTIwNg==",
      "original_commit_id" : "a31aa3255499ba8878ba98e4ac5a22a408c68da0",
      "original_line" : 463,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/test/streams_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 464606792,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-05T01:10:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/468201206",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gmaxwell pointed out to me why this is so much faster: it's not that std::find is amazing, but that the original code (which I wrote in 2012, it seems!) is doing a modulus operation for every character (which is often orders of magnitude slower than the byte comparison or addition/subtraction).\r\n\r\nThinking about this a bit more high level: the end goal is just to scan quickly for the 4-byte network magic in a file. If this is relevant for performance (and it seems it may be), it may be better to have a function that does exactly that in CBufferedFile, rather than a search for one byte + memcmp. `std::search` is probably what you want.\r\n\r\n",
      "created_at" : "2020-08-11T00:42:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-671659440",
      "id" : 671659440,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MTY1OTQ0MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-11T00:42:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671659440",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Here's a version that's very close in implementation to master that eliminates the `%` operation on every character:\r\n```\r\n    void FindByte(char ch) {\r\n        size_t start = nReadPos % vchBuf.size();\r\n        while (true) {\r\n            if (nReadPos == nSrcPos)\r\n                Fill();\r\n            if (vchBuf[start] == ch)\r\n                break;\r\n            nReadPos++;\r\n            start++;\r\n            if (start >= vchBuf.size()) start = 0;\r\n        }\r\n```\r\nand that does make a significant difference; `bench_bitcoin` reports 314 ns/op for this version. (My laptop isn't set up for very accurate CPU benchmarking, but my results are pretty consistent, varying by less than 1% across multiple runs.) That's about 5.3 times as fast as master (1,659.30 ns/op, as [mentioned above](https://github.com/bitcoin/bitcoin/pull/19690#discussion_r468201206)). The PR (52.66 ns/op) is still about 6 times faster than this version. So this version is right about in the middle (in terms of ratios) between master and this PR.\r\n\r\nI do like @sipa's suggestion to generalize `FindByte()` to search for a given sequence of bytes (maybe called `FindBytes()` or `Search()`, suggestions welcome); that's a much nicer interface. I'll push a commit to do that within the next few hours.",
      "created_at" : "2020-08-12T14:10:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-672894853",
      "id" : 672894853,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3Mjg5NDg1Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-12T17:56:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/672894853",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I just added a new commit (25413ab, can squash later) to implement @sipa's suggestion to add a method to `CBufferedFile` to find a sequence of bytes, rather than just one byte, as `FindByte()` does. This simplifies `LoadExternalBlockFile()`; the overall code base isn't simpler, but it encapsulates complexity nicely within the `CBufferedFile` class. \r\n\r\nIt didn't work out to use `std::search()` because that function requires the bytes being searched to be consecutive in memory -- that works if the entire file is read into contiguous memory. But `CBufferedFile` implements a circular buffer. The bytes we're searching for might be partially in and partially out of memory (bytes are read on demand), and even if all are in memory, they may be split between the end of the buffer and the beginning (because of wraparound), so trying to use `std::search` gets complicated. `FindByte()` doesn't have these problems since it's looking for a single byte.",
      "created_at" : "2020-08-13T05:35:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-673270669",
      "id" : 673270669,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MzI3MDY2OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-13T05:35:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/673270669",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Looks like one of the sanitizers is finding an implicit-integer-sign-change problem in the latest update:\r\n\r\n```\r\nï¿½[0;34m node0 stderr streams.h:857:22: runtime error: implicit conversion from type 'unsigned char' of value 250 (8-bit, unsigned) to type 'char' changed the value to -6 (8-bit, signed)\r\n    #0 0x55f6d4cc6285 in CBufferedFile::Search(unsigned char const*, unsigned long) /tmp/cirrus-ci-build/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/./streams.h:857:22\r\n    #1 0x55f6d4c967a0 in LoadExternalBlockFile(CChainParams const&, _IO_FILE*, FlatFilePos*) /tmp/cirrus-ci-build/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/validation.cpp:4682:24\r\n    #2 0x55f6d45071f6 in ThreadImport(ChainstateManager&, std::vector<boost::filesystem::path, std::allocator<boost::filesystem::path> >) /tmp/cirrus-ci-build/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/init.cpp:705:13\r\n    #3 0x55f6d4506814 in AppInitMain(util::Ref const&, NodeContext&)::$_10::operator()() const /tmp/cirrus-ci-build/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/init.cpp:1853:96\r\n    #4 0x55f6d4506814 in std::_Function_handler<void (), AppInitMain(util::Ref const&, NodeContext&)::$_10>::_M_invoke(std::_Any_data const&) /usr/bin/../lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/bits/std_function.h:300:2\r\n    #5 0x55f6d4585b29 in std::function<void ()>::operator()() const /usr/bin/../lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/bits/std_function.h:688:14\r\n    #6 0x55f6d45181bb in void TraceThread<std::function<void ()> >(char const*, std::function<void ()>) /tmp/cirrus-ci-build/ci/scratch/build/bitcoin-x86_64-pc-linux-gnu/src/./util/system.h:438:9\r\n    #7 0x55f6d4506447 in void std::__invoke_impl<void, void (*)(char const*, std::function<void ()>), char const*, AppInitMain(util::Ref const&, NodeContext&)::$_10>(std::__invoke_other, void (*&&)(char const*, std::function<void ()>), char const*&&, AppInitMain(util::Ref const&, NodeContext&)::$_10&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/bits/invoke.h:60:14\r\n    #8 0x55f6d450616a in std::__invoke_result<void (*)(char const*, std::function<void ()>), char const*, AppInitMain(util::Ref const&, NodeContext&)::$_10>::type std::__invoke<void (*)(char const*, std::function<void ()>), char const*, AppInitMain(util::Ref const&, NodeContext&)::$_10>(void (*&&)(char const*, std::function<void ()>), char const*&&, AppInitMain(util::Ref const&, NodeContext&)::$_10&&) /usr/bin/../lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/bits/invoke.h:95:14\r\n    #9 0x55f6d4505db2 in void std::thread::_Invoker<std::tuple<void (*)(char const*, std::function<void ()>), char const*, AppInitMain(util::Ref const&, NodeContext&)::$_10> >::_M_invoke<0ul, 1ul, 2ul>(std::_Index_tuple<0ul, 1ul, 2ul>) /usr/bin/../lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/thread:244:13\r\n    #10 0x55f6d4505db2 in std::thread::_Invoker<std::tuple<void (*)(char const*, std::function<void ()>), char const*, AppInitMain(util::Ref const&, NodeContext&)::$_10> >::operator()() /usr/bin/../lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/thread:251:11\r\n    #11 0x55f6d4505db2 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<void (*)(char const*, std::function<void ()>), char const*, AppInitMain(util::Ref const&, NodeContext&)::$_10> > >::_M_run() /usr/bin/../lib/gcc/x86_64-linux-gnu/9/../../../../include/c++/9/thread:195:13\r\n    #12 0x7f20f2f18cb3  (/lib/x86_64-linux-gnu/libstdc++.so.6+0xd6cb3)\r\n    #13 0x7f20f3317608 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x9608)\r\n    #14 0x7f20f2bf5102 in clone (/lib/x86_64-linux-gnu/libc.so.6+0x122102)\r\n\r\nSUMMARY: UndefinedBehaviorSanitizer: implicit-integer-sign-change streams.h:857:22\r\n```",
      "created_at" : "2020-08-14T00:39:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-673777171",
      "id" : 673777171,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3Mzc3NzE3MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-14T00:40:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/673777171",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/755825?v=4",
         "events_url" : "https://api.github.com/users/adamjonas/events{/privacy}",
         "followers_url" : "https://api.github.com/users/adamjonas/followers",
         "following_url" : "https://api.github.com/users/adamjonas/following{/other_user}",
         "gists_url" : "https://api.github.com/users/adamjonas/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/adamjonas",
         "id" : 755825,
         "login" : "adamjonas",
         "node_id" : "MDQ6VXNlcjc1NTgyNQ==",
         "organizations_url" : "https://api.github.com/users/adamjonas/orgs",
         "received_events_url" : "https://api.github.com/users/adamjonas/received_events",
         "repos_url" : "https://api.github.com/users/adamjonas/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/adamjonas/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/adamjonas/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/adamjonas"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, @adamjonas, force-pushed a fix for that signed-unsigned CI failure, added another unit test, some improvements to `Search()`, some `clang-format-diff.py` cleanups.",
      "created_at" : "2020-08-14T06:05:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-673904127",
      "id" : 673904127,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MzkwNDEyNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-07T17:53:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/673904127",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #16981 (Improve runtime performance of --reindex by LarryRuane)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-08-20T20:44:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-677894346",
      "id" : 677894346,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3Nzg5NDM0Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-27T14:19:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/677894346",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r479749877"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/479749877"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Could we maybe use something like `memfd_create(2)` for the benchmark, to decrease I/O noise?\r\nAnyone knows if there is a windows equivalent or a higher abstraction in boost::filesystem?\r\n",
      "commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "created_at" : "2020-08-30T10:09:09Z",
      "diff_hunk" : "@@ -0,0 +1,33 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <bench/bench.h>\n+#include <streams.h>\n+#include <test/util/setup_common.h>\n+\n+static void FindByte(benchmark::Bench& bench)\n+{\n+    // Setup\n+    FILE* file = fsbridge::fopen(\"streams_tmp\", \"w+b\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r479749877",
      "id" : 479749877,
      "line" : 12,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTc0OTg3Nw==",
      "original_commit_id" : "8f2e8c27bb9bb3ebb9f094129ce4a6019c46cfc0",
      "original_line" : 12,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/bench/streams_findbyte.cpp",
      "position" : 12,
      "pull_request_review_id" : 478189618,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-05T01:10:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/479749877",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2167860?v=4",
         "events_url" : "https://api.github.com/users/elichai/events{/privacy}",
         "followers_url" : "https://api.github.com/users/elichai/followers",
         "following_url" : "https://api.github.com/users/elichai/following{/other_user}",
         "gists_url" : "https://api.github.com/users/elichai/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/elichai",
         "id" : 2167860,
         "login" : "elichai",
         "node_id" : "MDQ6VXNlcjIxNjc4NjA=",
         "organizations_url" : "https://api.github.com/users/elichai/orgs",
         "received_events_url" : "https://api.github.com/users/elichai/received_events",
         "repos_url" : "https://api.github.com/users/elichai/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/elichai/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/elichai/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/elichai"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r479750181"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/479750181"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "`fmemopen(3)` also looks interesting",
      "commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "created_at" : "2020-08-30T10:12:09Z",
      "diff_hunk" : "@@ -0,0 +1,33 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <bench/bench.h>\n+#include <streams.h>\n+#include <test/util/setup_common.h>\n+\n+static void FindByte(benchmark::Bench& bench)\n+{\n+    // Setup\n+    FILE* file = fsbridge::fopen(\"streams_tmp\", \"w+b\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r479750181",
      "id" : 479750181,
      "in_reply_to_id" : 479749877,
      "line" : 12,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTc1MDE4MQ==",
      "original_commit_id" : "8f2e8c27bb9bb3ebb9f094129ce4a6019c46cfc0",
      "original_line" : 12,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/bench/streams_findbyte.cpp",
      "position" : 12,
      "pull_request_review_id" : 478189834,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-05T01:10:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/479750181",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2167860?v=4",
         "events_url" : "https://api.github.com/users/elichai/events{/privacy}",
         "followers_url" : "https://api.github.com/users/elichai/followers",
         "following_url" : "https://api.github.com/users/elichai/following{/other_user}",
         "gists_url" : "https://api.github.com/users/elichai/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/elichai",
         "id" : 2167860,
         "login" : "elichai",
         "node_id" : "MDQ6VXNlcjIxNjc4NjA=",
         "organizations_url" : "https://api.github.com/users/elichai/orgs",
         "received_events_url" : "https://api.github.com/users/elichai/received_events",
         "repos_url" : "https://api.github.com/users/elichai/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/elichai/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/elichai/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/elichai"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r479751366"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/479751366"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Maybe this can give us that? https://www.boost.org/doc/libs/1_72_0/libs/iostreams/doc/classes/mapped_file.html",
      "commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "created_at" : "2020-08-30T10:24:53Z",
      "diff_hunk" : "@@ -0,0 +1,33 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <bench/bench.h>\n+#include <streams.h>\n+#include <test/util/setup_common.h>\n+\n+static void FindByte(benchmark::Bench& bench)\n+{\n+    // Setup\n+    FILE* file = fsbridge::fopen(\"streams_tmp\", \"w+b\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r479751366",
      "id" : 479751366,
      "in_reply_to_id" : 479749877,
      "line" : 12,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3OTc1MTM2Ng==",
      "original_commit_id" : "8f2e8c27bb9bb3ebb9f094129ce4a6019c46cfc0",
      "original_line" : 12,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/bench/streams_findbyte.cpp",
      "position" : 12,
      "pull_request_review_id" : 478190588,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-05T01:10:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/479751366",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2167860?v=4",
         "events_url" : "https://api.github.com/users/elichai/events{/privacy}",
         "followers_url" : "https://api.github.com/users/elichai/followers",
         "following_url" : "https://api.github.com/users/elichai/following{/other_user}",
         "gists_url" : "https://api.github.com/users/elichai/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/elichai",
         "id" : 2167860,
         "login" : "elichai",
         "node_id" : "MDQ6VXNlcjIxNjc4NjA=",
         "organizations_url" : "https://api.github.com/users/elichai/orgs",
         "received_events_url" : "https://api.github.com/users/elichai/received_events",
         "repos_url" : "https://api.github.com/users/elichai/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/elichai/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/elichai/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/elichai"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r480206669"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/480206669"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the suggestions, but I don't think this matters, because the file IO (read) occurs only on the very first benchmark loop iteration; after that, the data is in memory and there is no IO at all. Each iteration repositions the stream pointer to zero (`bf.SetPos(0)`) and then searches forward for the value 1 (`bf.FindByte(1)`), which is 200 bytes away. But after the first iteration, all of these bytes are in memory, and we're just moving the position between 0 and 200. \r\n\r\nThe reason for the 200, by the way, is that with random data, searching for a random byte value the average distance would be half of 256. But the data in `blk.dat` files (which is the only use of this code currently) isn't quite random; zero and `0xff` occur more often (and we never search for those values). So I guessed that 200 is close to a typical distance that this function would move through before finding the requested byte. Maybe I should explain these points in a comment in `bench/streams_findbyte.cpp`.",
      "commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "created_at" : "2020-08-31T15:28:02Z",
      "diff_hunk" : "@@ -0,0 +1,33 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <bench/bench.h>\n+#include <streams.h>\n+#include <test/util/setup_common.h>\n+\n+static void FindByte(benchmark::Bench& bench)\n+{\n+    // Setup\n+    FILE* file = fsbridge::fopen(\"streams_tmp\", \"w+b\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r480206669",
      "id" : 480206669,
      "in_reply_to_id" : 479749877,
      "line" : 12,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MDIwNjY2OQ==",
      "original_commit_id" : "8f2e8c27bb9bb3ebb9f094129ce4a6019c46cfc0",
      "original_line" : 12,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/bench/streams_findbyte.cpp",
      "position" : 12,
      "pull_request_review_id" : 478715042,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-05T01:10:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/480206669",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK 8f2e8c27bb9bb3ebb9f094129ce4a6019c46cfc0, this looks like a better abstraction, and it's an improvement not to do a modulus for every byte.",
      "created_at" : "2020-11-20T04:08:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-730832077",
      "id" : 730832077,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczMDgzMjA3Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-20T04:08:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/730832077",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Force-pushed to rationalize the commits, so I think it's in a good state for merging. I reordered the commit that adds the benchmark test, b576994bea620c7d065dd558c93222391151c9ff, to be first, so it's easy for reviewers to checkout that commit and run the new benchmark test without the improvements:\r\n```\r\nsrc/bench/bench_bitcoin -filter=FindByte\r\n```\r\nI re-ran those tests just now, and on my laptop, the ns/op without the PR is 1,840, and with the PR it's 55 (an improvement of more than a factor of 33).",
      "created_at" : "2020-12-04T21:33:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-739032586",
      "id" : 739032586,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczOTAzMjU4Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-04T21:39:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/739032586",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK 566c2e2eec1e84af5143f1554613a89192e29433. I think it'd be good to move the refactoring to FindByte in the last commit to a separate commit.\r\n",
      "created_at" : "2020-12-04T22:33:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-739059080",
      "id" : 739059080,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczOTA1OTA4MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-04T22:33:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/739059080",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Force-pushed to implement latest [review suggestion](https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-739059080), changes are more cleanly separated among the commits (no code changes overall), thanks @sipa.",
      "created_at" : "2020-12-05T01:14:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-739098789",
      "id" : 739098789,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczOTA5ODc4OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-05T01:14:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/739098789",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r536789178"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/536789178"
         }
      },
      "author_association" : "MEMBER",
      "body" : "b576994bea620c7d065dd558c93222391151c9ff, nit: Add EOL\r\n![Screenshot from 2020-12-05 16-27-26](https://user-images.githubusercontent.com/32963518/101245636-d490ce00-3716-11eb-87e3-090b962e850f.png)\r\n",
      "commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "created_at" : "2020-12-05T14:28:07Z",
      "diff_hunk" : "@@ -0,0 +1,33 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <bench/bench.h>\n+#include <streams.h>\n+#include <test/util/setup_common.h>\n+\n+static void FindByte(benchmark::Bench& bench)\n+{\n+    // Setup\n+    FILE* file = fsbridge::fopen(\"streams_tmp\", \"w+b\");\n+    const size_t fileSize = 200;\n+    uint8_t b = 0;\n+    for (size_t i = 0; i < fileSize; ++i) {\n+        fwrite(&b, 1, 1, file);\n+    }\n+    b = 1;\n+    fwrite(&b, 1, 1, file);\n+    rewind(file);\n+    CBufferedFile bf(file, fileSize * 2, fileSize, 0, 0);\n+\n+    bench.minEpochIterations(1e7).run([&] {\n+        bf.SetPos(0);\n+        bf.FindByte(1);\n+    });\n+\n+    // Cleanup\n+    bf.fclose();\n+    fs::remove(\"streams_tmp\");\n+}\n+\n+BENCHMARK(FindByte);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r536789178",
      "id" : 536789178,
      "line" : 33,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjc4OTE3OA==",
      "original_commit_id" : "b576994bea620c7d065dd558c93222391151c9ff",
      "original_line" : 33,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/bench/streams_findbyte.cpp",
      "position" : 33,
      "pull_request_review_id" : 545591220,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-05T14:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/536789178",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r536790148"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/536790148"
         }
      },
      "author_association" : "MEMBER",
      "body" : "134de90f2b64ede6dbd812a9a88b00708685394d\r\n```suggestion\r\n    BOOST_CHECK_EXCEPTION(bf.FindByte(99), std::ios_base::failure, HasReason(\"CBufferedFile::Fill: end of file\"));```",
      "commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "created_at" : "2020-12-05T14:30:19Z",
      "diff_hunk" : "@@ -329,12 +329,80 @@ BOOST_AUTO_TEST_CASE(streams_buffered_file)\n     // by the rewind window (relative to our farthest read position, 40).\n     BOOST_CHECK(bf.GetPos() <= 30);\n \n+    bf.FindByte(31);\n+    BOOST_CHECK_EQUAL(bf.GetPos(), 31U);\n+\n+    // If the byte isn't found, end of file.\n+    try {\n+        bf.FindByte(99);\n+        BOOST_CHECK(false);\n+    } catch (const std::exception& e) {\n+        BOOST_CHECK(strstr(e.what(),\n+                           \"CBufferedFile::Fill: end of file\") != nullptr);\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r536790148",
      "id" : 536790148,
      "line" : 342,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjc5MDE0OA==",
      "original_commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "original_line" : 342,
      "original_position" : 14,
      "original_start_line" : 336,
      "path" : "src/test/streams_tests.cpp",
      "position" : 14,
      "pull_request_review_id" : 545591220,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690",
      "side" : "RIGHT",
      "start_line" : 336,
      "start_side" : "RIGHT",
      "updated_at" : "2020-12-05T14:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/536790148",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r536790336"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/536790336"
         }
      },
      "author_association" : "MEMBER",
      "body" : "134de90f2b64ede6dbd812a9a88b00708685394d\r\n```suggestion\r\n        BOOST_CHECK_EXCEPTION(bf.Search(needle, 2), std::ios_base::failure, HasReason(\"CBufferedFile::Fill: end of file\"));\r\n```",
      "commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "created_at" : "2020-12-05T14:30:47Z",
      "diff_hunk" : "@@ -329,12 +329,80 @@ BOOST_AUTO_TEST_CASE(streams_buffered_file)\n     // by the rewind window (relative to our farthest read position, 40).\n     BOOST_CHECK(bf.GetPos() <= 30);\n \n+    bf.FindByte(31);\n+    BOOST_CHECK_EQUAL(bf.GetPos(), 31U);\n+\n+    // If the byte isn't found, end of file.\n+    try {\n+        bf.FindByte(99);\n+        BOOST_CHECK(false);\n+    } catch (const std::exception& e) {\n+        BOOST_CHECK(strstr(e.what(),\n+                           \"CBufferedFile::Fill: end of file\") != nullptr);\n+    }\n+    BOOST_CHECK_EQUAL(bf.GetPos(), 40U);\n+    BOOST_CHECK(bf.eof());\n+\n+    // Test Search(), it leaves the postion just after the found bytes.\n+    BOOST_CHECK(bf.SetPos(30));\n+    {\n+        unsigned char needle[2] = {32, 33};\n+        bf.Search(needle, 2);\n+    }\n+    BOOST_CHECK_EQUAL(bf.GetPos(), 34U);\n+\n+    // The bytes must be consecutive, this won't be found.\n+    {\n+        unsigned char needle[2] = {36, 38};\n+        try {\n+            bf.Search(needle, 2);\n+            BOOST_CHECK(false);\n+        } catch (const std::exception& e) {\n+            BOOST_CHECK(strstr(e.what(),\n+                               \"CBufferedFile::Fill: end of file\") != nullptr);\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r536790336",
      "id" : 536790336,
      "line" : 363,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjc5MDMzNg==",
      "original_commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "original_line" : 363,
      "original_position" : 35,
      "original_start_line" : 357,
      "path" : "src/test/streams_tests.cpp",
      "position" : 35,
      "pull_request_review_id" : 545591220,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690",
      "side" : "RIGHT",
      "start_line" : 357,
      "start_side" : "RIGHT",
      "updated_at" : "2020-12-05T14:31:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/536790336",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r536812913"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/536812913"
         }
      },
      "author_association" : "MEMBER",
      "body" : "While the `CBufferedFile` class is already touched, maybe make `CBufferedFile::Fill` private by removing this line?",
      "commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "created_at" : "2020-12-05T15:54:43Z",
      "diff_hunk" : "@@ -718,7 +718,7 @@ class CBufferedFile\n     uint64_t nReadPos;    //!< how many bytes have been read from this\n     uint64_t nReadLimit;  //!< up to which position we're allowed to read\n     uint64_t nRewind;     //!< how many bytes we guarantee to rewind\n-    std::vector<char> vchBuf; //!< the buffer\n+    std::vector<unsigned char> vchBuf; //!< the buffer\n \n protected:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#discussion_r536812913",
      "id" : 536812913,
      "line" : 723,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzNjgxMjkxMw==",
      "original_commit_id" : "134de90f2b64ede6dbd812a9a88b00708685394d",
      "original_line" : 723,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/streams.h",
      "position" : 7,
      "pull_request_review_id" : 545596887,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19690",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-05T15:54:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/536812913",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@LarryRuane \r\n\r\nThanks for providing promising micro benchmarks. AFAICT `FindByte` is only used when doing `-reindex` and `-loadblock`. Do you have any macro numbers too where the gains from switching to this improved version are measured in terms of the overall speed-up of said operations?\r\n\r\nAnother thing: when fuzzing `CBufferedFile` I noticed that calling `FindByte` after a failed `SetPos` call may result in an infinite loop. Does the new code have that gotcha too? If not we can drop the `setpos_fail` logic in `src/test/fuzz/buffered_file.cpp` :)",
      "created_at" : "2020-12-05T16:55:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-739320594",
      "id" : 739320594,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczOTMyMDU5NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-05T16:55:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/739320594",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Another thing: when fuzzing `CBufferedFile` I noticed that calling `FindByte` after a failed `SetPos` call may result in an infinite loop. Does the new code have that gotcha too? If not we can drop the `setpos_fail` logic in `src/test/fuzz/buffered_file.cpp` :)\r\n\r\nAlso some failed tests:\r\n- https://cirrus-ci.com/task/4540479469518848\r\n- https://bitcoinbuilds.org/?job=34de38c2-b334-4dde-b067-462b3e62200b",
      "created_at" : "2020-12-05T17:01:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-739321236",
      "id" : 739321236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczOTMyMTIzNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-05T17:01:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/739321236",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@practicalswift\r\n> Do you have any macro numbers too where the gains from switching to this improved version are measured in terms of the overall speed-up of [`-reindex` and `-loadblock`]?\r\n\r\nI don't think there will be any measurable improvement in the sunny-day case, because the byte being searched for is the very first byte at the stream pointer. So no looping is needed (and this PR only improves the performance of that loop). But if there is corruption, damage in the `blk.dat` files, then `FindByte()` is being used to \"resynchronize\" with the stream, that is, to locate the start of the next valid block. I don't think that happens often in practice. But another advantage of this PR is that `FindByte()` may be used for something else in the future which does require actual looping in the sunny-day case.\r\n\r\n> Another thing: when fuzzing `CBufferedFile` I noticed that calling `FindByte` after a failed `SetPos` call may result in an infinite loop. Does the new code have that gotcha too?\r\n\r\nTL;DR: No. We can remove that check.\r\n\r\nDetails: I wanted to understand this better, so I checked out master immediately after your PR #19143 was merged, the commit where you added the `SetPos()` fuzzing (and the `setpos_fail` flag) (commit 614e0807a8137d82832aea45e4864b424f71f698), and did some investigation, and discovered that a failed `SetPos()` isn't what caused the infinite loop. The reason the `setpos_fail` flag seemed to fix the problem is that `SetPos()` typically fails very early in the fuzzing run, and that disables further `FindByte()` calls, after which the problem can't occur. (I didn't see anything that would _prevent_ the infinite loop, but it's just unlikely.)\r\n\r\nThe actual source of the problem is in the [`Seek()` call](https://github.com/bitcoin/bitcoin/blob/614e0807a8137d82832aea45e4864b424f71f698/src/test/fuzz/buffered_file.cpp#L44). The [implementation](https://github.com/bitcoin/bitcoin/blob/614e0807a8137d82832aea45e4864b424f71f698/src/streams.h#L817) of that method calls the standard library `fseek()`, then, if that succeeds, `ftell()`, which is supposed to return the byte offset into the file of the `FILE` pointer. It sometimes returns `-1` (which indicates error). That seems wrong, because if the `fseek()` is successful, then `ftell()` should return whatever offset we just seeked to. (I'm not sure why `Seek()` even called `ftell()`, since it already knows that offset.) This `-1` (error) return is stored into both the `CBufferedFile`'s read and write offsets (`nReadPos` and `nSrcPos`), which are unsigned, so things are messed up from here. (I was able to see why this caused an infinite loop, but it's not worth explaining here.)\r\n\r\nAnyway, this is all irrelevant now, because in #19593, @hebasto removed `CBufferedFile::Seek` because it wasn't being used. So, yes, we should remove this check (I did remove it and verified that there is no infinite loop), and I'll do that in this PR.\r\n\r\nAnother thing I'd like to do is add fuzz testing for the new method `CBufferedFile::Search()` (it can be added to the [existing test](https://github.com/bitcoin/bitcoin/blob/cef2efafcecc4d3d60421955bbd4c4fcebbcb86d/src/test/fuzz/buffered_file.cpp#L18)). That's why I changed this PR status to DRAFT. Also, I'll look into if those failed tests are real failures. Thanks for all your help!",
      "created_at" : "2020-12-07T06:30:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-739700330",
      "id" : 739700330,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczOTcwMDMzMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-07T06:30:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/739700330",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Force-pushed the latest review suggestions:\r\n- remove unneeded `protected:` tag\r\n- remove unneeded `setpos_fail` from fuzz test\r\n- add fuzz test for new `CBufferedFile::Search()` method\r\n- simplify checking for expected exception in unit test (use `BOOST_CHECK_EXCEPTION`)\r\n\r\n@hebasto \r\n> Also some failed tests\r\n\r\nI could not figure out those failures; I don't see how they have any relation to this PR.",
      "created_at" : "2020-12-07T17:51:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19690#issuecomment-740076745",
      "id" : 740076745,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19690",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0MDA3Njc0NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-07T17:51:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/740076745",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   }
]
