[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2020-07-29T14:15:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-665690746",
      "id" : 665690746,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NTY5MDc0Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-29T14:15:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/665690746",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19671 (wallet: Remove -zapwallettxes by achow101)\n* #19653 (wallet: Replace -zapwallettxes with zapwallettxes RPC by achow101)\n* #19457 (wallet: Cleanup wallettool salvage and walletdb extraneous declarations by achow101)\n* #19425 (refactor: Get rid of more redundant chain methods by ryanofsky)\n* #19245 ([WIP DONOTMERGE] Replace boost::filesystem with std::filesystem (in c++17) by kiminuo)\n* #19137 (wallettool: Add dump and createfromdump commands by achow101)\n* #19099 (refactor: Move wallet methods out of chain.h and node.h by ryanofsky)\n* #19077 (wallet: Add sqlite as an alternative wallet database and use it for new descriptor wallets by achow101)\n* #18904 (Don't call lsn_reset in periodic flush by bvbfan)\n* #18836 (wallet: upgradewallet fixes and additional tests by achow101)\n* #18608 (refactor: Remove CAddressBookData::destdata by ryanofsky)\n* #18354 (Use shared pointers only in validation interface by bvbfan)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-07-29T14:28:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-665698519",
      "id" : 665698519,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NTY5ODUxOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-09T17:31:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/665698519",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Could the second commit be split up a bit? It seems to be doing a lot and several functions are being renamed and removed.\r\n\r\nFrom what I understand, the second commit adds `DatabaseOptions` and `DatabaseStatus`. Then `CreateWalletDatabase` is renamed to `MakeWalletDatabase` and all of the various checks (file existence checks and database verify) are pushed into that function with `DatabaseOptions` informing the function what to actually do. And lastly `MakeWalletDatabase` becomes a separate distinct step that callers must do instead of letting `CWallet::Create` (renamed from `CreateWalletFromFile`) handle internally.\r\n\r\nFrom this, I think you could add a few more commits:\r\n* Introduction of `DatabaseOptions` and `DatabaseStatus` to consolidate the current options and status\r\n* Moving everything into `MakeWalletDatabase`\r\n* Separating `MakeWalletDatabase` from `CWallet::Create`",
      "created_at" : "2020-07-29T19:20:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-665853496",
      "id" : 665853496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NTg1MzQ5Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-29T19:27:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/665853496",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Could the second commit be split up a bit? It seems to be doing a lot and several functions are being renamed and removed.\r\n\r\nSure, I think I can split up like you're suggesting. The main change is introducing the `MakeBerkeleyDatabase` function. Then that function is called various places to get rid of path operations. So I think introducing MakeBerkeleyDatabase could be one commit, and then this can be followed by more commits calling it from RPC code, and then gui code, and then wallet tool code",
      "created_at" : "2020-07-29T20:15:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-665903005",
      "id" : 665903005,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NTkwMzAwNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-29T20:15:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/665903005",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh, also I didn't want this PR to depend on #19099, but this would be a little smaller with #19099 merged frist, because then there would be no need to change interfaces/node and walletinitinterface code here\r\n\r\n---\r\n\r\nRebased 8994145cb336862a51151cbaa2e222e3e2a5be96 -> 0e4cb50e3c86c3093b18fe2dfb47f563db32afef ([`pr/path.2`](https://github.com/ryanofsky/bitcoin/commits/pr/path.2) -> [`pr/path.3`](https://github.com/ryanofsky/bitcoin/commits/pr/path.3), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/path.2-rebase..pr/path.3)) due to conflict with #19102",
      "created_at" : "2020-07-29T20:18:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-665904386",
      "id" : 665904386,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NTkwNDM4Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-30T23:20:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/665904386",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-07-30T16:24:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-666505216",
      "id" : 666505216,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NjUwNTIxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-30T16:24:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/666505216",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I can see why we'd want to move anything about \"wallet.dat\" or the \"wallet is a directory\" stuff into the database layer, but IMO it doesn't make sense to hide the path the wallet is located within...",
      "created_at" : "2020-07-31T01:44:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-666864816",
      "id" : 666864816,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2Njg2NDgxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-31T01:44:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/666864816",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, as a logical separation I think it makes sense to have database-format-specific stuff like this at a lower layer than the logical use of a generic database in the rest of the code.",
      "created_at" : "2020-07-31T11:46:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-667080181",
      "id" : 667080181,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2NzA4MDE4MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-31T11:46:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/667080181",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/meshcollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/meshcollider/followers",
         "following_url" : "https://api.github.com/users/meshcollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/meshcollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/meshcollider",
         "id" : 3211283,
         "login" : "meshcollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/meshcollider/orgs",
         "received_events_url" : "https://api.github.com/users/meshcollider/received_events",
         "repos_url" : "https://api.github.com/users/meshcollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/meshcollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/meshcollider"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-665853496\r\n\r\n> Could the second commit be split up a bit? It seems to be doing a lot and several functions are being renamed and removed.\r\n\r\nTook some work, but I split this up into smaller commits that should make it more obvious nothing is changing.\r\n\r\n---\r\n\r\nre: https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-666864816\r\n\r\n> I can see why we'd want to move anything about \"wallet.dat\" or the \"wallet is a directory\" stuff into the database layer, but IMO it doesn't make sense to hide the path the wallet is located within...\r\n\r\nI don't think anything has been hidden here. Database object now has a filename method and error messages are more specific than before including full paths rather than path fragments.\r\n\r\n---\r\n\r\nUpdated 0e4cb50e3c86c3093b18fe2dfb47f563db32afef -> 4c2638281446efc7b23559925866238808a87c71 ([`pr/path.3`](https://github.com/ryanofsky/bitcoin/commits/pr/path.3) -> [`pr/path.4`](https://github.com/ryanofsky/bitcoin/commits/pr/path.4), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/path.3..pr/path.4)) splitting up later commits and making a few minor cleanups",
      "created_at" : "2020-08-05T03:12:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-668954043",
      "id" : 668954043,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2ODk1NDA0Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-05T03:12:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/668954043",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r465893207"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465893207"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think the non-BDB specific parts of this should be part of `MakeDatabase`. It would make this easier to handle in #19077 ",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-05T17:37:24Z",
      "diff_hunk" : "@@ -824,3 +824,50 @@ std::unique_ptr<DatabaseBatch> BerkeleyDatabase::MakeBatch(const char* mode, boo\n {\n     return MakeUnique<BerkeleyBatch>(*this, mode, flush_on_close);\n }\n+\n+std::unique_ptr<BerkeleyDatabase> MakeBerkeleyDatabase(const fs::path& path, const DatabaseOptions& options, DatabaseStatus& status, bilingual_str& error)\n+{\n+    status = DatabaseStatus::SUCCESS;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r465893207",
      "id" : 465893207,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg5MzIwNw==",
      "original_commit_id" : "9b15bf35d907aacf59bb7653f1014dc5160642e9",
      "original_line" : 830,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/wallet/bdb.cpp",
      "position" : null,
      "pull_request_review_id" : 461882850,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465893207",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r465893924"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465893924"
         }
      },
      "author_association" : "MEMBER",
      "body" : "There is a `m_file_path` variable in `WalletDatabase` that does this. If we add `Filename`, we should remove that.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-05T17:38:44Z",
      "diff_hunk" : "@@ -142,6 +140,9 @@ class WalletDatabase\n \n     virtual void ReloadDbEnv() = 0;\n \n+    /** Return path to main database file for logs and error messages. */\n+    virtual std::string Filename() = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r465893924",
      "id" : 465893924,
      "line" : 144,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg5MzkyNA==",
      "original_commit_id" : "6dd329f45a669695bbdd4747b623422fde41255c",
      "original_line" : 144,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/db.h",
      "position" : 22,
      "pull_request_review_id" : 461882850,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465893924",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r465895375"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465895375"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It seems like #19077 still needs `Verify`. Even if we don't necessarily use this outside of database specific code paths, I think it's still useful to keep it part of `WalletDatabase`.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-05T17:41:26Z",
      "diff_hunk" : "@@ -147,9 +147,6 @@ class WalletDatabase\n     unsigned int nLastFlushed;\n     int64_t nLastWalletUpdate;\n \n-    /** Verifies the environment and database file */\n-    virtual bool Verify(bilingual_str& error) = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r465895375",
      "id" : 465895375,
      "line" : 150,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NTg5NTM3NQ==",
      "original_commit_id" : "450ec1e34be9f0b62405e3e5901b961c15a4ecfb",
      "original_line" : 150,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/db.h",
      "position" : 30,
      "pull_request_review_id" : 461885611,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/465895375",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r466593355"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/466593355"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/19619#discussion_r465893207\r\n\r\n> I think the non-BDB specific parts of this should be part of `MakeDatabase`. It would make this easier to handle in #19077\r\n\r\nYou're right, moved this code since it didn't really support detecting the database format.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-06T18:05:13Z",
      "diff_hunk" : "@@ -824,3 +824,50 @@ std::unique_ptr<DatabaseBatch> BerkeleyDatabase::MakeBatch(const char* mode, boo\n {\n     return MakeUnique<BerkeleyBatch>(*this, mode, flush_on_close);\n }\n+\n+std::unique_ptr<BerkeleyDatabase> MakeBerkeleyDatabase(const fs::path& path, const DatabaseOptions& options, DatabaseStatus& status, bilingual_str& error)\n+{\n+    status = DatabaseStatus::SUCCESS;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r466593355",
      "id" : 466593355,
      "in_reply_to_id" : 465893207,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5MzM1NQ==",
      "original_commit_id" : "9b15bf35d907aacf59bb7653f1014dc5160642e9",
      "original_line" : 830,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/wallet/bdb.cpp",
      "position" : null,
      "pull_request_review_id" : 462757657,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/466593355",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r466593480"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/466593480"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/19619#discussion_r465893924\r\n\r\n> There is a `m_file_path` variable in `WalletDatabase` that does this. If we add `Filename`, we should remove that.\r\n\r\nThanks, cleaned this up.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-06T18:05:27Z",
      "diff_hunk" : "@@ -142,6 +140,9 @@ class WalletDatabase\n \n     virtual void ReloadDbEnv() = 0;\n \n+    /** Return path to main database file for logs and error messages. */\n+    virtual std::string Filename() = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r466593480",
      "id" : 466593480,
      "in_reply_to_id" : 465893924,
      "line" : 144,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5MzQ4MA==",
      "original_commit_id" : "6dd329f45a669695bbdd4747b623422fde41255c",
      "original_line" : 144,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/wallet/db.h",
      "position" : 22,
      "pull_request_review_id" : 462757657,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/466593480",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r466593575"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/466593575"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/19619#discussion_r465895375\r\n\r\n> It seems like #19077 still needs `Verify`. Even if we don't necessarily use this outside of database specific code paths, I think it's still useful to keep it part of `WalletDatabase`.\r\n\r\nWill take a look. The thought was that the API should either support offline verification at load time or online verification after the database is loaded, or and that load-time verification was probably preferable because:\r\n\r\n- It's the type of verification we use right now\r\n- It requires less from the database implementation. If the database provides an online verification function, you can use that during or after loading, but if it only provides an offline function you can't use that after loading.\r\n- Verifying by default (while having option to turn it off) seems safer and less likely to lead to bugs like new RPCs or wallet tool subcommands loading the database and forgetting to verify.\r\n- It can make wallet loading code simpler since there's one less step to perform.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-06T18:05:35Z",
      "diff_hunk" : "@@ -147,9 +147,6 @@ class WalletDatabase\n     unsigned int nLastFlushed;\n     int64_t nLastWalletUpdate;\n \n-    /** Verifies the environment and database file */\n-    virtual bool Verify(bilingual_str& error) = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r466593575",
      "id" : 466593575,
      "in_reply_to_id" : 465895375,
      "line" : 150,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NjU5MzU3NQ==",
      "original_commit_id" : "450ec1e34be9f0b62405e3e5901b961c15a4ecfb",
      "original_line" : 150,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/db.h",
      "position" : 30,
      "pull_request_review_id" : 462757657,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/466593575",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-08-07T08:04:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-670388990",
      "id" : 670388990,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MDM4ODk5MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-07T08:04:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/670388990",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r467245932"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/467245932"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think we can require that verify is an online verification function and call it from `MakeDatabase` rather than `MakeBerkeleyDatabase`.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-07T20:07:55Z",
      "diff_hunk" : "@@ -147,9 +147,6 @@ class WalletDatabase\n     unsigned int nLastFlushed;\n     int64_t nLastWalletUpdate;\n \n-    /** Verifies the environment and database file */\n-    virtual bool Verify(bilingual_str& error) = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r467245932",
      "id" : 467245932,
      "in_reply_to_id" : 465895375,
      "line" : 150,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2NzI0NTkzMg==",
      "original_commit_id" : "450ec1e34be9f0b62405e3e5901b961c15a4ecfb",
      "original_line" : 150,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/db.h",
      "position" : 30,
      "pull_request_review_id" : 463581885,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/467245932",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 977bfc5aef22c21ff9612068faf0672bf0f022eb",
      "created_at" : "2020-08-10T23:26:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-671638752",
      "id" : 671638752,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MTYzODc1Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-10T23:26:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671638752",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-08-14T15:02:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-674117592",
      "id" : 674117592,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3NDExNzU5Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-14T15:02:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/674117592",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased 977bfc5aef22c21ff9612068faf0672bf0f022eb -> f190f67ca7b3315c9dc46bf882dbc96af778b607 ([`pr/path.5`](https://github.com/ryanofsky/bitcoin/commits/pr/path.5) -> [`pr/path.6`](https://github.com/ryanofsky/bitcoin/commits/pr/path.6), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/path.5-rebase..pr/path.6)) due to conflict with #19457",
      "created_at" : "2020-08-14T17:01:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-674170083",
      "id" : 674170083,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3NDE3MDA4Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-14T17:01:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/674170083",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470754389"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470754389"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Might as well remove this `else if` as it's pointless now.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-14T17:20:09Z",
      "diff_hunk" : "@@ -109,19 +107,14 @@ bool ExecuteWalletToolFunc(const std::string& command, const std::string& name)\n     fs::path path = fs::absolute(name, GetWalletDir());\n \n     if (command == \"create\") {\n-        std::shared_ptr<CWallet> wallet_instance = CreateWallet(name, path);\n+        std::shared_ptr<CWallet> wallet_instance = MakeWallet(name, path, /* create= */ true);\n         if (wallet_instance) {\n             WalletShowInfo(wallet_instance.get());\n             wallet_instance->Close();\n         }\n     } else if (command == \"info\" || command == \"salvage\") {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470754389",
      "id" : 470754389,
      "line" : 115,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc1NDM4OQ==",
      "original_commit_id" : "f190f67ca7b3315c9dc46bf882dbc96af778b607",
      "original_line" : 115,
      "original_position" : 74,
      "original_start_line" : null,
      "path" : "src/wallet/wallettool.cpp",
      "position" : 74,
      "pull_request_review_id" : 467742830,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470754389",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470756846"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470756846"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think we need to close and destroy the `database`. Having it created and potentially open now could interfere with the salvage below. We only want to do this for the path existence check.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-14T17:25:16Z",
      "diff_hunk" : "@@ -18,6 +18,13 @@ typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyVa\n \n bool RecoverDatabaseFile(const fs::path& file_path, bilingual_str& error, std::vector<bilingual_str>& warnings)\n {\n+    DatabaseOptions options;\n+    DatabaseStatus status;\n+    options.require_existing = true;\n+    options.verify = false;\n+    std::unique_ptr<WalletDatabase> database = MakeDatabase(file_path, options, status, error);\n+    if (!database) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470756846",
      "id" : 470756846,
      "line" : 26,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc1Njg0Ng==",
      "original_commit_id" : "f190f67ca7b3315c9dc46bf882dbc96af778b607",
      "original_line" : 26,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/wallet/salvage.cpp",
      "position" : 9,
      "pull_request_review_id" : 467742830,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470756846",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470915633"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470915633"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ee5bb1bb09d9834edb6cd15d233be504f00615db\r\n\r\nCould be const?",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-15T00:39:36Z",
      "diff_hunk" : "@@ -144,6 +144,9 @@ class BerkeleyDatabase : public WalletDatabase\n     /** Verifies the environment and database file */\n     bool Verify(bilingual_str& error);\n \n+    /** Return path to main database filename */\n+    std::string Filename() override { return (env->Directory() / strFile).string(); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470915633",
      "id" : 470915633,
      "line" : 148,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkxNTYzMw==",
      "original_commit_id" : "ee5bb1bb09d9834edb6cd15d233be504f00615db",
      "original_line" : 148,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/bdb.h",
      "position" : 27,
      "pull_request_review_id" : 467931975,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470915633",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470916468"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470916468"
         }
      },
      "author_association" : "MEMBER",
      "body" : "ee5bb1bb09d9834edb6cd15d233be504f00615db\r\n\r\nWhy not take `name` from  `database`? Is it intentional to allow independent names and filenames?",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-15T00:46:22Z",
      "diff_hunk" : "@@ -3727,23 +3729,23 @@ std::unique_ptr<WalletDatabase> MakeWalletDatabase(const std::string& name, cons\n     return MakeDatabase(wallet_path, options, status, error_string);\n }\n \n-std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain, const std::string& name, bilingual_str& error, std::vector<bilingual_str>& warnings, uint64_t wallet_creation_flags)\n+std::shared_ptr<CWallet> CWallet::Create(interfaces::Chain& chain, const std::string& name, std::unique_ptr<WalletDatabase> database, uint64_t wallet_creation_flags, bilingual_str& error, std::vector<bilingual_str>& warnings)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470916468",
      "id" : 470916468,
      "line" : 3713,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDkxNjQ2OA==",
      "original_commit_id" : "ee5bb1bb09d9834edb6cd15d233be504f00615db",
      "original_line" : 3713,
      "original_position" : 40,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 181,
      "pull_request_review_id" : 467931975,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470916468",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470954536"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470954536"
         }
      },
      "author_association" : "MEMBER",
      "body" : "aac063f28e4ed48180c2ba7a51706af969ca1e55, nit\r\n```suggestion\r\n        const fs::path path = fs::absolute(wallet_file, GetWalletDir());\r\n```",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-15T08:33:48Z",
      "diff_hunk" : "@@ -42,16 +42,16 @@ bool VerifyWallets(interfaces::Chain& chain, const std::vector<std::string>& wal\n     std::set<fs::path> wallet_paths;\n \n     for (const auto& wallet_file : wallet_files) {\n-        WalletLocation location(wallet_file);\n+        fs::path path = fs::absolute(wallet_file, GetWalletDir());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470954536",
      "id" : 470954536,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDk1NDUzNg==",
      "original_commit_id" : "aac063f28e4ed48180c2ba7a51706af969ca1e55",
      "original_line" : 45,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/load.cpp",
      "position" : null,
      "pull_request_review_id" : 467957801,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470954536",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470954586"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470954586"
         }
      },
      "author_association" : "MEMBER",
      "body" : "aac063f28e4ed48180c2ba7a51706af969ca1e55\r\nAdd `#include <fs.h>` ?",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-15T08:34:40Z",
      "diff_hunk" : "@@ -42,16 +42,16 @@ bool VerifyWallets(interfaces::Chain& chain, const std::vector<std::string>& wal\n     std::set<fs::path> wallet_paths;\n \n     for (const auto& wallet_file : wallet_files) {\n-        WalletLocation location(wallet_file);\n+        fs::path path = fs::absolute(wallet_file, GetWalletDir());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470954586",
      "id" : 470954586,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDk1NDU4Ng==",
      "original_commit_id" : "aac063f28e4ed48180c2ba7a51706af969ca1e55",
      "original_line" : 45,
      "original_position" : 5,
      "original_start_line" : 45,
      "path" : "src/wallet/load.cpp",
      "position" : null,
      "pull_request_review_id" : 467957801,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "LEFT",
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470954586",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470954743"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470954743"
         }
      },
      "author_association" : "MEMBER",
      "body" : "aac063f28e4ed48180c2ba7a51706af969ca1e55, nit\r\n```suggestion\r\n    const std::string name(request.params[0].get_str());\r\n```",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-15T08:36:12Z",
      "diff_hunk" : "@@ -2499,21 +2499,22 @@ static UniValue loadwallet(const JSONRPCRequest& request)\n             }.Check(request);\n \n     WalletContext& context = EnsureWalletContext(request.context);\n-    WalletLocation location(request.params[0].get_str());\n+    std::string name(request.params[0].get_str());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470954743",
      "id" : 470954743,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDk1NDc0Mw==",
      "original_commit_id" : "aac063f28e4ed48180c2ba7a51706af969ca1e55",
      "original_line" : 2502,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 467957801,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470954743",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Commit 134f1807e51a8b64c813bf994c8752d55ff3469f \"wallet: Add MakeDatabase function\" confuses me:\r\n\r\n1. `bool IsBerkeleyBtree()` declaration is added to `wallet/bdb.h` but its definition remains in `wallet/walletutil.cpp`\r\n\r\n2. `std::unique_ptr<WalletDatabase> MakeDatabase()` declaration is added to `wallet/db.h` but its definition is added to `wallet/walletdb.cpp`\r\n\r\nIf this made on purpose, mind explaining such code organization?",
      "created_at" : "2020-08-15T08:54:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-674370405",
      "id" : 674370405,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3NDM3MDQwNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-15T08:54:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/674370405",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470957223"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470957223"
         }
      },
      "author_association" : "MEMBER",
      "body" : "134f1807e51a8b64c813bf994c8752d55ff3469f\r\nWhy locking is required here? Doesn't `GetWalletEnv()` do this job?",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-15T09:07:33Z",
      "diff_hunk" : "@@ -824,3 +824,35 @@ std::unique_ptr<DatabaseBatch> BerkeleyDatabase::MakeBatch(const char* mode, boo\n {\n     return MakeUnique<BerkeleyBatch>(*this, mode, flush_on_close);\n }\n+\n+bool ExistsBerkeleyDatabase(const fs::path& path)\n+{\n+    fs::path env_directory;\n+    std::string data_filename;\n+    SplitWalletPath(path, env_directory, data_filename);\n+    return IsBerkeleyBtree(env_directory / data_filename);\n+}\n+\n+std::unique_ptr<BerkeleyDatabase> MakeBerkeleyDatabase(const fs::path& path, const DatabaseOptions& options, DatabaseStatus& status, bilingual_str& error)\n+{\n+    std::unique_ptr<BerkeleyDatabase> db;\n+    {\n+        LOCK(cs_db);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470957223",
      "id" : 470957223,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDk1NzIyMw==",
      "original_commit_id" : "134f1807e51a8b64c813bf994c8752d55ff3469f",
      "original_line" : 840,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/wallet/bdb.cpp",
      "position" : null,
      "pull_request_review_id" : 467959398,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T12:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470957223",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194705"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194705"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470915633\r\n\r\n> [ee5bb1b](https://github.com/bitcoin/bitcoin/commit/ee5bb1bb09d9834edb6cd15d233be504f00615db)\r\n> \r\n> Could be const?\r\n\r\nI don't like virtual methods to be const. I don't think a superclass declaration should prevent subclasses from being able to modify their own state, expose this implementation detail to callers, and allow callers to pass around viral `const` references which constrain present and future subclass implementations. Adding const in cases like this doesn't have benefits that I'm aware of and seems likely to lead to code churn (removing viral consts) or confusing workarounds (adding mutable/const_casts) going forward.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-17T01:54:53Z",
      "diff_hunk" : "@@ -144,6 +144,9 @@ class BerkeleyDatabase : public WalletDatabase\n     /** Verifies the environment and database file */\n     bool Verify(bilingual_str& error);\n \n+    /** Return path to main database filename */\n+    std::string Filename() override { return (env->Directory() / strFile).string(); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194705",
      "id" : 471194705,
      "in_reply_to_id" : 470915633,
      "line" : 148,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE5NDcwNQ==",
      "original_commit_id" : "ee5bb1bb09d9834edb6cd15d233be504f00615db",
      "original_line" : 148,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/bdb.h",
      "position" : 27,
      "pull_request_review_id" : 468124944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T13:03:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194705",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194800"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194800"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/19619#discussion_r467245932\r\n\r\n> I think we can require that verify is an online verification function and call it from `MakeDatabase` rather than `MakeBerkeleyDatabase`.\r\n\r\nAgree we can add an extra method to the interface, but would want to know advantages to doing this. Sticking with a verify option instead of a verify method seems more flexible for implementations, and simpler and less error prone for callers (https://github.com/bitcoin/bitcoin/pull/19619#discussion_r466593575).",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-17T01:55:19Z",
      "diff_hunk" : "@@ -147,9 +147,6 @@ class WalletDatabase\n     unsigned int nLastFlushed;\n     int64_t nLastWalletUpdate;\n \n-    /** Verifies the environment and database file */\n-    virtual bool Verify(bilingual_str& error) = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194800",
      "id" : 471194800,
      "in_reply_to_id" : 465895375,
      "line" : 150,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE5NDgwMA==",
      "original_commit_id" : "450ec1e34be9f0b62405e3e5901b961c15a4ecfb",
      "original_line" : 150,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/db.h",
      "position" : 30,
      "pull_request_review_id" : 468124944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T13:01:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194800",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194826"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194826"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470954536\r\n\r\n> [aac063f](https://github.com/bitcoin/bitcoin/commit/aac063f28e4ed48180c2ba7a51706af969ca1e55), nit\r\n\r\nThanks, added",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-17T01:55:27Z",
      "diff_hunk" : "@@ -42,16 +42,16 @@ bool VerifyWallets(interfaces::Chain& chain, const std::vector<std::string>& wal\n     std::set<fs::path> wallet_paths;\n \n     for (const auto& wallet_file : wallet_files) {\n-        WalletLocation location(wallet_file);\n+        fs::path path = fs::absolute(wallet_file, GetWalletDir());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194826",
      "id" : 471194826,
      "in_reply_to_id" : 470954536,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE5NDgyNg==",
      "original_commit_id" : "aac063f28e4ed48180c2ba7a51706af969ca1e55",
      "original_line" : 45,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/load.cpp",
      "position" : null,
      "pull_request_review_id" : 468124944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T13:01:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194826",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194914"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194914"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470954743\r\n\r\n> [aac063f](https://github.com/bitcoin/bitcoin/commit/aac063f28e4ed48180c2ba7a51706af969ca1e55), nit\r\n\r\nThanks, added",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-17T01:55:55Z",
      "diff_hunk" : "@@ -2499,21 +2499,22 @@ static UniValue loadwallet(const JSONRPCRequest& request)\n             }.Check(request);\n \n     WalletContext& context = EnsureWalletContext(request.context);\n-    WalletLocation location(request.params[0].get_str());\n+    std::string name(request.params[0].get_str());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194914",
      "id" : 471194914,
      "in_reply_to_id" : 470954743,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE5NDkxNA==",
      "original_commit_id" : "aac063f28e4ed48180c2ba7a51706af969ca1e55",
      "original_line" : 2502,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_review_id" : 468124944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T13:01:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194914",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194943"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194943"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470756846\r\n\r\n> I think we need to close and destroy the `database`. Having it created and potentially open now could interfere with the salvage below.\r\n\r\nI'm not sure exactly what change is being asked for here. Closing an unopened database won't do anything. Goal of this commit is to remove path manipulation from wallet tool while changing it minimally (and nudging code in good future directions), so happy to make any change consistent with that.\r\n\r\n> We only want to do this for the path existence check.\r\n\r\nI don't think this is right. I think other checks done before opening a database should be done before salvaging a database. Not just checking path existence, but also checking load status and lock status.\r\n\r\nI expect having the database object here to be more useful in the future. It's beyond the scope of this PR, but recovery code below should be able to go through the database object instead of bypassing it.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-17T01:56:02Z",
      "diff_hunk" : "@@ -18,6 +18,13 @@ typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyVa\n \n bool RecoverDatabaseFile(const fs::path& file_path, bilingual_str& error, std::vector<bilingual_str>& warnings)\n {\n+    DatabaseOptions options;\n+    DatabaseStatus status;\n+    options.require_existing = true;\n+    options.verify = false;\n+    std::unique_ptr<WalletDatabase> database = MakeDatabase(file_path, options, status, error);\n+    if (!database) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194943",
      "id" : 471194943,
      "in_reply_to_id" : 470756846,
      "line" : 26,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE5NDk0Mw==",
      "original_commit_id" : "f190f67ca7b3315c9dc46bf882dbc96af778b607",
      "original_line" : 26,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/wallet/salvage.cpp",
      "position" : 9,
      "pull_request_review_id" : 468124944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T13:01:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194943",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194968"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194968"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470916468\r\n\r\n> [ee5bb1b](https://github.com/bitcoin/bitcoin/commit/ee5bb1bb09d9834edb6cd15d233be504f00615db)\r\n> \r\n> Why not take `name` from `database`? Is it intentional to allow independent names and filenames?\r\n\r\nYes it's intentional. Database objects don't have names. They aren't passed names, can't construct names, and don't need names because they don't need to route GUI or RPC requests, unlike wallet objects.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-17T01:56:10Z",
      "diff_hunk" : "@@ -3727,23 +3729,23 @@ std::unique_ptr<WalletDatabase> MakeWalletDatabase(const std::string& name, cons\n     return MakeDatabase(wallet_path, options, status, error_string);\n }\n \n-std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain, const std::string& name, bilingual_str& error, std::vector<bilingual_str>& warnings, uint64_t wallet_creation_flags)\n+std::shared_ptr<CWallet> CWallet::Create(interfaces::Chain& chain, const std::string& name, std::unique_ptr<WalletDatabase> database, uint64_t wallet_creation_flags, bilingual_str& error, std::vector<bilingual_str>& warnings)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194968",
      "id" : 471194968,
      "in_reply_to_id" : 470916468,
      "line" : 3713,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE5NDk2OA==",
      "original_commit_id" : "ee5bb1bb09d9834edb6cd15d233be504f00615db",
      "original_line" : 3713,
      "original_position" : 40,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 181,
      "pull_request_review_id" : 468124944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T13:01:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194968",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194992"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194992"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470754389\r\n\r\n> Might as well remove this `else if` as it's pointless now.\r\n\r\nDon't want to increase scope of this PR, but agree wallet tool command dispatching can be simplified later.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-17T01:56:18Z",
      "diff_hunk" : "@@ -109,19 +107,14 @@ bool ExecuteWalletToolFunc(const std::string& command, const std::string& name)\n     fs::path path = fs::absolute(name, GetWalletDir());\n \n     if (command == \"create\") {\n-        std::shared_ptr<CWallet> wallet_instance = CreateWallet(name, path);\n+        std::shared_ptr<CWallet> wallet_instance = MakeWallet(name, path, /* create= */ true);\n         if (wallet_instance) {\n             WalletShowInfo(wallet_instance.get());\n             wallet_instance->Close();\n         }\n     } else if (command == \"info\" || command == \"salvage\") {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471194992",
      "id" : 471194992,
      "in_reply_to_id" : 470754389,
      "line" : 115,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTE5NDk5Mg==",
      "original_commit_id" : "f190f67ca7b3315c9dc46bf882dbc96af778b607",
      "original_line" : 115,
      "original_position" : 74,
      "original_start_line" : null,
      "path" : "src/wallet/wallettool.cpp",
      "position" : 74,
      "pull_request_review_id" : 468124944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T13:01:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471194992",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471431230"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471431230"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/19619#discussion_r470957223\r\n\r\n> 134f1807e51a8b64c813bf994c8752d55ff3469f\r\n> Why locking is required here? Doesn't `GetWalletEnv()` do this job?\r\n\r\nAdded comment. The lock needs to cover both  GetWalletEnv and the Database constructor to prevent a race condition. In the future I think all these little functions should be inlined so code is clearer, but that's not really possible without more cleanup and anyway would not be directly related to path code consolidation which is the goal of this PR",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-17T12:01:31Z",
      "diff_hunk" : "@@ -824,3 +824,35 @@ std::unique_ptr<DatabaseBatch> BerkeleyDatabase::MakeBatch(const char* mode, boo\n {\n     return MakeUnique<BerkeleyBatch>(*this, mode, flush_on_close);\n }\n+\n+bool ExistsBerkeleyDatabase(const fs::path& path)\n+{\n+    fs::path env_directory;\n+    std::string data_filename;\n+    SplitWalletPath(path, env_directory, data_filename);\n+    return IsBerkeleyBtree(env_directory / data_filename);\n+}\n+\n+std::unique_ptr<BerkeleyDatabase> MakeBerkeleyDatabase(const fs::path& path, const DatabaseOptions& options, DatabaseStatus& status, bilingual_str& error)\n+{\n+    std::unique_ptr<BerkeleyDatabase> db;\n+    {\n+        LOCK(cs_db);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471431230",
      "id" : 471431230,
      "in_reply_to_id" : 470957223,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTQzMTIzMA==",
      "original_commit_id" : "134f1807e51a8b64c813bf994c8752d55ff3469f",
      "original_line" : 840,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/wallet/bdb.cpp",
      "position" : null,
      "pull_request_review_id" : 468124944,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T13:01:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471431230",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471606646"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471606646"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The main idea is that the verify is an option for all `WalletDatabase` implementations and always done within `MakeDatabase` so that there isn't an implementation that doesn't do this verification. I think we should be requiring that all `WalletDatabase` implementations have some kind of online verification, and if a database doesn't provide this, perhaps we shouldn't be using it.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-17T16:46:28Z",
      "diff_hunk" : "@@ -147,9 +147,6 @@ class WalletDatabase\n     unsigned int nLastFlushed;\n     int64_t nLastWalletUpdate;\n \n-    /** Verifies the environment and database file */\n-    virtual bool Verify(bilingual_str& error) = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471606646",
      "id" : 471606646,
      "in_reply_to_id" : 465895375,
      "line" : 150,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYwNjY0Ng==",
      "original_commit_id" : "450ec1e34be9f0b62405e3e5901b961c15a4ecfb",
      "original_line" : 150,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/wallet/db.h",
      "position" : 30,
      "pull_request_review_id" : 468629070,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T16:46:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471606646",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471608447"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471608447"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What I was asking for was to have a `database = nullptr` here so that `database` isn't valid further down.\r\n\r\nIf we do want to do the salvage through `WalletDatabase` (I'm not sure that we should though), then I would expect that all of this recovery code ends up back in `bdb.cpp/h`.",
      "commit_id" : "1233419c88c31f21e1b59b4e3f0cdad34d92413b",
      "created_at" : "2020-08-17T16:49:48Z",
      "diff_hunk" : "@@ -18,6 +18,13 @@ typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyVa\n \n bool RecoverDatabaseFile(const fs::path& file_path, bilingual_str& error, std::vector<bilingual_str>& warnings)\n {\n+    DatabaseOptions options;\n+    DatabaseStatus status;\n+    options.require_existing = true;\n+    options.verify = false;\n+    std::unique_ptr<WalletDatabase> database = MakeDatabase(file_path, options, status, error);\n+    if (!database) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#discussion_r471608447",
      "id" : 471608447,
      "in_reply_to_id" : 470756846,
      "line" : 26,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MTYwODQ0Nw==",
      "original_commit_id" : "f190f67ca7b3315c9dc46bf882dbc96af778b607",
      "original_line" : 26,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/wallet/salvage.cpp",
      "position" : 9,
      "pull_request_review_id" : 468631661,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19619",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-08-17T16:49:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/471608447",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 1233419c88c31f21e1b59b4e3f0cdad34d92413b Since last only rebase and some suggestions. My comments on this aren't really blocking.",
      "created_at" : "2020-08-17T22:48:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19619#issuecomment-675152638",
      "id" : 675152638,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19619",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3NTE1MjYzOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-17T22:48:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/675152638",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   }
]
