[
   {
      "author_association" : "MEMBER",
      "body" : "Sounds like a good initiative. The tendency on the repo is almost certainly to treat failures as \"random\"  and just blindly restart CIs until they pass. However saying that, recently there has been a trend of opening an issue with the log/failure before restarting, and I think we've seen more of those intermittent failures being fixed because of it. \r\n\r\nSemi related; I think that we should also be more aggressive about disabling hardware/jobs that (start to) consistently fail (due to issues outside our control. i.e the s390x build on Travis), otherwise the failures just generate spammy comments (here and on IRC), about having to restart builds, and in general seem to confuse non-regular contributors.",
      "created_at" : "2020-08-10T13:07:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19684#issuecomment-671342514",
      "id" : 671342514,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19684",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MTM0MjUxNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-10T13:07:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671342514",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think we should treat issues that are a direct consequence of mishaps attributed to us different from issues that are third party mishaps.\r\n\r\n## CI provider issues/issues not related to code/config in this repo\r\n\r\nAbsent any alternatives, I agree on aggressively disabling failing builds that are out of our control to fix. Honestly, it is quite depressing that there are literally no CI providers out there that suit our needs when it comes to features/stability and uptime. I wanted to avoid having to roll our own solution, because it means that the time spent on developing a CI infrastructure (hardware, provisioning, configurations, user authentication, hosting, anti-DOS, ...) can not be spent on user-facing Bitcoin Core improvements. Though, if the situation doesn't improve over the next year, we might have no other choice.\r\n\r\n## False positives in our tests/code\r\n\r\nWhen it comes to test failures that are in our control to fix, I also agree that that there has been a minimal increase in reported intermittent false positives. See the reports https://github.com/bitcoin/bitcoin/issues?q=is%3Aissue+intermittent+ . Non-intermittent issues that are in our control to fix should be rare and need to be fixed immediately anyway, so they are imo not worth to track.\r\n\r\nThough, I observe that CI failures are still blindly restarted without filing an issue. If no one wants to take the time to file an issue or look at the existing issues and fix them, I don't think it will help to spend time on automatically (or manually) tracking the false positive rates over time.\r\n\r\nI have two goals when it comes to false positive CI results:\r\n* Issues are created when the failure occurs. Either by adding a comment to an existing issue or filing a new issue if none exists.\r\n* Intermittent false positives might indicate actual bugs in Bitcoin Core. So those issues should be fixed before a new major  version is released, ideally as soon as possible.\r\n\r\nFiling an issue should take a minimal amount of time, so I am unsure why it is done so rarely. After #19110 it takes no more than one mouse click and a copy-paste. Let me know what else can be done to incentivize this.\r\n\r\n## Automatically collecting false postive rates\r\n\r\nNot sure if this is something to spend time on before the above goals are achieved...\r\n\r\nThe ci tools run most often on pull requests, as opposed to the master branch, since every proposed patch is merged at most once into the master branch, but pushed at least once to the pull request. This means that most of the data points are within pull requests. Though, pull requests also leak the auth tokens needed to report back the ci result to a third service. Moreover, pull requests run into true positive failures (if they never did, then all tests would be useless). Automatically distinguishing false positives from true positives might need some heuristics (see e.g. https://hacks.mozilla.org/2020/07/testing-firefox-more-efficiently-with-machine-learning/, ignore the \"machine learning\" part).",
      "created_at" : "2020-08-10T13:53:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19684#issuecomment-671367771",
      "id" : 671367771,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19684",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3MTM2Nzc3MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-10T13:53:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/671367771",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "One example of false positives in the CI provider itself is [here](https://travis-ci.org/github/bitcoin/bitcoin/jobs/721806790).  I had another example of a false positive on that same job in a different PR, but I think it was restarted so I'm not sure how to link to the failing job.\r\n\r\nI don't know how frequently this particular job in that particular CI fails, so I don't know if this is a test that we should be looking to perform on another provider, or even consider dropping altogether until we have a more stable place we think we can run it.\r\n",
      "created_at" : "2020-08-31T18:27:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/19684#issuecomment-683950713",
      "id" : 683950713,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19684",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4Mzk1MDcxMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-31T18:27:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/683950713",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   }
]
