[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "If this is merged, then https://github.com/bitcoin/bitcoin/pull/20849 will not be needed. That PR is valid with or without this one, but this one fixes the issue more broadly.",
      "created_at" : "2021-01-04T17:51:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-754120031",
      "id" : 754120031,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20852",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NDEyMDAzMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-04T17:51:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754120031",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r551476324"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551476324"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Control reaches end of non-void function.\r\n",
      "commit_id" : "293070adc34f979bee1e9315cc70973a168c3af2",
      "created_at" : "2021-01-04T18:01:56Z",
      "diff_hunk" : "@@ -1089,28 +1100,53 @@ bool CSubNet::Match(const CNetAddr &addr) const\n     if (!valid || !addr.IsValid() || network.m_net != addr.m_net)\n         return false;\n     assert(network.m_addr.size() == addr.m_addr.size());\n-    for (size_t x = 0; x < addr.m_addr.size(); ++x) {\n-        if ((addr.m_addr[x] & netmask[x]) != network.m_addr[x]) {\n-            return false;\n+    switch (network.m_net) {\n+    case NET_IPV4:\n+    case NET_IPV6:\n+        for (size_t x = 0; x < addr.m_addr.size(); ++x) {\n+            if ((addr.m_addr[x] & netmask[x]) != network.m_addr[x]) {\n+                return false;\n+            }\n         }\n+        return true;\n+    case NET_ONION:\n+    case NET_I2P:\n+    case NET_CJDNS:\n+        return addr == network;\n+    case NET_INTERNAL:\n+    case NET_UNROUTABLE:\n+    case NET_MAX:\n+        return false;\n     }\n-    return true;\n+    return false;\n }\n \n std::string CSubNet::ToString() const\n {\n-    assert(network.m_addr.size() <= sizeof(netmask));\n+    switch (network.m_net) {\n+    case NET_IPV4:\n+    case NET_IPV6: {\n+        assert(network.m_addr.size() <= sizeof(netmask));\n \n-    uint8_t cidr = 0;\n+        uint8_t cidr = 0;\n \n-    for (size_t i = 0; i < network.m_addr.size(); ++i) {\n-        if (netmask[i] == 0x00) {\n-            break;\n+        for (size_t i = 0; i < network.m_addr.size(); ++i) {\n+            if (netmask[i] == 0x00) {\n+                break;\n+            }\n+            cidr += NetmaskBits(netmask[i]);\n         }\n-        cidr += NetmaskBits(netmask[i]);\n-    }\n \n-    return network.ToString() + strprintf(\"/%u\", cidr);\n+        return network.ToString() + strprintf(\"/%u\", cidr);\n+    }\n+    case NET_ONION:\n+    case NET_I2P:\n+    case NET_CJDNS:\n+    case NET_INTERNAL:\n+    case NET_UNROUTABLE:\n+    case NET_MAX:\n+        return network.ToString();\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r551476324",
      "id" : 551476324,
      "line" : 1185,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTQ3NjMyNA==",
      "original_commit_id" : "06af169cff4a4d1555615f0592afab627ee2e83d",
      "original_line" : 1185,
      "original_position" : 95,
      "original_start_line" : null,
      "path" : "src/netaddress.cpp",
      "position" : 142,
      "pull_request_review_id" : 561227717,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-06T16:19:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551476324",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've given this label \"Needs backport (0.21)\", as either this or #20849 (or both) should go into rc5. If 20849 is merged and backported, we're good.",
      "created_at" : "2021-01-05T00:50:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-754315804",
      "id" : 754315804,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20852",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NDMxNTgwNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-05T00:50:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754315804",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Test is broken, fix:\r\n\r\n```diff\r\ndiff --git a/src/test/netbase_tests.cpp b/src/test/netbase_tests.cpp\r\nindex ac4db3a5b6..87d8bf6ef6 100644\r\n--- a/src/test/netbase_tests.cpp\r\n+++ b/src/test/netbase_tests.cpp\r\n@@ -442,8 +442,7 @@ BOOST_AUTO_TEST_CASE(netbase_dont_resolve_strings_with_embedded_nul_characters)\r\n     BOOST_CHECK(!LookupSubNet(\"1.2.3.0/24\\0\"s, ret));\r\n     BOOST_CHECK(!LookupSubNet(\"1.2.3.0/24\\0example.com\"s, ret));\r\n     BOOST_CHECK(!LookupSubNet(\"1.2.3.0/24\\0example.com\\0\"s, ret));\r\n-    // We only do subnetting for IPv4 and IPv6\r\n-    BOOST_CHECK(!LookupSubNet(\"5wyqrzbvrdsumnok.onion\"s, ret));\r\n+    BOOST_CHECK(LookupSubNet(\"5wyqrzbvrdsumnok.onion\"s, ret));\r\n     BOOST_CHECK(!LookupSubNet(\"5wyqrzbvrdsumnok.onion\\0\"s, ret));\r\n     BOOST_CHECK(!LookupSubNet(\"5wyqrzbvrdsumnok.onion\\0example.com\"s, ret));\r\n     BOOST_CHECK(!LookupSubNet(\"5wyqrzbvrdsumnok.onion\\0example.com\\0\"s, ret));\r\n\r\n```\r\n\r\n\r\n",
      "created_at" : "2021-01-05T00:52:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-754316438",
      "id" : 754316438,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20852",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NDMxNjQzOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-05T00:52:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754316438",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19825 (rpc: simpler setban and new ban manipulation commands by dhruv)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-01-05T05:42:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-754410907",
      "id" : 754410907,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20852",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NDQxMDkwNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-05T05:42:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754410907",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept/direction ACK, will review the code later",
      "created_at" : "2021-01-05T08:31:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-754488720",
      "id" : 754488720,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20852",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NDQ4ODcyMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-05T08:32:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754488720",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "06af169cf...6ab8b2b5d: minor tweaks, add comments to `CSubNet()` constructors, fix and extend tests.",
      "created_at" : "2021-01-05T11:11:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-754571102",
      "id" : 754571102,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20852",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NDU3MTEwMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-05T11:11:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754571102",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r551866832"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551866832"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed.",
      "commit_id" : "293070adc34f979bee1e9315cc70973a168c3af2",
      "created_at" : "2021-01-05T11:11:57Z",
      "diff_hunk" : "@@ -1089,28 +1100,53 @@ bool CSubNet::Match(const CNetAddr &addr) const\n     if (!valid || !addr.IsValid() || network.m_net != addr.m_net)\n         return false;\n     assert(network.m_addr.size() == addr.m_addr.size());\n-    for (size_t x = 0; x < addr.m_addr.size(); ++x) {\n-        if ((addr.m_addr[x] & netmask[x]) != network.m_addr[x]) {\n-            return false;\n+    switch (network.m_net) {\n+    case NET_IPV4:\n+    case NET_IPV6:\n+        for (size_t x = 0; x < addr.m_addr.size(); ++x) {\n+            if ((addr.m_addr[x] & netmask[x]) != network.m_addr[x]) {\n+                return false;\n+            }\n         }\n+        return true;\n+    case NET_ONION:\n+    case NET_I2P:\n+    case NET_CJDNS:\n+        return addr == network;\n+    case NET_INTERNAL:\n+    case NET_UNROUTABLE:\n+    case NET_MAX:\n+        return false;\n     }\n-    return true;\n+    return false;\n }\n \n std::string CSubNet::ToString() const\n {\n-    assert(network.m_addr.size() <= sizeof(netmask));\n+    switch (network.m_net) {\n+    case NET_IPV4:\n+    case NET_IPV6: {\n+        assert(network.m_addr.size() <= sizeof(netmask));\n \n-    uint8_t cidr = 0;\n+        uint8_t cidr = 0;\n \n-    for (size_t i = 0; i < network.m_addr.size(); ++i) {\n-        if (netmask[i] == 0x00) {\n-            break;\n+        for (size_t i = 0; i < network.m_addr.size(); ++i) {\n+            if (netmask[i] == 0x00) {\n+                break;\n+            }\n+            cidr += NetmaskBits(netmask[i]);\n         }\n-        cidr += NetmaskBits(netmask[i]);\n-    }\n \n-    return network.ToString() + strprintf(\"/%u\", cidr);\n+        return network.ToString() + strprintf(\"/%u\", cidr);\n+    }\n+    case NET_ONION:\n+    case NET_I2P:\n+    case NET_CJDNS:\n+    case NET_INTERNAL:\n+    case NET_UNROUTABLE:\n+    case NET_MAX:\n+        return network.ToString();\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r551866832",
      "id" : 551866832,
      "in_reply_to_id" : 551476324,
      "line" : 1185,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTg2NjgzMg==",
      "original_commit_id" : "06af169cff4a4d1555615f0592afab627ee2e83d",
      "original_line" : 1185,
      "original_position" : 95,
      "original_start_line" : null,
      "path" : "src/netaddress.cpp",
      "position" : 142,
      "pull_request_review_id" : 561704663,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-06T16:19:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551866832",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r551873584"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551873584"
         }
      },
      "author_association" : "MEMBER",
      "body" : "s/signle/single/ here and line 480",
      "commit_id" : "293070adc34f979bee1e9315cc70973a168c3af2",
      "created_at" : "2021-01-05T11:26:11Z",
      "diff_hunk" : "@@ -462,11 +462,31 @@ class CSubNet\n         bool SanityCheck() const;\n \n     public:\n+        /**\n+         * Construct an invalid subnet (empty, `Match()` always returns false).\n+         */\n         CSubNet();\n+\n+        /**\n+         * Construct from a given network start and number of bits (CIDR mask).\n+         * @param[in] addr Network start. If not IPv4 or IPv6, then a signle-host subnet is created.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r551873584",
      "id" : 551873584,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTg3MzU4NA==",
      "original_commit_id" : "6ab8b2b5d4a918c98c37fe057aa3af53e6f2b45e",
      "original_line" : 472,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : null,
      "pull_request_review_id" : 561713454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-06T16:19:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551873584",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r551875221"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551875221"
         }
      },
      "author_association" : "MEMBER",
      "body" : "readability suggestion\r\n```diff\r\n         /**\r\n          * Construct from a given network start and number of bits (CIDR mask).\r\n-         * @param[in] addr Network start. If not IPv4 or IPv6, then a signle-host subnet is created.\r\n-         * @param[in] mask CIDR mask, must be in [0, 32] for IPv4 addresses and in [0, 128] for IPv6\r\n-         * addresses. Otherwise an invalid subnet is created. Ignored for non-IP `addr`.\r\n+         * @param[in] addr  Network start. If not IPv4 or IPv6, then a single-host subnet is created.\r\n+         * @param[in] mask  CIDR mask, must be in [0, 32] for IPv4 addresses and in [0, 128] for IPv6\r\n+         *                  addresses. Otherwise an invalid subnet is created. Ignored for non-IP `addr`.\r\n          */\r\n         CSubNet(const CNetAddr& addr, uint8_t mask);\r\n \r\n         /**\r\n          * Construct from a given network start and mask.\r\n-         * @param[in] addr Network start. If not IPv4 or IPv6, then a signle-host subnet is created.\r\n-         * @param[in] mask Network mask, must be of the same type as `addr` and not contain 0-bits\r\n-         * followed by 1-bits. Otherwise an invalid subnet is created. Ignored for non-IP `addr`.\r\n+         * @param[in] addr  Network start. If not IPv4 or IPv6, then a single-host subnet is created.\r\n+         * @param[in] mask  Network mask, must be of the same type as `addr` and not contain 0-bits\r\n+         *                  followed by 1-bits. Otherwise an invalid subnet is created. Ignored for non-IP `addr`.\r\n          */\r\n         CSubNet(const CNetAddr& addr, const CNetAddr& mask);\r\n```",
      "commit_id" : "293070adc34f979bee1e9315cc70973a168c3af2",
      "created_at" : "2021-01-05T11:29:20Z",
      "diff_hunk" : "@@ -462,11 +462,31 @@ class CSubNet\n         bool SanityCheck() const;\n \n     public:\n+        /**\n+         * Construct an invalid subnet (empty, `Match()` always returns false).\n+         */\n         CSubNet();\n+\n+        /**\n+         * Construct from a given network start and number of bits (CIDR mask).\n+         * @param[in] addr Network start. If not IPv4 or IPv6, then a signle-host subnet is created.\n+         * @param[in] mask CIDR mask, must be in [0, 32] for IPv4 addresses and in [0, 128] for IPv6\n+         * addresses. Otherwise an invalid subnet is created. Ignored for non-IP `addr`.\n+         */\n         CSubNet(const CNetAddr& addr, uint8_t mask);\n+\n+        /**\n+         * Construct from a given network start and mask.\n+         * @param[in] addr Network start. If not IPv4 or IPv6, then a signle-host subnet is created.\n+         * @param[in] mask Network mask, must be of the same type as `addr` and not contain 0-bits\n+         * followed by 1-bits. Otherwise an invalid subnet is created. Ignored for non-IP `addr`.\n+         */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r551875221",
      "id" : 551875221,
      "line" : 483,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTg3NTIyMQ==",
      "original_commit_id" : "6ab8b2b5d4a918c98c37fe057aa3af53e6f2b45e",
      "original_line" : 483,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 22,
      "pull_request_review_id" : 561713454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-06T16:19:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551875221",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r551875461"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551875461"
         }
      },
      "author_association" : "MEMBER",
      "body" : "readability suggestion\r\n```suggestion\r\n         * @param[in] addr  The sole address to be contained in the subnet.\r\n```",
      "commit_id" : "293070adc34f979bee1e9315cc70973a168c3af2",
      "created_at" : "2021-01-05T11:29:52Z",
      "diff_hunk" : "@@ -462,11 +462,31 @@ class CSubNet\n         bool SanityCheck() const;\n \n     public:\n+        /**\n+         * Construct an invalid subnet (empty, `Match()` always returns false).\n+         */\n         CSubNet();\n+\n+        /**\n+         * Construct from a given network start and number of bits (CIDR mask).\n+         * @param[in] addr Network start. If not IPv4 or IPv6, then a signle-host subnet is created.\n+         * @param[in] mask CIDR mask, must be in [0, 32] for IPv4 addresses and in [0, 128] for IPv6\n+         * addresses. Otherwise an invalid subnet is created. Ignored for non-IP `addr`.\n+         */\n         CSubNet(const CNetAddr& addr, uint8_t mask);\n+\n+        /**\n+         * Construct from a given network start and mask.\n+         * @param[in] addr Network start. If not IPv4 or IPv6, then a signle-host subnet is created.\n+         * @param[in] mask Network mask, must be of the same type as `addr` and not contain 0-bits\n+         * followed by 1-bits. Otherwise an invalid subnet is created. Ignored for non-IP `addr`.\n+         */\n         CSubNet(const CNetAddr& addr, const CNetAddr& mask);\n \n-        //constructor for single ip subnet (<ipv4>/32 or <ipv6>/128)\n+        /**\n+         * Construct a single-host subnet.\n+         * @param[in] addr the sole address to be contained in the subnet.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r551875461",
      "id" : 551875461,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTg3NTQ2MQ==",
      "original_commit_id" : "6ab8b2b5d4a918c98c37fe057aa3af53e6f2b45e",
      "original_line" : 488,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : null,
      "pull_request_review_id" : 561713454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-06T16:19:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551875461",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "```\r\n test  2021-01-05T11:36:34.542000Z TestFramework (ERROR): JSONRPC error \r\n                                   Traceback (most recent call last):\r\n                                     File \"/private/var/folders/3y/l0z1x3693dl_8n0qybp4dqwh0000gn/T/cirrus-ci-build/ci/scratch/build/bitcoin-x86_64-apple-darwin18/test/functional/test_framework/test_framework.py\", line 126, in main\r\n                                       self.run_test()\r\n                                     File \"/private/var/folders/3y/l0z1x3693dl_8n0qybp4dqwh0000gn/T/cirrus-ci-build/ci/scratch/build/bitcoin-x86_64-apple-darwin18/test/functional/rpc_setban.py\", line 39, in run_test\r\n                                       self.nodes[1].setban(\"127.0.0.1\", \"remove\")\r\n                                     File \"/private/var/folders/3y/l0z1x3693dl_8n0qybp4dqwh0000gn/T/cirrus-ci-build/ci/scratch/build/bitcoin-x86_64-apple-darwin18/test/functional/test_framework/coverage.py\", line 47, in __call__\r\n                                       return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n                                     File \"/private/var/folders/3y/l0z1x3693dl_8n0qybp4dqwh0000gn/T/cirrus-ci-build/ci/scratch/build/bitcoin-x86_64-apple-darwin18/test/functional/test_framework/authproxy.py\", line 146, in __call__\r\n                                       raise JSONRPCException(response['error'], status)\r\n                                   test_framework.authproxy.JSONRPCException: Error: Unban failed. Requested address/subnet was not previously manually banned. (-30)",
      "created_at" : "2021-01-05T11:41:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-754584806",
      "id" : 754584806,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20852",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NDU4NDgwNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-05T11:41:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754584806",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r551881168"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551881168"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should we keep this `assert`?\r\n```diff\r\n     case NET_IPV4:\r\n     case NET_IPV6:\r\n         valid = true;\r\n+        assert(addr.m_addr.size() <= sizeof(netmask));\r\n         memset(netmask, 0xFF, sizeof(netmask));\r\n         break;\r\n     case NET_ONION:\r\n```",
      "commit_id" : "293070adc34f979bee1e9315cc70973a168c3af2",
      "created_at" : "2021-01-05T11:42:11Z",
      "diff_hunk" : "@@ -1068,15 +1101,23 @@ CSubNet::CSubNet(const CNetAddr& addr, const CNetAddr& mask) : CSubNet()\n \n CSubNet::CSubNet(const CNetAddr& addr) : CSubNet()\n {\n-    valid = addr.IsIPv4() || addr.IsIPv6();\n-    if (!valid) {\n+    switch (addr.m_net) {\n+    case NET_IPV4:\n+    case NET_IPV6:\n+        valid = true;\n+        memset(netmask, 0xFF, sizeof(netmask));\n+        break;\n+    case NET_ONION:\n+    case NET_I2P:\n+    case NET_CJDNS:\n+        valid = true;\n+        break;\n+    case NET_INTERNAL:\n+    case NET_UNROUTABLE:\n+    case NET_MAX:\n         return;\n     }\n \n-    assert(addr.m_addr.size() <= sizeof(netmask));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r551881168",
      "id" : 551881168,
      "line" : 1076,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MTg4MTE2OA==",
      "original_commit_id" : "6ab8b2b5d4a918c98c37fe057aa3af53e6f2b45e",
      "original_line" : 1076,
      "original_position" : 76,
      "original_start_line" : null,
      "path" : "src/netaddress.cpp",
      "position" : 77,
      "pull_request_review_id" : 561713454,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-06T16:19:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/551881168",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I am not familiar with this part of the codebase, but it seems safer to move this to 0.21.1. This claims to fix a bug how outbound onion addresses are handled by rpc and misbehavior-disconnect. However, it changes the code paths for all networks and all net handling. So it seems a bit risky to push out this late in the rc stage. (There haven't been any major issues since rc3 other than the macos code signing, so rc5 might very well be a good -final). It could be documented in the release notes, if needed, and a 0.21.1 can be pushed out once this has settled in the master branch (maybe after ~1-2 months)?",
      "created_at" : "2021-01-05T11:48:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-754588051",
      "id" : 754588051,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20852",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NDU4ODA1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-05T11:48:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754588051",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "6ab8b2b5d...826b8d9eb: fix failing `rpc_setban.py` by making sure in-memory representation of `CSubNet::netmask[]` for IPv4 subnets is the same when deserialized from disk and when created via the constructor.\r\n\r\nFor IPv4, [deserialize](https://github.com/bitcoin/bitcoin/blob/3b6d1b61d31674e033e821046baa95c66dedf623/src/netaddress.h#L490) only sets the first 4 bytes of the netmask, leaving the remaining 12 bytes to the default `0`. `operator==` [compares all the 16 bytes](https://github.com/bitcoin/bitcoin/blob/3b6d1b61d31674e033e821046baa95c66dedf623/src/netaddress.cpp#L1134), so we want a deserialized subnet to equal the same subnet that is created via the `CSubNet::CSubNet(CNetAddr)` constructor. Thus, in that constructor only set the first 4 bytes and leave the remaining 12 ones to the default `0`.\r\n\r\nYes, `operator==` need not compare all the 16 bytes for IPv4, it can/should compare just the first 4. Fixing this by modifying `operator==` I think goes beyond the purpose of this PR which is to allow non-IP subnets. So I restored the code to only set the first 4 bytes (+ the assert to ensure no overflow). This is the [same as in `master`](https://github.com/bitcoin/bitcoin/blob/3b6d1b61d31674e033e821046baa95c66dedf623/src/netaddress.cpp#L1076-L1078).\r\n\r\nEventually `uint8_t CSubNet::netmask[16]` should be changed to `uint8_t CSubNet::m_cidr`.",
      "created_at" : "2021-01-06T16:10:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-755393067",
      "id" : 755393067,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20852",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTM5MzA2Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-06T16:10:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755393067",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r552756569"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552756569"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed.",
      "commit_id" : "293070adc34f979bee1e9315cc70973a168c3af2",
      "created_at" : "2021-01-06T16:12:07Z",
      "diff_hunk" : "@@ -462,11 +462,31 @@ class CSubNet\n         bool SanityCheck() const;\n \n     public:\n+        /**\n+         * Construct an invalid subnet (empty, `Match()` always returns false).\n+         */\n         CSubNet();\n+\n+        /**\n+         * Construct from a given network start and number of bits (CIDR mask).\n+         * @param[in] addr Network start. If not IPv4 or IPv6, then a signle-host subnet is created.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r552756569",
      "id" : 552756569,
      "in_reply_to_id" : 551873584,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mjc1NjU2OQ==",
      "original_commit_id" : "6ab8b2b5d4a918c98c37fe057aa3af53e6f2b45e",
      "original_line" : 472,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : null,
      "pull_request_review_id" : 562840316,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-06T16:19:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552756569",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r552759552"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552759552"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This 3-column-layout has a maintainability problem when a parameter with longer name is added or existent one renamed.",
      "commit_id" : "293070adc34f979bee1e9315cc70973a168c3af2",
      "created_at" : "2021-01-06T16:13:55Z",
      "diff_hunk" : "@@ -462,11 +462,31 @@ class CSubNet\n         bool SanityCheck() const;\n \n     public:\n+        /**\n+         * Construct an invalid subnet (empty, `Match()` always returns false).\n+         */\n         CSubNet();\n+\n+        /**\n+         * Construct from a given network start and number of bits (CIDR mask).\n+         * @param[in] addr Network start. If not IPv4 or IPv6, then a signle-host subnet is created.\n+         * @param[in] mask CIDR mask, must be in [0, 32] for IPv4 addresses and in [0, 128] for IPv6\n+         * addresses. Otherwise an invalid subnet is created. Ignored for non-IP `addr`.\n+         */\n         CSubNet(const CNetAddr& addr, uint8_t mask);\n+\n+        /**\n+         * Construct from a given network start and mask.\n+         * @param[in] addr Network start. If not IPv4 or IPv6, then a signle-host subnet is created.\n+         * @param[in] mask Network mask, must be of the same type as `addr` and not contain 0-bits\n+         * followed by 1-bits. Otherwise an invalid subnet is created. Ignored for non-IP `addr`.\n+         */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r552759552",
      "id" : 552759552,
      "in_reply_to_id" : 551875221,
      "line" : 483,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mjc1OTU1Mg==",
      "original_commit_id" : "6ab8b2b5d4a918c98c37fe057aa3af53e6f2b45e",
      "original_line" : 483,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 22,
      "pull_request_review_id" : 562841787,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-06T16:19:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552759552",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r552762858"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552762858"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Took only the capital, without the space :)",
      "commit_id" : "293070adc34f979bee1e9315cc70973a168c3af2",
      "created_at" : "2021-01-06T16:15:53Z",
      "diff_hunk" : "@@ -462,11 +462,31 @@ class CSubNet\n         bool SanityCheck() const;\n \n     public:\n+        /**\n+         * Construct an invalid subnet (empty, `Match()` always returns false).\n+         */\n         CSubNet();\n+\n+        /**\n+         * Construct from a given network start and number of bits (CIDR mask).\n+         * @param[in] addr Network start. If not IPv4 or IPv6, then a signle-host subnet is created.\n+         * @param[in] mask CIDR mask, must be in [0, 32] for IPv4 addresses and in [0, 128] for IPv6\n+         * addresses. Otherwise an invalid subnet is created. Ignored for non-IP `addr`.\n+         */\n         CSubNet(const CNetAddr& addr, uint8_t mask);\n+\n+        /**\n+         * Construct from a given network start and mask.\n+         * @param[in] addr Network start. If not IPv4 or IPv6, then a signle-host subnet is created.\n+         * @param[in] mask Network mask, must be of the same type as `addr` and not contain 0-bits\n+         * followed by 1-bits. Otherwise an invalid subnet is created. Ignored for non-IP `addr`.\n+         */\n         CSubNet(const CNetAddr& addr, const CNetAddr& mask);\n \n-        //constructor for single ip subnet (<ipv4>/32 or <ipv6>/128)\n+        /**\n+         * Construct a single-host subnet.\n+         * @param[in] addr the sole address to be contained in the subnet.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r552762858",
      "id" : 552762858,
      "in_reply_to_id" : 551875461,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mjc2Mjg1OA==",
      "original_commit_id" : "6ab8b2b5d4a918c98c37fe057aa3af53e6f2b45e",
      "original_line" : 488,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : null,
      "pull_request_review_id" : 562843458,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-06T16:19:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552762858",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r552768364"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552768364"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The assert was there because in `master` we wrote `addr.m_addr.size()` bytes and here it is changed to write `sizeof(netmask)` bytes so it can't overflow and thus I removed the assert.\r\n\r\nHowever, I changed/restored it to write `addr.m_addr.size()` bytes and also restored the assert, [explanation](https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-755393067).",
      "commit_id" : "293070adc34f979bee1e9315cc70973a168c3af2",
      "created_at" : "2021-01-06T16:19:01Z",
      "diff_hunk" : "@@ -1068,15 +1101,23 @@ CSubNet::CSubNet(const CNetAddr& addr, const CNetAddr& mask) : CSubNet()\n \n CSubNet::CSubNet(const CNetAddr& addr) : CSubNet()\n {\n-    valid = addr.IsIPv4() || addr.IsIPv6();\n-    if (!valid) {\n+    switch (addr.m_net) {\n+    case NET_IPV4:\n+    case NET_IPV6:\n+        valid = true;\n+        memset(netmask, 0xFF, sizeof(netmask));\n+        break;\n+    case NET_ONION:\n+    case NET_I2P:\n+    case NET_CJDNS:\n+        valid = true;\n+        break;\n+    case NET_INTERNAL:\n+    case NET_UNROUTABLE:\n+    case NET_MAX:\n         return;\n     }\n \n-    assert(addr.m_addr.size() <= sizeof(netmask));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r552768364",
      "id" : 552768364,
      "in_reply_to_id" : 551881168,
      "line" : 1076,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Mjc2ODM2NA==",
      "original_commit_id" : "6ab8b2b5d4a918c98c37fe057aa3af53e6f2b45e",
      "original_line" : 1076,
      "original_position" : 76,
      "original_start_line" : null,
      "path" : "src/netaddress.cpp",
      "position" : 77,
      "pull_request_review_id" : 562846094,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-06T16:19:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552768364",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "826b8d9eb...293070adc: fix typos in comments",
      "created_at" : "2021-01-06T16:19:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-755400221",
      "id" : 755400221,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20852",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTQwMDIyMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-06T16:19:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755400221",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke \r\n> ... it changes the code paths for all networks and all net handling ...\r\n\r\nIndeed. `CSubNet` is used in lots of places and changes to it can have subtle effects, as shown by CI failures on this PR.",
      "created_at" : "2021-01-06T16:26:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-755406388",
      "id" : 755406388,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20852",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTQwNjM4OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-06T16:26:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755406388",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r552823103"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552823103"
         }
      },
      "author_association" : "MEMBER",
      "body" : "We shouldn't just *ignore* `mask`... Might be best to only change the single-address form?",
      "commit_id" : "293070adc34f979bee1e9315cc70973a168c3af2",
      "created_at" : "2021-01-06T17:14:47Z",
      "diff_hunk" : "@@ -996,8 +996,25 @@ CSubNet::CSubNet():\n \n CSubNet::CSubNet(const CNetAddr& addr, uint8_t mask) : CSubNet()\n {\n-    valid = (addr.IsIPv4() && mask <= ADDR_IPV4_SIZE * 8) ||\n-            (addr.IsIPv6() && mask <= ADDR_IPV6_SIZE * 8);\n+    switch (addr.m_net) {\n+    case NET_IPV4:\n+        valid = mask <= ADDR_IPV4_SIZE * 8;\n+        break;\n+    case NET_IPV6:\n+        valid = mask <= ADDR_IPV6_SIZE * 8;\n+        break;\n+    case NET_ONION:\n+    case NET_I2P:\n+    case NET_CJDNS:\n+        valid = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20852#discussion_r552823103",
      "id" : 552823103,
      "line" : 1009,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjgyMzEwMw==",
      "original_commit_id" : "293070adc34f979bee1e9315cc70973a168c3af2",
      "original_line" : 1009,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/netaddress.cpp",
      "position" : 16,
      "pull_request_review_id" : 562891345,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20852",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-06T17:14:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552823103",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   }
]
