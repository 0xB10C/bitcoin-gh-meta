[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20876 (test: Replace getmempoolentry with testmempoolaccept in MiniWallet by MarcoFalke)\n* #20391 (wallet: introduce setfeerate (an improved settxfee, in sat/vB) by jonatack)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-01-07T19:55:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20874#issuecomment-756346617",
      "id" : 756346617,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20874",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NjM0NjYxNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-07T19:55:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/756346617",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20874#discussion_r554068735"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20874"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/554068735"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just curious, is there a reason to generate blocks through the MiniWallet and the TestNode separately?",
      "commit_id" : "543919b4b19b98867b3eebc33b38c87f4fd164a3",
      "created_at" : "2021-01-08T16:55:36Z",
      "diff_hunk" : "@@ -20,55 +21,44 @@ def set_test_params(self):\n         ]]\n         self.supports_cli = False\n \n-    def skip_test_if_missing_module(self):\n-        self.skip_if_no_wallet()\n-\n     def run_test(self):\n         txouts = gen_return_txouts()\n-        relayfee = self.nodes[0].getnetworkinfo()['relayfee']\n+        node = self.nodes[0]\n+        miniwallet = MiniWallet(node)\n+        relayfee = node.getnetworkinfo()['relayfee']\n \n         self.log.info('Check that mempoolminfee is minrelytxfee')\n-        assert_equal(self.nodes[0].getmempoolinfo()['minrelaytxfee'], Decimal('0.00001000'))\n-        assert_equal(self.nodes[0].getmempoolinfo()['mempoolminfee'], Decimal('0.00001000'))\n+        assert_equal(node.getmempoolinfo()['minrelaytxfee'], Decimal('0.00001000'))\n+        assert_equal(node.getmempoolinfo()['mempoolminfee'], Decimal('0.00001000'))\n \n-        txids = []\n-        utxos = create_confirmed_utxos(relayfee, self.nodes[0], 91)\n+        txids=[]\n+        miniwallet.generate(91)\n+        node.generate(100)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20874#discussion_r554068735",
      "id" : 554068735,
      "line" : 36,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDA2ODczNQ==",
      "original_commit_id" : "543919b4b19b98867b3eebc33b38c87f4fd164a3",
      "original_line" : 36,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "test/functional/mempool_limit.py",
      "position" : 34,
      "pull_request_review_id" : 564423905,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20874",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-08T16:55:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/554068735",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/264977?v=4",
         "events_url" : "https://api.github.com/users/joelklabo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/joelklabo/followers",
         "following_url" : "https://api.github.com/users/joelklabo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/joelklabo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/joelklabo",
         "id" : 264977,
         "login" : "joelklabo",
         "node_id" : "MDQ6VXNlcjI2NDk3Nw==",
         "organizations_url" : "https://api.github.com/users/joelklabo/orgs",
         "received_events_url" : "https://api.github.com/users/joelklabo/received_events",
         "repos_url" : "https://api.github.com/users/joelklabo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/joelklabo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/joelklabo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/joelklabo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20874#discussion_r554073731"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20874"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/554073731"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "We generate blocks in `MiniWallet` so we have utxos to spend (coinbases). It is helpful to generate 100 blocks on the node separately, so all the utxos in MiniWallet are mature.\r\n\r\nIf we just did, miniwallet.generate(191), only 91 of the utxos in mini wallets utxo set will be mature. And it gets tricky because some miniwallet transactions will now fail (And we don't necessarily know which utxo we are gonna get as mini wallet sorts them by size)",
      "commit_id" : "543919b4b19b98867b3eebc33b38c87f4fd164a3",
      "created_at" : "2021-01-08T17:03:10Z",
      "diff_hunk" : "@@ -20,55 +21,44 @@ def set_test_params(self):\n         ]]\n         self.supports_cli = False\n \n-    def skip_test_if_missing_module(self):\n-        self.skip_if_no_wallet()\n-\n     def run_test(self):\n         txouts = gen_return_txouts()\n-        relayfee = self.nodes[0].getnetworkinfo()['relayfee']\n+        node = self.nodes[0]\n+        miniwallet = MiniWallet(node)\n+        relayfee = node.getnetworkinfo()['relayfee']\n \n         self.log.info('Check that mempoolminfee is minrelytxfee')\n-        assert_equal(self.nodes[0].getmempoolinfo()['minrelaytxfee'], Decimal('0.00001000'))\n-        assert_equal(self.nodes[0].getmempoolinfo()['mempoolminfee'], Decimal('0.00001000'))\n+        assert_equal(node.getmempoolinfo()['minrelaytxfee'], Decimal('0.00001000'))\n+        assert_equal(node.getmempoolinfo()['mempoolminfee'], Decimal('0.00001000'))\n \n-        txids = []\n-        utxos = create_confirmed_utxos(relayfee, self.nodes[0], 91)\n+        txids=[]\n+        miniwallet.generate(91)\n+        node.generate(100)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20874#discussion_r554073731",
      "id" : 554073731,
      "in_reply_to_id" : 554068735,
      "line" : 36,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NDA3MzczMQ==",
      "original_commit_id" : "543919b4b19b98867b3eebc33b38c87f4fd164a3",
      "original_line" : 36,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "test/functional/mempool_limit.py",
      "position" : 34,
      "pull_request_review_id" : 564429452,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20874",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-08T17:03:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/554073731",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7217256?v=4",
         "events_url" : "https://api.github.com/users/mjdietzx/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mjdietzx/followers",
         "following_url" : "https://api.github.com/users/mjdietzx/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mjdietzx/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mjdietzx",
         "id" : 7217256,
         "login" : "mjdietzx",
         "node_id" : "MDQ6VXNlcjcyMTcyNTY=",
         "organizations_url" : "https://api.github.com/users/mjdietzx/orgs",
         "received_events_url" : "https://api.github.com/users/mjdietzx/received_events",
         "repos_url" : "https://api.github.com/users/mjdietzx/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mjdietzx/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mjdietzx/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mjdietzx"
      }
   }
]
