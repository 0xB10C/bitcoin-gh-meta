[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20916 (rpc: Return wtxid from testmempoolaccept by MarcoFalke)\n* #20874 (test: Run mempool_limit.py even with wallet disabled by stackman27)\n* #20808 (test: Run rpc_generateblock.py even with wallet disabled by nginocchio)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-01-09T03:48:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20889#issuecomment-757089800",
      "id" : 757089800,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20889",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NzA4OTgwMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-13T07:24:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/757089800",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The initial design was that none of the calls would be allowed to throw, but no objection to making it more robust and extensible.",
      "created_at" : "2021-01-10T09:35:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20889#issuecomment-757445935",
      "id" : 757445935,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20889",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NzQ0NTkzNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-10T09:35:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/757445935",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Concept ACK. Reviewed and tested `send-self-transfer`, still testing `generate` method. Actually, faced a related issue while implementing tx after an exception in `mempool_limit.py`, but just went with the intuition that we pop the invalid utxo therefore the rest stays valid ð\r\n> \r\n> So I believe the invalid utxo stays in the list even after popping and/or exception in `send_self_transfer`?\r\n\r\nThanks! So before this PR the invalid utxo would stay in the list (unless you explicitly popped it out yourself when you handle the exception). After this PR, the invalid utxo would never have been appended to the list if `send_self_transfer` failed. So after this PR it would be more robust, and I think more intuitive",
      "created_at" : "2021-01-10T18:44:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20889#issuecomment-757523736",
      "id" : 757523736,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20889",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NzUyMzczNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-10T18:44:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/757523736",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/7217256?v=4",
         "events_url" : "https://api.github.com/users/mjdietzx/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mjdietzx/followers",
         "following_url" : "https://api.github.com/users/mjdietzx/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mjdietzx/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mjdietzx",
         "id" : 7217256,
         "login" : "mjdietzx",
         "node_id" : "MDQ6VXNlcjcyMTcyNTY=",
         "organizations_url" : "https://api.github.com/users/mjdietzx/orgs",
         "received_events_url" : "https://api.github.com/users/mjdietzx/received_events",
         "repos_url" : "https://api.github.com/users/mjdietzx/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mjdietzx/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mjdietzx/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mjdietzx"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-01-15T19:53:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20889#issuecomment-761165213",
      "id" : 761165213,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20889",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2MTE2NTIxMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-15T19:53:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/761165213",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20889#discussion_r576270231"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20889"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/576270231"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: Aren't we assigning utxos when `sendrawtransaction` succeeds? So, shouldn't it be `#update... after we are sure that sendrawtransaction will succeed` because in the case if we add sign_dont_send options, the `send_self_transfer` succeeds but dont spend tx? ",
      "commit_id" : "140e429c16e19efb28b7d825a6ccfbf32eb3c2ff",
      "created_at" : "2021-02-15T15:28:59Z",
      "diff_hunk" : "@@ -72,8 +72,9 @@ def send_self_transfer(self, *, fee_rate=Decimal(\"0.003\"), from_node, utxo_to_sp\n         tx_hex = tx.serialize().hex()\n \n         tx_info = from_node.testmempoolaccept([tx_hex])[0]\n-        self._utxos.append({'txid': tx_info['txid'], 'vout': 0, 'value': send_value})\n+        utxos.append({'txid': tx_info['txid'], 'vout': 0, 'value': send_value})\n         from_node.sendrawtransaction(tx_hex)\n         assert_equal(tx_info['vsize'], vsize)\n         assert_equal(tx_info['fees']['base'], fee)\n+        self._utxos = utxos  # update our internal utxo set after we are sure send_self_transfer will succeed",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20889#discussion_r576270231",
      "id" : 576270231,
      "line" : 79,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU3NjI3MDIzMQ==",
      "original_commit_id" : "140e429c16e19efb28b7d825a6ccfbf32eb3c2ff",
      "original_line" : 79,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "test/functional/test_framework/wallet.py",
      "position" : 33,
      "pull_request_review_id" : 590574989,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20889",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-02-15T15:33:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/576270231",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/26356227?v=4",
         "events_url" : "https://api.github.com/users/stackman27/events{/privacy}",
         "followers_url" : "https://api.github.com/users/stackman27/followers",
         "following_url" : "https://api.github.com/users/stackman27/following{/other_user}",
         "gists_url" : "https://api.github.com/users/stackman27/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/stackman27",
         "id" : 26356227,
         "login" : "stackman27",
         "node_id" : "MDQ6VXNlcjI2MzU2MjI3",
         "organizations_url" : "https://api.github.com/users/stackman27/orgs",
         "received_events_url" : "https://api.github.com/users/stackman27/received_events",
         "repos_url" : "https://api.github.com/users/stackman27/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/stackman27/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/stackman27/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/stackman27"
      }
   }
]
