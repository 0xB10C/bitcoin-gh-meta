[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15118#discussion_r245562887"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15118"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245562887"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should this not be `||`? /cc @jonasschnelli 386a6b62a8a1db9dd0f354cb95b7585f555c7e5d",
      "commit_id" : "13583e8a5edbb433f3e92562080786f8c079c5ca",
      "created_at" : "2019-01-07T07:04:02Z",
      "diff_hunk" : "@@ -1631,8 +1631,8 @@ bool AppInitMain(InitInterfaces& interfaces)\n \n     // ********************************************************* Step 11: import blocks\n \n-    if (!CheckDiskSpace() && !CheckDiskSpace(0, true))\n-        return false;\n+    if (!CheckDiskSpace(GetDataDir()) && !CheckDiskSpace(GetBlocksDir()))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15118#discussion_r245562887",
      "id" : 245562887,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NTU2Mjg4Nw==",
      "original_commit_id" : "9ab64b2276b2ab6638987282cce16be9b682d490",
      "original_position" : 17,
      "path" : "src/init.cpp",
      "position" : 17,
      "pull_request_review_id" : 189693788,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15118",
      "updated_at" : "2019-01-07T07:20:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245562887",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15118#discussion_r245563648"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15118"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245563648"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: could be static within the function",
      "commit_id" : "13583e8a5edbb433f3e92562080786f8c079c5ca",
      "created_at" : "2019-01-07T07:10:08Z",
      "diff_hunk" : "@@ -78,6 +78,9 @@\n #include <openssl/conf.h>\n #include <thread>\n \n+/** Minimum disk space required - used in CheckDiskSpace() */\n+static constexpr uint64_t nMinDiskSpace = 52428800;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15118#discussion_r245563648",
      "id" : 245563648,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NTU2MzY0OA==",
      "original_commit_id" : "2af8b710b3183e82f7ff898a5c42502bab4bf753",
      "original_position" : 5,
      "path" : "src/util/system.cpp",
      "position" : 5,
      "pull_request_review_id" : 189694792,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15118",
      "updated_at" : "2019-01-07T07:20:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245563648",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15118#discussion_r245565332"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15118"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245565332"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: These could each be const.\r\n`#include <cstddef>` for `size_t`",
      "commit_id" : "13583e8a5edbb433f3e92562080786f8c079c5ca",
      "created_at" : "2019-01-07T07:22:24Z",
      "diff_hunk" : "@@ -0,0 +1,36 @@\n+// Copyright (c) 2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_FLATFILE_H\n+#define BITCOIN_FLATFILE_H\n+\n+#include <chain.h>\n+#include <fs.h>\n+\n+/**\n+ * FlatFileSeq represents a sequence of numbered files storing raw data. This class facilitates\n+ * access to and efficient management of these files.\n+ */\n+class FlatFileSeq\n+{\n+private:\n+    fs::path m_dir;\n+    const char* m_prefix;\n+    size_t m_chunk_size;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15118#discussion_r245565332",
      "id" : 245565332,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NTU2NTMzMg==",
      "original_commit_id" : "88cf78032c221632643877dcada1ef38b3819460",
      "original_position" : 20,
      "path" : "src/flatfile.h",
      "position" : 59,
      "pull_request_review_id" : 189696918,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15118",
      "updated_at" : "2019-01-07T07:22:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245565332",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15118#discussion_r245567581"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15118"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245567581"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: `true`",
      "commit_id" : "13583e8a5edbb433f3e92562080786f8c079c5ca",
      "created_at" : "2019-01-07T07:34:40Z",
      "diff_hunk" : "@@ -45,6 +45,15 @@ class FlatFileSeq\n      * @return The number of bytes successfully allocated.\n      */\n     size_t Allocate(const CDiskBlockPos& pos, size_t add_size, bool& out_of_space);\n+\n+    /**\n+     * Commit a file to disk, and optionally truncate off extra pre-allocated bytes if final.\n+     *\n+     * @param[in] pos The first unwritten position in the file to be flushed.\n+     * @param[in] finalize True if no more data will be written to this file.\n+     * @return True on success, false on failure.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15118#discussion_r245567581",
      "id" : 245567581,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NTU2NzU4MQ==",
      "original_commit_id" : "d48754408bb36c8105002b1515ab8bb12db9313b",
      "original_position" : 10,
      "path" : "src/flatfile.h",
      "position" : 93,
      "pull_request_review_id" : 189699366,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15118",
      "updated_at" : "2019-01-07T07:34:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245567581",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15118#discussion_r245568440"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15118"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245568440"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: this adds an extra `fseek` via `Open` each.",
      "commit_id" : "13583e8a5edbb433f3e92562080786f8c079c5ca",
      "created_at" : "2019-01-07T07:40:07Z",
      "diff_hunk" : "@@ -1631,25 +1631,12 @@ void static FlushBlockFile(bool fFinalize = false)\n {\n     LOCK(cs_LastBlockFile);\n \n-    CDiskBlockPos posOld(nLastBlockFile, 0);\n-    bool status = true;\n-\n-    FILE *fileOld = OpenBlockFile(posOld);\n-    if (fileOld) {\n-        if (fFinalize)\n-            status &= TruncateFile(fileOld, vinfoBlockFile[nLastBlockFile].nSize);\n-        status &= FileCommit(fileOld);\n-        fclose(fileOld);\n-    }\n-\n-    fileOld = OpenUndoFile(posOld);\n-    if (fileOld) {\n-        if (fFinalize)\n-            status &= TruncateFile(fileOld, vinfoBlockFile[nLastBlockFile].nUndoSize);\n-        status &= FileCommit(fileOld);\n-        fclose(fileOld);\n-    }\n+    CDiskBlockPos block_pos_old(nLastBlockFile, vinfoBlockFile[nLastBlockFile].nSize);\n+    CDiskBlockPos undo_pos_old(nLastBlockFile, vinfoBlockFile[nLastBlockFile].nUndoSize);\n \n+    bool status = true;\n+    status &= BlockFileSeq().Flush(block_pos_old, fFinalize);\n+    status &= UndoFileSeq().Flush(undo_pos_old, fFinalize);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15118#discussion_r245568440",
      "id" : 245568440,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NTU2ODQ0MA==",
      "original_commit_id" : "d48754408bb36c8105002b1515ab8bb12db9313b",
      "original_position" : 27,
      "path" : "src/validation.cpp",
      "position" : 130,
      "pull_request_review_id" : 189700488,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15118",
      "updated_at" : "2019-01-07T07:40:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245568440",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15118#discussion_r245569540"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15118"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245569540"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`#include <string>`",
      "commit_id" : "13583e8a5edbb433f3e92562080786f8c079c5ca",
      "created_at" : "2019-01-07T07:47:09Z",
      "diff_hunk" : "@@ -0,0 +1,98 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_FLATFILE_H\n+#define BITCOIN_FLATFILE_H\n+\n+#include <string>\n+\n+#include <fs.h>\n+#include <serialize.h>\n+\n+struct FlatFilePos\n+{\n+    int nFile;\n+    unsigned int nPos;\n+\n+    ADD_SERIALIZE_METHODS;\n+\n+    template <typename Stream, typename Operation>\n+    inline void SerializationOp(Stream& s, Operation ser_action) {\n+        READWRITE(VARINT(nFile, VarIntMode::NONNEGATIVE_SIGNED));\n+        READWRITE(VARINT(nPos));\n+    }\n+\n+    FlatFilePos() {\n+        SetNull();\n+    }\n+\n+    FlatFilePos(int nFileIn, unsigned int nPosIn) {\n+        nFile = nFileIn;\n+        nPos = nPosIn;\n+    }\n+\n+    friend bool operator==(const FlatFilePos &a, const FlatFilePos &b) {\n+        return (a.nFile == b.nFile && a.nPos == b.nPos);\n+    }\n+\n+    friend bool operator!=(const FlatFilePos &a, const FlatFilePos &b) {\n+        return !(a == b);\n+    }\n+\n+    void SetNull() { nFile = -1; nPos = 0; }\n+    bool IsNull() const { return (nFile == -1); }\n+\n+    std::string ToString() const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15118#discussion_r245569540",
      "id" : 245569540,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NTU2OTU0MA==",
      "original_commit_id" : "13583e8a5edbb433f3e92562080786f8c079c5ca",
      "original_position" : 47,
      "path" : "src/flatfile.h",
      "position" : 47,
      "pull_request_review_id" : 189701918,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15118",
      "updated_at" : "2019-01-07T07:47:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245569540",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK hooray objects!",
      "created_at" : "2019-01-07T07:48:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15118#issuecomment-451848663",
      "id" : 451848663,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15118",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1MTg0ODY2Mw==",
      "updated_at" : "2019-01-07T07:48:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/451848663",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   }
]
