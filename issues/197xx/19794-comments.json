[
   {
      "author_association" : "MEMBER",
      "body" : "concept ACK",
      "created_at" : "2020-08-24T21:54:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-679386340",
      "id" : 679386340,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3OTM4NjM0MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-24T21:54:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/679386340",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #17785 (p2p: Unify Send and Receive protocol versions by hebasto)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-08-25T07:20:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-679851573",
      "id" : 679851573,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY3OTg1MTU3Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-25T07:20:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/679851573",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for the review! I pushed an update, implementing both style suggestions and copying the PR description into the commit message.",
      "created_at" : "2020-08-25T20:32:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-680254918",
      "id" : 680254918,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MDI1NDkxOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-25T20:33:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/680254918",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK ef9855580098654cdfc5844f8922518e6602878f.\r\n\r\nIt's good to get rid of the useless code. Even though it's only a couple lines, the burden of this variable is massive: I spent 10 minutes figuring what does it do, even after reading the PR description.\r\n\r\nI tried to make sure we don't miss any corner cases, and I think this PR works correctly.\r\n\r\nRegarding your commit message:\r\n>2.) If the response to GETADDR is small  (<=10 addresses), it will be relayed to peers just as any other ADDR message of that size.\r\n\r\nI'm not sure it's a bug in master. I always thought of `<=10` check as something to limit the forwarding of unsolicited ADDRs. Now it may also forward a solicited ADDR. May it leak privacy somehow? I guess not, because we don't send them out immediately anyway.\r\n\r\n----------\r\n\r\nAs a side note, is this possible?\r\n1. Victim node V starts and connects to their peers\r\n2. An attacker spams V with a lot of unsolicited ADDR messages (of size <10 but from different Sybils) to make sure all ADDRs V sends to their peers is of size 11 at least.\r\n3. V's self-announcements (and other unsolicited ADDRs from V) are never forwarded by their peers, so only immediate peers ever learn about V.\r\n\r\nThis PR doesn't address this issue as a whole, but it removes one out of two mechanisms making this possible I believe :)\r\nI think we should look further and see if we can fix it in full, perhaps in another PR.",
      "created_at" : "2020-08-26T11:56:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-680833892",
      "id" : 680833892,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MDgzMzg5Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-26T11:56:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/680833892",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I'm not sure it's a bug in master. I always thought of <=10 check as something to limit the forwarding of unsolicited ADDRs. Now it may also forward a solicited ADDR. May it leak privacy somehow? I guess not, because we don't send them out immediately anyway.\r\n\r\nI just wanted to note that it is a small change in behaviour, not sure if it is a bug. In any case, I don't think that this will occur often, because with `MAX_PCT_ADDR_TO_SEND = 23` it would mean that an honest peer would need to have a really small addrman with less than 50 addresses  to send such a small response - usually, GETADDR responses should be considerably larger.\r\n\r\nRegarding your scenario:\r\nI think this is a very interesting scenario and probably worth addressing (V's address  could still be part of a GETADDR response though, even if it not forwarded).\r\nI don't see though how this PR helps with this even a little. On current master, `fGetAddr` is set in the VERSION processing with an outbound peer, and immediately unset as soon as we get a single ADDR with size < 1000 from the peer (and can never be set again for the duration of the connection) - while your scenario entails repeated messages.\r\n ",
      "created_at" : "2020-08-26T22:22:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-681154335",
      "id" : 681154335,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MTE1NDMzNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-26T22:22:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/681154335",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Though I had an idea what it was for, I don't think I've ever thoroughly understood this flag. Thanks for the explanation and ACK on removing it.\r\nACK ef9855580098654cdfc5844f8922518e6602878f",
      "created_at" : "2020-08-27T11:36:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19794#issuecomment-681893374",
      "id" : 681893374,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19794",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MTg5MzM3NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-08-27T11:36:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/681893374",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
