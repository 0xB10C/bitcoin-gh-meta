[
   {
      "author_association" : "MEMBER",
      "body" : "For testing `./src/test/test_bitcoin -t logging_tests -- DEBUG_LOG_OUT` may be useful.",
      "created_at" : "2022-04-19T16:17:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1102842295",
      "id" : 1102842295,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585BvAm3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1102842295/reactions"
      },
      "updated_at" : "2022-04-19T16:17:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1102842295",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Interesting, I'm curious what the lock logging will look like with variable units. ",
      "created_at" : "2022-04-19T16:22:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1102847198",
      "id" : 1102847198,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585BvBze",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1102847198/reactions"
      },
      "updated_at" : "2022-04-19T16:22:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1102847198",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25284](https://github.com/bitcoin/bitcoin/pull/25284) ([WIP] consensus: Remove dependency on net (BIP 155 / ADDRV2_FORMAT) by MarcoFalke)\n* [#25081](https://github.com/bitcoin/bitcoin/pull/25081) (tracing: lock contention analysis by martinus)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-04-19T16:52:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1102874949",
      "id" : 1102874949,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585BvIlF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1102874949/reactions"
      },
      "updated_at" : "2022-08-11T14:02:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1102874949",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853400004"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853400004"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In the second commit, maybe inverse the order of the duration checks from the smallest unit to the largest. ",
      "commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "created_at" : "2022-04-19T19:07:44Z",
      "diff_hunk" : "@@ -60,24 +59,21 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto dur{std::chrono::steady_clock::now() - m_start_t};\n+        if (m_start_t == decltype(m_start_t){}) {\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n-\n-        if constexpr (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            return strprintf(\"%s: %s (%iÎ¼s)\", m_prefix, msg, end_time.count());\n-        } else if constexpr (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n-            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, end_time.count() * 0.001);\n-        } else if constexpr (std::is_same<TimeType, std::chrono::seconds>::value) {\n-            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, end_time.count() * 0.000001);\n-        } else {\n-            static_assert(ALWAYS_FALSE<TimeType>, \"Error: unexpected time type\");\n+        if (dur > 1s) {\n+            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, CountSecondsDouble(dur));\n+        }\n+        if (dur > 1ms) {\n+            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, CountMillisecondsDouble(dur));\n         }\n+        return strprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853400004",
      "id" : 853400004,
      "line" : 72,
      "node_id" : "PRRC_kwDOABII584y3dnE",
      "original_commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "original_line" : 72,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : 54,
      "pull_request_review_id" : 946172695,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853400004/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-20T09:21:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853400004",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853766150"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853766150"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Can you explain why?",
      "commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "created_at" : "2022-04-20T06:24:01Z",
      "diff_hunk" : "@@ -60,24 +59,21 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto dur{std::chrono::steady_clock::now() - m_start_t};\n+        if (m_start_t == decltype(m_start_t){}) {\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n-\n-        if constexpr (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            return strprintf(\"%s: %s (%iÎ¼s)\", m_prefix, msg, end_time.count());\n-        } else if constexpr (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n-            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, end_time.count() * 0.001);\n-        } else if constexpr (std::is_same<TimeType, std::chrono::seconds>::value) {\n-            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, end_time.count() * 0.000001);\n-        } else {\n-            static_assert(ALWAYS_FALSE<TimeType>, \"Error: unexpected time type\");\n+        if (dur > 1s) {\n+            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, CountSecondsDouble(dur));\n+        }\n+        if (dur > 1ms) {\n+            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, CountMillisecondsDouble(dur));\n         }\n+        return strprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853766150",
      "id" : 853766150,
      "in_reply_to_id" : 853400004,
      "line" : 72,
      "node_id" : "PRRC_kwDOABII584y43AG",
      "original_commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "original_line" : 72,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : 54,
      "pull_request_review_id" : 946642019,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853766150/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-20T06:24:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853766150",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Interesting, I'm curious what the lock logging will look like with variable units.\r\n\r\nI think for them it will actually be an improvement, as contention might happen for a short blink (a few microseconds) or, during a block connection, a bit longer (a few seconds).",
      "created_at" : "2022-04-20T06:44:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1103528837",
      "id" : 1103528837,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585BxoOF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103528837/reactions"
      },
      "updated_at" : "2022-04-20T06:44:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103528837",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853913292"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853913292"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In higher frequency timing logs like lock, the smaller units seem to be more frequent. Debug build on a slow system:\r\n\r\n```\r\n2022-04-19T17:59:03Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 started\r\n2022-04-19T17:59:03Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 completed (253.02Î¼s)\r\n2022-04-19T17:59:03Z [msghand] Enter: lock contention cs_main, net_processing.cpp:4196 started\r\n2022-04-19T17:59:03Z [msghand] Enter: lock contention cs_main, net_processing.cpp:4196 completed (14.28ms)\r\n2022-04-19T17:59:03Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 started\r\n2022-04-19T17:59:03Z [scheduler] Enter: lock contention ::cs_main, validation.cpp:5151 started\r\n2022-04-19T17:59:03Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 completed (157.08ms)\r\n2022-04-19T17:59:03Z [msghand] Enter: lock contention ::cs_main, validation.cpp:5151 started\r\n2022-04-19T17:59:03Z [scheduler] Enter: lock contention ::cs_main, validation.cpp:5151 completed (24.14ms)\r\n2022-04-19T17:59:03Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 started\r\n2022-04-19T17:59:03Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 completed (10.48Î¼s)\r\n2022-04-19T17:59:03Z [msghand] Enter: lock contention ::cs_main, validation.cpp:5151 completed (7.92ms)\r\n2022-04-19T17:59:03Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 started\r\n2022-04-19T17:59:03Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 completed (5.57Î¼s)\r\n2022-04-19T17:59:03Z [msghand] Enter: lock contention ::cs_main, validation.cpp:5151 started\r\n2022-04-19T17:59:03Z [msghand] Enter: lock contention ::cs_main, validation.cpp:5151 completed (85.71Î¼s)\r\n2022-04-19T17:59:03Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 started\r\n2022-04-19T17:59:03Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 completed (4.68Î¼s)\r\n2022-04-19T17:59:03Z [msghand] Enter: lock contention m_mutex, random.cpp:416 started\r\n2022-04-19T17:59:03Z [msghand] Enter: lock contention m_mutex, random.cpp:416 completed (62.23Î¼s)\r\n2022-04-19T17:59:03Z [msghand] Enter: lock contention cs_main, net_processing.cpp:4668 started\r\n2022-04-19T17:59:03Z [msghand] Enter: lock contention cs_main, net_processing.cpp:4668 completed (911.14Î¼s)\r\n```\r\n ",
      "commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "created_at" : "2022-04-20T09:14:39Z",
      "diff_hunk" : "@@ -60,24 +59,21 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto dur{std::chrono::steady_clock::now() - m_start_t};\n+        if (m_start_t == decltype(m_start_t){}) {\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n-\n-        if constexpr (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            return strprintf(\"%s: %s (%iÎ¼s)\", m_prefix, msg, end_time.count());\n-        } else if constexpr (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n-            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, end_time.count() * 0.001);\n-        } else if constexpr (std::is_same<TimeType, std::chrono::seconds>::value) {\n-            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, end_time.count() * 0.000001);\n-        } else {\n-            static_assert(ALWAYS_FALSE<TimeType>, \"Error: unexpected time type\");\n+        if (dur > 1s) {\n+            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, CountSecondsDouble(dur));\n+        }\n+        if (dur > 1ms) {\n+            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, CountMillisecondsDouble(dur));\n         }\n+        return strprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853913292",
      "id" : 853913292,
      "in_reply_to_id" : 853400004,
      "line" : 72,
      "node_id" : "PRRC_kwDOABII584y5a7M",
      "original_commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "original_line" : 72,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : 54,
      "pull_request_review_id" : 946845178,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853913292/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-20T09:14:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853913292",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > Interesting, I'm curious what the lock logging will look like with variable units.\r\n> \r\n> I think for them it will actually be an improvement, as contention might happen for a short blink (a few microseconds) or, during a block connection, a bit longer (a few seconds).\r\n\r\nYes, the lock logging has a high variance in timing. See https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853913292 for a test with this change. One downside is that it's more difficult to pick out the higher times by eyeballing the log with this change (similar to your point that \"There is one argument for a fixed precision, as it makes debug log parsers slightly easier.\") but still seems to be an improvement for the reasons in the OP. ",
      "created_at" : "2022-04-20T09:17:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1103680570",
      "id" : 1103680570,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585ByNQ6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103680570/reactions"
      },
      "updated_at" : "2022-04-20T09:22:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103680570",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853961057"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853961057"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I mean the order is intentional and it can not be changed without changing the behaviour of the code.",
      "commit_id" : "fa846da728d2160f42effe67637e8ae3fcda308b",
      "created_at" : "2022-04-20T10:06:12Z",
      "diff_hunk" : "@@ -60,24 +59,21 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto dur{std::chrono::steady_clock::now() - m_start_t};\n+        if (m_start_t == decltype(m_start_t){}) {\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n-\n-        if constexpr (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            return strprintf(\"%s: %s (%iÎ¼s)\", m_prefix, msg, end_time.count());\n-        } else if constexpr (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n-            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, end_time.count() * 0.001);\n-        } else if constexpr (std::is_same<TimeType, std::chrono::seconds>::value) {\n-            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, end_time.count() * 0.000001);\n-        } else {\n-            static_assert(ALWAYS_FALSE<TimeType>, \"Error: unexpected time type\");\n+        if (dur > 1s) {\n+            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, CountSecondsDouble(dur));\n+        }\n+        if (dur > 1ms) {\n+            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, CountMillisecondsDouble(dur));\n         }\n+        return strprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853961057",
      "id" : 853961057,
      "in_reply_to_id" : 853400004,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584y5mlh",
      "original_commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "original_line" : 72,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : null,
      "pull_request_review_id" : 946912619,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853961057/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-20T10:06:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853961057",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yeah, I am happy to drop the second commit (or postpone it). Another thought would be to print the same value twice. The second time as `%.9fs` (nanoseconds statically formatted as double-seconds)",
      "created_at" : "2022-04-20T10:08:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1103752100",
      "id" : 1103752100,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585Byeuk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103752100/reactions"
      },
      "updated_at" : "2022-04-20T10:08:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103752100",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853995678"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853995678"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I mean, you could invert both the logic and the order?\r\n\r\n```c++\r\nif (dur <= 1ms) { /* microseconds */ }\r\nelse if (dur <= 1s) { /* milliseconds */ }\r\nelse { /* seconds */ }\r\n```\r\n\r\nDoing one integer comparison instead of two prior to a printf seems like an amazing level of microoptimisation though...",
      "commit_id" : "fa846da728d2160f42effe67637e8ae3fcda308b",
      "created_at" : "2022-04-20T10:49:19Z",
      "diff_hunk" : "@@ -60,24 +59,21 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto dur{std::chrono::steady_clock::now() - m_start_t};\n+        if (m_start_t == decltype(m_start_t){}) {\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n-\n-        if constexpr (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            return strprintf(\"%s: %s (%iÎ¼s)\", m_prefix, msg, end_time.count());\n-        } else if constexpr (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n-            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, end_time.count() * 0.001);\n-        } else if constexpr (std::is_same<TimeType, std::chrono::seconds>::value) {\n-            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, end_time.count() * 0.000001);\n-        } else {\n-            static_assert(ALWAYS_FALSE<TimeType>, \"Error: unexpected time type\");\n+        if (dur > 1s) {\n+            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, CountSecondsDouble(dur));\n+        }\n+        if (dur > 1ms) {\n+            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, CountMillisecondsDouble(dur));\n         }\n+        return strprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853995678",
      "id" : 853995678,
      "in_reply_to_id" : 853400004,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584y5vCe",
      "original_commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "original_line" : 72,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : null,
      "pull_request_review_id" : 946961489,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853995678/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-20T10:49:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853995678",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853998942"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853998942"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It's new code anyway and low-hanging, so mentioned it.",
      "commit_id" : "fa846da728d2160f42effe67637e8ae3fcda308b",
      "created_at" : "2022-04-20T10:53:30Z",
      "diff_hunk" : "@@ -60,24 +59,21 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto dur{std::chrono::steady_clock::now() - m_start_t};\n+        if (m_start_t == decltype(m_start_t){}) {\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n-\n-        if constexpr (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            return strprintf(\"%s: %s (%iÎ¼s)\", m_prefix, msg, end_time.count());\n-        } else if constexpr (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n-            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, end_time.count() * 0.001);\n-        } else if constexpr (std::is_same<TimeType, std::chrono::seconds>::value) {\n-            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, end_time.count() * 0.000001);\n-        } else {\n-            static_assert(ALWAYS_FALSE<TimeType>, \"Error: unexpected time type\");\n+        if (dur > 1s) {\n+            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, CountSecondsDouble(dur));\n+        }\n+        if (dur > 1ms) {\n+            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, CountMillisecondsDouble(dur));\n         }\n+        return strprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r853998942",
      "id" : 853998942,
      "in_reply_to_id" : 853400004,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584y5v1e",
      "original_commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "original_line" : 72,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : null,
      "pull_request_review_id" : 946966067,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853998942/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-20T10:53:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/853998942",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r854000632"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854000632"
         }
      },
      "author_association" : "MEMBER",
      "body" : "And the existing code checks from small to large.",
      "commit_id" : "fa846da728d2160f42effe67637e8ae3fcda308b",
      "created_at" : "2022-04-20T10:55:34Z",
      "diff_hunk" : "@@ -60,24 +59,21 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto dur{std::chrono::steady_clock::now() - m_start_t};\n+        if (m_start_t == decltype(m_start_t){}) {\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n-\n-        if constexpr (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            return strprintf(\"%s: %s (%iÎ¼s)\", m_prefix, msg, end_time.count());\n-        } else if constexpr (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n-            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, end_time.count() * 0.001);\n-        } else if constexpr (std::is_same<TimeType, std::chrono::seconds>::value) {\n-            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, end_time.count() * 0.000001);\n-        } else {\n-            static_assert(ALWAYS_FALSE<TimeType>, \"Error: unexpected time type\");\n+        if (dur > 1s) {\n+            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, CountSecondsDouble(dur));\n+        }\n+        if (dur > 1ms) {\n+            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, CountMillisecondsDouble(dur));\n         }\n+        return strprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r854000632",
      "id" : 854000632,
      "in_reply_to_id" : 853400004,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584y5wP4",
      "original_commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "original_line" : 72,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : null,
      "pull_request_review_id" : 946968411,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854000632/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-20T10:55:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854000632",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Another thought would be to print the same value twice. The second time as `%.9fs` (nanoseconds statically formatted as double-seconds)\r\n\r\nHappy to test if you do that.\r\n",
      "created_at" : "2022-04-20T10:56:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1103798428",
      "id" : 1103798428,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585ByqCc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103798428/reactions"
      },
      "updated_at" : "2022-04-20T10:56:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103798428",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r854003955"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854003955"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "How about changing\r\n```c++\r\nstrprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur))\r\n```\r\n\r\nto\r\n\r\n```c++\r\nstrprintf(\"%s: %s (%.5fms)\", m_prefix, msg, CountMillisecondsDouble(dur))\r\n``` \r\n\r\n? Then you'd see \"10.23s\", \"10.23ms\" and \"0.01023ms\" which might be easier to follow?",
      "commit_id" : "fa846da728d2160f42effe67637e8ae3fcda308b",
      "created_at" : "2022-04-20T10:59:48Z",
      "diff_hunk" : "@@ -60,24 +59,21 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto dur{std::chrono::steady_clock::now() - m_start_t};\n+        if (m_start_t == decltype(m_start_t){}) {\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n-\n-        if constexpr (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            return strprintf(\"%s: %s (%iÎ¼s)\", m_prefix, msg, end_time.count());\n-        } else if constexpr (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n-            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, end_time.count() * 0.001);\n-        } else if constexpr (std::is_same<TimeType, std::chrono::seconds>::value) {\n-            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, end_time.count() * 0.000001);\n-        } else {\n-            static_assert(ALWAYS_FALSE<TimeType>, \"Error: unexpected time type\");\n+        if (dur > 1s) {\n+            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, CountSecondsDouble(dur));\n+        }\n+        if (dur > 1ms) {\n+            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, CountMillisecondsDouble(dur));\n         }\n+        return strprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r854003955",
      "id" : 854003955,
      "in_reply_to_id" : 853400004,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584y5xDz",
      "original_commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "original_line" : 72,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : null,
      "pull_request_review_id" : 946973269,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854003955/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-20T10:59:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854003955",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK. Would be nice if there's some way to make it easier to notice the difference between millis and micros when scanning logs.",
      "created_at" : "2022-04-20T11:01:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1103802095",
      "id" : 1103802095,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585Byq7v",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103802095/reactions"
      },
      "updated_at" : "2022-04-20T11:01:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103802095",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r854007846"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854007846"
         }
      },
      "author_association" : "MEMBER",
      "body" : "There aren't any in the sample above, but it's the big ones in seconds (s) that I find harder to pick out when eyeballing the mix (maybe because they are now smaller).  The Î¼s ones stand out pretty well to my eye. Sample with seconds:\r\n```\r\n2022-04-19T17:58:03Z [net] Enter: lock contention m_nodes_mutex, net.cpp:1294 started\r\n2022-04-19T17:58:03Z [net] Enter: lock contention m_nodes_mutex, net.cpp:1294 completed (4.16Î¼s)\r\n2022-04-19T17:58:03Z [opencon] Enter: lock contention m_nodes_mutex, net.cpp:366 started\r\n2022-04-19T17:58:03Z [opencon] Enter: lock contention m_nodes_mutex, net.cpp:366 completed (4.43Î¼s)\r\n2022-04-19T17:58:03Z [net] Enter: lock contention m_nodes_mutex, net.cpp:1294 started\r\n2022-04-19T17:58:03Z [net] Enter: lock contention m_nodes_mutex, net.cpp:1294 completed (4.28Î¼s)\r\n2022-04-19T17:58:03Z [opencon] Enter: lock contention cs_main, net_processing.cpp:1229 started\r\n2022-04-19T17:58:05Z [msghand] Enter: lock contention ::cs_main, validation.cpp:5151 started\r\n2022-04-19T17:58:05Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 completed (12.17s)\r\n2022-04-19T17:58:05Z [opencon] Enter: lock contention cs_main, net_processing.cpp:1229 completed (2.23s)\r\n2022-04-19T17:58:05Z [msghand] Enter: lock contention ::cs_main, validation.cpp:5151 completed (4.40ms)\r\n2022-04-19T17:58:05Z [scheduler] Enter: lock contention ::cs_main, validation.cpp:5151 completed (11.81s)\r\n2022-04-19T17:58:05Z [msghand] Enter: lock contention cs_main, validation.cpp:2906 started\r\n2022-04-19T17:58:05Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 started\r\n2022-04-19T17:58:05Z [msghand] Enter: lock contention cs_main, validation.cpp:2906 completed (558.78Î¼s)\r\n2022-04-19T17:58:05Z [loadblk] Enter: lock contention cs_main, validation.cpp:4672 completed (735.17Î¼s)\r\n```",
      "commit_id" : "fa846da728d2160f42effe67637e8ae3fcda308b",
      "created_at" : "2022-04-20T11:04:53Z",
      "diff_hunk" : "@@ -60,24 +59,21 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto dur{std::chrono::steady_clock::now() - m_start_t};\n+        if (m_start_t == decltype(m_start_t){}) {\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n-\n-        if constexpr (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            return strprintf(\"%s: %s (%iÎ¼s)\", m_prefix, msg, end_time.count());\n-        } else if constexpr (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n-            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, end_time.count() * 0.001);\n-        } else if constexpr (std::is_same<TimeType, std::chrono::seconds>::value) {\n-            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, end_time.count() * 0.000001);\n-        } else {\n-            static_assert(ALWAYS_FALSE<TimeType>, \"Error: unexpected time type\");\n+        if (dur > 1s) {\n+            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, CountSecondsDouble(dur));\n+        }\n+        if (dur > 1ms) {\n+            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, CountMillisecondsDouble(dur));\n         }\n+        return strprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r854007846",
      "id" : 854007846,
      "in_reply_to_id" : 853400004,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584y5yAm",
      "original_commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "original_line" : 72,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : null,
      "pull_request_review_id" : 946978803,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854007846/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-20T11:07:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854007846",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r854021738"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854021738"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Sorry, tangential, but: wouldn't it be better to log \"foo.cpp:123 held the cs_main lock for 20 seconds\" instead of \"bar.cpp:456 was waiting for the cs_main lock for 20 seconds\" ? In theory, you could then only report when some bit of code held a lock for an \"unusually\" long amount of time, and could do so even if no other thread happened to also want it... I just don't really see the point of a log entry for \"m_nodes_mutex net.cpp:1294 (4.28Î¼s)\" -- that doesn't really seem like actionable information.",
      "commit_id" : "fa846da728d2160f42effe67637e8ae3fcda308b",
      "created_at" : "2022-04-20T11:23:32Z",
      "diff_hunk" : "@@ -60,24 +59,21 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto dur{std::chrono::steady_clock::now() - m_start_t};\n+        if (m_start_t == decltype(m_start_t){}) {\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n-\n-        if constexpr (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            return strprintf(\"%s: %s (%iÎ¼s)\", m_prefix, msg, end_time.count());\n-        } else if constexpr (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n-            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, end_time.count() * 0.001);\n-        } else if constexpr (std::is_same<TimeType, std::chrono::seconds>::value) {\n-            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, end_time.count() * 0.000001);\n-        } else {\n-            static_assert(ALWAYS_FALSE<TimeType>, \"Error: unexpected time type\");\n+        if (dur > 1s) {\n+            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, CountSecondsDouble(dur));\n+        }\n+        if (dur > 1ms) {\n+            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, CountMillisecondsDouble(dur));\n         }\n+        return strprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r854021738",
      "id" : 854021738,
      "in_reply_to_id" : 853400004,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584y51Zq",
      "original_commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "original_line" : 72,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : null,
      "pull_request_review_id" : 946998793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854021738/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-20T11:23:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/854021738",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks, I've reworked to make it easier for humans and scripts to parse the format.\r\n\r\nFor example, `0.000011s` means 11us, `0.010s` means 10ms. I think a maximum error of 10% is fine, as we mostly only care about the exponent of the float in base 10.",
      "created_at" : "2022-04-20T12:02:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1103851629",
      "id" : 1103851629,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585By3Bt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103851629/reactions"
      },
      "updated_at" : "2022-04-20T12:02:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1103851629",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "First commit fa1d0f161f33634658 build error: `./logging/timer.h:69:63: error: use of undeclared identifier 'end_time'`\r\n\r\nSample of last push ddddf680b06e9 with lock logging:\r\n```\r\n2022-04-21T14:01:49Z [msghand] Enter: lock contention connman.m_nodes_mutex, ./net.h:1223 started\r\n2022-04-21T14:01:49Z [msghand] Enter: lock contention connman.m_nodes_mutex, ./net.h:1223 completed (0.000004479s)\r\n2022-04-21T14:01:50Z [opencon] Enter: lock contention cs_main, net_processing.cpp:1229 started\r\n2022-04-21T14:01:50Z [scheduler] Enter: lock contention ::cs_main, validation.cpp:5150 started\r\n2022-04-21T14:01:50Z [msghand] Enter: lock contention ::cs_main, validation.cpp:5150 started\r\n2022-04-21T14:01:50Z [opencon] Enter: lock contention cs_main, net_processing.cpp:1229 completed (0.449s)\r\n2022-04-21T14:01:50Z [scheduler] Enter: lock contention ::cs_main, validation.cpp:5150 completed (0.238s)\r\n2022-04-21T14:01:50Z [msghand] Enter: lock contention ::cs_main, validation.cpp:5150 completed (0.000407s)\r\n2022-04-21T14:01:51Z [msghand] Enter: lock contention connman.m_nodes_mutex, ./net.h:1223 started\r\n2022-04-21T14:01:51Z [msghand] Enter: lock contention connman.m_nodes_mutex, ./net.h:1223 completed (0.000004422s)\r\n```",
      "created_at" : "2022-04-21T14:16:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1105275355",
      "id" : 1105275355,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585B4Snb",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1105275355/reactions"
      },
      "updated_at" : "2022-04-21T14:16:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1105275355",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Good catch. I'll fix the dirty build and probably remove the nanosecond precision again. Previously the best precision we had was microseconds, so it is probably best to keep it.\r\n\r\nThe debug log would then look a bit like:\r\n\r\n```\r\n2022-04-21T14:01:49Z [msghand] Enter: lock contention connman.m_nodes_mutex, ./net.h:1223 started\r\n2022-04-21T14:01:49Z [msghand] Enter: lock contention connman.m_nodes_mutex, ./net.h:1223 completed (0.000004s)\r\n2022-04-21T14:01:50Z [opencon] Enter: lock contention cs_main, net_processing.cpp:1229 started\r\n2022-04-21T14:01:50Z [scheduler] Enter: lock contention ::cs_main, validation.cpp:5150 started\r\n2022-04-21T14:01:50Z [msghand] Enter: lock contention ::cs_main, validation.cpp:5150 started\r\n2022-04-21T14:01:50Z [opencon] Enter: lock contention cs_main, net_processing.cpp:1229 completed (0.449s)\r\n2022-04-21T14:01:50Z [scheduler] Enter: lock contention ::cs_main, validation.cpp:5150 completed (0.238s)\r\n2022-04-21T14:01:50Z [msghand] Enter: lock contention ::cs_main, validation.cpp:5150 completed (0.000407s)\r\n2022-04-21T14:01:51Z [msghand] Enter: lock contention connman.m_nodes_mutex, ./net.h:1223 started\r\n2022-04-21T14:01:51Z [msghand] Enter: lock contention connman.m_nodes_mutex, ./net.h:1223 completed (0.000004s)",
      "created_at" : "2022-04-21T15:33:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1105388054",
      "id" : 1105388054,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585B4uIW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1105388054/reactions"
      },
      "updated_at" : "2022-04-21T15:33:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1105388054",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r856255977"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856255977"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it's valuable information to show who waited, because just holding a lock when nobody else needs it isn't an issue. But what I'd really like to see is who actually blocked someone else.\r\n\r\nI'd personally prefer exact timestamps from e.g. `std::chrono::steady_clock` in the best precision possible in the logs, then one could extract a lot of useful information from it. E.g. who actually blocked whom and for how long. It would then also be possible to generate input for e.g. [chrome tracing](https://slack.engineering/chrome-tracing-for-fun-and-profit/) which is a simple JSON format.",
      "commit_id" : "fa146aafabba7597da28f3c9f86b9d71220063e6",
      "created_at" : "2022-04-22T13:54:28Z",
      "diff_hunk" : "@@ -60,24 +59,21 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto dur{std::chrono::steady_clock::now() - m_start_t};\n+        if (m_start_t == decltype(m_start_t){}) {\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n-\n-        if constexpr (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            return strprintf(\"%s: %s (%iÎ¼s)\", m_prefix, msg, end_time.count());\n-        } else if constexpr (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n-            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, end_time.count() * 0.001);\n-        } else if constexpr (std::is_same<TimeType, std::chrono::seconds>::value) {\n-            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, end_time.count() * 0.000001);\n-        } else {\n-            static_assert(ALWAYS_FALSE<TimeType>, \"Error: unexpected time type\");\n+        if (dur > 1s) {\n+            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, CountSecondsDouble(dur));\n+        }\n+        if (dur > 1ms) {\n+            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, CountMillisecondsDouble(dur));\n         }\n+        return strprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r856255977",
      "id" : 856255977,
      "in_reply_to_id" : 853400004,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584zCW3p",
      "original_commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "original_line" : 72,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : null,
      "pull_request_review_id" : 950129114,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856255977/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-22T13:54:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/856255977",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r857544892"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857544892"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I disagree. If something took a short time, why would anyone care if it took 900 nanoseconds or 1700 nanoseconds? After all this isn't a microbenchmark and real world fluctuations are larger than nanosecond precision. Also, nanosecond precision didn't exist before, so introducing it can be done in a separate pull or a follow-up.\r\n\r\nChanging the content of the lock contention logging or chrome tracing also appear largely unrelated to a change to the formatting of durations in logs.",
      "commit_id" : "fa146aafabba7597da28f3c9f86b9d71220063e6",
      "created_at" : "2022-04-25T11:54:32Z",
      "diff_hunk" : "@@ -60,24 +59,21 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto dur{std::chrono::steady_clock::now() - m_start_t};\n+        if (m_start_t == decltype(m_start_t){}) {\n             return strprintf(\"%s: %s\", m_prefix, msg);\n         }\n-\n-        if constexpr (std::is_same<TimeType, std::chrono::microseconds>::value) {\n-            return strprintf(\"%s: %s (%iÎ¼s)\", m_prefix, msg, end_time.count());\n-        } else if constexpr (std::is_same<TimeType, std::chrono::milliseconds>::value) {\n-            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, end_time.count() * 0.001);\n-        } else if constexpr (std::is_same<TimeType, std::chrono::seconds>::value) {\n-            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, end_time.count() * 0.000001);\n-        } else {\n-            static_assert(ALWAYS_FALSE<TimeType>, \"Error: unexpected time type\");\n+        if (dur > 1s) {\n+            return strprintf(\"%s: %s (%.2fs)\", m_prefix, msg, CountSecondsDouble(dur));\n+        }\n+        if (dur > 1ms) {\n+            return strprintf(\"%s: %s (%.2fms)\", m_prefix, msg, CountMillisecondsDouble(dur));\n         }\n+        return strprintf(\"%s: %s (%.2fÎ¼s)\", m_prefix, msg, CountMicrosecondsDouble(dur));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r857544892",
      "id" : 857544892,
      "in_reply_to_id" : 853400004,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584zHRi8",
      "original_commit_id" : "fa1d6989a780a7c19ed772478643a2df447aacce",
      "original_line" : 72,
      "original_position" : 54,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : null,
      "pull_request_review_id" : 951742876,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857544892/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-25T11:54:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/857544892",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Good catch. I'll fix the dirty build and probably remove the nanosecond precision again\r\n\r\nYes, I agree nanosecond precision is overkill here. For controlled benchmark situations it can come in handy but not for logging in a application running on (usually) a busy system.",
      "created_at" : "2022-06-29T10:39:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1169822082",
      "id" : 1169822082,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585FuhGC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169822082/reactions"
      },
      "updated_at" : "2022-06-29T10:39:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169822082",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "to clarify, my suggestion is already implemented",
      "created_at" : "2022-06-29T13:15:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1169966916",
      "id" : 1169966916,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585FvEdE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169966916/reactions"
      },
      "updated_at" : "2022-06-29T13:15:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1169966916",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2022-09-16T10:57:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#issuecomment-1249224581",
      "id" : 1249224581,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24923",
      "node_id" : "IC_kwDOABII585KdaeF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249224581/reactions"
      },
      "updated_at" : "2022-09-16T10:57:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1249224581",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r973237500"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/973237500"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think that if statement will never evaluate to true, right? `m_start_t` is always initialized with `m_start_t = std::chrono::steady_clock::now();` so it shouldn't ever be zero.",
      "commit_id" : "ffff28a25ad9fc279bd5743474ed97f33d220ade",
      "created_at" : "2022-09-16T17:23:13Z",
      "diff_hunk" : "@@ -60,8 +60,8 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto end_time{std::chrono::duration_cast<std::chrono::microseconds>(std::chrono::steady_clock::now() - m_start_t)};\n+        if (m_start_t == decltype(m_start_t){}) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r973237500",
      "id" : 973237500,
      "line" : 63,
      "node_id" : "PRRC_kwDOABII5846Amz8",
      "original_commit_id" : "facb78e187b80852bdb9e46860bd3542e10bec53",
      "original_line" : 64,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : 28,
      "pull_request_review_id" : 1110998734,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/973237500/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-09-16T17:24:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/973237500",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "node_id" : "MDQ6VXNlcjE0Mzg2",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r1060494052"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1060494052"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Huh? `m_start_t` is set *after* the first call to `LogMsg`, so I think this can evaluate to true.",
      "commit_id" : "fa35fe8396688286dedf177467cc76870e3f888c",
      "created_at" : "2023-01-03T11:23:23Z",
      "diff_hunk" : "@@ -60,8 +60,8 @@ class Timer\n \n     std::string LogMsg(const std::string& msg)\n     {\n-        const auto end_time = GetTime<std::chrono::microseconds>() - m_start_t;\n-        if (m_start_t.count() <= 0) {\n+        const auto end_time{std::chrono::duration_cast<std::chrono::microseconds>(std::chrono::steady_clock::now() - m_start_t)};\n+        if (m_start_t == decltype(m_start_t){}) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24923#discussion_r1060494052",
      "id" : 1060494052,
      "in_reply_to_id" : 973237500,
      "line" : 63,
      "node_id" : "PRRC_kwDOABII584_Ndrk",
      "original_commit_id" : "facb78e187b80852bdb9e46860bd3542e10bec53",
      "original_line" : 63,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/logging/timer.h",
      "position" : 36,
      "pull_request_review_id" : 1234411988,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24923",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1060494052/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-01-03T11:23:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1060494052",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
