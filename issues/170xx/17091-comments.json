[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, thanks.",
      "created_at" : "2019-10-10T09:16:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17091#issuecomment-540478923",
      "id" : 540478923,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17091",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0MDQ3ODkyMw==",
      "updated_at" : "2019-10-10T09:16:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/540478923",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17091#discussion_r333413682"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17091"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/333413682"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Do you really need the `shell=True` here? The immediate problem is that the arguments aren't escaped, so this won't work with paths with spaces, or other characters in it. You could escape the args with `shlex.quote`, but in general, it's better to avoid the shell completely and use Python's stdin/stdout/stderr redirection.",
      "commit_id" : "b94959e1a1021ee13b6b6537b771e01e6908c058",
      "created_at" : "2019-10-10T09:18:15Z",
      "diff_hunk" : "@@ -0,0 +1,78 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-2019 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test loadblock option\n+\n+Test the option to start a node with the option loadblock which loads\n+a serialized blockchain from a file (usually called bootstrap.dat).\n+To generate that file this test uses the helper scripts available\n+in contrib/linearize.\n+\"\"\"\n+\n+import os\n+import subprocess\n+import urllib\n+\n+from test_framework.test_framework import (\n+    BitcoinTestFramework,\n+)\n+from test_framework.util import assert_equal, wait_until\n+\n+\n+class LoadblockTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+\n+    def run_test(self):\n+        self.nodes[1].setnetworkactive(state=False)\n+        self.nodes[0].generate(100)\n+\n+        # Parsing the url of our node to get settings for config file\n+        data_dir = self.nodes[0].datadir\n+        node_url = urllib.parse.urlparse(self.nodes[0].url)\n+        cfg_path = os.path.join(data_dir, \"linearize.cfg\")\n+        hashlist_path = os.path.join(data_dir, \"hashlist.txt\")\n+        bootstrap_file = os.path.join(self.options.tmpdir, \"bootstrap.dat\")\n+        genesis_block = self.nodes[0].getblockhash(0)\n+        block_dir = os.path.join(data_dir, \"regtest\", \"blocks\")\n+\n+        self.log.info(\"Create linearization config file\")\n+        with open(cfg_path, \"a\", encoding=\"utf-8\") as cfg:\n+            cfg.write(\"datadir={}\\n\".format(data_dir))\n+            cfg.write(\"rpcuser={}\\n\".format(node_url.username))\n+            cfg.write(\"rpcpassword={}\\n\".format(node_url.password))\n+            cfg.write(\"port={}\\n\".format(node_url.port))\n+            cfg.write(\"host={}\\n\".format(node_url.hostname))\n+            cfg.write(\"output_file={}\\n\".format(bootstrap_file))\n+            cfg.write(\"max_height=100\\n\")\n+            cfg.write(\"netmagic=fabfb5da\\n\")\n+            cfg.write(\"input={}\\n\".format(block_dir))\n+            cfg.write(\"genesis={}\\n\".format(genesis_block))\n+            cfg.write(\"hashlist={}\\n\".format(hashlist_path))\n+\n+        base_dir = self.config[\"environment\"][\"SRCDIR\"]\n+        linearize_dir = os.path.join(base_dir, \"contrib\", \"linearize\")\n+\n+        self.log.info(\"Run linearization of block hashes\")\n+        linearize_hashes_path = os.path.join(linearize_dir, \"linearize-hashes.py\")\n+        hashes_args = [linearize_hashes_path, cfg_path, \">\", hashlist_path]\n+        subprocess.run(\" \".join(hashes_args), shell=True).check_returncode()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17091#discussion_r333413682",
      "id" : 333413682,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzMzQxMzY4Mg==",
      "original_commit_id" : "b94959e1a1021ee13b6b6537b771e01e6908c058",
      "original_position" : 61,
      "path" : "test/functional/feature_loadblock.py",
      "position" : 61,
      "pull_request_review_id" : 299926684,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17091",
      "updated_at" : "2019-10-10T09:18:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/333413682",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
