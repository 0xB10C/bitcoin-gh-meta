[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7966#discussion_r61467339"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7966"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61467339"
         }
      },
      "body" : "Also, in C++11, you no longer need to avoid the '>>' in `Template1<Template2<Template3>>`.",
      "commit_id" : "3fc99f4d9b3d23112b46e38f2586a80e766bcc30",
      "created_at" : "2016-04-28T17:22:08Z",
      "diff_hunk" : "@@ -71,8 +71,7 @@ class WorkQueue\n     /** Mutex protects entire object */\n     CWaitableCriticalSection cs;\n     CConditionVariable cond;\n-    /* XXX in C++11 we can use std::unique_ptr here and avoid manual cleanup */\n-    std::deque<WorkItem*> queue;\n+    std::deque<std::unique_ptr<WorkItem> > queue;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7966#discussion_r61467339",
      "id" : 61467339,
      "original_commit_id" : "c0c7d8b7d747e8adc8b1bfaa2a8d1b4d6d4e52c8",
      "original_position" : 6,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7966",
      "updated_at" : "2016-04-28T19:42:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61467339",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7966#discussion_r61468317"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7966"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61468317"
         }
      },
      "body" : "I was just about to ask why the space is there...",
      "commit_id" : "3fc99f4d9b3d23112b46e38f2586a80e766bcc30",
      "created_at" : "2016-04-28T17:28:11Z",
      "diff_hunk" : "@@ -71,8 +71,7 @@ class WorkQueue\n     /** Mutex protects entire object */\n     CWaitableCriticalSection cs;\n     CConditionVariable cond;\n-    /* XXX in C++11 we can use std::unique_ptr here and avoid manual cleanup */\n-    std::deque<WorkItem*> queue;\n+    std::deque<std::unique_ptr<WorkItem> > queue;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7966#discussion_r61468317",
      "id" : 61468317,
      "original_commit_id" : "c0c7d8b7d747e8adc8b1bfaa2a8d1b4d6d4e52c8",
      "original_position" : 6,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7966",
      "updated_at" : "2016-04-28T19:42:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61468317",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7966#discussion_r61486514"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7966"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61486514"
         }
      },
      "body" : "@paveljanik because `>>` is an operator. But yes with c++11 this is apparently parsed differently so will remove the space.",
      "commit_id" : "3fc99f4d9b3d23112b46e38f2586a80e766bcc30",
      "created_at" : "2016-04-28T19:15:46Z",
      "diff_hunk" : "@@ -71,8 +71,7 @@ class WorkQueue\n     /** Mutex protects entire object */\n     CWaitableCriticalSection cs;\n     CConditionVariable cond;\n-    /* XXX in C++11 we can use std::unique_ptr here and avoid manual cleanup */\n-    std::deque<WorkItem*> queue;\n+    std::deque<std::unique_ptr<WorkItem> > queue;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7966#discussion_r61486514",
      "id" : 61486514,
      "original_commit_id" : "c0c7d8b7d747e8adc8b1bfaa2a8d1b4d6d4e52c8",
      "original_position" : 6,
      "path" : "src/httpserver.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7966",
      "updated_at" : "2016-04-28T19:42:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61486514",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7966#discussion_r61494617"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7966"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61494617"
         }
      },
      "body" : "Do we need an empty destructor?",
      "commit_id" : "3fc99f4d9b3d23112b46e38f2586a80e766bcc30",
      "created_at" : "2016-04-28T20:12:13Z",
      "diff_hunk" : "@@ -106,19 +105,15 @@ class WorkQueue\n      */\n     ~WorkQueue()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7966#discussion_r61494617",
      "id" : 61494617,
      "original_commit_id" : "3fc99f4d9b3d23112b46e38f2586a80e766bcc30",
      "original_position" : 12,
      "path" : "src/httpserver.cpp",
      "position" : 12,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7966",
      "updated_at" : "2016-04-28T20:12:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61494617",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7966#discussion_r61504551"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7966"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61504551"
         }
      },
      "body" : "`item` has been given to the queue here",
      "commit_id" : "3fc99f4d9b3d23112b46e38f2586a80e766bcc30",
      "created_at" : "2016-04-28T21:20:50Z",
      "diff_hunk" : "@@ -288,11 +282,9 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n \n     // Dispatch to worker thread\n     if (i != iend) {\n-        std::auto_ptr<HTTPWorkItem> item(new HTTPWorkItem(hreq.release(), path, i->handler));\n+        std::unique_ptr<HTTPWorkItem> item(new HTTPWorkItem(hreq.release(), path, i->handler));\n         assert(workQueue);\n-        if (workQueue->Enqueue(item.get()))\n-            item.release(); /* if true, queue took ownership */\n-        else\n+        if (!workQueue->Enqueue(std::move(item)))\n             item->req->WriteReply(HTTP_INTERNAL, \"Work queue depth exceeded\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7966#discussion_r61504551",
      "id" : 61504551,
      "original_commit_id" : "3fc99f4d9b3d23112b46e38f2586a80e766bcc30",
      "original_position" : 73,
      "path" : "src/httpserver.cpp",
      "position" : 73,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7966",
      "updated_at" : "2016-04-28T21:20:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61504551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7966#discussion_r61504588"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7966"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61504588"
         }
      },
      "body" : "use after move here",
      "commit_id" : "3fc99f4d9b3d23112b46e38f2586a80e766bcc30",
      "created_at" : "2016-04-28T21:21:09Z",
      "diff_hunk" : "@@ -288,11 +282,9 @@ static void http_request_cb(struct evhttp_request* req, void* arg)\n \n     // Dispatch to worker thread\n     if (i != iend) {\n-        std::auto_ptr<HTTPWorkItem> item(new HTTPWorkItem(hreq.release(), path, i->handler));\n+        std::unique_ptr<HTTPWorkItem> item(new HTTPWorkItem(hreq.release(), path, i->handler));\n         assert(workQueue);\n-        if (workQueue->Enqueue(item.get()))\n-            item.release(); /* if true, queue took ownership */\n-        else\n+        if (!workQueue->Enqueue(std::move(item)))\n             item->req->WriteReply(HTTP_INTERNAL, \"Work queue depth exceeded\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7966#discussion_r61504588",
      "id" : 61504588,
      "original_commit_id" : "3fc99f4d9b3d23112b46e38f2586a80e766bcc30",
      "original_position" : 73,
      "path" : "src/httpserver.cpp",
      "position" : 73,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7966",
      "updated_at" : "2016-04-28T21:21:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61504588",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   }
]
