[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61204507"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61204507"
         }
      },
      "body" : "You do not need `HelpRequiringPassphrase` here. It is unavailable in no-wallet builds (see https://travis-ci.org/bitcoin/bitcoin/jobs/126001935#L1864).",
      "commit_id" : "f90efbfeef9cd733aa7590fdf581ff82b999c4b5",
      "created_at" : "2016-04-27T05:07:53Z",
      "diff_hunk" : "@@ -366,6 +366,49 @@ UniValue verifymessage(const UniValue& params, bool fHelp)\n     return (pubkey.GetID() == keyID);\n }\n \n+UniValue signmessagewithprivkey(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 2)\n+        throw runtime_error(\n+            \"signmessage \\\"privkey\\\" \\\"message\\\"\\n\"\n+            \"\\nSign a message with the private key of an address\"\n+            + HelpRequiringPassphrase() + \"\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61204507",
      "id" : 61204507,
      "original_commit_id" : "12c5fb94c3b951d33b365dccdc18698bc8246dd0",
      "original_position" : 10,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953",
      "updated_at" : "2016-04-27T10:43:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61204507",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61204932"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61204932"
         }
      },
      "body" : "This has to be `signmessagewithprivkey` instead of `signmessage`.",
      "commit_id" : "f90efbfeef9cd733aa7590fdf581ff82b999c4b5",
      "created_at" : "2016-04-27T05:17:26Z",
      "diff_hunk" : "@@ -366,6 +366,49 @@ UniValue verifymessage(const UniValue& params, bool fHelp)\n     return (pubkey.GetID() == keyID);\n }\n \n+UniValue signmessagewithprivkey(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 2)\n+        throw runtime_error(\n+            \"signmessage \\\"privkey\\\" \\\"message\\\"\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61204932",
      "id" : 61204932,
      "original_commit_id" : "12c5fb94c3b951d33b365dccdc18698bc8246dd0",
      "original_position" : 8,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953",
      "updated_at" : "2016-04-27T10:43:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61204932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61242868"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61242868"
         }
      },
      "body" : "Fixed",
      "commit_id" : "f90efbfeef9cd733aa7590fdf581ff82b999c4b5",
      "created_at" : "2016-04-27T11:37:10Z",
      "diff_hunk" : "@@ -366,6 +366,49 @@ UniValue verifymessage(const UniValue& params, bool fHelp)\n     return (pubkey.GetID() == keyID);\n }\n \n+UniValue signmessagewithprivkey(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 2)\n+        throw runtime_error(\n+            \"signmessage \\\"privkey\\\" \\\"message\\\"\\n\"\n+            \"\\nSign a message with the private key of an address\"\n+            + HelpRequiringPassphrase() + \"\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61242868",
      "id" : 61242868,
      "original_commit_id" : "12c5fb94c3b951d33b365dccdc18698bc8246dd0",
      "original_position" : 10,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953",
      "updated_at" : "2016-04-27T11:37:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61242868",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=3",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61242885"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61242885"
         }
      },
      "body" : "Fixed",
      "commit_id" : "f90efbfeef9cd733aa7590fdf581ff82b999c4b5",
      "created_at" : "2016-04-27T11:37:20Z",
      "diff_hunk" : "@@ -366,6 +366,49 @@ UniValue verifymessage(const UniValue& params, bool fHelp)\n     return (pubkey.GetID() == keyID);\n }\n \n+UniValue signmessagewithprivkey(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 2)\n+        throw runtime_error(\n+            \"signmessage \\\"privkey\\\" \\\"message\\\"\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61242885",
      "id" : 61242885,
      "original_commit_id" : "12c5fb94c3b951d33b365dccdc18698bc8246dd0",
      "original_position" : 8,
      "path" : "src/rpc/misc.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953",
      "updated_at" : "2016-04-27T11:37:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61242885",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=3",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "body" : "utACK https://github.com/bitcoin/bitcoin/pull/7953/commits/f90efbfeef9cd733aa7590fdf581ff82b999c4b5",
      "created_at" : "2016-04-27T12:00:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7953#issuecomment-215060877",
      "id" : 215060877,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7953",
      "updated_at" : "2016-04-27T12:00:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/215060877",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61245613"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61245613"
         }
      },
      "body" : "IMO `strPrivkey`, `vchSecret` and `params[0]` should be mem-cleansed before the function returns.\r\nI guess `key` RAII -cleans itself.",
      "commit_id" : "f90efbfeef9cd733aa7590fdf581ff82b999c4b5",
      "created_at" : "2016-04-27T12:05:55Z",
      "diff_hunk" : "@@ -366,6 +366,48 @@ UniValue verifymessage(const UniValue& params, bool fHelp)\n     return (pubkey.GetID() == keyID);\n }\n \n+UniValue signmessagewithprivkey(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 2)\n+        throw runtime_error(\n+            \"signmessagewithprivkey \\\"privkey\\\" \\\"message\\\"\\n\"\n+            \"\\nSign a message with the private key of an address\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"privkey\\\"         (string, required) The private key to sign the message with.\\n\"\n+            \"2. \\\"message\\\"         (string, required) The message to create a signature of.\\n\"\n+            \"\\nResult:\\n\"\n+            \"\\\"signature\\\"          (string) The signature of the message encoded in base 64\\n\"\n+            \"\\nExamples:\\n\"\n+            \"\\nCreate the signature\\n\"\n+            + HelpExampleCli(\"signmessagewithprivkey\", \"\\\"privkey\\\" \\\"my message\\\"\") +\n+            \"\\nVerify the signature\\n\"\n+            + HelpExampleCli(\"verifymessage\", \"\\\"1D1ZrZNe3JUo7ZycKEYQQiQAWd9y54F4XZ\\\" \\\"signature\\\" \\\"my message\\\"\") +\n+            \"\\nAs json rpc\\n\"\n+            + HelpExampleRpc(\"signmessagewithprivkey\", \"\\\"privkey\\\", \\\"my message\\\"\")\n+        );\n+\n+    string strPrivkey = params[0].get_str();\n+    string strMessage = params[1].get_str();\n+\n+    CBitcoinSecret vchSecret;\n+    bool fGood = vchSecret.SetString(strPrivkey);\n+    if (!fGood)\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid private key\");\n+    CKey key = vchSecret.GetKey();\n+    if (!key.IsValid())\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Private key outside allowed range\");\n+\n+    CHashWriter ss(SER_GETHASH, 0);\n+    ss << strMessageMagic;\n+    ss << strMessage;\n+\n+    vector<unsigned char> vchSig;\n+    if (!key.SignCompact(ss.GetHash(), vchSig))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Sign failed\");\n+\n+    return EncodeBase64(&vchSig[0], vchSig.size());\n+}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61245613",
      "id" : 61245613,
      "original_commit_id" : "f90efbfeef9cd733aa7590fdf581ff82b999c4b5",
      "original_position" : 44,
      "path" : "src/rpc/misc.cpp",
      "position" : 44,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953",
      "updated_at" : "2016-04-27T12:05:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61245613",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "utACK f90efbfeef9cd733aa7590fdf581ff82b999c4b5",
      "created_at" : "2016-04-27T12:06:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7953#issuecomment-215062017",
      "id" : 215062017,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7953",
      "updated_at" : "2016-04-27T12:06:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/215062017",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61250998"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61250998"
         }
      },
      "body" : "- vchSecret is ok - CBitcoinSecret (derived from CBase58Data) uses a zero_after_free allocator\r\n- strPrivKey could be a SecureString, I guess.\r\n\r\nHowever, params[] is a const parameter vector passed in, provided by a third-party library. I don't think this issue can be solved in general (except by never passing private keys in the API in the first place). The http server, JSON parsing, the RPC mechanism leaves the parameters all over memory. We have a similar problem in importprivkey. No need to solve in this pull.",
      "commit_id" : "f90efbfeef9cd733aa7590fdf581ff82b999c4b5",
      "created_at" : "2016-04-27T12:50:55Z",
      "diff_hunk" : "@@ -366,6 +366,48 @@ UniValue verifymessage(const UniValue& params, bool fHelp)\n     return (pubkey.GetID() == keyID);\n }\n \n+UniValue signmessagewithprivkey(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 2)\n+        throw runtime_error(\n+            \"signmessagewithprivkey \\\"privkey\\\" \\\"message\\\"\\n\"\n+            \"\\nSign a message with the private key of an address\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"privkey\\\"         (string, required) The private key to sign the message with.\\n\"\n+            \"2. \\\"message\\\"         (string, required) The message to create a signature of.\\n\"\n+            \"\\nResult:\\n\"\n+            \"\\\"signature\\\"          (string) The signature of the message encoded in base 64\\n\"\n+            \"\\nExamples:\\n\"\n+            \"\\nCreate the signature\\n\"\n+            + HelpExampleCli(\"signmessagewithprivkey\", \"\\\"privkey\\\" \\\"my message\\\"\") +\n+            \"\\nVerify the signature\\n\"\n+            + HelpExampleCli(\"verifymessage\", \"\\\"1D1ZrZNe3JUo7ZycKEYQQiQAWd9y54F4XZ\\\" \\\"signature\\\" \\\"my message\\\"\") +\n+            \"\\nAs json rpc\\n\"\n+            + HelpExampleRpc(\"signmessagewithprivkey\", \"\\\"privkey\\\", \\\"my message\\\"\")\n+        );\n+\n+    string strPrivkey = params[0].get_str();\n+    string strMessage = params[1].get_str();\n+\n+    CBitcoinSecret vchSecret;\n+    bool fGood = vchSecret.SetString(strPrivkey);\n+    if (!fGood)\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid private key\");\n+    CKey key = vchSecret.GetKey();\n+    if (!key.IsValid())\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Private key outside allowed range\");\n+\n+    CHashWriter ss(SER_GETHASH, 0);\n+    ss << strMessageMagic;\n+    ss << strMessage;\n+\n+    vector<unsigned char> vchSig;\n+    if (!key.SignCompact(ss.GetHash(), vchSig))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Sign failed\");\n+\n+    return EncodeBase64(&vchSig[0], vchSig.size());\n+}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61250998",
      "id" : 61250998,
      "original_commit_id" : "f90efbfeef9cd733aa7590fdf581ff82b999c4b5",
      "original_position" : 44,
      "path" : "src/rpc/misc.cpp",
      "position" : 44,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953",
      "updated_at" : "2016-04-27T12:54:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61250998",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61251392"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61251392"
         }
      },
      "body" : "Agree. Its just a nitpick (I forgot to pre-fix it with \"nit:\"). As long as we are dealing with privatekeys in bitcoin-core there will always be memory containing sensitive stuff.",
      "commit_id" : "f90efbfeef9cd733aa7590fdf581ff82b999c4b5",
      "created_at" : "2016-04-27T12:54:13Z",
      "diff_hunk" : "@@ -366,6 +366,48 @@ UniValue verifymessage(const UniValue& params, bool fHelp)\n     return (pubkey.GetID() == keyID);\n }\n \n+UniValue signmessagewithprivkey(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 2)\n+        throw runtime_error(\n+            \"signmessagewithprivkey \\\"privkey\\\" \\\"message\\\"\\n\"\n+            \"\\nSign a message with the private key of an address\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"privkey\\\"         (string, required) The private key to sign the message with.\\n\"\n+            \"2. \\\"message\\\"         (string, required) The message to create a signature of.\\n\"\n+            \"\\nResult:\\n\"\n+            \"\\\"signature\\\"          (string) The signature of the message encoded in base 64\\n\"\n+            \"\\nExamples:\\n\"\n+            \"\\nCreate the signature\\n\"\n+            + HelpExampleCli(\"signmessagewithprivkey\", \"\\\"privkey\\\" \\\"my message\\\"\") +\n+            \"\\nVerify the signature\\n\"\n+            + HelpExampleCli(\"verifymessage\", \"\\\"1D1ZrZNe3JUo7ZycKEYQQiQAWd9y54F4XZ\\\" \\\"signature\\\" \\\"my message\\\"\") +\n+            \"\\nAs json rpc\\n\"\n+            + HelpExampleRpc(\"signmessagewithprivkey\", \"\\\"privkey\\\", \\\"my message\\\"\")\n+        );\n+\n+    string strPrivkey = params[0].get_str();\n+    string strMessage = params[1].get_str();\n+\n+    CBitcoinSecret vchSecret;\n+    bool fGood = vchSecret.SetString(strPrivkey);\n+    if (!fGood)\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid private key\");\n+    CKey key = vchSecret.GetKey();\n+    if (!key.IsValid())\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Private key outside allowed range\");\n+\n+    CHashWriter ss(SER_GETHASH, 0);\n+    ss << strMessageMagic;\n+    ss << strMessage;\n+\n+    vector<unsigned char> vchSig;\n+    if (!key.SignCompact(ss.GetHash(), vchSig))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Sign failed\");\n+\n+    return EncodeBase64(&vchSig[0], vchSig.size());\n+}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7953#discussion_r61251392",
      "id" : 61251392,
      "original_commit_id" : "f90efbfeef9cd733aa7590fdf581ff82b999c4b5",
      "original_position" : 44,
      "path" : "src/rpc/misc.cpp",
      "position" : 44,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7953",
      "updated_at" : "2016-04-27T12:54:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61251392",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Can you please write some test for this new RPC?\r\n",
      "created_at" : "2016-04-27T15:58:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7953#issuecomment-215130273",
      "id" : 215130273,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7953",
      "updated_at" : "2016-04-27T15:58:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/215130273",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   }
]
