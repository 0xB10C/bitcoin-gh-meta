[
   {
      "body" : "Concept ACK.\r\n\r\nRelated: #6570, #7061,  #7551",
      "created_at" : "2016-05-01T16:07:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7984#issuecomment-216052264",
      "id" : 216052264,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7984",
      "updated_at" : "2016-05-01T16:07:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/216052264",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7984#discussion_r61690375"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7984"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61690375"
         }
      },
      "body" : "Why not define this in the `if (fRescan)` block where it's used?",
      "commit_id" : "5c2784eb49ad4fdf32bb07b0cbfbe989261ad2c5",
      "created_at" : "2016-05-01T17:59:14Z",
      "diff_hunk" : "@@ -114,6 +115,11 @@ UniValue importprivkey(const UniValue& params, bool fHelp)\n     if (params.size() > 2)\n         fRescan = params[2].get_bool();\n \n+    // Get the start height",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7984#discussion_r61690375",
      "id" : 61690375,
      "original_commit_id" : "5c2784eb49ad4fdf32bb07b0cbfbe989261ad2c5",
      "original_position" : 22,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 22,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7984",
      "updated_at" : "2016-05-01T17:59:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61690375",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7984#discussion_r61690442"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7984"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61690442"
         }
      },
      "body" : "Indexing into chainActive isn't safe until after locking cs_main",
      "commit_id" : "5c2784eb49ad4fdf32bb07b0cbfbe989261ad2c5",
      "created_at" : "2016-05-01T18:03:31Z",
      "diff_hunk" : "@@ -222,6 +229,11 @@ UniValue importaddress(const UniValue& params, bool fHelp)\n     if (params.size() > 3)\n         fP2SH = params[3].get_bool();\n \n+    // Get the start height\n+    CBlockIndex* start = chainActive.Genesis();\n+    if (params.size() > 4 && fRescan)\n+        start = chainActive[params[4].get_int()];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7984#discussion_r61690442",
      "id" : 61690442,
      "original_commit_id" : "5c2784eb49ad4fdf32bb07b0cbfbe989261ad2c5",
      "original_position" : 65,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 65,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7984",
      "updated_at" : "2016-05-01T18:03:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61690442",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "body" : "I tend to concept NACK.\r\nWhat if you want to import 10 addresses? Self-calculate the oldest heigh and pass it in when you import the last address?\r\n\r\nIMO the `importmulti` #7551 call makes more sense maybe there could also be a reason to support the `rescanblockchain` #7061. But later should not be required if we do #7551 right.",
      "created_at" : "2016-05-01T18:04:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7984#issuecomment-216059463",
      "id" : 216059463,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7984",
      "updated_at" : "2016-05-01T18:04:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/216059463",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7984#discussion_r61690502"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7984"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61690502"
         }
      },
      "body" : "This doesn't need to be a special case since the default for `-rescan` is `0`, and `chainActive.Genesis() == chainActive[0]`",
      "commit_id" : "5c2784eb49ad4fdf32bb07b0cbfbe989261ad2c5",
      "created_at" : "2016-05-01T18:08:40Z",
      "diff_hunk" : "@@ -3140,7 +3140,9 @@ bool CWallet::InitLoadWallet()\n     RegisterValidationInterface(walletInstance);\n \n     CBlockIndex *pindexRescan = chainActive.Tip();\n-    if (GetBoolArg(\"-rescan\", false))\n+    if (GetBoolArg(\"-rescan\", false) && GetArg(\"-rescan\", 0) > 0)\n+        pindexRescan = chainActive[GetArg(\"-rescan\", 0)];\n+    else if (GetBoolArg(\"-rescan\", false))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7984#discussion_r61690502",
      "id" : 61690502,
      "original_commit_id" : "5c2784eb49ad4fdf32bb07b0cbfbe989261ad2c5",
      "original_position" : 16,
      "path" : "src/wallet/wallet.cpp",
      "position" : 16,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7984",
      "updated_at" : "2016-05-01T18:08:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61690502",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1047859?v=3",
         "events_url" : "https://api.github.com/users/kazcw/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kazcw/followers",
         "following_url" : "https://api.github.com/users/kazcw/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kazcw/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kazcw",
         "id" : 1047859,
         "login" : "kazcw",
         "organizations_url" : "https://api.github.com/users/kazcw/orgs",
         "received_events_url" : "https://api.github.com/users/kazcw/received_events",
         "repos_url" : "https://api.github.com/users/kazcw/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kazcw/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kazcw/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kazcw"
      }
   },
   {
      "body" : "@achow101:\r\nRight. This is a point.\r\n\r\nEither we support no rescan for a single input (maybe together with a manual rescan like #7061) or each address/script/pubkey input call should support the same rescan flexibility.\r\n\r\nThe question now is if we should support heights or timestamps (key birthday). IIRC discussions in #7061 showed that most devs prefer timestamps.",
      "created_at" : "2016-05-02T06:54:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7984#issuecomment-216118380",
      "id" : 216118380,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7984",
      "updated_at" : "2016-05-02T06:54:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/216118380",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "100% agree with @jonasschnelli, importmulti with explicit key birthdays is the answer here, not adding yet another positional argument to RPC calls (yes, you can also use importmulti to import just one key).\r\nLet's focus on that pull and get it merged.\r\n\r\nIn time we can deprecate `import*` in favor of the `importmulti` interface which can (but doesn't need to) handle multiple keys. There are some other good reasons for that too: see discussion here https://github.com/bitcoin/bitcoin/pull/7551#issuecomment-209858703 on the `importscript` confusion.\r\n(and no one generally really wants to import keys one by one and rescan in between)",
      "created_at" : "2016-05-02T11:35:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7984#issuecomment-216212024",
      "id" : 216212024,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7984",
      "updated_at" : "2016-05-02T11:51:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/216212024",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "> I agree, but that's inferior in every way to just having one self-contained operation.\r\n\r\n@laanwj well this discussion is like `*rawtransaction` calls vs `createtransaction` on steroids. In terms of API it is more desirable to have simple, flexible, self explanatory calls instead of one super configurable call.\r\n\r\nHowever I see this like OpenGL `glVertex` vs `glDrawArrays`. There are too much locks and alike in import one by one vs impormulti.\r\n\r\nRegarding `rescan` option, I think it is very reasonable to be in `importmulti`, but I hope it can be possible to just issue a rescan (for instance #7061). ",
      "created_at" : "2016-05-02T12:57:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7984#issuecomment-216227955",
      "id" : 216227955,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7984",
      "updated_at" : "2016-05-02T12:57:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/216227955",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=3",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   }
]
