[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It looks like an empty line needs to be added to the commit message after the subject line for the linter to pass.",
      "created_at" : "2021-07-01T14:40:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22383#issuecomment-872304091",
      "id" : 872304091,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22383",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3MjMwNDA5MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-01T14:40:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/872304091",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this would change the behavior of `GetTransaction` in some cases. I'm not sure whether this is OK or not, but I'd think we should at least update comments here: https://github.com/bitcoin/bitcoin/blob/master/src/validation.h#L146, and docs here: https://github.com/bitcoin/bitcoin/blob/master/src/rpc/rawtransaction.cpp#L78\r\n\r\nThe case I'm thinking about, which you noted, is when an incorrect `block_index` is provided to `GetTransaction`, but `g_txindex->FindTx(hash, hashBlock, tx)` finds and returns the tx. After this PR we would return the tx although it isn't in the block the user asked for. Idk the implications of this or if it matters, but if it does, you could probably check `hashBlock` against the user provided `block_index` and get the performance win you want without changing behavior (if necessary/practical)\r\n\r\nSimilarly, I'm not sure if checking the mempool first has any unintended consequences (other than deviating from current docs). That said, I'm not sure the `if (mempool) {` branch needs to move in this PR, can probably just leave it after the `if (block_index) {` branch as is. Again, not sure how we feel about returning a tx from the mempool when the user wanted to check a specific `block_index`",
      "created_at" : "2021-07-01T16:31:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22383#issuecomment-872388955",
      "id" : 872388955,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22383",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3MjM4ODk1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-01T16:31:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/872388955",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7217256?v=4",
         "events_url" : "https://api.github.com/users/mjdietzx/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mjdietzx/followers",
         "following_url" : "https://api.github.com/users/mjdietzx/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mjdietzx/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mjdietzx",
         "id" : 7217256,
         "login" : "mjdietzx",
         "node_id" : "MDQ6VXNlcjcyMTcyNTY=",
         "organizations_url" : "https://api.github.com/users/mjdietzx/orgs",
         "received_events_url" : "https://api.github.com/users/mjdietzx/received_events",
         "repos_url" : "https://api.github.com/users/mjdietzx/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mjdietzx/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mjdietzx/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mjdietzx"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think a fundamental question is whether or not the block_index is intended to be used as a hint or as a validation parameter.\r\n\r\nGiven that the current logic of this function has various fallbacks, it seems to me that block_index is a hint and that the goal of the function is to try to return the requested transaction regardless of where it is stored. So it seems to me that reorganizing the logic for performance gains is a suitable goal.",
      "created_at" : "2021-07-01T18:37:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22383#issuecomment-872465440",
      "id" : 872465440,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22383",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3MjQ2NTQ0MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-01T18:37:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/872465440",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/288011?v=4",
         "events_url" : "https://api.github.com/users/jlopp/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jlopp/followers",
         "following_url" : "https://api.github.com/users/jlopp/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jlopp/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jlopp",
         "id" : 288011,
         "login" : "jlopp",
         "node_id" : "MDQ6VXNlcjI4ODAxMQ==",
         "organizations_url" : "https://api.github.com/users/jlopp/orgs",
         "received_events_url" : "https://api.github.com/users/jlopp/received_events",
         "repos_url" : "https://api.github.com/users/jlopp/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jlopp/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jlopp/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jlopp"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "FindTx returns the block hash, so it's very easy to check if it matches. If you do so, the question of whether the provided block is a hint or a search restriction doesn't apply.",
      "created_at" : "2021-07-01T18:45:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22383#issuecomment-872470202",
      "id" : 872470202,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22383",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3MjQ3MDIwMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-01T18:45:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/872470202",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
