[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2021-06-26T13:07:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#issuecomment-868998620",
      "id" : 868998620,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22330",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2ODk5ODYyMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-26T13:07:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/868998620",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK c582546366496f25b452a516d7890389af3e0729",
      "created_at" : "2021-07-14T21:54:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#issuecomment-880235236",
      "id" : 880235236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22330",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4MDIzNTIzNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-14T21:54:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/880235236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7217256?v=4",
         "events_url" : "https://api.github.com/users/mjdietzx/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mjdietzx/followers",
         "following_url" : "https://api.github.com/users/mjdietzx/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mjdietzx/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mjdietzx",
         "id" : 7217256,
         "login" : "mjdietzx",
         "node_id" : "MDQ6VXNlcjcyMTcyNTY=",
         "organizations_url" : "https://api.github.com/users/mjdietzx/orgs",
         "received_events_url" : "https://api.github.com/users/mjdietzx/received_events",
         "repos_url" : "https://api.github.com/users/mjdietzx/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mjdietzx/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mjdietzx/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mjdietzx"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Needs rebase",
      "created_at" : "2021-07-15T18:19:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#issuecomment-880914797",
      "id" : 880914797,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22330",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4MDkxNDc5Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-15T18:19:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/880914797",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Needs rebase\r\n\r\nDone. Took the new sub-test `test_replacement_relay_fee()` into account for the second commit.",
      "created_at" : "2021-07-15T20:21:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#issuecomment-880988013",
      "id" : 880988013,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22330",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg4MDk4ODAxMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-15T20:21:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/880988013",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r674195638"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/674195638"
         }
      },
      "author_association" : "NONE",
      "body" : "Previously,\r\nWe were scanning block 76 for `test_no_inherited_signaling(self)` and block 77 for `test_replacement_relay_fee(self)`\r\n\r\nHowever in the PR,\r\nWe are scanning blocks 76,77, and 78.\r\n\r\nBlock 78 is not required to be scanned here and seems unnecesary, hence, we can rather have this as `self.wallet.scan_blocks(start=76, num=2)`",
      "commit_id" : "48e5b1f66f567b21ab6ce3ec1b58838ca04279ca",
      "created_at" : "2021-07-21T17:36:28Z",
      "diff_hunk" : "@@ -84,10 +85,8 @@ def skip_test_if_missing_module(self):\n         self.skip_if_no_wallet()\n \n     def run_test(self):\n-        make_utxo(self.nodes[0], 1 * COIN)\n-\n-        # Ensure nodes are synced\n-        self.sync_all()\n+        self.wallet = MiniWallet(self.nodes[0])\n+        self.wallet.scan_blocks(start=76, num=3)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r674195638",
      "id" : 674195638,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NDE5NTYzOA==",
      "original_commit_id" : "9f2a53d0f450ea83b24b1af209591db7fc5b31b9",
      "original_line" : 89,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/feature_rbf.py",
      "position" : null,
      "pull_request_review_id" : 711972566,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-21T18:04:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/674195638",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/55556994?v=4",
         "events_url" : "https://api.github.com/users/ShubhamPalriwala/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ShubhamPalriwala/followers",
         "following_url" : "https://api.github.com/users/ShubhamPalriwala/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ShubhamPalriwala/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ShubhamPalriwala",
         "id" : 55556994,
         "login" : "ShubhamPalriwala",
         "node_id" : "MDQ6VXNlcjU1NTU2OTk0",
         "organizations_url" : "https://api.github.com/users/ShubhamPalriwala/orgs",
         "received_events_url" : "https://api.github.com/users/ShubhamPalriwala/received_events",
         "repos_url" : "https://api.github.com/users/ShubhamPalriwala/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ShubhamPalriwala/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ShubhamPalriwala/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ShubhamPalriwala"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r676016815"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/676016815"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, done.",
      "commit_id" : "48e5b1f66f567b21ab6ce3ec1b58838ca04279ca",
      "created_at" : "2021-07-24T16:11:37Z",
      "diff_hunk" : "@@ -84,10 +85,8 @@ def skip_test_if_missing_module(self):\n         self.skip_if_no_wallet()\n \n     def run_test(self):\n-        make_utxo(self.nodes[0], 1 * COIN)\n-\n-        # Ensure nodes are synced\n-        self.sync_all()\n+        self.wallet = MiniWallet(self.nodes[0])\n+        self.wallet.scan_blocks(start=76, num=3)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r676016815",
      "id" : 676016815,
      "in_reply_to_id" : 674195638,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NjAxNjgxNQ==",
      "original_commit_id" : "9f2a53d0f450ea83b24b1af209591db7fc5b31b9",
      "original_line" : 89,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/feature_rbf.py",
      "position" : null,
      "pull_request_review_id" : 714244750,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-24T16:11:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/676016815",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@ShubhamPalriwala @sriramdvt: Thanks for your reviews! You are right, in total we only need two blocks to scan -- in the second commit one UTXO in MiniWallet to start with is enough (both sub-tests `test_no_inherited_signaling` and `test_replacement_relay_fee` consume one UTXO, but also create one, due to calls to `send_self_transfer`), in the latest commit, we have to increase it to two, however (the sub-test `test_simple_doublespend` only consumes a UTXO, but doesn't create a new one).",
      "created_at" : "2021-07-24T16:16:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#issuecomment-886074550",
      "id" : 886074550,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22330",
      "node_id" : "IC_kwDOABII58400Gy2",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-24T16:16:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/886074550",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2021-07-24T20:17:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#issuecomment-886106589",
      "id" : 886106589,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22330",
      "node_id" : "IC_kwDOABII58400Ond",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-24T20:17:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/886106589",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r676540905"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/676540905"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm not not sure why this call to `self.sync_all()` is here. Looks like you removed it on line 137 and it's also not used after calling `sendrawtransaction` on line 155. Since the miniwallet is attached to node 0 and its the only once we are referencing in the test, it seems unnecessary.\r\n\r\nI deleted line 141 while testing, ran the test a few times and every run passed. I'd suggest removing it.",
      "commit_id" : "c1c0768b619ab463a00052d0a584fba191eb02a9",
      "created_at" : "2021-07-26T12:03:05Z",
      "diff_hunk" : "@@ -129,33 +128,27 @@ def run_test(self):\n \n     def test_simple_doublespend(self):\n         \"\"\"Simple doublespend\"\"\"\n-        tx0_outpoint = make_utxo(self.nodes[0], int(1.1 * COIN))\n+        # we use MiniWallet to create a transaction template with inputs correctly set,\n+        # and modify the output (amount, scriptPubKey) according to our needs\n+        utxo = self.wallet.get_utxo()\n+        tx_template = self.wallet.create_self_transfer(from_node=self.nodes[0], utxo_to_spend=utxo)['tx']\n \n-        # make_utxo may have generated a bunch of blocks, so we need to sync\n-        # before we can spend the coins generated, or else the resulting\n-        # transactions might not be accepted by our peers.\n-        self.sync_all()\n-\n-        tx1a = CTransaction()\n-        tx1a.vin = [CTxIn(tx0_outpoint, nSequence=0)]\n+        tx1a = deepcopy(tx_template)\n         tx1a.vout = [CTxOut(1 * COIN, DUMMY_P2WPKH_SCRIPT)]\n         tx1a_hex = tx1a.serialize().hex()\n         tx1a_txid = self.nodes[0].sendrawtransaction(tx1a_hex, 0)\n \n         self.sync_all()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r676540905",
      "id" : 676540905,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NjU0MDkwNQ==",
      "original_commit_id" : "48e5b1f66f567b21ab6ce3ec1b58838ca04279ca",
      "original_line" : 141,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "test/functional/feature_rbf.py",
      "position" : null,
      "pull_request_review_id" : 714761789,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-26T12:06:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/676540905",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7444140?v=4",
         "events_url" : "https://api.github.com/users/josibake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/josibake/followers",
         "following_url" : "https://api.github.com/users/josibake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/josibake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/josibake",
         "id" : 7444140,
         "login" : "josibake",
         "node_id" : "MDQ6VXNlcjc0NDQxNDA=",
         "organizations_url" : "https://api.github.com/users/josibake/orgs",
         "received_events_url" : "https://api.github.com/users/josibake/received_events",
         "repos_url" : "https://api.github.com/users/josibake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/josibake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/josibake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/josibake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r676542687"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/676542687"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Initially, I was confused by these parameters and noted that the test would fail if I picked a `start` less than 70, but would run for starts greater than 76. I dug through the comments and found the explanation on a previous PR, but considering this test is meant to be a proof of concept to motivate re-writing all the tests to use miniwallet, it might be worth adding a small comment explaining why 76 and 2 are chosen.",
      "commit_id" : "c1c0768b619ab463a00052d0a584fba191eb02a9",
      "created_at" : "2021-07-26T12:05:55Z",
      "diff_hunk" : "@@ -84,10 +85,8 @@ def skip_test_if_missing_module(self):\n         self.skip_if_no_wallet()\n \n     def run_test(self):\n-        make_utxo(self.nodes[0], 1 * COIN)\n-\n-        # Ensure nodes are synced\n-        self.sync_all()\n+        self.wallet = MiniWallet(self.nodes[0])\n+        self.wallet.scan_blocks(start=76, num=2)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r676542687",
      "id" : 676542687,
      "line" : 92,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NjU0MjY4Nw==",
      "original_commit_id" : "48e5b1f66f567b21ab6ce3ec1b58838ca04279ca",
      "original_line" : 92,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/feature_rbf.py",
      "position" : 20,
      "pull_request_review_id" : 714761789,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-26T12:06:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/676542687",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7444140?v=4",
         "events_url" : "https://api.github.com/users/josibake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/josibake/followers",
         "following_url" : "https://api.github.com/users/josibake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/josibake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/josibake",
         "id" : 7444140,
         "login" : "josibake",
         "node_id" : "MDQ6VXNlcjc0NDQxNDA=",
         "organizations_url" : "https://api.github.com/users/josibake/orgs",
         "received_events_url" : "https://api.github.com/users/josibake/received_events",
         "repos_url" : "https://api.github.com/users/josibake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/josibake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/josibake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/josibake"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "tested and works fine on Ubuntu 21.04 https://github.com/bitcoin/bitcoin/commit/48e5b1f66f567b21ab6ce3ec1b58838ca04279ca\r\n\r\nHowever, I agree with @josibake here:\r\n> Initially, I was confused by these parameters and noted that the test would fail if I picked a `start` less than 70, but would run for starts greater than 76. I dug through the comments and found the explanation on a previous PR, but considering this test is meant to be a proof of concept to motivate re-writing all the tests to use miniwallet, it might be worth adding a small comment explaining why 76 and 2 are chosen.\r\n\r\nAdding a comment explaining the 2 blocks would help to understand the code even further",
      "created_at" : "2021-07-27T20:05:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#issuecomment-887798303",
      "id" : 887798303,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22330",
      "node_id" : "IC_kwDOABII58406rof",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-27T20:05:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/887798303",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/55556994?v=4",
         "events_url" : "https://api.github.com/users/ShubhamPalriwala/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ShubhamPalriwala/followers",
         "following_url" : "https://api.github.com/users/ShubhamPalriwala/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ShubhamPalriwala/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ShubhamPalriwala",
         "id" : 55556994,
         "login" : "ShubhamPalriwala",
         "node_id" : "MDQ6VXNlcjU1NTU2OTk0",
         "organizations_url" : "https://api.github.com/users/ShubhamPalriwala/orgs",
         "received_events_url" : "https://api.github.com/users/ShubhamPalriwala/received_events",
         "repos_url" : "https://api.github.com/users/ShubhamPalriwala/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ShubhamPalriwala/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ShubhamPalriwala/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ShubhamPalriwala"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r677809258"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677809258"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, excellent find! Removed the sync_all() call in the latest force-push.",
      "commit_id" : "c1c0768b619ab463a00052d0a584fba191eb02a9",
      "created_at" : "2021-07-27T21:21:14Z",
      "diff_hunk" : "@@ -129,33 +128,27 @@ def run_test(self):\n \n     def test_simple_doublespend(self):\n         \"\"\"Simple doublespend\"\"\"\n-        tx0_outpoint = make_utxo(self.nodes[0], int(1.1 * COIN))\n+        # we use MiniWallet to create a transaction template with inputs correctly set,\n+        # and modify the output (amount, scriptPubKey) according to our needs\n+        utxo = self.wallet.get_utxo()\n+        tx_template = self.wallet.create_self_transfer(from_node=self.nodes[0], utxo_to_spend=utxo)['tx']\n \n-        # make_utxo may have generated a bunch of blocks, so we need to sync\n-        # before we can spend the coins generated, or else the resulting\n-        # transactions might not be accepted by our peers.\n-        self.sync_all()\n-\n-        tx1a = CTransaction()\n-        tx1a.vin = [CTxIn(tx0_outpoint, nSequence=0)]\n+        tx1a = deepcopy(tx_template)\n         tx1a.vout = [CTxOut(1 * COIN, DUMMY_P2WPKH_SCRIPT)]\n         tx1a_hex = tx1a.serialize().hex()\n         tx1a_txid = self.nodes[0].sendrawtransaction(tx1a_hex, 0)\n \n         self.sync_all()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r677809258",
      "id" : 677809258,
      "in_reply_to_id" : 676540905,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgwOTI1OA==",
      "original_commit_id" : "48e5b1f66f567b21ab6ce3ec1b58838ca04279ca",
      "original_line" : 141,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "test/functional/feature_rbf.py",
      "position" : null,
      "pull_request_review_id" : 716389761,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-27T21:21:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677809258",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r677810409"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677810409"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good point, extended the second commit with an explanation about why we start at block 76, with reference to the test framework's method where the chain is pre-mined.",
      "commit_id" : "c1c0768b619ab463a00052d0a584fba191eb02a9",
      "created_at" : "2021-07-27T21:23:15Z",
      "diff_hunk" : "@@ -84,10 +85,8 @@ def skip_test_if_missing_module(self):\n         self.skip_if_no_wallet()\n \n     def run_test(self):\n-        make_utxo(self.nodes[0], 1 * COIN)\n-\n-        # Ensure nodes are synced\n-        self.sync_all()\n+        self.wallet = MiniWallet(self.nodes[0])\n+        self.wallet.scan_blocks(start=76, num=2)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r677810409",
      "id" : 677810409,
      "in_reply_to_id" : 676542687,
      "line" : 92,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzgxMDQwOQ==",
      "original_commit_id" : "48e5b1f66f567b21ab6ce3ec1b58838ca04279ca",
      "original_line" : 92,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "test/functional/feature_rbf.py",
      "position" : 20,
      "pull_request_review_id" : 716391113,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-27T21:23:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677810409",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Force-pushed with changes suggested by josibake (https://github.com/bitcoin/bitcoin/pull/22330#discussion_r676542687, https://github.com/bitcoin/bitcoin/pull/22330#discussion_r676540905). Thanks for the valuable reviews so far :)",
      "created_at" : "2021-07-27T21:27:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#issuecomment-887846682",
      "id" : 887846682,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22330",
      "node_id" : "IC_kwDOABII584063ca",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-27T21:27:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/887846682",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #22567 by MarcoFalke\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-07-28T12:18:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#issuecomment-888262854",
      "id" : 888262854,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22330",
      "node_id" : "IC_kwDOABII58408dDG",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-28T12:18:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/888262854",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK https://github.com/bitcoin/bitcoin/pull/22330/commits/c1c0768b619ab463a00052d0a584fba191eb02a9\r\n\r\nthanks for adding the comment! it will make it much easier for others to followup and refactor the remaining tests to use miniwallet",
      "created_at" : "2021-07-28T14:49:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#issuecomment-888373257",
      "id" : 888373257,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22330",
      "node_id" : "IC_kwDOABII584084AJ",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-28T14:49:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/888373257",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7444140?v=4",
         "events_url" : "https://api.github.com/users/josibake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/josibake/followers",
         "following_url" : "https://api.github.com/users/josibake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/josibake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/josibake",
         "id" : 7444140,
         "login" : "josibake",
         "node_id" : "MDQ6VXNlcjc0NDQxNDA=",
         "organizations_url" : "https://api.github.com/users/josibake/orgs",
         "received_events_url" : "https://api.github.com/users/josibake/received_events",
         "repos_url" : "https://api.github.com/users/josibake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/josibake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/josibake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/josibake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r678388776"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678388776"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        tx_template = self.wallet.create_self_transfer(from_node=self.nodes[0])['tx']\r\n```",
      "commit_id" : "c1c0768b619ab463a00052d0a584fba191eb02a9",
      "created_at" : "2021-07-28T15:01:36Z",
      "diff_hunk" : "@@ -129,33 +131,25 @@ def run_test(self):\n \n     def test_simple_doublespend(self):\n         \"\"\"Simple doublespend\"\"\"\n-        tx0_outpoint = make_utxo(self.nodes[0], int(1.1 * COIN))\n-\n-        # make_utxo may have generated a bunch of blocks, so we need to sync\n-        # before we can spend the coins generated, or else the resulting\n-        # transactions might not be accepted by our peers.\n-        self.sync_all()\n+        # we use MiniWallet to create a transaction template with inputs correctly set,\n+        # and modify the output (amount, scriptPubKey) according to our needs\n+        utxo = self.wallet.get_utxo()\n+        tx_template = self.wallet.create_self_transfer(from_node=self.nodes[0], utxo_to_spend=utxo)['tx']",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r678388776",
      "id" : 678388776,
      "line" : 137,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3ODM4ODc3Ng==",
      "original_commit_id" : "c1c0768b619ab463a00052d0a584fba191eb02a9",
      "original_line" : 137,
      "original_position" : 37,
      "original_start_line" : 136,
      "path" : "test/functional/feature_rbf.py",
      "position" : 37,
      "pull_request_review_id" : 717121040,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330",
      "side" : "RIGHT",
      "start_line" : 136,
      "start_side" : "RIGHT",
      "updated_at" : "2021-07-28T15:03:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678388776",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r678389619"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678389619"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n        tx1b.vout[0].nValue -= int(0.1 * COIN)\r\n```",
      "commit_id" : "c1c0768b619ab463a00052d0a584fba191eb02a9",
      "created_at" : "2021-07-28T15:02:29Z",
      "diff_hunk" : "@@ -129,33 +131,25 @@ def run_test(self):\n \n     def test_simple_doublespend(self):\n         \"\"\"Simple doublespend\"\"\"\n-        tx0_outpoint = make_utxo(self.nodes[0], int(1.1 * COIN))\n-\n-        # make_utxo may have generated a bunch of blocks, so we need to sync\n-        # before we can spend the coins generated, or else the resulting\n-        # transactions might not be accepted by our peers.\n-        self.sync_all()\n+        # we use MiniWallet to create a transaction template with inputs correctly set,\n+        # and modify the output (amount, scriptPubKey) according to our needs\n+        utxo = self.wallet.get_utxo()\n+        tx_template = self.wallet.create_self_transfer(from_node=self.nodes[0], utxo_to_spend=utxo)['tx']\n \n-        tx1a = CTransaction()\n-        tx1a.vin = [CTxIn(tx0_outpoint, nSequence=0)]\n+        tx1a = deepcopy(tx_template)\n         tx1a.vout = [CTxOut(1 * COIN, DUMMY_P2WPKH_SCRIPT)]\n         tx1a_hex = tx1a.serialize().hex()\n         tx1a_txid = self.nodes[0].sendrawtransaction(tx1a_hex, 0)\n \n-        self.sync_all()\n-\n         # Should fail because we haven't changed the fee\n-        tx1b = CTransaction()\n-        tx1b.vin = [CTxIn(tx0_outpoint, nSequence=0)]\n+        tx1b = deepcopy(tx_template)\n         tx1b.vout = [CTxOut(1 * COIN, DUMMY_2_P2WPKH_SCRIPT)]\n         tx1b_hex = tx1b.serialize().hex()\n \n         # This will raise an exception due to insufficient fee\n         assert_raises_rpc_error(-26, \"insufficient fee\", self.nodes[0].sendrawtransaction, tx1b_hex, 0)\n \n         # Extra 0.1 BTC fee\n-        tx1b = CTransaction()\n-        tx1b.vin = [CTxIn(tx0_outpoint, nSequence=0)]\n         tx1b.vout = [CTxOut(int(0.9 * COIN), DUMMY_P2WPKH_SCRIPT)]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r678389619",
      "id" : 678389619,
      "line" : 153,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3ODM4OTYxOQ==",
      "original_commit_id" : "c1c0768b619ab463a00052d0a584fba191eb02a9",
      "original_line" : 153,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "test/functional/feature_rbf.py",
      "position" : 61,
      "pull_request_review_id" : 717121040,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-28T15:03:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678389619",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r678457953"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678457953"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, done.",
      "commit_id" : "aa02c64540cd77199c2834549786b9bc91fd4bc9",
      "created_at" : "2021-07-28T16:17:33Z",
      "diff_hunk" : "@@ -129,33 +131,25 @@ def run_test(self):\n \n     def test_simple_doublespend(self):\n         \"\"\"Simple doublespend\"\"\"\n-        tx0_outpoint = make_utxo(self.nodes[0], int(1.1 * COIN))\n-\n-        # make_utxo may have generated a bunch of blocks, so we need to sync\n-        # before we can spend the coins generated, or else the resulting\n-        # transactions might not be accepted by our peers.\n-        self.sync_all()\n+        # we use MiniWallet to create a transaction template with inputs correctly set,\n+        # and modify the output (amount, scriptPubKey) according to our needs\n+        utxo = self.wallet.get_utxo()\n+        tx_template = self.wallet.create_self_transfer(from_node=self.nodes[0], utxo_to_spend=utxo)['tx']",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r678457953",
      "id" : 678457953,
      "in_reply_to_id" : 678388776,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3ODQ1Nzk1Mw==",
      "original_commit_id" : "c1c0768b619ab463a00052d0a584fba191eb02a9",
      "original_line" : 137,
      "original_position" : 37,
      "original_start_line" : 136,
      "path" : "test/functional/feature_rbf.py",
      "position" : null,
      "pull_request_review_id" : 717211551,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-07-28T16:17:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678457953",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r678458199"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678458199"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Way more readable, thanks. Done.",
      "commit_id" : "aa02c64540cd77199c2834549786b9bc91fd4bc9",
      "created_at" : "2021-07-28T16:17:51Z",
      "diff_hunk" : "@@ -129,33 +131,25 @@ def run_test(self):\n \n     def test_simple_doublespend(self):\n         \"\"\"Simple doublespend\"\"\"\n-        tx0_outpoint = make_utxo(self.nodes[0], int(1.1 * COIN))\n-\n-        # make_utxo may have generated a bunch of blocks, so we need to sync\n-        # before we can spend the coins generated, or else the resulting\n-        # transactions might not be accepted by our peers.\n-        self.sync_all()\n+        # we use MiniWallet to create a transaction template with inputs correctly set,\n+        # and modify the output (amount, scriptPubKey) according to our needs\n+        utxo = self.wallet.get_utxo()\n+        tx_template = self.wallet.create_self_transfer(from_node=self.nodes[0], utxo_to_spend=utxo)['tx']\n \n-        tx1a = CTransaction()\n-        tx1a.vin = [CTxIn(tx0_outpoint, nSequence=0)]\n+        tx1a = deepcopy(tx_template)\n         tx1a.vout = [CTxOut(1 * COIN, DUMMY_P2WPKH_SCRIPT)]\n         tx1a_hex = tx1a.serialize().hex()\n         tx1a_txid = self.nodes[0].sendrawtransaction(tx1a_hex, 0)\n \n-        self.sync_all()\n-\n         # Should fail because we haven't changed the fee\n-        tx1b = CTransaction()\n-        tx1b.vin = [CTxIn(tx0_outpoint, nSequence=0)]\n+        tx1b = deepcopy(tx_template)\n         tx1b.vout = [CTxOut(1 * COIN, DUMMY_2_P2WPKH_SCRIPT)]\n         tx1b_hex = tx1b.serialize().hex()\n \n         # This will raise an exception due to insufficient fee\n         assert_raises_rpc_error(-26, \"insufficient fee\", self.nodes[0].sendrawtransaction, tx1b_hex, 0)\n \n         # Extra 0.1 BTC fee\n-        tx1b = CTransaction()\n-        tx1b.vin = [CTxIn(tx0_outpoint, nSequence=0)]\n         tx1b.vout = [CTxOut(int(0.9 * COIN), DUMMY_P2WPKH_SCRIPT)]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#discussion_r678458199",
      "id" : 678458199,
      "in_reply_to_id" : 678389619,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3ODQ1ODE5OQ==",
      "original_commit_id" : "c1c0768b619ab463a00052d0a584fba191eb02a9",
      "original_line" : 153,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "test/functional/feature_rbf.py",
      "position" : null,
      "pull_request_review_id" : 717211875,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22330",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-28T16:17:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/678458199",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Force-pushed with simplification suggestions by MarcoFalke (https://github.com/bitcoin/bitcoin/pull/22330#discussion_r678388776, https://github.com/bitcoin/bitcoin/pull/22330#discussion_r678389619) in the last commit.",
      "created_at" : "2021-07-28T16:18:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22330#issuecomment-888441959",
      "id" : 888441959,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22330",
      "node_id" : "IC_kwDOABII58409Ixn",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-28T16:18:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/888441959",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   }
]
