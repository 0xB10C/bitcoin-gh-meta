[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, good idea.",
      "created_at" : "2021-06-23T11:00:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22322#issuecomment-866740351",
      "id" : 866740351,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22322",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg2Njc0MDM1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-23T11:00:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/866740351",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22322#discussion_r657092084"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22322"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/657092084"
         }
      },
      "author_association" : "MEMBER",
      "body" : "proposed docs if you like\r\n```diff\r\n-        BanMan ban_man{banlist_file, nullptr, offset};\r\n+        BanMan ban_man{banlist_file, /* client_interface */ nullptr, /* default_ban_time */ offset};\r\n         while (--limit_max_ops >= 0 && fuzzed_data_provider.ConsumeBool()) {\r\n             CallOneOf(\r\n                 fuzzed_data_provider,\r\n@@ -100,15 +100,15 @@ FUZZ_TARGET_INIT(banman, initialize_banman)\r\n             SetMockTime(ConsumeTime(fuzzed_data_provider));\r\n             banmap_t banmap;\r\n             ban_man.GetBanned(banmap);\r\n-            BanMan ban_man_read{banlist_file, nullptr, offset};\r\n+            BanMan ban_man_read{banlist_file, /* client_interface */ nullptr, /* default_ban_time */ offset};\r\n             banmap_t banmap_read;\r\n             ban_man_read.GetBanned(banmap_read);\r\n             assert(banmap.size() == banmap_read.size());\r\n             auto it1{banmap.begin()};\r\n             auto it2{banmap_read.begin()};\r\n             for (; it1 != banmap.end(); ++it1, ++it2) {\r\n-                assert(it1->first == it2->first);\r\n-                assert(it1->second.ToJson().write() == it2->second.ToJson().write());\r\n+                assert(it1->first == it2->first); // CSubNet\r\n+                assert(it1->second.ToJson().write() == it2->second.ToJson().write()); // CBanEntry\r\n             }\r\n         }\r\n     }\r\n```\r\n",
      "commit_id" : "fabadb7702a9cbe477e9e5f91706620456154903",
      "created_at" : "2021-06-23T13:21:01Z",
      "diff_hunk" : "@@ -93,6 +95,22 @@ FUZZ_TARGET_INIT(banman, initialize_banman)\n                     ban_man.Discourage(ConsumeNetAddr(fuzzed_data_provider));\n                 });\n         }\n+        if (!force_read_and_write_to_err) {\n+            ban_man.DumpBanlist();\n+            SetMockTime(ConsumeTime(fuzzed_data_provider));\n+            banmap_t banmap;\n+            ban_man.GetBanned(banmap);\n+            BanMan ban_man_read{banlist_file, nullptr, offset};\n+            banmap_t banmap_read;\n+            ban_man_read.GetBanned(banmap_read);\n+            assert(banmap.size() == banmap_read.size());\n+            auto it1{banmap.begin()};\n+            auto it2{banmap_read.begin()};\n+            for (; it1 != banmap.end(); ++it1, ++it2) {\n+                assert(it1->first == it2->first);\n+                assert(it1->second.ToJson().write() == it2->second.ToJson().write());\n+            }\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22322#discussion_r657092084",
      "id" : 657092084,
      "line" : 113,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NzA5MjA4NA==",
      "original_commit_id" : "fabadb7702a9cbe477e9e5f91706620456154903",
      "original_line" : 113,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/test/fuzz/banman.cpp",
      "position" : 43,
      "pull_request_review_id" : 690644108,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22322",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-23T13:22:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/657092084",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
