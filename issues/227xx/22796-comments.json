[
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK f293c68be0469894c988711559f5528020c0ff71",
      "created_at" : "2021-08-25T13:47:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22796#issuecomment-905516755",
      "id" : 905516755,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22796",
      "node_id" : "IC_kwDOABII5841-RbT",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-25T13:47:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/905516755",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r696062327"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696062327"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: I think this include is not needed in this compilation unit (neither `FormatMoney` nor `ParseMoney` is used anywhere here)\r\n```suggestion\r\n```",
      "commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "created_at" : "2021-08-25T19:45:57Z",
      "diff_hunk" : "@@ -3,6 +3,10 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <policy/rbf.h>\n+\n+#include <policy/settings.h>\n+#include <tinyformat.h>\n+#include <util/moneystr.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r696062327",
      "id" : 696062327,
      "line" : 9,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjA2MjMyNw==",
      "original_commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "original_line" : 9,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/policy/rbf.cpp",
      "position" : 7,
      "pull_request_review_id" : 738763833,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-25T19:50:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696062327",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#22698](https://github.com/bitcoin/bitcoin/pull/22698) (Implement RBF inherited signaling and fix getmempoolentry returned bip125-replaceable status by mjdietzx)\n* [#22677](https://github.com/bitcoin/bitcoin/pull/22677) ([RFC] cut the validation <-> txmempool circular dependency by glozow)\n* [#22665](https://github.com/bitcoin/bitcoin/pull/22665) (policy/rbf: don't return \"incorrect\" replaceability status by darosior)\n* [#22539](https://github.com/bitcoin/bitcoin/pull/22539) (Re-include RBF replacement txs in fee estimation by darosior)\n* [#22290](https://github.com/bitcoin/bitcoin/pull/22290) (Package Mempool Submission with Package Fee-Bumping by glozow)\n* [#10443](https://github.com/bitcoin/bitcoin/pull/10443) (Add fee_est tool for debugging fee estimation code by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-08-25T23:49:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22796#issuecomment-905949924",
      "id" : 905949924,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22796",
      "node_id" : "IC_kwDOABII5841_7Lk",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-25T23:49:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/905949924",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r696454500"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696454500"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "ah true, I guess not needed until https://github.com/bitcoin/bitcoin/pull/22675/commits/781e100b6047f110f93e965146d5202ed7032e2c\r\n\r\nwill update if i need to repush",
      "commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "created_at" : "2021-08-26T09:24:40Z",
      "diff_hunk" : "@@ -3,6 +3,10 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <policy/rbf.h>\n+\n+#include <policy/settings.h>\n+#include <tinyformat.h>\n+#include <util/moneystr.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r696454500",
      "id" : 696454500,
      "in_reply_to_id" : 696062327,
      "line" : 9,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NjQ1NDUwMA==",
      "original_commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "original_line" : 9,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/policy/rbf.cpp",
      "position" : 7,
      "pull_request_review_id" : 739243727,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-26T09:24:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/696454500",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r697739720"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697739720"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: \"...by opt-in out its contributed input\"",
      "commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "created_at" : "2021-08-27T21:58:06Z",
      "diff_hunk" : "@@ -11,8 +11,15 @@ class CTransaction;\n \n static const uint32_t MAX_BIP125_RBF_SEQUENCE = 0xfffffffd;\n \n-// Check whether the sequence numbers on this transaction are signaling\n-// opt-in to replace-by-fee, according to BIP 125\n+/** Check whether the sequence numbers on this transaction are signaling\n+* opt-in to replace-by-fee, according to BIP 125.\n+* Allow opt-out of transaction replacement by setting\n+* nSequence > MAX_BIP125_RBF_SEQUENCE (SEQUENCE_FINAL-2) on all inputs.\n+*\n+* SEQUENCE_FINAL-1 is picked to still allow use of nLockTime by\n+* non-replaceable transactions. All inputs rather than just one\n+* is for the sake of multi-party protocols, where we don't\n+* want a single party to be able to disable replacement. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r697739720",
      "id" : 697739720,
      "line" : 22,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzczOTcyMA==",
      "original_commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "original_line" : 22,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/util/rbf.h",
      "position" : 14,
      "pull_request_review_id" : 740918322,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T23:44:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697739720",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r697744794"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697744794"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think what we called \"modified fees\" in before-this-PR `PreChecks()` are currently the base_fee of the mempool candidate plus the delta from `PrioritiseTransaction` (L698 in `src/validation.cpp`). Maybe the \"modified\" adjective can be dropped ?",
      "commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "created_at" : "2021-08-27T22:13:48Z",
      "diff_hunk" : "@@ -474,8 +475,10 @@ class MemPoolAccept\n         bool m_replacement_transaction;\n         CAmount m_base_fees;\n         CAmount m_modified_fees;\n-        CAmount m_conflicting_fees;\n-        size_t m_conflicting_size;\n+        /** Total modified fees of all transactions being replaced. */\n+        CAmount m_conflicting_fees{0};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r697744794",
      "id" : 697744794,
      "line" : 479,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5Nzc0NDc5NA==",
      "original_commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "original_line" : 479,
      "original_position" : 15,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 15,
      "pull_request_review_id" : 740918322,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T23:44:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697744794",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r697759143"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697759143"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Note, I think this commit is changing a bit the processing, Previously, the 3 operations a) checking candidate feerate is better than any replaced transaction b) fulfilling the set of parents inputs and c) accounting replaced transactions with descendants in the same loop.\r\n\r\nAfter this commit, `setIterConflicting` is iterated 3 times. Overall I think it's okay, though it might add a bit of work in case of well-sized set of replaced transactions. From a DoS viewpoint no changes. An upper bound is still enforced with `nConflictingCount` against `MAX_BIP_125_REPLACEMENT_CANDIDATES` (that would be great to have a set of QA assets with a wide range of mempool candidates payloads to confirm or infirm that kind of intuitions, not sure that's an information you can currently get from `qa-assets/fuzz_seed_corpus/validation_load_mempool`)",
      "commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "created_at" : "2021-08-27T23:06:43Z",
      "diff_hunk" : "@@ -818,33 +814,40 @@ bool MemPoolAccept::PreChecks(ATMPArgs& args, Workspace& ws)\n                             newFeeRate.ToString(),\n                             oldFeeRate.ToString()));\n             }\n+        }\n+\n+        uint64_t nConflictingCount = 0;\n+        for (const auto& mi : setIterConflicting) {\n+            nConflictingCount += mi->GetCountWithDescendants();\n+            // This potentially overestimates the number of actual descendants\n+            // but we just want to be conservative to avoid doing too much\n+            // work.\n+            if (nConflictingCount > MAX_BIP125_REPLACEMENT_CANDIDATES) {\n+                return state.Invalid(TxValidationResult::TX_MEMPOOL_POLICY, \"too many potential replacements\",\n+                        strprintf(\"rejecting replacement %s; too many potential replacements (%d > %d)\\n\",\n+                            hash.ToString(),\n+                            nConflictingCount,\n+                            MAX_BIP125_REPLACEMENT_CANDIDATES));\n+            }\n+        }\n+        // If not too many to replace, then calculate the set of\n+        // transactions that would have to be evicted\n+        for (CTxMemPool::txiter it : setIterConflicting) {\n+            m_pool.CalculateDescendants(it, allConflicting);\n+        }\n+        // Check if it's economically rational to mine this transaction rather\n+        // than the ones it replaces.\n+        for (CTxMemPool::txiter it : allConflicting) {\n+            nConflictingFees += it->GetModifiedFee();\n+            nConflictingSize += it->GetTxSize();\n+        }\n \n+        std::set<uint256> setConflictsParents;\n+        for (const auto& mi : setIterConflicting) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r697759143",
      "id" : 697759143,
      "line" : 833,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5Nzc1OTE0Mw==",
      "original_commit_id" : "8d7179633552f58ca0d23305196dcb4249b6dce7",
      "original_line" : 846,
      "original_position" : 51,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 96,
      "pull_request_review_id" : 740918322,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T23:44:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697759143",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r697764806"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697764806"
         }
      },
      "author_association" : "MEMBER",
      "body" : "What do you mean by \"Not cleared at the start; any existing mempool entries will remain in the set\" ?\r\n\r\nIf the replacement is successful,  `allConflicting` are going to be removed in `Finalize`. For package support, I think this operation we'll remove the per-package tx `allConflicting` set all at once. If `PreChecks` or any new other package policy checks as failed, don't modify mempool state.",
      "commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "created_at" : "2021-08-27T23:31:04Z",
      "diff_hunk" : "@@ -35,4 +35,19 @@ enum class RBFTransactionState {\n RBFTransactionState IsRBFOptIn(const CTransaction& tx, const CTxMemPool& pool) EXCLUSIVE_LOCKS_REQUIRED(pool.cs);\n RBFTransactionState IsRBFOptInEmptyMempool(const CTransaction& tx);\n \n+/** Get all descendants of setIterConflicting. Also enforce BIP125 Rule #5, \"The number of original\n+ * transactions to be replaced and their descendant transactions which will be evicted from the\n+ * mempool must not exceed a total of 100 transactions.\" Quit as early as possible. There cannot be\n+ * more than MAX_BIP125_REPLACEMENT_CANDIDATES potential entries.\n+ * @param[in]   setIterConflicting  The set of iterators to mempool entries.\n+ * @param[out]  err_string          Used to return errors, if any.\n+ * @param[out]  allConflicting      Populated with all the mempool entries that would be replaced,\n+ *                                  which includes descendants of setIterConflicting. Not cleared at\n+ *                                  the start; any existing mempool entries will remain in the set.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r697764806",
      "id" : 697764806,
      "line" : 46,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5Nzc2NDgwNg==",
      "original_commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "original_line" : 46,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/policy/rbf.h",
      "position" : 23,
      "pull_request_review_id" : 740918322,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T23:44:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697764806",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r697767044"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697767044"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: \"as replaced parents might have intersecting descendants\"",
      "commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "created_at" : "2021-08-27T23:41:30Z",
      "diff_hunk" : "@@ -42,3 +46,34 @@ RBFTransactionState IsRBFOptInEmptyMempool(const CTransaction& tx)\n     // If we don't have a local mempool we can only check the transaction itself.\n     return SignalsOptInRBF(tx) ? RBFTransactionState::REPLACEABLE_BIP125 : RBFTransactionState::UNKNOWN;\n }\n+\n+bool GetEntriesForConflicts(const CTransaction& tx,\n+                            CTxMemPool& m_pool,\n+                            const CTxMemPool::setEntries& setIterConflicting,\n+                            CTxMemPool::setEntries& allConflicting,\n+                            std::string& err_string)\n+{\n+    AssertLockHeld(m_pool.cs);\n+    const uint256 hash = tx.GetHash();\n+    uint64_t nConflictingCount = 0;\n+    for (const auto& mi : setIterConflicting) {\n+        nConflictingCount += mi->GetCountWithDescendants();\n+        // This potentially overestimates the number of actual descendants",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22796#discussion_r697767044",
      "id" : 697767044,
      "line" : 61,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5Nzc2NzA0NA==",
      "original_commit_id" : "f293c68be0469894c988711559f5528020c0ff71",
      "original_line" : 61,
      "original_position" : 27,
      "original_start_line" : null,
      "path" : "src/policy/rbf.cpp",
      "position" : 27,
      "pull_request_review_id" : 740918322,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22796",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T23:44:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697767044",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   }
]
