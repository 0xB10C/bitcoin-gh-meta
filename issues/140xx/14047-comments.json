[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15649](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15649.html) (Add ChaCha20Poly1305@Bitcoin AEAD by jonasschnelli)\n* [#15519](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15519.html) (Add Poly1305 implementation by jonasschnelli)\n* [#14032](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14032.html) (Add p2p layer encryption with ECDH/ChaCha20Poly1305 by jonasschnelli)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-08-24T12:15:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14047#issuecomment-415741455",
      "id" : 415741455,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14047",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNTc0MTQ1NQ==",
      "updated_at" : "2019-03-25T00:38:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/415741455",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r212834280"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212834280"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You can avoid the copy to `data` if you use `static const char one[1] = {1}; CHMAC_SHA256(m_prk, 32).Write(info.data(), info.size()).Write(one, 1).Finalize(out);` instead.",
      "commit_id" : "acf3debc6a2f8b80a5de1e71bc658086c6de77b4",
      "created_at" : "2018-08-26T18:09:15Z",
      "diff_hunk" : "@@ -0,0 +1,23 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <crypto/hkdf_sha256_32.h>\n+\n+#include <assert.h>\n+#include <string.h>\n+\n+CHKDF_HMAC_SHA256_L32::CHKDF_HMAC_SHA256_L32(const unsigned char* ikm, size_t ikmlen, const std::string& salt)\n+{\n+    CHMAC_SHA256(reinterpret_cast<const unsigned char*>(salt.c_str()), salt.size()).Write(ikm, ikmlen).Finalize(m_prk);\n+}\n+\n+void CHKDF_HMAC_SHA256_L32::Expand32(const std::string& info, unsigned char* out)\n+{\n+    // expand a 32byte key (single round)\n+    assert(info.size() <= 128);\n+    unsigned char data[129];\n+    memcpy(&data[0], &info[0], info.size());\n+    data[info.size()] = 0x01;\n+    CHMAC_SHA256(m_prk, 32).Write(&data[0], info.size() + 1).Finalize(out);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r212834280",
      "id" : 212834280,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjgzNDI4MA==",
      "original_commit_id" : "83e435f002a04a11b5283f89cc74626071dbb35b",
      "original_position" : 22,
      "path" : "src/crypto/hkdf_sha256_32.cpp",
      "position" : null,
      "pull_request_review_id" : 149546222,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047",
      "updated_at" : "2019-03-26T17:07:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212834280",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r212946915"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212946915"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh yes. That's more efficient. Fixed.",
      "commit_id" : "acf3debc6a2f8b80a5de1e71bc658086c6de77b4",
      "created_at" : "2018-08-27T11:42:43Z",
      "diff_hunk" : "@@ -0,0 +1,23 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <crypto/hkdf_sha256_32.h>\n+\n+#include <assert.h>\n+#include <string.h>\n+\n+CHKDF_HMAC_SHA256_L32::CHKDF_HMAC_SHA256_L32(const unsigned char* ikm, size_t ikmlen, const std::string& salt)\n+{\n+    CHMAC_SHA256(reinterpret_cast<const unsigned char*>(salt.c_str()), salt.size()).Write(ikm, ikmlen).Finalize(m_prk);\n+}\n+\n+void CHKDF_HMAC_SHA256_L32::Expand32(const std::string& info, unsigned char* out)\n+{\n+    // expand a 32byte key (single round)\n+    assert(info.size() <= 128);\n+    unsigned char data[129];\n+    memcpy(&data[0], &info[0], info.size());\n+    data[info.size()] = 0x01;\n+    CHMAC_SHA256(m_prk, 32).Write(&data[0], info.size() + 1).Finalize(out);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r212946915",
      "id" : 212946915,
      "in_reply_to_id" : 212834280,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMjk0NjkxNQ==",
      "original_commit_id" : "83e435f002a04a11b5283f89cc74626071dbb35b",
      "original_position" : 22,
      "path" : "src/crypto/hkdf_sha256_32.cpp",
      "position" : null,
      "pull_request_review_id" : 149677088,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047",
      "updated_at" : "2019-03-26T17:07:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/212946915",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r214535573"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214535573"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why not use `BitcoinSharedSecret`as the salt, like in the BIP?",
      "commit_id" : "acf3debc6a2f8b80a5de1e71bc658086c6de77b4",
      "created_at" : "2018-09-02T10:21:15Z",
      "diff_hunk" : "@@ -524,6 +525,16 @@ BOOST_AUTO_TEST_CASE(chacha20_testvector)\n                  \"fab78c9\");\n }\n \n+BOOST_AUTO_TEST_CASE(hkdf_hmac_sha256_l32_tests)\n+{\n+    // rfc5869 has no test vectors for HMAC_SHA256 length 32, the one below was created with python HKDF and compared against openssl\n+    std::vector<unsigned char> key = ParseHex(\"7768617420646f2079612077616e7420666f72206e6f7468696e673fab76cfa9\");\n+    CHKDF_HMAC_SHA256_L32 hkdf32(key.data(), key.size(), \"bitcoinecdh\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r214535573",
      "id" : 214535573,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDUzNTU3Mw==",
      "original_commit_id" : "dc02f90bd4f4374f5fa55520753ef6d7620f8458",
      "original_position" : 28,
      "path" : "src/test/crypto_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 151615961,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047",
      "updated_at" : "2019-03-26T17:07:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214535573",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r216405562"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/216405562"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\nsrc/./crypto/hkdf_sha256_32.h:22:10: warning: function 'CHKDF_HMAC_SHA256_L32::Expand32' has a definition with different parameter names [readability-inconsistent-declaration-parameter-name]\r\n```",
      "commit_id" : "acf3debc6a2f8b80a5de1e71bc658086c6de77b4",
      "created_at" : "2018-09-10T17:23:01Z",
      "diff_hunk" : "@@ -0,0 +1,25 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_CRYPTO_HKDF_SHA256_32_H\n+#define BITCOIN_CRYPTO_HKDF_SHA256_32_H\n+\n+#include <crypto/hmac_sha256.h>\n+\n+#include <stdint.h>\n+#include <stdlib.h>\n+\n+/** A rfc5869 HKDF implementation with HMAC_SHA256 and fixed key output length of 32 bytes (L=32) */\n+class CHKDF_HMAC_SHA256_L32\n+{\n+private:\n+    unsigned char m_prk[32];\n+    static const size_t OUTPUT_SIZE = 32;\n+\n+public:\n+    CHKDF_HMAC_SHA256_L32(const unsigned char* ikm, size_t ikmlen, const std::string& salt);\n+    void Expand32(const std::string& info, unsigned char hash[OUTPUT_SIZE]);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r216405562",
      "id" : 216405562,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNjQwNTU2Mg==",
      "original_commit_id" : "dc02f90bd4f4374f5fa55520753ef6d7620f8458",
      "original_position" : 22,
      "path" : "src/crypto/hkdf_sha256_32.h",
      "position" : 22,
      "pull_request_review_id" : 153878438,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047",
      "updated_at" : "2019-03-26T17:07:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/216405562",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r216794543"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/216794543"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks. Fixed.",
      "commit_id" : "acf3debc6a2f8b80a5de1e71bc658086c6de77b4",
      "created_at" : "2018-09-11T19:34:48Z",
      "diff_hunk" : "@@ -0,0 +1,25 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_CRYPTO_HKDF_SHA256_32_H\n+#define BITCOIN_CRYPTO_HKDF_SHA256_32_H\n+\n+#include <crypto/hmac_sha256.h>\n+\n+#include <stdint.h>\n+#include <stdlib.h>\n+\n+/** A rfc5869 HKDF implementation with HMAC_SHA256 and fixed key output length of 32 bytes (L=32) */\n+class CHKDF_HMAC_SHA256_L32\n+{\n+private:\n+    unsigned char m_prk[32];\n+    static const size_t OUTPUT_SIZE = 32;\n+\n+public:\n+    CHKDF_HMAC_SHA256_L32(const unsigned char* ikm, size_t ikmlen, const std::string& salt);\n+    void Expand32(const std::string& info, unsigned char hash[OUTPUT_SIZE]);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r216794543",
      "id" : 216794543,
      "in_reply_to_id" : 216405562,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNjc5NDU0Mw==",
      "original_commit_id" : "dc02f90bd4f4374f5fa55520753ef6d7620f8458",
      "original_position" : 22,
      "path" : "src/crypto/hkdf_sha256_32.h",
      "position" : 22,
      "pull_request_review_id" : 154362036,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047",
      "updated_at" : "2019-03-26T17:07:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/216794543",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2018-11-05T11:17:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14047#issuecomment-435839618",
      "id" : 435839618,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14047",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQzNTgzOTYxOA==",
      "updated_at" : "2018-11-05T11:17:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/435839618",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased",
      "created_at" : "2019-03-05T14:48:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14047#issuecomment-469707371",
      "id" : 469707371,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14047",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ2OTcwNzM3MQ==",
      "updated_at" : "2019-03-05T14:48:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/469707371",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r268893196"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268893196"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The test here could be a bit more extensive (for example, signing/verifying a fixed message with the corresponding private key, and checking that the private key roundtrips after 2 negations).",
      "commit_id" : "acf3debc6a2f8b80a5de1e71bc658086c6de77b4",
      "created_at" : "2019-03-25T23:25:43Z",
      "diff_hunk" : "@@ -188,4 +188,14 @@ BOOST_AUTO_TEST_CASE(key_signature_tests)\n     BOOST_CHECK(found_small);\n }\n \n+BOOST_AUTO_TEST_CASE(key_key_negation)\n+{\n+    CKey key = DecodeSecret(strSecret1C);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r268893196",
      "id" : 268893196,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODg5MzE5Ng==",
      "original_commit_id" : "dd6c1b61be9d490a3f34a5c6801edfaabc30d9a9",
      "original_position" : 6,
      "path" : "src/test/key_tests.cpp",
      "position" : 14,
      "pull_request_review_id" : 218632097,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047",
      "updated_at" : "2019-03-26T17:07:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268893196",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r268894881"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268894881"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think shorter-length HMAC_HKDF can be obtained by truncating the output of a longer-length one. So you could take all of the RFC's test vectors and truncate them to 32 bytes?",
      "commit_id" : "acf3debc6a2f8b80a5de1e71bc658086c6de77b4",
      "created_at" : "2019-03-25T23:33:58Z",
      "diff_hunk" : "@@ -524,6 +525,16 @@ BOOST_AUTO_TEST_CASE(chacha20_testvector)\n                  \"fab78c9\");\n }\n \n+BOOST_AUTO_TEST_CASE(hkdf_hmac_sha256_l32_tests)\n+{\n+    // rfc5869 has no test vectors for HMAC_SHA256 length 32, the one below was created with python HKDF and compared against openssl",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r268894881",
      "id" : 268894881,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODg5NDg4MQ==",
      "original_commit_id" : "32633ff159b230578ac8e2c60c2061d1dc1a80b1",
      "original_position" : 22,
      "path" : "src/test/crypto_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 218632097,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047",
      "updated_at" : "2019-03-26T17:07:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268894881",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r269218336"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/269218336"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good idea. Followed @sipa's advice and changed to the 3 rfc5869 SHA256 test vectors (truncated OKM to 32 bytes).",
      "commit_id" : "acf3debc6a2f8b80a5de1e71bc658086c6de77b4",
      "created_at" : "2019-03-26T17:09:36Z",
      "diff_hunk" : "@@ -524,6 +525,16 @@ BOOST_AUTO_TEST_CASE(chacha20_testvector)\n                  \"fab78c9\");\n }\n \n+BOOST_AUTO_TEST_CASE(hkdf_hmac_sha256_l32_tests)\n+{\n+    // rfc5869 has no test vectors for HMAC_SHA256 length 32, the one below was created with python HKDF and compared against openssl",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r269218336",
      "id" : 269218336,
      "in_reply_to_id" : 268894881,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2OTIxODMzNg==",
      "original_commit_id" : "32633ff159b230578ac8e2c60c2061d1dc1a80b1",
      "original_position" : 22,
      "path" : "src/test/crypto_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 219038660,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047",
      "updated_at" : "2019-03-26T17:09:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/269218336",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r269218675"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/269218675"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point. Extended the test to cover the double negation signature comparison.",
      "commit_id" : "acf3debc6a2f8b80a5de1e71bc658086c6de77b4",
      "created_at" : "2019-03-26T17:10:15Z",
      "diff_hunk" : "@@ -188,4 +188,14 @@ BOOST_AUTO_TEST_CASE(key_signature_tests)\n     BOOST_CHECK(found_small);\n }\n \n+BOOST_AUTO_TEST_CASE(key_key_negation)\n+{\n+    CKey key = DecodeSecret(strSecret1C);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14047#discussion_r269218675",
      "id" : 269218675,
      "in_reply_to_id" : 268893196,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2OTIxODY3NQ==",
      "original_commit_id" : "dd6c1b61be9d490a3f34a5c6801edfaabc30d9a9",
      "original_position" : 6,
      "path" : "src/test/key_tests.cpp",
      "position" : 14,
      "pull_request_review_id" : 219039070,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14047",
      "updated_at" : "2019-03-26T17:10:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/269218675",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   }
]
