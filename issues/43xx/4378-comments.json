[
   {
      "body" : "Appears functional with a quick test. Was able to bind two different ports and have clients connected to each, an intentionally misbehaving node on the whitelisted interface was not banned. Would it be sensible to show this as a line in `getpeerinfo` as well?",
      "created_at" : "2014-06-21T14:41:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46755330",
      "id" : 46755330,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T14:41:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46755330",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7950218?v=3",
         "events_url" : "https://api.github.com/users/dsnark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dsnark/followers",
         "following_url" : "https://api.github.com/users/dsnark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dsnark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dsnark",
         "id" : 7950218,
         "login" : "dsnark",
         "organizations_url" : "https://api.github.com/users/dsnark/orgs",
         "received_events_url" : "https://api.github.com/users/dsnark/received_events",
         "repos_url" : "https://api.github.com/users/dsnark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dsnark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dsnark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dsnark"
      }
   },
   {
      "body" : "Comments:\r\n* Code review ACK\r\n* Agree w/ @dsnark that showing \"I'm whitelisted\" in getpeerinfo would be nice\r\n* -whitebind looks correct, but makes me nervous.  Was this a requested feature?  An IP address whitelist is consciously built, while a -whitebind port _hopes_ the whitelist is consciously built elsewhere.\r\n\r\nIt seems easier for sysadmins, etc. to make a bad mistake with -whitebind, even though it might seem more convenient at first.\r\n",
      "created_at" : "2014-06-21T14:43:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46755391",
      "id" : 46755391,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T14:43:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46755391",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "@jgarzik `-whitelist` just is not enough when you have both trusted and untrusted local services running. Right now, we're unable to perform DoS banning on hidden service peers because they appear to be coming from localhost.",
      "created_at" : "2014-06-21T14:57:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46755780",
      "id" : 46755780,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T14:57:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46755780",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Added 'whitelisted' to `getpeerinfo`.",
      "created_at" : "2014-06-21T15:08:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46756044",
      "id" : 46756044,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T15:08:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46756044",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@dsnark Thanks for testing!",
      "created_at" : "2014-06-21T15:09:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46756073",
      "id" : 46756073,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T15:09:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46756073",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Agree that is an issue, but this is still adding a Big Ole Security Exemption.  I would suggest inverting the problem, to achieve a more secure result:\r\n\r\n* Add -torbind (-shadybind?), where all incoming connections are untrusted, and point Tor hidden service at this port\r\n* Mark connections coming into this port with a special taint flag, so that they _cannot_ be whitelisted\r\n\r\nI think it would be useful to distinguish between localhost and Tor in any case.  Another useful side effect of \"inverting the problem in a more secure way.\"\r\n",
      "created_at" : "2014-06-21T15:10:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46756084",
      "id" : 46756084,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T15:10:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46756084",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Interesting idea, but I'm not sure I like the double exception behavior of \"normally peers are subjected to DoS banning, UNLESS they are whitelisted, which happens when they're in a whitelisted range, UNLESS they are connecting to shadybind.\"",
      "created_at" : "2014-06-21T15:24:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46756420",
      "id" : 46756420,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T15:24:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46756420",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Fundamentally, it is still adding a \"default: insecure\" feature where the only justification for such insecurity is not a use case, a user request, but an implementation artifact (\"that's how our code works\").\r\n\r\nBased on the problem description, it sounds like the needs are\r\n* -whitelist\r\n* -torbind\r\n* Fix our stupid DoS code, so that bitcoind can recognize that -torbind nodes have a second level hierarchy, and we need to DoS-ban a single Tor peer, not _all of Tor_.\r\n\r\nWe should not add -whitebind insecurity just because our DoS banning code is too stupid to figure out how to ban a single Tor node.\r\n",
      "created_at" : "2014-06-21T15:33:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46756654",
      "id" : 46756654,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T15:33:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46756654",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "> we need to DoS-ban a single Tor peer, not all of Tor.\r\n\r\nIf the peers are connected to a Hidden Service they *can't* be identified due to the design of the network, they'll always be localhost. I don't see a way around that outside of just not allowing HS peers. ",
      "created_at" : "2014-06-21T15:48:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46757051",
      "id" : 46757051,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T15:56:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46757051",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7950218?v=3",
         "events_url" : "https://api.github.com/users/dsnark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dsnark/followers",
         "following_url" : "https://api.github.com/users/dsnark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dsnark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dsnark",
         "id" : 7950218,
         "login" : "dsnark",
         "organizations_url" : "https://api.github.com/users/dsnark/orgs",
         "received_events_url" : "https://api.github.com/users/dsnark/received_events",
         "repos_url" : "https://api.github.com/users/dsnark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dsnark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dsnark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dsnark"
      }
   },
   {
      "body" : "@dsnark You must consider the design of Tor + bitcoin, not just Tor alone.\r\n",
      "created_at" : "2014-06-21T15:55:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46757219",
      "id" : 46757219,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T15:55:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46757219",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "@dsnark You're absolutely right... I didn't think about that.\r\n\r\nStill, we want to at least be able to disconnect a misbehaving Tor peer, and not exclude them from DoS banning just because they seem to be connecting from localhost. However, it's not as simple as this patch, as we need also a way to not ban 127.0.0.1.",
      "created_at" : "2014-06-21T15:55:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46757236",
      "id" : 46757236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T15:55:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46757236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@jgarzik Not disagreeing with you, but I'm not sure that potential security exception weighs up against the more complex semantics.\r\n\r\nI'll wait for some more opinions.",
      "created_at" : "2014-06-21T18:32:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46761185",
      "id" : 46761185,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T18:32:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46761185",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@jgarzik In a lot of places the network security policy is implemented elsewhere, blocking that is annoying. The harm of being whitelisted inappropriately is also smallÃ¢ÂÂ  though I'm a little worried that the unconditional relaying is a little bit too powerful... since it does make you into a blind attack multiplier.\r\n\r\nThis is also a little coarse in that immunity from ban is not the same as immunity from disconnection.  I think localhost should still remain immune from banning, without being immune from disconnection. (disconnection suffers no overkill)\r\n",
      "created_at" : "2014-06-21T20:54:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46764543",
      "id" : 46764543,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-21T20:54:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46764543",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "So, two solutions:\r\n* Either adding special logic for localhost again to prevent it from being banned (even though connections from it may be DoS disconnected) [implemented now in this PR, as it was trivial]\r\n* Or add Jeff's suggested `-shadybind`, and give it that the extra logic of never banning.\r\n\r\nAlso new suggested names: `-trusted` and `-trustedbind` (instead of `-whitelist` and `-whitebind`). `-shadybind` then becomes `-untrustedbind`.",
      "created_at" : "2014-06-22T15:29:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46783928",
      "id" : 46783928,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-22T15:29:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46783928",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@gmaxwell There is still the setInventoryKnown caching. One single inv will never be announced twice to the same peer (unless the setInventoryKnown cache overflows and is pruned). The largest advantage to rebroadcasts is that it does relay to new peers since the previous broadcast.",
      "created_at" : "2014-06-22T15:39:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46784230",
      "id" : 46784230,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-22T15:39:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46784230",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4378_95b5f1961edb7a8b393d1cb298de7756621da20d for binaries and test log.\r\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\r\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-06-22T16:10:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46785092",
      "id" : 46785092,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-22T16:14:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46785092",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "A third thought:  extend the whitelist interface so that an ACL entry can specify the port that it was connected _to_, then instead of trusted bind you'd be able to just bind multiple ports and write whitelist entries like 0/0:1234.\r\n\r\nI still suspect that special casing localhost to prevent banning is something we want to do, even for onion peers. Banning all onion peers because one behaves is the wrong behavior (and creates a vulnerability where we currently have none: a single trouble maker could turn off bitcoin on tor cheaply, in order to be able to deanonymize users when they drop off tor to get things working).\r\n",
      "created_at" : "2014-06-22T23:44:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-46796567",
      "id" : 46796567,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-22T23:44:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46796567",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Extending the ACLs to include what port/interface it is connected to sounds like feature creep to me. Too much work to maintain and test all that.\r\n\r\nIn cases such advanced configurability is needed I suggest using the host firewall combined with `trustedbind` to control access to a specific port.\r\n",
      "created_at" : "2014-06-25T08:14:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-47072597",
      "id" : 47072597,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-25T08:15:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47072597",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "For as long as anti-DoS policy involves the notion of banning peers, it won't be completely compatible with Tor either via hidden services or exit nodes. We can still use Tor when it works and hope that some attacker that is willing to very noisily interfere with the entire network to force people back onto the clearnet doesn't come along.\r\n\r\nEventually perhaps we'll have an alternative strategy that doesn't rely on bans, which anyway aren't really effective with large a enough botnet. Until then I don't think we should hold up this kind of nice improvement on the behalf of Tor.",
      "created_at" : "2014-06-27T10:09:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-47327851",
      "id" : 47327851,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-06-27T10:09:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47327851",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/971089?v=3",
         "events_url" : "https://api.github.com/users/mikehearn/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mikehearn/followers",
         "following_url" : "https://api.github.com/users/mikehearn/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mikehearn/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mikehearn",
         "id" : 971089,
         "login" : "mikehearn",
         "organizations_url" : "https://api.github.com/users/mikehearn/orgs",
         "received_events_url" : "https://api.github.com/users/mikehearn/received_events",
         "repos_url" : "https://api.github.com/users/mikehearn/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mikehearn/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mikehearn/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mikehearn"
      }
   },
   {
      "body" : "Rebased.",
      "created_at" : "2014-07-09T16:12:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-48496708",
      "id" : 48496708,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-07-09T16:12:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48496708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4378_dc942e6f276b9fabc21f06d11cd16871d4054f82/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-07-09T19:01:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-48519339",
      "id" : 48519339,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-07-09T19:01:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48519339",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "ACK",
      "created_at" : "2014-07-10T06:11:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#issuecomment-48568647",
      "id" : 48568647,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4378",
      "updated_at" : "2014-07-10T06:11:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48568647",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4378#discussion_r14980981"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14980981"
         }
      },
      "body" : "Why? This will cause any misbehaviour that is equal to or greater than the threshold set to cause the node to never be disconnected!",
      "commit_id" : "dc942e6f276b9fabc21f06d11cd16871d4054f82",
      "created_at" : "2014-07-16T04:35:45Z",
      "diff_hunk" : "@@ -1425,7 +1425,8 @@ void Misbehaving(NodeId pnode, int howmuch)\n         return;\n \n     state->nMisbehavior += howmuch;\n-    if (state->nMisbehavior >= GetArg(\"-banscore\", 100))\n+    int banscore = GetArg(\"-banscore\", 100);\n+    if (state->nMisbehavior >= banscore && state->nMisbehavior - howmuch < banscore)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#discussion_r14980981",
      "id" : 14980981,
      "original_commit_id" : "dc942e6f276b9fabc21f06d11cd16871d4054f82",
      "original_position" : 15,
      "path" : "src/main.cpp",
      "position" : 15,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4378",
      "updated_at" : "2014-07-16T04:35:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14980981",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4378#discussion_r14998223"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4378"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14998223"
         }
      },
      "body" : "As I pointed out in #4378 this isn't the case. (though I'm glad you're reading the code!)",
      "commit_id" : "dc942e6f276b9fabc21f06d11cd16871d4054f82",
      "created_at" : "2014-07-16T13:55:28Z",
      "diff_hunk" : "@@ -1425,7 +1425,8 @@ void Misbehaving(NodeId pnode, int howmuch)\n         return;\n \n     state->nMisbehavior += howmuch;\n-    if (state->nMisbehavior >= GetArg(\"-banscore\", 100))\n+    int banscore = GetArg(\"-banscore\", 100);\n+    if (state->nMisbehavior >= banscore && state->nMisbehavior - howmuch < banscore)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4378#discussion_r14998223",
      "id" : 14998223,
      "original_commit_id" : "dc942e6f276b9fabc21f06d11cd16871d4054f82",
      "original_position" : 15,
      "path" : "src/main.cpp",
      "position" : 15,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4378",
      "updated_at" : "2014-07-16T13:55:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14998223",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   }
]
