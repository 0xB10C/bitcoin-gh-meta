[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Some of this sounds like it could be broken or unintential. Having balances updated multiple times a second is by design, but could I think could easily improved by only repeating computation when contents of mapWallet changes. (I'd like to see this because the polling causes a ridculous amount of spam in #10102 IPC logs.)\r\n\r\nThe trace showing lots of calls to LookupBlockIndex is suprising to me because generally balances are cached, so I'm not sure why they aren't being cached in this case. It could be interesting to look into. Also #15931 will prevent the repeated LookupBlockIndex calls regardless of other things.",
      "created_at" : "2019-09-06T16:17:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16815#issuecomment-528918855",
      "id" : 528918855,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16815",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyODkxODg1NQ==",
      "updated_at" : "2019-09-06T16:17:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/528918855",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> generally balances are cached\r\n\r\nI just tried running `bitcoin-cli getbalance` 10 times in a row quickly. It looped through all my transactions and summed them 10 times.\r\n\r\nDo you have an example of an operation that uses a cached balance instead of recalculating it every time please? I'd like to look into this and see why the cache isn't being used, but I'm not having any success finding the cache!",
      "created_at" : "2019-09-07T01:24:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16815#issuecomment-529059251",
      "id" : 529059251,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16815",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyOTA1OTI1MQ==",
      "updated_at" : "2019-09-07T01:24:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/529059251",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/573356?v=4",
         "events_url" : "https://api.github.com/users/dooglus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dooglus/followers",
         "following_url" : "https://api.github.com/users/dooglus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dooglus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dooglus",
         "id" : 573356,
         "login" : "dooglus",
         "node_id" : "MDQ6VXNlcjU3MzM1Ng==",
         "organizations_url" : "https://api.github.com/users/dooglus/orgs",
         "received_events_url" : "https://api.github.com/users/dooglus/received_events",
         "repos_url" : "https://api.github.com/users/dooglus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dooglus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dooglus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dooglus"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The balances are cached per transaction, AFAIK, not at the wallet level.",
      "created_at" : "2019-09-07T01:36:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/16815#issuecomment-529060275",
      "id" : 529060275,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16815",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUyOTA2MDI3NQ==",
      "updated_at" : "2019-09-07T01:36:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/529060275",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
