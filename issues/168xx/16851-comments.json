[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This is particularly useful with support for package relay, see #16401.\r\n\r\nIt would be possible to go a bit further and drop mapRelay entirely; but we want to delay relaying transactions until we've inv'ed them, and currently we use mapRelay for that logic -- ie, we receive a tx, add it to setInventoryTxToSend, wait for a random poisson delay, INV the tx to a peer, add it to mapRelay, and only then are we willing to relay the tx. The poisson delay maxes out at about 3 minutes, so any tx that's been around for <15m is either to new to relay, or is already in mapRelay.\r\n\r\nIdeally we would have some per-peer logic so that we only relay new txs to peer X if we've INV'ed the tx to peer X; but saving that work for a different PR in order to keep this one simple.",
      "created_at" : "2019-09-11T05:14:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16851#issuecomment-530222619",
      "id" : 530222619,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16851",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMDIyMjYxOQ==",
      "updated_at" : "2019-09-11T05:14:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/530222619",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK, will test.\r\n\r\nI believe this will be useful even without package relay -- whenever a node starts up with an empty (or stale) mempool, transactions with parents fail to make it into the mempool because our peers won't serve parents that were previously relayed.\r\n\r\nBut I would also like this bug to be fixed as soon as possible, so that a package-acceptance scheme like what I'm proposing in #16401 is immediately useful, even before proposing a p2p protocol extension for package relay.",
      "created_at" : "2019-09-11T17:56:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16851#issuecomment-530493789",
      "id" : 530493789,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16851",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMDQ5Mzc4OQ==",
      "updated_at" : "2019-09-11T17:56:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/530493789",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 7b2dbf9e4bdbacd16ccd4923a6ebf4f93d7a799b\r\n\r\nI ran a new node connected only to a node running this patch, and observed that as transaction relay started (after IBD) that the node started receiving orphan transactions that were then accepted to the mempool after the parents were fetched. ",
      "created_at" : "2019-09-11T20:13:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16851#issuecomment-530546674",
      "id" : 530546674,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16851",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMDU0NjY3NA==",
      "updated_at" : "2019-09-11T20:13:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/530546674",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK\r\n\r\nI don't think so, but asking for sake of completeness: this will not affect privacy (fingerprinting) negatively, will it?",
      "created_at" : "2019-09-12T10:03:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16851#issuecomment-530756972",
      "id" : 530756972,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16851",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMDc1Njk3Mg==",
      "updated_at" : "2019-09-12T10:03:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/530756972",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I don't think so, but asking for sake of completeness: this will not affect privacy (fingerprinting) negatively, will it?\r\n\r\nI don't think so; I think you can already tell if tx \"X\" is in a peer's mempool by constructing a tx with \"X:0\" and \"Y:0\" as inputs (Y being a non-existent txid, providing invalid sigs for both, relies on X being rbf'able or X:0 not being spent yet), and see if they request both X and Y or just Y.",
      "created_at" : "2019-09-12T12:05:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16851#issuecomment-530794255",
      "id" : 530794255,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16851",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzMDc5NDI1NQ==",
      "updated_at" : "2019-09-12T12:05:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/530794255",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   }
]
