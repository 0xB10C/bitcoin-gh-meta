[
   {
      "body" : "As pointed out elsewhere, we first need a means to distinguish pruned nodes from nodes that don't relay/verify at all.",
      "created_at" : "2016-08-24T07:14:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8572#issuecomment-241977073",
      "id" : 241977073,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8572",
      "updated_at" : "2016-08-24T07:14:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/241977073",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa Why \"first\"? Yes, I agree that we need this, but how is banning useful pruning nodes a way forward?",
      "created_at" : "2016-08-24T07:16:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8572#issuecomment-241977624",
      "id" : 241977624,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8572",
      "updated_at" : "2016-08-24T07:16:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/241977624",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "And anyway, there's nothing to stop a node advertising as NODE_NETWORK yet not relaying/verifying, so simply banning nodes that don't set NODE_NETWORK is 0% reliable, isn't it?",
      "created_at" : "2016-08-24T07:18:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8572#issuecomment-241977935",
      "id" : 241977935,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8572",
      "updated_at" : "2016-08-24T07:18:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/241977935",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "We're always relying on having at least one homest peer.\n\nIt was completely intentional that pruning nodes would not be connected to,\nas we had no means in the protocol to advertize\nfull-node-but-no-old-blocks. Several suggestions for this have been made,\nbut there are several issues that make it difficult. Perhaps it is time to\nrestart that discussion.\n",
      "created_at" : "2016-08-24T07:24:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8572#issuecomment-241979131",
      "id" : 241979131,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8572",
      "updated_at" : "2016-08-24T07:24:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/241979131",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Also this commit should just be change the requires services flags, not removing the check.",
      "created_at" : "2016-08-24T08:33:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8572#issuecomment-241994465",
      "id" : 241994465,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8572",
      "updated_at" : "2016-08-24T08:33:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/241994465",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "@pstratem I thought of that - an equally valid place to change it, IMHO\r\n\r\n@sipa Where is the right place to have that discussion? I guess the other place to \"fix\" this is to change it so that pruning nodes still advertise as NODE_NETWORK. Perhaps that is a better solution, and then upon connection the node can establish how far back its blocks go. Storing the services bits in the address database was a nice idea - perhaps it can also store additional services which aren't also stored in the services version messages, such as whether a node is pruned, and use this bit instead of the NODE_NETWORK bit currently being used. If this is an ok idea, I can go ahead and create a pull for this functionality (unless someone else wants to do it).\r\n\r\nI'm currently working on some other changes which can better determine what value a node is providing, such as whether it's giving usful txs, speedily delivering blocks etc, and then could use this in determining when to evict outgoing connections (in a similar way to the incoming connections evictions but based on different parameters). I'd ideally like to be able to display some of these metrics in the Peers Debug pane, but I'm not up to speed enough on Qt to program this and anyway, I think a webpage would be a better way to display it as that could also be served by bitcoind too.",
      "created_at" : "2016-08-24T09:48:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8572#issuecomment-242011559",
      "id" : 242011559,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8572",
      "updated_at" : "2016-08-24T09:51:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/242011559",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "@rebroad Pruning nodes can't advertize NODE_NETWORK, because NODE_NETWORK implies they can serve old blocks.\r\n\r\nWe can have a discussion on the mailing list about new flags or means to advertize what ranges a node has available for download. I believe this PR is in error though - it tries to incorrectly change something that is by design. NACK.",
      "created_at" : "2016-08-24T17:02:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8572#issuecomment-242137422",
      "id" : 242137422,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8572",
      "updated_at" : "2016-08-24T17:02:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/242137422",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "\"banning useful pruning nodes a way forward\", please be more careful with your comments. It doesn't ban anything here, it just doesn't connect out to them.  I can envision the headlines now, \"bitcoin core bans pruned nodes!\"-- it's just not so. :)\r\n\r\nAs mentioned in the other PR we need a service type for nodes that relay near-tip that defines how much they must retain, at a minimum. ",
      "created_at" : "2016-08-25T18:33:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8572#issuecomment-242493800",
      "id" : 242493800,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8572",
      "updated_at" : "2016-08-25T18:33:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/242493800",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   }
]
