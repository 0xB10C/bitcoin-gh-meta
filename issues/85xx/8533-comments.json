[
   {
      "body" : "utACK 24c398f",
      "created_at" : "2016-08-17T22:51:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8533#issuecomment-240573316",
      "id" : 240573316,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8533",
      "updated_at" : "2016-08-17T22:51:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/240573316",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "needs 0.13.1 milestone tag?",
      "created_at" : "2016-08-23T16:53:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8533#issuecomment-241799188",
      "id" : 241799188,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8533",
      "updated_at" : "2016-08-23T16:53:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/241799188",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8533#discussion_r75907866"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8533"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/75907866"
         }
      },
      "body" : "Could we get constants for these long hex numbers?",
      "commit_id" : "068e3e3aef62504f8bd797f42fa84b1431c21177",
      "created_at" : "2016-08-23T16:58:54Z",
      "diff_hunk" : "@@ -0,0 +1,235 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2016 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+from test_framework.test_framework import ComparisonTestFramework\n+from test_framework.util import *\n+from test_framework.mininode import CTransaction, NetworkThread, ToHex\n+from test_framework.blocktools import create_coinbase, create_block, add_witness_commitment\n+from test_framework.comptool import TestManager\n+from test_framework.script import CScript\n+from io import BytesIO\n+import time\n+\n+LOW_S_ERROR = \"64: non-mandatory-script-verify-flag (Non-canonical signature: S value is unnecessarily high)\"\n+NULLDUMMY_ERROR = \"64: non-mandatory-script-verify-flag (Dummy CHECKMULTISIG argument must be zero)\"\n+\n+def trueDummy(tx):\n+    scriptSig = CScript(tx.vin[0].scriptSig)\n+    newscript = []\n+    for i in scriptSig:\n+        if (len(newscript) == 0):\n+            assert(len(i) == 0)\n+            newscript.append(b'\\x51')\n+        else:\n+            newscript.append(i)\n+    tx.vin[0].scriptSig = CScript(newscript)\n+    tx.rehash()\n+\n+def isCanonicalSig(sig):\n+    '''\n+    A canonical signature consists of:\n+    <30> <total len> <02> <len R> <R> <02> <len S> <S> <hashtype>\n+    '''\n+    if (len(sig) < 9 or len(sig) > 73 or sig[0] != 0x30):\n+        return False\n+    if (sig[1] != len(sig) - 3):\n+        return False\n+    lenR = sig[3]\n+    if (len(sig) < 8 + lenR):\n+        return False\n+    lenS = sig[5 + lenR]\n+    if (len(sig) != lenR + lenS + 7):\n+        return False\n+    if (lenR == 0 or lenR > 33 or sig[2] != 0x02 or sig[4] & 0x80):\n+        return False\n+    if (lenS == 0 or lenS > 33 or sig[4 + lenR] != 0x02 or sig[6 + lenR] & 0x80):\n+        return False\n+    if (lenR > 1 and sig[4] == 0x00 and not sig[5] & 0x80):\n+        return False\n+    if (lenS > 1 and sig[lenS + 6] == 0x00 and not sig[lenS + 7] & 0x80):\n+        return False\n+    return True\n+\n+def highSifyTx(tx):\n+    scriptSig = CScript(tx.vin[0].scriptSig)\n+    newscript = []\n+    for i in scriptSig:\n+        if (isCanonicalSig(i)):\n+            i = highSifySig(i)\n+        newscript.append(i)\n+    tx.vin[0].scriptSig = CScript(newscript)\n+    tx.rehash()\n+\n+def highSifySig(sig):\n+    assert(isCanonicalSig(sig))\n+    rsize = sig[3]\n+    s = int.from_bytes(sig[6+rsize:-1], byteorder='big')\n+    assert(s <= 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8533#discussion_r75907866",
      "id" : 75907866,
      "original_commit_id" : "068e3e3aef62504f8bd797f42fa84b1431c21177",
      "original_position" : 69,
      "path" : "qa/rpc-tests/bip146-p2p.py",
      "position" : 69,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8533",
      "updated_at" : "2016-08-23T16:58:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/75907866",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8533#discussion_r75907920"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8533"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/75907920"
         }
      },
      "body" : "Constants for these too?",
      "commit_id" : "068e3e3aef62504f8bd797f42fa84b1431c21177",
      "created_at" : "2016-08-23T16:59:11Z",
      "diff_hunk" : "@@ -159,7 +159,25 @@ def sign(self, hash):\n         mb_sig = ctypes.create_string_buffer(sig_size0.value)\n         result = ssl.ECDSA_sign(0, hash, len(hash), mb_sig, ctypes.byref(sig_size0), self.k)\n         assert 1 == result\n-        return mb_sig.raw[:sig_size0.value]\n+        assert mb_sig.raw[0] == 0x30\n+        assert mb_sig.raw[1] == sig_size0.value - 2\n+        total_size = mb_sig.raw[1]\n+        assert mb_sig.raw[2] == 2\n+        r_size = mb_sig.raw[3]\n+        assert mb_sig.raw[4 + r_size] == 2\n+        s_size = mb_sig.raw[5 + r_size]\n+        s_value = int.from_bytes(mb_sig.raw[6+r_size:6+r_size+s_size], byteorder='big')\n+        if s_value <= 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8533#discussion_r75907920",
      "id" : 75907920,
      "original_commit_id" : "068e3e3aef62504f8bd797f42fa84b1431c21177",
      "original_position" : 13,
      "path" : "qa/rpc-tests/test_framework/key.py",
      "position" : 13,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8533",
      "updated_at" : "2016-08-23T16:59:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/75907920",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   }
]
