[
   {
      "body" : "Why do you want to make verack a no-op? It's nice to know the peer received and understood our version message before continuing.",
      "created_at" : "2016-08-26T12:39:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8597#issuecomment-242724391",
      "id" : 242724391,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8597",
      "updated_at" : "2016-08-26T12:39:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/242724391",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "NACK, this part of the protocol is not broken, let's not fix it.",
      "created_at" : "2016-08-26T14:18:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8597#issuecomment-242748079",
      "id" : 242748079,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8597",
      "updated_at" : "2016-08-26T14:18:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/242748079",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@sipa you say \"before continuing\" but this is not how the code currently works. There is no stopping or waiting for the verack currently, instead some code is simply not executed as a result of the verack not being received. That code (which is important that it runs) is what I have now moved to run upon receipt of a \"version\" message - which DOES cause the required continuation that you mention.\r\n\r\nThe githib diff doesn't show this code in question so it's not clear from the github diff.\r\n\r\nThe code in question is the sending of the SENDHEADERS and SENDCMPCT messages.\r\n\r\nTherefore if no VERACK is received the node will default to receiving INVs for block announcements and will not be using Compact Blocks - this is currently DEPENDENT on verack messages being received. Other than this the node functions the same in every other way.\r\n\r\n@laanwj If that's not considered broken then you are saying this is intentional - why do you want compact blocks and headers announcements to be dependant on verack messages? It's certainly not, IMHO, intuitive that this is how the protocol would function, based on a typical understanding of ACK messages. Headers announcements and compact block technology are recent additions so it seems a bit strange to me that only this new functionality is dependant on verack messages yet all other functionality will continue as normal without veracks.",
      "created_at" : "2016-08-28T02:45:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8597#issuecomment-242952772",
      "id" : 242952772,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8597",
      "updated_at" : "2016-08-28T02:55:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/242952772",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "@rebroad Ok, so the history behind VERACK is that it was introduced together with protocol checksums.\r\n\r\nOriginally, the protocol version started at 0, and then VERSION is used to propose by peer A that peer B can start using a higher protocol version number. Peer A however needs to know when B received that VERSION message, as he doesn't know when to start decoding the received messages using the new protocol, so the switchover to enable decoding checksums happens when B sends a VERACK back.\r\n\r\nSince february 20, 2012 the protocol version starts at 209, which has checksums from the start (including the VERSION and VERACK messages themselves).\r\n\r\nSince then, VERACK has effectively not had any function, but it should also not slow anything down, apart from sending an extra message. There may also be a use for it in the future, if we'd ever want to propose a protocol change that modifies the checksums again, or otherwise modifies the based protocol structure.\r\n\r\nDon't fix what isn't broken.",
      "created_at" : "2016-08-30T15:36:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8597#issuecomment-243481475",
      "id" : 243481475,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8597",
      "updated_at" : "2016-08-30T15:36:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/243481475",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa Thanks for that. I wouldn't be proposing this pull request if I didn't think there was something broken that it fixes. But broken is a subjective term. If you're happy with Bitcoin Core NOT requesting announcements by headers or preferrring compact blocks, then it's not broken. But given that most Bitcoin Core nodes ARE requesting these things, then it would seem broken to me.",
      "created_at" : "2016-09-01T07:16:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8597#issuecomment-243996110",
      "id" : 243996110,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8597",
      "updated_at" : "2016-09-01T07:16:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/243996110",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "You have a peer who is sending messages before sending a verack. That peer\nis broken.\n",
      "created_at" : "2016-09-01T07:36:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8597#issuecomment-244000012",
      "id" : 244000012,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8597",
      "updated_at" : "2016-09-01T07:36:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/244000012",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
