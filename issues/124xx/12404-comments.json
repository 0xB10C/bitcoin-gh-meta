[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@fanquake probably also needs \"Block storage\" label.",
      "created_at" : "2018-02-10T14:39:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-364659456",
      "id" : 364659456,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-02-10T14:39:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/364659456",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Untested ACK, would kill off #11658 and #11359.\r\n\r\nI personally don't think the detail of how much we over-or-under-prune here are that important given that the long term solution is to fix the cache such that it doesn't require a complete flush. Basically any change here will speed up pruning IBD by a large amount.",
      "created_at" : "2018-02-19T03:30:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-366581069",
      "id" : 366581069,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-02-19T03:33:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/366581069",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7999704?v=4",
         "events_url" : "https://api.github.com/users/esotericnonsense/events{/privacy}",
         "followers_url" : "https://api.github.com/users/esotericnonsense/followers",
         "following_url" : "https://api.github.com/users/esotericnonsense/following{/other_user}",
         "gists_url" : "https://api.github.com/users/esotericnonsense/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/esotericnonsense",
         "id" : 7999704,
         "login" : "esotericnonsense",
         "organizations_url" : "https://api.github.com/users/esotericnonsense/orgs",
         "received_events_url" : "https://api.github.com/users/esotericnonsense/received_events",
         "repos_url" : "https://api.github.com/users/esotericnonsense/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/esotericnonsense/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/esotericnonsense/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/esotericnonsense"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12404#discussion_r170957735"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12404"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/170957735"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Seems like this ought to be using best case...?",
      "commit_id" : "86bef23e6550cdcf989ae6ac22dbbc45bbf613e4",
      "created_at" : "2018-02-27T15:21:55Z",
      "diff_hunk" : "@@ -3570,6 +3570,9 @@ static void FindFilesToPrune(std::set<int>& setFilesToPrune, uint64_t nPruneAfte\n \n     unsigned int nLastBlockWeCanPrune = chainActive.Tip()->nHeight - MIN_BLOCKS_TO_KEEP;\n     uint64_t nCurrentUsage = CalculateCurrentUsage();\n+    // Worst case remaining block space:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#discussion_r170957735",
      "id" : 170957735,
      "original_commit_id" : "86bef23e6550cdcf989ae6ac22dbbc45bbf613e4",
      "original_position" : 4,
      "path" : "src/validation.cpp",
      "position" : 4,
      "pull_request_review_id" : 99725451,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12404",
      "updated_at" : "2018-02-27T15:21:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/170957735",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12404#discussion_r170974354"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12404"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/170974354"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Best case would be empty blocks. That would lead to a lot of flushes.",
      "commit_id" : "86bef23e6550cdcf989ae6ac22dbbc45bbf613e4",
      "created_at" : "2018-02-27T16:06:40Z",
      "diff_hunk" : "@@ -3570,6 +3570,9 @@ static void FindFilesToPrune(std::set<int>& setFilesToPrune, uint64_t nPruneAfte\n \n     unsigned int nLastBlockWeCanPrune = chainActive.Tip()->nHeight - MIN_BLOCKS_TO_KEEP;\n     uint64_t nCurrentUsage = CalculateCurrentUsage();\n+    // Worst case remaining block space:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#discussion_r170974354",
      "id" : 170974354,
      "in_reply_to_id" : 170957735,
      "original_commit_id" : "86bef23e6550cdcf989ae6ac22dbbc45bbf613e4",
      "original_position" : 4,
      "path" : "src/validation.cpp",
      "position" : 4,
      "pull_request_review_id" : 99745463,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12404",
      "updated_at" : "2018-02-27T16:06:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/170974354",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 86bef23",
      "created_at" : "2018-03-05T15:05:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-370447840",
      "id" : 370447840,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-03-05T15:05:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/370447840",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/4360349?v=4",
         "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/morcos/followers",
         "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/morcos",
         "id" : 4360349,
         "login" : "morcos",
         "organizations_url" : "https://api.github.com/users/morcos/orgs",
         "received_events_url" : "https://api.github.com/users/morcos/received_events",
         "repos_url" : "https://api.github.com/users/morcos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/morcos"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "utACK 86bef23e6550cdcf989ae6ac22dbbc45bbf613e4 ",
      "created_at" : "2018-03-11T07:54:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-372096476",
      "id" : 372096476,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-03-11T07:54:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372096476",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/2734?v=4",
         "events_url" : "https://api.github.com/users/eklitzke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eklitzke/followers",
         "following_url" : "https://api.github.com/users/eklitzke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eklitzke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eklitzke",
         "id" : 2734,
         "login" : "eklitzke",
         "organizations_url" : "https://api.github.com/users/eklitzke/orgs",
         "received_events_url" : "https://api.github.com/users/eklitzke/received_events",
         "repos_url" : "https://api.github.com/users/eklitzke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eklitzke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eklitzke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased due to release notes change.",
      "created_at" : "2018-03-12T21:03:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-372461667",
      "id" : 372461667,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-03-12T21:03:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/372461667",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased due to release notes change.",
      "created_at" : "2018-03-26T16:29:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-376227776",
      "id" : 376227776,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-03-26T16:29:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/376227776",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "`p2p_leak.py` failure on Travis seems a bit random (and passes on my local machine)...",
      "created_at" : "2018-03-26T18:17:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-376262277",
      "id" : 376262277,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-03-26T18:18:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/376262277",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 82efbf1e8ac67ad9d04cba9b64cb79ece86209f8",
      "created_at" : "2018-03-27T04:00:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-376389718",
      "id" : 376389718,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-03-27T04:00:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/376389718",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/2734?v=4",
         "events_url" : "https://api.github.com/users/eklitzke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/eklitzke/followers",
         "following_url" : "https://api.github.com/users/eklitzke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/eklitzke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/eklitzke",
         "id" : 2734,
         "login" : "eklitzke",
         "organizations_url" : "https://api.github.com/users/eklitzke/orgs",
         "received_events_url" : "https://api.github.com/users/eklitzke/received_events",
         "repos_url" : "https://api.github.com/users/eklitzke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/eklitzke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/eklitzke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Before merging, please remove the name and PR reference from the commit message, so it doesn't ping us every time someone adds it to their random fork.",
      "created_at" : "2018-03-31T20:26:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-377721048",
      "id" : 377721048,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-03-31T20:26:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/377721048",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "I found this web in my cache log why ?\n\nOn Sat, Mar 31, 2018, 4:27 PM Luke Dashjr <notifications@github.com> wrote:\n\n> Before merging, please remove the name and PR reference from the commit\n> message, so it doesn't ping us every time someone adds it to their random\n> fork.\n>\n> Ã¢ÂÂ\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-377721048>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AkND8slkw6vU8yLJBAdXMe9z10A-G6ddks5tj-bLgaJpZM4SA7zL>\n> .\n>\n",
      "created_at" : "2018-03-31T20:34:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-377721527",
      "id" : 377721527,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-03-31T20:34:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/377721527",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/37962738?v=4",
         "events_url" : "https://api.github.com/users/neverstopthegrind1/events{/privacy}",
         "followers_url" : "https://api.github.com/users/neverstopthegrind1/followers",
         "following_url" : "https://api.github.com/users/neverstopthegrind1/following{/other_user}",
         "gists_url" : "https://api.github.com/users/neverstopthegrind1/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/neverstopthegrind1",
         "id" : 37962738,
         "login" : "neverstopthegrind1",
         "organizations_url" : "https://api.github.com/users/neverstopthegrind1/orgs",
         "received_events_url" : "https://api.github.com/users/neverstopthegrind1/received_events",
         "repos_url" : "https://api.github.com/users/neverstopthegrind1/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/neverstopthegrind1/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/neverstopthegrind1/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/neverstopthegrind1"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@luke-jr will do. Should I also remove it from the PR description, since that also ends up in the merge commit message? Or do those merge commits rarely make it into upstream work because commits are cherry-picked?",
      "created_at" : "2018-04-03T09:43:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-378191842",
      "id" : 378191842,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-04-03T09:43:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378191842",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Done. Also: rebased for release notes.",
      "created_at" : "2018-04-03T09:49:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-378193733",
      "id" : 378193733,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-04-03T09:49:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378193733",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased so I can do some benchmarking.",
      "created_at" : "2018-05-15T11:24:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-389132783",
      "id" : 389132783,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-05-15T11:24:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/389132783",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I've been racing AWS instances for the past few days, using `master`, #11658 (rebased on master) and this PR. I use a `t2.micro` with 1 vCPU, 1 GiB RAM and 20 GB storage. I set `prune` to 10 GB, `dbcache=300` and `maxmempool=5`.\r\n\r\nAfter 72 hours master is currently at block 341909, @luke-jr's branch is at 364905 and mine is at 360719. \r\n\r\nI enabled T2 Unlimited to prevent CPU throttling, although it doesn't seem to be CPU bound beyond the first 100-200K blocks (that will change after the assumed valid block):\r\n<img width=\"882\" alt=\"schermafbeelding 2018-05-20 om 10 42 26\" src=\"https://user-images.githubusercontent.com/10217/40277140-920cbbf4-5c1a-11e8-9116-eb84bc45e4a8.png\">\r\n\r\nI tried higher values for `dbcache` but that led to out of memory crashes (sometimes during a cache flush) and once even to a machine freezing. I didn't try adding swap to prevent these crashes; I'm not sure how to manage that properly, i.e. in a way that too much swap usage doesn't end up cancelling the benefits of these caches.\r\n\r\nI'll leave them running for a bit. So far it seems clear that merging either of these PR's would be quite helpful on low-end machines, but which one is less clear. It probably depends on the choices for `dbcache` and `prune` and my guess is that machines with more RAM would benefit from pruning as aggressively as possible to minimize the number of cache flushes (but beyond ~8 GB of RAM it wouldn't matter, because it would never flush).\r\n\r\nI just started three `t2.medium` instances with 2 vCPU, using `dbcache=3000`. ",
      "created_at" : "2018-05-20T08:54:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-390467042",
      "id" : 390467042,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-05-20T10:16:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390467042",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "To clarify, is `IsInitialBlockDownload()` something that only happens once in the life time of a node, or is this also `true` if it needs to do a large catch up? If the latter, there is a case to be made for conservative pruning (or putting aggressive pruning behind a config flag).\r\n\r\nWhen you run something like c-lightning against a pruned bitcoind node, it's constantly processing blocks as they come in. A large prune event could mess with this process if for some reason the other application isn't completely caught up. This is less of a problem for the initial sync if that other application doesn't care about pre-history. E.g. c-lightning doesn't need history before its wallet creation block, so the trick there is to wait with launching it until `bitcoind` finishes IBD, and then keep them both running.\r\n\r\nBut there may be other applications that need to track some sort of index all the way through IBD where it's important they don't lose sync.",
      "created_at" : "2018-05-20T10:30:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-390471566",
      "id" : 390471566,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-05-20T10:31:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390471566",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "After a little under 24 hours the `t2.medium` instances:\r\n\r\n* master: 458269\r\n* 10% pruning: 471894\r\n* this PR: 396051\r\n\r\nNotice how this PR so far seems to perform _worse_ than master (on this instance and with these settings, still better than master on the `t2.micro` instance). I'll keep an eye on it. Maybe it has something to do with the large `dbcache`? Because of the more frequent prune events the `dbcache` doesn't grow as much on master and the 10% prune branch. See [IRC](https://botbot.me/freenode/bitcoin-core-dev/2018-05-21/?msg=100272576&page=1). Paging @eklitzke.\r\n\r\nIt would be nice to have a script that parses `debug.log` and spits out a CSV file with block height and cache size. Scrolling through the log I notice that on master cache mostly stays below 200 MB,  on the 10% pruning cache stays below 1 GB and usually under 500 MB, whereas in this PR is grows up to 2 GB.",
      "created_at" : "2018-05-21T07:49:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-390579889",
      "id" : 390579889,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-05-21T08:17:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390579889",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "```sh\r\necho \"height, cache\" > cache.csv\r\ncat ~/.bitcoin/debug.log | grep UpdateTip | awk -F'[ =M]'  '{print $7\", \" $19 }' >> cache.csv\r\n```\r\n\r\n<img width=\"1240\" alt=\"2018-05-21 10 59 05\" src=\"https://user-images.githubusercontent.com/10217/40299263-0142b50c-5ce6-11e8-9299-604f7a22f3b6.png\">\r\n\r\nI'll update the plots later.\r\n\r\n\r\nSource data and Thunderplot file: [plot.zip](https://github.com/bitcoin/bitcoin/files/2021884/plot.zip)\r\n\r\n\r\n\r\n\r\n",
      "created_at" : "2018-05-21T08:57:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-390595338",
      "id" : 390595338,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-05-21T09:03:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390595338",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This extracts block height, cache size and a unix timestamp from the log: \r\n```sh\r\ncat prune300_master.log | grep UpdateTip | gawk -F'[ =M]'  '{print $7\", \" $19\", \" gsub(/[-T:Z]/,\" \") \", \" mktime($1 \" \" $2 \" \" $3 \" \" $4 \" \" $5 \" \" $6)  }' >> prune300_master.csv\r\n```\r\n\r\nIBD duration with dbcache=300MB: \r\n\r\n<img width=\"806\" alt=\"2018-05-25 17 39 59\" src=\"https://user-images.githubusercontent.com/10217/40553385-c32fec52-6042-11e8-8412-280056fcaa19.png\">\r\n\r\nVertical access is in days. They ran for more than a week but didn't finish. The 10% prune strategy (green line) was the fastest, master the slowest.\r\n\r\nCache usage:\r\n\r\n<img width=\"769\" alt=\"2018-05-25 17 40 18\" src=\"https://user-images.githubusercontent.com/10217/40553386-c34a7e28-6042-11e8-9829-9b6c0e328229.png\">\r\n\r\nBoth strategies use more cache than master, but don't differ much for such a small dbcache.\r\n\r\nIBD duration with dbcache=300MB: \r\n<img width=\"820\" alt=\"2018-05-25 17 40 25\" src=\"https://user-images.githubusercontent.com/10217/40553388-c366d172-6042-11e8-8575-c25e4986ce50.png\">\r\n\r\nThe 10% pruning strategy (green) was the only one that finished IBD before I gave up. This PR (red line) is dramatically slower than even master.\r\n\r\nCache usage:\r\n<img width=\"793\" alt=\"2018-05-25 17 40 31\" src=\"https://user-images.githubusercontent.com/10217/40553389-c38792c2-6042-11e8-814e-07d1dee107be.png\">\r\n\r\nBoth strategies use more cache than master. Aggressive pruning uses way more cache, but for some reason that seems to make things worse.\r\n\r\n",
      "created_at" : "2018-05-25T15:44:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-392099372",
      "id" : 392099372,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "updated_at" : "2018-05-25T15:44:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/392099372",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "FYI on AWS been running a node with 4gig RAM and sc1 disks (very cheap - 0.025/GigMonth) for a node with txindex on and keeps up fine (i.e. does not use burst allowance). Is used by a lightning node so get reasonable number of rpc requests. Is useless for IBD, but can set to SSD initially then once IBD done switch to sc1 with the click of a button!",
      "created_at" : "2018-05-31T09:15:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-393468440",
      "id" : 393468440,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5MzQ2ODQ0MA==",
      "updated_at" : "2018-05-31T09:15:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/393468440",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/1016563?v=4",
         "events_url" : "https://api.github.com/users/n1bor/events{/privacy}",
         "followers_url" : "https://api.github.com/users/n1bor/followers",
         "following_url" : "https://api.github.com/users/n1bor/following{/other_user}",
         "gists_url" : "https://api.github.com/users/n1bor/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/n1bor",
         "id" : 1016563,
         "login" : "n1bor",
         "node_id" : "MDQ6VXNlcjEwMTY1NjM=",
         "organizations_url" : "https://api.github.com/users/n1bor/orgs",
         "received_events_url" : "https://api.github.com/users/n1bor/received_events",
         "repos_url" : "https://api.github.com/users/n1bor/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/n1bor/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/n1bor/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/n1bor"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@n1bor for [my own project on AWS](https://medium.com/provoost-on-crypto/bitcoin-core-lightning-rails-on-aws-ad3bd45b11e0), I also use the strategy of doing IBD on a fast machine (`i3.2xlarge`). Anything with > 10 GB RAM to prevent the cache from flushing and a disk big enough to avoid pruning (doesn't have to be SSD). The bigger disk is ephemeral and goes away after you downgrade to a regular instance type, so I do a manual prune at the end and copy the data to the persistent disk.\r\n\r\nI'll look into [Cold HDD (sc1) Volumes](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSVolumeTypes.html#EBSVolumeTypes_sc1) for that project, because it `c-lightning` doesn't fully love pruned nodes yet, but that's off topic...\r\n\r\nBut you don't have that luxury on a physical machine like the various [Rasberry / Orange / Nano] Pi's out there. So it's quite useful if IBD performed better on a constrained machines. Also, even that price point pruning still saves $5 a month in storage at the current chain size.",
      "created_at" : "2018-05-31T10:00:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12404#issuecomment-393480892",
      "id" : 393480892,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12404",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5MzQ4MDg5Mg==",
      "updated_at" : "2018-05-31T10:00:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/393480892",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
