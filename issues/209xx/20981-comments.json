[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Some of the previously proposed USDTs by @jb55 from #19866:\r\n\r\n#### `net:push_message`\r\n  - traces all sent P2P messages as TRACE5:\r\n    - `int node_id`\r\n    - `char* node_addr`\r\n    - `char* msg_type`\r\n    - `size_t msg_size`\r\n    - `uint8_t* msg_data`\r\n\r\n \r\n https://github.com/bitcoin/bitcoin/blob/7d8a10a6f4d61df1f4afb138e379149565afa02d/src/net.cpp#L3001\r\n \r\n ---\r\n\r\n#### `net:process_message`\r\nTraces all received P2P messages as TRACE5:\r\n  - `int node_id`\r\n  - `char* node_addr`\r\n  - `char* msg_type`\r\n  - `size_t msg_size`\r\n  - `uint8_t* msg_data`\r\n    \r\nhttps://github.com/bitcoin/bitcoin/blob/7d8a10a6f4d61df1f4afb138e379149565afa02d/src/net_processing.cpp#L3812\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/19866 has an example bpftrace script using  `net:process_message` and `net:push_message`.\r\n\r\n---\r\n\r\n#### `validation:connect_block`\r\nTraces all blocks for which ConnectBlock() is called as TRACE4:\r\n  - `uint32 height`\r\n  - `int tx_count`\r\n  - `uint8_t[32] hash`\r\n  - `uint8_t[32] prevhash`\r\n  - (more header fields?)\r\n\r\nPassing the full serialized block is not possible as this could be bigger than both the bcc and bftrace stack (the kernel VM crashes gracefully, no stack overflow). While the serialized block header would not be bigger than the stack size, header serialization would need to happen even when no USDTs are attached. This has an performance impact and should not be done.  \r\n\r\n@jb55 used an earlier version of `validation:connect_block` to measure IBD performance.  \r\n\r\nDepending on placement in `ConnectBlock()`, this could either trace to-be-connected blocks or connected blocks (no error while connecting). In either way, the documentation should make it clear for which blocks the data is passed. \r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/7d8a10a6f4d61df1f4afb138e379149565afa02d/src/validation.cpp#L1946",
      "created_at" : "2021-01-23T15:03:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-766092705",
      "id" : 766092705,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NjA5MjcwNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-23T15:06:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/766092705",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@laanwj [mentioned](https://github.com/bitcoin/bitcoin/pull/19866#issuecomment-687336319) that traces for dis- and connections of peers would be useful too. I'll have a look where these could be placed. I guess there are some places where there is already `net` debug logging which can be used for orientation. @jlopp's statoshi diff could be helpful to look at too. \r\n\r\nAlso interesting:\r\n- function timings, like [statoshi.info/function-timings](https://statoshi.info/dashboard/db/function-timings) for block and transaction validation functions\r\n- tracing fee estimation\r\n\r\n\r\n\r\n  ",
      "created_at" : "2021-01-23T15:27:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-766096054",
      "id" : 766096054,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NjA5NjA1NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-23T15:27:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/766096054",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">  @jlopp's statoshi diff could be helpful to look at too.\r\n\r\nFWIW the statoshi diff can be found here: https://github.com/jlopp/statoshi/compare/1b90a7b61a37d450bbe5b485dcc9b8c591567e0d..28b88353a78ae19e3c5379bbda6b72f4fef65a8c",
      "created_at" : "2021-01-24T19:42:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-766419687",
      "id" : 766419687,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NjQxOTY4Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-24T19:42:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/766419687",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "\n\"Wladimir J. van der Laan\" <notifications@github.com> writes:\n>>  @jlopp's statoshi diff could be helpful to look at too.\n>\n> FWIW the statoshi diff can be found here: https://github.com/jlopp/statoshi/compare/1b90a7b61a37d450bbe5b485dcc9b8c591567e0d..28b88353a78ae19e3c5379bbda6b72f4fef65a8c\n\nI was looking at this a long time ago. In theory you could get the same\nfunctionality as statoshi (stats gathering via prometheus) with \nhttps://github.com/cloudflare/ebpf_exporter\n\nWould be an interesting project.\n",
      "created_at" : "2021-01-25T23:07:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-767170859",
      "id" : 767170859,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NzE3MDg1OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-25T23:07:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/767170859",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Would be an interesting project.\r\n\r\nI agree! This would be my preferred way to do this kind of reporting, to be honest. It'd flexible and built into the operating system. It has low impact on the code and low impact on performance. It could potentially work for all software.\r\n\r\nOne reason Statoshi never got merged is because it's just too much hassle to integrate and maintain a Bitcoin Core specific framework for this. Not because it's not a great thing to have.",
      "created_at" : "2021-01-26T11:53:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-767493889",
      "id" : 767493889,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NzQ5Mzg4OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-26T11:54:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/767493889",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Besides networking, one major thing that would be interesting to monitor through tracepoints is dbcache usage. This is useful to get metrics for hardware optimization of validation (e.g. to find where bottlenecks are). A few things come to mind:\r\n\r\n- Gross statistics on changes (this is in the log but it's good to have a well defined interface for it)\r\n  - how much memory is used of how much\r\n  - how many UTXOs are cached\r\n- Before/afters for timing:\r\n  - Insertions and deletions of UTXOs in the CoinsCache with associated information\r\n  - Queries: hits and misses\r\n  - Flushes\r\n",
      "created_at" : "2021-03-19T09:34:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-802688809",
      "id" : 802688809,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgwMjY4ODgwOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-19T09:34:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/802688809",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "On Fri, Mar 19, 2021 at 02:34:27AM -0700, W. J. van der Laan wrote:\n>Besides networking, one major thing that would be interesting to monitor through tracepoints is dbcache usage. This is useful to get metrics for hardware optimization of validation (e.g. to find where bottlenecks are). A few things come to mind:\n>\n>  - how much memory is used of how much\n\nI've been using heaptrack[1] for memory tracing, it hooks into malloc calls which saves us from putting allocation traces everywhere.\n\n>- Gross statistics on changes (this is in the log but it's good to have a well defined interface for it)\n>  - how many UTXOs are cached\n>- Before/afters for timing:\n>  - Insertions and deletions of UTXOs in the CoinsCache with associated information\n>  - Queries: hits and misses\n>  - Flushes\n\nð¯ð\n\n[1] https://github.com/KDE/heaptrack\n",
      "created_at" : "2021-04-12T17:21:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-817987016",
      "id" : 817987016,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxNzk4NzAxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-12T17:21:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/817987016",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I've been using heaptrack[1] for memory tracing, it hooks into malloc calls which saves us from putting allocation traces everywhere.\r\n\r\nThat sounds useful, however I think it would show gross malloc usage, not specifically that of the utxo set? Or can it drill down to more specific things as well?",
      "created_at" : "2021-04-12T19:02:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-818059376",
      "id" : 818059376,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxODA1OTM3Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-12T19:02:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/818059376",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "On Mon, Apr 12, 2021 at 12:03:09PM -0700, W. J. van der Laan wrote:\n>> I've been using heaptrack[1] for memory tracing, it hooks into malloc calls which saves us from putting allocation traces everywhere.\n>\n>That sounds useful, however I think it would show gross malloc usage, not specifically that of the utxo set? Or can it drill down to more specific things as well?\n\nIt shows memory usage from specific data structures over time, like the cacheCoins map. You can also drill down by which function is doing the allocation. \n\nSee: https://github.com/bitcoin/bitcoin/pull/18849#issuecomment-623531668\n",
      "created_at" : "2021-04-12T19:19:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-818069624",
      "id" : 818069624,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxODA2OTYyNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-12T19:19:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/818069624",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I've started working on a patch that adds tracing documentation (based on laanwj's work) and the `net:push_message` + `net:process_message` + more (based on jb55's work) together with both `bpftrace` and `bcc` examples. Goal is to have some initial and easy to work with examples of how USDT in Core could look like. There will be Bitcoin Core Review Club on USDTs later this month. ",
      "created_at" : "2021-05-05T08:40:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-832518476",
      "id" : 832518476,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgzMjUxODQ3Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-05T08:40:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/832518476",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "On Wed, May 05, 2021 at 01:41:18AM -0700, 0xB10C wrote:\n>I've started working on a patch that adds tracing documentation (based on laanwj's work) and the `net:push_message` + `net:process_message` + more (based on jb55's work) together with both `bpftrace` and `bcc` examples. Goal is to have some initial and easy to work with examples of how USDT in Core could look like.\n\nGreat! Looking forward to it. Thanks for moving this along.\n\n> There will be Bitcoin Core Review Club on USDTs later this month.\n\nI'll be there\n",
      "created_at" : "2021-05-05T17:43:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-832883926",
      "id" : 832883926,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgzMjg4MzkyNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-05T17:43:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/832883926",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> laanwj [mentioned](https://github.com/bitcoin/bitcoin/pull/19866#issuecomment-687336319) that traces for dis- and connections of peers would be useful too. I'll have a look where these could be placed. I guess there are some places where there is already `net` debug logging which can be used for orientation. \r\n\r\n@jonatack added that next to normal disconnects, tracepoints for peer evictions would be useful too. He [provided input](https://github.com/bitcoin/bitcoin/pull/22006#discussion_r636775863) on what tracepoint arguments he'd find useful:\r\n\r\n- message\r\n- connection direction and type,\r\n- peer id\r\n- address\r\n",
      "created_at" : "2021-05-21T09:54:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-845833323",
      "id" : 845833323,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg0NTgzMzMyMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-21T09:54:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/845833323",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@0xB10C thanks! Yes, my wishlist ties in a bit with issue #20576. I wish we had those in our net logging, separated into high/low frequency/level events.\r\n\r\nEdit: could add the network to the args list.",
      "created_at" : "2021-05-21T10:06:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-845840514",
      "id" : 845840514,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg0NTg0MDUxNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-21T10:08:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/845840514",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > I was looking at this a long time ago. In theory you could get the same functionality as statoshi (stats gathering via prometheus) with https://github.com/cloudflare/ebpf_exporter Would be an interesting project.\r\n> \r\n> \r\n> I agree! This would be my preferred way to do this kind of reporting, to be honest. It'd flexible and built into the operating system. It has low impact on the code and low impact on performance. It could potentially work for all software.\r\n> \r\n> One reason Statoshi never got merged is because it's just too much hassle to integrate and maintain a Bitcoin Core specific framework for this. Not because it's not a great thing to have.\r\n\r\nI have a demo for Prometheus metrics via eBPF based on the tracepoints added in #22006 in [0xB10C/bitcoind-observer](https://github.com/0xB10C/bitcoind-observer). It's written in Rust and uses the [bcc](https://crates.io/crates/bcc) crate under the hood which recently added USDT support.\r\n\r\nA live demo can be fund on [bitcoind.observer](https://bitcoind.observer). Currently showing [block validation] during IBD and per message type [P2P traffic] stats. I was surprised who well it works. Might be a real alternative to statoshi once we add more tracepoints about e.g. UTXO set, peer dis/connections, and so on.\r\n\r\n[block validation]: https://bitcoind.observer/d/V5pGXBW7k/block-validation-during-idb?orgId=1&from=1627333200000&to=1627390800000\r\n[P2P traffic]: https://bitcoind.observer/d/Z3_pFfZnz/p2p-network-traffic?orgId=1&refresh=30s&from=now-24h&to=now",
      "created_at" : "2021-07-27T12:02:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-887453677",
      "id" : 887453677,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "IC_kwDOABII58405Xft",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-27T12:02:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/887453677",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Tracepoints for Bitcoin Core startup and shutdown could be useful too. IDB latching to true/false too. ",
      "created_at" : "2021-08-10T14:20:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-896071188",
      "id" : 896071188,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "IC_kwDOABII5841aPYU",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-10T14:20:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/896071188",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Banman tracepoints should be interesting too.",
      "created_at" : "2021-08-13T13:48:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20981#issuecomment-898470100",
      "id" : 898470100,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20981",
      "node_id" : "IC_kwDOABII5841jZDU",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-13T13:48:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898470100",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   }
]
