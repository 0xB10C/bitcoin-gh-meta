[
   {
      "body" : "Hmm, have you considered to not print the error immediately, but only report through ValidationState, and then have ProcessMessage choose (optionally) to report the error string it, if any?\r\n\r\nThat's also more compatible with future modularization of the consensus code, where you want to do the actual logging externally.",
      "created_at" : "2015-08-05T13:52:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6519#issuecomment-128002541",
      "id" : 128002541,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6519",
      "updated_at" : "2015-08-05T13:52:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/128002541",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Yes let's do that...\r\n",
      "created_at" : "2015-08-05T14:59:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6519#issuecomment-128026520",
      "id" : 128026520,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6519",
      "updated_at" : "2015-08-05T16:33:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/128026520",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Done. CValidationState is augmented with optional debug information, which is logged upstream where possible.\r\n\r\nThis makes the change larger than originally intended, but the end result is better.\r\nSee commit messages/details for more information.\r\n\r\nN.B.: I've also removed the logging in `CScriptCheck::operator()()`. This is consistent but I'm uncertain about this, because this means that the script error is no longer logged in case of verification through CCheckQueue (so in the case of blocks). However it *is* logged when called directly from CheckInputs (https://github.com/bitcoin/bitcoin/blob/master/src/main.cpp#L1394).",
      "created_at" : "2015-08-06T08:19:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6519#issuecomment-128287427",
      "id" : 128287427,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6519",
      "updated_at" : "2015-08-06T08:19:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/128287427",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6519#discussion_r36396275"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6519"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/36396275"
         }
      },
      "body" : "No closing bracket?",
      "commit_id" : "72f786422f442cf68233dfcd58e2642b598a0ac8",
      "created_at" : "2015-08-06T09:32:19Z",
      "diff_hunk" : "@@ -778,6 +769,14 @@ CAmount GetMinRelayFee(const CTransaction& tx, unsigned int nBytes, bool fAllowF\n     return nMinFee;\n }\n \n+/** Convert CValidationState to a human-readable message for logging */\n+static std::string FormatStateMessage(const CValidationState &state)\n+{\n+    return strprintf(\"%s%s (code %i)\",\n+        state.GetRejectReason(),\n+        state.GetDebugMessage().empty() ? \"\" : (\", \"+state.GetDebugMessage()),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6519#discussion_r36396275",
      "id" : 36396275,
      "original_commit_id" : "0cbeb26fa69de916216754251507ce63e6a34a9f",
      "original_position" : 73,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6519",
      "updated_at" : "2015-08-06T10:12:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/36396275",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@laanwj That's not very consistent, as I think that means it will be printed with -par=1 and not with other values. I don't know of a better solution, though.",
      "created_at" : "2015-08-06T09:46:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6519#issuecomment-128310713",
      "id" : 128310713,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6519",
      "updated_at" : "2015-08-06T09:46:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/128310713",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa So we just call par=1 mode 'safe mode with debugging'. Voila.\r\n",
      "created_at" : "2015-08-06T09:49:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6519#issuecomment-128311220",
      "id" : 128311220,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6519",
      "updated_at" : "2015-08-06T09:49:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/128311220",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6519#discussion_r36397914"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6519"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/36397914"
         }
      },
      "body" : "The bracket is not in the string.",
      "commit_id" : "72f786422f442cf68233dfcd58e2642b598a0ac8",
      "created_at" : "2015-08-06T09:49:58Z",
      "diff_hunk" : "@@ -778,6 +769,14 @@ CAmount GetMinRelayFee(const CTransaction& tx, unsigned int nBytes, bool fAllowF\n     return nMinFee;\n }\n \n+/** Convert CValidationState to a human-readable message for logging */\n+static std::string FormatStateMessage(const CValidationState &state)\n+{\n+    return strprintf(\"%s%s (code %i)\",\n+        state.GetRejectReason(),\n+        state.GetDebugMessage().empty() ? \"\" : (\", \"+state.GetDebugMessage()),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6519#discussion_r36397914",
      "id" : 36397914,
      "original_commit_id" : "0cbeb26fa69de916216754251507ce63e6a34a9f",
      "original_position" : 73,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6519",
      "updated_at" : "2015-08-06T10:12:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/36397914",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Untested ACK (but see nit about closing bracket).",
      "created_at" : "2015-08-06T10:01:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6519#issuecomment-128313341",
      "id" : 128313341,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6519",
      "updated_at" : "2015-08-06T10:01:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/128313341",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6519#discussion_r36399708"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6519"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/36399708"
         }
      },
      "body" : "Removed the parenthesis around \", \"+... - they made the code harder to read instead of easier.",
      "commit_id" : "72f786422f442cf68233dfcd58e2642b598a0ac8",
      "created_at" : "2015-08-06T10:14:21Z",
      "diff_hunk" : "@@ -778,6 +769,14 @@ CAmount GetMinRelayFee(const CTransaction& tx, unsigned int nBytes, bool fAllowF\n     return nMinFee;\n }\n \n+/** Convert CValidationState to a human-readable message for logging */\n+static std::string FormatStateMessage(const CValidationState &state)\n+{\n+    return strprintf(\"%s%s (code %i)\",\n+        state.GetRejectReason(),\n+        state.GetDebugMessage().empty() ? \"\" : (\", \"+state.GetDebugMessage()),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6519#discussion_r36399708",
      "id" : 36399708,
      "original_commit_id" : "0cbeb26fa69de916216754251507ce63e6a34a9f",
      "original_position" : 73,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6519",
      "updated_at" : "2015-08-06T10:14:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/36399708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "> Also introduces a consistent format for transaction validation failures that always includes the txid.\r\n\r\nGreat PR, I'm running it for some hours, and this is really useful!",
      "created_at" : "2015-08-07T20:50:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6519#issuecomment-128831524",
      "id" : 128831524,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6519",
      "updated_at" : "2015-08-07T20:50:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/128831524",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5836089?v=3",
         "events_url" : "https://api.github.com/users/dexX7/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dexX7/followers",
         "following_url" : "https://api.github.com/users/dexX7/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dexX7/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dexX7",
         "id" : 5836089,
         "login" : "dexX7",
         "organizations_url" : "https://api.github.com/users/dexX7/orgs",
         "received_events_url" : "https://api.github.com/users/dexX7/received_events",
         "repos_url" : "https://api.github.com/users/dexX7/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dexX7/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dexX7"
      }
   }
]
