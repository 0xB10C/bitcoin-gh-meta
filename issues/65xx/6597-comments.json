[
   {
      "body" : "> Apart from being a minimal optimization\r\n\r\nHow is this an optimization?  You are now comparing the blocks hash against the genesis block every time `ConnectBlock` is called?",
      "created_at" : "2015-08-29T01:28:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6597#issuecomment-135925165",
      "id" : 135925165,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6597",
      "updated_at" : "2015-08-29T01:28:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135925165",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "> How is this an optimization? \r\n\r\nBy saving some checks for the genesis block.\r\n\r\n> You are now comparing the blocks hash against the genesis block every time ConnectBlock is called?\r\n\r\nThe check in ConnectBlock was already there, now ```CheckBlock``` is not called if the block being checked is the genesis block (ie the checks has just been moved below the genesis block check).",
      "created_at" : "2015-08-29T01:36:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6597#issuecomment-135925472",
      "id" : 135925472,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6597",
      "updated_at" : "2015-08-29T01:37:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135925472",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "In any case, benchmarking welcomed.",
      "created_at" : "2015-08-29T01:40:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6597#issuecomment-135925772",
      "id" : 135925772,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6597",
      "updated_at" : "2015-08-29T01:40:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/135925772",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Rebased and simplified. Looking at it again, @dcousens was right that many of the changes would have affected performance negatively. Besides they were (or at least they currently seem to be) unnecessary for #6382 (or for facilitating the creating of testchains in general by not requiring tester to \"mine\" the genesis block of their testchains: the genesis block is correct by definition).\r\nNow it should be clear that we're just optimizing the genesis block case in ConnectBlock() without adding any work to the other cases, and we're only affecting negatively the performance of CBlockTreeDB::LoadBlockIndexGuts by comparing two hashes right before returning and error (only if CheckProofOfWork had previously failed), which I think is very acceptable.\r\nSo I don't think benchmarking this makes sense anymore.",
      "created_at" : "2015-11-11T22:59:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6597#issuecomment-155936477",
      "id" : 155936477,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6597",
      "updated_at" : "2015-11-11T22:59:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/155936477",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "utACK",
      "created_at" : "2015-11-11T23:13:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6597#issuecomment-155939066",
      "id" : 155939066,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6597",
      "updated_at" : "2015-11-11T23:13:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/155939066",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6597#discussion_r44671670"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6597"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/44671670"
         }
      },
      "body" : "Is the genesis block expected to fail PoW?",
      "commit_id" : "b95a2f959f9f86b49391fcb68b4e3cfe6691b41a",
      "created_at" : "2015-11-12T15:40:24Z",
      "diff_hunk" : "@@ -203,7 +204,8 @@ bool CBlockTreeDB::LoadBlockIndexGuts()\n                 pindexNew->nStatus        = diskindex.nStatus;\n                 pindexNew->nTx            = diskindex.nTx;\n \n-                if (!CheckProofOfWork(pindexNew->GetBlockHash(), pindexNew->nBits, Params().GetConsensus()))\n+                if (!CheckProofOfWork(pindexNew->GetBlockHash(), pindexNew->nBits, consensusParams) &&\n+                    pindexNew->GetBlockHash() != consensusParams.hashGenesisBlock)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6597#discussion_r44671670",
      "id" : 44671670,
      "original_commit_id" : "b95a2f959f9f86b49391fcb68b4e3cfe6691b41a",
      "original_position" : 14,
      "path" : "src/txdb.cpp",
      "position" : 14,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6597",
      "updated_at" : "2015-11-12T15:40:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/44671670",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
