{
   "assignee" : null,
   "assignees" : [],
   "body" : "When `listsinceblock` is called with a block hash that belongs to a non-main chain, the system will mistakenly use its relative position in **its** chain vs the current active chain's height to determine which transactions should be included.\r\n\r\nThis patch locates the fork point and uses that as reference instead.\r\n\r\nThe problem can be observed in the following scenario: with address `A` belonging to node `n1` in a network with `n1` through `n4`:\r\n\r\n1. Split network into two partitions, `n12` and `n34`.\r\n2. Create and send a transaction `tx` from `n3` to address `A`.\r\n3. Generate 6 blocks on `n1`. Note last block hash as `<lastKnownHash>`.\r\n4. Generate 6 blocks on `n3`.\r\n5. Merge network into `n1234`.\r\n6. Generate 1 block on `n3` to activate `n34` chain.\r\n7. Do `listsinceblock <lastKnownHash>` on `n1`.\r\n\r\nThe resulting transaction list should contain `tx`, but it does not.\r\n",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 7,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9516/comments",
   "created_at" : "2017-01-11T09:06:34Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9516/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/9516",
   "id" : 200037784,
   "labels" : [
      {
         "color" : "0052cc",
         "default" : false,
         "id" : 98279177,
         "name" : "RPC/REST/ZMQ",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ"
      },
      {
         "color" : "02d7e1",
         "default" : false,
         "id" : 149424,
         "name" : "Wallet",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Wallet"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9516/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 9516,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/9516.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9516",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/9516.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9516"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Bug-fix: listsinceblock: use fork point as reference for blocks in reorg'd chains",
   "updated_at" : "2017-01-13T18:19:04Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9516",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/250224?v=3",
      "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
      "followers_url" : "https://api.github.com/users/kallewoof/followers",
      "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/kallewoof",
      "id" : 250224,
      "login" : "kallewoof",
      "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
      "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
      "repos_url" : "https://api.github.com/users/kallewoof/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/kallewoof"
   }
}
