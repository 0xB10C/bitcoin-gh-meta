[
   {
      "body" : "Concept ACK\r\n\r\nWhile trying to test this, I have got:\r\n```\r\nAssertion failed: (nMaxInbound > 0), function AcceptConnection, file net.cpp, line 973.\r\n```\r\nalmost immediately I pressed the network toggle icon.\r\n\r\nWhen the network is toggled off, the icon is hidden and I can't turn the network back on without trying to click in the empty space...\r\n",
      "created_at" : "2016-10-23T16:19:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255597649",
      "id" : 255597649,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8996",
      "updated_at" : "2016-10-23T16:19:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255597649",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "There is a commit for RPC `togglenetwork` (f83a1e2bd83625997916963fe8b1942e504070ab), but it is renamed later, so commits do not match.\r\n\r\nThe RPC test is still named `togglenetwork` (https://github.com/bitcoin/bitcoin/pull/8996/files#diff-b89234789a9a9ee29cb0758f69a73133R87).",
      "created_at" : "2016-10-23T16:39:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255598783",
      "id" : 255598783,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8996",
      "updated_at" : "2016-10-23T16:39:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255598783",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "During startup, when there is 1 outgoing connection only:\r\n\r\n```\r\n2016-10-23 16:44:42 SetNetworkActive: false\r\n2016-10-23 16:44:42 disconnecting peer=1\r\n2016-10-23 16:44:42 socket select error Bad file descriptor (9)\r\n2016-10-23 16:44:42 disconnecting peer=2\r\nnMaxConnections = 8\r\nnMaxFeeler = 1\r\nnMaxOutbound = 8\r\nnMaxInbound = -1\r\nAssertion failed: (nMaxInbound > 0), function AcceptConnection, file net.cpp, line 979.\r\n```\r\n@EthanHeilman Do you have an idea?",
      "created_at" : "2016-10-23T16:48:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255599302",
      "id" : 255599302,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8996",
      "updated_at" : "2016-10-23T16:48:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255599302",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "> ```Assertion failed: (nMaxInbound > 0), function AcceptConnection, file net.cpp, line 973.```\r\n\r\nI don't believe this can be related to this PR...\r\n\r\n> When the network is toggled off, the icon is hidden and I can't turn the network back on without trying to click in the empty space...\r\n\r\nSounds like a build system problem - it didn't update the resources with the new icon?\r\n\r\n> There is a commit for RPC togglenetwork (f83a1e2), but it is renamed later, so commits do not match.\r\n\r\nI don't see this as a problem.",
      "created_at" : "2016-10-23T17:05:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255600344",
      "id" : 255600344,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8996",
      "updated_at" : "2016-10-23T17:05:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255600344",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8996#discussion_r84600124"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8996"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84600124"
         }
      },
      "body" : "`_clientModel` please to prevent shadowing.",
      "commit_id" : "19f46f177ec5e1913f9be5b257dad95bc7a57c38",
      "created_at" : "2016-10-23T17:31:47Z",
      "diff_hunk" : "@@ -1211,3 +1231,18 @@ void UnitDisplayStatusBarControl::onMenuSelection(QAction* action)\n         optionsModel->setDisplayUnit(action->data());\n     }\n }\n+\n+void NetworkToggleStatusBarControl::mousePressEvent(QMouseEvent *event)\n+{\n+    if (clientModel) {\n+        clientModel->setNetworkActive(!clientModel->getNetworkActive());\n+    }\n+}\n+\n+/** Lets the control know about the Client Model */\n+void NetworkToggleStatusBarControl::setClientModel(ClientModel *clientModel)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8996#discussion_r84600124",
      "id" : 84600124,
      "original_commit_id" : "c0e95c8ee24745bbc54c6230cd497ecb08c9dbc3",
      "original_position" : 98,
      "path" : "src/qt/bitcoingui.cpp",
      "position" : null,
      "pull_request_review_id" : 5368477,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8996",
      "updated_at" : "2016-10-24T10:25:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84600124",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "The missing icon issue was local one, yes (solved by clean build). Sorry for confusion.\r\n\r\nThe icon should probably contain some visual reference to the network (compare with the no-HD icon). I can't create screenshot because it aborts almost immediately here.\r\n",
      "created_at" : "2016-10-23T17:33:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255601894",
      "id" : 255601894,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8996",
      "updated_at" : "2016-10-23T17:33:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255601894",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8996#discussion_r84633065"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8996"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84633065"
         }
      },
      "body" : "done",
      "commit_id" : "19f46f177ec5e1913f9be5b257dad95bc7a57c38",
      "created_at" : "2016-10-24T07:34:50Z",
      "diff_hunk" : "@@ -1211,3 +1231,18 @@ void UnitDisplayStatusBarControl::onMenuSelection(QAction* action)\n         optionsModel->setDisplayUnit(action->data());\n     }\n }\n+\n+void NetworkToggleStatusBarControl::mousePressEvent(QMouseEvent *event)\n+{\n+    if (clientModel) {\n+        clientModel->setNetworkActive(!clientModel->getNetworkActive());\n+    }\n+}\n+\n+/** Lets the control know about the Client Model */\n+void NetworkToggleStatusBarControl::setClientModel(ClientModel *clientModel)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8996#discussion_r84633065",
      "id" : 84633065,
      "original_commit_id" : "c0e95c8ee24745bbc54c6230cd497ecb08c9dbc3",
      "original_position" : 98,
      "path" : "src/qt/bitcoingui.cpp",
      "position" : null,
      "pull_request_review_id" : 5397446,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8996",
      "updated_at" : "2016-10-24T10:25:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84633065",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "It works as designed. Icon in the UI flips on RPC calls, can be clicked, nice tooltips, it works.\r\n\r\nWhen the network is disabled, it looks like this (with non-HD wallet):\r\n\r\n<img width=\"94\" alt=\"screen shot 2016-10-24 at 18 58 52\" src=\"https://cloud.githubusercontent.com/assets/6848764/19655388/f7ce6568-9a1b-11e6-96b1-7d56ef992ab9.png\">\r\n\r\nI still think that it should be done in 2 commits instead of this mess:\r\n\r\n- RPC: New method setnetworkactive\r\n- GUI: UI part of the network enable/disable\r\n",
      "created_at" : "2016-10-24T17:06:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255801972",
      "id" : 255801972,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8996",
      "updated_at" : "2016-10-24T17:06:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255801972",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "@paveljanik At the risk of stating the obvious if nMaxConnections is set to 8 then nMaxInbound will be set to -1 triggering the assert.\r\n\r\n```c++\r\nint nMaxInbound = nMaxConnections - (nMaxOutbound + nMaxFeeler);\r\nassert(nMaxInbound > 0);\r\n```\r\n\r\nThe value nMaxConnections is typically set to 125, I don't understand how it is getting set to 8, perhaps the system is running low on available sockets?",
      "created_at" : "2016-10-24T22:53:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255888768",
      "id" : 255888768,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8996",
      "updated_at" : "2016-10-24T22:53:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255888768",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/274814?v=3",
         "events_url" : "https://api.github.com/users/EthanHeilman/events{/privacy}",
         "followers_url" : "https://api.github.com/users/EthanHeilman/followers",
         "following_url" : "https://api.github.com/users/EthanHeilman/following{/other_user}",
         "gists_url" : "https://api.github.com/users/EthanHeilman/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/EthanHeilman",
         "id" : 274814,
         "login" : "EthanHeilman",
         "organizations_url" : "https://api.github.com/users/EthanHeilman/orgs",
         "received_events_url" : "https://api.github.com/users/EthanHeilman/received_events",
         "repos_url" : "https://api.github.com/users/EthanHeilman/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/EthanHeilman/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/EthanHeilman/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/EthanHeilman"
      }
   },
   {
      "body" : "@EthanHeilman nMaxConnections is user configurable. I typically set it to 3 on low-memory devices.",
      "created_at" : "2016-10-24T22:55:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255889255",
      "id" : 255889255,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8996",
      "updated_at" : "2016-10-24T22:55:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255889255",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "I think the assert failure with a low maxconnections is an issue unrelated to this PR.",
      "created_at" : "2016-10-25T01:58:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255915358",
      "id" : 255915358,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8996",
      "updated_at" : "2016-10-25T01:58:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255915358",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@luke-jr @EthanHeilman Indeed, let's move to #9007.",
      "created_at" : "2016-10-25T04:45:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255935418",
      "id" : 255935418,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8996",
      "updated_at" : "2016-10-25T04:45:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/255935418",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
