[
   {
      "author_association" : "NONE",
      "body" : "There's also the possibility of emitting the shutdown signal from RPCExecutor destructor so we don't need a wrapper - that simplify the solution. I created the PR with the wrapper solution because it might be considered unsafe to emit signals from a destructor in a multi-threaded application. Would appreciate any input on this and I'll update the PR accordingly.",
      "created_at" : "2018-07-16T17:27:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#issuecomment-405323678",
      "id" : 405323678,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13674",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNTMyMzY3OA==",
      "updated_at" : "2018-07-16T17:27:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/405323678",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8540640?v=4",
         "events_url" : "https://api.github.com/users/LeandroRocha84/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LeandroRocha84/followers",
         "following_url" : "https://api.github.com/users/LeandroRocha84/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LeandroRocha84/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LeandroRocha84",
         "id" : 8540640,
         "login" : "LeandroRocha84",
         "node_id" : "MDQ6VXNlcjg1NDA2NDA=",
         "organizations_url" : "https://api.github.com/users/LeandroRocha84/orgs",
         "received_events_url" : "https://api.github.com/users/LeandroRocha84/received_events",
         "repos_url" : "https://api.github.com/users/LeandroRocha84/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LeandroRocha84/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LeandroRocha84/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LeandroRocha84"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r202818240"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/202818240"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Remove commented code?",
      "commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "created_at" : "2018-07-16T20:44:13Z",
      "diff_hunk" : "@@ -968,19 +1014,21 @@ void RPCConsole::browseHistory(int offset)\n \n void RPCConsole::startExecutor()\n {\n-    RPCExecutor *executor = new RPCExecutor(m_node);\n-    executor->moveToThread(&thread);\n+    RPCExecutorWrapper *executorWrapper = new RPCExecutorWrapper(m_node);\n+    executorWrapper->moveToThread(&thread);\n \n     // Replies from executor object must go to this object\n-    connect(executor, SIGNAL(reply(int,QString)), this, SLOT(message(int,QString)));\n+    connect(executorWrapper, SIGNAL(reply(int,QString)), this, SLOT(message(int,QString)));\n     // Requests from this object must go to executor\n-    connect(this, SIGNAL(cmdRequest(QString, QString)), executor, SLOT(request(QString, QString)));\n+    connect(this, SIGNAL(cmdRequest(QString, QString)), executorWrapper, SLOT(request(QString, QString)));\n+    connect(executorWrapper, SIGNAL(shutdownComplete()), this, SIGNAL(rpcExecutorShutdownComplete()));\n \n     // On stopExecutor signal\n     // - quit the Qt event loop in the execution thread\n-    connect(this, SIGNAL(stopExecutor()), &thread, SLOT(quit()));\n+    connect(this, SIGNAL(stopExecutor()), executorWrapper, SLOT(shutdown()));\n+    //connect(this, SIGNAL(stopExecutor()), &thread, SLOT(quit()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r202818240",
      "id" : 202818240,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMjgxODI0MA==",
      "original_commit_id" : "debf7dbeb26d5f05c134ca6a3ce0b9d1ce40a88d",
      "original_position" : 90,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : null,
      "pull_request_review_id" : 137589486,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674",
      "updated_at" : "2018-07-27T02:58:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/202818240",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Thanks for the suggestion @promag \r\nI've updated the PR to remove the unnecessary complexity. Aside from your suggested code, I've made a small change to bitcoingui.cpp so that the UI clientModel is not cleared until the RPCExecutor thread joins. Otherwise, network events, like a new connection, that trigger a UI update would raise exceptions.\r\n",
      "created_at" : "2018-07-17T04:08:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#issuecomment-405453406",
      "id" : 405453406,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13674",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwNTQ1MzQwNg==",
      "updated_at" : "2018-07-17T04:08:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/405453406",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8540640?v=4",
         "events_url" : "https://api.github.com/users/LeandroRocha84/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LeandroRocha84/followers",
         "following_url" : "https://api.github.com/users/LeandroRocha84/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LeandroRocha84/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LeandroRocha84",
         "id" : 8540640,
         "login" : "LeandroRocha84",
         "node_id" : "MDQ6VXNlcjg1NDA2NDA=",
         "organizations_url" : "https://api.github.com/users/LeandroRocha84/orgs",
         "received_events_url" : "https://api.github.com/users/LeandroRocha84/received_events",
         "repos_url" : "https://api.github.com/users/LeandroRocha84/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LeandroRocha84/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LeandroRocha84/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LeandroRocha84"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r203056751"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203056751"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sorry, could use new connect syntax?\r\n```cpp\r\nconnect(&thread, &QThread::finished, &loop, &QEventLoop::quit)",
      "commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "created_at" : "2018-07-17T14:58:11Z",
      "diff_hunk" : "@@ -688,8 +689,10 @@ void RPCConsole::setClientModel(ClientModel *model)\n     if (!model) {\n         // Client model is being set to 0, this means shutdown() is about to be called.\n         // Make sure we clean up the executor thread\n+        QEventLoop loop;\n+        connect(&thread, SIGNAL(finished()), &loop, SLOT(quit()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r203056751",
      "id" : 203056751,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMzA1Njc1MQ==",
      "original_commit_id" : "3844ba3d10a4bb89ddd348a19ccd33f64f35a1a6",
      "original_position" : 13,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : null,
      "pull_request_review_id" : 137871575,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674",
      "updated_at" : "2018-07-27T02:58:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203056751",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r203490214"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203490214"
         }
      },
      "author_association" : "NONE",
      "body" : "Sure thing. That's done.\r\nAnd rebased.",
      "commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "created_at" : "2018-07-18T18:49:01Z",
      "diff_hunk" : "@@ -688,8 +689,10 @@ void RPCConsole::setClientModel(ClientModel *model)\n     if (!model) {\n         // Client model is being set to 0, this means shutdown() is about to be called.\n         // Make sure we clean up the executor thread\n+        QEventLoop loop;\n+        connect(&thread, SIGNAL(finished()), &loop, SLOT(quit()));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r203490214",
      "id" : 203490214,
      "in_reply_to_id" : 203056751,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwMzQ5MDIxNA==",
      "original_commit_id" : "3844ba3d10a4bb89ddd348a19ccd33f64f35a1a6",
      "original_position" : 13,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : null,
      "pull_request_review_id" : 138390317,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674",
      "updated_at" : "2018-07-27T02:58:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/203490214",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8540640?v=4",
         "events_url" : "https://api.github.com/users/LeandroRocha84/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LeandroRocha84/followers",
         "following_url" : "https://api.github.com/users/LeandroRocha84/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LeandroRocha84/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LeandroRocha84",
         "id" : 8540640,
         "login" : "LeandroRocha84",
         "node_id" : "MDQ6VXNlcjg1NDA2NDA=",
         "organizations_url" : "https://api.github.com/users/LeandroRocha84/orgs",
         "received_events_url" : "https://api.github.com/users/LeandroRocha84/received_events",
         "repos_url" : "https://api.github.com/users/LeandroRocha84/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LeandroRocha84/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LeandroRocha84/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LeandroRocha84"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r205535493"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205535493"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Rebase to remove this change.",
      "commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "created_at" : "2018-07-26T17:15:40Z",
      "diff_hunk" : "@@ -470,13 +470,13 @@ void BitcoinGUI::setClientModel(ClientModel *_clientModel)\n         }\n #endif // ENABLE_WALLET\n         unitDisplayControl->setOptionsModel(_clientModel->getOptionsModel());\n-        \n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r205535493",
      "id" : 205535493,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNTUzNTQ5Mw==",
      "original_commit_id" : "086d88e3e911930152827dfe9f0c878d1de18296",
      "original_position" : 16,
      "path" : "src/qt/bitcoingui.cpp",
      "position" : null,
      "pull_request_review_id" : 140825723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674",
      "updated_at" : "2018-07-27T02:58:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205535493",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r205535537"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205535537"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why this change? Should update `this->clientModel` event if `_clientModel` is null.",
      "commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "created_at" : "2018-07-26T17:15:48Z",
      "diff_hunk" : "@@ -437,9 +437,9 @@ void BitcoinGUI::createToolBars()\n \n void BitcoinGUI::setClientModel(ClientModel *_clientModel)\n {\n-    this->clientModel = _clientModel;\n     if(_clientModel)\n     {\n+        this->clientModel = _clientModel;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r205535537",
      "id" : 205535537,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNTUzNTUzNw==",
      "original_commit_id" : "086d88e3e911930152827dfe9f0c878d1de18296",
      "original_position" : 7,
      "path" : "src/qt/bitcoingui.cpp",
      "position" : 7,
      "pull_request_review_id" : 140825723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674",
      "updated_at" : "2018-07-27T02:58:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205535537",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r205535639"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205535639"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Same as above.",
      "commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "created_at" : "2018-07-26T17:16:03Z",
      "diff_hunk" : "@@ -470,13 +470,13 @@ void BitcoinGUI::setClientModel(ClientModel *_clientModel)\n         }\n #endif // ENABLE_WALLET\n         unitDisplayControl->setOptionsModel(_clientModel->getOptionsModel());\n-        \n+\n         OptionsModel* optionsModel = _clientModel->getOptionsModel();\n         if(optionsModel)\n         {\n             // be aware of the tray icon disable state change reported by the OptionsModel object.\n             connect(optionsModel,SIGNAL(hideTrayIconChanged(bool)),this,SLOT(setTrayIconVisible(bool)));\n-        \n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r205535639",
      "id" : 205535639,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNTUzNTYzOQ==",
      "original_commit_id" : "086d88e3e911930152827dfe9f0c878d1de18296",
      "original_position" : 23,
      "path" : "src/qt/bitcoingui.cpp",
      "position" : null,
      "pull_request_review_id" : 140825723,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674",
      "updated_at" : "2018-07-27T02:58:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205535639",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r205655309"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205655309"
         }
      },
      "author_association" : "NONE",
      "body" : "Because now the main thread is not blocked, network events can trigger a GUI update. If the clientModel is set to 0 or null at the time, the application will crash.\r\nExample: When number of connections change, BitcoinGUI::updateNetworkState() gets invoked and this method assumes that clientModel is valid.\r\nWith this change  BitcoinGUI clientModel is cleared only after the RPCExecutor thread joins and shutdown resumes in the main thread.",
      "commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "created_at" : "2018-07-27T02:52:55Z",
      "diff_hunk" : "@@ -437,9 +437,9 @@ void BitcoinGUI::createToolBars()\n \n void BitcoinGUI::setClientModel(ClientModel *_clientModel)\n {\n-    this->clientModel = _clientModel;\n     if(_clientModel)\n     {\n+        this->clientModel = _clientModel;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r205655309",
      "id" : 205655309,
      "in_reply_to_id" : 205535537,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNTY1NTMwOQ==",
      "original_commit_id" : "086d88e3e911930152827dfe9f0c878d1de18296",
      "original_position" : 7,
      "path" : "src/qt/bitcoingui.cpp",
      "position" : 7,
      "pull_request_review_id" : 140970757,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674",
      "updated_at" : "2018-07-27T02:58:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205655309",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8540640?v=4",
         "events_url" : "https://api.github.com/users/LeandroRocha84/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LeandroRocha84/followers",
         "following_url" : "https://api.github.com/users/LeandroRocha84/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LeandroRocha84/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LeandroRocha84",
         "id" : 8540640,
         "login" : "LeandroRocha84",
         "node_id" : "MDQ6VXNlcjg1NDA2NDA=",
         "organizations_url" : "https://api.github.com/users/LeandroRocha84/orgs",
         "received_events_url" : "https://api.github.com/users/LeandroRocha84/received_events",
         "repos_url" : "https://api.github.com/users/LeandroRocha84/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LeandroRocha84/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LeandroRocha84/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LeandroRocha84"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r205656056"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205656056"
         }
      },
      "author_association" : "NONE",
      "body" : "Done",
      "commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "created_at" : "2018-07-27T03:00:14Z",
      "diff_hunk" : "@@ -470,13 +470,13 @@ void BitcoinGUI::setClientModel(ClientModel *_clientModel)\n         }\n #endif // ENABLE_WALLET\n         unitDisplayControl->setOptionsModel(_clientModel->getOptionsModel());\n-        \n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r205656056",
      "id" : 205656056,
      "in_reply_to_id" : 205535493,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNTY1NjA1Ng==",
      "original_commit_id" : "086d88e3e911930152827dfe9f0c878d1de18296",
      "original_position" : 16,
      "path" : "src/qt/bitcoingui.cpp",
      "position" : null,
      "pull_request_review_id" : 140971657,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674",
      "updated_at" : "2018-07-27T03:00:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205656056",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8540640?v=4",
         "events_url" : "https://api.github.com/users/LeandroRocha84/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LeandroRocha84/followers",
         "following_url" : "https://api.github.com/users/LeandroRocha84/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LeandroRocha84/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LeandroRocha84",
         "id" : 8540640,
         "login" : "LeandroRocha84",
         "node_id" : "MDQ6VXNlcjg1NDA2NDA=",
         "organizations_url" : "https://api.github.com/users/LeandroRocha84/orgs",
         "received_events_url" : "https://api.github.com/users/LeandroRocha84/received_events",
         "repos_url" : "https://api.github.com/users/LeandroRocha84/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LeandroRocha84/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LeandroRocha84/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LeandroRocha84"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r205656066"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205656066"
         }
      },
      "author_association" : "NONE",
      "body" : "Done!",
      "commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "created_at" : "2018-07-27T03:00:22Z",
      "diff_hunk" : "@@ -470,13 +470,13 @@ void BitcoinGUI::setClientModel(ClientModel *_clientModel)\n         }\n #endif // ENABLE_WALLET\n         unitDisplayControl->setOptionsModel(_clientModel->getOptionsModel());\n-        \n+\n         OptionsModel* optionsModel = _clientModel->getOptionsModel();\n         if(optionsModel)\n         {\n             // be aware of the tray icon disable state change reported by the OptionsModel object.\n             connect(optionsModel,SIGNAL(hideTrayIconChanged(bool)),this,SLOT(setTrayIconVisible(bool)));\n-        \n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r205656066",
      "id" : 205656066,
      "in_reply_to_id" : 205535639,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNTY1NjA2Ng==",
      "original_commit_id" : "086d88e3e911930152827dfe9f0c878d1de18296",
      "original_position" : 23,
      "path" : "src/qt/bitcoingui.cpp",
      "position" : null,
      "pull_request_review_id" : 140971670,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674",
      "updated_at" : "2018-07-27T03:00:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205656066",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8540640?v=4",
         "events_url" : "https://api.github.com/users/LeandroRocha84/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LeandroRocha84/followers",
         "following_url" : "https://api.github.com/users/LeandroRocha84/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LeandroRocha84/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LeandroRocha84",
         "id" : 8540640,
         "login" : "LeandroRocha84",
         "node_id" : "MDQ6VXNlcjg1NDA2NDA=",
         "organizations_url" : "https://api.github.com/users/LeandroRocha84/orgs",
         "received_events_url" : "https://api.github.com/users/LeandroRocha84/received_events",
         "repos_url" : "https://api.github.com/users/LeandroRocha84/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LeandroRocha84/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LeandroRocha84/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LeandroRocha84"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Hi all, please let me know if there's anything that needs to be done to have this fix merged.\r\nThanks",
      "created_at" : "2018-09-01T05:45:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#issuecomment-417835170",
      "id" : 417835170,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13674",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQxNzgzNTE3MA==",
      "updated_at" : "2018-09-01T05:45:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/417835170",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8540640?v=4",
         "events_url" : "https://api.github.com/users/LeandroRocha84/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LeandroRocha84/followers",
         "following_url" : "https://api.github.com/users/LeandroRocha84/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LeandroRocha84/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LeandroRocha84",
         "id" : 8540640,
         "login" : "LeandroRocha84",
         "node_id" : "MDQ6VXNlcjg1NDA2NDA=",
         "organizations_url" : "https://api.github.com/users/LeandroRocha84/orgs",
         "received_events_url" : "https://api.github.com/users/LeandroRocha84/received_events",
         "repos_url" : "https://api.github.com/users/LeandroRocha84/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LeandroRocha84/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LeandroRocha84/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LeandroRocha84"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r219680542"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219680542"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "You're implicitly using `QueuedConnection` here: https://github.com/bitcoin/bitcoin/blob/9255963890f07f93646cc32703da935dcb24d454/src/qt/rpcconsole.cpp#L693\r\nTherefore,  the `thread.isFinished()` is called immediately after the `stopExecutor()` signal is emitted. If the `thread` is idle the value of `thread.isFinished()` may be unpredictable, IMO.",
      "commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "created_at" : "2018-09-22T19:37:33Z",
      "diff_hunk" : "@@ -688,8 +689,10 @@ void RPCConsole::setClientModel(ClientModel *model)\n     if (!model) {\n         // Client model is being set to 0, this means shutdown() is about to be called.\n         // Make sure we clean up the executor thread\n+        QEventLoop loop;\n+        connect(&thread, &QThread::finished, &loop, &QEventLoop::quit);\n         Q_EMIT stopExecutor();\n-        thread.wait();\n+        if (!thread.isFinished()) loop.exec();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r219680542",
      "id" : 219680542,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY4MDU0Mg==",
      "original_commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "original_position" : 16,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : 16,
      "pull_request_review_id" : 157920184,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674",
      "updated_at" : "2018-09-22T19:38:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219680542",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r221449323"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221449323"
         }
      },
      "author_association" : "NONE",
      "body" : "If I understood your concern correctly, you're afraid that the thread.isFinished() result may be unpredictable and as a result, the QEventLoop may never quit since it is tied to the thread finished() signal.\r\n\r\nI don't see a problem considering how the QThread lifecycle works. As per documentation, the order is:\r\n* Thread quit() or exit() is called\r\n* As soon as exec completes, isFinished starts to return true\r\n* The finished() signal is emitted\r\n\r\nAs a result we should consistently get the loop.exec before the thread finished signal is emitted.\r\nAlso, if thread.isFinished return true, the code in the if statement is not executed and shutdown continues normally.\r\n\r\nPlease let me know if I misunderstood your concern.\r\nThanks,\r\n\r\n\r\n",
      "commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "created_at" : "2018-09-30T06:47:57Z",
      "diff_hunk" : "@@ -688,8 +689,10 @@ void RPCConsole::setClientModel(ClientModel *model)\n     if (!model) {\n         // Client model is being set to 0, this means shutdown() is about to be called.\n         // Make sure we clean up the executor thread\n+        QEventLoop loop;\n+        connect(&thread, &QThread::finished, &loop, &QEventLoop::quit);\n         Q_EMIT stopExecutor();\n-        thread.wait();\n+        if (!thread.isFinished()) loop.exec();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13674#discussion_r221449323",
      "id" : 221449323,
      "in_reply_to_id" : 219680542,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMTQ0OTMyMw==",
      "original_commit_id" : "9255963890f07f93646cc32703da935dcb24d454",
      "original_position" : 16,
      "path" : "src/qt/rpcconsole.cpp",
      "position" : 16,
      "pull_request_review_id" : 160104199,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13674",
      "updated_at" : "2018-09-30T06:47:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/221449323",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8540640?v=4",
         "events_url" : "https://api.github.com/users/LeandroRocha84/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LeandroRocha84/followers",
         "following_url" : "https://api.github.com/users/LeandroRocha84/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LeandroRocha84/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LeandroRocha84",
         "id" : 8540640,
         "login" : "LeandroRocha84",
         "node_id" : "MDQ6VXNlcjg1NDA2NDA=",
         "organizations_url" : "https://api.github.com/users/LeandroRocha84/orgs",
         "received_events_url" : "https://api.github.com/users/LeandroRocha84/received_events",
         "repos_url" : "https://api.github.com/users/LeandroRocha84/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LeandroRocha84/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LeandroRocha84/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LeandroRocha84"
      }
   }
]
