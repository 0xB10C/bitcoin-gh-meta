[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-06-07T23:30:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-640296153",
      "id" : 640296153,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MDI5NjE1Mw==",
      "updated_at" : "2020-06-07T23:30:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/640296153",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20788 (net: add RAII socket and use it instead of bare SOCKET by vasild)\n* #20685 (Add I2P support using I2P SAM by vasild)\n* #19415 (net: Make DNS lookup mockable, add fuzzing harness by practicalswift)\n* #19259 (fuzz: Add fuzzing harness for LoadMempool(...) and DumpMempool(...) by practicalswift)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-06-07T23:34:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-640296575",
      "id" : 640296575,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MDI5NjU3NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-22T22:50:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/640296575",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-07-09T16:32:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-656228768",
      "id" : 656228768,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NjIyODc2OA==",
      "updated_at" : "2020-07-09T16:32:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656228768",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-07-11T10:39:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-657039312",
      "id" : 657039312,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NzAzOTMxMg==",
      "updated_at" : "2020-07-11T10:39:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657039312",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-07-18T07:45:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-660444979",
      "id" : 660444979,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY2MDQ0NDk3OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-07-18T07:45:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/660444979",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r457793470"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/457793470"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is a redundant declaration, it's defined lower on line 164.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-07-21T02:09:06Z",
      "diff_hunk" : "@@ -37,6 +41,98 @@ class proxyType\n     bool randomize_credentials;\n };\n \n+struct timeval MillisToTimeval(int64_t nTimeout);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r457793470",
      "id" : 457793470,
      "line" : 44,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Nzc5MzQ3MA==",
      "original_commit_id" : "5da912d7cbf86c697f65ec777f06c3e00c57e120",
      "original_line" : 44,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/netbase.h",
      "position" : 15,
      "pull_request_review_id" : 452077139,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/457793470",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r458016843"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/458016843"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just would like to point out that this is currently unused. Is this intentional?",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-07-21T11:09:37Z",
      "diff_hunk" : "@@ -37,6 +41,91 @@ class proxyType\n     bool randomize_credentials;\n };\n \n+struct timeval MillisToTimeval(int64_t nTimeout);\n+\n+// Represents a read/write socket.\n+class Socket\n+{\n+public:\n+    virtual ssize_t send(const char* buf, size_t len, int flags) = 0;\n+\n+    virtual ssize_t recv(char* buf, size_t len, int flags) = 0;\n+\n+#ifdef USE_POLL\n+    virtual int poll(short events, int timeout_ms) = 0;\n+#endif\n+\n+    virtual int select(bool watch_read, bool watch_write, int timeout_ms) = 0;\n+\n+    virtual bool IsSelectable() const = 0;\n+};\n+\n+// Represents a non-owned SOCKET.\n+//\n+// The underlying SOCKET will NOT be closed automatically on object destruction.\n+class SocketImpl : public Socket",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r458016843",
      "id" : 458016843,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODAxNjg0Mw==",
      "original_commit_id" : "544a8705578cdecc532a209929a7ca2d846efd6a",
      "original_line" : 69,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/netbase.h",
      "position" : null,
      "pull_request_review_id" : 452077139,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/458016843",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r458020094"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/458020094"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: `m_fuzzed_data_provider` so the reference in the constructor can just be `fuzzed_data_provider`?",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-07-21T11:16:02Z",
      "diff_hunk" : "@@ -470,4 +470,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public Socket\n+{\n+    FuzzedDataProvider& fuzzed_data_provider;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r458020094",
      "id" : 458020094,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODAyMDA5NA==",
      "original_commit_id" : "4f18edbe5500033ef619659b980b257c16a3834a",
      "original_line" : 475,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 452077139,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/458020094",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r458022084"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/458022084"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Here it is still possible for `random_bytes.size() < len` since that condition is only checked if `ConsumeBool` returns true. Shouldn't the correct number of bytes be returned if possible?",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-07-21T11:20:04Z",
      "diff_hunk" : "@@ -470,4 +470,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public Socket\n+{\n+    FuzzedDataProvider& fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider_) : fuzzed_data_provider{fuzzed_data_provider_}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || fuzzed_data_provider.ConsumeBool()) {\n+            return fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = fuzzed_data_provider.ConsumeBytes<uint8_t>(len);\n+        if (random_bytes.empty()) {\n+            return fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        std::memcpy(buf, random_bytes.data(), random_bytes.size());\n+        if (fuzzed_data_provider.ConsumeBool()) {\n+            if (len > random_bytes.size()) {\n+                std::memset(buf + random_bytes.size(), 0, len - random_bytes.size());\n+            }\n+            return len;\n+        }\n+        return random_bytes.size();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r458022084",
      "id" : 458022084,
      "line" : 611,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1ODAyMjA4NA==",
      "original_commit_id" : "4f18edbe5500033ef619659b980b257c16a3834a",
      "original_line" : 611,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : 107,
      "pull_request_review_id" : 452077139,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/458022084",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470748302"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470748302"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It is used in `netbase.cpp`? :)\r\n\r\n```\r\n$ git grep SocketImpl\r\nsrc/netbase.cpp:        SocketImpl socket{hSocket};\r\nsrc/netbase.cpp:        SocketImpl socket{hSocket};\r\nsrc/netbase.h:class SocketImpl : public Socket\r\nsrc/netbase.h:    explicit SocketImpl(SOCKET socket) : m_socket{socket}\r\n```",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-08-14T17:08:04Z",
      "diff_hunk" : "@@ -37,6 +41,91 @@ class proxyType\n     bool randomize_credentials;\n };\n \n+struct timeval MillisToTimeval(int64_t nTimeout);\n+\n+// Represents a read/write socket.\n+class Socket\n+{\n+public:\n+    virtual ssize_t send(const char* buf, size_t len, int flags) = 0;\n+\n+    virtual ssize_t recv(char* buf, size_t len, int flags) = 0;\n+\n+#ifdef USE_POLL\n+    virtual int poll(short events, int timeout_ms) = 0;\n+#endif\n+\n+    virtual int select(bool watch_read, bool watch_write, int timeout_ms) = 0;\n+\n+    virtual bool IsSelectable() const = 0;\n+};\n+\n+// Represents a non-owned SOCKET.\n+//\n+// The underlying SOCKET will NOT be closed automatically on object destruction.\n+class SocketImpl : public Socket",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470748302",
      "id" : 470748302,
      "in_reply_to_id" : 458016843,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc0ODMwMg==",
      "original_commit_id" : "544a8705578cdecc532a209929a7ca2d846efd6a",
      "original_line" : 69,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/netbase.h",
      "position" : null,
      "pull_request_review_id" : 467735377,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470748302",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470750075"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470750075"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I meant that even though it's used, the coverage isn't updated for `SocketImpl` functions. Might be a bug with `lcov` perhaps.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-08-14T17:11:41Z",
      "diff_hunk" : "@@ -37,6 +41,91 @@ class proxyType\n     bool randomize_credentials;\n };\n \n+struct timeval MillisToTimeval(int64_t nTimeout);\n+\n+// Represents a read/write socket.\n+class Socket\n+{\n+public:\n+    virtual ssize_t send(const char* buf, size_t len, int flags) = 0;\n+\n+    virtual ssize_t recv(char* buf, size_t len, int flags) = 0;\n+\n+#ifdef USE_POLL\n+    virtual int poll(short events, int timeout_ms) = 0;\n+#endif\n+\n+    virtual int select(bool watch_read, bool watch_write, int timeout_ms) = 0;\n+\n+    virtual bool IsSelectable() const = 0;\n+};\n+\n+// Represents a non-owned SOCKET.\n+//\n+// The underlying SOCKET will NOT be closed automatically on object destruction.\n+class SocketImpl : public Socket",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470750075",
      "id" : 470750075,
      "in_reply_to_id" : 458016843,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc1MDA3NQ==",
      "original_commit_id" : "544a8705578cdecc532a209929a7ca2d846efd6a",
      "original_line" : 69,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/netbase.h",
      "position" : null,
      "pull_request_review_id" : 467737622,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470750075",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470751725"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470751725"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It is now used prior to L164, so it must be on L44 -- but removing L164. Thanks!",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-08-14T17:14:46Z",
      "diff_hunk" : "@@ -37,6 +41,98 @@ class proxyType\n     bool randomize_credentials;\n };\n \n+struct timeval MillisToTimeval(int64_t nTimeout);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470751725",
      "id" : 470751725,
      "in_reply_to_id" : 457793470,
      "line" : 44,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc1MTcyNQ==",
      "original_commit_id" : "5da912d7cbf86c697f65ec777f06c3e00c57e120",
      "original_line" : 44,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/netbase.h",
      "position" : 15,
      "pull_request_review_id" : 467739574,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470751725",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470753145"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470753145"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think that is expected: it is currently only from `ConnectThroughProxy` which is not fuzzed :)",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-08-14T17:17:29Z",
      "diff_hunk" : "@@ -37,6 +41,91 @@ class proxyType\n     bool randomize_credentials;\n };\n \n+struct timeval MillisToTimeval(int64_t nTimeout);\n+\n+// Represents a read/write socket.\n+class Socket\n+{\n+public:\n+    virtual ssize_t send(const char* buf, size_t len, int flags) = 0;\n+\n+    virtual ssize_t recv(char* buf, size_t len, int flags) = 0;\n+\n+#ifdef USE_POLL\n+    virtual int poll(short events, int timeout_ms) = 0;\n+#endif\n+\n+    virtual int select(bool watch_read, bool watch_write, int timeout_ms) = 0;\n+\n+    virtual bool IsSelectable() const = 0;\n+};\n+\n+// Represents a non-owned SOCKET.\n+//\n+// The underlying SOCKET will NOT be closed automatically on object destruction.\n+class SocketImpl : public Socket",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470753145",
      "id" : 470753145,
      "in_reply_to_id" : 458016843,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc1MzE0NQ==",
      "original_commit_id" : "544a8705578cdecc532a209929a7ca2d846efd6a",
      "original_line" : 69,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/netbase.h",
      "position" : null,
      "pull_request_review_id" : 467741240,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470753145",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470753243"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470753243"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good nit! Adressed!",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-08-14T17:17:43Z",
      "diff_hunk" : "@@ -470,4 +470,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public Socket\n+{\n+    FuzzedDataProvider& fuzzed_data_provider;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470753243",
      "id" : 470753243,
      "in_reply_to_id" : 458020094,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc1MzI0Mw==",
      "original_commit_id" : "4f18edbe5500033ef619659b980b257c16a3834a",
      "original_line" : 475,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 467741353,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470753243",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470755486"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470755486"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah derp! I mistakenly thought it was fuzzed for some reason, but `FuzzedSocket` is the one that's used. Is the idea that they be used together in some manner eventually?",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-08-14T17:22:29Z",
      "diff_hunk" : "@@ -37,6 +41,91 @@ class proxyType\n     bool randomize_credentials;\n };\n \n+struct timeval MillisToTimeval(int64_t nTimeout);\n+\n+// Represents a read/write socket.\n+class Socket\n+{\n+public:\n+    virtual ssize_t send(const char* buf, size_t len, int flags) = 0;\n+\n+    virtual ssize_t recv(char* buf, size_t len, int flags) = 0;\n+\n+#ifdef USE_POLL\n+    virtual int poll(short events, int timeout_ms) = 0;\n+#endif\n+\n+    virtual int select(bool watch_read, bool watch_write, int timeout_ms) = 0;\n+\n+    virtual bool IsSelectable() const = 0;\n+};\n+\n+// Represents a non-owned SOCKET.\n+//\n+// The underlying SOCKET will NOT be closed automatically on object destruction.\n+class SocketImpl : public Socket",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470755486",
      "id" : 470755486,
      "in_reply_to_id" : 458016843,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc1NTQ4Ng==",
      "original_commit_id" : "544a8705578cdecc532a209929a7ca2d846efd6a",
      "original_line" : 69,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/netbase.h",
      "position" : null,
      "pull_request_review_id" : 467744215,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470755486",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470755741"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470755741"
         }
      },
      "author_association" : "MEMBER",
      "body" : "We want to make it so that the fuzzer driven `recv` can return _up to_ `len` bytes like the real `recv`, right? :)",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-08-14T17:23:02Z",
      "diff_hunk" : "@@ -470,4 +470,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public Socket\n+{\n+    FuzzedDataProvider& fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider_) : fuzzed_data_provider{fuzzed_data_provider_}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || fuzzed_data_provider.ConsumeBool()) {\n+            return fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = fuzzed_data_provider.ConsumeBytes<uint8_t>(len);\n+        if (random_bytes.empty()) {\n+            return fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        std::memcpy(buf, random_bytes.data(), random_bytes.size());\n+        if (fuzzed_data_provider.ConsumeBool()) {\n+            if (len > random_bytes.size()) {\n+                std::memset(buf + random_bytes.size(), 0, len - random_bytes.size());\n+            }\n+            return len;\n+        }\n+        return random_bytes.size();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470755741",
      "id" : 470755741,
      "in_reply_to_id" : 458022084,
      "line" : 611,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc1NTc0MQ==",
      "original_commit_id" : "4f18edbe5500033ef619659b980b257c16a3834a",
      "original_line" : 611,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : 107,
      "pull_request_review_id" : 467744522,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470755741",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470758852"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470758852"
         }
      },
      "author_association" : "MEMBER",
      "body" : "@Crypt-iQ It is only used as a way to wrap an existing `SOCKET`  as a `Socket` instance: no further plans beyond that :)",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-08-14T17:29:03Z",
      "diff_hunk" : "@@ -37,6 +41,91 @@ class proxyType\n     bool randomize_credentials;\n };\n \n+struct timeval MillisToTimeval(int64_t nTimeout);\n+\n+// Represents a read/write socket.\n+class Socket\n+{\n+public:\n+    virtual ssize_t send(const char* buf, size_t len, int flags) = 0;\n+\n+    virtual ssize_t recv(char* buf, size_t len, int flags) = 0;\n+\n+#ifdef USE_POLL\n+    virtual int poll(short events, int timeout_ms) = 0;\n+#endif\n+\n+    virtual int select(bool watch_read, bool watch_write, int timeout_ms) = 0;\n+\n+    virtual bool IsSelectable() const = 0;\n+};\n+\n+// Represents a non-owned SOCKET.\n+//\n+// The underlying SOCKET will NOT be closed automatically on object destruction.\n+class SocketImpl : public Socket",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470758852",
      "id" : 470758852,
      "in_reply_to_id" : 458016843,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDc1ODg1Mg==",
      "original_commit_id" : "544a8705578cdecc532a209929a7ca2d846efd6a",
      "original_line" : 69,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/netbase.h",
      "position" : null,
      "pull_request_review_id" : 467748299,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470758852",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470820694"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470820694"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah, yes that makes sense, thanks for clarifying. ",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-08-14T19:15:08Z",
      "diff_hunk" : "@@ -470,4 +470,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public Socket\n+{\n+    FuzzedDataProvider& fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider_) : fuzzed_data_provider{fuzzed_data_provider_}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || fuzzed_data_provider.ConsumeBool()) {\n+            return fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = fuzzed_data_provider.ConsumeBytes<uint8_t>(len);\n+        if (random_bytes.empty()) {\n+            return fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        std::memcpy(buf, random_bytes.data(), random_bytes.size());\n+        if (fuzzed_data_provider.ConsumeBool()) {\n+            if (len > random_bytes.size()) {\n+                std::memset(buf + random_bytes.size(), 0, len - random_bytes.size());\n+            }\n+            return len;\n+        }\n+        return random_bytes.size();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r470820694",
      "id" : 470820694,
      "in_reply_to_id" : 458022084,
      "line" : 611,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3MDgyMDY5NA==",
      "original_commit_id" : "4f18edbe5500033ef619659b980b257c16a3834a",
      "original_line" : 611,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : 107,
      "pull_request_review_id" : 467819128,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/470820694",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Builds on Ubuntu.\r\nFails to build on macOS with brew clang.\r\n<details>\r\n<summary>failure</summary>\r\n\r\n```\r\nMaking all in src\r\n  CXX      test/fuzz/addition_overflow-addition_overflow.o\r\nIn file included from test/fuzz/addition_overflow.cpp:7:\r\n./test/fuzz/util.h:335:13: error: no matching function for call to 'AdditionOverflow'\r\n        if (AdditionOverflow((uint64_t)fuzzed_file->m_offset, random_bytes.size())) {\r\n            ^~~~~~~~~~~~~~~~\r\n./test/fuzz/util.h:201:16: note: candidate template ignored: deduced conflicting types for parameter 'T' ('unsigned long long' vs. 'unsigned long')\r\nNODISCARD bool AdditionOverflow(const T i, const T j) noexcept\r\n               ^\r\n./test/fuzz/util.h:346:13: error: no matching function for call to 'AdditionOverflow'\r\n        if (AdditionOverflow(fuzzed_file->m_offset, n)) {\r\n            ^~~~~~~~~~~~~~~~\r\n./test/fuzz/util.h:201:16: note: candidate template ignored: deduced conflicting types for parameter 'T' ('long long' vs. 'long')\r\nNODISCARD bool AdditionOverflow(const T i, const T j) noexcept\r\n               ^\r\n2 errors generated.\r\nmake[2]: *** [test/fuzz/addition_overflow-addition_overflow.o] Error 1\r\nmake[1]: *** [all-recursive] Error 1\r\nmake: *** [all-recursive] Error 1\r\n```\r\n</details>",
      "created_at" : "2020-09-01T05:04:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-684254689",
      "id" : 684254689,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NDI1NDY4OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-01T05:05:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/684254689",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@Crypt-iQ Thanks for letting me know. Now rebased. Should compile on macOS now? :)",
      "created_at" : "2020-09-01T14:15:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-684887029",
      "id" : 684887029,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NDg4NzAyOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-01T14:16:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/684887029",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@practicalswift Now compiles on macOS :). Will run the builds again and re-review.",
      "created_at" : "2020-09-01T19:08:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-685075098",
      "id" : 685075098,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NTA3NTA5OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-01T19:08:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/685075098",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r481735725"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/481735725"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Calling this with `-1` as the `min` parameter to `ConsumeIntegralInRange` will result in a very large range since it will be cast to `uint64_t`:\r\nhttps://github.com/bitcoin/bitcoin/blob/48c1083632687a42ac603d4f241e70616a1d3815/src/test/fuzz/FuzzedDataProvider.h#L87\r\n\r\nMaybe an alternative version of `ConsumeIntegralInRange` for just -1,0,1 can be used? Not your fault, it's the header file's fault.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-09-02T05:41:43Z",
      "diff_hunk" : "@@ -470,4 +470,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public Socket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || m_fuzzed_data_provider.ConsumeBool()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = m_fuzzed_data_provider.ConsumeBytes<uint8_t>(len);\n+        if (random_bytes.empty()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        std::memcpy(buf, random_bytes.data(), random_bytes.size());\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            if (len > random_bytes.size()) {\n+                std::memset(buf + random_bytes.size(), 0, len - random_bytes.size());\n+            }\n+            return len;\n+        }\n+        return random_bytes.size();\n+    }\n+\n+#ifdef USE_POLL\n+    int poll(short events, int timeout_ms) override\n+    {\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<int>(-1, 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r481735725",
      "id" : 481735725,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTczNTcyNQ==",
      "original_commit_id" : "2d02f775fa36c59bca5d7ef1a0e702c1bc2de117",
      "original_line" : 554,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 480497736,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/481735725",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r481735948"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/481735948"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Same here.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-09-02T05:41:57Z",
      "diff_hunk" : "@@ -470,4 +470,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public Socket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || m_fuzzed_data_provider.ConsumeBool()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = m_fuzzed_data_provider.ConsumeBytes<uint8_t>(len);\n+        if (random_bytes.empty()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        std::memcpy(buf, random_bytes.data(), random_bytes.size());\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            if (len > random_bytes.size()) {\n+                std::memset(buf + random_bytes.size(), 0, len - random_bytes.size());\n+            }\n+            return len;\n+        }\n+        return random_bytes.size();\n+    }\n+\n+#ifdef USE_POLL\n+    int poll(short events, int timeout_ms) override\n+    {\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<int>(-1, 1);\n+    }\n+#endif\n+\n+    int select(bool watch_read, bool watch_write, int timeout_ms) override\n+    {\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<int>(-1, 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r481735948",
      "id" : 481735948,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTczNTk0OA==",
      "original_commit_id" : "2d02f775fa36c59bca5d7ef1a0e702c1bc2de117",
      "original_line" : 560,
      "original_position" : 49,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 480497736,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/481735948",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r481745772"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/481745772"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nevermind, godbolt tells me I am wrong.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-09-02T05:51:38Z",
      "diff_hunk" : "@@ -470,4 +470,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public Socket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || m_fuzzed_data_provider.ConsumeBool()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = m_fuzzed_data_provider.ConsumeBytes<uint8_t>(len);\n+        if (random_bytes.empty()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        std::memcpy(buf, random_bytes.data(), random_bytes.size());\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            if (len > random_bytes.size()) {\n+                std::memset(buf + random_bytes.size(), 0, len - random_bytes.size());\n+            }\n+            return len;\n+        }\n+        return random_bytes.size();\n+    }\n+\n+#ifdef USE_POLL\n+    int poll(short events, int timeout_ms) override\n+    {\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<int>(-1, 1);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r481745772",
      "id" : 481745772,
      "in_reply_to_id" : 481735725,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4MTc0NTc3Mg==",
      "original_commit_id" : "2d02f775fa36c59bca5d7ef1a0e702c1bc2de117",
      "original_line" : 554,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 480501517,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/481745772",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK 2d02f775fa36c59bca5d7ef1a0e702c1bc2de117\r\n\r\nCode change looks good to me. I did not try to reintroduce the CVE, but I did read up about it.\r\nUbuntu 18:\r\n- `./configure --enable-fuzz --with-sanitizers=address,undefined,integer,fuzzer` - no errors\r\n- valgrind - no errors\r\n\r\nmacOS 10.15.4:\r\n- `./configure --enable-fuzz --with-sanitizers=address,fuzzer --disable-asm` - no errors\r\n- `./configure --enable-fuzz --with-sanitizers=undefined,integer,fuzzer` - one complaint (suppressed by https://github.com/bitcoin/bitcoin/pull/19713)\r\n<details>\r\n<summary>implicit-integer-sign-change</summary>\r\n\r\n```\r\n/usr/local/opt/llvm/bin/../include/c++/v1/memory:1876:35: runtime error: implicit conversion from type 'char' of value -125 (8-bit, signed) to type 'unsigned char' changed the value to 131 (8-bit, unsigned)\r\n    #0 0x1072b4bd4 in void std::__1::allocator_traits<std::__1::allocator<unsigned char> >::construct<unsigned char, char const&>(std::__1::allocator<unsigned char>&, unsigned char*, char const&) memory:1595\r\n    #1 0x1072b49f9 in void std::__1::allocator_traits<std::__1::allocator<unsigned char> >::__construct_range_forward<std::__1::__wrap_iter<char const*>, unsigned char*>(std::__1::allocator<unsigned char>&, std::__1::__wrap_iter<char const*>, std::__1::__wrap_iter<char const*>, unsigned char*&) memory:1688\r\n    #2 0x1072b3598 in std::__1::enable_if<__is_cpp17_forward_iterator<std::__1::__wrap_iter<char const*> >::value, void>::type std::__1::vector<unsigned char, std::__1::allocator<unsigned char> >::__construct_at_end<std::__1::__wrap_iter<char const*> >(std::__1::__wrap_iter<char const*>, std::__1::__wrap_iter<char const*>, unsigned long) vector:1076\r\n    #3 0x10728e2a2 in std::__1::enable_if<(__is_cpp17_forward_iterator<std::__1::__wrap_iter<char const*> >::value) && (is_constructible<unsigned char, std::__1::iterator_traits<std::__1::__wrap_iter<char const*> >::reference>::value), std::__1::__wrap_iter<unsigned char*> >::type std::__1::vector<unsigned char, std::__1::allocator<unsigned char> >::insert<std::__1::__wrap_iter<char const*> >(std::__1::__wrap_iter<unsigned char const*>, std::__1::__wrap_iter<char const*>, std::__1::__wrap_iter<char const*>) vector:1996\r\n    #4 0x10728b18c in Socks5(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, ProxyCredentials const*, Socket&) netbase.cpp:492\r\n    #5 0x10663a420 in test_one_input(std::__1::vector<unsigned char, std::__1::allocator<unsigned char> > const&) socks5.cpp:30\r\n    #6 0x107663b28 in LLVMFuzzerTestOneInput fuzz.cpp:45\r\n    #7 0x107862780 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) FuzzerLoop.cpp:556\r\n    #8 0x107861ec5 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool*) FuzzerLoop.cpp:470\r\n    #9 0x107863f76 in fuzzer::Fuzzer::MutateAndTestOne() FuzzerLoop.cpp:698\r\n    #10 0x107864be5 in fuzzer::Fuzzer::Loop(std::__1::vector<fuzzer::SizedFile, fuzzer::fuzzer_allocator<fuzzer::SizedFile> >&) FuzzerLoop.cpp:830\r\n    #11 0x107851d8d in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) FuzzerDriver.cpp:829\r\n    #12 0x10787da62 in main FuzzerMain.cpp:19\r\n    #13 0x7fff73778cc8 in start+0x0 (libdyld.dylib:x86_64+0x1acc8)\r\n```\r\n</details>",
      "created_at" : "2020-09-02T17:34:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-685889544",
      "id" : 685889544,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NTg4OTU0NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-02T17:36:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/685889544",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Had to rebase also this one to make use of the new `$(FUZZ_SUITE_LDFLAGS_COMMON)`.\r\n\r\n@Crypt-iQ May I ask you to review and hopefully give your second ACK on this PR? :)",
      "created_at" : "2020-09-17T13:38:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-694241213",
      "id" : 694241213,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NDI0MTIxMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-17T13:38:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/694241213",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK ea6cd7b2cc6b070b2630457d75b396de555b31c7",
      "created_at" : "2020-09-20T10:54:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-695773087",
      "id" : 695773087,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5NTc3MzA4Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-20T10:54:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/695773087",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/15145615?v=4",
         "events_url" : "https://api.github.com/users/Crypt-iQ/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Crypt-iQ/followers",
         "following_url" : "https://api.github.com/users/Crypt-iQ/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Crypt-iQ",
         "id" : 15145615,
         "login" : "Crypt-iQ",
         "node_id" : "MDQ6VXNlcjE1MTQ1NjE1",
         "organizations_url" : "https://api.github.com/users/Crypt-iQ/orgs",
         "received_events_url" : "https://api.github.com/users/Crypt-iQ/received_events",
         "repos_url" : "https://api.github.com/users/Crypt-iQ/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Crypt-iQ/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Crypt-iQ"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Friendly review beg :)\r\n\r\nConcept NACK:s are totally fine too: that would allow me to move forward with other fuzzing stuff without having to keep this PR updated :)",
      "created_at" : "2020-10-15T08:36:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-708994095",
      "id" : 708994095,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwODk5NDA5NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-15T08:36:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/708994095",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke Thanks for your Concept ACK. Would you mind reviewing the code too? :)",
      "created_at" : "2020-10-15T08:38:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-708994781",
      "id" : 708994781,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwODk5NDc4MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-15T08:38:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/708994781",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Sorry, I don't know enough about sockets to be able to review this.",
      "created_at" : "2020-11-10T10:21:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-724609080",
      "id" : 724609080,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNDYwOTA4MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-10T10:21:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/724609080",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke Ah, got it! Do you know who would be an appropriate reviewer? :)\r\n\r\nFWIW I think sipa wrote the `Socks5(...)` code originally in #1141.\r\n\r\nAny review help welcome! Concept NACK is obviously fine too: I just want to move forward towards close (due to NACK or close due to merge) :)",
      "created_at" : "2020-11-10T10:27:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-724612684",
      "id" : 724612684,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNDYxMjY4NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-10T10:27:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/724612684",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased. Now using the names `MockableSocket`, `Socket` and `FuzzedSocket`.\r\n\r\n`Socket` and `FuzzedSocket` both implement `MockableSocket`.\r\n\r\nThe introduced `src/test/fuzz/socks5` would have caught the [CVE-2017-18350](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2019-November/017453.html) buffer overflow (which I caught via code review rather than fuzzing) within literally seconds of fuzzing :)",
      "created_at" : "2020-11-13T10:07:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-726673274",
      "id" : 726673274,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNjY3MzI3NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-13T10:07:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/726673274",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-12-15T18:41:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-745486342",
      "id" : 745486342,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0NTQ4NjM0Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-15T18:41:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/745486342",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546625544"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546625544"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just a note: this could return `0` from `send()`. I am not sure if [`send(2)`](https://linux.die.net/man/2/send) could ever [return `0`](https://stackoverflow.com/questions/3081952/with-c-tcp-sockets-can-send-return-zero#3082032):\r\n\r\n> On success, these calls return the number of characters sent. On error, -1 is returned\r\n\r\nanyway, I think it is ok to return `0` - to check that our code does not get bricked by that (in case `send(2)` actually returns `0`).",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T10:24:32Z",
      "diff_hunk" : "@@ -512,4 +512,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public MockableSocket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546625544",
      "id" : 546625544,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjYyNTU0NA==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 529,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 556276078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546625544",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546628691"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546628691"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think it would be good to set `errno` if we are going to return an error (`-1`). Application reaction on error should differ depending on the value of `errno` (should retry on \"temporary\" errors).",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T10:30:54Z",
      "diff_hunk" : "@@ -512,4 +512,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public MockableSocket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546628691",
      "id" : 546628691,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjYyODY5MQ==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 529,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 556276078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546628691",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546630296"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546630296"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Maybe assert that if `buf` is `nullptr` then `len` is `0` before this `if` and then remove `buf == nullptr` from here.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T10:34:32Z",
      "diff_hunk" : "@@ -512,4 +512,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public MockableSocket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || m_fuzzed_data_provider.ConsumeBool()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546630296",
      "id" : 546630296,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjYzMDI5Ng==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 534,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 556276078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546630296",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546631891"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546631891"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Here and above, set `errno` to some \"random\" value if we are going to return `-1`. Maybe the \"random\" value should have higher probablitity of being one of `EAGAIN`, `EWOULDBLOCK`, `EINTR` or `EINPROGRESS`.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T10:37:51Z",
      "diff_hunk" : "@@ -512,4 +512,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public MockableSocket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || m_fuzzed_data_provider.ConsumeBool()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = m_fuzzed_data_provider.ConsumeBytes<uint8_t>(len);\n+        if (random_bytes.empty()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546631891",
      "id" : 546631891,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjYzMTg5MQ==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 539,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 556276078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546631891",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546633217"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546633217"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why this? `recv(2)` would never set the remaining buffer to `0x0` bytes.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T10:40:34Z",
      "diff_hunk" : "@@ -512,4 +512,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public MockableSocket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || m_fuzzed_data_provider.ConsumeBool()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = m_fuzzed_data_provider.ConsumeBytes<uint8_t>(len);\n+        if (random_bytes.empty()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        std::memcpy(buf, random_bytes.data(), random_bytes.size());\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            if (len > random_bytes.size()) {\n+                std::memset(buf + random_bytes.size(), 0, len - random_bytes.size());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546633217",
      "id" : 546633217,
      "line" : 607,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjYzMzIxNw==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 607,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : 103,
      "pull_request_review_id" : 556276078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546633217",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546634939"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546634939"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What is the likelihood of this returning less than `len`? The `ConsumeBytes()` comment says:\r\n\r\n> ... If fewer than\r\n  // |num_bytes| of data remain, returns a shorter std::vector containing all\r\n  // of the data that's left.\r\n\r\nI think we should make it more likely that this fuzzed `recv()` returns a partial read because this is when the \"interesting\" things happen in the app code as it should retry.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T10:44:19Z",
      "diff_hunk" : "@@ -512,4 +512,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public MockableSocket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || m_fuzzed_data_provider.ConsumeBool()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = m_fuzzed_data_provider.ConsumeBytes<uint8_t>(len);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546634939",
      "id" : 546634939,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjYzNDkzOQ==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 596,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 556276078,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546634939",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546824364"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546824364"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'd prefer to have this implementation in an implementation unit instead of the header. This is not a templated class and implementing virtual methods can be done everywhere.\r\nThis would also avoid adding the optional include `poll.h` here, I think.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T17:08:22Z",
      "diff_hunk" : "@@ -37,6 +41,101 @@ class proxyType\n     bool randomize_credentials;\n };\n \n+/**\n+ * Convert milliseconds to a struct timeval for e.g. select.\n+ */\n+struct timeval MillisToTimeval(int64_t nTimeout);\n+\n+// Represents a read/write socket.\n+class MockableSocket\n+{\n+public:\n+    virtual ssize_t send(const char* buf, size_t len, int flags) = 0;\n+\n+    virtual ssize_t recv(char* buf, size_t len, int flags) = 0;\n+\n+#ifdef USE_POLL\n+    virtual int poll(short events, int timeout_ms) = 0;\n+#endif\n+\n+    virtual int select(bool watch_read, bool watch_write, int timeout_ms) = 0;\n+\n+    virtual bool IsSelectable() const = 0;\n+};\n+\n+// Represents a non-owned SOCKET.\n+//\n+// The underlying SOCKET will NOT be closed automatically on object destruction.\n+class Socket : public MockableSocket\n+{\n+    SOCKET m_socket = INVALID_SOCKET;\n+\n+public:\n+    explicit Socket(SOCKET socket) : m_socket{socket}\n+    {\n+    }\n+\n+    // Send bytes on the socket. See send(2).\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        return ::send(m_socket, buf, len, flags);\n+    }\n+\n+    // Receive bytes from the socket. See recv(2).\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        return ::recv(m_socket, buf, len, flags);\n+    }\n+\n+#ifdef USE_POLL",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546824364",
      "id" : 546824364,
      "line" : 81,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NjgyNDM2NA==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 81,
      "original_position" : 63,
      "original_start_line" : null,
      "path" : "src/netbase.h",
      "position" : 52,
      "pull_request_review_id" : 556532204,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546824364",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-12-21T17:08:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-749089371",
      "id" : 749089371,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0OTA4OTM3MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-21T17:08:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/749089371",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546853431"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546853431"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point! Pushed an updated version addressing this.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T18:09:19Z",
      "diff_hunk" : "@@ -512,4 +512,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public MockableSocket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546853431",
      "id" : 546853431,
      "in_reply_to_id" : 546628691,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njg1MzQzMQ==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 529,
      "original_position" : 18,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 556569534,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546853431",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546853482"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546853482"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point! Pushed an updated version addressing this.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T18:09:27Z",
      "diff_hunk" : "@@ -512,4 +512,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public MockableSocket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || m_fuzzed_data_provider.ConsumeBool()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546853482",
      "id" : 546853482,
      "in_reply_to_id" : 546630296,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njg1MzQ4Mg==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 534,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 556569616,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546853482",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546853754"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546853754"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point! Pushed an updated version addressing this.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T18:10:03Z",
      "diff_hunk" : "@@ -512,4 +512,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public MockableSocket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || m_fuzzed_data_provider.ConsumeBool()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = m_fuzzed_data_provider.ConsumeBytes<uint8_t>(len);\n+        if (random_bytes.empty()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546853754",
      "id" : 546853754,
      "in_reply_to_id" : 546631891,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njg1Mzc1NA==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 539,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 556569976,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546853754",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546863947"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546863947"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point! Pushed an updated version addressing this.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T18:32:55Z",
      "diff_hunk" : "@@ -37,6 +41,101 @@ class proxyType\n     bool randomize_credentials;\n };\n \n+/**\n+ * Convert milliseconds to a struct timeval for e.g. select.\n+ */\n+struct timeval MillisToTimeval(int64_t nTimeout);\n+\n+// Represents a read/write socket.\n+class MockableSocket\n+{\n+public:\n+    virtual ssize_t send(const char* buf, size_t len, int flags) = 0;\n+\n+    virtual ssize_t recv(char* buf, size_t len, int flags) = 0;\n+\n+#ifdef USE_POLL\n+    virtual int poll(short events, int timeout_ms) = 0;\n+#endif\n+\n+    virtual int select(bool watch_read, bool watch_write, int timeout_ms) = 0;\n+\n+    virtual bool IsSelectable() const = 0;\n+};\n+\n+// Represents a non-owned SOCKET.\n+//\n+// The underlying SOCKET will NOT be closed automatically on object destruction.\n+class Socket : public MockableSocket\n+{\n+    SOCKET m_socket = INVALID_SOCKET;\n+\n+public:\n+    explicit Socket(SOCKET socket) : m_socket{socket}\n+    {\n+    }\n+\n+    // Send bytes on the socket. See send(2).\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        return ::send(m_socket, buf, len, flags);\n+    }\n+\n+    // Receive bytes from the socket. See recv(2).\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        return ::recv(m_socket, buf, len, flags);\n+    }\n+\n+#ifdef USE_POLL",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546863947",
      "id" : 546863947,
      "in_reply_to_id" : 546824364,
      "line" : 81,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njg2Mzk0Nw==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 81,
      "original_position" : 63,
      "original_start_line" : null,
      "path" : "src/netbase.h",
      "position" : 52,
      "pull_request_review_id" : 556582773,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546863947",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546962270"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546962270"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is intentional:\r\n\r\nIf `m_fuzzed_data_provider.ConsumeBool()` we pretend to read `len` bytes but we only consume `random_bytes.size()` from the fuzzing input and let the remaining bytes be `0x0`.\r\n\r\nThat way we can satisfy a read of say 4096 bytes even if we only have say 20 bytes of input left: 20 bytes will be real data from the input and 4076 bytes will be `0x0` bytes.\r\n\r\nMakes sense? :)",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T22:32:01Z",
      "diff_hunk" : "@@ -512,4 +512,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public MockableSocket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || m_fuzzed_data_provider.ConsumeBool()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = m_fuzzed_data_provider.ConsumeBytes<uint8_t>(len);\n+        if (random_bytes.empty()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        std::memcpy(buf, random_bytes.data(), random_bytes.size());\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            if (len > random_bytes.size()) {\n+                std::memset(buf + random_bytes.size(), 0, len - random_bytes.size());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546962270",
      "id" : 546962270,
      "in_reply_to_id" : 546633217,
      "line" : 607,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njk2MjI3MA==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 607,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : 103,
      "pull_request_review_id" : 556704422,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:46:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546962270",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546964547"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546964547"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point! Pushed an updated version addressing this.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-21T22:38:41Z",
      "diff_hunk" : "@@ -512,4 +512,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public MockableSocket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || m_fuzzed_data_provider.ConsumeBool()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = m_fuzzed_data_provider.ConsumeBytes<uint8_t>(len);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r546964547",
      "id" : 546964547,
      "in_reply_to_id" : 546634939,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0Njk2NDU0Nw==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 596,
      "original_position" : 26,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : null,
      "pull_request_review_id" : 556707041,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-21T22:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/546964547",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj @vasild \r\n\r\nThanks for very good review feedback!\r\n\r\nI believe I've addressed all the issues raised. Please re-review :)",
      "created_at" : "2020-12-21T22:39:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-749237405",
      "id" : 749237405,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0OTIzNzQwNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-21T22:39:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/749237405",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r547206605"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/547206605"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh yes, we return `len`. Sorry for the noise.",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2020-12-22T10:48:51Z",
      "diff_hunk" : "@@ -512,4 +512,63 @@ void ReadFromStream(FuzzedDataProvider& fuzzed_data_provider, Stream& stream) no\n     }\n }\n \n+class FuzzedSocket : public MockableSocket\n+{\n+    FuzzedDataProvider& m_fuzzed_data_provider;\n+\n+public:\n+    explicit FuzzedSocket(FuzzedDataProvider& fuzzed_data_provider) : m_fuzzed_data_provider{fuzzed_data_provider}\n+    {\n+    }\n+\n+    ssize_t send(const char* buf, size_t len, int flags) override\n+    {\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            return len;\n+        }\n+        return m_fuzzed_data_provider.ConsumeIntegralInRange<ssize_t>(-1, len);\n+    }\n+\n+    ssize_t recv(char* buf, size_t len, int flags) override\n+    {\n+        if (buf == nullptr || len == 0 || m_fuzzed_data_provider.ConsumeBool()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        const std::vector<uint8_t> random_bytes = m_fuzzed_data_provider.ConsumeBytes<uint8_t>(len);\n+        if (random_bytes.empty()) {\n+            return m_fuzzed_data_provider.ConsumeBool() ? 0 : -1;\n+        }\n+        std::memcpy(buf, random_bytes.data(), random_bytes.size());\n+        if (m_fuzzed_data_provider.ConsumeBool()) {\n+            if (len > random_bytes.size()) {\n+                std::memset(buf + random_bytes.size(), 0, len - random_bytes.size());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r547206605",
      "id" : 547206605,
      "in_reply_to_id" : 546633217,
      "line" : 607,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzIwNjYwNQ==",
      "original_commit_id" : "b7a45b35555c195bd417f52b7b709cd69cc580b6",
      "original_line" : 607,
      "original_position" : 33,
      "original_start_line" : null,
      "path" : "src/test/fuzz/util.h",
      "position" : 103,
      "pull_request_review_id" : 556988642,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-22T10:48:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/547206605",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I am considering how to make a RAII socket class...\r\n\r\nWhat about something like this: https://github.com/vasild/bitcoin/commit/bf3fa6a10a69f3d0dbd84188e3ba089a19248b20?",
      "created_at" : "2020-12-23T15:49:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-750359147",
      "id" : 750359147,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MDM1OTE0Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-23T15:50:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/750359147",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@vasild Great! Would you mind submitting that as a separate PR? :)",
      "created_at" : "2020-12-27T17:24:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-751493896",
      "id" : 751493896,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MTQ5Mzg5Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-27T17:24:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/751493896",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @vasild Great! Would you mind submitting that as a separate PR? :)\r\n\r\nHere it is: https://github.com/bitcoin/bitcoin/pull/20788. If it gets merged, then the first commit in this PR can be dropped.",
      "created_at" : "2020-12-28T16:19:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-751771010",
      "id" : 751771010,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MTc3MTAxMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-28T16:19:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/751771010",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r553462191"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553462191"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This could be in the `#else` of `USE_POLL`?",
      "commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "created_at" : "2021-01-07T17:09:49Z",
      "diff_hunk" : "@@ -37,6 +38,79 @@ class proxyType\n     bool randomize_credentials;\n };\n \n+/**\n+ * Convert milliseconds to a struct timeval for e.g. select.\n+ */\n+struct timeval MillisToTimeval(int64_t nTimeout);\n+\n+// Represents a read/write socket.\n+class MockableSocket\n+{\n+public:\n+    virtual ssize_t send(const char* buf, size_t len, int flags) = 0;\n+\n+    virtual ssize_t recv(char* buf, size_t len, int flags) = 0;\n+\n+#ifdef USE_POLL\n+    virtual int poll(short events, int timeout_ms) = 0;\n+#endif\n+\n+    virtual int select(bool watch_read, bool watch_write, int timeout_ms) = 0;\n+\n+    virtual bool IsSelectable() const = 0;\n+};\n+\n+// Represents a non-owned SOCKET.\n+//\n+// The underlying SOCKET will NOT be closed automatically on object destruction.\n+class Socket : public MockableSocket\n+{\n+    SOCKET m_socket = INVALID_SOCKET;\n+\n+public:\n+    explicit Socket(SOCKET socket) : m_socket{socket}\n+    {\n+    }\n+\n+    // Send bytes on the socket. See send(2).\n+    ssize_t send(const char* buf, size_t len, int flags) override;\n+\n+    // Receive bytes from the socket. See recv(2).\n+    ssize_t recv(char* buf, size_t len, int flags) override;\n+\n+#ifdef USE_POLL\n+    // Simplified poll(2) interface: Wait until the socket becomes ready for\n+    // reading, writing or other events. Timeout after timeout_ms milliseconds.\n+    // See poll(2) for return values.\n+    //\n+    // The input parameter field is a bit mask specifying the event(s) the\n+    // application is interested in.\n+    //\n+    // The bits that may be set in events are defined in <poll.h>. Examples\n+    // include:\n+    // * POLLIN: There is data to read.\n+    // * POLLOUT: Writing is now possible, though a write larger that the\n+    //   available space in a socket will still block (unless O_NONBLOCK is\n+    //   set).\n+    int poll(short events, int timeout_ms) override;\n+#endif\n+\n+    // Simplified select(2) interface: Wait until the socket becomes ready for\n+    // reading (if watch_read) and/or writing (if watch_write). Timeout after\n+    // timeout_ms milliseconds. See select(2) for return values.\n+    int select(bool watch_read, bool watch_write, int timeout_ms) override;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#discussion_r553462191",
      "id" : 553462191,
      "line" : 101,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzQ2MjE5MQ==",
      "original_commit_id" : "0370d7a22a4316dc11c4c85abc94f32cf960cf4c",
      "original_line" : 101,
      "original_position" : 72,
      "original_start_line" : null,
      "path" : "src/netbase.h",
      "position" : 72,
      "pull_request_review_id" : 563665038,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19203",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-07T17:09:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553462191",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I still like the concept of this very much, but I just wondered if there isn't a general way to fuzz network applications that doesn't require wrapping every BSD socketsI call. I mean it *seem* like something people would want to commonly do.",
      "created_at" : "2021-01-07T17:16:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-756254507",
      "id" : 756254507,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NjI1NDUwNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-07T17:16:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/756254507",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@laanwj It is possible to override functions (e.g. `send(2)`) without modifying the source code with `LD_PRELOAD`. I think that is not supported by the current testing framework, out of the box? ",
      "created_at" : "2021-01-14T11:00:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-760123106",
      "id" : 760123106,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2MDEyMzEwNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-14T11:00:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/760123106",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I still like the concept of this very much, but I just wondered if there isn't a general way to fuzz network applications that doesn't require wrapping every BSD socketsI call. I mean it _seem_ like something people would want to commonly do.\r\n\r\nEasy fuzzing of networking code is unfortunately an unsolved problem generally AFAIK.\r\n\r\nThere have been many attempts to solve this by using `LD_PRELOAD` hacks as @vasild mentions. One notable example is [`preeny`'s `desock`](https://github.com/zardus/preeny). My experience is that these `LD_PRELOAD` hacks are pretty fragile and while they might be good enough for short-term one-off fuzzing jobs (think targeted vulnerability research) they are not suitable for more long-term robustness testing needs like in our case.\r\n\r\nThe best \"off the shelf\" solution to this problem I've seen is what Honggfuzz is doing with its networking mode `libhfnetdriver` (see http://blog.swiecki.net/2018/01/fuzzing-tcp-servers.html). Unfortunately that solutions is limited to Honggfuzz and it is more suited for \"macro level\" networking code fuzzing than the more \"micro level\" networking code fuzzing this PR targets.\r\n\r\nThat said: Honggfuzz NetDriver is great too have in the toolbox too: I've tried documenting how to fuzz Bitcoin Core using Honggfuzz's networking mode. See the unmerged PR #20380 (\"doc: Add instructions on how to fuzz the P2P layer using Honggfuzz NetDriver\"). Review welcome! :)\r\n\r\ntl;dr -- Mocked networking functions driven by `FuzzedDataProvider` as suggested in this PR is AFAICT the most robust and appropriate way to solve our low-level network fuzzing needs. That said it would be interesting to know if anyone has any alternative approach which is both robust and fuzzer engine agnostic: automated robustness testing of networking code is an active area of research :)\r\n\r\n",
      "created_at" : "2021-01-14T11:35:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-760141077",
      "id" : 760141077,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2MDE0MTA3Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-14T11:36:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/760141077",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> tl;dr -- Mocked networking functions driven by FuzzedDataProvider as suggested in this PR is AFAICT the most robust and appropriate way to solve our low-level network fuzzing needs.\r\n\r\nSure. Fair enough. It's just that I'm in principle not a fan of wrapping and abstracting basic operating system APIs such as BSD Sockets because anyone contributing to the code has to learn a special interface instead of being up to speed quickly with what they already know. It's also another moving part that could have bugs itself.\r\n\r\nThat said, it seems this is useful for other things such as I2P support so that seems enough of a motivation to do it anyway. If we do it, it would be good to do so at a global level as #20788 does.",
      "created_at" : "2021-01-24T21:59:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-766439500",
      "id" : 766439500,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NjQzOTUwMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-24T21:59:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/766439500",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> anyone contributing to the code has to learn a special interface instead of being up to speed quickly with what they already know\r\n\r\nIndeed! This is why #20788 mimics the system interface:\r\n\r\n```cpp\r\nssize_t ret = recv(socket, data, len, 0);\r\n// vs (same arguments, return type and semantic)\r\nssize_t ret = sock.Recv(data, len, 0);\r\n```",
      "created_at" : "2021-01-25T10:03:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-766701314",
      "id" : 766701314,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NjcwMTMxNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-25T10:03:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/766701314",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj Good points. When/if @vasild's #20788 is merged I'll use that facility instead :)",
      "created_at" : "2021-01-26T09:34:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19203#issuecomment-767420285",
      "id" : 767420285,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19203",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc2NzQyMDI4NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-26T09:34:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/767420285",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   }
]
