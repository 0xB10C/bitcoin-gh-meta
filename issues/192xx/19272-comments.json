[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19272#discussion_r439822415"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19272"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/439822415"
         }
      },
      "author_association" : "MEMBER",
      "body" : "splitting up msg_type and size could match them on different lines, while we want to match both on the same line",
      "commit_id" : "6b18bfefed402a904db45a19b9cd8c1cb5d4c337",
      "created_at" : "2020-06-14T11:59:37Z",
      "diff_hunk" : "@@ -93,40 +101,47 @@ def test_msgtype(self):\n             conn.sync_with_ping(timeout=1)\n             self.nodes[0].disconnect_p2ps()\n \n-    def test_large_inv(self):\n-        conn = self.nodes[0].add_p2p_connection(P2PInterface())\n-        with self.nodes[0].assert_debug_log(['Misbehaving', 'peer=4 (0 -> 20): message inv size() = 50001']):\n-            msg = msg_inv([CInv(MSG_TX, 1)] * 50001)\n-            conn.send_and_ping(msg)\n-        with self.nodes[0].assert_debug_log(['Misbehaving', 'peer=4 (20 -> 40): message getdata size() = 50001']):\n-            msg = msg_getdata([CInv(MSG_TX, 1)] * 50001)\n-            conn.send_and_ping(msg)\n-        with self.nodes[0].assert_debug_log(['Misbehaving', 'peer=4 (40 -> 60): headers message size = 2001']):\n-            msg = msg_headers([CBlockHeader()] * 2001)\n-            conn.send_and_ping(msg)\n+    def test_oversized(self, msg_type, msg, size):\n+        self.log.info(\"Test {} message of size {} is logged as misbehaving\".format(msg_type, size))\n+        with self.nodes[0].assert_debug_log(['Misbehaving', msg_type, str(size)]):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19272#discussion_r439822415",
      "id" : 439822415,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTgyMjQxNQ==",
      "original_commit_id" : "bc42270f216454fb9fb79183cb4a159d0f92f9c1",
      "original_line" : 106,
      "original_position" : 79,
      "original_start_line" : null,
      "path" : "test/functional/p2p_invalid_messages.py",
      "position" : null,
      "pull_request_review_id" : 430212838,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19272",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-14T19:48:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/439822415",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19145 (Add hash_type options for gettxoutsetinfo by fjahr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-06-14T18:01:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19272#issuecomment-643800731",
      "id" : 643800731,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19272",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MzgwMDczMQ==",
      "updated_at" : "2020-06-14T18:01:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/643800731",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19272#discussion_r439861808"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19272"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/439861808"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Good point! Fixed. This made it apparent that in `net_processing.cpp` the debug logging for misbehaving from `headers` message size was a bit different from the equivalent misbehavior logging for `inv`, `getdata`, and `addr` message sizes. Fixed. If we don't want to touch it, we can also have each test pass in their own debug log message to test for.",
      "commit_id" : "6b18bfefed402a904db45a19b9cd8c1cb5d4c337",
      "created_at" : "2020-06-14T19:47:42Z",
      "diff_hunk" : "@@ -93,40 +101,47 @@ def test_msgtype(self):\n             conn.sync_with_ping(timeout=1)\n             self.nodes[0].disconnect_p2ps()\n \n-    def test_large_inv(self):\n-        conn = self.nodes[0].add_p2p_connection(P2PInterface())\n-        with self.nodes[0].assert_debug_log(['Misbehaving', 'peer=4 (0 -> 20): message inv size() = 50001']):\n-            msg = msg_inv([CInv(MSG_TX, 1)] * 50001)\n-            conn.send_and_ping(msg)\n-        with self.nodes[0].assert_debug_log(['Misbehaving', 'peer=4 (20 -> 40): message getdata size() = 50001']):\n-            msg = msg_getdata([CInv(MSG_TX, 1)] * 50001)\n-            conn.send_and_ping(msg)\n-        with self.nodes[0].assert_debug_log(['Misbehaving', 'peer=4 (40 -> 60): headers message size = 2001']):\n-            msg = msg_headers([CBlockHeader()] * 2001)\n-            conn.send_and_ping(msg)\n+    def test_oversized(self, msg_type, msg, size):\n+        self.log.info(\"Test {} message of size {} is logged as misbehaving\".format(msg_type, size))\n+        with self.nodes[0].assert_debug_log(['Misbehaving', msg_type, str(size)]):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19272#discussion_r439861808",
      "id" : 439861808,
      "in_reply_to_id" : 439822415,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTg2MTgwOA==",
      "original_commit_id" : "bc42270f216454fb9fb79183cb4a159d0f92f9c1",
      "original_line" : 106,
      "original_position" : 79,
      "original_start_line" : null,
      "path" : "test/functional/p2p_invalid_messages.py",
      "position" : null,
      "pull_request_review_id" : 430246154,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19272",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-14T19:48:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/439861808",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
