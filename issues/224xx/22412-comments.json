[
   {
      "author_association" : "MEMBER",
      "body" : "Thank you for your contribution. However we do not accept patches that are only meant for downstream projects that are shipping modified versions of Bitcoin Core. This project's goal is to maintain the vanilla version of Bitcoin Core.\r\n\r\nhttps://github.com/bitcoin-core/univalue/commit/98fadc090984fa7e070b6c41ccb514f69a371c85",
      "created_at" : "2021-07-07T07:06:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-875345174",
      "id" : 875345174,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTM0NTE3NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-07T08:17:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875345174",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Happy to reopen for more feedback",
      "created_at" : "2021-07-07T08:25:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-875400254",
      "id" : 875400254,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTQwMDI1NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-07T08:25:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875400254",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Fixes regressions introduced by #20012 and #21302\r\n\r\nDo we need tests to prevent such regressions in the future?",
      "created_at" : "2021-07-07T08:33:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-875406596",
      "id" : 875406596,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTQwNjU5Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-07T08:33:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875406596",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Agree that this needs tests if it is decided that the workaround should be applied. Also the minimum dependency version should be properly documented in https://github.com/bitcoin/bitcoin/blob/master/doc/dependencies.md#dependencies to have an objective criteria to decide on what workarounds are acceptable and which ones are not. Currently it is not documented and I (incorrectly?) assumed that only the bundled univalue is supported. The lack of clarification will lead to subjective disagreement about what versions are supported.\r\n\r\nFinally, the patch seems incomplete anyway. It is a workaround for the fix for arrays I submitted in https://github.com/bitcoin-core/univalue/commit/98fadc090984fa7e070b6c41ccb514f69a371c85, however it doesn't seem to address the same issue that was fixed for dictionaries in https://github.com/bitcoin-core/univalue/commit/51d3ab34ba2857f0d03dc07250cb4a2b5e712e67",
      "created_at" : "2021-07-07T08:57:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-875422895",
      "id" : 875422895,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTQyMjg5NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-07T08:57:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875422895",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "To reply to my own comment: The minimum required univalue version is hidden in the configure.ac. The last time it was bumped was https://github.com/bitcoin/bitcoin/pull/12666 to require the bool dictionary fix.\r\n\r\nSo Concept NACK on this pull. I'd prefer to bump the minimum univalue dependency to require the bool array fix. This is a reliable fix for the bug (unlike this pull request) that also prevents the bug from silently appearing again.",
      "created_at" : "2021-07-07T09:15:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-875437216",
      "id" : 875437216,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTQzNzIxNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-07T09:15:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875437216",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22412#discussion_r665299861"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22412"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/665299861"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This note is only true for broken versions of univalue. push_back in our tree works just fine.",
      "commit_id" : "5e4b9513be85810b619b0a6079d82c9e3f45c8cc",
      "created_at" : "2021-07-07T11:54:45Z",
      "diff_hunk" : "@@ -606,8 +606,9 @@ void RPCHelpMan::AppendArgMap(UniValue& arr) const\n             map.push_back(m_name);\n             map.push_back(i);\n             map.push_back(arg_name);\n-            map.push_back(arg.m_type == RPCArg::Type::STR ||\n-                          arg.m_type == RPCArg::Type::STR_HEX);\n+            // NOTE: push_back(bool) converts the bool to Number, so explicitly make a boolean UniValue first",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22412#discussion_r665299861",
      "id" : 665299861,
      "line" : 609,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY2NTI5OTg2MQ==",
      "original_commit_id" : "5e4b9513be85810b619b0a6079d82c9e3f45c8cc",
      "original_line" : 609,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/rpc/util.cpp",
      "position" : 6,
      "pull_request_review_id" : 700912015,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22412",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-07-07T11:55:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/665299861",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">However we do not accept patches that are only meant for downstream projects that are shipping modified versions of Bitcoin Core. \r\n\r\nMany changes that benefit other projects (eg, Liquid) have been accepted into Core. This particular fix, however, affects Core itself, without modifications.\r\n\r\n>Do we need tests to prevent such regressions in the future?\r\n\r\nIt would be good to get one of the CI tasks using official UniValue, yes. That would have caught this. However, many of our tests don't differentiate between Number and boolean JSON return values, and would have ignored the issue if the bug hadn't been in the test itself.\r\n\r\nPersonally, I have modified my UniValue to give a deprecation warning when push_back(bool) is used. That could be put in our UniValue fork - or perhaps there's a way to make it stronger (ie, an error)?\r\n\r\n> Also the minimum dependency version should be properly documented in https://github.com/bitcoin/bitcoin/blob/master/doc/dependencies.md\r\n\r\nDone\r\n\r\n>So Concept NACK on this pull. I'd prefer to bump the minimum univalue dependency to require the bool array fix. This is a reliable fix for the bug (unlike this pull request) that also prevents the bug from silently appearing again.\r\n\r\nFor that approach, the fix needs to be released upstream first. AFAIK, you have never submitted it upstream (despite me bringing it to your attention previously), so that hasn't even begun...\r\n\r\nUntil that happens, this fix is needed.",
      "created_at" : "2021-07-07T17:22:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-875787304",
      "id" : 875787304,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTc4NzMwNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-07T17:22:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875787304",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #22006 by 0xB10C\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-07-08T00:52:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876032639",
      "id" : 876032639,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22412",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NjAzMjYzOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-08T00:52:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/876032639",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
