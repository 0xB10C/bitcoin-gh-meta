[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Huh... I don't know much about the GCC ABI, could you enlighten me as to why this doesn't apply to us?",
      "created_at" : "2021-07-06T21:00:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22410#issuecomment-875078046",
      "id" : 875078046,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22410",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTA3ODA0Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-06T21:00:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875078046",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "My understanding is that this is just a warning not to link objects compiled with pre- and post-7.1 together.\r\n\r\nEDIT: this seems to confirm that: https://stackoverflow.com/q/52020305/8342274",
      "created_at" : "2021-07-06T21:19:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22410#issuecomment-875089045",
      "id" : 875089045,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22410",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTA4OTA0NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-06T21:24:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875089045",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "We use `-Wno-psabi` in CI, and I use it for my arm binaries.",
      "created_at" : "2021-07-07T06:47:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22410#issuecomment-875334244",
      "id" : 875334244,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22410",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTMzNDI0NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-07T06:47:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875334244",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> My understanding is that this is just a warning not to link objects compiled with pre- and post-7.1 together.\r\n\r\nCorrect. It doesn't apply to us while building the distribution binaries because we use the same C and C++ compilers for everything including the dependencies.\r\n\r\nACK 1edddf5de41b053049ce0b0bdbc39c2fbb743c40",
      "created_at" : "2021-07-07T10:56:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22410#issuecomment-875506040",
      "id" : 875506040,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22410",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTUwNjA0MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-07T10:56:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875506040",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah! In that case, ACK 5016091dd8b827c74fe28212be43d3b22014c5b6",
      "created_at" : "2021-07-07T20:38:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22410#issuecomment-875916363",
      "id" : 875916363,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22410",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NTkxNjM2Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-07T20:38:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/875916363",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It's a bit annoying that there doesn't seem to be a way to suppress these warnings with any sort of granularity, and the only option is disabling ABI warnings wholesale. Although I'm wondering if this is some buggy behaviour in GCC?\r\n\r\nIdeally we could just tell GCC that we don't care about ABI related warnings for any ABI changes that happened before GCC 8.5 (i.e [ABI version 13](https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Dialect-Options.html), from G++ 8.2), given that's what we are using to compile all code for the `arm-linux-gnueabihf` target.\r\n\r\nI took a minified test case from the [bug in question](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=77728):\r\n```cpp\r\n#include <stdarg.h>\r\n\r\ntemplate <int N> struct A { double p; };\r\n\r\nA<0> v;\r\n\r\ntemplate <int N> struct B {\r\n\ttypedef A<N> T;\r\n\tint i, j;\r\n};\r\n\r\nint fn1(int a, B<0> b) {\r\n\treturn a + b.i;\r\n}\r\n\r\nint main() {\r\n\treturn 0;\r\n}\r\n```\r\n\r\nwhich produces the warning we're seeing:\r\n```bash\r\n# arm-linux-gnueabihf-g++ --version\r\n# arm-linux-gnueabihf-g++ (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0\r\n\r\narm-linux-gnueabihf-g++ abi.cpp -std=c++17\r\n\r\nabi.cpp: In function âint fn1(int, B<0>)â:\r\nabi.cpp:12:5: note: parameter passing for argument of type âB<0>â changed in GCC 7.1\r\n   12 | int fn1(int a, B<0> b) {\r\n      |     ^~~\r\n```\r\n\r\nI assumed with some combination of the [`-Wabi=X`](https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html) or [`-fabi-(compat)-version=X`](https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Dialect-Options.html) options you'd be able to suppress the warning output, but I can't find a combination that works.\r\n\r\nNote that if you compile with `-Wabi` (these warnings are emitted regardless), GCC tells you that it wont warn about anything, unless you've set a `-fabi-version=` to something other than the default (0 or 13 in our case), but still warns:\r\n```bash\r\narm-linux-gnueabihf-g++ abi.cpp -std=c++17 -Wabi\r\ncc1plus: warning: â-Wabiâ wonât warn about anything [-Wabi]\r\ncc1plus: note: â-Wabiâ warns about differences from the most up-to-date ABI, which is also used by default\r\ncc1plus: note: use e.g. â-Wabi=11â to warn about changes from GCC 7\r\nabi.cpp: In function âint fn1(int, B<0>)â:\r\nabi.cpp:12:5: note: parameter passing for argument of type âB<0>â changed in GCC 7.1\r\n   12 | int fn1(int a, B<0> b) {\r\n      |     ^~~\r\n```\r\n\r\nIf you set `-fabi-verison=12` (G++ 8.0), GCC no longer tells you that it won't warn, but it still emits the warnings about changes in GCC 7.1:\r\n```bash\r\narm-linux-gnueabihf-g++ abi.cpp -std=c++17 -fabi-version=12\r\nabi.cpp: In function âint fn1(int, B<0>)â:\r\nabi.cpp:12:5: note: parameter passing for argument of type âB<0>â changed in GCC 7.1\r\n   12 | int fn1(int a, B<0> b) {\r\n      |     ^~~\r\n```\r\n\r\nIf you set `-Wabi=12`, same deal:\r\n```bash\r\narm-linux-gnueabihf-g++ abi.cpp -std=c++17 -Wabi=12\r\nabi.cpp: In function âint fn1(int, B<0>)â:\r\nabi.cpp:12:5: note: parameter passing for argument of type âB<0>â changed in GCC 7.1\r\n   12 | int fn1(int a, B<0> b) {\r\n      |     ^~~\r\n```\r\n\r\nð¤·",
      "created_at" : "2021-07-08T04:25:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22410#issuecomment-876114005",
      "id" : 876114005,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22410",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NjExNDAwNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-08T04:25:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/876114005",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Is it possible that ABI and psABI are two independent settings, and that psABI doesn't have this kind of granular versioning?",
      "created_at" : "2021-07-08T05:13:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22410#issuecomment-876132993",
      "id" : 876132993,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22410",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NjEzMjk5Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-08T05:13:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/876132993",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Is it possible that ABI and psABI are two independent settings, and that psABI doesn't have this kind of granular versioning?\r\n\r\nYea that may be the case. Also, as of GCC 11.1, the `-Wpsabi` remain undocumented:\r\n```bash\r\ng++-11 --help=warnings | grep -i abi\r\n  -Wabi                       Warn about things that will change when compiling with an ABI-compliant compiler.\r\n  -Wabi-tag                   Warn if a subobject has an abi_tag attribute that the complete object type does not have.\r\n  -Wabi=                      Warn about things that change between the current -fabi-version and the specified version.\r\n  -Wpsabi                     This option lacks documentation.\r\n```\r\n\r\nCould be good to add one line explaining that this is disabled to suppress uncontrollable warning output, but should be ok to do based on us consistently using GCC 8.5 for the Guix build.",
      "created_at" : "2021-07-08T05:34:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22410#issuecomment-876141677",
      "id" : 876141677,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22410",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg3NjE0MTY3Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-07-08T05:34:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/876141677",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
