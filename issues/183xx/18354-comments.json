[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19289 (wallet: GetWalletTx and IsMine require cs_wallet lock by promag)\n* #19277 (util: Add Assert identity function by MarcoFalke)\n* #19101 (refactor: remove ::vpwallets and related global variables by ryanofsky)\n* #19099 (refactor: Move wallet methods out of chain.h and node.h by ryanofsky)\n* #19070 (p2p: Signal support for compact block filters with NODE_COMPACT_FILTERS by jnewbery)\n* #19046 (Replace CWallet::Set* functions that use memonly with Add/Load variants by achow101)\n* #18654 (rpc: separate bumpfee's psbt creation function into psbtbumpfee by achow101)\n* #18608 (refactor: Remove CAddressBookData::destdata by ryanofsky)\n* #18531 (rpc: Assert that RPCArg names are equal to CRPCCommand ones by MarcoFalke)\n* #18202 (refactor: consolidate sendmany and sendtoaddress code by Sjors)\n* #18011 (Replace current benchmarking framework with nanobench by martinus)\n* #17526 (Use Single Random Draw In addition to knapsack as coin selection fallback by achow101)\n* #17484 (wallet: add cached m_is_ibd to remove Chain::isInitialBlockDownload by ariard)\n* #17331 (Use effective values throughout coin selection by achow101)\n* #17211 (Allow fundrawtransaction and walletcreatefundedpsbt to take external inputs by achow101)\n* #16546 (External signer support - Wallet Box edition by Sjors)\n* #16378 (The ultimate send RPC by Sjors)\n* #15719 (Wallet passive startup by ryanofsky)\n* #15093 (rpc: Change importwallet to return additional errors by marcinja)\n* #14707 ([RPC] Include coinbase transactions in receivedby RPCs by andrewtoth)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-03-15T19:12:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-599251772",
      "id" : 599251772,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5OTI1MTc3Mg==",
      "updated_at" : "2020-07-04T10:27:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/599251772",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Simplify patch, make more fuzzing test\r\n```\r\n#!/bin/bash\r\nwhile [ 1 ]\r\ndo\r\n    src/bitcoin-cli -testnet loadwallet test\r\n    src/bitcoin-cli -testnet unloadwallet test3\r\n    src/bitcoin-cli -testnet loadwallet test2\r\n    src/bitcoin-cli -testnet unloadwallet test\r\n    src/bitcoin-cli -testnet loadwallet test3\r\n    src/bitcoin-cli -testnet unloadwallet test2\r\ndone\r\n```",
      "created_at" : "2020-03-16T13:46:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-599544782",
      "id" : 599544782,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5OTU0NDc4Mg==",
      "updated_at" : "2020-03-16T13:46:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/599544782",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393055199"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393055199"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why's this adding `|| m_are_callbacks_running`? In the case where m_callbacks_pending is empty and m_are_callbacks_running is true, won't ProcessQueue return immediately and the loop below be a busy loop consuming 100% of CPU?\r\n\r\nAlso could use `while (WITH_LOCK(m_cs_callbacks_pending, return ...)) {` instead of a lambda",
      "commit_id" : "65b2983e9a00ed051f7e12faaae674ce20f8e982",
      "created_at" : "2020-03-16T14:17:11Z",
      "diff_hunk" : "@@ -199,13 +199,16 @@ void SingleThreadedSchedulerClient::AddToProcessQueue(std::function<void ()> fun\n }\n \n void SingleThreadedSchedulerClient::EmptyQueue() {\n-    assert(!m_pscheduler->AreThreadsServicingQueue());\n-    bool should_continue = true;\n-    while (should_continue) {\n-        ProcessQueue();\n+    if (m_pscheduler->AreThreadsServicingQueue())\n+        return;\n+\n+    auto shouldProcessQueue = [this]() {\n         LOCK(m_cs_callbacks_pending);\n-        should_continue = !m_callbacks_pending.empty();\n-    }\n+        return !m_callbacks_pending.empty() || m_are_callbacks_running;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393055199",
      "id" : 393055199,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA1NTE5OQ==",
      "original_commit_id" : "16e9578c1ecc3240282e136c378fb0433e775e41",
      "original_position" : 15,
      "path" : "src/scheduler.cpp",
      "position" : 15,
      "pull_request_review_id" : 375260070,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354",
      "updated_at" : "2020-03-16T18:34:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393055199",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393063319"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393063319"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is a partial fix for the bug, not a full fix. While calling BlockUntilSyncedToCurrentChain before reset makes it less likely the wallet pointer will be deleted while still in use, it's still possible for a blockconnected or other notification to be running when wallet.reset() is called below",
      "commit_id" : "65b2983e9a00ed051f7e12faaae674ce20f8e982",
      "created_at" : "2020-03-16T14:24:50Z",
      "diff_hunk" : "@@ -137,6 +135,8 @@ void UnloadWallet(std::shared_ptr<CWallet>&& wallet)\n     // Notify the unload intent so that all remaining shared pointers are\n     // released.\n     wallet->NotifyUnload();\n+    wallet->BlockUntilSyncedToCurrentChain();\n+    wallet->m_chain_notifications_handler.reset();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393063319",
      "id" : 393063319,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzA2MzMxOQ==",
      "original_commit_id" : "16e9578c1ecc3240282e136c378fb0433e775e41",
      "original_position" : 15,
      "path" : "src/wallet/wallet.cpp",
      "position" : 15,
      "pull_request_review_id" : 375260070,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354",
      "updated_at" : "2020-03-16T18:34:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393063319",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393173751"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393173751"
         }
      },
      "author_association" : "NONE",
      "body" : "That's guaranteed it https://github.com/bitcoin/bitcoin/pull/18354/commits/16e9578c1ecc3240282e136c378fb0433e775e41#diff-e8d9e22d9683f73a9fb8399be0dab640R93",
      "commit_id" : "65b2983e9a00ed051f7e12faaae674ce20f8e982",
      "created_at" : "2020-03-16T16:59:20Z",
      "diff_hunk" : "@@ -137,6 +135,8 @@ void UnloadWallet(std::shared_ptr<CWallet>&& wallet)\n     // Notify the unload intent so that all remaining shared pointers are\n     // released.\n     wallet->NotifyUnload();\n+    wallet->BlockUntilSyncedToCurrentChain();\n+    wallet->m_chain_notifications_handler.reset();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393173751",
      "id" : 393173751,
      "in_reply_to_id" : 393063319,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE3Mzc1MQ==",
      "original_commit_id" : "16e9578c1ecc3240282e136c378fb0433e775e41",
      "original_position" : 15,
      "path" : "src/wallet/wallet.cpp",
      "position" : 15,
      "pull_request_review_id" : 375411624,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354",
      "updated_at" : "2020-03-16T18:34:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393173751",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393175374"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393175374"
         }
      },
      "author_association" : "NONE",
      "body" : "> Why's this adding || m_are_callbacks_running? In the case where m_callbacks_pending is empty and m_are_callbacks_running is true, won't ProcessQueue return immediately and the loop below be a busy loop consuming 100% of CPU?\r\n\r\nIt's same without `m_are_callbacks_running` i.e. while loop consume a lot of CPU. The change is to ensure notification thread is finish processing callback.",
      "commit_id" : "65b2983e9a00ed051f7e12faaae674ce20f8e982",
      "created_at" : "2020-03-16T17:01:05Z",
      "diff_hunk" : "@@ -199,13 +199,16 @@ void SingleThreadedSchedulerClient::AddToProcessQueue(std::function<void ()> fun\n }\n \n void SingleThreadedSchedulerClient::EmptyQueue() {\n-    assert(!m_pscheduler->AreThreadsServicingQueue());\n-    bool should_continue = true;\n-    while (should_continue) {\n-        ProcessQueue();\n+    if (m_pscheduler->AreThreadsServicingQueue())\n+        return;\n+\n+    auto shouldProcessQueue = [this]() {\n         LOCK(m_cs_callbacks_pending);\n-        should_continue = !m_callbacks_pending.empty();\n-    }\n+        return !m_callbacks_pending.empty() || m_are_callbacks_running;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393175374",
      "id" : 393175374,
      "in_reply_to_id" : 393055199,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE3NTM3NA==",
      "original_commit_id" : "16e9578c1ecc3240282e136c378fb0433e775e41",
      "original_position" : 15,
      "path" : "src/scheduler.cpp",
      "position" : 15,
      "pull_request_review_id" : 375413030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354",
      "updated_at" : "2020-03-16T18:34:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393175374",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393183034"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393183034"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "As I understand it, the EmptyQueue call added there (in UnregisterValidationInterface) does nothing if `m_pscheduler->AreThreadsServicingQueue()` is true, which it always is, except during shutdown. So a notification could still be in progress and raw wallet pointer still in use after the UnregisterValidationInterface call and handler.reset() call and wallet.reset() call. Adding the BlockUntilSyncedToCurrentChain right before probably makes this much less unlikely, but not impossible. #18338 is be a more direct, race-free fix for the issue, because it gets rid of the raw pointer and uses shared_ptr for all wallet references.",
      "commit_id" : "65b2983e9a00ed051f7e12faaae674ce20f8e982",
      "created_at" : "2020-03-16T17:10:48Z",
      "diff_hunk" : "@@ -137,6 +135,8 @@ void UnloadWallet(std::shared_ptr<CWallet>&& wallet)\n     // Notify the unload intent so that all remaining shared pointers are\n     // released.\n     wallet->NotifyUnload();\n+    wallet->BlockUntilSyncedToCurrentChain();\n+    wallet->m_chain_notifications_handler.reset();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393183034",
      "id" : 393183034,
      "in_reply_to_id" : 393063319,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE4MzAzNA==",
      "original_commit_id" : "16e9578c1ecc3240282e136c378fb0433e775e41",
      "original_position" : 15,
      "path" : "src/wallet/wallet.cpp",
      "position" : 15,
      "pull_request_review_id" : 375420566,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354",
      "updated_at" : "2020-03-16T18:34:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393183034",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393193401"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393193401"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> > Why's this adding || m_are_callbacks_running? In the case where m_callbacks_pending is empty and m_are_callbacks_running is true, won't ProcessQueue return immediately and the loop below be a busy loop consuming 100% of CPU?\r\n\r\nOh, you're right. The current code is can busy-loop when the queue non-empty and running is true, though AreThreadsServicingQueue check makes this less likely to happen. I still don't understand why you now want to busy loop in the case where the queue is empty and running is true. Again prefer just using shared_ptr to avoid use-after-free bugs instead of doing more complicated things with the scheduler.",
      "commit_id" : "65b2983e9a00ed051f7e12faaae674ce20f8e982",
      "created_at" : "2020-03-16T17:28:27Z",
      "diff_hunk" : "@@ -199,13 +199,16 @@ void SingleThreadedSchedulerClient::AddToProcessQueue(std::function<void ()> fun\n }\n \n void SingleThreadedSchedulerClient::EmptyQueue() {\n-    assert(!m_pscheduler->AreThreadsServicingQueue());\n-    bool should_continue = true;\n-    while (should_continue) {\n-        ProcessQueue();\n+    if (m_pscheduler->AreThreadsServicingQueue())\n+        return;\n+\n+    auto shouldProcessQueue = [this]() {\n         LOCK(m_cs_callbacks_pending);\n-        should_continue = !m_callbacks_pending.empty();\n-    }\n+        return !m_callbacks_pending.empty() || m_are_callbacks_running;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393193401",
      "id" : 393193401,
      "in_reply_to_id" : 393055199,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzE5MzQwMQ==",
      "original_commit_id" : "16e9578c1ecc3240282e136c378fb0433e775e41",
      "original_position" : 15,
      "path" : "src/scheduler.cpp",
      "position" : 15,
      "pull_request_review_id" : 375434268,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354",
      "updated_at" : "2020-03-16T18:34:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393193401",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393220993"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393220993"
         }
      },
      "author_association" : "NONE",
      "body" : "Got'cha, you're right. I'll investigate for solution.",
      "commit_id" : "65b2983e9a00ed051f7e12faaae674ce20f8e982",
      "created_at" : "2020-03-16T18:11:21Z",
      "diff_hunk" : "@@ -199,13 +199,16 @@ void SingleThreadedSchedulerClient::AddToProcessQueue(std::function<void ()> fun\n }\n \n void SingleThreadedSchedulerClient::EmptyQueue() {\n-    assert(!m_pscheduler->AreThreadsServicingQueue());\n-    bool should_continue = true;\n-    while (should_continue) {\n-        ProcessQueue();\n+    if (m_pscheduler->AreThreadsServicingQueue())\n+        return;\n+\n+    auto shouldProcessQueue = [this]() {\n         LOCK(m_cs_callbacks_pending);\n-        should_continue = !m_callbacks_pending.empty();\n-    }\n+        return !m_callbacks_pending.empty() || m_are_callbacks_running;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393220993",
      "id" : 393220993,
      "in_reply_to_id" : 393055199,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIyMDk5Mw==",
      "original_commit_id" : "16e9578c1ecc3240282e136c378fb0433e775e41",
      "original_position" : 15,
      "path" : "src/scheduler.cpp",
      "position" : 15,
      "pull_request_review_id" : 375469306,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354",
      "updated_at" : "2020-03-16T18:34:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393220993",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393233993"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393233993"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> Got'cha, you're right. I'll investigate for solution.\r\n\r\nAgain would suggest closing this PR and using #18338 which I think is more consistent and less fragile fix",
      "commit_id" : "65b2983e9a00ed051f7e12faaae674ce20f8e982",
      "created_at" : "2020-03-16T18:34:57Z",
      "diff_hunk" : "@@ -199,13 +199,16 @@ void SingleThreadedSchedulerClient::AddToProcessQueue(std::function<void ()> fun\n }\n \n void SingleThreadedSchedulerClient::EmptyQueue() {\n-    assert(!m_pscheduler->AreThreadsServicingQueue());\n-    bool should_continue = true;\n-    while (should_continue) {\n-        ProcessQueue();\n+    if (m_pscheduler->AreThreadsServicingQueue())\n+        return;\n+\n+    auto shouldProcessQueue = [this]() {\n         LOCK(m_cs_callbacks_pending);\n-        should_continue = !m_callbacks_pending.empty();\n-    }\n+        return !m_callbacks_pending.empty() || m_are_callbacks_running;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393233993",
      "id" : 393233993,
      "in_reply_to_id" : 393055199,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIzMzk5Mw==",
      "original_commit_id" : "16e9578c1ecc3240282e136c378fb0433e775e41",
      "original_position" : 15,
      "path" : "src/scheduler.cpp",
      "position" : 15,
      "pull_request_review_id" : 375485578,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354",
      "updated_at" : "2020-03-16T18:34:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393233993",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393234040"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393234040"
         }
      },
      "author_association" : "NONE",
      "body" : "`AreThreadsServicingQueue` is not needed at all. Its purpose is obsolete in the context.",
      "commit_id" : "65b2983e9a00ed051f7e12faaae674ce20f8e982",
      "created_at" : "2020-03-16T18:35:04Z",
      "diff_hunk" : "@@ -199,13 +199,16 @@ void SingleThreadedSchedulerClient::AddToProcessQueue(std::function<void ()> fun\n }\n \n void SingleThreadedSchedulerClient::EmptyQueue() {\n-    assert(!m_pscheduler->AreThreadsServicingQueue());\n-    bool should_continue = true;\n-    while (should_continue) {\n-        ProcessQueue();\n+    if (m_pscheduler->AreThreadsServicingQueue())\n+        return;\n+\n+    auto shouldProcessQueue = [this]() {\n         LOCK(m_cs_callbacks_pending);\n-        should_continue = !m_callbacks_pending.empty();\n-    }\n+        return !m_callbacks_pending.empty() || m_are_callbacks_running;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#discussion_r393234040",
      "id" : 393234040,
      "in_reply_to_id" : 393055199,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MzIzNDA0MA==",
      "original_commit_id" : "16e9578c1ecc3240282e136c378fb0433e775e41",
      "original_position" : 15,
      "path" : "src/scheduler.cpp",
      "position" : 15,
      "pull_request_review_id" : 375485646,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18354",
      "updated_at" : "2020-03-16T18:35:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/393234040",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Use future instead of raw loop for waiting pending callbacks. It still much matters to me compared to #18338 ",
      "created_at" : "2020-03-17T06:49:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-599906008",
      "id" : 599906008,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5OTkwNjAwOA==",
      "updated_at" : "2020-03-17T06:50:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/599906008",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@promag same as your approach with more aggressive refactor + missing virtual desctructors.",
      "created_at" : "2020-03-24T11:39:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-603189889",
      "id" : 603189889,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMzE4OTg4OQ==",
      "updated_at" : "2020-03-24T11:39:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/603189889",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK, though this is making a lot of changes in a single commit. The changes will probably get simpler if #18338 is merged first, and maybe they can be broken up into smaller commits. Could consider rebasing on top of #18338 of you don't want to wait for it to be merged. I'd also encourage you to review #18338!",
      "created_at" : "2020-03-25T13:35:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-603842986",
      "id" : 603842986,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMzg0Mjk4Ng==",
      "updated_at" : "2020-03-25T13:35:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/603842986",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh, just saw this PR has expanded since I looked at it previously. I think some of the uses of shared_ptr / weak_ptr here like the new ones added in CWalletTx do not make sense. shared_ptr / weak_ptr only make sense when lifetime of the reference doesn't have a definite scope. For cases like CWalletTx where the wallet reference can't outlive the wallet, `CWallet&` makes more sense than `weak_ptr<CWallet>`. (Also, though in that specific case, it would be preferable to stop storing the wallet references entirely since they are redundant and no CWalletTx method is ever called without already having a reference to the wallet).\r\n\r\nIt would probably make sense to break this PR up into multiple commits so individual changes here can be understood and reviewed more easily",
      "created_at" : "2020-03-25T13:48:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-603849568",
      "id" : 603849568,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMzg0OTU2OA==",
      "updated_at" : "2020-03-25T13:53:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/603849568",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> shared_ptr / weak_ptr only make sense when lifetime of the reference doesn't have a definite scope.\r\n\r\nI agree, in plus it defines no ownership. I agree, that reference makes much more sense here, too\r\n\r\n",
      "created_at" : "2020-03-25T17:41:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-603984873",
      "id" : 603984873,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMzk4NDg3Mw==",
      "updated_at" : "2020-03-25T17:42:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/603984873",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Use Optional instead of weak_ptr, i can't reproduce CI errors, all tests + functional ones passes in Linux x64.",
      "created_at" : "2020-03-26T09:47:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-604330770",
      "id" : 604330770,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNDMzMDc3MA==",
      "updated_at" : "2020-03-26T09:47:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/604330770",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-03-28T22:53:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-605530295",
      "id" : 605530295,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNTUzMDI5NQ==",
      "updated_at" : "2020-03-28T22:53:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/605530295",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-03-31T13:15:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-606619858",
      "id" : 606619858,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjYxOTg1OA==",
      "updated_at" : "2020-03-31T13:15:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/606619858",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Loosk like there are some cleanups from https://github.com/bitcoin/bitcoin/pull/18338#issuecomment-605920724 that can be addressed here",
      "created_at" : "2020-03-31T14:08:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-606650860",
      "id" : 606650860,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjY1MDg2MA==",
      "updated_at" : "2020-03-31T14:08:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/606650860",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-04-03T20:21:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-608640513",
      "id" : 608640513,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwODY0MDUxMw==",
      "updated_at" : "2020-04-03T20:21:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/608640513",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-05-01T11:08:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-622346893",
      "id" : 622346893,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjM0Njg5Mw==",
      "updated_at" : "2020-05-01T11:08:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622346893",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Are you interested in this patch or you prefer to be closed?\r\nThe changes are:\r\n\r\n1. Validation interface uses shared pointers only\r\n2. Fix CValidationInterface and NetEventsInterface to use virtual destructors. Since there is no usage of creation and deletion via base pointer it does not have a problem but instead it's not correct design.\r\n3. RPC methods uses CWallet shared pointer only\r\n4. CwalletTx and WalletRescanReserver uses optional reference to CWallet instead of pointer\r\n5. Notification implementation uses weak pointer instead of shared one.",
      "created_at" : "2020-05-02T09:39:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-622926731",
      "id" : 622926731,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjkyNjczMQ==",
      "updated_at" : "2020-05-03T07:59:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622926731",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-05-04T15:49:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-623545409",
      "id" : 623545409,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMzU0NTQwOQ==",
      "updated_at" : "2020-05-04T15:49:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/623545409",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Interestingly this change seems like a superset of #18742 by @MarcoFalke and #18791 by @promag and #18592 by @brakmic but it precedes all these other prs!\r\n\r\nFor the #18742 / #18791 overlap, I think there's a question about where it makes sense to use the shared pointer validationinterface callbacks, and where it makes sense to use the non-shared ones. Maybe it would be good to do what this PR does and use shared pointers everywhere but there are possible concerns about overhead and making shutdown not deterministic. Some discussion https://github.com/bitcoin/bitcoin/pull/18791#issuecomment-620307875\r\n\r\nFor the #18592 overlap, I think #18592 might be taking a better approach. It's generally good to replace raw pointers with smart pointers or references. But a lot of instances here look like they should be references instead of shared_ptrs, and there's also an `Optional<const CWallet&>` usage which I think is just recreating a type of a raw pointer. It seems like the pointer changes here might be going too far in some cases.\r\n\r\nProbably we should focus on #18742 and #18791 and #18592 for now, but see if there's anything this PR does better or isn't covered by the smaller prs.",
      "created_at" : "2020-05-07T01:55:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-624983709",
      "id" : 624983709,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNDk4MzcwOQ==",
      "updated_at" : "2020-05-07T01:55:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/624983709",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-05-13T10:30:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-627896429",
      "id" : 627896429,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyNzg5NjQyOQ==",
      "updated_at" : "2020-05-13T10:30:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/627896429",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Revert optional ref. @ryanofsky none of those PRs are complete like this, i agree they have same approach. Using shared pointer is cheap enough to be pass by value.",
      "created_at" : "2020-05-15T15:07:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-629288136",
      "id" : 629288136,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyOTI4ODEzNg==",
      "updated_at" : "2020-05-15T15:09:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/629288136",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-05-21T18:28:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-632268740",
      "id" : 632268740,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMjI2ODc0MA==",
      "updated_at" : "2020-05-21T18:28:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/632268740",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-05-23T12:06:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-633038747",
      "id" : 633038747,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMzAzODc0Nw==",
      "updated_at" : "2020-05-23T12:06:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633038747",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-05-26T12:54:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-634006144",
      "id" : 634006144,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNDAwNjE0NA==",
      "updated_at" : "2020-05-26T12:54:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634006144",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-05-28T14:57:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-635403507",
      "id" : 635403507,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNTQwMzUwNw==",
      "updated_at" : "2020-05-28T14:57:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635403507",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-06-02T22:30:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-637842127",
      "id" : 637842127,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNzg0MjEyNw==",
      "updated_at" : "2020-06-02T22:30:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/637842127",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-06-05T12:40:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-639456736",
      "id" : 639456736,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzOTQ1NjczNg==",
      "updated_at" : "2020-06-05T12:40:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/639456736",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-06-18T21:49:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-646323236",
      "id" : 646323236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NjMyMzIzNg==",
      "updated_at" : "2020-06-18T21:49:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/646323236",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-06-21T10:24:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-647109075",
      "id" : 647109075,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0NzEwOTA3NQ==",
      "updated_at" : "2020-06-21T10:24:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/647109075",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-06-24T19:34:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-649024102",
      "id" : 649024102,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0OTAyNDEwMg==",
      "updated_at" : "2020-06-24T19:34:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/649024102",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-07-03T12:25:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-653523517",
      "id" : 653523517,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1MzUyMzUxNw==",
      "updated_at" : "2020-07-03T12:25:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/653523517",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-07-04T13:22:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18354#issuecomment-653765874",
      "id" : 653765874,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18354",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1Mzc2NTg3NA==",
      "updated_at" : "2020-07-04T13:22:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/653765874",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
