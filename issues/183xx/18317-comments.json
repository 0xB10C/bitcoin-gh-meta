[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #16463 ([BIP 174] Implement serialization support for GLOBAL_XPUB field. by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-03-11T17:43:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#issuecomment-597773325",
      "id" : 597773325,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18317",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU5Nzc3MzMyNQ==",
      "updated_at" : "2020-05-06T18:39:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/597773325",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r398625457"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/398625457"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Convert everything except wallet/qt to new serialization\" (4a185971f495ab89d869a4744d36aa1a8c9aea3f)\r\n\r\nIs it safe to drop the Init call here? It seems needed to avoid leaving nTime uninitialized if READWRITE(obj.nTime) is skipped below.\r\n\r\nI was experimenting a little bit with how to be able to bring back `if (ser_action.ForRead())` ability in the new framework now that the object type can vary and may be const.\r\n\r\nOne option might be to have `SER_READ` / `SER_WRITE` macros that contain code (similar to `WITH_LOCK`) and only execute when reading or writing:\r\n\r\n```diff\r\n--- a/src/protocol.h\r\n+++ b/src/protocol.h\r\n@@ -316,6 +316,7 @@ public:\r\n \r\n     SERIALIZE_METHODS(CAddress, obj)\r\n     {\r\n+        SER_READ(obj, obj.Init());\r\n         int nVersion = s.GetVersion();\r\n         if (s.GetType() & SER_DISK) {\r\n             READWRITE(nVersion);\r\ndiff --git a/src/serialize.h b/src/serialize.h\r\nindex 43f35f7ebe6..ae6a028ce97 100644\r\n--- a/src/serialize.h\r\n+++ b/src/serialize.h\r\n@@ -179,6 +179,7 @@ template<typename X> const X& ReadWriteAsHelper(const X& x) { return x; }\r\n \r\n #define READWRITE(...) (::SerReadWriteMany(s, ser_action, __VA_ARGS__))\r\n #define READWRITEAS(type, obj) (::SerReadWriteMany(s, ser_action, ReadWriteAsHelper<type>(obj)))\r\n+#define SER_READ(obj, code) ::SerRead(s, ser_action, obj, [&](Stream& s, typename std::remove_const<Type>::type& obj) { code; })\r\n \r\n /**\r\n  * Implement three methods for serializable objects. These are actually wrappers over\r\n@@ -1089,6 +1090,17 @@ inline void SerReadWriteMany(Stream& s, CSerActionUnserialize ser_action, Args&&\r\n     ::UnserializeMany(s, args...);\r\n }\r\n \r\n+template<typename Stream, typename Type, typename Fn>\r\n+inline void SerRead(Stream& s, CSerActionSerialize ser_action, Type&&, Fn&&)\r\n+{\r\n+}\r\n+\r\n+template<typename Stream, typename Type, typename Fn>\r\n+inline void SerRead(Stream& s, CSerActionUnserialize ser_action, Type&& obj, Fn&& fn)\r\n+{\r\n+    fn(s, std::forward<Type>(obj));\r\n+}\r\n+\r\n template<typename I>\r\n inline void WriteVarInt(CSizeComputer &s, I n)\r\n {\r\n```",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-03-26T14:40:22Z",
      "diff_hunk" : "@@ -323,23 +314,18 @@ class CAddress : public CService\n \n     void Init();\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action)\n+    SERIALIZE_METHODS(CAddress, obj)\n     {\n-        if (ser_action.ForRead())\n-            Init();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r398625457",
      "id" : 398625457,
      "line" : 336,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODYyNTQ1Nw==",
      "original_commit_id" : "4a185971f495ab89d869a4744d36aa1a8c9aea3f",
      "original_line" : 336,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 29,
      "pull_request_review_id" : 382075974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-03-30T23:11:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/398625457",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r398770856"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/398770856"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Add ConvertFormatter\" (7c5a0c7c53c7cec8f4f6d074d90c5e8988f61c15)\r\n\r\nI think it would be better not to have this class, or maybe expose it less widely:\r\n\r\n- It only seems to be used one place currently, and I think CustomUintFormatter could be used there instead.\r\n- It seems easy to confuse with `READWRITEAS`, and not obvious when you'd use `READWRITEAS` vs `READWRITE` with `ConvertFormatter`\r\n- Haven't thought about it too much, but just based on how this is implemented, there could be cases where using it would do unexpected temporary creation or copying or derived-base truncation.",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-03-26T17:47:44Z",
      "diff_hunk" : "@@ -540,6 +540,26 @@ struct CustomUintFormatter\n     }\n };\n \n+/** Formatter that (de)serializes a type as another type it's convertible to/from. */\n+template<typename F> struct ConvertFormatter",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r398770856",
      "id" : 398770856,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODc3MDg1Ng==",
      "original_commit_id" : "7c5a0c7c53c7cec8f4f6d074d90c5e8988f61c15",
      "original_line" : 544,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : null,
      "pull_request_review_id" : 382075974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-03-30T23:11:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/398770856",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r398817741"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/398817741"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Convert everything except wallet/qt to new serialization\" (4a185971f495ab89d869a4744d36aa1a8c9aea3f)\r\n\r\nLast commit is mostly repetitive changes of this form. Maybe a big regex in a scripted diff could be used to do the boilerplate subtitutions in a separate commit, so the more complicated changes here stand out.",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-03-26T18:57:18Z",
      "diff_hunk" : "@@ -66,15 +66,7 @@ class CBloomFilter\n     CBloomFilter(const unsigned int nElements, const double nFPRate, const unsigned int nTweak, unsigned char nFlagsIn);\n     CBloomFilter() : isFull(true), isEmpty(false), nHashFuncs(0), nTweak(0), nFlags(0) {}\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n-        READWRITE(vData);\n-        READWRITE(nHashFuncs);\n-        READWRITE(nTweak);\n-        READWRITE(nFlags);\n-    }\n+    SERIALIZE_METHODS(CBloomFilter, obj) { READWRITE(obj.vData, obj.nHashFuncs, obj.nTweak, obj.nFlags); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r398817741",
      "id" : 398817741,
      "line" : 69,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgxNzc0MQ==",
      "original_commit_id" : "4a185971f495ab89d869a4744d36aa1a8c9aea3f",
      "original_line" : 69,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/bloom.h",
      "position" : 13,
      "pull_request_review_id" : 382075974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-03-30T23:11:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/398817741",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r398821936"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/398821936"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Convert everything except wallet/qt to new serialization\" (4a185971f495ab89d869a4744d36aa1a8c9aea3f)\r\n\r\nI suggested dropping ConvertFormatter in another comment for a few reasons. CustomUintFormatter could be used instead here if extended to support enums:\r\n\r\n```diff\r\ndiff --git a/src/protocol.h b/src/protocol.h\r\nindex c1a21264705..901471e110d 100644\r\n--- a/src/protocol.h\r\n+++ b/src/protocol.h\r\n@@ -324,7 +324,7 @@ public:\r\n             (nVersion >= CADDR_TIME_VERSION && !(s.GetType() & SER_GETHASH))) {\r\n             READWRITE(obj.nTime);\r\n         }\r\n-        READWRITE(Using<ConvertFormatter<uint64_t>>(obj.nServices));\r\n+        READWRITE(Using<CustomUintFormatter<8>>(obj.nServices));\r\n         READWRITEAS(CService, obj);\r\n     }\r\n \r\ndiff --git a/src/serialize.h b/src/serialize.h\r\nindex 51d270d7976..718bdea90a6 100644\r\n--- a/src/serialize.h\r\n+++ b/src/serialize.h\r\n@@ -527,14 +527,15 @@ struct CustomUintFormatter\r\n \r\n     template <typename Stream, typename I> void Unser(Stream& s, I& v)\r\n     {\r\n-        static_assert(std::numeric_limits<I>::max() >= MAX && std::numeric_limits<I>::min() <= 0, \"CustomUintFormatter type too small\");\r\n+        using U = typename std::conditional<std::is_enum<I>::value, std::underlying_type<I>, std::common_type<I>>::type::type;\r\n+        static_assert(std::numeric_limits<U>::max() >= MAX && std::numeric_limits<U>::min() <= 0, \"Assigned type too small\");\r\n         uint64_t raw = 0;\r\n         if (BigEndian) {\r\n             s.read(((char*)&raw) + 8 - Bytes, Bytes);\r\n-            v = be64toh(raw);\r\n+            v = static_cast<I>(be64toh(raw));\r\n         } else {\r\n             s.read((char*)&raw, Bytes);\r\n-            v = le64toh(raw);\r\n+            v = static_cast<I>(le64toh(raw));\r\n         }\r\n     }\r\n };\r\n```",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-03-26T19:04:02Z",
      "diff_hunk" : "@@ -323,23 +314,18 @@ class CAddress : public CService\n \n     void Init();\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action)\n+    SERIALIZE_METHODS(CAddress, obj)\n     {\n-        if (ser_action.ForRead())\n-            Init();\n         int nVersion = s.GetVersion();\n-        if (s.GetType() & SER_DISK)\n+        if (s.GetType() & SER_DISK) {\n             READWRITE(nVersion);\n+        }\n         if ((s.GetType() & SER_DISK) ||\n-            (nVersion >= CADDR_TIME_VERSION && !(s.GetType() & SER_GETHASH)))\n-            READWRITE(nTime);\n-        uint64_t nServicesInt = nServices;\n-        READWRITE(nServicesInt);\n-        nServices = static_cast<ServiceFlags>(nServicesInt);\n-        READWRITEAS(CService, *this);\n+            (nVersion >= CADDR_TIME_VERSION && !(s.GetType() & SER_GETHASH))) {\n+            READWRITE(obj.nTime);\n+        }\n+        READWRITE(Using<ConvertFormatter<uint64_t>>(obj.nServices));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r398821936",
      "id" : 398821936,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5ODgyMTkzNg==",
      "original_commit_id" : "4a185971f495ab89d869a4744d36aa1a8c9aea3f",
      "original_line" : 327,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 382075974,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-03-30T23:11:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/398821936",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r399518137"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/399518137"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Convert merkleblock to new serialization\" (25bfbbeb63eca1f1c8852a8a08844069d9e06776)\r\n\r\nMaybe better to keep constructor below private and just declare SERIALIZE_METHODS before it, assuming there's a valid reason for the constructor to be private.",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-03-27T20:21:13Z",
      "diff_hunk" : "@@ -157,17 +161,10 @@ class CMerkleBlock\n \n     CMerkleBlock() {}\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n-        READWRITE(header);\n-        READWRITE(txn);\n-    }\n-\n-private:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r399518137",
      "id" : 399518137,
      "line" : 168,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTUxODEzNw==",
      "original_commit_id" : "25bfbbeb63eca1f1c8852a8a08844069d9e06776",
      "original_line" : 168,
      "original_position" : 62,
      "original_start_line" : null,
      "path" : "src/merkleblock.h",
      "position" : 60,
      "pull_request_review_id" : 383174750,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-03-30T23:11:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/399518137",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r400549708"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/400549708"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That's great! I've turned this snippet into a separate commit (with you as author; please let me know if you prefer a different approach). It also adds the corresponding SER_WRITE, as it turns out to be useful further.",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-03-30T23:13:47Z",
      "diff_hunk" : "@@ -323,23 +314,18 @@ class CAddress : public CService\n \n     void Init();\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action)\n+    SERIALIZE_METHODS(CAddress, obj)\n     {\n-        if (ser_action.ForRead())\n-            Init();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r400549708",
      "id" : 400549708,
      "in_reply_to_id" : 398625457,
      "line" : 336,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU0OTcwOA==",
      "original_commit_id" : "4a185971f495ab89d869a4744d36aa1a8c9aea3f",
      "original_line" : 336,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 29,
      "pull_request_review_id" : 384297176,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-03-30T23:14:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/400549708",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r400550066"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/400550066"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I've taken your approach of merging it into `CustomUintFormatter`.",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-03-30T23:14:45Z",
      "diff_hunk" : "@@ -540,6 +540,26 @@ struct CustomUintFormatter\n     }\n };\n \n+/** Formatter that (de)serializes a type as another type it's convertible to/from. */\n+template<typename F> struct ConvertFormatter",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r400550066",
      "id" : 400550066,
      "in_reply_to_id" : 398770856,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU1MDA2Ng==",
      "original_commit_id" : "7c5a0c7c53c7cec8f4f6d074d90c5e8988f61c15",
      "original_line" : 544,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : null,
      "pull_request_review_id" : 384297551,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-03-30T23:14:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/400550066",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r400550280"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/400550280"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think that would be pretty hard to do, especially the classname argument to `SERIALIZE_METHODS` is hard to figure out with a regexp. Do you have any concrete ideas?",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-03-30T23:15:23Z",
      "diff_hunk" : "@@ -66,15 +66,7 @@ class CBloomFilter\n     CBloomFilter(const unsigned int nElements, const double nFPRate, const unsigned int nTweak, unsigned char nFlagsIn);\n     CBloomFilter() : isFull(true), isEmpty(false), nHashFuncs(0), nTweak(0), nFlags(0) {}\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n-        READWRITE(vData);\n-        READWRITE(nHashFuncs);\n-        READWRITE(nTweak);\n-        READWRITE(nFlags);\n-    }\n+    SERIALIZE_METHODS(CBloomFilter, obj) { READWRITE(obj.vData, obj.nHashFuncs, obj.nTweak, obj.nFlags); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r400550280",
      "id" : 400550280,
      "in_reply_to_id" : 398817741,
      "line" : 69,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU1MDI4MA==",
      "original_commit_id" : "4a185971f495ab89d869a4744d36aa1a8c9aea3f",
      "original_line" : 69,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/bloom.h",
      "position" : 13,
      "pull_request_review_id" : 384297792,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-03-30T23:15:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/400550280",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r400550416"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/400550416"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I've turned this into a separate commit with you as author.",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-03-30T23:15:50Z",
      "diff_hunk" : "@@ -323,23 +314,18 @@ class CAddress : public CService\n \n     void Init();\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action)\n+    SERIALIZE_METHODS(CAddress, obj)\n     {\n-        if (ser_action.ForRead())\n-            Init();\n         int nVersion = s.GetVersion();\n-        if (s.GetType() & SER_DISK)\n+        if (s.GetType() & SER_DISK) {\n             READWRITE(nVersion);\n+        }\n         if ((s.GetType() & SER_DISK) ||\n-            (nVersion >= CADDR_TIME_VERSION && !(s.GetType() & SER_GETHASH)))\n-            READWRITE(nTime);\n-        uint64_t nServicesInt = nServices;\n-        READWRITE(nServicesInt);\n-        nServices = static_cast<ServiceFlags>(nServicesInt);\n-        READWRITEAS(CService, *this);\n+            (nVersion >= CADDR_TIME_VERSION && !(s.GetType() & SER_GETHASH))) {\n+            READWRITE(obj.nTime);\n+        }\n+        READWRITE(Using<ConvertFormatter<uint64_t>>(obj.nServices));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r400550416",
      "id" : 400550416,
      "in_reply_to_id" : 398821936,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU1MDQxNg==",
      "original_commit_id" : "4a185971f495ab89d869a4744d36aa1a8c9aea3f",
      "original_line" : 327,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 384297948,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-03-30T23:15:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/400550416",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r400550568"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/400550568"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this was a mistake; fixed.",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-03-30T23:16:20Z",
      "diff_hunk" : "@@ -157,17 +161,10 @@ class CMerkleBlock\n \n     CMerkleBlock() {}\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n-        READWRITE(header);\n-        READWRITE(txn);\n-    }\n-\n-private:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r400550568",
      "id" : 400550568,
      "in_reply_to_id" : 399518137,
      "line" : 168,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwMDU1MDU2OA==",
      "original_commit_id" : "25bfbbeb63eca1f1c8852a8a08844069d9e06776",
      "original_line" : 168,
      "original_position" : 62,
      "original_start_line" : null,
      "path" : "src/merkleblock.h",
      "position" : 60,
      "pull_request_review_id" : 384298139,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-03-30T23:16:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/400550568",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Addressed a number of comments, and included some of @ryanofsky's code suggestions. I've also revamped the merkleblock serializers using the new FOR_READ/FOR_WRITE.",
      "created_at" : "2020-03-30T23:18:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#issuecomment-606301664",
      "id" : 606301664,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18317",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNjMwMTY2NA==",
      "updated_at" : "2020-03-30T23:18:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/606301664",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Anyone else feel like reviewing this? We're getting close. ",
      "created_at" : "2020-05-18T21:33:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#issuecomment-630447051",
      "id" : 630447051,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18317",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzMDQ0NzA1MQ==",
      "updated_at" : "2020-05-18T21:33:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630447051",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r427518341"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427518341"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit 769ee5fa0011ae658770586442715452a656559d:\r\n\r\nAny reason why you remove the comment? \"This is only intended\r\nto implement serializers that are compatible with existing formats, and\r\nits use is not recommended for new data structures.\"",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-05-19T18:38:12Z",
      "diff_hunk" : "@@ -527,52 +527,30 @@ struct CustomUintFormatter\n     template <typename Stream, typename I> void Ser(Stream& s, I v)\n     {\n         if (v < 0 || v > MAX) throw std::ios_base::failure(\"CustomUintFormatter value out of range\");\n-        uint64_t raw = htole64(v);\n-        s.write((const char*)&raw, Bytes);\n+        if (BigEndian) {\n+            uint64_t raw = htobe64(v);\n+            s.write(((const char*)&raw) + 8 - Bytes, Bytes);\n+        } else {\n+            uint64_t raw = htole64(v);\n+            s.write((const char*)&raw, Bytes);\n+        }\n     }\n \n     template <typename Stream, typename I> void Unser(Stream& s, I& v)\n     {\n         static_assert(std::numeric_limits<I>::max() >= MAX && std::numeric_limits<I>::min() <= 0, \"CustomUintFormatter type too small\");\n         uint64_t raw = 0;\n-        s.read((char*)&raw, Bytes);\n-        v = le64toh(raw);\n+        if (BigEndian) {\n+            s.read(((char*)&raw) + 8 - Bytes, Bytes);\n+            v = be64toh(raw);\n+        } else {\n+            s.read((char*)&raw, Bytes);\n+            v = le64toh(raw);\n+        }\n     }\n };\n \n-/** Serialization wrapper class for big-endian integers.\n- *\n- * Use this wrapper around integer types that are stored in memory in native\n- * byte order, but serialized in big endian notation. This is only intended\n- * to implement serializers that are compatible with existing formats, and\n- * its use is not recommended for new data structures.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r427518341",
      "id" : 427518341,
      "line" : 548,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzUxODM0MQ==",
      "original_commit_id" : "769ee5fa0011ae658770586442715452a656559d",
      "original_line" : 548,
      "original_position" : 45,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 56,
      "pull_request_review_id" : 414722057,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-19T19:44:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427518341",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r427557191"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427557191"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Clang has tooling to do these kind of refactors. Though, I haven't figured out how to run them in a scripted-diff.",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-05-19T19:46:27Z",
      "diff_hunk" : "@@ -66,15 +66,7 @@ class CBloomFilter\n     CBloomFilter(const unsigned int nElements, const double nFPRate, const unsigned int nTweak, unsigned char nFlagsIn);\n     CBloomFilter() : isFull(true), isEmpty(false), nHashFuncs(0), nTweak(0), nFlags(0) {}\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action) {\n-        READWRITE(vData);\n-        READWRITE(nHashFuncs);\n-        READWRITE(nTweak);\n-        READWRITE(nFlags);\n-    }\n+    SERIALIZE_METHODS(CBloomFilter, obj) { READWRITE(obj.vData, obj.nHashFuncs, obj.nTweak, obj.nFlags); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r427557191",
      "id" : 427557191,
      "in_reply_to_id" : 398817741,
      "line" : 69,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1NzE5MQ==",
      "original_commit_id" : "4a185971f495ab89d869a4744d36aa1a8c9aea3f",
      "original_line" : 69,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/bloom.h",
      "position" : 13,
      "pull_request_review_id" : 414769644,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-19T19:46:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427557191",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r427557837"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427557837"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Going forward, the Init should probably be removed and replaced with a slim and clean C++11 initializer",
      "commit_id" : "4eb5643e3538863c9d2ff261f49a9a1b248de243",
      "created_at" : "2020-05-19T19:47:38Z",
      "diff_hunk" : "@@ -323,23 +314,18 @@ class CAddress : public CService\n \n     void Init();\n \n-    ADD_SERIALIZE_METHODS;\n-\n-    template <typename Stream, typename Operation>\n-    inline void SerializationOp(Stream& s, Operation ser_action)\n+    SERIALIZE_METHODS(CAddress, obj)\n     {\n-        if (ser_action.ForRead())\n-            Init();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18317#discussion_r427557837",
      "id" : 427557837,
      "in_reply_to_id" : 398625457,
      "line" : 336,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU1NzgzNw==",
      "original_commit_id" : "4a185971f495ab89d869a4744d36aa1a8c9aea3f",
      "original_line" : 336,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 29,
      "pull_request_review_id" : 414770428,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18317",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-19T19:47:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427557837",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
