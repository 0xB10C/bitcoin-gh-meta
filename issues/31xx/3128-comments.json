[
   {
      "body" : "I suspect https://github.com/bitcoin/bitcoin/pull/2740 broke the pull-tester.",
      "created_at" : "2013-10-22T11:03:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3128#issuecomment-26793858",
      "id" : 26793858,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3128",
      "updated_at" : "2013-10-22T11:03:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26793858",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Do we need both TX_NULL and TX_NULL_DATA? Seems to me it should just be TX_NULL_DATA, and supporting that would (I think) be a one-line change:\r\n```\r\nmTemplates.insert(make_pair(TX_NULL_DATA, CScript() << OP_RETURN));\r\n```\r\n\r\nIf we ever write higher-level code that extracts the data from a TX_NULL_DATA, that should be trivial-- remove the first byte/opcode from the ScriptPubKey, execute whatever remains (empty CScript in the case of no SMALLDATA), and data is whatever is left on the execution stack.\r\n",
      "created_at" : "2013-10-23T01:58:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3128#issuecomment-26875366",
      "id" : 26875366,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3128",
      "updated_at" : "2013-10-23T01:58:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26875366",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "... wait, no, I'm wrong, mTemplates is a map, not a multimap...\r\nMaybe it should be a multimap, though.\r\n",
      "created_at" : "2013-10-23T01:59:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3128#issuecomment-26875413",
      "id" : 26875413,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3128",
      "updated_at" : "2013-10-23T01:59:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26875413",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "@gavinandresen Regardless of map/multimap, I had the same thought.  TX_NULL_DATA can be defined as OP_RETURN, with optional trailing pushdata <= 80 bytes.",
      "created_at" : "2013-10-23T02:02:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3128#issuecomment-26875522",
      "id" : 26875522,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3128",
      "updated_at" : "2013-10-23T02:02:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26875522",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Well if we want to do that it'll need a separate code path in Solver(), similar to how P2SH is handled specially. I think you can make a (weak) argument that NULL and NULL_DATA make lives a little easier, because you always know that only the latter has data that your app should try to parse. (remember that it's legal to make a zero-byte PUSHDATA with 0x00)\r\n\r\nYou know, it's unfortunate that Satoshi bizarrely counts sigops in scriptPubKeys, the only time the protocol looks at them when a block is processed. If not for that I'd just say make a two line test that scriptPubKey[0] == OP_RETURN and len(scriptPubKey) < 81 (a scriptPubKey that's invalid due to invalid PUSHDATA's is allowed into blocks and would save a byte; e.g. ebc9fa1196a59e192352d76c0f6e73167046b9d37b8302b6bb6968dfd279b767)\r\n\r\nAnyway, verging towards shed-painting IMO.",
      "created_at" : "2013-10-23T10:48:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3128#issuecomment-26895529",
      "id" : 26895529,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3128",
      "updated_at" : "2013-10-23T10:48:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26895529",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Huh?  This two-line change seems to work properly:\r\n\r\n```\r\nFrom d485640daee9ecbbdd3f39ca7ab1cda83b99c4a5 Mon Sep 17 00:00:00 2001\r\nFrom: Gavin Andresen <gavinandresen@gmail.com>\r\nDate: Thu, 24 Oct 2013 11:20:23 +1000\r\nSubject: [PATCH] 0-byte OP_NULL_DATA\r\n\r\n---\r\n src/script.cpp                 | 3 ++-\r\n src/test/transaction_tests.cpp | 4 ++++\r\n 2 files changed, 6 insertions(+), 1 deletion(-)\r\n\r\ndiff --git a/src/script.cpp b/src/script.cpp\r\nindex 63f6327..79d0b2c 100644\r\n--- a/src/script.cpp\r\n+++ b/src/script.cpp\r\n@@ -1195,7 +1195,7 @@ bool CheckSig(vector<unsigned char> vchSig, const vector<unsigned char> &vchPubK\r\n bool Solver(const CScript& scriptPubKey, txnouttype& typeRet, vector<vector<unsigned char> >& vSolutionsRet)\r\n {\r\n     // Templates\r\n-    static map<txnouttype, CScript> mTemplates;\r\n+    static multimap<txnouttype, CScript> mTemplates;\r\n     if (mTemplates.empty())\r\n     {\r\n         // Standard tx, sender provides pubkey, receiver adds signature\r\n@@ -1208,6 +1208,7 @@ bool Solver(const CScript& scriptPubKey, txnouttype& typeRet, vector<vector<unsi\r\n         mTemplates.insert(make_pair(TX_MULTISIG, CScript() << OP_SMALLINTEGER << OP_PUBKEYS << OP_SMALLINTEGER << OP_CHECKMULTISIG));\r\n\r\n         // Empty, provably prunable, data-carrying output\r\n+        mTemplates.insert(make_pair(TX_NULL_DATA, CScript() << OP_RETURN));\r\n         mTemplates.insert(make_pair(TX_NULL_DATA, CScript() << OP_RETURN << OP_SMALLDATA));\r\n     }\r\n\r\ndiff --git a/src/test/transaction_tests.cpp b/src/test/transaction_tests.cpp\r\nindex 5dfb67c..5b69e64 100644\r\n--- a/src/test/transaction_tests.cpp\r\n+++ b/src/test/transaction_tests.cpp\r\n@@ -274,6 +274,10 @@ BOOST_AUTO_TEST_CASE(test_IsStandard)\r\n     t.vout[0].scriptPubKey = CScript() << OP_1;\r\n     BOOST_CHECK(!IsStandardTx(t, reason));\r\n\r\n+    // 0-byte TX_NULL_DATA (standard)\r\n+    t.vout[0].scriptPubKey = CScript() << OP_RETURN;\r\n+    BOOST_CHECK(IsStandardTx(t, reason));\r\n+\r\n     // 80-byte TX_NULL_DATA (standard)\r\n     t.vout[0].scriptPubKey = CScript() << OP_RETURN << ParseHex(\"04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef3804678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38\");\r\n     BOOST_CHECK(IsStandardTx(t, reason));\r\n--\r\n1.8.4\r\n```",
      "created_at" : "2013-10-24T01:21:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3128#issuecomment-26960098",
      "id" : 26960098,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3128",
      "updated_at" : "2013-10-24T01:21:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26960098",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "@gavinandresen Oh, doh, yeah lets just do that + the bugfix and ScriptSigArgsExpected() change I made.",
      "created_at" : "2013-10-24T01:29:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3128#issuecomment-26960416",
      "id" : 26960416,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3128",
      "updated_at" : "2013-10-24T01:29:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26960416",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Now using multimap so there's just TX_NULL_DATA",
      "created_at" : "2013-10-24T08:42:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3128#issuecomment-26975289",
      "id" : 26975289,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3128",
      "updated_at" : "2013-10-24T08:42:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26975289",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/005609539b2184a474ffe9ebfe883984c900a3fb for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2013-10-24T09:17:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3128#issuecomment-26977191",
      "id" : 26977191,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3128",
      "updated_at" : "2013-10-24T09:17:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/26977191",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   }
]
