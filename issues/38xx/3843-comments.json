[
   {
      "body" : "Interesting, bitcoinj is producing CHECKMULTISIG transactions that violate this rule. Fixed by @schildbach in https://github.com/schildbach/bitcoinj/commit/e3d97759d5692791821e8f1ee71856a9e8231dd7 (pull-req, not yet merged)\r\n\r\n bitcoinjs-lib does get it right however, which covers almost all real-world use of CHECKMULTISIG right now. (e.g. bitgo and bitrated) EDIT: litbitcoin gets it right too, which covers sx.",
      "created_at" : "2014-03-11T06:40:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-37267319",
      "id" : 37267319,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-03-11T10:49:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/37267319",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "ACK.\r\n\r\nI started working on some similar extra flags to implement my proposed version3 transaction/blocks, but didn't get to extend the unit tests as you did, so preferring this code goes in first.\r\n\r\nThis pull-request does contain a bunch of only moderately-related commits though, so perhaps others prefer seeing it split up. I'm personally fine with all.\r\n\r\nI'm not sure a separation into standard/mandatory will suffice in the future. Some flags may be mandatory in some context (nVersion=3 blocks) while not even being required in others. We'll see as we go, I guess.\r\n",
      "created_at" : "2014-03-11T15:32:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-37309153",
      "id" : 37309153,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-03-11T15:32:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/37309153",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Verifying some math:\r\n\r\nI think you can only fit a n-of-14 checkmultisig in a 510-byte redeem script IMHO. It requires an OP_(nRequired) + nKeys*(push of 33 bytes) + OP_(nKeys) + OP_CHECKMULTISIG. For nKeys=15, this requires 513 bytes.\r\n\r\nSo nKeys is at most 14, and the maximum standard redeemscript is 479 bytes.\r\n\r\nThe size limit on scriptSig can be made a bit more strict as well.\r\n\r\nSince the even-s signature creation rule, signatures are never more than 72 bytes, so 14*(72+1) + 479+1 = 1502 bytes can be the scriptSig limit (instead of 1721). This is also enough for spending a 20-of-20 multisig, by the way.",
      "created_at" : "2014-03-11T15:47:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-37311070",
      "id" : 37311070,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-03-11T15:47:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/37311070",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Ugh. The limit is 520 bytes, not 510.\r\n\r\nThis means nKeys can indeed be 15, and the maximum redeemscript is 513 bytes.\r\n\r\nThe maximum scriptSig then becomes 15*(72+1) + 513+1 = 1609.",
      "created_at" : "2014-03-11T15:49:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-37311291",
      "id" : 37311291,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-03-11T15:49:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/37311291",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@petertodd was that reindex with checkpoints=0 ?   I'd also suggest adding to your testplan a quick test of the test by turning on the rule like a blockchain rule and making sure it rejects the chain.",
      "created_at" : "2014-03-11T17:08:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-37321543",
      "id" : 37321543,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-03-11T17:08:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/37321543",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell Good point; checkpoints=0 does pass. I also did a testnet reindex with the test forced on, and as expected it fails at height 180683 due to tx 013b1d2d37f77ec0b6861b396d594ace1d6bbff97d1cc64e401c396e89ba0462.\r\n\r\n@sipa I lowered the limit to a rounded off 1650 bytes and updated the comment to be clear it wasn't the absolute lower-limit. I agree re: nVersion=3, and actually was going to suggest we think about whether or not treating that as a transaction-level flag and/or passing the transaction nVersion into EvalScript made sense, but that's a discussion for elsewhere. Mandatory/standard at least gives us a starting point for those more complex changes.",
      "created_at" : "2014-03-12T20:24:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-37459677",
      "id" : 37459677,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-03-12T20:24:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/37459677",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "I've been running a node for about a week now with this patch applied. No issues seen, and on top of that other than some of my own test transactions I haven't seen any CHECKMULTISIG usage that would be blocked by this patch; looks like all the implementations actually out there getting used are compliant.",
      "created_at" : "2014-03-18T22:08:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-37995139",
      "id" : 37995139,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-03-18T22:08:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/37995139",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Looks good. Haven't throughly tested it, but I am running a node and it seems to work fine.\r\n\r\nThis is a much desired fix.",
      "created_at" : "2014-03-31T03:11:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-39050771",
      "id" : 39050771,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-03-31T03:11:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/39050771",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/894059?v=3",
         "events_url" : "https://api.github.com/users/CodeShark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/CodeShark/followers",
         "following_url" : "https://api.github.com/users/CodeShark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/CodeShark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/CodeShark",
         "id" : 894059,
         "login" : "CodeShark",
         "organizations_url" : "https://api.github.com/users/CodeShark/orgs",
         "received_events_url" : "https://api.github.com/users/CodeShark/received_events",
         "repos_url" : "https://api.github.com/users/CodeShark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/CodeShark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/CodeShark"
      }
   },
   {
      "body" : "I've been running this patch for several weeks now and haven't run into any issues - any chance of this getting merged soon?",
      "created_at" : "2014-05-04T06:07:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-42125189",
      "id" : 42125189,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-05-04T06:07:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42125189",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/894059?v=3",
         "events_url" : "https://api.github.com/users/CodeShark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/CodeShark/followers",
         "following_url" : "https://api.github.com/users/CodeShark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/CodeShark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/CodeShark",
         "id" : 894059,
         "login" : "CodeShark",
         "organizations_url" : "https://api.github.com/users/CodeShark/orgs",
         "received_events_url" : "https://api.github.com/users/CodeShark/received_events",
         "repos_url" : "https://api.github.com/users/CodeShark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/CodeShark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/CodeShark"
      }
   },
   {
      "body" : "Lemme know if this needs a rebase; pull-reqs #3860 and #3861 depend on it as well.",
      "created_at" : "2014-05-05T05:05:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-42159413",
      "id" : 42159413,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-05-05T05:05:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42159413",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/3843#discussion_r12268918"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3843"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12268918"
         }
      },
      "body" : "Maybe define a constant `STANDARD_NOT_MANDATORY_VERIFY_FLAGS` that's `(STANDARD_SCRIPT_VERIFY_FLAGS & ~MANDATORY_SCRIPT_VERIFY_FLAGS)` instead of doing the bit twiddling here inline, twice.",
      "commit_id" : "787ee0c91394b0ae16ca2500dbacf9349e65b6bc",
      "created_at" : "2014-05-05T07:04:05Z",
      "diff_hunk" : "@@ -1573,14 +1577,30 @@ bool CheckInputs(const CTransaction& tx, CValidationState &state, CCoinsViewCach\n                     pvChecks->push_back(CScriptCheck());\n                     check.swap(pvChecks->back());\n                 } else if (!check()) {\n-                    if (flags & SCRIPT_VERIFY_STRICTENC) {\n-                        // For now, check whether the failure was caused by non-canonical\n-                        // encodings or not; if so, don't trigger DoS protection.\n-                        CScriptCheck check(coins, tx, i, flags & (~SCRIPT_VERIFY_STRICTENC), 0);\n+                    if (flags & (STANDARD_SCRIPT_VERIFY_FLAGS & ~MANDATORY_SCRIPT_VERIFY_FLAGS)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#discussion_r12268918",
      "id" : 12268918,
      "original_commit_id" : "b3eb5a208e416cec68cd63999e271529274a0d9c",
      "original_position" : 36,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3843",
      "updated_at" : "2014-05-08T05:10:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12268918",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/3843#discussion_r12268960"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3843"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12268960"
         }
      },
      "body" : "I'd make this parsing a bit more strict: fail if the word is not in mapFlagNames instead of treating it as 0. This avoids tests testing something else than you think due to a typo.",
      "commit_id" : "787ee0c91394b0ae16ca2500dbacf9349e65b6bc",
      "created_at" : "2014-05-05T07:07:23Z",
      "diff_hunk" : "@@ -11,16 +11,41 @@\n #include <map>\n #include <string>\n \n+#include <boost/algorithm/string/classification.hpp>\n+#include <boost/algorithm/string/split.hpp>\n #include <boost/test/unit_test.hpp>\n #include \"json/json_spirit_writer_template.h\"\n \n using namespace std;\n using namespace json_spirit;\n+using namespace boost::algorithm;\n \n // In script_tests.cpp\n extern Array read_json(const std::string& jsondata);\n extern CScript ParseScript(string s);\n \n+unsigned int ParseFlags(string strFlags){\n+    unsigned int flags = 0;\n+    vector<string> words;\n+    split(words, strFlags, is_any_of(\",\"));\n+\n+    // Note how NOCACHE is not included as it is a runtime-only flag.\n+    static map<string, unsigned int> mapFlagNames;\n+    if (mapFlagNames.size() == 0)\n+    {\n+        mapFlagNames[\"NONE\"] = SCRIPT_VERIFY_NONE;\n+        mapFlagNames[\"P2SH\"] = SCRIPT_VERIFY_P2SH;\n+        mapFlagNames[\"STRICTENC\"] = SCRIPT_VERIFY_STRICTENC;\n+        mapFlagNames[\"EVEN_S\"] = SCRIPT_VERIFY_EVEN_S;\n+        mapFlagNames[\"NULLDUMMY\"] = SCRIPT_VERIFY_NULLDUMMY;\n+    }\n+\n+    BOOST_FOREACH(string word, words)\n+        flags |= mapFlagNames[word];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#discussion_r12268960",
      "id" : 12268960,
      "original_commit_id" : "b3eb5a208e416cec68cd63999e271529274a0d9c",
      "original_position" : 34,
      "path" : "src/test/transaction_tests.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3843",
      "updated_at" : "2014-05-08T05:10:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12268960",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/3843#discussion_r12268992"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3843"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12268992"
         }
      },
      "body" : "Maybe\r\n\r\n    return error(\"CBasicKeyStore::AddCScript() : redeemScripts > %i bytes are invalid\", MAX_SCRIPT_ELEMENT_SIZE);\r\n",
      "commit_id" : "787ee0c91394b0ae16ca2500dbacf9349e65b6bc",
      "created_at" : "2014-05-05T07:09:52Z",
      "diff_hunk" : "@@ -33,6 +33,9 @@ bool CBasicKeyStore::AddKeyPubKey(const CKey& key, const CPubKey &pubkey)\n \n bool CBasicKeyStore::AddCScript(const CScript& redeemScript)\n {\n+    if (redeemScript.size() > MAX_SCRIPT_ELEMENT_SIZE)\n+        return error(\"CBasicKeyStore::AddCScript() : redeemScripts > 520 bytes are invalid\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#discussion_r12268992",
      "id" : 12268992,
      "original_commit_id" : "b3eb5a208e416cec68cd63999e271529274a0d9c",
      "original_position" : 5,
      "path" : "src/keystore.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3843",
      "updated_at" : "2014-05-08T05:10:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12268992",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Looks good to me, ACK apart from above minor nits",
      "created_at" : "2014-05-05T07:25:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-42164361",
      "id" : 42164361,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-05-05T07:25:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42164361",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/3843#discussion_r12273140"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3843"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12273140"
         }
      },
      "body" : "Oh! I didn't realize C++ modified a map if you used [] on a unknown key, weird.",
      "commit_id" : "787ee0c91394b0ae16ca2500dbacf9349e65b6bc",
      "created_at" : "2014-05-05T10:02:32Z",
      "diff_hunk" : "@@ -11,16 +11,41 @@\n #include <map>\n #include <string>\n \n+#include <boost/algorithm/string/classification.hpp>\n+#include <boost/algorithm/string/split.hpp>\n #include <boost/test/unit_test.hpp>\n #include \"json/json_spirit_writer_template.h\"\n \n using namespace std;\n using namespace json_spirit;\n+using namespace boost::algorithm;\n \n // In script_tests.cpp\n extern Array read_json(const std::string& jsondata);\n extern CScript ParseScript(string s);\n \n+unsigned int ParseFlags(string strFlags){\n+    unsigned int flags = 0;\n+    vector<string> words;\n+    split(words, strFlags, is_any_of(\",\"));\n+\n+    // Note how NOCACHE is not included as it is a runtime-only flag.\n+    static map<string, unsigned int> mapFlagNames;\n+    if (mapFlagNames.size() == 0)\n+    {\n+        mapFlagNames[\"NONE\"] = SCRIPT_VERIFY_NONE;\n+        mapFlagNames[\"P2SH\"] = SCRIPT_VERIFY_P2SH;\n+        mapFlagNames[\"STRICTENC\"] = SCRIPT_VERIFY_STRICTENC;\n+        mapFlagNames[\"EVEN_S\"] = SCRIPT_VERIFY_EVEN_S;\n+        mapFlagNames[\"NULLDUMMY\"] = SCRIPT_VERIFY_NULLDUMMY;\n+    }\n+\n+    BOOST_FOREACH(string word, words)\n+        flags |= mapFlagNames[word];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#discussion_r12273140",
      "id" : 12273140,
      "original_commit_id" : "b3eb5a208e416cec68cd63999e271529274a0d9c",
      "original_position" : 34,
      "path" : "src/test/transaction_tests.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3843",
      "updated_at" : "2014-05-08T05:10:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12273140",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/3843#discussion_r12273195"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3843"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12273195"
         }
      },
      "body" : "It's really a pitfall. To paraphrase the horse_unix twitter account: \"the definition of operator[] is extremely simple: m[k] is equivalent to (*((m.insert(value_type(k, data_type()))).first)).second.\"\r\n\r\nI wouldn't be surprised if Bitcoin Core itself also had a minor bug or two due to strangeness with [. In general using the explicit .find() results in more clear (though also more verbose...) code.\r\n\r\n",
      "commit_id" : "787ee0c91394b0ae16ca2500dbacf9349e65b6bc",
      "created_at" : "2014-05-05T10:05:39Z",
      "diff_hunk" : "@@ -11,16 +11,41 @@\n #include <map>\n #include <string>\n \n+#include <boost/algorithm/string/classification.hpp>\n+#include <boost/algorithm/string/split.hpp>\n #include <boost/test/unit_test.hpp>\n #include \"json/json_spirit_writer_template.h\"\n \n using namespace std;\n using namespace json_spirit;\n+using namespace boost::algorithm;\n \n // In script_tests.cpp\n extern Array read_json(const std::string& jsondata);\n extern CScript ParseScript(string s);\n \n+unsigned int ParseFlags(string strFlags){\n+    unsigned int flags = 0;\n+    vector<string> words;\n+    split(words, strFlags, is_any_of(\",\"));\n+\n+    // Note how NOCACHE is not included as it is a runtime-only flag.\n+    static map<string, unsigned int> mapFlagNames;\n+    if (mapFlagNames.size() == 0)\n+    {\n+        mapFlagNames[\"NONE\"] = SCRIPT_VERIFY_NONE;\n+        mapFlagNames[\"P2SH\"] = SCRIPT_VERIFY_P2SH;\n+        mapFlagNames[\"STRICTENC\"] = SCRIPT_VERIFY_STRICTENC;\n+        mapFlagNames[\"EVEN_S\"] = SCRIPT_VERIFY_EVEN_S;\n+        mapFlagNames[\"NULLDUMMY\"] = SCRIPT_VERIFY_NULLDUMMY;\n+    }\n+\n+    BOOST_FOREACH(string word, words)\n+        flags |= mapFlagNames[word];",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#discussion_r12273195",
      "id" : 12273195,
      "original_commit_id" : "b3eb5a208e416cec68cd63999e271529274a0d9c",
      "original_position" : 34,
      "path" : "src/test/transaction_tests.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3843",
      "updated_at" : "2014-05-08T05:10:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12273195",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj Fixed all minor nits.",
      "created_at" : "2014-05-05T10:07:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-42174231",
      "id" : 42174231,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-05-05T10:07:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42174231",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "@gavinandresen can you have a final look at this before merging?\r\n",
      "created_at" : "2014-05-05T10:09:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-42174342",
      "id" : 42174342,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-05-05T10:09:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42174342",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Code-reviewed, but untested, ACK.\r\n",
      "created_at" : "2014-05-05T12:58:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-42184669",
      "id" : 42184669,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-05-05T12:58:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42184669",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "@sipa Fixed that comment and added a test for stack size prior to stacktop().",
      "created_at" : "2014-05-08T05:12:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-42513949",
      "id" : 42513949,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-05-08T05:12:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42513949",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/787ee0c91394b0ae16ca2500dbacf9349e65b6bc for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-05-08T05:37:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3843#issuecomment-42514922",
      "id" : 42514922,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3843",
      "updated_at" : "2014-05-08T05:37:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/42514922",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   }
]
