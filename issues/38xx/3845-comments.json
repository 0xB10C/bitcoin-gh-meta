[
   {
      "body" : "Note that this basically implements what is requested in #3795, except that you can use it for confirmed transactions as well, which may be pointless (or maybe not... not sure).\r\n",
      "created_at" : "2014-03-11T10:16:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-37280447",
      "id" : 37280447,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-03-11T10:16:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/37280447",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/3845#discussion_r10479778"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3845"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/10479778"
         }
      },
      "body" : "Can you use a queue of to-be-deleted txids instead of recursion here?",
      "commit_id" : "e50b57541cf8fdce7671e065886d8458a78df6eb",
      "created_at" : "2014-03-11T15:55:59Z",
      "diff_hunk" : "@@ -762,6 +762,40 @@ DBErrors CWalletDB::ZapWalletTx(CWallet* pwallet)\n     return DB_LOAD_OK;\n }\n \n+DBErrors CWalletDB::ZapWalletTx(CWallet* pwallet, const CWalletTx& wtx, vector<CWalletTx>& vErasedTxes)\n+{\n+    LogPrintf(\"ZapWalletTx %s\\n\", wtx.GetHash().GetHex());\n+\n+    // erase child TX's\n+    for (unsigned int nVoutIndex = 0; nVoutIndex < wtx.vout.size(); nVoutIndex++)\n+    {\n+        BOOST_FOREACH(PAIRTYPE(uint256, CWalletTx) walletEntry, pwallet->mapWallet)\n+        {\n+            const CWalletTx& wtxPotentialChild = walletEntry.second;\n+            BOOST_FOREACH(const CTxIn& txin, wtxPotentialChild.vin)\n+            {\n+                if (txin.prevout.hash == wtx.GetHash() && txin.prevout.n == nVoutIndex)\n+                {\n+                    LogPrintf(\"ZapWalletTx found child tx %s\\n\", wtxPotentialChild.GetHash().GetHex());\n+                    //TODO: recursion could be a problem if it gets too deep\n+                    DBErrors ret = ZapWalletTx(pwallet, wtxPotentialChild, vErasedTxes);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#discussion_r10479778",
      "id" : 10479778,
      "original_commit_id" : "e0d31dd67b29ee6f304386d465cde855dc134234",
      "original_position" : 43,
      "path" : "src/walletdb.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/3845",
      "updated_at" : "2014-03-12T09:19:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/10479778",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/e50b57541cf8fdce7671e065886d8458a78df6eb for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-03-18T21:39:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-37992081",
      "id" : 37992081,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-03-18T21:39:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/37992081",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "What now?",
      "created_at" : "2014-03-19T02:23:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-38011534",
      "id" : 38011534,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-03-19T02:23:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/38011534",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42459?v=3",
         "events_url" : "https://api.github.com/users/djpnewton/events{/privacy}",
         "followers_url" : "https://api.github.com/users/djpnewton/followers",
         "following_url" : "https://api.github.com/users/djpnewton/following{/other_user}",
         "gists_url" : "https://api.github.com/users/djpnewton/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/djpnewton",
         "id" : 42459,
         "login" : "djpnewton",
         "organizations_url" : "https://api.github.com/users/djpnewton/orgs",
         "received_events_url" : "https://api.github.com/users/djpnewton/received_events",
         "repos_url" : "https://api.github.com/users/djpnewton/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/djpnewton/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/djpnewton/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/djpnewton"
      }
   },
   {
      "body" : "People need to test it and review the code and post ACKs.\r\n",
      "created_at" : "2014-03-19T10:28:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-38035887",
      "id" : 38035887,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-03-19T10:28:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/38035887",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "... which of course, no one does... Sigh. It happens every time, at one point everyone seems to want a certain feature, then it is implemented, and no one of the people that requested it is around anymore.\r\n\r\nIs really no one interested in this? No one with 'zombie transactions' that wants the joy of zapping them one by one?\r\n\r\nMaybe you could ask on the mailing list, IRC or forum whether someone wants to help test.\r\n",
      "created_at" : "2014-04-05T09:53:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-39633717",
      "id" : 39633717,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-04-05T09:53:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/39633717",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Pardon my ignorance, but what exactly does this fix?\r\n",
      "created_at" : "2014-04-07T01:42:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-39690137",
      "id" : 39690137,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-04-07T01:42:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/39690137",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6835520?v=3",
         "events_url" : "https://api.github.com/users/kjsisco/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kjsisco/followers",
         "following_url" : "https://api.github.com/users/kjsisco/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kjsisco/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kjsisco",
         "id" : 6835520,
         "login" : "kjsisco",
         "organizations_url" : "https://api.github.com/users/kjsisco/orgs",
         "received_events_url" : "https://api.github.com/users/kjsisco/received_events",
         "repos_url" : "https://api.github.com/users/kjsisco/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kjsisco/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kjsisco/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kjsisco"
      }
   },
   {
      "body" : "It is not a 'fix', it adds the possibility to remove individual stuck transactions.\r\n",
      "created_at" : "2014-04-07T06:57:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-39700860",
      "id" : 39700860,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-04-07T06:57:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/39700860",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I have some suggestions to this pull request:\r\n\r\n- Do not allow to erase confirmed transactions:\r\nThey would be recovered through rescan, so why delete them?\r\n(Some wallet pruning funtionality, to clean up large wallets,\r\nand erase old spent transactions could make sense, but thats a different story.)\r\n\r\n- Forget about the rescan:\r\nIf we dont allow erasing confirmed transaction there is no reason to do a rescan as\r\nthe wallet vfSpent flags have been removed.\r\n\r\n- Rename \"zapwallettx\" to \"erasewallettx\":\r\nI think the term \"erase\" is preferred to be used in software over \"zap\" for deleting something permanently.\r\n\r\n- Do not make any changes in walletdb.cpp at all:\r\nCurrently we pass a wallet pointer to walletdb.cpp and then loop mapWallet there.\r\nInstead simply loop mapWallet in wallet.cpp and fill vErasedTxes. Then loop\r\nvErasedTxes and call CWallet::EraseFromWallet for every tx to erase. This function deletes both, database and mapWallet. No code additions to walletdb.cpp needed.\r\n\r\n- Add special case parameter \"all\":\r\nIf the passed txid is \"all\" => erase all unconfirmed transactions.\r\nThe loop could be done in the rpc method and fill the queue with all unconfirmed transactions already.\r\nThen simply pass the queue directly to CWallet::EraseWalletTxes.\r\nSo EraseWalletTxes takes a queue as parameter, which is either all or only 1 unconformed tx.\r\n\r\n- Remove zapwallettxes completely:\r\nThe reason for zapwallettxes to run on startup and do a rescan was to avoid messing up the wallet\r\nvfSpent flags. Now that they are gone and if we had a \"erasewallettx all/txid\", I vote for removing\r\nzapwallettxes completely. Zapwallettxes doesnt really solve anything other than removing unconfirmed transactions.\r\nIf your wallet is that corrupt then you are better off using either berkeley db repair tools or start a new clean wallet by using salvagewallet/pywallet/importwallet.\r\n\r\n- Remove from mapTxSpends:\r\nEvery erased transaction needs to be removed from CWallet::mapTxSpends.\r\nThe code could be added to CWallet::EraseFromWallet.\r\n\r\n- Remove from setLockedCoins:\r\nTo have a clean state of CWallet::setLockedCoins the transaction should be removed there (if its in there).\r\nThe code could be added to CWallet::EraseFromWallet.\r\n\r\n- (Remove from coin control selection):\r\nYou could trigger a temporary minor bug, if you select a transaction in coin control and then erase it.\r\nBut this would require to pass a signal to walletmodel. Its no critical bug, even if it happens, and very unlikely scenario, so I would be fine just forgetting about this.\r\n\r\n- Mention metadata in rpc help text:\r\nTransaction metadata like strFromAccount gets lost, if someone erases an unconfirmed transaction, which then gets confirmed because it had already been broadcasted.\r\nI think we shouldnt bother much, but at least mention this in the rpc help text:\r\n\"Notice: An erased transaction which still gets confirmed by miners, will be readded to the wallet without transaction meta data e.g. account owner and payment request information.\"\r\n\r\n- About the workqueue: \r\n  - This loop can be removed: for (unsigned int nVoutIndex = 0; nVoutIndex &lt; wtx.vout.size(); nVoutIndex++).\r\n   It is enough to check the hash only.\r\n   if (txin.prevout.hash == wtx.GetHash()) => Found child\r\n  - it is possible transactions get added multiple times to the queue, so to have a clean algorithm, I suggest adding txs into a set&lt;uint256&gt;\r\n    to ensure every transaction only gets processed once. If a transaction is already in the set, skip it, because\r\n    it is or was already in the queue.\r\n  - nit: use vector instead of &lt;queue&gt;, just because we dont use queue anywhere else. (not important)\r\n\r\n- Return bool instead of DBErrors:\r\nDBErrors is for when loading the wallet.\r\n\r\n- Remove DB_NEED_REWRITE and cr+:\r\nThose 2 dont make sense either. The \"c\" is for DB_CREATE if the wallet file does not exist\r\nand rewrite gets checked on wallet load. But they should remove anyway if we refactor\r\nthe code from walletdb.cpp to wallet.cpp as I suggested above.\r\n\r\n- Notify GUI: \r\nFor every erased transaction we need to update the GUI. This can be done when looping vErasedTxes.\r\nNotifyTransactionChanged(this, hash, CT_DELETED);",
      "created_at" : "2014-04-09T10:57:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-39951255",
      "id" : 39951255,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-04-09T10:57:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/39951255",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2814559?v=3",
         "events_url" : "https://api.github.com/users/cozz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cozz/followers",
         "following_url" : "https://api.github.com/users/cozz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cozz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cozz",
         "id" : 2814559,
         "login" : "cozz",
         "organizations_url" : "https://api.github.com/users/cozz/orgs",
         "received_events_url" : "https://api.github.com/users/cozz/received_events",
         "repos_url" : "https://api.github.com/users/cozz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cozz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cozz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cozz"
      }
   },
   {
      "body" : "It seems a lot of work and impact for something that has a very rare use-case.\r\n\r\nThere is also little interest in this pull from testers, I suppose most actual issues with stuck wallet transactions can be solved by passing `-zapwalletxes`. For this rare use-case, it's not a big issue to have to restart the daemon, avoiding all the changes to bookkeeping that would be necessary as @cozz mentions.\r\n\r\nSo I'm leaning toward closing this.",
      "created_at" : "2014-06-03T07:03:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-44926469",
      "id" : 44926469,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-06-03T07:03:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44926469",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Or let @cozz do a rebase of this, if he has time and will :)? I also greatly dislike zap as a term for erase or remove!",
      "created_at" : "2014-06-03T07:40:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-44928866",
      "id" : 44928866,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-06-03T07:41:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44928866",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "I am fine with closing, as you said, if someone needs to clear his unconfirmed transactions he can use zapwallettxes. I would just like to see some changes to zapwallettxes:\r\n- do not delete confirmed txes. Why do we delete confirmed txes with zapwallettxes? This does not make sense anymore after removing of vfSpent. This would also prevent people from erasing transation meta data to their confirmed transactions.\r\n- no rescan anymore\r\n- change description to \"Erase unconfirmed wallet transactions\"\r\n- preferably rename zapwallettxes to eraseunconfirmedtxes\r\n",
      "created_at" : "2014-06-03T14:38:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-44972750",
      "id" : 44972750,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-06-03T14:38:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44972750",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2814559?v=3",
         "events_url" : "https://api.github.com/users/cozz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cozz/followers",
         "following_url" : "https://api.github.com/users/cozz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cozz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cozz",
         "id" : 2814559,
         "login" : "cozz",
         "organizations_url" : "https://api.github.com/users/cozz/orgs",
         "received_events_url" : "https://api.github.com/users/cozz/received_events",
         "repos_url" : "https://api.github.com/users/cozz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cozz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cozz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cozz"
      }
   },
   {
      "body" : "Ok, closing this. I'm fine with improving zapwallettxes. Removing only unconfirmed transactions makes sense to me in the common case (but there may be scenarios in which one may want to remove all transactions, I don't know, I suppose we didn't add this without a reason). I also think you are a humorless bunch, zapping transactions is all the fun :)\r\n",
      "created_at" : "2014-06-03T14:48:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-44974045",
      "id" : 44974045,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-06-03T14:48:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44974045",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "ok, lets make it -nukerandomwallettx so people can play russian roulette with it :)",
      "created_at" : "2014-06-03T15:04:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-44976328",
      "id" : 44976328,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-06-03T15:04:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44976328",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2814559?v=3",
         "events_url" : "https://api.github.com/users/cozz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cozz/followers",
         "following_url" : "https://api.github.com/users/cozz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cozz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cozz",
         "id" : 2814559,
         "login" : "cozz",
         "organizations_url" : "https://api.github.com/users/cozz/orgs",
         "received_events_url" : "https://api.github.com/users/cozz/received_events",
         "repos_url" : "https://api.github.com/users/cozz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cozz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cozz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cozz"
      }
   },
   {
      "body" : "Additive rather than subtractive methods are more reliable.  Thus, the feature (a) zaps everything, then lets the normal processing/rescanning code (b) add back that which is necessary.\r\n\r\n\"removing only X type of transactions\" is a less reliable method that will inevitably need tweaking if that fails to meet your needs.  As such, I don't view updating -zapwallettxes to remove only unconfirmed transactions as an improvement.\r\n",
      "created_at" : "2014-06-03T16:25:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-44987265",
      "id" : 44987265,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-06-03T16:25:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44987265",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "@jgarzik Hmm, is there really a use case where I want to zap my confirmed transactions, and then recover the exact same transactions through rescan other than a corrupt wallet?",
      "created_at" : "2014-06-03T16:37:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-44988809",
      "id" : 44988809,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-06-03T16:37:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44988809",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2814559?v=3",
         "events_url" : "https://api.github.com/users/cozz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cozz/followers",
         "following_url" : "https://api.github.com/users/cozz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cozz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cozz",
         "id" : 2814559,
         "login" : "cozz",
         "organizations_url" : "https://api.github.com/users/cozz/orgs",
         "received_events_url" : "https://api.github.com/users/cozz/received_events",
         "repos_url" : "https://api.github.com/users/cozz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cozz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cozz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cozz"
      }
   },
   {
      "body" : "A re-evaluation of the chain from clean slate is more secure.  Who can say if your \"confirmed\" transactions are still on the latest/best chain?\r\n",
      "created_at" : "2014-06-03T16:44:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-44989693",
      "id" : 44989693,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-06-03T16:44:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44989693",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Our software checks all the time with GetDepthInMainChain(..), how deep transactions are in the main chain.\r\n\r\nI just dont see a scenario for zapping a confirmed transaction, if it gets recovered with rescan anyway.\r\nI still vote for not removing confirmed transactions and not do a rescan. But thats just my opinion. I guess I am just missing something here.",
      "created_at" : "2014-06-03T17:31:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-44995406",
      "id" : 44995406,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-06-03T17:31:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44995406",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2814559?v=3",
         "events_url" : "https://api.github.com/users/cozz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cozz/followers",
         "following_url" : "https://api.github.com/users/cozz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cozz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cozz",
         "id" : 2814559,
         "login" : "cozz",
         "organizations_url" : "https://api.github.com/users/cozz/orgs",
         "received_events_url" : "https://api.github.com/users/cozz/received_events",
         "repos_url" : "https://api.github.com/users/cozz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cozz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cozz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cozz"
      }
   },
   {
      "body" : "My question was a rhetorical question, pointing out the problem with alternative approaches.  \"Don't zap confirmed transactions\" is strictly defined as \"don't zap transactions which will probably but not 100% certainly remain confirmed\" which is not equivalent.\r\n\r\nPerforming redundant work is not an issue here, as rescan is a one-time, offline recovery operation.  There is no need to micro-optimize these situations.  Indeed, micro-optimizing this situation may potentially make the feature less useful.\r\n",
      "created_at" : "2014-06-03T17:39:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-44996342",
      "id" : 44996342,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-06-03T17:39:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44996342",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Ok, lets just stay with the current behavior then. I have submitted a pull for recovering metadata in the past #3674. This can be useful for people who only want to remove their unconfirmed transactions without losing their account balances and payment request information etc of the confirmed transactions.",
      "created_at" : "2014-06-03T18:05:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/3845#issuecomment-44999494",
      "id" : 44999494,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/3845",
      "updated_at" : "2014-06-03T18:05:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44999494",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2814559?v=3",
         "events_url" : "https://api.github.com/users/cozz/events{/privacy}",
         "followers_url" : "https://api.github.com/users/cozz/followers",
         "following_url" : "https://api.github.com/users/cozz/following{/other_user}",
         "gists_url" : "https://api.github.com/users/cozz/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/cozz",
         "id" : 2814559,
         "login" : "cozz",
         "organizations_url" : "https://api.github.com/users/cozz/orgs",
         "received_events_url" : "https://api.github.com/users/cozz/received_events",
         "repos_url" : "https://api.github.com/users/cozz/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/cozz/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/cozz/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/cozz"
      }
   }
]
