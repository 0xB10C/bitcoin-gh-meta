[
   {
      "body" : "Looks like this test is acting up: \r\nhttps://travis-ci.org/bitcoin/bitcoin/jobs/248398016\r\nhttps://travis-ci.org/bitcoin/bitcoin/jobs/248398018\r\nMight need a similar change to #10659.",
      "created_at" : "2017-06-29T15:39:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10704#issuecomment-312005841",
      "id" : 312005841,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10704",
      "updated_at" : "2017-06-29T15:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/312005841",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10704#discussion_r124844368"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10704"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/124844368"
         }
      },
      "body" : "I don't feel strongly, but the reason I put this in was that I didn't think that changes to the default test framework should cause tests to break -- since this test relies on a particular configuration, I felt it was best to define that locally.",
      "commit_id" : "b7870b7949e614d90b2f831b42065afc0ab694f2",
      "created_at" : "2017-06-29T16:07:43Z",
      "diff_hunk" : "@@ -37,45 +23,47 @@\n        * submit block to node\n        * if node crashed on/after submitting:\n          - restart until recovery succeeds\n-         - check that utxo matches node3 using gettxoutsetinfo\n-'''\n+         - check that utxo matches node3 using gettxoutsetinfo\"\"\"\n \n-class ChainstateWriteCrashTest(BitcoinTestFramework):\n+import errno\n+import http.client\n+import random\n+import time\n+\n+from test_framework.mininode import *\n+from test_framework.script import *\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n \n+class ChainstateWriteCrashTest(BitcoinTestFramework):\n     def __init__(self):\n         super().__init__()\n-        self.num_nodes = 4",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10704#discussion_r124844368",
      "id" : 124844368,
      "original_commit_id" : "b7870b7949e614d90b2f831b42065afc0ab694f2",
      "original_position" : 45,
      "path" : "test/functional/dbcrash.py",
      "position" : 45,
      "pull_request_review_id" : 47174299,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10704",
      "updated_at" : "2017-06-29T16:20:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/124844368",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10704#discussion_r124845800"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10704"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/124845800"
         }
      },
      "body" : "Also, can you set a custom timewait for the RPC connections in this test to resolve the travis issues that have come up so far:\r\nhttps://travis-ci.org/bitcoin/bitcoin/jobs/248398018#L2153",
      "commit_id" : "b7870b7949e614d90b2f831b42065afc0ab694f2",
      "created_at" : "2017-06-29T16:13:28Z",
      "diff_hunk" : "@@ -37,45 +23,47 @@\n        * submit block to node\n        * if node crashed on/after submitting:\n          - restart until recovery succeeds\n-         - check that utxo matches node3 using gettxoutsetinfo\n-'''\n+         - check that utxo matches node3 using gettxoutsetinfo\"\"\"\n \n-class ChainstateWriteCrashTest(BitcoinTestFramework):\n+import errno\n+import http.client\n+import random\n+import time\n+\n+from test_framework.mininode import *\n+from test_framework.script import *\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n \n+class ChainstateWriteCrashTest(BitcoinTestFramework):\n     def __init__(self):\n         super().__init__()\n-        self.num_nodes = 4",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10704#discussion_r124845800",
      "id" : 124845800,
      "original_commit_id" : "b7870b7949e614d90b2f831b42065afc0ab694f2",
      "original_position" : 45,
      "path" : "test/functional/dbcrash.py",
      "position" : 45,
      "pull_request_review_id" : 47174299,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10704",
      "updated_at" : "2017-06-29T16:20:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/124845800",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10704#discussion_r124846671"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10704"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/124846671"
         }
      },
      "body" : "I think this RemoteDisconnected exception may not exist pre-3.5, which would explain this travis failure:\r\nhttps://travis-ci.org/bitcoin/bitcoin/jobs/248398016#L3321\r\n\r\nI'm not sure what the best way to handle that is...",
      "commit_id" : "b7870b7949e614d90b2f831b42065afc0ab694f2",
      "created_at" : "2017-06-29T16:17:10Z",
      "diff_hunk" : "@@ -99,14 +87,16 @@ def restart_node(self, node_index, expected_tip):\n         # and make sure that recovery happens.\n         raise AssertionError(\"Unable to successfully restart node %d in allotted time\", node_index)\n \n-    # Try submitting a block to the given node.\n-    # Catch any exceptions that indicate the node has crashed.\n-    # Returns true if the block was submitted successfully; false otherwise.\n     def submit_block_catch_error(self, node_index, block):\n+        \"\"\"Try submitting a block to the given node.\n+\n+        Catch any exceptions that indicate the node has crashed.\n+        Returns true if the block was submitted successfully; false otherwise.\"\"\"\n+\n         try:\n             self.nodes[node_index].submitblock(block)\n             return True\n-        except (httplib.CannotSendRequest, httplib.RemoteDisconnected) as e:\n+        except (http.client.CannotSendRequest, http.client.RemoteDisconnected) as e:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10704#discussion_r124846671",
      "id" : 124846671,
      "original_commit_id" : "b7870b7949e614d90b2f831b42065afc0ab694f2",
      "original_position" : 106,
      "path" : "test/functional/dbcrash.py",
      "position" : 106,
      "pull_request_review_id" : 47174299,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10704",
      "updated_at" : "2017-06-29T16:20:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/124846671",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10704#discussion_r124847135"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10704"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/124847135"
         }
      },
      "body" : "Feel free to address the TODO as well :)  I think you just do something like `relayfee = self.nodes[0].getnetworkinfo()['relayfee']`, and then convert to the right units.",
      "commit_id" : "b7870b7949e614d90b2f831b42065afc0ab694f2",
      "created_at" : "2017-06-29T16:19:17Z",
      "diff_hunk" : "@@ -175,9 +168,8 @@ def verify_utxo_hash(self):\n                 nodei_utxo_hash = self.restart_node(i, self.nodes[3].getbestblockhash())\n             assert_equal(nodei_utxo_hash, node3_utxo_hash)\n \n-\n     def generate_small_transactions(self, node, count, utxo_list):\n-        FEE = 1000 # TODO: replace this with node relay fee based calculation\n+        FEE = 1000  # TODO: replace this with node relay fee based calculation",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10704#discussion_r124847135",
      "id" : 124847135,
      "original_commit_id" : "b7870b7949e614d90b2f831b42065afc0ab694f2",
      "original_position" : 148,
      "path" : "test/functional/dbcrash.py",
      "position" : 148,
      "pull_request_review_id" : 47174299,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10704",
      "updated_at" : "2017-06-29T16:20:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/124847135",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   }
]
