[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #18699 (wallet: Avoid translating RPC errors by MarcoFalke)\n* #18647 (rpc: remove g_rpc_node & g_rpc_chain by brakmic)\n* #18592 (rpc: replace raw pointers with shared_ptrs by brakmic)\n* #16528 (Native Descriptor Wallets using DescriptorScriptPubKeyMan by achow101)\n* #11413 ([wallet] [rpc] sendtoaddress/sendmany: Add explicit feerate option by kallewoof)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-04-15T23:56:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18654#issuecomment-614337121",
      "id" : 614337121,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18654",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxNDMzNzEyMQ==",
      "updated_at" : "2020-04-19T22:43:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/614337121",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. I wish there was a way to prevent duplicating walls of help text.",
      "created_at" : "2020-04-22T18:15:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18654#issuecomment-617945344",
      "id" : 617945344,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18654",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxNzk0NTM0NA==",
      "updated_at" : "2020-04-22T18:15:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/617945344",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I wish there was a way to prevent duplicating walls of help text.\r\n\r\n`RPCHelpMan` can not be duplicated because it takes the RPC method's name, but anything you pass to RPCHelpMan are basic C++11 structs that can be made const globals (or returned by helper functions like `GetBumpFee{HelpText,Args,...}`.) and then passed into the rpc help man.",
      "created_at" : "2020-04-22T18:28:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18654#issuecomment-617952407",
      "id" : 617952407,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18654",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYxNzk1MjQwNw==",
      "updated_at" : "2020-04-22T18:28:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/617952407",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18654#discussion_r413910879"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18654"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413910879"
         }
      },
      "author_association" : "MEMBER",
      "body" : "/bumpfee/psbtbumpfee",
      "commit_id" : "550337ca3d94cb1eb22b3c54753cb5ec0a03d0bd",
      "created_at" : "2020-04-23T15:46:17Z",
      "diff_hunk" : "@@ -3510,6 +3510,97 @@ static UniValue bumpfee(const JSONRPCRequest& request)\n     return result;\n }\n \n+static UniValue psbtbumpfee(const JSONRPCRequest& request)\n+{\n+    std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n+    CWallet* const pwallet = wallet.get();\n+\n+\n+    if (!EnsureWalletIsAvailable(pwallet, request.fHelp))\n+        return NullUniValue;\n+\n+            RPCHelpMan{\"psbtbumpfee\",\n+                \"\\nBumps the fee of an opt-in-RBF transaction T, replacing it with a new transaction B.\\n\"\n+                \"Returns a PSBT instead of creating and signing a new transaction.\\n\"\n+                \"An opt-in RBF transaction with the given txid must be in the wallet.\\n\"\n+                \"The command will pay the additional fee by reducing change outputs or adding inputs when necessary. It may add a new change output if one does not already exist.\\n\"\n+                \"All inputs in the original transaction will be included in the replacement transaction.\\n\"\n+                \"The command will fail if the wallet or mempool contains a transaction that spends one of T's outputs.\\n\"\n+                \"By default, the new fee will be calculated automatically using estimatesmartfee.\\n\"\n+                \"The user can specify a confirmation target for estimatesmartfee.\\n\"\n+                \"Alternatively, the user can specify a fee_rate (\" + CURRENCY_UNIT + \" per kB) for the new transaction.\\n\"\n+                \"At a minimum, the new fee rate must be high enough to pay an additional new relay fee (incrementalfee\\n\"\n+                \"returned by getnetworkinfo) to enter the node's mempool.\\n\",\n+                {\n+                    {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The txid to be bumped\"},\n+                    {\"options\", RPCArg::Type::OBJ, RPCArg::Optional::OMITTED_NAMED_ARG, \"\",\n+                        {\n+                            {\"confTarget\", RPCArg::Type::NUM, /* default */ \"wallet default\", \"Confirmation target (in blocks)\"},\n+                            {\"fee_rate\", RPCArg::Type::NUM, /* default */ \"fall back to 'confTarget'\", \"fee rate (NOT total fee) to pay, in \" + CURRENCY_UNIT + \" per kB\\n\"\n+            \"                         Specify a fee rate instead of relying on the built-in fee estimator.\\n\"\n+                                     \"Must be at least 0.0001 \" + CURRENCY_UNIT + \" per kB higher than the current transaction fee rate.\\n\"},\n+                            {\"replaceable\", RPCArg::Type::BOOL, /* default */ \"true\", \"Whether the new transaction should still be\\n\"\n+            \"                         marked bip-125 replaceable. If true, the sequence numbers in the transaction will\\n\"\n+            \"                         be left unchanged from the original. If false, any input sequence numbers in the\\n\"\n+            \"                         original transaction that were less than 0xfffffffe will be increased to 0xfffffffe\\n\"\n+            \"                         so the new transaction will not be explicitly bip-125 replaceable (though it may\\n\"\n+            \"                         still be replaceable in practice, for example if it has unconfirmed ancestors which\\n\"\n+            \"                         are replaceable).\"},\n+                            {\"estimate_mode\", RPCArg::Type::STR, /* default */ \"UNSET\", \"The fee estimate mode, must be one of:\\n\"\n+            \"         \\\"UNSET\\\"\\n\"\n+            \"         \\\"ECONOMICAL\\\"\\n\"\n+            \"         \\\"CONSERVATIVE\\\"\"},\n+                        },\n+                        \"options\"},\n+                },\n+                RPCResult{\n+                    RPCResult::Type::OBJ, \"\", \"\", {\n+                        {RPCResult::Type::STR, \"psbt\", \"The base64-encoded unsigned PSBT of the new transaction.\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"origfee\", \"The fee of the replaced transaction.\"},\n+                        {RPCResult::Type::STR_AMOUNT, \"fee\", \"The fee of the new transaction.\"},\n+                        {RPCResult::Type::ARR, \"errors\", \"Errors encountered during processing (may be empty).\",\n+                        {\n+                            {RPCResult::Type::STR, \"\", \"\"},\n+                        }},\n+                    }\n+                },\n+                RPCExamples{\n+            \"\\nBump the fee, get the new transaction\\'s psbt\\n\" +\n+                    HelpExampleCli(\"bumpfee\", \"<txid>\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18654#discussion_r413910879",
      "id" : 413910879,
      "line" : 3573,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzkxMDg3OQ==",
      "original_commit_id" : "1f22b55fad9b30aae32a4609950b7ae8e105cf67",
      "original_line" : 3569,
      "original_position" : 60,
      "original_start_line" : null,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 232,
      "pull_request_review_id" : 399233618,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18654",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-04-23T15:55:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413910879",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   }
]
