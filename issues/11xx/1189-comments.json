[
   {
      "body" : "Can you please move the checking logic to WalletModel instead of inside SetAddressBookName? That'd make it an UI-only change and much easier to test.\r\n\r\n",
      "created_at" : "2012-05-04T06:33:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1189#issuecomment-5505050",
      "id" : 5505050,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1189",
      "updated_at" : "2012-05-04T06:36:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5505050",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "The question is, if walletmodel.cpp is the only place, where that check makes senes or if it's beneficial to all places in the source? I'm fine if it's only needed in walletmodel.cpp, so can you verify this?",
      "created_at" : "2012-05-04T06:49:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1189#issuecomment-5505197",
      "id" : 5505197,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1189",
      "updated_at" : "2012-05-04T06:49:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5505197",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/1189#discussion_r772698"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1189"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/772698"
         }
      },
      "body" : "// Check if we have a new address or updated label",
      "commit_id" : "dab7acdf4570e7b716cff02fb3d0550f142f747c",
      "created_at" : "2012-05-04T07:09:31Z",
      "diff_hunk" : "@@ -1289,11 +1289,19 @@ int CWallet::LoadWallet(bool& fFirstRunRet)\n \n bool CWallet::SetAddressBookName(const CBitcoinAddress& address, const string& strName)\n {\n-    mapAddressBook[address] = strName;\n-    AddressBookRepaint();\n-    if (!fFileBacked)\n-        return false;\n-    return CWalletDB(strWalletFile).WriteName(address.ToString(), strName);\n+    std::map<CBitcoinAddress, std::string>::iterator mi = mapAddressBook.find(address);\n+    // Check if we have a new address or label",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1189#discussion_r772698",
      "id" : 772698,
      "original_commit_id" : "1dcb0a3f89605a087fb464a7bd068a7ef27a89c5",
      "original_position" : 10,
      "path" : "src/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/1189",
      "updated_at" : "2012-05-04T09:10:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/772698",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Well, it'd be nice to only change only the UI for an UI-only fix.\r\n\r\nThen again, I guess the extra check doesn't hurt (except that it complicates the code a bit).",
      "created_at" : "2012-05-04T07:26:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1189#issuecomment-5505575",
      "id" : 5505575,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1189",
      "updated_at" : "2012-05-04T07:26:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5505575",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj Updated to be a GUI-fix only, is the LOCK in parentheses correct? I get now compiler warning, just want to be sure :)",
      "created_at" : "2012-05-04T08:44:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1189#issuecomment-5506494",
      "id" : 5506494,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1189",
      "updated_at" : "2012-05-04T08:44:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5506494",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "The LOCK is not correct. You need to have the lock before any access to the address book, so also while doing the check.\r\n\r\n",
      "created_at" : "2012-05-04T08:46:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1189#issuecomment-5506518",
      "id" : 5506518,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1189",
      "updated_at" : "2012-05-04T08:46:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5506518",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Alright, the LOCK is now before any access to wallet, locking good now?",
      "created_at" : "2012-05-04T09:10:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1189#issuecomment-5506791",
      "id" : 5506791,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1189",
      "updated_at" : "2012-05-04T09:10:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5506791",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Yes, it's ok now\r\n",
      "created_at" : "2012-05-04T09:55:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/1189#issuecomment-5507403",
      "id" : 5507403,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/1189",
      "updated_at" : "2012-05-04T09:55:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/5507403",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
