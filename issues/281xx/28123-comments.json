[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [MarcoFalke](https://github.com/bitcoin/bitcoin/pull/28123#pullrequestreview-1542053175) |\n| Concept ACK | [russeree](https://github.com/bitcoin/bitcoin/pull/28123#issuecomment-1646814647) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27433](https://github.com/bitcoin/bitcoin/pull/27433) (getblocktemplate improvements for segwit and sigops by Sjors)\n* [#27351](https://github.com/bitcoin/bitcoin/pull/27351) (wallet: add `seeds` argument to `importdescriptors` by apoelstra)\n* [#27101](https://github.com/bitcoin/bitcoin/pull/27101) (Support JSON-RPC 2.0 when requested by client by pinheadmz)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-07-22T01:07:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28123#issuecomment-1646366074",
      "id" : 1646366074,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28123",
      "node_id" : "IC_kwDOABII585iIY16",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1646366074/reactions"
      },
      "updated_at" : "2023-07-23T11:25:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1646366074",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28123#discussion_r1271252144"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28123"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1271252144"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Could use `STR_INTERNAL_BUG`?\r\n\r\n```suggestion\r\n                STR_INTERNAL_BUG(strprintf(\"Internal bug detected: non-string RPC arg \\\"%s\\\" quotes oneline_description:\\n%s\\n\",\r\n                          m_names, m_opts.oneline_description,\r\n                           \r\n                          )};\r\n```",
      "commit_id" : "5e3e83b005518659a69916c373b808da27e51791",
      "created_at" : "2023-07-22T05:44:32Z",
      "diff_hunk" : "@@ -1117,7 +1117,16 @@ std::string RPCArg::ToStringObj(const bool oneline) const\n \n std::string RPCArg::ToString(const bool oneline) const\n {\n-    if (oneline && !m_opts.oneline_description.empty()) return m_opts.oneline_description;\n+    if (oneline && !m_opts.oneline_description.empty()) {\n+        if (m_opts.oneline_description[0] == '\\\"' && m_type != Type::STR_HEX && m_type != Type::STR && gArgs.GetBoolArg(\"-rpcdoccheck\", DEFAULT_RPC_DOC_CHECK)) {\n+            throw std::runtime_error{\n+                strprintf(\"Internal bug detected: non-string RPC arg \\\"%s\\\" quotes oneline_description:\\n%s\\n%s %s\\nPlease report this issue here: %s\\n\",\n+                          m_names, m_opts.oneline_description,\n+                          PACKAGE_NAME, FormatFullVersion(),\n+                          PACKAGE_BUGREPORT)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28123#discussion_r1271252144",
      "id" : 1271252144,
      "line" : 1126,
      "node_id" : "PRRC_kwDOABII585LxcSw",
      "original_commit_id" : "5e3e83b005518659a69916c373b808da27e51791",
      "original_line" : 1126,
      "original_position" : 11,
      "original_start_line" : 1123,
      "path" : "src/rpc/util.cpp",
      "position" : 11,
      "pull_request_review_id" : 1542053175,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28123",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1271252144/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1123,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-22T05:47:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1271252144",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28123#discussion_r1271252337"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28123"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1271252337"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you can remove the IsNull check below? Also, does this need release notes?",
      "commit_id" : "5e3e83b005518659a69916c373b808da27e51791",
      "created_at" : "2023-07-22T05:46:31Z",
      "diff_hunk" : "@@ -554,7 +554,7 @@ static RPCHelpMan getblocktemplate()\n         \"    https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki#getblocktemplate_changes\\n\"\n         \"    https://github.com/bitcoin/bips/blob/master/bip-0145.mediawiki\\n\",\n         {\n-            {\"template_request\", RPCArg::Type::OBJ, RPCArg::Default{UniValue::VOBJ}, \"Format of the template\",\n+            {\"template_request\", RPCArg::Type::OBJ, RPCArg::Optional::NO, \"Format of the template\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28123#discussion_r1271252337",
      "id" : 1271252337,
      "line" : 557,
      "node_id" : "PRRC_kwDOABII585LxcVx",
      "original_commit_id" : "5e3e83b005518659a69916c373b808da27e51791",
      "original_line" : 557,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/rpc/mining.cpp",
      "position" : 5,
      "pull_request_review_id" : 1542053175,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28123",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1271252337/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-07-22T05:47:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1271252337",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "tACK\r\n\r\n1. I applied this PRs logic with masters ```.oneline_description``` and was able to trigger the desired error message.\r\n2. When checking out this PR without any modifications the expected cli help is displayed.\r\n\r\n![image](https://github.com/bitcoin/bitcoin/assets/3104223/c723b926-b666-4ca9-9ba4-aa0b3b1714b2)\r\n\r\n",
      "created_at" : "2023-07-23T11:25:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28123#issuecomment-1646814647",
      "id" : 1646814647,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/28123",
      "node_id" : "IC_kwDOABII585iKGW3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1646814647/reactions"
      },
      "updated_at" : "2023-07-23T11:43:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1646814647",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3104223?v=4",
         "events_url" : "https://api.github.com/users/russeree/events{/privacy}",
         "followers_url" : "https://api.github.com/users/russeree/followers",
         "following_url" : "https://api.github.com/users/russeree/following{/other_user}",
         "gists_url" : "https://api.github.com/users/russeree/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/russeree",
         "id" : 3104223,
         "login" : "russeree",
         "node_id" : "MDQ6VXNlcjMxMDQyMjM=",
         "organizations_url" : "https://api.github.com/users/russeree/orgs",
         "received_events_url" : "https://api.github.com/users/russeree/received_events",
         "repos_url" : "https://api.github.com/users/russeree/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/russeree/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/russeree/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/russeree"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/28123#discussion_r1271432874"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28123"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1271432874"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The above suggestion doesn't compile without syntax changes due to ```error: unterminated argument list invoking macro \"STR_INTERNAL_BUG\"``` This is because of a missing ```)``` to close off the arguments for STR_INTERNAL_BUG and then there is a loose comma after ```m_opts.oneline_description```. Once these are removed code does compile but the output is not as clean as the current commit due to an extra ```\"``` on a new line after the name of the ```oneline_description``` compared to the current version which doesn't have this artifact. \r\n\r\n![image](https://github.com/bitcoin/bitcoin/assets/3104223/f80e1c47-6a4e-4353-91e7-f79db3ea79bf)\r\n",
      "commit_id" : "5e3e83b005518659a69916c373b808da27e51791",
      "created_at" : "2023-07-23T11:47:01Z",
      "diff_hunk" : "@@ -1117,7 +1117,16 @@ std::string RPCArg::ToStringObj(const bool oneline) const\n \n std::string RPCArg::ToString(const bool oneline) const\n {\n-    if (oneline && !m_opts.oneline_description.empty()) return m_opts.oneline_description;\n+    if (oneline && !m_opts.oneline_description.empty()) {\n+        if (m_opts.oneline_description[0] == '\\\"' && m_type != Type::STR_HEX && m_type != Type::STR && gArgs.GetBoolArg(\"-rpcdoccheck\", DEFAULT_RPC_DOC_CHECK)) {\n+            throw std::runtime_error{\n+                strprintf(\"Internal bug detected: non-string RPC arg \\\"%s\\\" quotes oneline_description:\\n%s\\n%s %s\\nPlease report this issue here: %s\\n\",\n+                          m_names, m_opts.oneline_description,\n+                          PACKAGE_NAME, FormatFullVersion(),\n+                          PACKAGE_BUGREPORT)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/28123#discussion_r1271432874",
      "id" : 1271432874,
      "in_reply_to_id" : 1271252144,
      "line" : 1126,
      "node_id" : "PRRC_kwDOABII585LyIaq",
      "original_commit_id" : "5e3e83b005518659a69916c373b808da27e51791",
      "original_line" : 1126,
      "original_position" : 11,
      "original_start_line" : 1123,
      "path" : "src/rpc/util.cpp",
      "position" : 11,
      "pull_request_review_id" : 1542236081,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/28123",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1271432874/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1123,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-07-23T11:49:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1271432874",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3104223?v=4",
         "events_url" : "https://api.github.com/users/russeree/events{/privacy}",
         "followers_url" : "https://api.github.com/users/russeree/followers",
         "following_url" : "https://api.github.com/users/russeree/following{/other_user}",
         "gists_url" : "https://api.github.com/users/russeree/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/russeree",
         "id" : 3104223,
         "login" : "russeree",
         "node_id" : "MDQ6VXNlcjMxMDQyMjM=",
         "organizations_url" : "https://api.github.com/users/russeree/orgs",
         "received_events_url" : "https://api.github.com/users/russeree/received_events",
         "repos_url" : "https://api.github.com/users/russeree/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/russeree/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/russeree/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/russeree"
      }
   }
]
