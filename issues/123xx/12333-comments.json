[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Note to reviewers, 2nd commit is just indentation, see 1st commit. I'll squash before merge.",
      "created_at" : "2018-02-02T11:46:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-362565336",
      "id" : 362565336,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12333",
      "updated_at" : "2018-02-02T11:46:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/362565336",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Just noting that you can fixup right now. It is possible to ignore-all-space in git diff",
      "created_at" : "2018-02-02T16:19:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-362631647",
      "id" : 362631647,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12333",
      "updated_at" : "2018-02-02T16:19:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/362631647",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I know but IIRC it's not possible to add comments with that option, so I've decided to split for now.",
      "created_at" : "2018-02-02T18:30:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-362666666",
      "id" : 362666666,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12333",
      "updated_at" : "2018-02-02T18:30:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/362666666",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165738263"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12333"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/165738263"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Both are recursive locks, so any reason we can't just use `LOCK2` here?",
      "commit_id" : "834529f3c097386b82feb01bd2cc3e0f90418813",
      "created_at" : "2018-02-02T19:32:07Z",
      "diff_hunk" : "@@ -2198,111 +2198,109 @@ CAmount CWallet::GetAvailableBalance(const CCoinControl* coinControl) const\n \n void CWallet::AvailableCoins(std::vector<COutput> &vCoins, bool fOnlySafe, const CCoinControl *coinControl, const CAmount &nMinimumAmount, const CAmount &nMaximumAmount, const CAmount &nMinimumSumAmount, const uint64_t nMaximumCount, const int nMinDepth, const int nMaxDepth) const\n {\n+    AssertLockHeld(cs_main);\n+    AssertLockHeld(cs_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165738263",
      "id" : 165738263,
      "original_commit_id" : "834529f3c097386b82feb01bd2cc3e0f90418813",
      "original_position" : 5,
      "path" : "src/wallet/wallet.cpp",
      "position" : 5,
      "pull_request_review_id" : 93731179,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12333",
      "updated_at" : "2018-02-02T19:33:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/165738263",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165739359"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12333"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/165739359"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Long term plan is to remove recursive locks. Correct me if I'm wrong @TheBlueMatt.",
      "commit_id" : "834529f3c097386b82feb01bd2cc3e0f90418813",
      "created_at" : "2018-02-02T19:36:51Z",
      "diff_hunk" : "@@ -2198,111 +2198,109 @@ CAmount CWallet::GetAvailableBalance(const CCoinControl* coinControl) const\n \n void CWallet::AvailableCoins(std::vector<COutput> &vCoins, bool fOnlySafe, const CCoinControl *coinControl, const CAmount &nMinimumAmount, const CAmount &nMaximumAmount, const CAmount &nMinimumSumAmount, const uint64_t nMaximumCount, const int nMinDepth, const int nMaxDepth) const\n {\n+    AssertLockHeld(cs_main);\n+    AssertLockHeld(cs_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165739359",
      "id" : 165739359,
      "in_reply_to_id" : 165738263,
      "original_commit_id" : "834529f3c097386b82feb01bd2cc3e0f90418813",
      "original_position" : 5,
      "path" : "src/wallet/wallet.cpp",
      "position" : 5,
      "pull_request_review_id" : 93732619,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12333",
      "updated_at" : "2018-02-02T19:36:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/165739359",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165740121"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12333"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/165740121"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think in general we want to move away from recursive locking: https://github.com/bitcoin/bitcoin/blob/85123be78df5a4e9447e70f9ee727416d45843d7/src/sync.h#L92\r\n\r\nhttp://www.zaval.org/resources/library/butenhof1.html has some interesting rationale and history",
      "commit_id" : "834529f3c097386b82feb01bd2cc3e0f90418813",
      "created_at" : "2018-02-02T19:40:10Z",
      "diff_hunk" : "@@ -2198,111 +2198,109 @@ CAmount CWallet::GetAvailableBalance(const CCoinControl* coinControl) const\n \n void CWallet::AvailableCoins(std::vector<COutput> &vCoins, bool fOnlySafe, const CCoinControl *coinControl, const CAmount &nMinimumAmount, const CAmount &nMaximumAmount, const CAmount &nMinimumSumAmount, const uint64_t nMaximumCount, const int nMinDepth, const int nMaxDepth) const\n {\n+    AssertLockHeld(cs_main);\n+    AssertLockHeld(cs_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165740121",
      "id" : 165740121,
      "in_reply_to_id" : 165738263,
      "original_commit_id" : "834529f3c097386b82feb01bd2cc3e0f90418813",
      "original_position" : 5,
      "path" : "src/wallet/wallet.cpp",
      "position" : 5,
      "pull_request_review_id" : 93733610,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12333",
      "updated_at" : "2018-02-02T19:40:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/165740121",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165740738"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12333"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/165740738"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks @ryanofsky for the reference.",
      "commit_id" : "834529f3c097386b82feb01bd2cc3e0f90418813",
      "created_at" : "2018-02-02T19:42:47Z",
      "diff_hunk" : "@@ -2198,111 +2198,109 @@ CAmount CWallet::GetAvailableBalance(const CCoinControl* coinControl) const\n \n void CWallet::AvailableCoins(std::vector<COutput> &vCoins, bool fOnlySafe, const CCoinControl *coinControl, const CAmount &nMinimumAmount, const CAmount &nMaximumAmount, const CAmount &nMinimumSumAmount, const uint64_t nMaximumCount, const int nMinDepth, const int nMaxDepth) const\n {\n+    AssertLockHeld(cs_main);\n+    AssertLockHeld(cs_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165740738",
      "id" : 165740738,
      "in_reply_to_id" : 165738263,
      "original_commit_id" : "834529f3c097386b82feb01bd2cc3e0f90418813",
      "original_position" : 5,
      "path" : "src/wallet/wallet.cpp",
      "position" : 5,
      "pull_request_review_id" : 93734393,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12333",
      "updated_at" : "2018-02-02T19:42:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/165740738",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165753492"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12333"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/165753492"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah, thanks for the clarification.",
      "commit_id" : "834529f3c097386b82feb01bd2cc3e0f90418813",
      "created_at" : "2018-02-02T20:37:11Z",
      "diff_hunk" : "@@ -2198,111 +2198,109 @@ CAmount CWallet::GetAvailableBalance(const CCoinControl* coinControl) const\n \n void CWallet::AvailableCoins(std::vector<COutput> &vCoins, bool fOnlySafe, const CCoinControl *coinControl, const CAmount &nMinimumAmount, const CAmount &nMaximumAmount, const CAmount &nMinimumSumAmount, const uint64_t nMaximumCount, const int nMinDepth, const int nMaxDepth) const\n {\n+    AssertLockHeld(cs_main);\n+    AssertLockHeld(cs_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165753492",
      "id" : 165753492,
      "in_reply_to_id" : 165738263,
      "original_commit_id" : "834529f3c097386b82feb01bd2cc3e0f90418813",
      "original_position" : 5,
      "path" : "src/wallet/wallet.cpp",
      "position" : 5,
      "pull_request_review_id" : 93749115,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12333",
      "updated_at" : "2018-02-02T20:37:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/165753492",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/73197?v=4",
         "events_url" : "https://api.github.com/users/jamesob/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jamesob/followers",
         "following_url" : "https://api.github.com/users/jamesob/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jamesob/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jamesob",
         "id" : 73197,
         "login" : "jamesob",
         "organizations_url" : "https://api.github.com/users/jamesob/orgs",
         "received_events_url" : "https://api.github.com/users/jamesob/received_events",
         "repos_url" : "https://api.github.com/users/jamesob/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jamesob/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jamesob"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK https://github.com/bitcoin/bitcoin/pull/12333/commits/834529f3c097386b82feb01bd2cc3e0f90418813",
      "created_at" : "2018-02-03T17:09:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-362835185",
      "id" : 362835185,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12333",
      "updated_at" : "2018-02-03T17:09:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/362835185",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/107096?v=4",
         "events_url" : "https://api.github.com/users/devrandom/events{/privacy}",
         "followers_url" : "https://api.github.com/users/devrandom/followers",
         "following_url" : "https://api.github.com/users/devrandom/following{/other_user}",
         "gists_url" : "https://api.github.com/users/devrandom/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/devrandom",
         "id" : 107096,
         "login" : "devrandom",
         "organizations_url" : "https://api.github.com/users/devrandom/orgs",
         "received_events_url" : "https://api.github.com/users/devrandom/received_events",
         "repos_url" : "https://api.github.com/users/devrandom/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/devrandom/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/devrandom/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/devrandom"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "utACK 834529f3c097386b82feb01bd2cc3e0f90418813 (very easy to review with `-w` / `?w=1`).",
      "created_at" : "2018-02-05T21:08:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-363221763",
      "id" : 363221763,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12333",
      "updated_at" : "2018-02-05T21:08:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/363221763",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
