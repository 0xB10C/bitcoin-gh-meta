[
   {
      "body" : "Nice minimalistic PR. One question though. Why to use m/0'/0'/i instead of something more standard? BIP32 proposes m/0'/0/i for external chains (I suppose Core in current implementation does not need internal/change chain). Or even better - use m/0/i, which is forward compatible with BIP44 (maybe Core will make it somedays). m/0/i is subset of BIP44 - an account.",
      "created_at" : "2016-05-10T10:06:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-218114283",
      "id" : 218114283,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-10T10:06:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218114283",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/565341?v=3",
         "events_url" : "https://api.github.com/users/slush0/events{/privacy}",
         "followers_url" : "https://api.github.com/users/slush0/followers",
         "following_url" : "https://api.github.com/users/slush0/following{/other_user}",
         "gists_url" : "https://api.github.com/users/slush0/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/slush0",
         "id" : 565341,
         "login" : "slush0",
         "organizations_url" : "https://api.github.com/users/slush0/orgs",
         "received_events_url" : "https://api.github.com/users/slush0/received_events",
         "repos_url" : "https://api.github.com/users/slush0/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/slush0/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/slush0/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/slush0"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62645694"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62645694"
         }
      },
      "body" : "No need for `strprintf`. See previous line.",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T10:15:42Z",
      "diff_hunk" : "@@ -3036,6 +3104,7 @@ std::string CWallet::GetWalletHelpString(bool showDebug)\n         strUsage += HelpMessageOpt(\"-sendfreetransactions\", strprintf(_(\"Send transactions as zero-fee transactions if possible (default: %u)\"), DEFAULT_SEND_FREE_TRANSACTIONS));\n     strUsage += HelpMessageOpt(\"-spendzeroconfchange\", strprintf(_(\"Spend unconfirmed change when sending transactions (default: %u)\"), DEFAULT_SPEND_ZEROCONF_CHANGE));\n     strUsage += HelpMessageOpt(\"-txconfirmtarget=<n>\", strprintf(_(\"If paytxfee is not set, include enough fee so transactions begin confirmation on average within n blocks (default: %u)\"), DEFAULT_TX_CONFIRM_TARGET));\n+    strUsage += HelpMessageOpt(\"-usehd\", _(\"Use hierarchical deterministic key generation (HD) after bip32. Has only affect during wallet creation/first start\") + \" \" + strprintf(_(\"(default: %u)\"), DEFAULT_USE_HD_WALLET));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62645694",
      "id" : 62645694,
      "original_commit_id" : "ce6332ec0a0a95e86fcc461b826c79e8b5e34f96",
      "original_position" : 99,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62645694",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62645945"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62645945"
         }
      },
      "body" : "s/AddChain/SetHDChain/",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T10:17:31Z",
      "diff_hunk" : "@@ -599,6 +599,16 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n                 return false;\n             }\n         }\n+        else if (strType == \"hdchain\")\n+        {\n+            CHDChain chain;\n+            ssValue >> chain;\n+            if (!pwallet->SetHDChain(chain, true))\n+            {\n+                strErr = \"Error reading wallet database: AddChain failed\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62645945",
      "id" : 62645945,
      "original_commit_id" : "ce6332ec0a0a95e86fcc461b826c79e8b5e34f96",
      "original_position" : 10,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62645945",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62646344"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62646344"
         }
      },
      "body" : "Repeating `\"hdchain\"` several times reminds me there was some patch redefining these as constants...",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T10:20:47Z",
      "diff_hunk" : "@@ -599,6 +599,16 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n                 return false;\n             }\n         }\n+        else if (strType == \"hdchain\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62646344",
      "id" : 62646344,
      "original_commit_id" : "ce6332ec0a0a95e86fcc461b826c79e8b5e34f96",
      "original_position" : 4,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62646344",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "Concept ACK\r\n\r\nNice, small, elegant Ã°ÂÂÂ ",
      "created_at" : "2016-05-10T10:25:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-218118237",
      "id" : 218118237,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-10T10:25:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218118237",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62647015"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62647015"
         }
      },
      "body" : "This line is there two times in the file. You can make the diff even shorter!",
      "commit_id" : "c3b8aa5869f7cadbb030f66c5f48770142a6c2ea",
      "created_at" : "2016-05-10T10:26:27Z",
      "diff_hunk" : "@@ -91,7 +91,45 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62647015",
      "id" : 62647015,
      "original_commit_id" : "ce6332ec0a0a95e86fcc461b826c79e8b5e34f96",
      "original_position" : 6,
      "path" : "src/wallet/wallet.cpp",
      "position" : 6,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-10T13:55:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62647015",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62651748"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62651748"
         }
      },
      "body" : "Which one? We did the redefine-magic-strings-as-constants it in other places, but also for the wallet?",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T11:02:45Z",
      "diff_hunk" : "@@ -599,6 +599,16 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n                 return false;\n             }\n         }\n+        else if (strType == \"hdchain\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62651748",
      "id" : 62651748,
      "original_commit_id" : "ce6332ec0a0a95e86fcc461b826c79e8b5e34f96",
      "original_position" : 4,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62651748",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62653035"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62653035"
         }
      },
      "body" : "Yes, because some of them are repeated several times in the file. But maybe I'm remembering some other patch.",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T11:12:46Z",
      "diff_hunk" : "@@ -599,6 +599,16 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n                 return false;\n             }\n         }\n+        else if (strType == \"hdchain\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62653035",
      "id" : 62653035,
      "original_commit_id" : "ce6332ec0a0a95e86fcc461b826c79e8b5e34f96",
      "original_position" : 4,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62653035",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62653333"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62653333"
         }
      },
      "body" : "Ah, it probably was #5707.",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T11:15:34Z",
      "diff_hunk" : "@@ -599,6 +599,16 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n                 return false;\n             }\n         }\n+        else if (strType == \"hdchain\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62653333",
      "id" : 62653333,
      "original_commit_id" : "ce6332ec0a0a95e86fcc461b826c79e8b5e34f96",
      "original_position" : 4,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62653333",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62667509"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62667509"
         }
      },
      "body" : "Yes. I did refactor out these stings into constants serval times. But this should be done in another PR and hopefully after this has been merged.",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T13:09:20Z",
      "diff_hunk" : "@@ -599,6 +599,16 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n                 return false;\n             }\n         }\n+        else if (strType == \"hdchain\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62667509",
      "id" : 62667509,
      "original_commit_id" : "ce6332ec0a0a95e86fcc461b826c79e8b5e34f96",
      "original_position" : 4,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62667509",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62667901"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62667901"
         }
      },
      "body" : "Hmm... I have looked at `walletbroadcast`, there `strprintf` is also used. Isn't more flexible for the translation then?",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T13:11:57Z",
      "diff_hunk" : "@@ -3036,6 +3104,7 @@ std::string CWallet::GetWalletHelpString(bool showDebug)\n         strUsage += HelpMessageOpt(\"-sendfreetransactions\", strprintf(_(\"Send transactions as zero-fee transactions if possible (default: %u)\"), DEFAULT_SEND_FREE_TRANSACTIONS));\n     strUsage += HelpMessageOpt(\"-spendzeroconfchange\", strprintf(_(\"Spend unconfirmed change when sending transactions (default: %u)\"), DEFAULT_SPEND_ZEROCONF_CHANGE));\n     strUsage += HelpMessageOpt(\"-txconfirmtarget=<n>\", strprintf(_(\"If paytxfee is not set, include enough fee so transactions begin confirmation on average within n blocks (default: %u)\"), DEFAULT_TX_CONFIRM_TARGET));\n+    strUsage += HelpMessageOpt(\"-usehd\", _(\"Use hierarchical deterministic key generation (HD) after bip32. Has only affect during wallet creation/first start\") + \" \" + strprintf(_(\"(default: %u)\"), DEFAULT_USE_HD_WALLET));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62667901",
      "id" : 62667901,
      "original_commit_id" : "ce6332ec0a0a95e86fcc461b826c79e8b5e34f96",
      "original_position" : 99,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62667901",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "@slush0: One reason for the current keypath is the use hardened-only key derivation.\r\nI personally think people overestimate the switch-wallet feature. Importing a bip32 master key together with a given keypath can be tricky (lookup window).\r\n\r\nBut I agree.\r\nIf and once this PR gets merged into master, next thing I would do is writing a PR that would make the keypath flexible.\r\n\r\nWe could discuss the default keypath and the keypath flexibility in a such follow up PR.\r\n\r\nThis PR only intent to solve the \"backup problem\" by using deterministic key derivation. So we could even think of using m/k'.",
      "created_at" : "2016-05-10T13:18:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-218154051",
      "id" : 218154051,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-10T13:18:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218154051",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62671064"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62671064"
         }
      },
      "body" : "I think you want to `strprintf(_(string))` the whole string and not two separate stings, as other languages might have different grammar. but consider it a nit.",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T13:31:29Z",
      "diff_hunk" : "@@ -3036,6 +3104,7 @@ std::string CWallet::GetWalletHelpString(bool showDebug)\n         strUsage += HelpMessageOpt(\"-sendfreetransactions\", strprintf(_(\"Send transactions as zero-fee transactions if possible (default: %u)\"), DEFAULT_SEND_FREE_TRANSACTIONS));\n     strUsage += HelpMessageOpt(\"-spendzeroconfchange\", strprintf(_(\"Spend unconfirmed change when sending transactions (default: %u)\"), DEFAULT_SPEND_ZEROCONF_CHANGE));\n     strUsage += HelpMessageOpt(\"-txconfirmtarget=<n>\", strprintf(_(\"If paytxfee is not set, include enough fee so transactions begin confirmation on average within n blocks (default: %u)\"), DEFAULT_TX_CONFIRM_TARGET));\n+    strUsage += HelpMessageOpt(\"-usehd\", _(\"Use hierarchical deterministic key generation (HD) after bip32. Has only affect during wallet creation/first start\") + \" \" + strprintf(_(\"(default: %u)\"), DEFAULT_USE_HD_WALLET));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62671064",
      "id" : 62671064,
      "original_commit_id" : "ce6332ec0a0a95e86fcc461b826c79e8b5e34f96",
      "original_position" : 99,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62671064",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "Fixed @paveljanik nits.",
      "created_at" : "2016-05-10T13:56:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-218164667",
      "id" : 218164667,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-10T13:56:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218164667",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "> I personally think people overestimate the switch-wallet feature.\r\n\r\n@jonasschnelli It's actually quite useful feature, and it may be even for Core. I can imagine somebody who'll have Qt wallet awfully out of sync and will need to get his funds ASAP. Then loading the backup to some other software like Multibit HD will do the job. BIP44 is actually being used by most of current wallets so heading towards the same structure makes sense.\r\n\r\n> This PR only intent to solve the \"backup problem\" \r\n\r\nFair point and I appreciate somebody is finally addressing it.",
      "created_at" : "2016-05-10T14:19:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-218171888",
      "id" : 218171888,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-10T14:19:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218171888",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/565341?v=3",
         "events_url" : "https://api.github.com/users/slush0/events{/privacy}",
         "followers_url" : "https://api.github.com/users/slush0/followers",
         "following_url" : "https://api.github.com/users/slush0/following{/other_user}",
         "gists_url" : "https://api.github.com/users/slush0/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/slush0",
         "id" : 565341,
         "login" : "slush0",
         "organizations_url" : "https://api.github.com/users/slush0/orgs",
         "received_events_url" : "https://api.github.com/users/slush0/received_events",
         "repos_url" : "https://api.github.com/users/slush0/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/slush0/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/slush0/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/slush0"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62714441"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62714441"
         }
      },
      "body" : "the the",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T17:23:14Z",
      "diff_hunk" : "@@ -1051,6 +1087,37 @@ CAmount CWallet::GetChange(const CTransaction& tx) const\n     return nChange;\n }\n \n+bool CWallet::SetHDMasterKey(const CKey& key)\n+{\n+    LOCK(cs_wallet);\n+\n+    // store the key as normal \"key\"/\"ckey\" object\n+    // in the the database",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62714441",
      "id" : 62714441,
      "original_commit_id" : "c3b8aa5869f7cadbb030f66c5f48770142a6c2ea",
      "original_position" : 67,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62714441",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62714610"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62714610"
         }
      },
      "body" : "derived",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T17:24:10Z",
      "diff_hunk" : "@@ -57,6 +57,9 @@ static const unsigned int DEFAULT_TX_CONFIRM_TARGET = 2;\n static const unsigned int MAX_FREE_TRANSACTION_CREATE_SIZE = 1000;\n static const bool DEFAULT_WALLETBROADCAST = true;\n \n+//! if set, all keys will be deriven by using BIP32",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62714610",
      "id" : 62714610,
      "original_commit_id" : "c3b8aa5869f7cadbb030f66c5f48770142a6c2ea",
      "original_position" : 4,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62714610",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62714724"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62714724"
         }
      },
      "body" : "Definitely not for this PR, of course.",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T17:24:44Z",
      "diff_hunk" : "@@ -599,6 +599,16 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n                 return false;\n             }\n         }\n+        else if (strType == \"hdchain\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62714724",
      "id" : 62714724,
      "original_commit_id" : "ce6332ec0a0a95e86fcc461b826c79e8b5e34f96",
      "original_position" : 4,
      "path" : "src/wallet/walletdb.cpp",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62714724",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62714844"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62714844"
         }
      },
      "body" : "two spaces",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T17:25:28Z",
      "diff_hunk" : "@@ -40,6 +40,34 @@ enum DBErrors\n     DB_NEED_REWRITE\n };\n \n+/* simple hd chain data model */\n+class CHDChain\n+{\n+public:\n+    uint32_t nExternalChainCounter;\n+    CKeyID  masterKeyID; /* master key hash160 */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62714844",
      "id" : 62714844,
      "original_commit_id" : "c3b8aa5869f7cadbb030f66c5f48770142a6c2ea",
      "original_position" : 9,
      "path" : "src/wallet/walletdb.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62714844",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62715716"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62715716"
         }
      },
      "body" : "Maybe just clang-format the diff?\n",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T17:30:25Z",
      "diff_hunk" : "@@ -40,6 +40,34 @@ enum DBErrors\n     DB_NEED_REWRITE\n };\n \n+/* simple hd chain data model */\n+class CHDChain\n+{\n+public:\n+    uint32_t nExternalChainCounter;\n+    CKeyID  masterKeyID; /* master key hash160 */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62715716",
      "id" : 62715716,
      "original_commit_id" : "c3b8aa5869f7cadbb030f66c5f48770142a6c2ea",
      "original_position" : 9,
      "path" : "src/wallet/walletdb.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62715716",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "Force push fixed @paveljanik nits. Formatted some of the code with clang-format.",
      "created_at" : "2016-05-10T18:12:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-218243036",
      "id" : 218243036,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-10T18:12:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218243036",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62723177"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62723177"
         }
      },
      "body" : "I think you should check whether the derived key already exists in the keystore, and if so, try the next chaincounter. Otheriwse you'll give out the same keys twice after a backup restore.\r\n\r\nEDIT: nevermind, that's not going to work. we'll also need to make keypool entries be regenerated when one is encountered in the blockchain or mempool. I think we can defer that...",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-10T18:13:12Z",
      "diff_hunk" : "@@ -91,7 +91,45 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata\n+    int64_t nCreationTime = GetTime();\n+    CKeyMetadata metadata(nCreationTime);\n+\n+    // use HD key derivation if HD was enabled during wallet creation\n+    if (!hdChain.masterKeyID.IsNull())\n+    {\n+        // for now we use a fixed keypath scheme of m/0'/0'/k\n+        CKey key; //master key seed (256bit)\n+        CExtKey masterKey; //hd master key\n+        CExtKey accountKey; //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey; //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdChain.masterKeyID, key))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Master key not found\");\n+\n+        assert(key.size() == 32);\n+        masterKey.SetMaster(key.begin(), key.size());\n+\n+        // derive m/0'\n+        masterKey.Derive(accountKey, 0 | 0x80000000);\n+\n+        // derive m/0'/0'\n+        accountKey.Derive(externalChainChildKey, 0 | 0x80000000);\n+\n+        // derive child key at next index\n+        externalChainChildKey.Derive(childKey, hdChain.nExternalChainCounter | 0x80000000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62723177",
      "id" : 62723177,
      "original_commit_id" : "c3b8aa5869f7cadbb030f66c5f48770142a6c2ea",
      "original_position" : 34,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62723177",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Concept ACK\r\n\r\nSo as I understand this, it won't affect the keys already in the wallet, right? It just generates all new keys using the HD master key?\r\n\r\nAlso there should be an RPC command to dump the master private key.",
      "created_at" : "2016-05-11T12:17:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-218442297",
      "id" : 218442297,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-11T12:17:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218442297",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=3",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "body" : "@achow101:\r\nfor now (this PR), HD will only be enabled when you create a new wallet (first start).\r\n\r\n> Also there should be an RPC command to dump the master private key.\r\n\r\nI agree. Have a look at #6265 and #7273.\r\nThis is my third try to get HD into Cores wallet. I think the way to go is this extremely simple basic step.\r\nWe can add RPC/API changes later.",
      "created_at" : "2016-05-11T12:20:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-218442964",
      "id" : 218442964,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-11T12:20:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218442964",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62838900"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62838900"
         }
      },
      "body" : "I added a loop to derive the next key as long as its not known by the wallet. I think this is required otherwise we might run into an exception if someone restores a backup or has imported a derived key of a higher child index.",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-11T12:32:05Z",
      "diff_hunk" : "@@ -91,7 +91,45 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata\n+    int64_t nCreationTime = GetTime();\n+    CKeyMetadata metadata(nCreationTime);\n+\n+    // use HD key derivation if HD was enabled during wallet creation\n+    if (!hdChain.masterKeyID.IsNull())\n+    {\n+        // for now we use a fixed keypath scheme of m/0'/0'/k\n+        CKey key; //master key seed (256bit)\n+        CExtKey masterKey; //hd master key\n+        CExtKey accountKey; //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey; //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdChain.masterKeyID, key))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Master key not found\");\n+\n+        assert(key.size() == 32);\n+        masterKey.SetMaster(key.begin(), key.size());\n+\n+        // derive m/0'\n+        masterKey.Derive(accountKey, 0 | 0x80000000);\n+\n+        // derive m/0'/0'\n+        accountKey.Derive(externalChainChildKey, 0 | 0x80000000);\n+\n+        // derive child key at next index\n+        externalChainChildKey.Derive(childKey, hdChain.nExternalChainCounter | 0x80000000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r62838900",
      "id" : 62838900,
      "original_commit_id" : "c3b8aa5869f7cadbb030f66c5f48770142a6c2ea",
      "original_position" : 34,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62838900",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63034009"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63034009"
         }
      },
      "body" : "external only for now? (and in the other 2 places in the PR)",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-12T14:50:59Z",
      "diff_hunk" : "@@ -574,6 +577,9 @@ class CWallet : public CCryptoKeyStore, public CValidationInterface\n \n     void SyncMetaData(std::pair<TxSpends::iterator, TxSpends::iterator>);\n \n+    /* the hd chain data model (internal and external counters) */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63034009",
      "id" : 63034009,
      "original_commit_id" : "cc1df8fa6f4849b65187f60a3cb4c83da3d16788",
      "original_position" : 14,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63034009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63034380"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63034380"
         }
      },
      "body" : "s/Has only affect/Only has effect/",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-12T14:53:16Z",
      "diff_hunk" : "@@ -3036,6 +3104,7 @@ std::string CWallet::GetWalletHelpString(bool showDebug)\n         strUsage += HelpMessageOpt(\"-sendfreetransactions\", strprintf(_(\"Send transactions as zero-fee transactions if possible (default: %u)\"), DEFAULT_SEND_FREE_TRANSACTIONS));\n     strUsage += HelpMessageOpt(\"-spendzeroconfchange\", strprintf(_(\"Spend unconfirmed change when sending transactions (default: %u)\"), DEFAULT_SPEND_ZEROCONF_CHANGE));\n     strUsage += HelpMessageOpt(\"-txconfirmtarget=<n>\", strprintf(_(\"If paytxfee is not set, include enough fee so transactions begin confirmation on average within n blocks (default: %u)\"), DEFAULT_TX_CONFIRM_TARGET));\n+    strUsage += HelpMessageOpt(\"-usehd\", _(\"Use hierarchical deterministic key generation (HD) after bip32. Has only affect during wallet creation/first start\") + \" \" + strprintf(_(\"(default: %u)\"), DEFAULT_USE_HD_WALLET));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63034380",
      "id" : 63034380,
      "original_commit_id" : "ce6332ec0a0a95e86fcc461b826c79e8b5e34f96",
      "original_position" : 99,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63034380",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63035718"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63035718"
         }
      },
      "body" : "Nit: I think you want to use `//!<` when placing a trailing comment.\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#doxygen-comments",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-12T14:59:59Z",
      "diff_hunk" : "@@ -40,6 +40,35 @@ enum DBErrors\n     DB_NEED_REWRITE\n };\n \n+/* simple hd chain data model */\n+class CHDChain\n+{\n+public:\n+    uint32_t nExternalChainCounter;\n+    CKeyID masterKeyID; /* master key hash160 */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63035718",
      "id" : 63035718,
      "original_commit_id" : "cc1df8fa6f4849b65187f60a3cb4c83da3d16788",
      "original_position" : 9,
      "path" : "src/wallet/walletdb.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63035718",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63036439"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63036439"
         }
      },
      "body" : "~~nit: simply calling AddKey should work here~~ nevermind, wrong function",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-12T15:03:58Z",
      "diff_hunk" : "@@ -1051,6 +1089,37 @@ CAmount CWallet::GetChange(const CTransaction& tx) const\n     return nChange;\n }\n \n+bool CWallet::SetHDMasterKey(const CKey& key)\n+{\n+    LOCK(cs_wallet);\n+\n+    // store the key as normal \"key\"/\"ckey\" object\n+    // in the database\n+    // key metadata is not required\n+    CPubKey pubkey = key.GetPubKey();\n+    if (!AddKeyPubKey(key, pubkey))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63036439",
      "id" : 63036439,
      "original_commit_id" : "cc1df8fa6f4849b65187f60a3cb4c83da3d16788",
      "original_position" : 72,
      "path" : "src/wallet/wallet.cpp",
      "position" : 73,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63036439",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "body" : "utACK https://github.com/bitcoin/bitcoin/pull/8035/commits/cc1df8fa6f4849b65187f60a3cb4c83da3d16788\r\n\r\nGlad to see a really simple PR. Baby steps better than no steps.",
      "created_at" : "2016-05-12T15:14:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-218788961",
      "id" : 218788961,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-12T15:14:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218788961",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "body" : "Added a squash me commit with some non-code nit fixes.",
      "created_at" : "2016-05-12T18:56:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-218852532",
      "id" : 218852532,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-12T18:56:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/218852532",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63466646"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63466646"
         }
      },
      "body" : "Why is this an assertion but missing the master key is an exception?",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-17T05:36:33Z",
      "diff_hunk" : "@@ -91,7 +91,47 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata\n+    int64_t nCreationTime = GetTime();\n+    CKeyMetadata metadata(nCreationTime);\n+\n+    // use HD key derivation if HD was enabled during wallet creation\n+    if (!hdChain.masterKeyID.IsNull()) {\n+        // for now we use a fixed keypath scheme of m/0'/0'/k\n+        CKey key;                      //master key seed (256bit)\n+        CExtKey masterKey;             //hd master key\n+        CExtKey accountKey;            //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey;              //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdChain.masterKeyID, key))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Master key not found\");\n+\n+        assert(key.size() == 32);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63466646",
      "id" : 63466646,
      "original_commit_id" : "cc1df8fa6f4849b65187f60a3cb4c83da3d16788",
      "original_position" : 23,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63466646",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63466697"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63466697"
         }
      },
      "body" : "Needs comment about hardened derivation.",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-17T05:37:33Z",
      "diff_hunk" : "@@ -91,7 +91,47 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata\n+    int64_t nCreationTime = GetTime();\n+    CKeyMetadata metadata(nCreationTime);\n+\n+    // use HD key derivation if HD was enabled during wallet creation\n+    if (!hdChain.masterKeyID.IsNull()) {\n+        // for now we use a fixed keypath scheme of m/0'/0'/k\n+        CKey key;                      //master key seed (256bit)\n+        CExtKey masterKey;             //hd master key\n+        CExtKey accountKey;            //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey;              //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdChain.masterKeyID, key))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Master key not found\");\n+\n+        assert(key.size() == 32);\n+        masterKey.SetMaster(key.begin(), key.size());\n+\n+        // derive m/0'\n+        masterKey.Derive(accountKey, 0 | 0x80000000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63466697",
      "id" : 63466697,
      "original_commit_id" : "cc1df8fa6f4849b65187f60a3cb4c83da3d16788",
      "original_position" : 27,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63466697",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63466976"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63466976"
         }
      },
      "body" : "Please add braces here for the else block.",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-17T05:42:02Z",
      "diff_hunk" : "@@ -91,7 +91,47 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata\n+    int64_t nCreationTime = GetTime();\n+    CKeyMetadata metadata(nCreationTime);\n+\n+    // use HD key derivation if HD was enabled during wallet creation\n+    if (!hdChain.masterKeyID.IsNull()) {\n+        // for now we use a fixed keypath scheme of m/0'/0'/k\n+        CKey key;                      //master key seed (256bit)\n+        CExtKey masterKey;             //hd master key\n+        CExtKey accountKey;            //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey;              //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdChain.masterKeyID, key))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Master key not found\");\n+\n+        assert(key.size() == 32);\n+        masterKey.SetMaster(key.begin(), key.size());\n+\n+        // derive m/0'\n+        masterKey.Derive(accountKey, 0 | 0x80000000);\n+\n+        // derive m/0'/0'\n+        accountKey.Derive(externalChainChildKey, 0 | 0x80000000);\n+\n+        // derive child key at next index, skip keys already known to the wallet\n+        do\n+        {\n+            externalChainChildKey.Derive(childKey, hdChain.nExternalChainCounter | 0x80000000);\n+            // increment childkey index\n+            hdChain.nExternalChainCounter++;\n+        } while(HaveKey(childKey.key.GetPubKey().GetID()));\n+        secret = childKey.key;\n+\n+        // update the chain model in the database\n+        if (!CWalletDB(strWalletFile).WriteHDChain(hdChain))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Writing HD chain model failed\");\n+    } else\n+        secret.MakeNewKey(fCompressed);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63466976",
      "id" : 63466976,
      "original_commit_id" : "cc1df8fa6f4849b65187f60a3cb4c83da3d16788",
      "original_position" : 45,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63466976",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63467081"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63467081"
         }
      },
      "body" : "I agree. This assertion should be removed.",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-17T05:43:08Z",
      "diff_hunk" : "@@ -91,7 +91,47 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata\n+    int64_t nCreationTime = GetTime();\n+    CKeyMetadata metadata(nCreationTime);\n+\n+    // use HD key derivation if HD was enabled during wallet creation\n+    if (!hdChain.masterKeyID.IsNull()) {\n+        // for now we use a fixed keypath scheme of m/0'/0'/k\n+        CKey key;                      //master key seed (256bit)\n+        CExtKey masterKey;             //hd master key\n+        CExtKey accountKey;            //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey;              //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdChain.masterKeyID, key))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Master key not found\");\n+\n+        assert(key.size() == 32);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63467081",
      "id" : 63467081,
      "original_commit_id" : "cc1df8fa6f4849b65187f60a3cb4c83da3d16788",
      "original_position" : 23,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63467081",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63476458"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63476458"
         }
      },
      "body" : "our clang format script accepted that.\r\nWhat's wrong with it? :-)",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-17T07:40:40Z",
      "diff_hunk" : "@@ -91,7 +91,47 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata\n+    int64_t nCreationTime = GetTime();\n+    CKeyMetadata metadata(nCreationTime);\n+\n+    // use HD key derivation if HD was enabled during wallet creation\n+    if (!hdChain.masterKeyID.IsNull()) {\n+        // for now we use a fixed keypath scheme of m/0'/0'/k\n+        CKey key;                      //master key seed (256bit)\n+        CExtKey masterKey;             //hd master key\n+        CExtKey accountKey;            //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey;              //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdChain.masterKeyID, key))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Master key not found\");\n+\n+        assert(key.size() == 32);\n+        masterKey.SetMaster(key.begin(), key.size());\n+\n+        // derive m/0'\n+        masterKey.Derive(accountKey, 0 | 0x80000000);\n+\n+        // derive m/0'/0'\n+        accountKey.Derive(externalChainChildKey, 0 | 0x80000000);\n+\n+        // derive child key at next index, skip keys already known to the wallet\n+        do\n+        {\n+            externalChainChildKey.Derive(childKey, hdChain.nExternalChainCounter | 0x80000000);\n+            // increment childkey index\n+            hdChain.nExternalChainCounter++;\n+        } while(HaveKey(childKey.key.GetPubKey().GetID()));\n+        secret = childKey.key;\n+\n+        // update the chain model in the database\n+        if (!CWalletDB(strWalletFile).WriteHDChain(hdChain))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Writing HD chain model failed\");\n+    } else\n+        secret.MakeNewKey(fCompressed);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63476458",
      "id" : 63476458,
      "original_commit_id" : "cc1df8fa6f4849b65187f60a3cb4c83da3d16788",
      "original_position" : 45,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63476458",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Added another squash-me commit with minor nit fixes.",
      "created_at" : "2016-05-17T07:42:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-219642847",
      "id" : 219642847,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-17T07:42:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219642847",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "@jonasschnelli clang-format does not reject anything, it just reformats.",
      "created_at" : "2016-05-17T07:55:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-219645472",
      "id" : 219645472,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-17T07:55:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219645472",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa: right! Sorry. I meant it didn't reformat the `else` part.",
      "created_at" : "2016-05-17T08:11:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-219648708",
      "id" : 219648708,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-17T08:11:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219648708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "@jonasschnelli It can't reformat it, because all it does is change whitespace. What we want here is more than just changing whitespace, but there is no way to make clang do that (and also not make it yell about it). Just because a whitespace formatting tool accepts the code, doesn't mean it satisfies all our style guidelines. For example, it also does not check consistency of variable names.",
      "created_at" : "2016-05-17T08:13:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-219649367",
      "id" : 219649367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-17T08:13:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219649367",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63481179"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63481179"
         }
      },
      "body" : "I think that is what clang-tidy is supposed to do ;)",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-17T08:17:42Z",
      "diff_hunk" : "@@ -91,7 +91,47 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata\n+    int64_t nCreationTime = GetTime();\n+    CKeyMetadata metadata(nCreationTime);\n+\n+    // use HD key derivation if HD was enabled during wallet creation\n+    if (!hdChain.masterKeyID.IsNull()) {\n+        // for now we use a fixed keypath scheme of m/0'/0'/k\n+        CKey key;                      //master key seed (256bit)\n+        CExtKey masterKey;             //hd master key\n+        CExtKey accountKey;            //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey;              //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdChain.masterKeyID, key))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Master key not found\");\n+\n+        assert(key.size() == 32);\n+        masterKey.SetMaster(key.begin(), key.size());\n+\n+        // derive m/0'\n+        masterKey.Derive(accountKey, 0 | 0x80000000);\n+\n+        // derive m/0'/0'\n+        accountKey.Derive(externalChainChildKey, 0 | 0x80000000);\n+\n+        // derive child key at next index, skip keys already known to the wallet\n+        do\n+        {\n+            externalChainChildKey.Derive(childKey, hdChain.nExternalChainCounter | 0x80000000);\n+            // increment childkey index\n+            hdChain.nExternalChainCounter++;\n+        } while(HaveKey(childKey.key.GetPubKey().GetID()));\n+        secret = childKey.key;\n+\n+        // update the chain model in the database\n+        if (!CWalletDB(strWalletFile).WriteHDChain(hdChain))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Writing HD chain model failed\");\n+    } else\n+        secret.MakeNewKey(fCompressed);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r63481179",
      "id" : 63481179,
      "original_commit_id" : "cc1df8fa6f4849b65187f60a3cb4c83da3d16788",
      "original_position" : 45,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-17T14:39:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/63481179",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "Amend force pushed last squash-me commit with the `else` + bracket change.",
      "created_at" : "2016-05-17T11:07:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-219686978",
      "id" : 219686978,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-17T11:07:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/219686978",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r64147195"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64147195"
         }
      },
      "body" : "Sorry, I don't understand this ```| 0x80000000``` from the comments...",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-22T09:46:35Z",
      "diff_hunk" : "@@ -91,7 +91,48 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata\n+    int64_t nCreationTime = GetTime();\n+    CKeyMetadata metadata(nCreationTime);\n+\n+    // use HD key derivation if HD was enabled during wallet creation\n+    if (!hdChain.masterKeyID.IsNull()) {\n+        // for now we use a fixed keypath scheme of m/0'/0'/k\n+        CKey key;                      //master key seed (256bit)\n+        CExtKey masterKey;             //hd master key\n+        CExtKey accountKey;            //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey;              //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdChain.masterKeyID, key))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Master key not found\");\n+\n+        masterKey.SetMaster(key.begin(), key.size());\n+\n+        // derive m/0'\n+        // use hardened derivation (child keys > 0x80000000 are hardened after bip32)\n+        masterKey.Derive(accountKey, 0 | 0x80000000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r64147195",
      "id" : 64147195,
      "original_commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "original_position" : 27,
      "path" : "src/wallet/wallet.cpp",
      "position" : 27,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-22T09:46:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64147195",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r64147377"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64147377"
         }
      },
      "body" : "Hardened keys are >= 0x80000000, not > according to bip32",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-22T10:05:32Z",
      "diff_hunk" : "@@ -91,7 +91,48 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata\n+    int64_t nCreationTime = GetTime();\n+    CKeyMetadata metadata(nCreationTime);\n+\n+    // use HD key derivation if HD was enabled during wallet creation\n+    if (!hdChain.masterKeyID.IsNull()) {\n+        // for now we use a fixed keypath scheme of m/0'/0'/k\n+        CKey key;                      //master key seed (256bit)\n+        CExtKey masterKey;             //hd master key\n+        CExtKey accountKey;            //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey;              //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdChain.masterKeyID, key))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Master key not found\");\n+\n+        masterKey.SetMaster(key.begin(), key.size());\n+\n+        // derive m/0'\n+        // use hardened derivation (child keys > 0x80000000 are hardened after bip32)\n+        masterKey.Derive(accountKey, 0 | 0x80000000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r64147377",
      "id" : 64147377,
      "original_commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "original_position" : 27,
      "path" : "src/wallet/wallet.cpp",
      "position" : 27,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-22T10:05:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64147377",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r64147389"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64147389"
         }
      },
      "body" : "It's specified here:\r\nhttps://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki#child-key-derivation-ckd-functions\r\n\r\nYou can derive 2^32 key, child keys <= 2147483648 (<=0x80000000) are non-hardened key. Derived child keys > 2147483648 are hardened keys.\r\n\r\nThis line:\r\n`masterKey.Derive(accountKey, 0 | 0x80000000);`\r\n.. is equal to ..\r\n`masterKey.Derive(accountKey, 0 + 2147483648)`",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-22T10:06:10Z",
      "diff_hunk" : "@@ -91,7 +91,48 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata\n+    int64_t nCreationTime = GetTime();\n+    CKeyMetadata metadata(nCreationTime);\n+\n+    // use HD key derivation if HD was enabled during wallet creation\n+    if (!hdChain.masterKeyID.IsNull()) {\n+        // for now we use a fixed keypath scheme of m/0'/0'/k\n+        CKey key;                      //master key seed (256bit)\n+        CExtKey masterKey;             //hd master key\n+        CExtKey accountKey;            //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey;              //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdChain.masterKeyID, key))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Master key not found\");\n+\n+        masterKey.SetMaster(key.begin(), key.size());\n+\n+        // derive m/0'\n+        // use hardened derivation (child keys > 0x80000000 are hardened after bip32)\n+        masterKey.Derive(accountKey, 0 | 0x80000000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r64147389",
      "id" : 64147389,
      "original_commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "original_position" : 27,
      "path" : "src/wallet/wallet.cpp",
      "position" : 27,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-22T10:06:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64147389",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r64147425"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64147425"
         }
      },
      "body" : "I think the comment has a typo?",
      "commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "created_at" : "2016-05-22T10:09:09Z",
      "diff_hunk" : "@@ -91,7 +91,48 @@ CPubKey CWallet::GenerateNewKey()\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n \n     CKey secret;\n-    secret.MakeNewKey(fCompressed);\n+\n+    // Create new metadata\n+    int64_t nCreationTime = GetTime();\n+    CKeyMetadata metadata(nCreationTime);\n+\n+    // use HD key derivation if HD was enabled during wallet creation\n+    if (!hdChain.masterKeyID.IsNull()) {\n+        // for now we use a fixed keypath scheme of m/0'/0'/k\n+        CKey key;                      //master key seed (256bit)\n+        CExtKey masterKey;             //hd master key\n+        CExtKey accountKey;            //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey;              //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdChain.masterKeyID, key))\n+            throw std::runtime_error(\"CWallet::GenerateNewKey(): Master key not found\");\n+\n+        masterKey.SetMaster(key.begin(), key.size());\n+\n+        // derive m/0'\n+        // use hardened derivation (child keys > 0x80000000 are hardened after bip32)\n+        masterKey.Derive(accountKey, 0 | 0x80000000);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#discussion_r64147425",
      "id" : 64147425,
      "original_commit_id" : "d2f3c1ded185cd0f67bb0f48b59c995d63ad50b7",
      "original_position" : 27,
      "path" : "src/wallet/wallet.cpp",
      "position" : 27,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8035",
      "updated_at" : "2016-05-22T10:09:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/64147425",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "I still have limited knowledge of the wallet, but thanks to this being so simple I was able to review it and everything looks good.\r\nsomething-between-concept-and-ut ACK\r\n",
      "created_at" : "2016-05-22T10:21:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-220824867",
      "id" : 220824867,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-22T10:21:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/220824867",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Rebased. Squashed squash-me commits.",
      "created_at" : "2016-05-31T08:45:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8035#issuecomment-222628091",
      "id" : 222628091,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8035",
      "updated_at" : "2016-05-31T08:45:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/222628091",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   }
]
