[
   {
      "body" : "utACK",
      "created_at" : "2016-05-22T10:04:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-220824169",
      "id" : 220824169,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8086",
      "updated_at" : "2016-05-22T10:04:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/220824169",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "This is one of those things where having a cryptographic hash function probably isnt /critical/, but is really preferable. Is the speed of SHA256 really slow enough to matter here afer you accepted a new TCP connection (and all associated OS overhead of doing so)?",
      "created_at" : "2016-05-23T02:37:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-220875999",
      "id" : 220875999,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8086",
      "updated_at" : "2016-05-23T02:37:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/220875999",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "nACK\r\n\r\nThis really does need to be a cryptographic hash function.\r\n\r\nThe performance overhead of opening the connection is almost certainly many many times the cost of this comparison.",
      "created_at" : "2016-05-23T04:11:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-220883912",
      "id" : 220883912,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8086",
      "updated_at" : "2016-05-23T04:11:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/220883912",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "Siphash is a cryptographic function with all the properties we would desire here: https://eprint.iacr.org/2014/722\r\n\r\nIt is generally suitable any place a cryptographic hash would be used where the small output size wouldn't be an issue.  This is a fine example of such a location, similar to hash tables where the table's smallness makes a larger hash output irrelevant, with only a few hundred peers a 64 bit hash will reliably distinguish them.",
      "created_at" : "2016-05-23T05:19:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-220889430",
      "id" : 220889430,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8086",
      "updated_at" : "2016-05-23T05:19:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/220889430",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "In principal, yes, SipHash was designed to be effectively a cryptographic hash with small output size, but I don't want to fall into the trap of calling something a cryptographic hash when it has only had one or two cryptanalyses published. If we care about the performance difference here, I'd say it's fine, but I'm not sure that we do?\n\nOn May 22, 2016 10:19:47 PM PDT, Gregory Maxwell <notifications@github.com> wrote:\n>Siphash is a cryptographic function with all the properties we would\n>desire here: https://eprint.iacr.org/2014/722\n>\n>It is generally suitable any place a cryptographic hash would be used\n>where the small output size wouldn't be an issue.  This is a fine\n>example of such a location, similar to hash tables where the table's\n>smallness makes a larger hash output irrelevant, with only a few\n>hundred peers a 64 bit hash will reliably distinguish them.\n>\n>---\n>You are receiving this because you commented.\n>Reply to this email directly or view it on GitHub:\n>https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-220889430\n",
      "created_at" : "2016-05-23T06:13:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-220895178",
      "id" : 220895178,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8086",
      "updated_at" : "2016-05-23T06:13:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/220895178",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "@gmaxwell I'll do a fix that still uses SHA256",
      "created_at" : "2016-05-23T07:20:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-220904801",
      "id" : 220904801,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8086",
      "updated_at" : "2016-05-23T07:20:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/220904801",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "Please walk me through the attack you're imagining here.   There are 16 bits of network groups for IPv4, 32 bits for IPv6. In both cases many of the possible values aren't routable on the internet..  Each node has it's own 128-bit secret random seed.  The node prefers to keep four hosts based on how their netgroup is ordered by a salted hash.  The attacker does X and achieves Y.  Help me out with the blanks here. :)\r\n",
      "created_at" : "2016-05-23T09:18:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-220928715",
      "id" : 220928715,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8086",
      "updated_at" : "2016-05-23T09:18:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/220928715",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "@gmaxwell I don't know but with #8088 the performance difference is going to be basically not measurable.\r\n\r\nIt's now reduced to the difference between a single SHA256 vs SipHash and comparison between 256 bits vs 64 bits.",
      "created_at" : "2016-05-23T10:05:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-220939354",
      "id" : 220939354,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8086",
      "updated_at" : "2016-05-23T10:05:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/220939354",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/620611?v=3",
         "events_url" : "https://api.github.com/users/pstratem/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pstratem/followers",
         "following_url" : "https://api.github.com/users/pstratem/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pstratem/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pstratem",
         "id" : 620611,
         "login" : "pstratem",
         "organizations_url" : "https://api.github.com/users/pstratem/orgs",
         "received_events_url" : "https://api.github.com/users/pstratem/received_events",
         "repos_url" : "https://api.github.com/users/pstratem/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pstratem/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pstratem"
      }
   },
   {
      "body" : "Come one guys, you can't throw up a bunch of stop signs for security then fail to actually walk me through your security analysis.  We want security but not security cargo cult.\r\n\r\nBeyond performance there is a consistency point here, we should use the same cryptographic hash-function in all the cases where we need some non-normative small hash, unless there is a good reason not to. If there is a reason it's not suitable here, then its likely not suitable in other cases either.",
      "created_at" : "2016-05-24T18:18:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-221358510",
      "id" : 221358510,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8086",
      "updated_at" : "2016-05-24T18:18:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/221358510",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "If there is no performance difference, why change it? Might as well use a stronger hash anywhere we can if its free.",
      "created_at" : "2016-05-24T19:11:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-221373159",
      "id" : 221373159,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8086",
      "updated_at" : "2016-05-24T19:11:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/221373159",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Again, please actually specify the attack.  I gave you a template, fill it out.\r\n\r\n> If the other uses of SipHash fail they at worst are a denial of service attack\r\n\r\nThe usage in addrman is functionally identical to this. \r\n\r\n> if there is no performance difference\r\n\r\nin this PR it's a pretty substantial performance difference (it's about 2ms per connection), though performance can be achieved in other ways that I pointed out.\r\n\r\n> Might as well use a stronger hash \r\n\r\nOn what basis do you believe that another construction would be stronger?",
      "created_at" : "2016-05-24T19:19:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-221374959",
      "id" : 221374959,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8086",
      "updated_at" : "2016-05-24T19:19:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/221374959",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "Again, please actually specify the attack.  I gave you a template, fill it out.\r\n\r\n> If the other uses of SipHash fail they at worst are a denial of service attack\r\n\r\nThe usage in addrman is functionally identical to this. \r\n\r\n> if there is no performance difference\r\n\r\nin this PR it's a pretty substantial performance difference (it's about 2ms per connection), though performance can be achieved in other ways that I pointed out.\r\n\r\n> Might as well use a stronger hash \r\n\r\nOn what basis do you believe that another construction would be stronger?\r\n\r\nAs an aside-- right now the behavior of this is kind of busted. It orders peers by their netgroup and protects four, but it makes no effort to make the four be from different netgroups, which means there is an obvious attack strategy of running four hosts per netgroup in a lots of different netgroups. To avoid that, it should (e.g.) sort by netgroup hash, lastblocktime>0, connection uptime and skip over protecting peers that have the same netgroup as peers that were already protected.\r\n\r\nIt's more than a little disappointing to see furious hand-waving about the hash function when the basic functionality isn't getting anywhere near that amount of attention.",
      "created_at" : "2016-05-24T19:40:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8086#issuecomment-221379952",
      "id" : 221379952,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8086",
      "updated_at" : "2016-05-24T19:40:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/221379952",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   }
]
