[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6733#discussion_r40562325"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6733"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/40562325"
         }
      },
      "body" : "This works well as long as 'stuff you want to time' does not run too quickly - otherwise the state.KeepRunning(), which does a `gettimeofday` syscall, with the implied latency of that, will dominate.\r\n(an alternative to calling the time function in the benchmark loop that is commonly used, is to first time a fixed # of runs of the loop, then from the result compute a number of iterations so that it runs for approximately the allotted time)",
      "commit_id" : "09125ce99b63dcc264a6df71fed774a4584d879c",
      "created_at" : "2015-09-28T15:01:23Z",
      "diff_hunk" : "@@ -0,0 +1,69 @@\n+// Copyright (c) 2015 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+#ifndef BITCOIN_BENCH_H\n+#define BITCOIN_BENCH_H\n+\n+// Simple micro-benchmarking framework; API mostly matches a subset of the Google Benchmark\n+// framework (see https://github.com/google/benchmark)\n+// Wny not use the Google Benchmark framework? Because adding Yet Another Dependency\n+// (that uses cmake as its build system and has lots of features we don't need) isn't\n+// worth it.\n+\n+/*\n+ * Usage:\n+\n+static void CODE_TO_TIME(benchmark::State& state)\n+{\n+    ... do any setup needed...\n+    while (state.KeepRunning()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6733#discussion_r40562325",
      "id" : 40562325,
      "original_commit_id" : "830fec11356c16e2396be7c6d5d076553bc5ca0d",
      "original_position" : 19,
      "path" : "src/bench/bench.h",
      "position" : 19,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6733",
      "updated_at" : "2015-09-28T18:14:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/40562325",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Concept ACK",
      "created_at" : "2015-09-28T15:42:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6733#issuecomment-143783672",
      "id" : 143783672,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6733",
      "updated_at" : "2015-09-28T15:42:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/143783672",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6733#discussion_r40567870"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6733"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/40567870"
         }
      },
      "body" : "rm `$(CURL_LIBS)`? This seems to have be sneaked in from XT.",
      "commit_id" : "09125ce99b63dcc264a6df71fed774a4584d879c",
      "created_at" : "2015-09-28T15:46:07Z",
      "diff_hunk" : "@@ -0,0 +1,31 @@\n+bin_PROGRAMS += bench/bench_bitcoin\n+BENCH_SRCDIR = bench\n+BENCH_BINARY=bench/bench_bitcoin$(EXEEXT)\n+\n+\n+bench_bench_bitcoin_SOURCES =\\\n+  bench/bench_bitcoin.cpp \\\n+  bench/bench.cpp \\\n+  bench/bench.h \\\n+  bench/MilliSleep.cpp\n+\n+bench_bench_bitcoin_CPPFLAGS = $(BITCOIN_INCLUDES) -I$(builddir)/bench/\n+bench_bench_bitcoin_LDADD = $(LIBBITCOIN_SERVER) $(LIBBITCOIN_CLI) $(LIBBITCOIN_COMMON) $(LIBBITCOIN_UTIL) $(LIBBITCOIN_CRYPTO) $(LIBBITCOIN_UNIVALUE) $(LIBLEVELDB) $(LIBMEMENV) \\\n+  $(BOOST_LIBS) $(LIBSECP256K1)\n+if ENABLE_WALLET\n+bench_bench_bitcoin_LDADD += $(LIBBITCOIN_WALLET)\n+endif\n+bench_bench_bitcoin_LDADD += $(LIBBITCOIN_CONSENSUS) $(BDB_LIBS) $(SSL_LIBS) $(CRYPTO_LIBS) $(MINIUPNPC_LIBS) $(CURL_LIBS)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6733#discussion_r40567870",
      "id" : 40567870,
      "original_commit_id" : "830fec11356c16e2396be7c6d5d076553bc5ca0d",
      "original_position" : 18,
      "path" : "src/Makefile.bench.include",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6733",
      "updated_at" : "2015-09-28T18:14:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/40567870",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Concept ACK",
      "created_at" : "2015-09-28T16:16:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6733#issuecomment-143793531",
      "id" : 143793531,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6733",
      "updated_at" : "2015-09-28T16:16:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/143793531",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Removed the $(CURL_LIBS) noticed by @jonasschnelli.\r\n\r\nAnd added the new libevent and libzmq dependencies.\r\n\r\nI also decided to make it disabled by default, so you have to configure --enable-bench, so it doesn't slow down compile times for everybody.\r\n\r\n@laanwj : RE: gettimeofday overhead and timing things that are very fast: timing how fast gettimeofday() is and then warning the developer if their benchmarking code runs into that overhead (maybe suggest that they loop 1,000 times inside the KeepRunning loop) would be another way of preventing that problem. Feel free to improve, I'm planning on using this to benchmark things that take microseconds to run, not nanoseconds.",
      "created_at" : "2015-09-29T16:53:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6733#issuecomment-144118883",
      "id" : 144118883,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6733",
      "updated_at" : "2015-09-29T16:53:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/144118883",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "@jgarzik :  I KNEW you were going to say that...\r\n\r\nWould a Travis configuration that runs benchmarks be good enough to prevent code rot? Compiling and linking Yet Another Binary that approximately nobody will run (unless you're actively working on optimizing something) tickles my \"features shouldn't cost anything unless you're using them\" sensibility.",
      "created_at" : "2015-09-29T18:06:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6733#issuecomment-144138148",
      "id" : 144138148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6733",
      "updated_at" : "2015-09-29T18:06:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/144138148",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   }
]
