[
   {
      "body" : "Oh, forgot:\r\n\r\nTested by running with:\r\n   -debug=mempool -maxorphantx=0\r\nand\r\n   -debug=mempool -maxorphantx=4\r\n",
      "created_at" : "2014-09-09T18:16:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55011496",
      "id" : 55011496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-09T18:16:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55011496",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Untested ACK. Testing.",
      "created_at" : "2014-09-09T18:27:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55012663",
      "id" : 55012663,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-09T18:27:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55012663",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "One rare edge case I wonder about:  When a reorg creates more than 100 orphans.\r\n",
      "created_at" : "2014-09-09T19:40:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55021997",
      "id" : 55021997,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-09T19:40:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55021997",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Jeff: you seem confused. Orphans (both blocks and transactions) as used in\nthe source code means: things that can't be validated yet, as a parent is\nmissing.\n\nDisconnecting part of the block chain can moved blockchain transaction back\nto the memory pool, but certainly not to the orphan pool.\n\nOr are you confusing with orphan blocks?",
      "created_at" : "2014-09-09T19:47:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55022910",
      "id" : 55022910,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-09T19:47:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55022910",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "I meant invalid transactions, due to depending on unknown(non-existent) coinbases.  But those wouldn't go into mapOrphan* presumably, as they are simply invalid.",
      "created_at" : "2014-09-09T19:54:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55023830",
      "id" : 55023830,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-09T19:54:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55023830",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "Tested ACK",
      "created_at" : "2014-09-09T20:34:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55030130",
      "id" : 55030130,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-09T20:34:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55030130",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "I've cherry-picked 66aca7 \"Fix crashing bug caused by orphan(s) with duplicate prevout.hash\" into master as def2fdb to avoid crashes.",
      "created_at" : "2014-09-10T14:55:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55127485",
      "id" : 55127485,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-10T14:56:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55127485",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Rebased on master, and reworked a bit to address @wtogami's comments-- now one bad signature breaks out of the \"process all orphans that were waiting on this transaction\" loop.",
      "created_at" : "2014-09-10T16:24:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55141628",
      "id" : 55141628,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-10T16:24:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55141628",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Won't breaking out of that loop mean that you end up with transactions in the orphan pool that never get processed anymore?\r\n\r\nI think we should prevent processing transactions from punished sources instead.",
      "created_at" : "2014-09-10T16:32:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55142941",
      "id" : 55142941,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-10T16:32:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55142941",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "@sipa : mmm... I think you're right, I could construct a chain of valid orphans with invalid-but-expensive-to-validate children and cause a lot of unnecessary CPU work.",
      "created_at" : "2014-09-10T17:14:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55148961",
      "id" : 55148961,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-10T17:14:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55148961",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Ok, the promote orphans into memory pool loop now keeps track of misbehaving peers, and skips processing of orphans from those peers. It doesn't remove ALL the orphans from those peers-- that still gets done when the peer is disconnected.\r\n\r\nTested by running -debug=mempool -printtoconsole and merging in a hacked-together disconnectpeer RPC call.\r\n",
      "created_at" : "2014-09-10T17:36:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55152120",
      "id" : 55152120,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-10T17:36:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55152120",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4885_aa3c697e90c02d5797a59a7bfb1ecac6fbd918cf/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-09-10T18:27:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55159933",
      "id" : 55159933,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-10T18:27:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55159933",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "ACK",
      "created_at" : "2014-09-11T05:48:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55222343",
      "id" : 55222343,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-11T05:48:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55222343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/93665?v=3",
         "events_url" : "https://api.github.com/users/wtogami/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wtogami/followers",
         "following_url" : "https://api.github.com/users/wtogami/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wtogami/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wtogami",
         "id" : 93665,
         "login" : "wtogami",
         "organizations_url" : "https://api.github.com/users/wtogami/orgs",
         "received_events_url" : "https://api.github.com/users/wtogami/received_events",
         "repos_url" : "https://api.github.com/users/wtogami/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wtogami/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wtogami/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wtogami"
      }
   },
   {
      "body" : "I tested the orphan pool overflow as well as deletion of all orphans of a node on disconnect. I don't have anything to test the DoS/Misbehaving case at the moment, though.\r\n\r\nACK on code changes.\r\n",
      "created_at" : "2014-09-11T10:34:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4885#issuecomment-55246737",
      "id" : 55246737,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4885",
      "updated_at" : "2014-09-11T10:44:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/55246737",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
