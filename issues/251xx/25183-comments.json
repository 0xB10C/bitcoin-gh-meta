[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2022-05-21T08:02:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25183#issuecomment-1133560428",
      "id" : 1133560428,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25183",
      "node_id" : "IC_kwDOABII585DkMJs",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1133560428/reactions"
      },
      "updated_at" : "2022-05-21T08:02:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1133560428",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25118](https://github.com/bitcoin/bitcoin/pull/25118) (wallet: unify âallow/block other inputsâ concept by furszy)\n* [#25005](https://github.com/bitcoin/bitcoin/pull/25005) (wallet: remove extra wtx lookup in 'AvailableCoins' + several code cleanups. by furszy)\n* [#24699](https://github.com/bitcoin/bitcoin/pull/24699) (wallet: Improve AvailableCoins performance by reducing duplicated operations by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-05-21T16:02:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25183#issuecomment-1133660802",
      "id" : 1133660802,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25183",
      "node_id" : "IC_kwDOABII585DkkqC",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1133660802/reactions"
      },
      "updated_at" : "2022-05-21T16:02:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1133660802",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@aureleoules can we achieve the same result by using descriptors wallet with only segwit descriptors?",
      "created_at" : "2022-05-23T07:53:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25183#issuecomment-1134311246",
      "id" : 1134311246,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25183",
      "node_id" : "IC_kwDOABII585DnDdO",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1134311246/reactions"
      },
      "updated_at" : "2022-05-23T07:53:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1134311246",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\n@brunoerg I think it's fine as it. Should squash if the 1st commit requires the 2nd to pass CI.",
      "created_at" : "2022-05-23T22:58:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25183#issuecomment-1135215654",
      "id" : 1135215654,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25183",
      "node_id" : "IC_kwDOABII585DqgQm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1135215654/reactions"
      },
      "updated_at" : "2022-05-23T22:58:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1135215654",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @aureleoules can we achieve the same result by using descriptors wallet with only segwit descriptors?\r\n\r\nI am not very familiar with wallet descriptors.\r\nDo you mean using a wallet that does not have legacy descriptors imported?\r\nI think @achow101 answed that yes (https://github.com/bitcoin/bitcoin/issues/25181#issuecomment-1134923482).\r\n\r\nBut if I understand correctly, this feature might still be useful in cases where you don't control the wallet.",
      "created_at" : "2022-05-24T01:08:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25183#issuecomment-1135291216",
      "id" : 1135291216,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25183",
      "node_id" : "IC_kwDOABII585DqytQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1135291216/reactions"
      },
      "updated_at" : "2022-05-24T01:08:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1135291216",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25183#discussion_r881581203"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25183"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/881581203"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The name here seems confusing to me. Maybe `\"segwit_inputs_only\"`?",
      "commit_id" : "6677717fba71b64a476b441f3af0fdf4fa98631d",
      "created_at" : "2022-05-25T12:16:15Z",
      "diff_hunk" : "@@ -787,7 +792,8 @@ RPCHelpMan fundrawtransaction()\n                                         \"so the maximum DER signatures size of 73 bytes should be used when considering ECDSA signatures.\"\n                                         \"Remember to convert serialized sizes to weight units when necessary.\"},\n                                 },\n-                             },\n+                            },\n+                            {\"inputs_witness_only\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"Whether to only use inputs with witness data for transaction.\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25183#discussion_r881581203",
      "id" : 881581203,
      "line" : 796,
      "node_id" : "PRRC_kwDOABII5840i9yT",
      "original_commit_id" : "6677717fba71b64a476b441f3af0fdf4fa98631d",
      "original_line" : 796,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : 25,
      "pull_request_review_id" : 984708878,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25183",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/881581203/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-25T12:16:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/881581203",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25183#discussion_r881703417"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25183"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/881703417"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Indeed, I changed it.",
      "commit_id" : "1c5cfd84b3dc14ab886acd47c7891c11eb2457ec",
      "created_at" : "2022-05-25T14:10:03Z",
      "diff_hunk" : "@@ -787,7 +792,8 @@ RPCHelpMan fundrawtransaction()\n                                         \"so the maximum DER signatures size of 73 bytes should be used when considering ECDSA signatures.\"\n                                         \"Remember to convert serialized sizes to weight units when necessary.\"},\n                                 },\n-                             },\n+                            },\n+                            {\"inputs_witness_only\", RPCArg::Type::BOOL, RPCArg::Default{false}, \"Whether to only use inputs with witness data for transaction.\"},",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25183#discussion_r881703417",
      "id" : 881703417,
      "in_reply_to_id" : 881581203,
      "line" : null,
      "node_id" : "PRRC_kwDOABII5840jbn5",
      "original_commit_id" : "6677717fba71b64a476b441f3af0fdf4fa98631d",
      "original_line" : 796,
      "original_position" : 25,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/spend.cpp",
      "position" : null,
      "pull_request_review_id" : 984885962,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25183",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/881703417/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-25T14:10:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/881703417",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/22493292?v=4",
         "events_url" : "https://api.github.com/users/aureleoules/events{/privacy}",
         "followers_url" : "https://api.github.com/users/aureleoules/followers",
         "following_url" : "https://api.github.com/users/aureleoules/following{/other_user}",
         "gists_url" : "https://api.github.com/users/aureleoules/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/aureleoules",
         "id" : 22493292,
         "login" : "aureleoules",
         "node_id" : "MDQ6VXNlcjIyNDkzMjky",
         "organizations_url" : "https://api.github.com/users/aureleoules/orgs",
         "received_events_url" : "https://api.github.com/users/aureleoules/received_events",
         "repos_url" : "https://api.github.com/users/aureleoules/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/aureleoules/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/aureleoules/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/aureleoules"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25183#discussion_r885759061"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25183"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/885759061"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This may actually be testing something else than intended: given that the coinbase output is not 100 blocks old yet, I suspect the \"Insufficient funds\" would be foremost caused by the inputs being immature.\r\n\r\nThis test could be improved by creating a scenario in which a transaction is first successfully funded by using legacy inputs, but then toggling the `'segwit_inputs_only': true` causes a repeated attempt to fund the transaction to fail.",
      "commit_id" : "1c5cfd84b3dc14ab886acd47c7891c11eb2457ec",
      "created_at" : "2022-05-31T15:08:07Z",
      "diff_hunk" : "@@ -177,6 +178,38 @@ def test_simple(self):\n         dec_tx  = self.nodes[2].decoderawtransaction(rawtxfund['hex'])\n         assert len(dec_tx['vin']) > 0  #test that we have enough inputs\n \n+    def check_witness_inputs(self, vins):\n+        for vin in vins:\n+            # check vin is a segwit input\n+            utxo = self.nodes[2].gettxout(vin['txid'], vin['vout'])\n+            info = self.nodes[2].getaddressinfo(utxo['scriptPubKey']['address'])\n+            if not info['iswitness']:\n+                return False\n+\n+        return True\n+\n+    def test_witness_only(self):\n+        self.log.info(\"Testing fundrawtxn with witness inputs only\")\n+\n+        inputs  = [ ]\n+\n+        # make sure legacy inputs are not accepted in witness only mode if no witness inputs are found\n+        self.generatetoaddress(self.nodes[2], 2, self.nodes[2].getnewaddress(address_type='legacy'))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25183#discussion_r885759061",
      "id" : 885759061,
      "line" : 197,
      "node_id" : "PRRC_kwDOABII5840y5xV",
      "original_commit_id" : "1c5cfd84b3dc14ab886acd47c7891c11eb2457ec",
      "original_line" : 197,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "test/functional/rpc_fundrawtransaction.py",
      "position" : 28,
      "pull_request_review_id" : 990630370,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25183",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/885759061/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-05-31T15:12:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/885759061",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   }
]
