[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19145 (Add hash_type MUHASH for gettxoutsetinfo by fjahr)\n* #19055 (Add MuHash3072 implementation by fjahr)\n* #18014 (lib: Optimizing siphash implementation by elichai)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-08-31T14:47:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19845#issuecomment-683826463",
      "id" : 683826463,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19845",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4MzgyNjQ2Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-02T17:38:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/683826463",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "If https://github.com/bitcoin/bitcoin/pull/19503 gets merged then it could be used to configure the stream to (un)ser in V2 format instead of the currently used `ADDRV2_FORMAT` flag that is ORed into the stream version.",
      "created_at" : "2020-09-01T10:25:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19845#issuecomment-684742011",
      "id" : 684742011,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19845",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NDc0MjAxMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-01T10:25:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/684742011",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. First read-through looks promising and happy to see the additional unit test coverage. \r\n\r\nEdit: noting here for myself that local debug build is clean and unit tests are green.",
      "created_at" : "2020-09-01T13:46:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19845#issuecomment-684865867",
      "id" : 684865867,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19845",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NDg2NTg2Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-01T14:43:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/684865867",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This PR now contains #19841, needed for the `SHA3_256` implementation.",
      "created_at" : "2020-09-02T08:03:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19845#issuecomment-685427804",
      "id" : 685427804,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19845",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NTQyNzgwNA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-02T08:03:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/685427804",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Would it make sense to benchmark how fast addr2 messages are deserialized? Maybe we should even benchmark every message type?",
      "created_at" : "2020-09-05T13:03:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19845#issuecomment-687608367",
      "id" : 687608367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19845",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4NzYwODM2Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-05T13:03:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/687608367",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Would it make sense to benchmark how fast addr2 messages are deserialized? Maybe we should even benchmark every message type?\r\n\r\n<details>\r\n<summary>benchmark</summary>\r\n\r\n```diff\r\ndiff --git i/src/bench/addrman.cpp w/src/bench/addrman.cpp\r\nindex ebdad5a4b..db6b1c9fa 100644\r\n--- i/src/bench/addrman.cpp\r\n+++ w/src/bench/addrman.cpp\r\n@@ -1,20 +1,24 @@\r\n // Copyright (c) 2020-2020 The Bitcoin Core developers\r\n // Distributed under the MIT software license, see the accompanying\r\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\r\n \r\n #include <addrman.h>\r\n #include <bench/bench.h>\r\n+#include <netaddress.h>\r\n #include <random.h>\r\n+#include <serialize.h>\r\n+#include <streams.h>\r\n #include <util/time.h>\r\n+#include <version.h>\r\n \r\n #include <vector>\r\n \r\n /* A \"source\" is a source address from which we have received a bunch of other addresses. */\r\n \r\n-static constexpr size_t NUM_SOURCES = 64;\r\n+static constexpr size_t NUM_SOURCES = 1000;\r\n static constexpr size_t NUM_ADDRESSES_PER_SOURCE = 256;\r\n \r\n static std::vector<CAddress> g_sources;\r\n static std::vector<std::vector<CAddress>> g_addresses;\r\n \r\n static void CreateAddresses()\r\n@@ -135,6 +139,36 @@ static void AddrManGood(benchmark::Bench& bench)\r\n }\r\n \r\n BENCHMARK(AddrManAdd);\r\n BENCHMARK(AddrManSelect);\r\n BENCHMARK(AddrManGetAddr);\r\n BENCHMARK(AddrManGood);\r\n+\r\n+static void AddressUnser(benchmark::Bench& bench, int add_to_version)\r\n+{\r\n+    CreateAddresses();\r\n+\r\n+    CDataStream s_orig(SER_NETWORK, PROTOCOL_VERSION | add_to_version);\r\n+    s_orig << g_sources;\r\n+\r\n+    bench.run([&] {\r\n+        CDataStream s(s_orig);\r\n+\r\n+        std::vector<CAddress> unserialized;\r\n+        s >> unserialized;\r\n+\r\n+        assert(s.empty());\r\n+    });\r\n+}\r\n+\r\n+static void AddressUnserV1(benchmark::Bench& bench)\r\n+{\r\n+    AddressUnser(bench, 0);\r\n+}\r\n+\r\n+static void AddressUnserV2(benchmark::Bench& bench)\r\n+{\r\n+    AddressUnser(bench, ADDRV2_FORMAT);\r\n+}\r\n+\r\n+BENCHMARK(AddressUnserV1);\r\n+BENCHMARK(AddressUnserV2);\r\n```\r\n</details>\r\n\r\nResults (one operation is \"unserialize 1000 addresses\"):\r\n```\r\n$ ./src/bench/bench_bitcoin -filter=\"AddressUnser.*\"\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|           39,362.00 |           25,405.21 |    0.3% |      0.00 | `AddressUnserV1`\r\n|           49,457.00 |           20,219.58 |    0.0% |      0.00 | `AddressUnserV2`\r\n```\r\n\r\nUnserialize in V2 is expected to be somewhat slower and it is indeed. Looks ok to me.",
      "created_at" : "2020-09-07T13:38:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19845#issuecomment-688332202",
      "id" : 688332202,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19845",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODMzMjIwMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-07T13:38:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688332202",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased now that the SHA3_256 implementation is in `master`.",
      "created_at" : "2020-09-10T18:45:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19845#issuecomment-690614950",
      "id" : 690614950,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19845",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY5MDYxNDk1MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-10T18:45:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/690614950",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19845#discussion_r486669845"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19845"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486669845"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Just a nit, feel free to leave as is.\r\n\r\nNo real reason why this needs to be in netaddress.h or restricted to `CNetAddr`. Maybe it can move to one of the util/*.h files or even a new one. It's probably useful elsewhere.",
      "commit_id" : "9eb5b089c5852ba569fc879786b3b01be7596273",
      "created_at" : "2020-09-10T22:32:17Z",
      "diff_hunk" : "@@ -192,6 +192,17 @@ class CNetAddr\n         friend class CSubNet;\n \n     private:\n+        /**\n+         * Check whether a container begins with the given prefix.\n+         */\n+        template <typename T1, size_t PREFIX_LEN>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19845#discussion_r486669845",
      "id" : 486669845,
      "line" : 237,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY2OTg0NQ==",
      "original_commit_id" : "e57bedde3199a36ef558e1b8bd6e9278ad9b72ec",
      "original_line" : 198,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 101,
      "pull_request_review_id" : 486355793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19845",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T23:02:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486669845",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19845#discussion_r486671228"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19845"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486671228"
         }
      },
      "author_association" : "MEMBER",
      "body" : "That's not technically true; EOF can be reached in ADDRv1 mode.\r\n\r\nI don't think this comment adds much; every deserializer can always fail.",
      "commit_id" : "9eb5b089c5852ba569fc879786b3b01be7596273",
      "created_at" : "2020-09-10T22:35:57Z",
      "diff_hunk" : "@@ -177,16 +188,27 @@ class CNetAddr\n         template <typename Stream>\n         void Serialize(Stream& s) const\n         {\n-            SerializeV1Stream(s);\n+            if (s.GetVersion() & ADDRV2_FORMAT) {\n+                SerializeV2Stream(s);\n+            } else {\n+                SerializeV1Stream(s);\n+            }\n         }\n \n         /**\n          * Unserialize from a stream.\n+         * @throws std::ios_base::failure if the stream is in ADDRv2 format and\n+         * the data is invalid and cannot be unserialized; ADDRv1 format",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19845#discussion_r486671228",
      "id" : 486671228,
      "line" : 218,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MTIyOA==",
      "original_commit_id" : "c73ea45e12d42a3a79bc4610d98f731465e4327e",
      "original_line" : 201,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 81,
      "pull_request_review_id" : 486355793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19845",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T23:02:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486671228",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19845#discussion_r486672929"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19845"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486672929"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: you're using both \"Bip155\" and \"BIP155\" is this commit. I prefer \"BIP155\".",
      "commit_id" : "9eb5b089c5852ba569fc879786b3b01be7596273",
      "created_at" : "2020-09-10T22:40:32Z",
      "diff_hunk" : "@@ -203,11 +225,41 @@ class CNetAddr\n                    std::equal(std::begin(prefix), std::end(prefix), std::begin(obj));\n         }\n \n+        /**\n+         * BIP155 network ids recognized by this software.\n+         */\n+        enum Bip155Network : uint8_t {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19845#discussion_r486672929",
      "id" : 486672929,
      "line" : 248,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3MjkyOQ==",
      "original_commit_id" : "c73ea45e12d42a3a79bc4610d98f731465e4327e",
      "original_line" : 231,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/netaddress.h",
      "position" : 112,
      "pull_request_review_id" : 486355793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19845",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T23:02:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486672929",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19845#discussion_r486674423"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19845"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486674423"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Comment is wrong here, I think (I2P, not TORv2).",
      "commit_id" : "9eb5b089c5852ba569fc879786b3b01be7596273",
      "created_at" : "2020-09-10T22:44:46Z",
      "diff_hunk" : "@@ -400,6 +400,70 @@ BOOST_AUTO_TEST_CASE(cnetaddr_unserialize_v2)\n     BOOST_REQUIRE(!s.empty()); // The stream is not consumed on invalid input.\n     s.clear();\n \n+    // Valid TORv3.\n+    s << MakeSpan(ParseHex(\"04\"                               // network type (TORv3)\n+                           \"20\"                               // address length\n+                           \"79bcc625184b05194975c28b66b66b04\" // address\n+                           \"69f7f6556fb1ac3189a79b40dda32f1f\"\n+                           ));\n+    s >> addr;\n+    BOOST_CHECK(addr.IsValid());\n+    BOOST_CHECK(addr.IsTor());\n+    BOOST_CHECK_EQUAL(addr.ToString(),\n+                      \"pg6mmjiyjmcrsslvykfwnntlaru7p5svn6y2ymmju6nubxndf4pscryd.onion\");\n+    BOOST_REQUIRE(s.empty());\n+\n+    // Invalid TORv3, with bogus length.\n+    s << MakeSpan(ParseHex(\"04\" // network type (TORv2)\n+                           \"00\" // address length\n+                           \"00\" // address\n+                           ));\n+    BOOST_CHECK_EXCEPTION(s >> addr, std::ios_base::failure,\n+                          HasReason(\"BIP155 TORv3 address with length 0 (should be 32)\"));\n+    BOOST_REQUIRE(!s.empty()); // The stream is not consumed on invalid input.\n+    s.clear();\n+\n+    // Valid I2P.\n+    s << MakeSpan(ParseHex(\"05\"                               // network type (I2P)\n+                           \"20\"                               // address length\n+                           \"a2894dabaec08c0051a481a6dac88b64\" // address\n+                           \"f98232ae42d4b6fd2fa81952dfe36a87\"));\n+    s >> addr;\n+    BOOST_CHECK(addr.IsValid());\n+    BOOST_CHECK_EQUAL(addr.ToString(),\n+                      \"ukeu3k5oycgaauneqgtnvselmt4yemvoilkln7jpvamvfx7dnkdq.b32.i2p\");\n+    BOOST_REQUIRE(s.empty());\n+\n+    // Invalid I2P, with bogus length.\n+    s << MakeSpan(ParseHex(\"05\" // network type (TORv2)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19845#discussion_r486674423",
      "id" : 486674423,
      "line" : 438,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NjY3NDQyMw==",
      "original_commit_id" : "9eb5b089c5852ba569fc879786b3b01be7596273",
      "original_line" : 438,
      "original_position" : 39,
      "original_start_line" : null,
      "path" : "src/test/net_tests.cpp",
      "position" : 193,
      "pull_request_review_id" : 486355793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19845",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-10T23:02:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/486674423",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
