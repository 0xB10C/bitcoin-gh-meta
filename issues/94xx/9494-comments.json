[
   {
      "body" : "Concept ACK. I think we had discussed doing this when #9243 went in.\n\nOn January 9, 2017 11:02:04 AM EST, \"Jorge TimÃÂ³n\" <notifications@github.com> wrote:\n>Continues #9243 by @TheBlueMatt \n>Introduce an ArgsManager class encapsulating cs_args, mapArgs  and\n>mapMultiArgs.\n>\n>To reduce disruption, the used functions are kept as wrapers. The\n>wrapers can be removed later, see\n>https://github.com/jtimon/bitcoin/compare/0.13-args-class...jtimon:0.13-args-remove-wrapers\n>for the less disruptive ones to remove.\n>\n>You can view, comment on, or merge this pull request online at:\n>\n>  https://github.com/bitcoin/bitcoin/pull/9494\n>\n>-- Commit Summary --\n>\n>  * Util: Create ArgsManager class\n>  * Util: Expose ArgsManager argsGlobal\n>  * Util: s/mapMultiArgs.count(/argsGlobal.IsArgSet(/\n>  * Util: Introduce ArgsManager::ArgsAt()\n>  * Util: Put mapMultiArgs inside ArgsManager\n>\n>-- File Changes --\n>\n>    M src/httprpc.cpp (4)\n>    M src/httpserver.cpp (8)\n>    M src/init.cpp (48)\n>    M src/net.cpp (10)\n>    M src/test/util_tests.cpp (77)\n>    M src/util.cpp (83)\n>    M src/util.h (28)\n>\n>-- Patch Links --\n>\n>https://github.com/bitcoin/bitcoin/pull/9494.patch\n>https://github.com/bitcoin/bitcoin/pull/9494.diff\n>\n>-- \n>You are receiving this because you were mentioned.\n>Reply to this email directly or view it on GitHub:\n>https://github.com/bitcoin/bitcoin/pull/9494\n",
      "created_at" : "2017-01-09T20:35:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9494#issuecomment-271399944",
      "id" : 271399944,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9494",
      "updated_at" : "2017-01-09T20:35:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271399944",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "body" : "Yes, we discussed it in #9243, but that this seems approximately what was discussed previously is still very useful, thanks.\r\n\r\nWhat concerns me more of the current code is the fact that the methods IsArgSet, GetArg, GetBoolArg and  ArgsAt aren't const, because they need to ```LOCK(cs_args);```. The first \"solution\" that comes to mind is to make a superclass with just these methods (but they remain non-const).\r\n",
      "created_at" : "2017-01-09T22:47:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9494#issuecomment-271432546",
      "id" : 271432546,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9494",
      "updated_at" : "2017-01-09T22:47:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271432546",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "concept ACK :+1: , will review again when able, once-over utACK 8a96939\r\n",
      "created_at" : "2017-01-11T06:50:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9494#issuecomment-271792379",
      "id" : 271792379,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9494",
      "updated_at" : "2017-01-11T06:51:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271792379",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9494#discussion_r95578281"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9494"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95578281"
         }
      },
      "body" : "I assume this should get LOCK(cs_args); too? If so, the method can't be const.",
      "commit_id" : "6086a8439ccd3d0a585f0085622d09436b8fb27f",
      "created_at" : "2017-01-11T13:34:20Z",
      "diff_hunk" : "@@ -377,41 +373,46 @@ void ParseParameters(int argc, const char* const argv[])\n         InterpretNegativeSetting(str, strValue);\n \n         mapArgs[str] = strValue;\n-        _mapMultiArgs[str].push_back(strValue);\n+        mapMultiArgs[str].push_back(strValue);\n     }\n }\n \n-bool IsArgSet(const std::string& strArg)\n+const std::vector<std::string>& ArgsManager::ArgsAt(const std::string& strArg) const\n+{\n+    return mapMultiArgs.at(strArg);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9494#discussion_r95578281",
      "id" : 95578281,
      "original_commit_id" : "8a96939c1690172c0b45f6e0e78303d74c68ea7a",
      "original_position" : 57,
      "path" : "src/util.cpp",
      "position" : 57,
      "pull_request_review_id" : 16137178,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9494",
      "updated_at" : "2017-01-31T21:37:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95578281",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   },
   {
      "body" : "Needed rebase.",
      "created_at" : "2017-01-31T21:38:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9494#issuecomment-276500900",
      "id" : 276500900,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9494",
      "updated_at" : "2017-01-31T21:38:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/276500900",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1008458?v=3",
         "events_url" : "https://api.github.com/users/jtimon/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jtimon/followers",
         "following_url" : "https://api.github.com/users/jtimon/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jtimon/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jtimon",
         "id" : 1008458,
         "login" : "jtimon",
         "organizations_url" : "https://api.github.com/users/jtimon/orgs",
         "received_events_url" : "https://api.github.com/users/jtimon/received_events",
         "repos_url" : "https://api.github.com/users/jtimon/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jtimon/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jtimon"
      }
   }
]
