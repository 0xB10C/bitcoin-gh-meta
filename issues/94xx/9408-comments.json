[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9408#discussion_r93705542"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9408"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93705542"
         }
      },
      "body" : "I think this is a bit overkill. `bool` is there already. And returning `true` only in case of successful `mempool.dat` load is enough. The only question is what to return in case of corrupted `mempool.dat`. Returning `true` instead of `false` makes sense here. And when `true` is returned, dump mempool at shutdown.\r\n",
      "commit_id" : "66fcca9ad312d0c85c8e2eae390a72ba68c2ba9f",
      "created_at" : "2016-12-22T22:19:03Z",
      "diff_hunk" : "@@ -557,7 +557,14 @@ static const unsigned int REJECT_CONFLICT = 0x102;\n /** Dump the mempool to disk. */\n void DumpMempool();\n \n+/** Result states for loading the mempool from disk */\n+enum LoadMempoolResult {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9408#discussion_r93705542",
      "id" : 93705542,
      "original_commit_id" : "66fcca9ad312d0c85c8e2eae390a72ba68c2ba9f",
      "original_position" : 5,
      "path" : "src/validation.h",
      "position" : 5,
      "pull_request_review_id" : 14239767,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9408",
      "updated_at" : "2016-12-22T22:19:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93705542",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9408#discussion_r93737243"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9408"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93737243"
         }
      },
      "body" : "IMO a simple `true|false` would not work. You need to distinct between...\r\n* not yet loaded = don't dump during shutdown\r\n* user_aborted (shutdown) = don't dump during shutdown\r\n* failed = dump during shutdown\r\n* successful = dump during shutdown\r\n\r\nReturning `false` in case of a user-triggered shutdown could work, but then you would need to return `true` in case of an input error (somehow not good).",
      "commit_id" : "66fcca9ad312d0c85c8e2eae390a72ba68c2ba9f",
      "created_at" : "2016-12-23T07:50:47Z",
      "diff_hunk" : "@@ -557,7 +557,14 @@ static const unsigned int REJECT_CONFLICT = 0x102;\n /** Dump the mempool to disk. */\n void DumpMempool();\n \n+/** Result states for loading the mempool from disk */\n+enum LoadMempoolResult {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9408#discussion_r93737243",
      "id" : 93737243,
      "original_commit_id" : "66fcca9ad312d0c85c8e2eae390a72ba68c2ba9f",
      "original_position" : 5,
      "path" : "src/validation.h",
      "position" : 5,
      "pull_request_review_id" : 14270749,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9408",
      "updated_at" : "2016-12-23T07:50:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93737243",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/9408#discussion_r93755735"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9408"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93755735"
         }
      },
      "body" : "If user aborts at T=5, and doesn't shut down the node, when it *does* finally shutdown at T=5000, you would want to dump it. This isn't possible, but the enum name doesn't make that clear. So a simply two-value enum with DoNotSave vs PleaseSave might be best?",
      "commit_id" : "66fcca9ad312d0c85c8e2eae390a72ba68c2ba9f",
      "created_at" : "2016-12-23T11:28:40Z",
      "diff_hunk" : "@@ -557,7 +557,14 @@ static const unsigned int REJECT_CONFLICT = 0x102;\n /** Dump the mempool to disk. */\n void DumpMempool();\n \n+/** Result states for loading the mempool from disk */\n+enum LoadMempoolResult {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9408#discussion_r93755735",
      "id" : 93755735,
      "original_commit_id" : "66fcca9ad312d0c85c8e2eae390a72ba68c2ba9f",
      "original_position" : 5,
      "path" : "src/validation.h",
      "position" : 5,
      "pull_request_review_id" : 14290242,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/9408",
      "updated_at" : "2016-12-23T11:28:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93755735",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "@luke-jr Two value enum aka bool? ;-)",
      "created_at" : "2016-12-23T11:32:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9408#issuecomment-268977281",
      "id" : 268977281,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9408",
      "updated_at" : "2016-12-23T11:32:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268977281",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "I might be missing something here but imo it is intentional to always dump the full mempool. In case the user feels it is taking too long (to load the mempool) on their hardware, they can switch to a smaller mempool with `-maxmempool=`?",
      "created_at" : "2016-12-23T11:34:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9408#issuecomment-268977487",
      "id" : 268977487,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9408",
      "updated_at" : "2016-12-23T11:34:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268977487",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "@MarcoFalke Imagine `mempool.dat` containing 300M of txs. User quits in the middle of loading it from the file. The mempool now contains ~150M of txs from the .dat file and some more txs from the network... What to do now?",
      "created_at" : "2016-12-23T11:40:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9408#issuecomment-268978096",
      "id" : 268978096,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9408",
      "updated_at" : "2016-12-23T11:40:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268978096",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   }
]
