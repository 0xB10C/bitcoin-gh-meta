[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#17373](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17373.html) (wallet: Various fixes and cleanup to keypool handling in LegacyScriptPubKeyMan and CWallet by achow101)\n* [#17371](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17371.html) (Refactor: Require scriptPubKey to get wallet SigningProvider by achow101)\n* [#17261](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17261.html) (Make ScriptPubKeyMan an actual interface and the wallet to have multiple by achow101)\n* [#16910](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16910.html) (wallet: reduce loading time by using unordered maps by achow101)\n* [#16528](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16528.html) ([WIP] Native Descriptor Wallets (take 2) by achow101)\n* [#15931](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15931.html) (Remove GetDepthInMainChain dependency on locked chain interface by ariard)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-11-04T23:29:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17369#issuecomment-549594649",
      "id" : 549594649,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17369",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0OTU5NDY0OQ==",
      "updated_at" : "2019-11-04T23:29:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549594649",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17369#discussion_r343874412"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17369"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/343874412"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Refactor: Move encryption code between KeyMan and Wallet\" (d96925bde5c103693e44787503dc3e45d1248da8)\r\n\r\nWould be great if this check and the same check in `LegacyScriptPubKeyMan::AddCryptedKeyInner` could be made into asserts or `CHECK_NONFATAL`'s, because it seems like something would have to be very wrong for these to trigger. Or it would be helpful to have a comment saying when this is expected, if it is ever expected.",
      "commit_id" : "d96925bde5c103693e44787503dc3e45d1248da8",
      "created_at" : "2019-11-07T21:06:32Z",
      "diff_hunk" : "@@ -202,11 +202,11 @@ isminetype LegacyScriptPubKeyMan::IsMine(const CScript& script) const\n     assert(false);\n }\n \n-bool CWallet::Unlock(const CKeyingMaterial& vMasterKeyIn, bool accept_no_keys)\n+bool LegacyScriptPubKeyMan::CheckDecryptionKey(const CKeyingMaterial& master_key, bool accept_no_keys)\n {\n     {\n         LOCK(cs_KeyStore);\n-        if (!SetCrypted())\n+        if (!mapKeys.empty())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17369#discussion_r343874412",
      "id" : 343874412,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Mzg3NDQxMg==",
      "original_commit_id" : "d96925bde5c103693e44787503dc3e45d1248da8",
      "original_position" : 10,
      "path" : "src/wallet/scriptpubkeyman.cpp",
      "position" : 10,
      "pull_request_review_id" : 313636620,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17369",
      "updated_at" : "2019-11-07T21:37:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/343874412",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17369#discussion_r343887547"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17369"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/343887547"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Refactor: Move encryption code between KeyMan and Wallet\" (d96925bde5c103693e44787503dc3e45d1248da8)\r\n\r\nNote: Future cleanup could delete this method and just have callers call `HasEncryptionKeys()` directly instead.",
      "commit_id" : "d96925bde5c103693e44787503dc3e45d1248da8",
      "created_at" : "2019-11-07T21:37:18Z",
      "diff_hunk" : "@@ -732,11 +723,9 @@ class CWallet final : public WalletStorage, private interfaces::Chain::Notificat\n     {\n         // Should not have slots connected at this point.\n         assert(NotifyUnload.empty());\n-        delete encrypted_batch;\n-        encrypted_batch = nullptr;\n     }\n \n-    bool IsCrypted() const { return fUseCrypto; }\n+    bool IsCrypted() const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17369#discussion_r343887547",
      "id" : 343887547,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Mzg4NzU0Nw==",
      "original_commit_id" : "d96925bde5c103693e44787503dc3e45d1248da8",
      "original_position" : 35,
      "path" : "src/wallet/wallet.h",
      "position" : 35,
      "pull_request_review_id" : 313636620,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17369",
      "updated_at" : "2019-11-07T21:38:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/343887547",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
