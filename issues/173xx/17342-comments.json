[
   {
      "author_association" : "MEMBER",
      "body" : "ACK 6775a18cab043af0a9ea69a364804d6d75faf939 -- agree regarding the confusion",
      "created_at" : "2019-11-01T16:01:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17342#issuecomment-548843989",
      "id" : 548843989,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17342",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0ODg0Mzk4OQ==",
      "updated_at" : "2019-11-01T16:01:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/548843989",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think it would be much more straightforward if 0 (anything smaller than 1) was the disallowed value, not 1.\r\n\r\nEither that, or make the meaning *the number of additional threads spawned*, which can be 0.\r\n\r\n(Not that I disagree on adding documentation, but maybe it would be better to make this code less confusing instead, there is no deeper reason why it needs to be like this, the value isn't even exposed on the RPC interface)",
      "created_at" : "2019-11-02T12:23:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17342#issuecomment-549038996",
      "id" : 549038996,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17342",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0OTAzODk5Ng==",
      "updated_at" : "2019-11-02T13:50:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549038996",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj \r\n> I think it would be much more straightforward if...\r\n\r\nTurns out that a global int is not needed at all. We only need the bool-ness of whether any script checking threads have been spawned. I have a branch here: https://github.com/jnewbery/bitcoin/tree/2019-11-nScriptCheckThreads2 that changes the int for a bool, improves commenting everywhere and makes the code clearer.\r\n\r\nI fear it'd be NACKed by the \"don't change code for purely cosmetic reasons\" crowd, but if you prefer it, let me know.",
      "created_at" : "2019-11-02T21:29:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17342#issuecomment-549082906",
      "id" : 549082906,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17342",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0OTA4MjkwNg==",
      "updated_at" : "2019-11-02T21:29:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549082906",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jnewbery FWIW the other branch LGTM.\r\n\r\n> I fear it'd be NACKed by the \"don't change code for purely cosmetic reasons\" crowd\r\n\r\nIt's not cosmetic, it's a good refactor IMO.",
      "created_at" : "2019-11-03T21:48:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17342#issuecomment-549182440",
      "id" : 549182440,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17342",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0OTE4MjQ0MA==",
      "updated_at" : "2019-11-03T21:51:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549182440",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Refactor LGTM, we've both been in the group of people that were confused by this code at some point.\r\n\r\n> Turns out that a global int is not needed at all. We only need the bool-ness of whether any script checking threads have been spawned.\r\n\r\nWonder if we can take this a step further and not have any global at all, passing the flag into the ChainState constructor instead.",
      "created_at" : "2019-11-04T14:31:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17342#issuecomment-549380178",
      "id" : 549380178,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17342",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0OTM4MDE3OA==",
      "updated_at" : "2019-11-04T14:31:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549380178",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the feedback everyone. I've changed this PR so it now refactors `nScriptCheckThreads` and adds clarifying comments.\r\n\r\n> Wonder if we can take this a step further and not have any global at all, passing the flag into the ChainState constructor instead.\r\n\r\nYes, it'd be great to remove more globals and make validation initialization take these as arguments, but I think that's too far to go in this PR.",
      "created_at" : "2019-11-04T18:53:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17342#issuecomment-549495553",
      "id" : 549495553,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17342",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0OTQ5NTU1Mw==",
      "updated_at" : "2019-11-04T18:53:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549495553",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Tested that number of script threads started is the same before and after this PR:\r\n\r\n(`bitcoind-pre17342` is a bitcoind compiled from commit bc3fcf3c0d1d4c83da0fab14d40f92ffca35789e in master and `bitcoind-post17342` is a bitcoind compiled from this branch)\r\n\r\n```\r\nfor par in {-4..17}; do echo par=$par; ./bitcoind-pre17342 -par=$par && sleep 2 && bitcoin-cli stop && grep \"Script verification\" .bitcoin/regtest/debug.log && rm .bitcoin/regtest/debug.log && sleep 1; ./bitcoind-post17342 -par=$par && sleep 2 && bitcoin-cli stop && grep \"Script verification\" .bitcoin/regtest/debug.log && rm .bitcoin/regtest/debug.log && sleep 1;done\r\npar=-4\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:30:57Z Script verification uses 0 additional threads\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:00Z Script verification uses 0 additional threads\r\npar=-3\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:03Z Script verification uses 0 additional threads\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:06Z Script verification uses 0 additional threads\r\npar=-2\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:10Z Script verification uses 1 additional threads\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:13Z Script verification uses 1 additional threads\r\npar=-1\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:16Z Script verification uses 2 additional threads\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:19Z Script verification uses 2 additional threads\r\npar=0\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:22Z Script verification uses 3 additional threads\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:26Z Script verification uses 3 additional threads\r\npar=1\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:29Z Script verification uses 0 additional threads\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:32Z Script verification uses 0 additional threads\r\npar=2\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:35Z Script verification uses 1 additional threads\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:31:38Z Script verification uses 1 additional threads\r\n[...]\r\nar=15\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:32:58Z Script verification uses 14 additional threads\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:33:01Z Script verification uses 14 additional threads\r\npar=16\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:33:04Z Script verification uses 15 additional threads\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:33:07Z Script verification uses 15 additional threads\r\npar=17\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:33:11Z Script verification uses 15 additional threads\r\nBitcoin Core starting\r\nBitcoin Core stopping\r\n2019-11-04T19:33:14Z Script verification uses 15 additional threads\r\n\r\n```",
      "created_at" : "2019-11-04T19:36:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17342#issuecomment-549512834",
      "id" : 549512834,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17342",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0OTUxMjgzNA==",
      "updated_at" : "2019-11-04T19:36:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549512834",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16658](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16658.html) (validation: Rename CheckInputs to CheckInputScripts by jnewbery)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-11-04T23:44:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17342#issuecomment-549598299",
      "id" : 549598299,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17342",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU0OTU5ODI5OQ==",
      "updated_at" : "2019-11-04T23:44:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549598299",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
