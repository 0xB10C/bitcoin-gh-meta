[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#17396](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17396.html) (build: modest Android improvements by icota)\n* [#17376](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17376.html) (Add Parallel P2P Client in Rust by TheBlueMatt)\n* [#17227](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17227.html) (Qt: Add Android packaging support by icota)\n* [#16834](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16834.html) (Fetch Headers over DNS by TheBlueMatt)\n* [#16762](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16762.html) (Rust-based Backup over-REST block downloader by TheBlueMatt)\n* [#15704](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15704.html) (Move Win32 defines to configure.ac to ensure they are globally defined by luke-jr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-11-06T23:51:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17398#issuecomment-550554380",
      "id" : 550554380,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17398",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MDU1NDM4MA==",
      "updated_at" : "2019-11-07T14:47:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/550554380",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "OK, travis build should pass now\r\n\r\nTesting notes:\r\n\r\n- [x] check that `HAVE_FULLFSYNC=1` is passed on MacOS (done, `checking for F_FULLFSYNC... yes` appears in both MacOS builds)\r\n- [x] check that crc32c is correctly integrated\r\n  - [x] ARM64 (checked `crc32c::ExtendArm64` in `libcrc32c_arm_crc.a` is invoked and contains the correct asm instructions)\r\n   - [x] x86_64 (checked `crc32c::ExtendSse42` in `libcrc32c_sse42.a` is invoked and contains the correct asm instructions)\r\n- [ ] test on BSD variants\r\n  - [x] FreeBSD 12.0 build succesful\r\n  - [ ] OpenBSD\r\n- [ ] test on Windows (full sync, as well as catching up an existing node)\r\n- [ ] [verify file descriptor use](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#upgrading-leveldb)\r\n- [ ] check sync performance before an after on different OS and hardware\r\n- [ ] test forward and backward compatibility of UTXO and block database",
      "created_at" : "2019-11-07T11:53:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17398#issuecomment-551048478",
      "id" : 551048478,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17398",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MTA0ODQ3OA==",
      "updated_at" : "2019-11-08T01:25:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/551048478",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK for the new branch. it's really nice that we can again easily see the diff from upstream.\r\nhttps://github.com/google/leveldb/compare/master...bitcoin-core:bitcoin-fork-new\r\n\r\nWill try to read later the (reported) changes upstream leveldb did in the past ~160 commits.",
      "created_at" : "2019-11-07T13:20:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17398#issuecomment-551075809",
      "id" : 551075809,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17398",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MTA3NTgwOQ==",
      "updated_at" : "2019-11-07T13:20:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/551075809",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2167860?v=4",
         "events_url" : "https://api.github.com/users/elichai/events{/privacy}",
         "followers_url" : "https://api.github.com/users/elichai/followers",
         "following_url" : "https://api.github.com/users/elichai/following{/other_user}",
         "gists_url" : "https://api.github.com/users/elichai/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/elichai",
         "id" : 2167860,
         "login" : "elichai",
         "node_id" : "MDQ6VXNlcjIxNjc4NjA=",
         "organizations_url" : "https://api.github.com/users/elichai/orgs",
         "received_events_url" : "https://api.github.com/users/elichai/received_events",
         "repos_url" : "https://api.github.com/users/elichai/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/elichai/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/elichai/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/elichai"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Regarding the msvc build I didn't have any problems getting it to build after applying what I think are the relevant changes to the `libleveldb` project.\r\n\r\nI do get two new warnings:\r\n\r\n````\r\nSeverity\tCode\tDescription\tProject\tFile\tLine\tSuppression State\tSuppression State\r\nWarning\tC26110\tCaller failing to hold lock 'this->mu_' before calling function 'std::_Mutex_base::unlock'.\tlibleveldb\tC:\\DEV\\GITHUB\\SIPSORCERY_BITCOIN\\SRC\\LEVELDB\\PORT\\PORT_STDCXX.H\t58\t\t\r\nSeverity\tCode\tDescription\tProject\tFile\tLine\tSuppression State\tSuppression State\r\nWarning\tC26110\tCaller failing to hold lock 'this->mu_->mu_' before calling function 'std::unique_lock<std::mutex>::unique_lock<std::mutex>'.\tlibleveldb\tC:\\DEV\\GITHUB\\SIPSORCERY_BITCOIN\\SRC\\LEVELDB\\PORT\\PORT_STDCXX.H\t76\t\t\r\n````\r\n\r\nAre any of the preprocessor defines below relevant for Windows?\r\n\r\n````\r\nLEVELDB_CPPFLAGS_INT += -DHAVE_FDATASYNC=@HAVE_FDATASYNC@\r\nLEVELDB_CPPFLAGS_INT += -DHAVE_FULLFSYNC=@HAVE_FULLFSYNC@\r\nLEVELDB_CPPFLAGS_INT += -DHAVE_O_CLOEXEC=@HAVE_O_CLOEXEC@\r\n````\r\n\r\nIn case it's of any use the diff for `libleveldb.vcxproj` is:\r\n\r\n````\r\ndiff --git a/build_msvc/libleveldb/libleveldb.vcxproj b/build_msvc/libleveldb/libleveldb.vcxproj\r\nindex f855923c6..ba6a86fdc 100644\r\n--- a/build_msvc/libleveldb/libleveldb.vcxproj\r\n+++ b/build_msvc/libleveldb/libleveldb.vcxproj\r\n@@ -24,8 +24,6 @@\r\n     <ClCompile Include=\"..\\..\\src\\leveldb\\db\\version_set.cc\" />\r\n     <ClCompile Include=\"..\\..\\src\\leveldb\\db\\write_batch.cc\" />\r\n     <ClCompile Include=\"..\\..\\src\\leveldb\\helpers\\memenv\\memenv.cc\" />\r\n-    <ClCompile Include=\"..\\..\\src\\leveldb\\port\\port_posix_sse.cc\" />\r\n-    <ClCompile Include=\"..\\..\\src\\leveldb\\port\\port_win.cc\" />\r\n     <ClCompile Include=\"..\\..\\src\\leveldb\\table\\block.cc\" />\r\n     <ClCompile Include=\"..\\..\\src\\leveldb\\table\\block_builder.cc\" />\r\n     <ClCompile Include=\"..\\..\\src\\leveldb\\table\\filter_block.cc\" />\r\n@@ -42,7 +40,7 @@\r\n     <ClCompile Include=\"..\\..\\src\\leveldb\\util\\comparator.cc\" />\r\n     <ClCompile Include=\"..\\..\\src\\leveldb\\util\\crc32c.cc\" />\r\n     <ClCompile Include=\"..\\..\\src\\leveldb\\util\\env.cc\" />\r\n-    <ClCompile Include=\"..\\..\\src\\leveldb\\util\\env_win.cc\" />\r\n+    <ClCompile Include=\"..\\..\\src\\leveldb\\util\\env_windows.cc\" />\r\n     <ClCompile Include=\"..\\..\\src\\leveldb\\util\\filter_policy.cc\" />\r\n     <ClCompile Include=\"..\\..\\src\\leveldb\\util\\hash.cc\" />\r\n     <ClCompile Include=\"..\\..\\src\\leveldb\\util\\histogram.cc\" />\r\n@@ -52,7 +50,7 @@\r\n   </ItemGroup>\r\n   <ItemDefinitionGroup>\r\n     <ClCompile>\r\n-        <PreprocessorDefinitions>_CRT_NONSTDC_NO_DEPRECATE;LEVELDB_PLATFORM_WINDOWS;LEVELDB_ATOMIC_PRESENT;%(PreprocessorDefinitions)</PreprocessorDefinitions>\r\n+        <PreprocessorDefinitions>HAVE_CRC32C=0;HAVE_SNAPPY=0;__STDC_LIMIT_MACROS;LEVELDB_IS_BIG_ENDIAN=0;_UNICODE;UNICODE;_CRT_NONSTDC_NO_DEPRECATE;LEVELDB_PLATFORM_WINDOWS;LEVELDB_ATOMIC_PRESENT;%(PreprocessorDefinitions)</PreprocessorDefinitions>\r\n         <DisableSpecificWarnings>4244;4267;4312;</DisableSpecificWarnings>\r\n         <AdditionalIncludeDirectories>..\\..\\src\\leveldb;..\\..\\src\\leveldb\\include;%(AdditionalIncludeDirectories)</AdditionalIncludeDirectories>\r\n        </ClCompile>\r\n````",
      "created_at" : "2019-11-07T17:59:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17398#issuecomment-551193954",
      "id" : 551193954,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17398",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MTE5Mzk1NA==",
      "updated_at" : "2019-11-07T17:59:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/551193954",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/197660?v=4",
         "events_url" : "https://api.github.com/users/sipsorcery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipsorcery/followers",
         "following_url" : "https://api.github.com/users/sipsorcery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipsorcery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipsorcery",
         "id" : 197660,
         "login" : "sipsorcery",
         "node_id" : "MDQ6VXNlcjE5NzY2MA==",
         "organizations_url" : "https://api.github.com/users/sipsorcery/orgs",
         "received_events_url" : "https://api.github.com/users/sipsorcery/received_events",
         "repos_url" : "https://api.github.com/users/sipsorcery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipsorcery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipsorcery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipsorcery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> In case it's of any use the diff for libleveldb.vcxproj is:\r\n\r\nThanks, I'll include that!\r\n\r\n> Are any of the preprocessor defines below relevant for Windows?\r\n\r\nI think they're only used in env_posix.cc? Yes, they are, so indeed they're irrelevant on windows.",
      "created_at" : "2019-11-07T20:36:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17398#issuecomment-551252823",
      "id" : 551252823,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17398",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MTI1MjgyMw==",
      "updated_at" : "2019-11-07T21:23:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/551252823",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "AppVeyor fails on some warning that is promoted to error, for an unreachable destructor.\r\n```\r\nC:\\projects\\bitcoin\\src\\leveldb\\util\\env_windows.cc(383): error C2220: the following warning is treated as an error [C:\\projects\\bitcoin\\build_msvc\\bitcoind\\bitcoind.vcxproj]\r\nC:\\projects\\bitcoin\\src\\leveldb\\util\\env_windows.cc(383): warning C4722: 'leveldb::`anonymous namespace'::WindowsEnv::~WindowsEnv': destructor never returns, potential memory leak [C:\\projects\\bitcoin\\build_msvc\\bitcoind\\bitcoind.vcxproj]\r\n```\r\nDid you need some flag changes too?",
      "created_at" : "2019-11-08T12:56:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17398#issuecomment-551748307",
      "id" : 551748307,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17398",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MTc0ODMwNw==",
      "updated_at" : "2019-11-08T12:56:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/551748307",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK - have not reviewed the changes yet. Only done some minimal does it compile + start running tests. Started testing going between leveldb versions on macOS.\r\n\r\n### macOS (fed6a9bd661321694b375dc393e8c0307042474f + depends):\r\n```bash\r\nchecking for fdatasync... no\r\nchecking for F_FULLFSYNC... yes\r\nchecking for O_CLOEXEC... yes\r\nchecking for __builtin_prefetch... yes\r\nchecking for _mm_prefetch... yes\r\nchecking for strong getauxval support in the system headers... no\r\nchecking for weak getauxval support in the compiler... yes\r\n....\r\nLevelDB using max_open_files=1000 (default=1000)\r\n```\r\n\r\n### openBSD 6.6 (fed6a9bd661321694b375dc393e8c0307042474f)\r\n```bash\r\nchecking for fdatasync... yes\r\nchecking for F_FULLFSYNC... no\r\nchecking for O_CLOEXEC... yes\r\nchecking for __builtin_prefetch... yes\r\nchecking for _mm_prefetch... yes\r\nchecking for strong getauxval support in the system headers... no\r\nchecking for weak getauxval support in the compiler... yes\r\n....\r\nLevelDB using max_open_files=1000 (default=1000)\r\n```\r\n\r\n### Windows 10 (WSL) (fed6a9bd661321694b375dc393e8c0307042474f + depends)\r\n```bash\r\nchecking for fdatasync... no\r\nchecking for F_FULLFSYNC... no\r\nchecking for O_CLOEXEC... no\r\nchecking for __builtin_prefetch... yes\r\nchecking for _mm_prefetch... yes\r\nchecking for strong getauxval support in the system headers... no\r\nchecking for weak getauxval support in the compiler... yes\r\n...\r\nLevelDB using max_open_files=1000 (default=1000)\r\n```",
      "created_at" : "2019-11-08T16:19:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17398#issuecomment-551892172",
      "id" : 551892172,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17398",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MTg5MjE3Mg==",
      "updated_at" : "2019-11-08T16:19:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/551892172",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   }
]
