[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14942](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14942.html) (wallet: Make scan / abort status private to CWallet by Empact)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-05-19T22:44:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16050#issuecomment-493798405",
      "id" : 493798405,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16050",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5Mzc5ODQwNQ==",
      "updated_at" : "2019-05-19T22:44:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/493798405",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285541385"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16050"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/285541385"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "suggested clarification\r\n```diff\r\n-            self.test_importmulti(updateexisting=True, count=11)\r\n+            self.test_importmulti(updateexisting=True, count=block_count+1)\r\n```",
      "commit_id" : "9c014295c8e3f83e68a69750add9542b7e80c1d0",
      "created_at" : "2019-05-20T11:19:09Z",
      "diff_hunk" : "@@ -66,6 +77,10 @@ def run_test(self):\n             txids_rpc = list(map(lambda t: t['txid'], self.nodes[1].listtransactions(\"*\", block_count)))\n             assert_equal(sorted(txids_rpc), sorted(os.listdir(self.walletnotify_dir)))\n \n+            self.log.info(\"test -walletnotify with importmulti\")\n+            self.test_importmulti(updateexisting=True, count=11)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285541385",
      "id" : 285541385,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4NTU0MTM4NQ==",
      "original_commit_id" : "9c014295c8e3f83e68a69750add9542b7e80c1d0",
      "original_position" : 30,
      "path" : "test/functional/feature_notifications.py",
      "position" : 30,
      "pull_request_review_id" : 239435248,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16050",
      "updated_at" : "2019-05-20T11:47:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/285541385",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285542417"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16050"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/285542417"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "logging suggestion\r\n```diff\r\n         self.nodes[0].generatetoaddress(1, addr)\r\n\r\n+        self.log.info('test -walletnotify with importmulti \"updateexisting\": {}'.format(updateexisting))\r\n         self.nodes[1].importmulti([{\"scriptPubKey\": {\"address\": addr}, \"timestamp\": \"now\"}], {\"updateexisting\": updateexisting})\r\n\r\n             assert_equal(sorted(txids_rpc), sorted(os.listdir(self.walletnotify_dir)))\r\n\r\n-            self.log.info(\"test -walletnotify with importmulti\")\r\n```",
      "commit_id" : "9c014295c8e3f83e68a69750add9542b7e80c1d0",
      "created_at" : "2019-05-20T11:22:45Z",
      "diff_hunk" : "@@ -32,6 +33,16 @@ def setup_network(self):\n                             \"-walletnotify=echo > {}\".format(os.path.join(self.walletnotify_dir, '%s'))]]\n         super().setup_network()\n \n+    def test_importmulti(self, updateexisting, count):\n+        shutil.rmtree(self.walletnotify_dir)\n+        os.mkdir(self.walletnotify_dir)\n+\n+        addr = self.nodes[0].getnewaddress()\n+        self.nodes[0].generatetoaddress(1, addr)\n+\n+        self.nodes[1].importmulti([{\"scriptPubKey\": {\"address\": addr}, \"timestamp\": \"now\"}], {\"updateexisting\": updateexisting})",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285542417",
      "id" : 285542417,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4NTU0MjQxNw==",
      "original_commit_id" : "9c014295c8e3f83e68a69750add9542b7e80c1d0",
      "original_position" : 19,
      "path" : "test/functional/feature_notifications.py",
      "position" : 19,
      "pull_request_review_id" : 239435248,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16050",
      "updated_at" : "2019-05-20T11:47:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/285542417",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285547015"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16050"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/285547015"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "and maybe the 1 in each `self.test_importmulti` call and inside the function with a `NEW_ADDRESSES_COUNT` constant. Ideally the number could vary randomly with each test run.",
      "commit_id" : "9c014295c8e3f83e68a69750add9542b7e80c1d0",
      "created_at" : "2019-05-20T11:36:57Z",
      "diff_hunk" : "@@ -66,6 +77,10 @@ def run_test(self):\n             txids_rpc = list(map(lambda t: t['txid'], self.nodes[1].listtransactions(\"*\", block_count)))\n             assert_equal(sorted(txids_rpc), sorted(os.listdir(self.walletnotify_dir)))\n \n+            self.log.info(\"test -walletnotify with importmulti\")\n+            self.test_importmulti(updateexisting=True, count=11)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285547015",
      "id" : 285547015,
      "in_reply_to_id" : 285541385,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4NTU0NzAxNQ==",
      "original_commit_id" : "9c014295c8e3f83e68a69750add9542b7e80c1d0",
      "original_position" : 30,
      "path" : "test/functional/feature_notifications.py",
      "position" : 30,
      "pull_request_review_id" : 239435248,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16050",
      "updated_at" : "2019-05-20T11:47:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/285547015",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285552432"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16050"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/285552432"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nits: comma after false and \"the\" after \"notified to\"",
      "commit_id" : "9c014295c8e3f83e68a69750add9542b7e80c1d0",
      "created_at" : "2019-05-20T11:51:50Z",
      "diff_hunk" : "@@ -0,0 +1,5 @@\n+RPC changes\n+-----------\n+The RPC `importmulti` has a new option `updateexisting` to control whether\n+rescan updates existing transactions. When `false` only new wallet transactions\n+are notified to `-walletnotify` script.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285552432",
      "id" : 285552432,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4NTU1MjQzMg==",
      "original_commit_id" : "9c014295c8e3f83e68a69750add9542b7e80c1d0",
      "original_position" : 5,
      "path" : "doc/release-notes-16050.md",
      "position" : 5,
      "pull_request_review_id" : 239449083,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16050",
      "updated_at" : "2019-05-20T11:51:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/285552432",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285552732"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16050"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/285552732"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Comment suggestion\r\n```diff\r\n+        # Wait at most 10 seconds for expected number of files predicate to be true.\r\n         wait_until(lambda: len(os.listdir(self.walletnotify_dir)) == count, timeout=10)\r\n```",
      "commit_id" : "9c014295c8e3f83e68a69750add9542b7e80c1d0",
      "created_at" : "2019-05-20T11:52:46Z",
      "diff_hunk" : "@@ -32,6 +33,16 @@ def setup_network(self):\n                             \"-walletnotify=echo > {}\".format(os.path.join(self.walletnotify_dir, '%s'))]]\n         super().setup_network()\n \n+    def test_importmulti(self, updateexisting, count):\n+        shutil.rmtree(self.walletnotify_dir)\n+        os.mkdir(self.walletnotify_dir)\n+\n+        addr = self.nodes[0].getnewaddress()\n+        self.nodes[0].generatetoaddress(1, addr)\n+\n+        self.nodes[1].importmulti([{\"scriptPubKey\": {\"address\": addr}, \"timestamp\": \"now\"}], {\"updateexisting\": updateexisting})\n+        wait_until(lambda: len(os.listdir(self.walletnotify_dir)) == count, timeout=10)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285552732",
      "id" : 285552732,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4NTU1MjczMg==",
      "original_commit_id" : "9c014295c8e3f83e68a69750add9542b7e80c1d0",
      "original_position" : 20,
      "path" : "test/functional/feature_notifications.py",
      "position" : 20,
      "pull_request_review_id" : 239449463,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16050",
      "updated_at" : "2019-05-20T11:52:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/285552732",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   }
]
