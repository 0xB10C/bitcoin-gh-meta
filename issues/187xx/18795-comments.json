[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This is meant as an example for #14148 as requested by @MarcoFalke , not to be merged for now.",
      "created_at" : "2020-04-28T07:29:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18795#issuecomment-620432429",
      "id" : 620432429,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18795",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMDQzMjQyOQ==",
      "updated_at" : "2020-04-28T07:29:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/620432429",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4943644?v=4",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "node_id" : "MDQ6VXNlcjQ5NDM2NDQ=",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #18000 (Index for UTXO Set Statistics by fjahr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-04-28T08:35:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18795#issuecomment-620463740",
      "id" : 620463740,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18795",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMDQ2Mzc0MA==",
      "updated_at" : "2020-04-28T08:35:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/620463740",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "If this demonstrates an unfixed issue, shouldn't the test fail on master?",
      "created_at" : "2020-04-30T13:54:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18795#issuecomment-621867814",
      "id" : 621867814,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18795",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMTg2NzgxNA==",
      "updated_at" : "2020-04-30T13:54:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/621867814",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> If this demonstrates an unfixed issue, shouldn't the test fail on master?\r\n\r\nThat's a good point.  The test was originally written to assert the current behaviour and thus passed (but looking at the code one could see the behaviour described in #14148).\r\n\r\nBut I agree that is probably confusing.  I've added another commit now that makes the test fail as expected (the original version is still preserved in the first commit, as it might be interesting as well for understanding what the issue is about).",
      "created_at" : "2020-05-01T07:12:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18795#issuecomment-622279220",
      "id" : 622279220,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18795",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYyMjI3OTIyMA==",
      "updated_at" : "2020-05-01T07:12:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622279220",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/4943644?v=4",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "node_id" : "MDQ6VXNlcjQ5NDM2NDQ=",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18795#discussion_r423364829"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18795"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/423364829"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\ntest/functional/wallet_orphanedreward.py:8:1: F401 'test_framework.util.assert_raises_rpc_error' imported but unused",
      "commit_id" : "9f2ac53cbcd15f8a9d9ce4e33b56aa114b190056",
      "created_at" : "2020-05-11T22:53:02Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test orphaned block rewards in the wallet.\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_rpc_error",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18795#discussion_r423364829",
      "id" : 423364829,
      "line" : 8,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM2NDgyOQ==",
      "original_commit_id" : "9f2ac53cbcd15f8a9d9ce4e33b56aa114b190056",
      "original_line" : 8,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "test/functional/wallet_orphanedreward.py",
      "position" : 8,
      "pull_request_review_id" : 409585864,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18795",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-11T23:17:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/423364829",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18795#discussion_r423364868"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18795"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/423364868"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why is this needed?",
      "commit_id" : "9f2ac53cbcd15f8a9d9ce4e33b56aa114b190056",
      "created_at" : "2020-05-11T22:53:10Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test orphaned block rewards in the wallet.\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_rpc_error\n+\n+class OrphanedBlockRewardTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.supports_cli = False",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18795#discussion_r423364868",
      "id" : 423364868,
      "line" : 14,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM2NDg2OA==",
      "original_commit_id" : "9f2ac53cbcd15f8a9d9ce4e33b56aa114b190056",
      "original_line" : 14,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "test/functional/wallet_orphanedreward.py",
      "position" : 14,
      "pull_request_review_id" : 409585864,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18795",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-11T23:17:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/423364868",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18795#discussion_r423365132"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18795"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/423365132"
         }
      },
      "author_association" : "MEMBER",
      "body" : "For a speed-up you can remove this line, and then start the test with `sendtoaddress`.",
      "commit_id" : "9f2ac53cbcd15f8a9d9ce4e33b56aa114b190056",
      "created_at" : "2020-05-11T22:53:54Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test orphaned block rewards in the wallet.\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_rpc_error\n+\n+class OrphanedBlockRewardTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18795#discussion_r423365132",
      "id" : 423365132,
      "line" : 12,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM2NTEzMg==",
      "original_commit_id" : "9f2ac53cbcd15f8a9d9ce4e33b56aa114b190056",
      "original_line" : 12,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "test/functional/wallet_orphanedreward.py",
      "position" : 12,
      "pull_request_review_id" : 409585864,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18795",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-11T23:17:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/423365132",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18795#discussion_r423372657"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18795"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/423372657"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Could comment this out, and add a comment that it fails?",
      "commit_id" : "9f2ac53cbcd15f8a9d9ce4e33b56aa114b190056",
      "created_at" : "2020-05-11T23:16:31Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test orphaned block rewards in the wallet.\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_rpc_error\n+\n+class OrphanedBlockRewardTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.supports_cli = False\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        # Generate some blocks and obtain some coins on node 0.  We send\n+        # some balance to node 1, which will hold it as a single coin.\n+        self.nodes[0].generate(150)\n+        self.nodes[0].sendtoaddress(self.nodes[1].getnewaddress(), 10)\n+        self.nodes[0].generate(50)\n+\n+        # Get a block reward with node 1 and remember the block so we can orphan\n+        # it later.\n+        self.sync_blocks()\n+        blk = self.nodes[1].generate(1)[0]\n+        self.sync_blocks()\n+\n+        # Let the block reward mature and send coins including both\n+        # the existing balance and the block reward.\n+        self.nodes[0].generate(150)\n+        assert_equal(self.nodes[1].getbalance(), 10 + 25)\n+        self.nodes[1].sendtoaddress(self.nodes[0].getnewaddress(), 30)\n+\n+        # Orphan the block reward and make sure that the original coins\n+        # from the wallet can still be spent.\n+        self.nodes[0].invalidateblock(blk)\n+        self.nodes[0].generate(200)\n+        self.sync_blocks()\n+        self.nodes[1].sendtoaddress(self.nodes[0].getnewaddress(), 9)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18795#discussion_r423372657",
      "id" : 423372657,
      "line" : 43,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM3MjY1Nw==",
      "original_commit_id" : "9f2ac53cbcd15f8a9d9ce4e33b56aa114b190056",
      "original_line" : 43,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "test/functional/wallet_orphanedreward.py",
      "position" : 43,
      "pull_request_review_id" : 409585864,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18795",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-11T23:17:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/423372657",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18795#discussion_r423372747"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18795"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/423372747"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Also, would be good to check the output of `getbalances` here.",
      "commit_id" : "9f2ac53cbcd15f8a9d9ce4e33b56aa114b190056",
      "created_at" : "2020-05-11T23:16:50Z",
      "diff_hunk" : "@@ -0,0 +1,46 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test orphaned block rewards in the wallet.\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal, assert_raises_rpc_error\n+\n+class OrphanedBlockRewardTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.supports_cli = False\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def run_test(self):\n+        # Generate some blocks and obtain some coins on node 0.  We send\n+        # some balance to node 1, which will hold it as a single coin.\n+        self.nodes[0].generate(150)\n+        self.nodes[0].sendtoaddress(self.nodes[1].getnewaddress(), 10)\n+        self.nodes[0].generate(50)\n+\n+        # Get a block reward with node 1 and remember the block so we can orphan\n+        # it later.\n+        self.sync_blocks()\n+        blk = self.nodes[1].generate(1)[0]\n+        self.sync_blocks()\n+\n+        # Let the block reward mature and send coins including both\n+        # the existing balance and the block reward.\n+        self.nodes[0].generate(150)\n+        assert_equal(self.nodes[1].getbalance(), 10 + 25)\n+        self.nodes[1].sendtoaddress(self.nodes[0].getnewaddress(), 30)\n+\n+        # Orphan the block reward and make sure that the original coins\n+        # from the wallet can still be spent.\n+        self.nodes[0].invalidateblock(blk)\n+        self.nodes[0].generate(200)\n+        self.sync_blocks()\n+        self.nodes[1].sendtoaddress(self.nodes[0].getnewaddress(), 9)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18795#discussion_r423372747",
      "id" : 423372747,
      "line" : 43,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMzM3Mjc0Nw==",
      "original_commit_id" : "9f2ac53cbcd15f8a9d9ce4e33b56aa114b190056",
      "original_line" : 43,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "test/functional/wallet_orphanedreward.py",
      "position" : 43,
      "pull_request_review_id" : 409585864,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18795",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-05-11T23:17:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/423372747",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
