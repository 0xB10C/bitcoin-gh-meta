[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18410#discussion_r396539404"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18410"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/396539404"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    CheckWriteCoins(ABSENT, SPENT , ABSENT, NO_ENTRY   , DIRTY|FRESH, NO_ENTRY   );\r\n```",
      "commit_id" : "97298e536d09724952f84837b562e5e714acbf23",
      "created_at" : "2020-03-23T15:30:38Z",
      "diff_hunk" : "@@ -805,42 +805,42 @@ BOOST_AUTO_TEST_CASE(ccoins_write)\n      *              Value   Value   Value   Flags        Flags        Flags\n      */\n     CheckWriteCoins(ABSENT, ABSENT, ABSENT, NO_ENTRY   , NO_ENTRY   , NO_ENTRY   );\n-    CheckWriteCoins(ABSENT, PRUNED, PRUNED, NO_ENTRY   , DIRTY      , DIRTY      );\n-    CheckWriteCoins(ABSENT, PRUNED, ABSENT, NO_ENTRY   , DIRTY|FRESH, NO_ENTRY   );\n+    CheckWriteCoins(ABSENT, SPENT , SPENT , NO_ENTRY   , DIRTY      , DIRTY      );\n+    CheckWriteCoins(ABSENT, SPENT , ABSENT , NO_ENTRY   , DIRTY|FRESH, NO_ENTRY   );",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18410#discussion_r396539404",
      "id" : 396539404,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjUzOTQwNA==",
      "original_commit_id" : "0e04b2c44e5bb951a96e5e9f3e1252b9ef695827",
      "original_position" : 175,
      "path" : "src/test/coins_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 379543360,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18410",
      "updated_at" : "2020-03-23T15:41:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/396539404",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "These changes were extracted from #18113.",
      "created_at" : "2020-03-23T15:36:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18410#issuecomment-602679330",
      "id" : 602679330,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18410",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMjY3OTMzMA==",
      "updated_at" : "2020-03-23T15:36:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/602679330",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18410#discussion_r396547589"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18410"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/396547589"
         }
      },
      "author_association" : "MEMBER",
      "body" : "oops. Fixed. Thanks Marco",
      "commit_id" : "97298e536d09724952f84837b562e5e714acbf23",
      "created_at" : "2020-03-23T15:41:02Z",
      "diff_hunk" : "@@ -805,42 +805,42 @@ BOOST_AUTO_TEST_CASE(ccoins_write)\n      *              Value   Value   Value   Flags        Flags        Flags\n      */\n     CheckWriteCoins(ABSENT, ABSENT, ABSENT, NO_ENTRY   , NO_ENTRY   , NO_ENTRY   );\n-    CheckWriteCoins(ABSENT, PRUNED, PRUNED, NO_ENTRY   , DIRTY      , DIRTY      );\n-    CheckWriteCoins(ABSENT, PRUNED, ABSENT, NO_ENTRY   , DIRTY|FRESH, NO_ENTRY   );\n+    CheckWriteCoins(ABSENT, SPENT , SPENT , NO_ENTRY   , DIRTY      , DIRTY      );\n+    CheckWriteCoins(ABSENT, SPENT , ABSENT , NO_ENTRY   , DIRTY|FRESH, NO_ENTRY   );",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18410#discussion_r396547589",
      "id" : 396547589,
      "in_reply_to_id" : 396539404,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NjU0NzU4OQ==",
      "original_commit_id" : "0e04b2c44e5bb951a96e5e9f3e1252b9ef695827",
      "original_position" : 175,
      "path" : "src/test/coins_tests.cpp",
      "position" : null,
      "pull_request_review_id" : 379553772,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18410",
      "updated_at" : "2020-03-23T15:41:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/396547589",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #16910 (wallet: reduce loading time by using unordered maps by achow101)\n* #9384 (CCoinsViewCache code cleanup & deduplication by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-03-23T18:28:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18410#issuecomment-602778584",
      "id" : 602778584,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18410",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMjc3ODU4NA==",
      "updated_at" : "2020-03-24T16:27:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/602778584",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for improving the documentation here. I think this is a clear improvement.\r\n\r\nACK 97298e536d09724952f84837b562e5e714acbf23",
      "created_at" : "2020-03-25T15:13:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18410#issuecomment-603897580",
      "id" : 603897580,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18410",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMzg5NzU4MA==",
      "updated_at" : "2020-03-25T15:13:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/603897580",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-03-26T19:33:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18410#issuecomment-604640473",
      "id" : 604640473,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18410",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNDY0MDQ3Mw==",
      "updated_at" : "2020-03-26T19:33:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/604640473",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18410#discussion_r399543226"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18410"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/399543226"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[docs] Improve commenting in coins.cpp|h\" (eeeb97b6da16fed5701ff04d3b9a622eb759fa5a)\r\n\r\nIt seems like this comment is going into the weeds about when it is safe to set these flags without explaining what the code is trying to do. If I were trying to explain this code I think I'd start off with something like:\r\n\r\n\"As an optimization, try to set the FRESH flag when the caller has passed possible_overwrite=false and is guaranteeing that the coin was spent or never existed before this call. In this case, the FRESH flag can be applied as long as there's not a previous spent dirty cache entry (from disconnecting a block in a reorg and \"spending\" the coin to remove it), that hasn't yet been written to the base view.\"",
      "commit_id" : "97298e536d09724952f84837b562e5e714acbf23",
      "created_at" : "2020-03-27T21:19:40Z",
      "diff_hunk" : "@@ -77,8 +77,21 @@ void CCoinsViewCache::AddCoin(const COutPoint &outpoint, Coin&& coin, bool possi\n     }\n     if (!possible_overwrite) {\n         if (!it->second.coin.IsSpent()) {\n-            throw std::logic_error(\"Adding new coin that replaces non-pruned entry\");\n+            throw std::logic_error(\"Attempted to overwrite an unspent coin\");\n         }\n+        // If the coin exists in this cache as a spent coin and is DIRTY, then",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18410#discussion_r399543226",
      "id" : 399543226,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU0MzIyNg==",
      "original_commit_id" : "eeeb97b6da16fed5701ff04d3b9a622eb759fa5a",
      "original_position" : 7,
      "path" : "src/coins.cpp",
      "position" : 7,
      "pull_request_review_id" : 383206366,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18410",
      "updated_at" : "2020-03-27T22:58:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/399543226",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18410#discussion_r399550011"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18410"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/399550011"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[docs] Improve commenting in coins.cpp|h\" (eeeb97b6da16fed5701ff04d3b9a622eb759fa5a)\r\n\r\nI think it's not finding an unspent coin that's a problem, but finding an unspent coin when `possible_overwrite=false` that's a problem. logic_error(\"Found unexpected coin in cache with possible_overwrite=false\") might make it clearer the error's more of an unexpected state than a failed attempt to write something",
      "commit_id" : "97298e536d09724952f84837b562e5e714acbf23",
      "created_at" : "2020-03-27T21:38:00Z",
      "diff_hunk" : "@@ -77,8 +77,21 @@ void CCoinsViewCache::AddCoin(const COutPoint &outpoint, Coin&& coin, bool possi\n     }\n     if (!possible_overwrite) {\n         if (!it->second.coin.IsSpent()) {\n-            throw std::logic_error(\"Adding new coin that replaces non-pruned entry\");\n+            throw std::logic_error(\"Attempted to overwrite an unspent coin\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18410#discussion_r399550011",
      "id" : 399550011,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU1MDAxMQ==",
      "original_commit_id" : "eeeb97b6da16fed5701ff04d3b9a622eb759fa5a",
      "original_position" : 5,
      "path" : "src/coins.cpp",
      "position" : 5,
      "pull_request_review_id" : 383206366,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18410",
      "updated_at" : "2020-03-27T22:58:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/399550011",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18410#discussion_r399561161"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18410"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/399561161"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[docs] use consistent naming for possible_overwrite\" (97298e536d09724952f84837b562e5e714acbf23)\r\n\r\nNot for here, since it's too much change for a documentation PR, but it might be worth considering replacing this bool possible_overwrite param with an inverted bool fresh param. possible_overwrite=false would change to fresh=true, meaning it is safe for AddCoin to assume any existing coin is spent, and possible_overwrite=true would change to fresh=false, meaning it can't make that assumption\r\n\r\n(This would be a partial step in the direction I was trying to go in #9384: instead of repeating fresh/dirty logic and implementing it slightly different ways in AddCoin, and SpendCoin, Batchwrite, just doing it one time one way in a CCoinsViewCache::Modifier class.)\r\n\r\nCalling the param fresh instead of possible_overwrite would make it more clear this is doing the same freshness logic as BatchWrite et al, and not something different",
      "commit_id" : "97298e536d09724952f84837b562e5e714acbf23",
      "created_at" : "2020-03-27T22:10:46Z",
      "diff_hunk" : "@@ -279,10 +279,10 @@ class CCoinsViewCache : public CCoinsViewBacked\n     const Coin& AccessCoin(const COutPoint &output) const;\n \n     /**\n-     * Add a coin. Set potential_overwrite to true if an unspent version may\n+     * Add a coin. Set possible_overwrite to true if an unspent version may\n      * already exist in the cache.\n      */\n-    void AddCoin(const COutPoint& outpoint, Coin&& coin, bool potential_overwrite);\n+    void AddCoin(const COutPoint& outpoint, Coin&& coin, bool possible_overwrite);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18410#discussion_r399561161",
      "id" : 399561161,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU2MTE2MQ==",
      "original_commit_id" : "97298e536d09724952f84837b562e5e714acbf23",
      "original_position" : 9,
      "path" : "src/coins.h",
      "position" : 67,
      "pull_request_review_id" : 383206366,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18410",
      "updated_at" : "2020-03-27T22:58:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/399561161",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18410#discussion_r399571009"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18410"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/399571009"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"[docs] Improve commenting in coins.cpp|h\" (eeeb97b6da16fed5701ff04d3b9a622eb759fa5a)\r\n\r\n\"A coin can only be FRESH in the child cache if it doesn't exist in any of the ancestor caches\" is too broad a statement, not generally true. You can layer caches arbitrarily and a fresh flag in a child doesn't tell you about the state of the coin in every ancestor cache. It only directly tells you the state of the coin in the immediate parent cache. In this case, we only indirectly know the state of the grandparent coin due to this happening under the `itUs == cacheCoins.end()` branch.\r\n\r\nWould write this comment more like: \"We can mark parent cache entry FRESH here if child cache entry was FRESH. This works because parent cache entry not previously existing and child cache entry being FRESH indicates grandparent coin is spent or doesn't exist.\"",
      "commit_id" : "97298e536d09724952f84837b562e5e714acbf23",
      "created_at" : "2020-03-27T22:44:54Z",
      "diff_hunk" : "@@ -152,36 +165,35 @@ bool CCoinsViewCache::BatchWrite(CCoinsMap &mapCoins, const uint256 &hashBlockIn\n         }\n         CCoinsMap::iterator itUs = cacheCoins.find(it->first);\n         if (itUs == cacheCoins.end()) {\n-            // The parent cache does not have an entry, while the child does\n-            // We can ignore it if it's both FRESH and pruned in the child\n+            // The parent cache does not have an entry, while the child cache does.\n+            // We can ignore it if it's both spent and FRESH in the child\n             if (!(it->second.flags & CCoinsCacheEntry::FRESH && it->second.coin.IsSpent())) {\n-                // Otherwise we will need to create it in the parent\n-                // and move the data up and mark it as dirty\n+                // Create the coin in the parent cache, move the data up\n+                // and mark it as dirty.\n                 CCoinsCacheEntry& entry = cacheCoins[it->first];\n                 entry.coin = std::move(it->second.coin);\n                 cachedCoinsUsage += entry.coin.DynamicMemoryUsage();\n                 entry.flags = CCoinsCacheEntry::DIRTY;\n-                // We can mark it FRESH in the parent if it was FRESH in the child\n-                // Otherwise it might have just been flushed from the parent's cache\n-                // and already exist in the grandparent\n+                // A coin can only be FRESH in the child cache if it doesn't exist\n+                // in any of the ancestor caches. We can therefore mark it FRESH",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18410#discussion_r399571009",
      "id" : 399571009,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5OTU3MTAwOQ==",
      "original_commit_id" : "eeeb97b6da16fed5701ff04d3b9a622eb759fa5a",
      "original_position" : 44,
      "path" : "src/coins.cpp",
      "position" : 60,
      "pull_request_review_id" : 383206366,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18410",
      "updated_at" : "2020-03-27T23:00:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/399571009",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
