[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2020-03-24T16:18:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#issuecomment-603340799",
      "id" : 603340799,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18421",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMzM0MDc5OQ==",
      "updated_at" : "2020-03-25T23:41:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/603340799",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Can this use the scheduler instead of using a separate thread?",
      "created_at" : "2020-03-24T16:19:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#issuecomment-603341645",
      "id" : 603341645,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18421",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMzM0MTY0NQ==",
      "updated_at" : "2020-03-24T16:19:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/603341645",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-03-24T16:42:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#issuecomment-603356671",
      "id" : 603356671,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18421",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMzM1NjY3MQ==",
      "updated_at" : "2020-03-24T16:42:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/603356671",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa yes! I simply forgot that this can be done with scheduler. Just force-pushed an update.",
      "created_at" : "2020-03-24T16:42:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#issuecomment-603357337",
      "id" : 603357337,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18421",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMzM1NzMzNw==",
      "updated_at" : "2020-03-24T16:42:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/603357337",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397302616"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397302616"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this in an implementation detail which people that want to reduce their traffic are not interested in learning about.\r\n\r\nA release notes snippet would be a better place to put this, no?",
      "commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "created_at" : "2020-03-24T16:44:20Z",
      "diff_hunk" : "@@ -28,7 +28,9 @@ calculating the target.\n \n Disabling listening will result in fewer nodes connected (remember the maximum of 8\n outbound peers). Fewer nodes will result in less traffic usage as you are relaying\n-blocks and transactions to fewer nodes.\n+blocks and transactions to fewer nodes. This would also prevent reachable nodes from\n+periodically querying DNS servers when it is not needed (feature, which gives more\n+privacy to the non-reachable nodes located in the same subnet).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397302616",
      "id" : 397302616,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMwMjYxNg==",
      "original_commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "original_position" : 7,
      "path" : "doc/reduce-traffic.md",
      "position" : 7,
      "pull_request_review_id" : 380499860,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421",
      "updated_at" : "2020-03-24T16:44:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397302616",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397305463"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397305463"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, I was hesitant about this part. Committed this for now simply to not ignore this. Unless someone expresses support for keeping this, I would remove this commit later.",
      "commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "created_at" : "2020-03-24T16:47:55Z",
      "diff_hunk" : "@@ -28,7 +28,9 @@ calculating the target.\n \n Disabling listening will result in fewer nodes connected (remember the maximum of 8\n outbound peers). Fewer nodes will result in less traffic usage as you are relaying\n-blocks and transactions to fewer nodes.\n+blocks and transactions to fewer nodes. This would also prevent reachable nodes from\n+periodically querying DNS servers when it is not needed (feature, which gives more\n+privacy to the non-reachable nodes located in the same subnet).",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397305463",
      "id" : 397305463,
      "in_reply_to_id" : 397302616,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMwNTQ2Mw==",
      "original_commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "original_position" : 7,
      "path" : "doc/reduce-traffic.md",
      "position" : 7,
      "pull_request_review_id" : 380503239,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421",
      "updated_at" : "2020-03-24T16:47:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397305463",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397313055"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397313055"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Could use doxygen comment?\r\n```suggestion\r\n/** How often to make a DNS caches updating query */\r\n```",
      "commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "created_at" : "2020-03-24T16:57:55Z",
      "diff_hunk" : "@@ -48,6 +48,9 @@ static_assert(MINIUPNPC_API_VERSION >= 10, \"miniUPnPc API version >= 10 assumed\"\n // How often to dump addresses to peers.dat\n static constexpr std::chrono::minutes DUMP_PEERS_INTERVAL{15};\n \n+// How often to make a DNS caches updating query",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397313055",
      "id" : 397313055,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMxMzA1NQ==",
      "original_commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "original_position" : 4,
      "path" : "src/net.cpp",
      "position" : 4,
      "pull_request_review_id" : 380512858,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421",
      "updated_at" : "2020-03-24T17:24:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397313055",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397316551"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397316551"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: I think this list reads easier if each entry was on its own line.\r\n\r\nnit: compile time constants should be all upper case and static\r\n\r\n```suggestion\r\n    static const std::vector<uint64_t> SERVICE_BITS_COMBINATIONS{\r\n```",
      "commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "created_at" : "2020-03-24T17:02:53Z",
      "diff_hunk" : "@@ -1571,8 +1579,48 @@ void StopMapPort()\n #endif\n \n \n+void CConnman::DNSCachesUpdate()\n+{\n+    // Only reachable nodes do this, because those are already easy to find.\n+    // Unless the node is explicitly set to be non-reachable (-listen=0),\n+    // the only way to check if it is reachable is to observe inbound connections.\n+    // This check is made every time, because a node may become non-reachable\n+    // due to external factors (e.g. local network settings update).\n+    if (CountInboundConnections() == 0) return;\n+\n+    // Every time a new widely-requests service bit is deployed, this list should be\n+    // updated to invalide records for that service bit.\n+    std::vector<uint64_t> service_bits_combinations{",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397316551",
      "id" : 397316551,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMxNjU1MQ==",
      "original_commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "original_position" : 56,
      "path" : "src/net.cpp",
      "position" : 56,
      "pull_request_review_id" : 380512858,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421",
      "updated_at" : "2020-03-24T17:24:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397316551",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397318427"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397318427"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Should be removed now?",
      "commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "created_at" : "2020-03-24T17:05:34Z",
      "diff_hunk" : "@@ -468,6 +479,7 @@ class CConnman\n \n     CThreadInterrupt interruptNet;\n \n+    std::thread thread_dns_caches_update;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397318427",
      "id" : 397318427,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMxODQyNw==",
      "original_commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "original_position" : 29,
      "path" : "src/net.h",
      "position" : 29,
      "pull_request_review_id" : 380512858,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421",
      "updated_at" : "2020-03-24T17:24:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397318427",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397319403"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397319403"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: Both of the newly added methods can be `const` because they are read-only, no?\r\n```suggestion\r\n    void DNSCachesUpdate() const;\r\n```",
      "commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "created_at" : "2020-03-24T17:06:59Z",
      "diff_hunk" : "@@ -361,6 +362,16 @@ class CConnman\n     void ThreadSocketHandler();\n     void ThreadDNSAddressSeed();\n \n+    // Reachable nodes should periodically make requests\n+    // to DNS servers even if they don't need them.\n+    // Then, when new nodes from the same subnets need to query DNS,\n+    // they are likely to hit the cache instead.\n+    // For non-reachable nodes this means more privacy,\n+    // because fewer actors would know about their query.\n+    // For reachable nodes there is no privacy loss due to this,\n+    // because being reachable already makes them public.\n+    void DNSCachesUpdate();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397319403",
      "id" : 397319403,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMxOTQwMw==",
      "original_commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "original_position" : 20,
      "path" : "src/net.h",
      "position" : 20,
      "pull_request_review_id" : 380512858,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421",
      "updated_at" : "2020-03-24T17:24:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397319403",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397334535"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397334535"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "oops. yes!",
      "commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "created_at" : "2020-03-24T17:28:42Z",
      "diff_hunk" : "@@ -468,6 +479,7 @@ class CConnman\n \n     CThreadInterrupt interruptNet;\n \n+    std::thread thread_dns_caches_update;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#discussion_r397334535",
      "id" : 397334535,
      "in_reply_to_id" : 397318427,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5NzMzNDUzNQ==",
      "original_commit_id" : "5e87cba47a8c5b86448658e4c23d2e809e69b50b",
      "original_position" : 29,
      "path" : "src/net.h",
      "position" : 29,
      "pull_request_review_id" : 380539924,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/18421",
      "updated_at" : "2020-03-24T17:28:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/397334535",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Can this use the scheduler instead of using a separate thread?\r\n\r\nWhat is the maximum time this can take? If it is unbounded, it seems that this would be a trivial DOS attack against a node, no?",
      "created_at" : "2020-03-24T17:31:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#issuecomment-603392699",
      "id" : 603392699,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18421",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMzM5MjY5OQ==",
      "updated_at" : "2020-03-24T17:31:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/603392699",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa I was not aware that scheduled event will block other execution threads, and now that Marco pointed out that attack, i'm thinking separate thread makes more sense? We don't want to make any assumptions about these requests executing very fast.",
      "created_at" : "2020-03-24T23:30:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#issuecomment-603557583",
      "id" : 603557583,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18421",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMzU1NzU4Mw==",
      "updated_at" : "2020-03-24T23:30:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/603557583",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "`LimitValidationInterfaceQueue` is called in `ActivateBestChain`. So even validation itself can be blocked, if an attacker can make those requests go slow. Not sure if that is possible, but I wanted to raise the point.",
      "created_at" : "2020-03-24T23:40:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#issuecomment-603560680",
      "id" : 603560680,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18421",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwMzU2MDY4MA==",
      "updated_at" : "2020-03-24T23:40:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/603560680",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@naumenkogs It won't block other threads, but it will delay other events in the same scheduler. I agree that it's probably too slow for that (I don't know what latency `getaddrinfo` can have, but I expect it may be substantial). An alternative is doing it from `PeerValidationLogic::SendMessages`, once a timer expires. I'm hammering on avoiding a separate thread for this, because threads have a significant memory footprint (several MB, at least), so a thread that's idle almost all the time is a waste.\r\n\r\n@MarcoFalke Vaguely related, do we have any policies around what maximum execution duration things in the main scheduler are allowed to have? ",
      "created_at" : "2020-03-26T00:09:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#issuecomment-604154189",
      "id" : 604154189,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18421",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNDE1NDE4OQ==",
      "updated_at" : "2020-03-26T00:09:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/604154189",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Agreed that that RAM overhead of a new thread for just this is no good.\r\n\r\nYeah, I would say normal execution of this function takes 2s, abnormal may take...a minute even if everyone is honest, due to random internet/os glitches.\r\nDo we have anything in our toolset to make sure Lookup() function doesn't take more than couple seconds? I don't see anything within scheduler. Maybe it's doable to add this feature?\r\n\r\nAn alternative crazy idea is to have a special thread for a number of rare not-so-critical functions, which might take long time (for example, I can imagine DumpAddresses takes long due to I/O issues).",
      "created_at" : "2020-03-26T01:41:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/18421#issuecomment-604178979",
      "id" : 604178979,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/18421",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYwNDE3ODk3OQ==",
      "updated_at" : "2020-03-26T01:42:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/604178979",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   }
]
