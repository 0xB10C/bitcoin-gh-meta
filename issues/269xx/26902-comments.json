[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [0xB10C](https://github.com/bitcoin/bitcoin/pull/26902#issuecomment-1385527167) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#25273](https://github.com/bitcoin/bitcoin/pull/25273) (wallet: Pass through transaction locktime and preset input sequences and scripts to CreateTransaction by achow101)\n* [#24128](https://github.com/bitcoin/bitcoin/pull/24128) (wallet: BIP 326 sequence based anti-fee-snipe for taproot inputs by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-01-16T20:27:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26902#issuecomment-1384522868",
      "id" : 1384522868,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26902",
      "node_id" : "IC_kwDOABII585ShiR0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1384522868/reactions"
      },
      "updated_at" : "2023-01-17T14:39:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1384522868",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK. Thanks for picking this up!\r\n\r\n(Please drop the @ from the @0xB10C mention from the PR description. This creates notifications if software-forks of Bitcoin Core include this commit too. )",
      "created_at" : "2023-01-17T14:39:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26902#issuecomment-1385527167",
      "id" : 1385527167,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26902",
      "node_id" : "IC_kwDOABII585SlXd_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1385527167/reactions"
      },
      "updated_at" : "2023-01-17T14:39:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1385527167",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Do we want to align the implementation with Electrum? https://github.com/spesmilo/electrum/issues/8073\r\n\r\nI'm not sure if that could be a source of further fingerprinting",
      "created_at" : "2023-01-19T08:29:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26902#issuecomment-1396608652",
      "id" : 1396608652,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26902",
      "node_id" : "IC_kwDOABII585TPo6M",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1396608652/reactions"
      },
      "updated_at" : "2023-01-19T08:29:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1396608652",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1466284?v=4",
         "events_url" : "https://api.github.com/users/S3RK/events{/privacy}",
         "followers_url" : "https://api.github.com/users/S3RK/followers",
         "following_url" : "https://api.github.com/users/S3RK/following{/other_user}",
         "gists_url" : "https://api.github.com/users/S3RK/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/S3RK",
         "id" : 1466284,
         "login" : "S3RK",
         "node_id" : "MDQ6VXNlcjE0NjYyODQ=",
         "organizations_url" : "https://api.github.com/users/S3RK/orgs",
         "received_events_url" : "https://api.github.com/users/S3RK/received_events",
         "repos_url" : "https://api.github.com/users/S3RK/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/S3RK/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/S3RK/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/S3RK"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26902#discussion_r1096562814"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26902"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096562814"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It'd be helpful if you explained in more detail here what exactly is the fingerprinting we're concerned about. There's a lot of possible fingerprinting attacks and it's not clear what you're referring to exactly here.",
      "commit_id" : "613942d494abad3ea020a18027c6c3c4dd4101a3",
      "created_at" : "2023-02-04T17:18:15Z",
      "diff_hunk" : "@@ -969,7 +970,21 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n     for (const auto& coin : selected_coins) {\n         txNew.vin.push_back(CTxIn(coin.outpoint, CScript(), nSequence));\n     }\n-    DiscourageFeeSniping(txNew, rng_fast, wallet.chain(), wallet.GetLastBlockHash(), wallet.GetLastBlockHeight());\n+\n+    // `DiscourageFeeSniping` may backdate locktime, but we prohibit\n+    // it if this transaction spends an unconfirmed output or is an\n+    // RBF replacement, in order to avoid leaking information that may\n+    // serve as a fingerprint of a wallet being used.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26902#discussion_r1096562814",
      "id" : 1096562814,
      "line" : 977,
      "node_id" : "PRRC_kwDOABII585BXDh-",
      "original_commit_id" : "613942d494abad3ea020a18027c6c3c4dd4101a3",
      "original_line" : 977,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 28,
      "pull_request_review_id" : 1284094606,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26902",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096562814/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-04T17:18:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1096562814",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26902#discussion_r1133748788"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26902"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1133748788"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks! Will do.",
      "commit_id" : "613942d494abad3ea020a18027c6c3c4dd4101a3",
      "created_at" : "2023-03-13T10:49:45Z",
      "diff_hunk" : "@@ -969,7 +970,21 @@ static util::Result<CreatedTransactionResult> CreateTransactionInternal(\n     for (const auto& coin : selected_coins) {\n         txNew.vin.push_back(CTxIn(coin.outpoint, CScript(), nSequence));\n     }\n-    DiscourageFeeSniping(txNew, rng_fast, wallet.chain(), wallet.GetLastBlockHash(), wallet.GetLastBlockHeight());\n+\n+    // `DiscourageFeeSniping` may backdate locktime, but we prohibit\n+    // it if this transaction spends an unconfirmed output or is an\n+    // RBF replacement, in order to avoid leaking information that may\n+    // serve as a fingerprint of a wallet being used.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26902#discussion_r1133748788",
      "id" : 1133748788,
      "in_reply_to_id" : 1096562814,
      "line" : 977,
      "node_id" : "PRRC_kwDOABII585Dk6I0",
      "original_commit_id" : "613942d494abad3ea020a18027c6c3c4dd4101a3",
      "original_line" : 977,
      "original_position" : 28,
      "original_start_line" : null,
      "path" : "src/wallet/spend.cpp",
      "position" : 28,
      "pull_request_review_id" : 1336726432,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26902",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1133748788/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-03-13T10:49:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1133748788",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7646953?v=4",
         "events_url" : "https://api.github.com/users/rodentrabies/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rodentrabies/followers",
         "following_url" : "https://api.github.com/users/rodentrabies/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rodentrabies/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rodentrabies",
         "id" : 7646953,
         "login" : "rodentrabies",
         "node_id" : "MDQ6VXNlcjc2NDY5NTM=",
         "organizations_url" : "https://api.github.com/users/rodentrabies/orgs",
         "received_events_url" : "https://api.github.com/users/rodentrabies/received_events",
         "repos_url" : "https://api.github.com/users/rodentrabies/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rodentrabies/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rodentrabies/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rodentrabies"
      }
   }
]
