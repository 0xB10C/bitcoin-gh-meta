[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12204#discussion_r161864379"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12204"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161864379"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Maybe put \"block\" in front of blocks being named by number. (and everywhere else)\r\n\r\nI was reading it as the the height in coinbase aka the number 176,684 in the block's coinbase at height 490,897.",
      "commit_id" : "9ab7fe0b3f50b2cc3514975b26eb7c63134bdd40",
      "created_at" : "2018-01-16T19:37:21Z",
      "diff_hunk" : "@@ -1858,12 +1858,58 @@ bool CChainState::ConnectBlock(const CBlock& block, CValidationState& state, CBl\n     // before the first had been spent.  Since those coinbases are sufficiently buried its no longer possible to create further\n     // duplicate transactions descending from the known pairs either.\n     // If we're on the known chain at height greater than where BIP34 activated, we can save the db accesses needed for the BIP30 check.\n+\n+    // The exception to this logic is if there are coinbases from blocks before\n+    // the BIP34 height of 227,931 which have a scriptSig with a valid-looking\n+    // BIP34 height for a later block height. These coinbases run the risk of\n+    // being duplicated when we reach that later block height. An exhaustive\n+    // search of all mainnet coinbases before the BIP34 height which have a\n+    // scriptSig indicating a later block height reveals 2 cases where the later\n+    // block height is before 1,983,702.\n+\n+    // There are many cases which indicate block height 1,983,702 or later, so\n+    // we simply remove the optimiztion to skip BIP30 checking for blocks at\n+    // height 1,983,702 or higher.  Before we reach that block in another 25\n+    // years or so, we should take advantage of a future consensus change to do\n+    // a new and improved version of BIP34 that will actually prevent ever\n+    // creating any duplicate coinbases in the future.\n+\n+    // The first earlier case is block 209,920 and the indicated height is\n+    // 209,921, so we do not need to be concerned with this case because 209,921\n+    // is under the BIP34 height and so BIP30 is active already.\n+\n+    // The second case is block 176,684 which has an indicated block height of\n+    // 490,897. Unfortunately this issue was not discovered until about 2 weeks\n+    // before block 490,897 so there was not much opportunity to address this\n+    // case other than to carefully analyze it and determine it would not be a\n+    // problem. Block 490,897 was, in fact, mined with a different coinbase\n+    // than 176,684, but it is important to note that even if it hadn't",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12204#discussion_r161864379",
      "id" : 161864379,
      "original_commit_id" : "9ab7fe0b3f50b2cc3514975b26eb7c63134bdd40",
      "original_position" : 29,
      "path" : "src/validation.cpp",
      "position" : 29,
      "pull_request_review_id" : 89222376,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12204",
      "updated_at" : "2018-01-16T19:53:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161864379",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   }
]
