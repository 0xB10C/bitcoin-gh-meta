[
   {
      "author_association" : "MEMBER",
      "body" : "Generally the node is defended from block denial by the subscription to three peers in HB mode, resulting in getting up to four copies even in the face of malicious denial.  It would be interesting to see your logs to see if CB reconstruction failed or if there was some other issue.    @TheBlueMatt  would fine this issue interesting\r\n\r\nI previously saw these attacks from those nodes, and the improved CB reproduction seemed to solve them.  Their mass connecting behavior got them listed on the blacklists my nodes use, so I haven't seen them lately.\r\n\r\nThe timeout question is complicated.  Too short a timeout and when you run bitcoin on a limited bandwidth link (or one under a sustained DOS attack that otherwise would have enough bandwidth to barely keep working) you will go into congestion collapse and be unable to continue syncing because just before finishing a block you terminate the peer and start anew.  Even with the 10 minute time we've had problems with people reporting that. More correct would likely be an adaptive time which advances forward to 2x the last successful transfer and backs off exponentially on disconnection but these things are tricky to test and work out their effect network wide in the face of possible attacks, so it hasn't been done yet-- instead effort went into making better use of the redundant CB transmissions so far.\r\n\r\nSimilar applies on banning,  you having a slow connection doesn't mean the peer did anything wrong.  One wouldn't want third parties DOS attacking you to cause you to ban all honest peers.\r\n\r\nRe mining: directly exposing a mining node to inbound connections to the public is not a good configuration. Standard advice is that a mining node should connect out to a couple of remote public nodes run by the miner as well as potentially a few other seemingly reliable nodes run by others.  Its common to see miners DOS attacked and some attacks don't admit any software defense (e.g. flooding you with traffic right when a block shows up on the network), so the most general defense is to keep a low profile.    Obviously the software should be as resistant as possible too, but we need to avoid overly simple defenses turning into attack amplifiers.",
      "created_at" : "2018-02-04T09:03:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12291#issuecomment-362891770",
      "id" : 362891770,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12291",
      "updated_at" : "2018-02-04T09:03:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/362891770",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "#10984 would make us somewhat more robust to this attack, though at this point we should consider just banning anything that says \"bitpeer\" in it...",
      "created_at" : "2018-02-04T17:14:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12291#issuecomment-362922881",
      "id" : 362922881,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12291",
      "updated_at" : "2018-02-04T17:14:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/362922881",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/649246?v=4",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> It would be interesting to see your logs to see if CB reconstruction failed or if there was some other issue.\r\n\r\nI don't see any compact block related logs in debug.log.  I can try to run again with more debugging enabled if that helps. Is there an option to increase verbosity for CB?\r\n\r\nI noticed that the bitpeer server banned itself by misbehaving from time to time, so this is why there is sometimes a period of more than 24 hours without any timeouts :).  I currently ban it manually. ",
      "created_at" : "2018-02-05T13:45:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/12291#issuecomment-363088597",
      "id" : 363088597,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12291",
      "updated_at" : "2018-02-05T13:45:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/363088597",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/897826?v=4",
         "events_url" : "https://api.github.com/users/jhoenicke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jhoenicke/followers",
         "following_url" : "https://api.github.com/users/jhoenicke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jhoenicke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jhoenicke",
         "id" : 897826,
         "login" : "jhoenicke",
         "organizations_url" : "https://api.github.com/users/jhoenicke/orgs",
         "received_events_url" : "https://api.github.com/users/jhoenicke/received_events",
         "repos_url" : "https://api.github.com/users/jhoenicke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jhoenicke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jhoenicke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jhoenicke"
      }
   }
]
