[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Specifying the alignment requirement at the prevector level instead of for `prevector::_union` would also work (ie, `class alignas(char*) prevector {`) and would be a smaller change, but it would be more fragile (breaking if `N*sizeof(T)` isn't a multiple of `alignof(size_type)`, or `sizeof(size_type)*2` didn't match `alignof(char*)`) , so keeping the pack pragma covering only the code that it absolutely needs to seems better.",
      "created_at" : "2019-12-10T08:20:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#issuecomment-563920041",
      "id" : 563920041,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17708",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MzkyMDA0MQ==",
      "updated_at" : "2019-12-10T08:20:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/563920041",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK: it would be really nice to be able to run with UndefinedBehaviorSanitizer (UBSan) without having to use any suppressions. \r\n\r\nReviewers of this PR are encouraged to review also the related PR #17208 (\"Make all tests pass UBSan without using any UBSan suppressions\").",
      "created_at" : "2019-12-10T09:00:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#issuecomment-563934250",
      "id" : 563934250,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17708",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MzkzNDI1MA==",
      "updated_at" : "2019-12-10T09:00:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/563934250",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r355916325"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355916325"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't like statically asserting numbers here. It may differ per platform, architecture.",
      "commit_id" : "5f26855f109af53a336d5f98ed0ae584e7a31f84",
      "created_at" : "2019-12-10T09:09:31Z",
      "diff_hunk" : "@@ -9,6 +9,11 @@\n #include <random.h>\n #include <version.h>\n \n+/* Check structure sizes are nicely packed */\n+static_assert(sizeof(Coin) == 48, \"unexpected sizeof(Coin)\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r355916325",
      "id" : 355916325,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NTkxNjMyNQ==",
      "original_commit_id" : "c28770d2a01e3fd364353c8723a81f56558bc626",
      "original_position" : 5,
      "path" : "src/coins.cpp",
      "position" : null,
      "pull_request_review_id" : 329679721,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708",
      "updated_at" : "2019-12-10T11:00:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355916325",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK on the prevector.h and ubsan change",
      "created_at" : "2019-12-10T09:10:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#issuecomment-563937703",
      "id" : 563937703,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17708",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2MzkzNzcwMw==",
      "updated_at" : "2019-12-10T09:10:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/563937703",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r355926888"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355926888"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: `assert(A && B);` is equivalent to `assert(A); assert(B);`, however the former has the (small) problem that if it fails it is not clear from the message which one of `A` or `B` is false.",
      "commit_id" : "5f26855f109af53a336d5f98ed0ae584e7a31f84",
      "created_at" : "2019-12-10T09:30:22Z",
      "diff_hunk" : "@@ -147,14 +146,20 @@ class prevector {\n     };\n \n private:\n-    size_type _size = 0;\n+#pragma pack(push, 1)\n     union direct_or_indirect {\n         char direct[sizeof(T) * N];\n         struct {\n-            size_type capacity;\n             char* indirect;\n+            size_type capacity;\n         };\n-    } _union = {};\n+    };\n+#pragma pack(pop)\n+    alignas(char*) direct_or_indirect _union = {};\n+    size_type _size = 0;\n+\n+    static_assert(alignof(char*) % alignof(size_type) == 0 && sizeof(char*) % alignof(size_type) == 0, \"size_type cannot have more restrictive alignment requirement than pointer\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r355926888",
      "id" : 355926888,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NTkyNjg4OA==",
      "original_commit_id" : "0df2f79c0be9baf3ced891617ffd6ce32327f1fe",
      "original_position" : 27,
      "path" : "src/prevector.h",
      "position" : 27,
      "pull_request_review_id" : 329693033,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708",
      "updated_at" : "2019-12-10T11:00:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355926888",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK 0df2f79c0, I have tested the code",
      "created_at" : "2019-12-10T09:44:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#issuecomment-563951470",
      "id" : 563951470,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17708",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2Mzk1MTQ3MA==",
      "updated_at" : "2019-12-10T09:44:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/563951470",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r355936160"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355936160"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think it should be a compile error if these are too small or big. This means that for any field added/removed to the structure, or possible for new compilers/architectures, these lines have to be updated.",
      "commit_id" : "5f26855f109af53a336d5f98ed0ae584e7a31f84",
      "created_at" : "2019-12-10T09:47:57Z",
      "diff_hunk" : "@@ -9,6 +9,11 @@\n #include <random.h>\n #include <version.h>\n \n+/* Check structure sizes are nicely packed */\n+static_assert(sizeof(CScript) == 32, \"unexpected sizeof(CScript)\");\n+static_assert(44 <= sizeof(Coin) && sizeof(Coin) <= 48, \"unexpected sizeof(Coin)\");\n+static_assert(48 <= sizeof(CCoinsCacheEntry) && sizeof(CCoinsCacheEntry) <= 56, \"unexpected sizeof(CCoinsCacheEntry)\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r355936160",
      "id" : 355936160,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NTkzNjE2MA==",
      "original_commit_id" : "0df2f79c0be9baf3ced891617ffd6ce32327f1fe",
      "original_position" : 7,
      "path" : "src/coins.cpp",
      "position" : null,
      "pull_request_review_id" : 329704715,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708",
      "updated_at" : "2019-12-10T11:00:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355936160",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#17208](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17208.html) (Make all tests pass UBSan without using any UBSan suppressions by practicalswift)\n* [#17060](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17060.html) (Cache 26% more coins: Reduce CCoinsMap::value_type from 96 to 76 bytes by martinus)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-12-10T09:49:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#issuecomment-563953994",
      "id" : 563953994,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17708",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2Mzk1Mzk5NA==",
      "updated_at" : "2019-12-10T14:30:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/563953994",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r355972284"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355972284"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Agree, mostly wanted them in there to check that there weren't any unexpected changes at least on any of the architectures travis checks. (It's 44/48 for 4-byte pointers and 48/56 for 8-byte pointers). Rebased without that commit.",
      "commit_id" : "5f26855f109af53a336d5f98ed0ae584e7a31f84",
      "created_at" : "2019-12-10T11:00:40Z",
      "diff_hunk" : "@@ -9,6 +9,11 @@\n #include <random.h>\n #include <version.h>\n \n+/* Check structure sizes are nicely packed */\n+static_assert(sizeof(CScript) == 32, \"unexpected sizeof(CScript)\");\n+static_assert(44 <= sizeof(Coin) && sizeof(Coin) <= 48, \"unexpected sizeof(Coin)\");\n+static_assert(48 <= sizeof(CCoinsCacheEntry) && sizeof(CCoinsCacheEntry) <= 56, \"unexpected sizeof(CCoinsCacheEntry)\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r355972284",
      "id" : 355972284,
      "in_reply_to_id" : 355936160,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NTk3MjI4NA==",
      "original_commit_id" : "0df2f79c0be9baf3ced891617ffd6ce32327f1fe",
      "original_position" : 7,
      "path" : "src/coins.cpp",
      "position" : null,
      "pull_request_review_id" : 329750997,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708",
      "updated_at" : "2019-12-10T11:00:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355972284",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r355974938"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355974938"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, it's good for that.\r\nI later realized there could be a case for checking *CScript*'s size because it's supposed to be 32 bytes no matter the architecture (assuming pointer sizes <= 128 bit  :smiley: ), and it's unlikely for fields to be added to it. But I dunno.",
      "commit_id" : "5f26855f109af53a336d5f98ed0ae584e7a31f84",
      "created_at" : "2019-12-10T11:06:48Z",
      "diff_hunk" : "@@ -9,6 +9,11 @@\n #include <random.h>\n #include <version.h>\n \n+/* Check structure sizes are nicely packed */\n+static_assert(sizeof(CScript) == 32, \"unexpected sizeof(CScript)\");\n+static_assert(44 <= sizeof(Coin) && sizeof(Coin) <= 48, \"unexpected sizeof(Coin)\");\n+static_assert(48 <= sizeof(CCoinsCacheEntry) && sizeof(CCoinsCacheEntry) <= 56, \"unexpected sizeof(CCoinsCacheEntry)\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r355974938",
      "id" : 355974938,
      "in_reply_to_id" : 355936160,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NTk3NDkzOA==",
      "original_commit_id" : "0df2f79c0be9baf3ced891617ffd6ce32327f1fe",
      "original_position" : 7,
      "path" : "src/coins.cpp",
      "position" : null,
      "pull_request_review_id" : 329754517,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708",
      "updated_at" : "2019-12-10T11:15:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355974938",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 5f26855f109af53a336d5f98ed0ae584e7a31f84",
      "created_at" : "2019-12-10T11:07:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#issuecomment-563983915",
      "id" : 563983915,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17708",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2Mzk4MzkxNQ==",
      "updated_at" : "2019-12-10T11:07:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/563983915",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r355981321"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355981321"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "CScript seems like it ought to be reasonably robust, and it's got that `28` constant already. Maybe if #17060 or the like makes progress could add some checks then? Figure it only makes sense to worry about the size of the things you're caching a bazillion of...",
      "commit_id" : "5f26855f109af53a336d5f98ed0ae584e7a31f84",
      "created_at" : "2019-12-10T11:21:43Z",
      "diff_hunk" : "@@ -9,6 +9,11 @@\n #include <random.h>\n #include <version.h>\n \n+/* Check structure sizes are nicely packed */\n+static_assert(sizeof(CScript) == 32, \"unexpected sizeof(CScript)\");\n+static_assert(44 <= sizeof(Coin) && sizeof(Coin) <= 48, \"unexpected sizeof(Coin)\");\n+static_assert(48 <= sizeof(CCoinsCacheEntry) && sizeof(CCoinsCacheEntry) <= 56, \"unexpected sizeof(CCoinsCacheEntry)\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r355981321",
      "id" : 355981321,
      "in_reply_to_id" : 355936160,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NTk4MTMyMQ==",
      "original_commit_id" : "0df2f79c0be9baf3ced891617ffd6ce32327f1fe",
      "original_position" : 7,
      "path" : "src/coins.cpp",
      "position" : null,
      "pull_request_review_id" : 329762637,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708",
      "updated_at" : "2019-12-10T11:21:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/355981321",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 5f26855f109af53a336d5f98ed0ae584e7a31f84\r\n\r\nVery glad to see two UBSan suppressions go away! :)",
      "created_at" : "2019-12-10T16:17:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#issuecomment-564110088",
      "id" : 564110088,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17708",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2NDExMDA4OA==",
      "updated_at" : "2019-12-10T16:17:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/564110088",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jamesob Might wanna benchmark this one instead of the previous attempt if you haven't already :relaxed:",
      "created_at" : "2019-12-10T17:18:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#issuecomment-564138304",
      "id" : 564138304,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17708",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2NDEzODMwNA==",
      "updated_at" : "2019-12-10T17:18:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/564138304",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm pretty sure the change, as it is now, doesn't modify the layout of any of the data structures used in UTXO caching.\r\n\r\nI think the only case where `CScript` ended up non-aligned in practice was on the stack in some cases (esp. the fuzzing tests).",
      "created_at" : "2019-12-12T11:25:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#issuecomment-564967479",
      "id" : 564967479,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17708",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2NDk2NzQ3OQ==",
      "updated_at" : "2019-12-12T11:25:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/564967479",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r357323996"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357323996"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`sizeof(X)` is always a multiple of `alignof(X)`, so I think the second half here is just redundant.",
      "commit_id" : "5f26855f109af53a336d5f98ed0ae584e7a31f84",
      "created_at" : "2019-12-12T19:17:55Z",
      "diff_hunk" : "@@ -147,14 +146,20 @@ class prevector {\n     };\n \n private:\n-    size_type _size = 0;\n+#pragma pack(push, 1)\n     union direct_or_indirect {\n         char direct[sizeof(T) * N];\n         struct {\n-            size_type capacity;\n             char* indirect;\n+            size_type capacity;\n         };\n-    } _union = {};\n+    };\n+#pragma pack(pop)\n+    alignas(char*) direct_or_indirect _union = {};\n+    size_type _size = 0;\n+\n+    static_assert(alignof(char*) % alignof(size_type) == 0 && sizeof(char*) % alignof(size_type) == 0, \"size_type cannot have more restrictive alignment requirement than pointer\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#discussion_r357323996",
      "id" : 357323996,
      "in_reply_to_id" : 355926888,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzMyMzk5Ng==",
      "original_commit_id" : "0df2f79c0be9baf3ced891617ffd6ce32327f1fe",
      "original_position" : 27,
      "path" : "src/prevector.h",
      "position" : 27,
      "pull_request_review_id" : 331463867,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17708",
      "updated_at" : "2019-12-12T19:17:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357323996",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@laanwj Agree.",
      "created_at" : "2019-12-12T19:24:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#issuecomment-565148154",
      "id" : 565148154,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17708",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2NTE0ODE1NA==",
      "updated_at" : "2019-12-12T19:24:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/565148154",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This just feels like there must be a better solution. What we're trying to accomplish here should be completely legal, and shouldn't require pragma pack at all.\r\n\r\nReally the problem is that we want either (size, size, pointer) or (size, bytearray). If we could have a union between those two, with a guarantee the two first fields are merged, we'd be done. But because the language forces us to construct an explicit type for the ((size, pointer) or (bytearray)) structure, it on itself has a stronger alignment than if it were \"inlined\" so to speak.\r\n\r\nThat said, I see no way to accomplish that that is guaranteed legal, so ACK.",
      "created_at" : "2019-12-12T19:43:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17708#issuecomment-565155911",
      "id" : 565155911,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17708",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU2NTE1NTkxMQ==",
      "updated_at" : "2019-12-12T19:43:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/565155911",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
