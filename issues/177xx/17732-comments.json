[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357124904"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357124904"
         }
      },
      "author_association" : "MEMBER",
      "body" : "perhaps construct this string outside of the arg array assignment, or do:\r\n```python3\r\n \"--exit-on-first-error={}\".format(\"yes\" if exit_on_first_error else \"no\"),\r\n```",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T12:45:28Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357124904",
      "id" : 357124904,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyNDkwNA==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331203403,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357124904",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357126002"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126002"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This won't throw an error if `--valgrind` is used on a system without valgrind.",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T12:48:12Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357126002",
      "id" : 357126002,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyNjAwMg==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 5,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331204844,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126002",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357126161"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126161"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: suggestion for readability, format the args array like in line 90 above:\r\n```diff\r\n-            self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\r\n-                         \"--gen-suppressions=all\",\r\n-                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",\r\n-                         \"--error-exitcode=1\", \"--quiet\"] + self.args\r\n+            self.args = [\r\n+                \"valgrind\",\r\n+                \"--suppressions={}\".format(suppressions_file),\r\n+                \"--gen-suppressions=all\",\r\n+                \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",\r\n+                \"--error-exitcode=1\",\r\n+                \"--quiet\",\r\n+            ] + self.args\r\n```",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T12:48:35Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",\n                          \"--error-exitcode=1\", \"--quiet\"] + self.args",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357126161",
      "id" : 357126161,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyNjE2MQ==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 16,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331203403,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126161",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357126725"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126725"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I haven't tested this, but I expect `--exit-on-first-error=no` to throw an error on versions that don't have this option.",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T12:49:58Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357126725",
      "id" : 357126725,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyNjcyNQ==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331204844,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126725",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357127399"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357127399"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I believe this was added in 3.14: https://stackoverflow.com/a/50289059",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T12:51:22Z",
      "diff_hunk" : "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357127399",
      "id" : 357127399,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyNzM5OQ==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 35,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331204844,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357127399",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357127816"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357127816"
         }
      },
      "author_association" : "MEMBER",
      "body" : "suggest wrapping long lines like here and the docstring just above",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T12:52:19Z",
      "diff_hunk" : "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"\n+        version_regex = re.compile('[.bv]')\n+        version_info = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\").rstrip().split(\"valgrind-\")[1:][0]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357127816",
      "id" : 357127816,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyNzgxNg==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 37,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331203403,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357127816",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357128396"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357128396"
         }
      },
      "author_association" : "MEMBER",
      "body" : "suggest hoisting these two magic values to constants",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T12:53:37Z",
      "diff_hunk" : "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"\n+        version_regex = re.compile('[.bv]')\n+        version_info = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\").rstrip().split(\"valgrind-\")[1:][0]\n+        version_array = re.split(version_regex, version_info)\n+        major = int(version_array[0])\n+        minor = int(version_array[1])\n+        if major >=3 and minor >=15:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357128396",
      "id" : 357128396,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyODM5Ng==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 41,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331203403,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357128396",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357129740"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357129740"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Many thanks! I am going through the comments and will adapt the code accordingly. ",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T12:56:57Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357129740",
      "id" : 357129740,
      "in_reply_to_id" : 357124904,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyOTc0MA==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331209556,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357129740",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357129905"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357129905"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes! Thanks :)",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T12:57:24Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",\n                          \"--error-exitcode=1\", \"--quiet\"] + self.args",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357129905",
      "id" : 357129905,
      "in_reply_to_id" : 357126161,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyOTkwNQ==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 16,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331209809,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357129905",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357130330"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357130330"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Will test it on my macOS Catalina, because valgrind can't be installed there. :)",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T12:58:24Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357130330",
      "id" : 357130330,
      "in_reply_to_id" : 357126725,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEzMDMzMA==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331210391,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357130330",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357130419"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357130419"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Will adapt!",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T12:58:37Z",
      "diff_hunk" : "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357130419",
      "id" : 357130419,
      "in_reply_to_id" : 357127399,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEzMDQxOQ==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 35,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331210524,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357130419",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357137164"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357137164"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You mean the previous comment? This one is easiest to test on e.g. a fresh Ubuntu 18.04 machine, which has valgrind 3.13. You can then compile it from source and install 3.15 to see the difference. ",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T13:14:07Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357137164",
      "id" : 357137164,
      "in_reply_to_id" : 357126725,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEzNzE2NA==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331219376,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357137164",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357138153"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357138153"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, I have one cheap VPS running, with Ubuntu 18.04. Will follow your recommendation. Thanks!",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T13:16:05Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357138153",
      "id" : 357138153,
      "in_reply_to_id" : 357126725,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEzODE1Mw==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331220578,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357138153",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357159574"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357159574"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`--exit-on-first-error=yes` should always be used if the option `--exit-on-first-error` is supported :)",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:00:57Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357159574",
      "id" : 357159574,
      "in_reply_to_id" : 357124904,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE1OTU3NA==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331248517,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357159574",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357160270"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160270"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Will then simply produce an empty string if the flag should not be active, because it's \"no\" anyway for versions that support it.\r\n\r\nLike: **\"--exit-on-first-error=yes\" if exit_on_first_error else \"\"**",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:02:22Z",
      "diff_hunk" : "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357160270",
      "id" : 357160270,
      "in_reply_to_id" : 357127399,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MDI3MA==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 35,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331249480,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160270",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357160662"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160662"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This will create an unnecessary `valgrind` execution in the normal case when Valgrind is not used (no `--valgrind`).\r\n\r\nBetter to do it as `if use_valgrind and â¦` instead :)",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:03:13Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357160662",
      "id" : 357160662,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MDY2Mg==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 5,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331250064,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160662",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357160744"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160744"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@jonatack \r\nWould prefer your solution, but because not all old versions support this flag I'll have to stick with the other variant. Will basically return an empty string when the flag should not be active, because this is the default for some older versions anyway.",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:03:26Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357160744",
      "id" : 357160744,
      "in_reply_to_id" : 357124904,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MDc0NA==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331250206,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160744",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357161041"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357161041"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes, indeed. Thanks!",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:04:03Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357161041",
      "id" : 357161041,
      "in_reply_to_id" : 357160662,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MTA0MQ==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 5,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331250614,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357161041",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357161586"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357161586"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`if version.startswith(\"valgrind-\")` :)",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:05:16Z",
      "diff_hunk" : "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357161586",
      "id" : 357161586,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MTU4Ng==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 27,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331251357,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357161586",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357162045"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162045"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> `--exit-on-first-error=yes` should always be used if the option `--exit-on-first-error` is supported :)\r\n\r\nBut the original discussion was about disabling it for v3.15. Or am I missing something?",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:06:04Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357162045",
      "id" : 357162045,
      "in_reply_to_id" : 357124904,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MjA0NQ==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331251884,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162045",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357162358"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162358"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'd rename `exit_on_first_error` to `supports_exit_on_first_error` for clarity.",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:06:43Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357162358",
      "id" : 357162358,
      "in_reply_to_id" : 357124904,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MjM1OA==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331252300,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162358",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357162705"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162705"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done!",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:07:27Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357162705",
      "id" : 357162705,
      "in_reply_to_id" : 357124904,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MjcwNQ==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331252802,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162705",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357164663"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357164663"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> I'd rename `exit_on_first_error` to `supports_exit_on_first_error` for clarity.\r\n\r\nThen I will also put the expected version (major, minor) to 3.14, ok?\r\nIf I understand @practicalswift correctly, every version that supports this flag should also have it activated by default.",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:11:07Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357164663",
      "id" : 357164663,
      "in_reply_to_id" : 357124904,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2NDY2Mw==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331255444,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357164663",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357167630"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357167630"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this can be simplified. Only one execution of `valgrind --version` should be needed to a.) check if Valgrind is present and b.) to parse what version it is, so try to merge the logic of `is_valgrind_present` and `should_exit_valgrind_on_first_error`.\r\n\r\nI suggest `get_valgrind_version` which could return the tuple `(valgrind_major, valgrind_minor)` if `valgrind` is installed or `None` otherwise.\r\n\r\nSomething like this:\r\n\r\n```\r\nvalgrind_version = get_valgrind_version()\r\nif valgrind_version and valgrind_version >= (3, 14):\r\n    # add --exit-on-first-error=true\r\n```\r\n\r\n:)",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:16:39Z",
      "diff_hunk" : "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"\n+        version_regex = re.compile('[.bv]')\n+        version_info = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\").rstrip().split(\"valgrind-\")[1:][0]",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357167630",
      "id" : 357167630,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2NzYzMA==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 37,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331251357,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357167630",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357169751"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357169751"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Believe it or not, I was just typing the same changes. Thanks!",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:20:24Z",
      "diff_hunk" : "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357169751",
      "id" : 357169751,
      "in_reply_to_id" : 357161586,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2OTc1MQ==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 27,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331262277,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357169751",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357170012"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357170012"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> If I understand @practicalswift correctly, every version that supports this flag should also have it activated by default.\r\n\r\nCorrect! :)\r\n\r\nIt is supported by Valgrind 3.14 and above.\r\n\r\n(Unfortunately I said the wrong version number in the linked issue. I've now corrected that. Sorry for the confusion :))",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T14:20:52Z",
      "diff_hunk" : "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357170012",
      "id" : 357170012,
      "in_reply_to_id" : 357124904,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE3MDAxMg==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 15,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331262602,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357170012",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357192327"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357192327"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, I have valgrind-3.14.0 installed on debian, and valgrind --help does have the option for `--exit-on-first-error=no|yes`. Will test the updated version of this PR!",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:00:30Z",
      "diff_hunk" : "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357192327",
      "id" : 357192327,
      "in_reply_to_id" : 357127399,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5MjMyNw==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 35,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331292017,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357192327",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357194203"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357194203"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just force pushed changes. :)",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:03:53Z",
      "diff_hunk" : "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357194203",
      "id" : 357194203,
      "in_reply_to_id" : 357127399,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5NDIwMw==",
      "original_commit_id" : "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
      "original_position" : 35,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331294462,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357194203",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357194353"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357194353"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: `VALGRIND_MINIMUM_VERSION_MAJOR`",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:04:08Z",
      "diff_hunk" : "@@ -34,7 +34,8 @@\n )\n \n BITCOIND_PROC_WAIT_TIMEOUT = 60\n-\n+VALGRIND_VERSION_MAJOR = 3",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357194353",
      "id" : 357194353,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5NDM1Mw==",
      "original_commit_id" : "f59541707e47918526daa3c5b714f1f79ac1438f",
      "original_position" : 5,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331294647,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357194353",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357195971"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357195971"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: \"or None if not found\"",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:06:55Z",
      "diff_hunk" : "@@ -140,6 +149,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):\n+        \"\"\"Returns valgrind version (major, minor) in a tuple\"\"\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357195971",
      "id" : 357195971,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5NTk3MQ==",
      "original_commit_id" : "28eabc865301a1a6f2fae21f3385e9e7a99ef021",
      "original_position" : 42,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331294647,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357195971",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357197095"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357197095"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'd move all this below `if use_valgrind`. Don't forget to throw if `valgrind_version == None`",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:08:54Z",
      "diff_hunk" : "@@ -97,15 +98,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n+        valgrind_version = self.get_valgrind_version()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357197095",
      "id" : 357197095,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5NzA5NQ==",
      "original_commit_id" : "28eabc865301a1a6f2fae21f3385e9e7a99ef021",
      "original_position" : 14,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331294647,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357197095",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357198887"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357198887"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The scope can be narrowed for these and the meaning could be clarified by doing it like this on L103 instead :)\r\n\r\n```\r\nMIN_VALGRIND_VERSION_EARLY_EXIT = (3, 14)\r\nif valgrind_version and valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:\r\n```",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:11:58Z",
      "diff_hunk" : "@@ -34,7 +34,8 @@\n )\n \n BITCOIND_PROC_WAIT_TIMEOUT = 60\n-\n+VALGRIND_VERSION_MAJOR = 3\n+VALGRIND_VERSION_MINOR = 14",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357198887",
      "id" : 357198887,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5ODg4Nw==",
      "original_commit_id" : "28eabc865301a1a6f2fae21f3385e9e7a99ef021",
      "original_position" : 6,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331300555,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357198887",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357199855"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357199855"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, will do it. Many thanks!",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:13:44Z",
      "diff_hunk" : "@@ -97,15 +98,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n+        valgrind_version = self.get_valgrind_version()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357199855",
      "id" : 357199855,
      "in_reply_to_id" : 357197095,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5OTg1NQ==",
      "original_commit_id" : "28eabc865301a1a6f2fae21f3385e9e7a99ef021",
      "original_position" : 14,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331301862,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357199855",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357200114"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357200114"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Use `shutil.which(\"valgrind\")` to avoid shelling out unnecessarily :)",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:14:11Z",
      "diff_hunk" : "@@ -140,6 +149,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):\n+        \"\"\"Returns valgrind version (major, minor) in a tuple\"\"\"\n+        try:\n+          rc = subprocess.call(['which', 'valgrind'],",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357200114",
      "id" : 357200114,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIwMDExNA==",
      "original_commit_id" : "28eabc865301a1a6f2fae21f3385e9e7a99ef021",
      "original_position" : 44,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331300555,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357200114",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357204519"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357204519"
         }
      },
      "author_association" : "MEMBER",
      "body" : "1. Have you seen instances where the Valgrind version identifier contains `b` or `v`? :) If not, perhaps the simpler `version_info.split(\".\")` could do?\r\n\r\n2. Check the indentation here so that it matches the four spaces used in the rest of this file :)  Applies throughout this PR.",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:21:53Z",
      "diff_hunk" : "@@ -140,6 +151,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):\n+        \"\"\"Returns valgrind version (major, minor) in a tuple or None if not found\"\"\"\n+        try:\n+          rc = subprocess.call(['which', 'valgrind'],\n+                                     stdout=subprocess.PIPE,\n+                                     stderr=subprocess.PIPE)\n+          if rc == 0:\n+            version_regex = re.compile('[.bv]')",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357204519",
      "id" : 357204519,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIwNDUxOQ==",
      "original_commit_id" : "1c2f07c8137aabad98d2f41746d9a904439406ab",
      "original_position" : 54,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331300555,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357204519",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357205478"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357205478"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yup, much better!",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:23:37Z",
      "diff_hunk" : "@@ -140,6 +149,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):\n+        \"\"\"Returns valgrind version (major, minor) in a tuple\"\"\"\n+        try:\n+          rc = subprocess.call(['which', 'valgrind'],",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357205478",
      "id" : 357205478,
      "in_reply_to_id" : 357200114,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIwNTQ3OA==",
      "original_commit_id" : "28eabc865301a1a6f2fae21f3385e9e7a99ef021",
      "original_position" : 44,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331309254,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357205478",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357207838"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357207838"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I must admit that I wasn't sure abut valgrind's versioning. But I will adapt the code of course.\r\nWill also update the indentations.",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:27:46Z",
      "diff_hunk" : "@@ -140,6 +151,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):\n+        \"\"\"Returns valgrind version (major, minor) in a tuple or None if not found\"\"\"\n+        try:\n+          rc = subprocess.call(['which', 'valgrind'],\n+                                     stdout=subprocess.PIPE,\n+                                     stderr=subprocess.PIPE)\n+          if rc == 0:\n+            version_regex = re.compile('[.bv]')",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357207838",
      "id" : 357207838,
      "in_reply_to_id" : 357204519,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIwNzgzOA==",
      "original_commit_id" : "1c2f07c8137aabad98d2f41746d9a904439406ab",
      "original_position" : 54,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331312415,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357207838",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357216948"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357216948"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think the logic is wrong here. This will only run `valgrind` if `valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT` :)\r\n\r\nThe only impact `valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT` should have is to enable `--exit-on-first-error=yes`. `self.args` should be set both for old and new versions of Valgrind :)",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:43:24Z",
      "diff_hunk" : "@@ -98,14 +98,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-uacomment=testnode%d\" % i,\n         ]\n         if use_valgrind:\n-            default_suppressions_file = os.path.join(\n-                os.path.dirname(os.path.realpath(__file__)),\n-                \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n-            suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n-                                          default_suppressions_file)\n-            self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n-                         \"--error-exitcode=1\", \"--quiet\"] + self.args\n+            valgrind_version = self.get_valgrind_version()\n+            exit_on_first_error_flag = \"\"\n+            if valgrind_version and valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357216948",
      "id" : 357216948,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIxNjk0OA==",
      "original_commit_id" : "130435997931f7086229f057df968f41d845efd5",
      "original_position" : 23,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331321558,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357216948",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357218254"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357218254"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you want to do this check right after `valgrind_version = self.get_valgrind_version()`. With the current logic the exception will be thrown also in the case where `valgrind` is present (but with an older version).\r\n\r\nI suggest testing the PR with the following alternatives to make sure all code paths are working as expected:\r\n\r\n1.) Without `valgrind` in `PATH`\r\n2.) With new `valgrind` version (>= 3.14) in `PATH`\r\n3.) With old `valgrind` version (< 3.14) in `PATH`\r\n\r\n:)",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:45:16Z",
      "diff_hunk" : "@@ -98,14 +98,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-uacomment=testnode%d\" % i,\n         ]\n         if use_valgrind:\n-            default_suppressions_file = os.path.join(\n-                os.path.dirname(os.path.realpath(__file__)),\n-                \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n-            suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n-                                          default_suppressions_file)\n-            self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n-                         \"--error-exitcode=1\", \"--quiet\"] + self.args\n+            valgrind_version = self.get_valgrind_version()\n+            exit_on_first_error_flag = \"\"\n+            if valgrind_version and valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:\n+                exit_on_first_error_flag = \"--exit-on-first-error=yes\"\n+                default_suppressions_file = os.path.join(\n+                    os.path.dirname(os.path.realpath(__file__)),\n+                    \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n+                suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n+                    default_suppressions_file)\n+                self.args = [\"valgrind\",\n+                             \"--suppressions={}\".format(suppressions_file),\n+                             \"--gen-suppressions=all\",\n+                             exit_on_first_error_flag,\n+                             \"--error-exitcode=1\",\n+                             \"--quiet\"] + self.args\n+            elif valgrind_version == None:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357218254",
      "id" : 357218254,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIxODI1NA==",
      "original_commit_id" : "130435997931f7086229f057df968f41d845efd5",
      "original_position" : 36,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331321558,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357218254",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357224013"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357224013"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Suggested alternative:\r\n\r\n```\r\ndef get_valgrind_version(self):\r\n    \"\"\"Returns valgrind version tuple (major, minor), or None if valgrind is not found\"\"\"\r\n    if not shutil.which(\"valgrind\"):\r\n        return None\r\n    version = (\r\n        subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE)\r\n        .stdout.decode(\"utf-8\")\r\n        .rstrip()\r\n        .split(\"valgrind-\")[1:][0]\r\n    )\r\n    return tuple(int(i) for i in version.split(\".\")[:2])\r\n```",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T15:54:43Z",
      "diff_hunk" : "@@ -140,6 +149,20 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357224013",
      "id" : 357224013,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIyNDAxMw==",
      "original_commit_id" : "130435997931f7086229f057df968f41d845efd5",
      "original_position" : 45,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : 51,
      "pull_request_review_id" : 331321558,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357224013",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357229136"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357229136"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yeah, just saw it. Will reorganize the code.",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T16:02:52Z",
      "diff_hunk" : "@@ -98,14 +98,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-uacomment=testnode%d\" % i,\n         ]\n         if use_valgrind:\n-            default_suppressions_file = os.path.join(\n-                os.path.dirname(os.path.realpath(__file__)),\n-                \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n-            suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n-                                          default_suppressions_file)\n-            self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n-                         \"--error-exitcode=1\", \"--quiet\"] + self.args\n+            valgrind_version = self.get_valgrind_version()\n+            exit_on_first_error_flag = \"\"\n+            if valgrind_version and valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357229136",
      "id" : 357229136,
      "in_reply_to_id" : 357216948,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIyOTEzNg==",
      "original_commit_id" : "130435997931f7086229f057df968f41d845efd5",
      "original_position" : 23,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331339896,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357229136",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357229756"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357229756"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Much better.",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T16:04:00Z",
      "diff_hunk" : "@@ -140,6 +149,20 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357229756",
      "id" : 357229756,
      "in_reply_to_id" : 357224013,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIyOTc1Ng==",
      "original_commit_id" : "130435997931f7086229f057df968f41d845efd5",
      "original_position" : 45,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : 51,
      "pull_request_review_id" : 331340742,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357229756",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/56779?v=4",
         "events_url" : "https://api.github.com/users/brakmic/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brakmic/followers",
         "following_url" : "https://api.github.com/users/brakmic/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brakmic/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brakmic",
         "id" : 56779,
         "login" : "brakmic",
         "node_id" : "MDQ6VXNlcjU2Nzc5",
         "organizations_url" : "https://api.github.com/users/brakmic/orgs",
         "received_events_url" : "https://api.github.com/users/brakmic/received_events",
         "repos_url" : "https://api.github.com/users/brakmic/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brakmic/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brakmic"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357240183"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357240183"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This can be reduced to `if valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:` since the `not valgrind_version` case is handled on L103.\r\n",
      "commit_id" : "f10ca181b6958d6a78eb6eab1d884536ff36c601",
      "created_at" : "2019-12-12T16:23:06Z",
      "diff_hunk" : "@@ -98,14 +99,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-uacomment=testnode%d\" % i,\n         ]\n         if use_valgrind:\n+            valgrind_version = self.get_valgrind_version()\n+            if not valgrind_version:\n+                raise Exception('Valgrind not present')\n+            exit_on_first_error_flag = \"\"\n+            if valgrind_version and valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357240183",
      "id" : 357240183,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzI0MDE4Mw==",
      "original_commit_id" : "3ed9706357126ac7d65c7e0f023b497c1749b2fa",
      "original_position" : 25,
      "path" : "test/functional/test_framework/test_node.py",
      "position" : null,
      "pull_request_review_id" : 331354844,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
      "updated_at" : "2019-12-12T16:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357240183",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   }
]
