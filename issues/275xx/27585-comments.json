[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Stale ACK | [Xekyo](https://github.com/bitcoin/bitcoin/pull/27585#pullrequestreview-1477583153) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#27877](https://github.com/bitcoin/bitcoin/pull/27877) (wallet: Add CoinGrinder coin selection algorithm by Xekyo)\n* [#27846](https://github.com/bitcoin/bitcoin/pull/27846) ([coinselection] Increase SRD target by change_fee by Xekyo)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-05-05T17:54:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#issuecomment-1536587665",
      "id" : 1536587665,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27585",
      "node_id" : "IC_kwDOABII585blneR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1536587665/reactions"
      },
      "updated_at" : "2023-06-26T20:19:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1536587665",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cc @achow101 @Xekyo @furszy ",
      "created_at" : "2023-05-08T14:46:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#issuecomment-1538483661",
      "id" : 1538483661,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27585",
      "node_id" : "IC_kwDOABII585bs2XN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1538483661/reactions"
      },
      "updated_at" : "2023-05-08T14:46:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1538483661",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1187594094"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1187594094"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If `CreateCoins` generates a coin that is already inside any of the results, `AddInputs` will throw a runtime error, which the fuzzing framework will detect as a failure when it is not. It is part of the class boundaries.\r\n\r\nSame apply for the fuzz `Merge` function commit.",
      "commit_id" : "d5282a45bd452844dc815181825e3dd46133ac51",
      "created_at" : "2023-05-08T15:38:08Z",
      "diff_hunk" : "@@ -114,6 +114,19 @@ FUZZ_TARGET(coinselection)\n     if (total_balance >= target && subtract_fee_outputs && !HasErrorMsg(result_knapsack)) {\n         assert(result_knapsack);\n     }\n+\n+    std::vector<COutput> utxos;\n+    std::set<std::shared_ptr<COutput>> utxos_set;\n+    CreateCoins(fuzzed_data_provider, utxos, coin_params);\n+    std::transform(utxos.begin(), utxos.end(),\n+                 std::inserter(utxos_set, utxos_set.begin()),\n+                 [](const COutput& output) {\n+                   return std::make_shared<COutput>(output);\n+                 });\n+\n+    if (result_srd) result_srd->AddInputs(utxos_set, subtract_fee_outputs);\n+    if (result_knapsack) result_knapsack->AddInputs(utxos_set, subtract_fee_outputs);\n+    if (result_bnb) result_bnb->AddInputs(utxos_set, subtract_fee_outputs);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1187594094",
      "id" : 1187594094,
      "line" : 141,
      "node_id" : "PRRC_kwDOABII585GyT9u",
      "original_commit_id" : "6151b914ffa40dc9de829b292a6df37ee7bf54ee",
      "original_line" : 129,
      "original_position" : 25,
      "original_start_line" : 119,
      "path" : "src/wallet/test/fuzz/coinselection.cpp",
      "position" : 97,
      "pull_request_review_id" : 1417041371,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1187594094/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 131,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-05-08T15:38:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1187594094",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1187606760"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1187606760"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> If CreateCoins generates a coin that is already inside any of the results, AddInputs will throw a runtime error, which the fuzzing framework will detect as a failure when it is not. It is part of the class boundaries.\r\n\r\nYes, that's why it calls `CreateCoins` twice and with different \"utxos pool\". Is there any risk yet?",
      "commit_id" : "d5282a45bd452844dc815181825e3dd46133ac51",
      "created_at" : "2023-05-08T15:50:52Z",
      "diff_hunk" : "@@ -114,6 +114,19 @@ FUZZ_TARGET(coinselection)\n     if (total_balance >= target && subtract_fee_outputs && !HasErrorMsg(result_knapsack)) {\n         assert(result_knapsack);\n     }\n+\n+    std::vector<COutput> utxos;\n+    std::set<std::shared_ptr<COutput>> utxos_set;\n+    CreateCoins(fuzzed_data_provider, utxos, coin_params);\n+    std::transform(utxos.begin(), utxos.end(),\n+                 std::inserter(utxos_set, utxos_set.begin()),\n+                 [](const COutput& output) {\n+                   return std::make_shared<COutput>(output);\n+                 });\n+\n+    if (result_srd) result_srd->AddInputs(utxos_set, subtract_fee_outputs);\n+    if (result_knapsack) result_knapsack->AddInputs(utxos_set, subtract_fee_outputs);\n+    if (result_bnb) result_bnb->AddInputs(utxos_set, subtract_fee_outputs);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1187606760",
      "id" : 1187606760,
      "in_reply_to_id" : 1187594094,
      "line" : 141,
      "node_id" : "PRRC_kwDOABII585GyXDo",
      "original_commit_id" : "6151b914ffa40dc9de829b292a6df37ee7bf54ee",
      "original_line" : 129,
      "original_position" : 25,
      "original_start_line" : 119,
      "path" : "src/wallet/test/fuzz/coinselection.cpp",
      "position" : 97,
      "pull_request_review_id" : 1417060957,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1187606760/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 131,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-05-08T15:50:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1187606760",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1187625261"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1187625261"
         }
      },
      "author_association" : "MEMBER",
      "body" : "No ok. The reason why this doesn't fails is the test global increasing `next_locktime` which ensures that all UTXOs receive a different hash even when the fuzzer provided the same data for them.\r\nSo, nvm. A comment wouldn't hurt but nothing serious.",
      "commit_id" : "d5282a45bd452844dc815181825e3dd46133ac51",
      "created_at" : "2023-05-08T16:09:33Z",
      "diff_hunk" : "@@ -114,6 +114,19 @@ FUZZ_TARGET(coinselection)\n     if (total_balance >= target && subtract_fee_outputs && !HasErrorMsg(result_knapsack)) {\n         assert(result_knapsack);\n     }\n+\n+    std::vector<COutput> utxos;\n+    std::set<std::shared_ptr<COutput>> utxos_set;\n+    CreateCoins(fuzzed_data_provider, utxos, coin_params);\n+    std::transform(utxos.begin(), utxos.end(),\n+                 std::inserter(utxos_set, utxos_set.begin()),\n+                 [](const COutput& output) {\n+                   return std::make_shared<COutput>(output);\n+                 });\n+\n+    if (result_srd) result_srd->AddInputs(utxos_set, subtract_fee_outputs);\n+    if (result_knapsack) result_knapsack->AddInputs(utxos_set, subtract_fee_outputs);\n+    if (result_bnb) result_bnb->AddInputs(utxos_set, subtract_fee_outputs);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1187625261",
      "id" : 1187625261,
      "in_reply_to_id" : 1187594094,
      "line" : 141,
      "node_id" : "PRRC_kwDOABII585Gybkt",
      "original_commit_id" : "6151b914ffa40dc9de829b292a6df37ee7bf54ee",
      "original_line" : 129,
      "original_position" : 25,
      "original_start_line" : 119,
      "path" : "src/wallet/test/fuzz/coinselection.cpp",
      "position" : 97,
      "pull_request_review_id" : 1417091211,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1187625261/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 131,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-05-08T16:10:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1187625261",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1187734637"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1187734637"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Got it, thanks.",
      "commit_id" : "d5282a45bd452844dc815181825e3dd46133ac51",
      "created_at" : "2023-05-08T18:05:02Z",
      "diff_hunk" : "@@ -114,6 +114,19 @@ FUZZ_TARGET(coinselection)\n     if (total_balance >= target && subtract_fee_outputs && !HasErrorMsg(result_knapsack)) {\n         assert(result_knapsack);\n     }\n+\n+    std::vector<COutput> utxos;\n+    std::set<std::shared_ptr<COutput>> utxos_set;\n+    CreateCoins(fuzzed_data_provider, utxos, coin_params);\n+    std::transform(utxos.begin(), utxos.end(),\n+                 std::inserter(utxos_set, utxos_set.begin()),\n+                 [](const COutput& output) {\n+                   return std::make_shared<COutput>(output);\n+                 });\n+\n+    if (result_srd) result_srd->AddInputs(utxos_set, subtract_fee_outputs);\n+    if (result_knapsack) result_knapsack->AddInputs(utxos_set, subtract_fee_outputs);\n+    if (result_bnb) result_bnb->AddInputs(utxos_set, subtract_fee_outputs);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1187734637",
      "id" : 1187734637,
      "in_reply_to_id" : 1187594094,
      "line" : 141,
      "node_id" : "PRRC_kwDOABII585Gy2Rt",
      "original_commit_id" : "6151b914ffa40dc9de829b292a6df37ee7bf54ee",
      "original_line" : 129,
      "original_position" : 25,
      "original_start_line" : 119,
      "path" : "src/wallet/test/fuzz/coinselection.cpp",
      "position" : 97,
      "pull_request_review_id" : 1417261688,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1187734637/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 131,
      "start_side" : "RIGHT",
      "subject_type" : "line",
      "updated_at" : "2023-05-08T18:05:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1187734637",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1213479178"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213479178"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Letâs allow the lower bound of whatâs possible:\r\n\r\n```suggestion\r\n        const int n_input_bytes{fuzzed_data_provider.ConsumeIntegralInRange<int>(41, 10000)};\r\n```",
      "commit_id" : "2d739a425c92e2dd409c45273e8e376d39ead1cc",
      "created_at" : "2023-06-01T17:37:59Z",
      "diff_hunk" : "@@ -45,6 +45,25 @@ static void GroupCoins(FuzzedDataProvider& fuzzed_data_provider, const std::vect\n     if (valid_outputgroup) output_groups.push_back(output_group);\n }\n \n+static CAmount CreateCoins(FuzzedDataProvider& fuzzed_data_provider, std::vector<COutput>& utxo_pool, CoinSelectionParams& coin_params) {\n+    // Create some coins\n+    CAmount total_balance{0};\n+    int next_locktime{0};\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 10000)\n+    {\n+        const int n_input{fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 10)};\n+        const int n_input_bytes{fuzzed_data_provider.ConsumeIntegralInRange<int>(100, 10000)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1213479178",
      "id" : 1213479178,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IVDkK",
      "original_commit_id" : "d5282a45bd452844dc815181825e3dd46133ac51",
      "original_line" : 55,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/test/fuzz/coinselection.cpp",
      "position" : null,
      "pull_request_review_id" : 1455990639,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213479178/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-01T18:03:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213479178",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1213485109"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213485109"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Itâs not clear to me why the `ComputeAndSetWaste()` is called with these parameters. The first should be `min_viable_change` which should be bigger than `change_fee` but not really related to `cost_of_change`. I guess thatâs fine for this test. Itâs also not clear to me, though why the `change_fee` is set to 0 here. Wouldnât it be better to have it derive from the current `coin_params`?\r\n\r\n`coin_params.m_change_fee = coin_params.m_effective_feerate.GetFee(coin_params.change_output_size);`\r\n\r\nNot sure if it adds interesting test coverage here, but I could see some `ComputeAndSetWaste()` come to different conclusions occasionally when a fee is considered.",
      "commit_id" : "2d739a425c92e2dd409c45273e8e376d39ead1cc",
      "created_at" : "2023-06-01T17:44:09Z",
      "diff_hunk" : "@@ -68,40 +87,65 @@ FUZZ_TARGET(coinselection)\n     coin_params.m_change_fee = effective_fee_rate.GetFee(coin_params.change_output_size);\n \n     // Create some coins\n-    CAmount total_balance{0};\n-    int next_locktime{0};\n-    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 10000)\n-    {\n-        const int n_input{fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 10)};\n-        const int n_input_bytes{fuzzed_data_provider.ConsumeIntegralInRange<int>(100, 10000)};\n-        const CAmount amount{fuzzed_data_provider.ConsumeIntegralInRange<CAmount>(1, MAX_MONEY)};\n-        if (total_balance + amount >= MAX_MONEY) {\n-            break;\n-        }\n-        AddCoin(amount, n_input, n_input_bytes, ++next_locktime, utxo_pool, coin_params.m_effective_feerate);\n-        total_balance += amount;\n-    }\n+    CAmount total_balance{CreateCoins(fuzzed_data_provider, utxo_pool, coin_params)};\n \n     std::vector<OutputGroup> group_pos;\n     GroupCoins(fuzzed_data_provider, utxo_pool, coin_params, /*positive_only=*/true, group_pos);\n     std::vector<OutputGroup> group_all;\n     GroupCoins(fuzzed_data_provider, utxo_pool, coin_params, /*positive_only=*/false, group_all);\n \n+    for (const OutputGroup& group : group_all) {\n+        const CoinEligibilityFilter filter(fuzzed_data_provider.ConsumeIntegral<int>(), fuzzed_data_provider.ConsumeIntegral<int>(), fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        (void)group.EligibleForSpending(filter);\n+    }\n+\n     // Run coinselection algorithms\n-    const auto result_bnb = SelectCoinsBnB(group_pos, target, cost_of_change, MAX_STANDARD_TX_WEIGHT);\n+    auto result_bnb = SelectCoinsBnB(group_pos, target, cost_of_change, MAX_STANDARD_TX_WEIGHT);\n+    if (result_bnb) {\n+        (void)result_bnb->GetShuffledInputVector();\n+        (void)result_bnb->GetInputSet();\n+    }\n \n     auto result_srd = SelectCoinsSRD(group_pos, target, fast_random_context, MAX_STANDARD_TX_WEIGHT);\n-    if (result_srd) result_srd->ComputeAndSetWaste(cost_of_change, cost_of_change, 0);\n+    if (result_srd) {\n+        result_srd->ComputeAndSetWaste(cost_of_change, cost_of_change, 0);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1213485109",
      "id" : 1213485109,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IVFA1",
      "original_commit_id" : "d5282a45bd452844dc815181825e3dd46133ac51",
      "original_line" : 111,
      "original_position" : 66,
      "original_start_line" : null,
      "path" : "src/wallet/test/fuzz/coinselection.cpp",
      "position" : null,
      "pull_request_review_id" : 1455990639,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213485109/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-01T18:03:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213485109",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1213654672"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213654672"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Great, done!",
      "commit_id" : "2d739a425c92e2dd409c45273e8e376d39ead1cc",
      "created_at" : "2023-06-01T20:37:26Z",
      "diff_hunk" : "@@ -45,6 +45,25 @@ static void GroupCoins(FuzzedDataProvider& fuzzed_data_provider, const std::vect\n     if (valid_outputgroup) output_groups.push_back(output_group);\n }\n \n+static CAmount CreateCoins(FuzzedDataProvider& fuzzed_data_provider, std::vector<COutput>& utxo_pool, CoinSelectionParams& coin_params) {\n+    // Create some coins\n+    CAmount total_balance{0};\n+    int next_locktime{0};\n+    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 10000)\n+    {\n+        const int n_input{fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 10)};\n+        const int n_input_bytes{fuzzed_data_provider.ConsumeIntegralInRange<int>(100, 10000)};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1213654672",
      "id" : 1213654672,
      "in_reply_to_id" : 1213479178,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IVuaQ",
      "original_commit_id" : "d5282a45bd452844dc815181825e3dd46133ac51",
      "original_line" : 55,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/wallet/test/fuzz/coinselection.cpp",
      "position" : null,
      "pull_request_review_id" : 1456269751,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213654672/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-01T20:37:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213654672",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1213672054"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213672054"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I didn't touch `ComputeAndSetWaste` parameters value, perhaps who did it copied (?) from: https://github.com/bitcoin/bitcoin/blob/34ac3f438a268e83af6cd11e2981e5bc07f699c9/src/wallet/coinselection.cpp#L179\r\n\r\nI'm going to change it to make it more \"realistic\"/robust.",
      "commit_id" : "2d739a425c92e2dd409c45273e8e376d39ead1cc",
      "created_at" : "2023-06-01T20:56:20Z",
      "diff_hunk" : "@@ -68,40 +87,65 @@ FUZZ_TARGET(coinselection)\n     coin_params.m_change_fee = effective_fee_rate.GetFee(coin_params.change_output_size);\n \n     // Create some coins\n-    CAmount total_balance{0};\n-    int next_locktime{0};\n-    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 10000)\n-    {\n-        const int n_input{fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 10)};\n-        const int n_input_bytes{fuzzed_data_provider.ConsumeIntegralInRange<int>(100, 10000)};\n-        const CAmount amount{fuzzed_data_provider.ConsumeIntegralInRange<CAmount>(1, MAX_MONEY)};\n-        if (total_balance + amount >= MAX_MONEY) {\n-            break;\n-        }\n-        AddCoin(amount, n_input, n_input_bytes, ++next_locktime, utxo_pool, coin_params.m_effective_feerate);\n-        total_balance += amount;\n-    }\n+    CAmount total_balance{CreateCoins(fuzzed_data_provider, utxo_pool, coin_params)};\n \n     std::vector<OutputGroup> group_pos;\n     GroupCoins(fuzzed_data_provider, utxo_pool, coin_params, /*positive_only=*/true, group_pos);\n     std::vector<OutputGroup> group_all;\n     GroupCoins(fuzzed_data_provider, utxo_pool, coin_params, /*positive_only=*/false, group_all);\n \n+    for (const OutputGroup& group : group_all) {\n+        const CoinEligibilityFilter filter(fuzzed_data_provider.ConsumeIntegral<int>(), fuzzed_data_provider.ConsumeIntegral<int>(), fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        (void)group.EligibleForSpending(filter);\n+    }\n+\n     // Run coinselection algorithms\n-    const auto result_bnb = SelectCoinsBnB(group_pos, target, cost_of_change, MAX_STANDARD_TX_WEIGHT);\n+    auto result_bnb = SelectCoinsBnB(group_pos, target, cost_of_change, MAX_STANDARD_TX_WEIGHT);\n+    if (result_bnb) {\n+        (void)result_bnb->GetShuffledInputVector();\n+        (void)result_bnb->GetInputSet();\n+    }\n \n     auto result_srd = SelectCoinsSRD(group_pos, target, fast_random_context, MAX_STANDARD_TX_WEIGHT);\n-    if (result_srd) result_srd->ComputeAndSetWaste(cost_of_change, cost_of_change, 0);\n+    if (result_srd) {\n+        result_srd->ComputeAndSetWaste(cost_of_change, cost_of_change, 0);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1213672054",
      "id" : 1213672054,
      "in_reply_to_id" : 1213485109,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IVyp2",
      "original_commit_id" : "d5282a45bd452844dc815181825e3dd46133ac51",
      "original_line" : 111,
      "original_position" : 66,
      "original_start_line" : null,
      "path" : "src/wallet/test/fuzz/coinselection.cpp",
      "position" : null,
      "pull_request_review_id" : 1456299335,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213672054/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-01T20:56:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213672054",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1213710664"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213710664"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "2d739a425c92e2dd409c45273e8e376d39ead1cc",
      "created_at" : "2023-06-01T21:39:30Z",
      "diff_hunk" : "@@ -68,40 +87,65 @@ FUZZ_TARGET(coinselection)\n     coin_params.m_change_fee = effective_fee_rate.GetFee(coin_params.change_output_size);\n \n     // Create some coins\n-    CAmount total_balance{0};\n-    int next_locktime{0};\n-    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 10000)\n-    {\n-        const int n_input{fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 10)};\n-        const int n_input_bytes{fuzzed_data_provider.ConsumeIntegralInRange<int>(100, 10000)};\n-        const CAmount amount{fuzzed_data_provider.ConsumeIntegralInRange<CAmount>(1, MAX_MONEY)};\n-        if (total_balance + amount >= MAX_MONEY) {\n-            break;\n-        }\n-        AddCoin(amount, n_input, n_input_bytes, ++next_locktime, utxo_pool, coin_params.m_effective_feerate);\n-        total_balance += amount;\n-    }\n+    CAmount total_balance{CreateCoins(fuzzed_data_provider, utxo_pool, coin_params)};\n \n     std::vector<OutputGroup> group_pos;\n     GroupCoins(fuzzed_data_provider, utxo_pool, coin_params, /*positive_only=*/true, group_pos);\n     std::vector<OutputGroup> group_all;\n     GroupCoins(fuzzed_data_provider, utxo_pool, coin_params, /*positive_only=*/false, group_all);\n \n+    for (const OutputGroup& group : group_all) {\n+        const CoinEligibilityFilter filter(fuzzed_data_provider.ConsumeIntegral<int>(), fuzzed_data_provider.ConsumeIntegral<int>(), fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        (void)group.EligibleForSpending(filter);\n+    }\n+\n     // Run coinselection algorithms\n-    const auto result_bnb = SelectCoinsBnB(group_pos, target, cost_of_change, MAX_STANDARD_TX_WEIGHT);\n+    auto result_bnb = SelectCoinsBnB(group_pos, target, cost_of_change, MAX_STANDARD_TX_WEIGHT);\n+    if (result_bnb) {\n+        (void)result_bnb->GetShuffledInputVector();\n+        (void)result_bnb->GetInputSet();\n+    }\n \n     auto result_srd = SelectCoinsSRD(group_pos, target, fast_random_context, MAX_STANDARD_TX_WEIGHT);\n-    if (result_srd) result_srd->ComputeAndSetWaste(cost_of_change, cost_of_change, 0);\n+    if (result_srd) {\n+        result_srd->ComputeAndSetWaste(cost_of_change, cost_of_change, 0);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1213710664",
      "id" : 1213710664,
      "in_reply_to_id" : 1213485109,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585IV8FI",
      "original_commit_id" : "d5282a45bd452844dc815181825e3dd46133ac51",
      "original_line" : 111,
      "original_position" : 66,
      "original_start_line" : null,
      "path" : "src/wallet/test/fuzz/coinselection.cpp",
      "position" : null,
      "pull_request_review_id" : 1456355626,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213710664/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-01T21:39:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1213710664",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Force-pushed addressing https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1213485109 and https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1213479178",
      "created_at" : "2023-06-01T21:40:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#issuecomment-1572825952",
      "id" : 1572825952,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27585",
      "node_id" : "IC_kwDOABII585dv2tg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1572825952/reactions"
      },
      "updated_at" : "2023-06-01T21:40:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1572825952",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1224612164"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1224612164"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think you might get some funny behavior here, if `min_viable_change` is smaller than `m_change_fee` as mentioned above, also see https://github.com/bitcoin/bitcoin/pull/27846",
      "commit_id" : "2d739a425c92e2dd409c45273e8e376d39ead1cc",
      "created_at" : "2023-06-09T18:14:59Z",
      "diff_hunk" : "@@ -64,44 +84,71 @@ FUZZ_TARGET(coinselection)\n     coin_params.m_subtract_fee_outputs = subtract_fee_outputs;\n     coin_params.m_long_term_feerate = long_term_fee_rate;\n     coin_params.m_effective_feerate = effective_fee_rate;\n+    coin_params.min_viable_change = min_viable_change;\n+    coin_params.m_cost_of_change = cost_of_change;\n     coin_params.change_output_size = fuzzed_data_provider.ConsumeIntegralInRange<int>(10, 1000);\n     coin_params.m_change_fee = effective_fee_rate.GetFee(coin_params.change_output_size);\n \n     // Create some coins\n-    CAmount total_balance{0};\n-    int next_locktime{0};\n-    LIMITED_WHILE(fuzzed_data_provider.ConsumeBool(), 10000)\n-    {\n-        const int n_input{fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 10)};\n-        const int n_input_bytes{fuzzed_data_provider.ConsumeIntegralInRange<int>(100, 10000)};\n-        const CAmount amount{fuzzed_data_provider.ConsumeIntegralInRange<CAmount>(1, MAX_MONEY)};\n-        if (total_balance + amount >= MAX_MONEY) {\n-            break;\n-        }\n-        AddCoin(amount, n_input, n_input_bytes, ++next_locktime, utxo_pool, coin_params.m_effective_feerate);\n-        total_balance += amount;\n-    }\n+    CAmount total_balance{CreateCoins(fuzzed_data_provider, utxo_pool, coin_params)};\n \n     std::vector<OutputGroup> group_pos;\n     GroupCoins(fuzzed_data_provider, utxo_pool, coin_params, /*positive_only=*/true, group_pos);\n     std::vector<OutputGroup> group_all;\n     GroupCoins(fuzzed_data_provider, utxo_pool, coin_params, /*positive_only=*/false, group_all);\n \n+    for (const OutputGroup& group : group_all) {\n+        const CoinEligibilityFilter filter(fuzzed_data_provider.ConsumeIntegral<int>(), fuzzed_data_provider.ConsumeIntegral<int>(), fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+        (void)group.EligibleForSpending(filter);\n+    }\n+\n     // Run coinselection algorithms\n-    const auto result_bnb = SelectCoinsBnB(group_pos, target, cost_of_change, MAX_STANDARD_TX_WEIGHT);\n+    auto result_bnb = SelectCoinsBnB(group_pos, target, coin_params.m_cost_of_change, MAX_STANDARD_TX_WEIGHT);\n+    if (result_bnb) {\n+        (void)result_bnb->GetShuffledInputVector();\n+        (void)result_bnb->GetInputSet();\n+    }\n \n     auto result_srd = SelectCoinsSRD(group_pos, target, fast_random_context, MAX_STANDARD_TX_WEIGHT);\n-    if (result_srd) result_srd->ComputeAndSetWaste(cost_of_change, cost_of_change, 0);\n+    if (result_srd) {\n+        result_srd->ComputeAndSetWaste(coin_params.min_viable_change, coin_params.m_cost_of_change, coin_params.m_change_fee);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#discussion_r1224612164",
      "id" : 1224612164,
      "line" : 114,
      "node_id" : "PRRC_kwDOABII585I_hlE",
      "original_commit_id" : "2d739a425c92e2dd409c45273e8e376d39ead1cc",
      "original_line" : 114,
      "original_position" : 80,
      "original_start_line" : null,
      "path" : "src/wallet/test/fuzz/coinselection.cpp",
      "position" : 80,
      "pull_request_review_id" : 1472846678,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27585",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1224612164/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-06-09T18:14:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1224612164",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4060799?v=4",
         "events_url" : "https://api.github.com/users/Xekyo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Xekyo/followers",
         "following_url" : "https://api.github.com/users/Xekyo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Xekyo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Xekyo",
         "id" : 4060799,
         "login" : "Xekyo",
         "node_id" : "MDQ6VXNlcjQwNjA3OTk=",
         "organizations_url" : "https://api.github.com/users/Xekyo/orgs",
         "received_events_url" : "https://api.github.com/users/Xekyo/received_events",
         "repos_url" : "https://api.github.com/users/Xekyo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Xekyo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Xekyo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Xekyo"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n",
      "created_at" : "2023-06-23T22:04:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#issuecomment-1605036655",
      "id" : 1605036655,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27585",
      "node_id" : "IC_kwDOABII585fqupv",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1605036655/reactions"
      },
      "updated_at" : "2023-06-23T22:04:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1605036655",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased",
      "created_at" : "2023-06-26T20:20:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27585#issuecomment-1608188265",
      "id" : 1608188265,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27585",
      "node_id" : "IC_kwDOABII585f2wFp",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1608188265/reactions"
      },
      "updated_at" : "2023-06-26T20:20:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1608188265",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   }
]
