[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r218184168"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218184168"
         }
      },
      "author_association" : "MEMBER",
      "body" : "By definition, the first opcode must be executed because `vfExec` is empty and without any false item. So `fExec` must be true at the beginning",
      "commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "created_at" : "2018-09-17T18:47:37Z",
      "diff_hunk" : "@@ -294,6 +294,7 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n     opcodetype opcode;\n     valtype vchPushValue;\n     std::vector<bool> vfExec;\n+    bool fExec = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r218184168",
      "id" : 218184168,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxODE4NDE2OA==",
      "original_commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "original_position" : 4,
      "path" : "src/script/interpreter.cpp",
      "position" : 4,
      "pull_request_review_id" : 156066834,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245",
      "updated_at" : "2018-09-17T19:32:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218184168",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/8403418?v=4",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "node_id" : "MDQ6VXNlcjg0MDM0MTg=",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r218184778"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218184778"
         }
      },
      "author_association" : "MEMBER",
      "body" : "value of `fExec` may change only if an `IF`, `NOTIF`, `ELSE`, or `ENDIF` is encountered. No other opcode may flip `fExec`. So we don't need to redo it for every opcode, just after `IF`, `NOTIF`, `ELSE`, or `ENDIF`",
      "commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "created_at" : "2018-09-17T18:49:39Z",
      "diff_hunk" : "@@ -305,8 +306,6 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n     {\n         while (pc < pend)\n         {\n-            bool fExec = !count(vfExec.begin(), vfExec.end(), false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r218184778",
      "id" : 218184778,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxODE4NDc3OA==",
      "original_commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "original_position" : 12,
      "path" : "src/script/interpreter.cpp",
      "position" : 12,
      "pull_request_review_id" : 156067626,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245",
      "updated_at" : "2018-09-17T19:05:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218184778",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/8403418?v=4",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "node_id" : "MDQ6VXNlcjg0MDM0MTg=",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r218186741"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218186741"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in `OP_IF`, if `fExec` is true, the original `vfExec` must be by definition all true. Since `fValue` is added to the end of `vfExec`, the new `fExec` value must be same as `fValue`\r\n\r\nIf `fExec` is false, a false will be added to `vfExec`, and by definition `fExec` will remain false, so we don't need to do anything",
      "commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "created_at" : "2018-09-17T18:54:44Z",
      "diff_hunk" : "@@ -485,6 +484,7 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                         if (opcode == OP_NOTIF)\n                             fValue = !fValue;\n                         popstack(stack);\n+                        fExec = fValue;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r218186741",
      "id" : 218186741,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxODE4Njc0MQ==",
      "original_commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "original_position" : 21,
      "path" : "src/script/interpreter.cpp",
      "position" : 21,
      "pull_request_review_id" : 156069620,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245",
      "updated_at" : "2018-09-17T18:54:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218186741",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/8403418?v=4",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "node_id" : "MDQ6VXNlcjg0MDM0MTg=",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r218188542"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218188542"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in `OP_ELSE`, if `fExec` is true, the original `vfExec` must be by definition all true. Since `OP_ELSE` will flip the last `vfExec` item, the resulting `vfExec` must have exactly one false at the end. So we know `fExec` must become false.\r\n\r\nIf `fExec` is false, there is at least one false in `vfExec` but we don't know where it is, so we have to count as usual (`fExec` will flip if and only if the original `vfExec` had exactly one false at the end)",
      "commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "created_at" : "2018-09-17T18:59:34Z",
      "diff_hunk" : "@@ -495,6 +495,7 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                     if (vfExec.empty())\n                         return set_error(serror, SCRIPT_ERR_UNBALANCED_CONDITIONAL);\n                     vfExec.back() = !vfExec.back();\n+                    fExec = fExec ? false : !count(vfExec.begin(), vfExec.end(), false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r218188542",
      "id" : 218188542,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxODE4ODU0Mg==",
      "original_commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "original_position" : 29,
      "path" : "src/script/interpreter.cpp",
      "position" : 29,
      "pull_request_review_id" : 156071559,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245",
      "updated_at" : "2018-09-17T19:15:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218188542",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/8403418?v=4",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "node_id" : "MDQ6VXNlcjg0MDM0MTg=",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r218189852"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218189852"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in `OP_ENDIF`, if `fExec` is true, the original `vfExec` must be by definition all true. Since `OP_ENDIF` will simply remove the last `vfExec` item, the resulting `vfExec` must not have any false. So we know `fExec` must remain true.\r\n\r\nIf `fExec` is false, there is at least one false in `vfExec` but we don't know where it is, so we have to count as usual (`fExec` will flip if and only if the original `vfExec` had exactly one false at the end)",
      "commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "created_at" : "2018-09-17T19:02:31Z",
      "diff_hunk" : "@@ -503,6 +504,7 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                     if (vfExec.empty())\n                         return set_error(serror, SCRIPT_ERR_UNBALANCED_CONDITIONAL);\n                     vfExec.pop_back();\n+                    fExec = fExec ? true : !count(vfExec.begin(), vfExec.end(), false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r218189852",
      "id" : 218189852,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxODE4OTg1Mg==",
      "original_commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "original_position" : 37,
      "path" : "src/script/interpreter.cpp",
      "position" : 37,
      "pull_request_review_id" : 156072679,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245",
      "updated_at" : "2018-09-17T19:15:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/218189852",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/8403418?v=4",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "node_id" : "MDQ6VXNlcjg0MDM0MTg=",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r219417547"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219417547"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```\r\n2018-09-20 01:47:27 cppcheck(pr=14245): [src/script/interpreter.cpp:297]: (style) The scope of the variable 'fExec' can be reduced.\r\n```",
      "commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "created_at" : "2018-09-21T08:19:14Z",
      "diff_hunk" : "@@ -294,6 +294,7 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n     opcodetype opcode;\n     valtype vchPushValue;\n     std::vector<bool> vfExec;\n+    bool fExec = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r219417547",
      "id" : 219417547,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTQxNzU0Nw==",
      "original_commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "original_position" : 4,
      "path" : "src/script/interpreter.cpp",
      "position" : 4,
      "pull_request_review_id" : 157588016,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245",
      "updated_at" : "2018-09-21T08:19:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219417547",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r219666339"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666339"
         }
      },
      "author_association" : "MEMBER",
      "body" : "yes, but a few variables there, like nOpCount, can be reduced as well",
      "commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "created_at" : "2018-09-22T09:19:44Z",
      "diff_hunk" : "@@ -294,6 +294,7 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n     opcodetype opcode;\n     valtype vchPushValue;\n     std::vector<bool> vfExec;\n+    bool fExec = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14245#discussion_r219666339",
      "id" : 219666339,
      "in_reply_to_id" : 219417547,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY2NjMzOQ==",
      "original_commit_id" : "f3155ea50ce4c085cc37d243508ab235fe71a6f9",
      "original_position" : 4,
      "path" : "src/script/interpreter.cpp",
      "position" : 4,
      "pull_request_review_id" : 157904524,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14245",
      "updated_at" : "2018-09-22T09:19:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666339",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/8403418?v=4",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "node_id" : "MDQ6VXNlcjg0MDM0MTg=",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   }
]
