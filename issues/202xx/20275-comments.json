[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\nIn 606622195fdf6a1fb6adc41d1091ce2ae7501125 commit message:\r\n> \"Remove circular dependencies between wallet translation units\"\r\n\r\nWhat are those dependencies?",
      "created_at" : "2020-10-30T21:34:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20275#issuecomment-719810438",
      "id" : 719810438,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20275",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxOTgxMDQzOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-30T21:34:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/719810438",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> What are those dependencies?\r\n\r\nOh, I think I need to drop that comment. The dependency I was thinking of was `walletutil.cpp` depending on `bdb.cpp` for `ExistsBerkeleyDatabase`, and `bdb.cpp` depending on `walletutil.cpp` for `SplitWalletPath`. And I thought there were others. But actually `SplitWalletPath` is in `db.cpp` not `walletutil.cpp`, and now I don't think there are other dependencies.",
      "created_at" : "2020-10-30T21:47:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20275#issuecomment-719815071",
      "id" : 719815071,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20275",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxOTgxNTA3MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-30T21:47:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/719815071",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20267 (Disable and fix tests for when BDB is not compiled by achow101)\n* #20206 (wallet, refactor: Include headers instead of function declarations by hebasto)\n* #20202 (wallet: Make BDB support optional by achow101)\n* #19502 (Bugfix: Wallet: Soft-fail exceptions within ListWalletDir file checks by luke-jr)\n* #18836 (wallet: upgradewallet fixes and additional tests by achow101)\n* #18095 (Fix crashes and infinite loop in ListWalletDir() by uhliksk)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-10-30T23:58:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20275#issuecomment-719849943",
      "id" : 719849943,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20275",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxOTg0OTk0Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-30T23:58:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/719849943",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20275#discussion_r515641690"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20275"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/515641690"
         }
      },
      "author_association" : "MEMBER",
      "body" : "9d1fd52952cb6a944e7de4dd7fca241e3341894b\r\n\r\nAs a next step it would be nice to refactor this and `MakeWalletDatabase` to avoid duplicate code. Something like:\r\n```cpp\r\nDatabaseStatus CheckWalletDatabase(const fs::path& path);\r\nDatabaseStatus CheckWalletDatabase(const std::string& name)\r\n{\r\n    return CheckWalletDatabase(fs::absolute(name, GetWalletDir()));\r\n}\r\n```\r\nWhich would be called in both places.",
      "commit_id" : "e21dc6c05c02a0da18b9af2c0eb1d7996c378541",
      "created_at" : "2020-11-01T16:23:34Z",
      "diff_hunk" : "@@ -34,10 +27,10 @@ std::vector<fs::path> ListDatabases(const fs::path& wallet_dir)\n         const fs::path path = it->path().string().substr(offset);\n \n         if (it->status().type() == fs::directory_file &&\n-            (ExistsBerkeleyDatabase(it->path()) || ExistsSQLiteDatabase(it->path()))) {\n+            (IsBDBFile(BDBDataFile(it->path())) || IsSQLiteFile(SQLiteDataFile(it->path())))) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20275#discussion_r515641690",
      "id" : 515641690,
      "line" : 30,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxNTY0MTY5MA==",
      "original_commit_id" : "9d1fd52952cb6a944e7de4dd7fca241e3341894b",
      "original_line" : 30,
      "original_position" : 19,
      "original_start_line" : null,
      "path" : "src/wallet/db.cpp",
      "position" : 30,
      "pull_request_review_id" : 521239205,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20275",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-11-01T16:23:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/515641690",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   }
]
