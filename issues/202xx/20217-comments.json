[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20217#discussion_r510099354"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20217"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510099354"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Any reason to change the name from relay_txes to blocks_only? With block-relay-only connections, I'd prefer to stick to the old name to avoid confusion.\r\n\r\nThe purpose is to ignore incoming inv and tx messages, so another name suggestion could be `ignore_incoming_tx_relay`, as outgoing tx relay is unaffected.",
      "commit_id" : "a5c853572cb2d18467666cd250ecebb43659c29e",
      "created_at" : "2020-10-22T11:53:51Z",
      "diff_hunk" : "@@ -1404,7 +1404,10 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     node.chainman = &g_chainman;\n     ChainstateManager& chainman = *Assert(node.chainman);\n \n-    node.peerman.reset(new PeerManager(chainparams, *node.connman, node.banman.get(), *node.scheduler, chainman, *node.mempool));\n+    assert(!node.peerman);\n+    const bool blocks_only = args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#discussion_r510099354",
      "id" : 510099354,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA5OTM1NA==",
      "original_commit_id" : "45e81e1eb27da3173191657f6863097b64bb774c",
      "original_line" : 1408,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 514642084,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20217",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-22T12:34:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510099354",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20217#discussion_r510111999"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20217"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510111999"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    /** Whether to ignore incoming tx relay traffic */\r\n```",
      "commit_id" : "a5c853572cb2d18467666cd250ecebb43659c29e",
      "created_at" : "2020-10-22T12:15:58Z",
      "diff_hunk" : "@@ -94,6 +95,9 @@ class PeerManager final : public CValidationInterface, public NetEventsInterface\n      */\n     void Misbehaving(const NodeId pnode, const int howmuch, const std::string& message);\n \n+    /** Whether this node is in blocks only mode */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#discussion_r510111999",
      "id" : 510111999,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDExMTk5OQ==",
      "original_commit_id" : "45e81e1eb27da3173191657f6863097b64bb774c",
      "original_line" : 98,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/net_processing.h",
      "position" : null,
      "pull_request_review_id" : 514642084,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20217",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-22T12:34:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510111999",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20217#discussion_r510124282"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20217"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510124282"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "a5c853572cb2d18467666cd250ecebb43659c29e",
      "created_at" : "2020-10-22T12:35:31Z",
      "diff_hunk" : "@@ -1404,7 +1404,10 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     node.chainman = &g_chainman;\n     ChainstateManager& chainman = *Assert(node.chainman);\n \n-    node.peerman.reset(new PeerManager(chainparams, *node.connman, node.banman.get(), *node.scheduler, chainman, *node.mempool));\n+    assert(!node.peerman);\n+    const bool blocks_only = args.GetBoolArg(\"-blocksonly\", DEFAULT_BLOCKSONLY);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#discussion_r510124282",
      "id" : 510124282,
      "in_reply_to_id" : 510099354,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEyNDI4Mg==",
      "original_commit_id" : "45e81e1eb27da3173191657f6863097b64bb774c",
      "original_line" : 1408,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : null,
      "pull_request_review_id" : 514675299,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20217",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-22T12:35:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510124282",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20217#discussion_r510124382"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20217"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510124382"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "a5c853572cb2d18467666cd250ecebb43659c29e",
      "created_at" : "2020-10-22T12:35:39Z",
      "diff_hunk" : "@@ -94,6 +95,9 @@ class PeerManager final : public CValidationInterface, public NetEventsInterface\n      */\n     void Misbehaving(const NodeId pnode, const int howmuch, const std::string& message);\n \n+    /** Whether this node is in blocks only mode */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#discussion_r510124382",
      "id" : 510124382,
      "in_reply_to_id" : 510111999,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEyNDM4Mg==",
      "original_commit_id" : "45e81e1eb27da3173191657f6863097b64bb774c",
      "original_line" : 98,
      "original_position" : 14,
      "original_start_line" : null,
      "path" : "src/net_processing.h",
      "position" : null,
      "pull_request_review_id" : 514675417,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20217",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-10-22T12:35:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510124382",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for the review @MarcoFalke. I've taken your suggested name change.",
      "created_at" : "2020-10-22T12:36:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-714463448",
      "id" : 714463448,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNDQ2MzQ0OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-22T12:36:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/714463448",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK: globals going down is good!",
      "created_at" : "2020-10-22T18:53:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-714692988",
      "id" : 714692988,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNDY5Mjk4OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-22T18:53:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/714692988",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20228 (addrman: Make addrman a top-level component by jnewbery)\n* #19910 (net processing: Move peer_map to PeerManager by jnewbery)\n* #19858 (Periodically make block-relay connections and sync headers by sdaftuar)\n* #18766 (Disable fee estimation in blocksonly mode (by removing the fee estimates global) by darosior)\n* #18354 (Use shared pointers only in validation interface by bvbfan)\n* #18261 (Erlay: bandwidth-efficient transaction relay protocol by naumenkogs)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-10-22T22:42:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-714802431",
      "id" : 714802431,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNDgwMjQzMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-18T12:24:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/714802431",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-10-23T02:57:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-714876342",
      "id" : 714876342,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxNDg3NjM0Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-23T02:57:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/714876342",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-11-04T12:53:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-721714352",
      "id" : 721714352,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMTcxNDM1Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-04T12:53:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/721714352",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased",
      "created_at" : "2020-11-04T14:51:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-721778001",
      "id" : 721778001,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMTc3ODAwMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-04T14:51:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/721778001",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK 179616f8211883739df6e06852bd976dcdd0c3c9",
      "created_at" : "2020-11-05T02:11:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-722080461",
      "id" : 722080461,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMjA4MDQ2MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-05T02:11:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/722080461",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "code review ACK. \r\n\r\nI was confused about the relationship between g_relay_txes (now m_ignore_incoming_txs) and m_tx_relay.  I think it's if m_tx_relay is null, this is a blocks-only peer, and if m_ignore_incoming_txs is true, I am a blocks-only peer. Is that right? I think unifying everything under names with \"blocks-only\" would be clearer but is out of scope for this change.",
      "created_at" : "2020-11-14T23:07:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-727278496",
      "id" : 727278496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzI3ODQ5Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-14T23:07:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727278496",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/177646?v=4",
         "events_url" : "https://api.github.com/users/narula/events{/privacy}",
         "followers_url" : "https://api.github.com/users/narula/followers",
         "following_url" : "https://api.github.com/users/narula/following{/other_user}",
         "gists_url" : "https://api.github.com/users/narula/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/narula",
         "id" : 177646,
         "login" : "narula",
         "node_id" : "MDQ6VXNlcjE3NzY0Ng==",
         "organizations_url" : "https://api.github.com/users/narula/orgs",
         "received_events_url" : "https://api.github.com/users/narula/received_events",
         "repos_url" : "https://api.github.com/users/narula/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/narula/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/narula/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/narula"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yes, this has been confusing for people, which is why I think it's important to be precise with terminology:\r\n\r\n- a block-relay-only connection is a type of connection to a peer where we only send and process blocks. We do not send or process transactions or addresses to/from that peer. We'll request that the peer not send us transactions by setting `relay` to 0 in the `version` message that we send to them. We also won't initialize the `m_tx_relay` data structure for that peer, since we're not doing tx relay with them.\r\n- `-blocksonly` mode is a configuration option where we don't process transactions from any of our peers. We'll set `relay` to 0 in all of our `version` messages. It's mostly used to reduce bandwidth usage for people who don't need a mempool.\r\n\r\n>  think unifying everything under names with \"blocks-only\" would be clearer\r\n\r\nI think that's probably _less_ clear since it would confuse those two concepts.",
      "created_at" : "2020-11-16T10:08:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-727876700",
      "id" : 727876700,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzg3NjcwMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-16T10:08:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727876700",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> * a block-relay-only connection is a type of connection to a peer where we only send and process blocks. We do not send or process transactions or addresses to/from that peer. We'll request that the peer not send us transactions by setting `relay` to 0 in the `version` message that we send to them. We also won't initialize the `m_tx_relay` data structure for that peer, since we're not doing tx relay with them.\r\n> * `-blocksonly` mode is a configuration option where we don't process transactions from any of our peers. We'll set `relay` to 0 in all of our `version` messages. It's mostly used to reduce bandwidth usage for people who don't need a mempool.\r\n\r\nHmm, these still seem like the same concept to me but I'm probably missing something; let me ask the question in a different way: What is the difference between me being a `-blocksonly` node and me setting _all_ of my connections to `block-relay-only` (let's hypothetically say you could)? Is it how the node addresses incoming transactions? If there is no difference, I would say they are the same concept?",
      "created_at" : "2020-11-16T17:09:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-728197751",
      "id" : 728197751,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyODE5Nzc1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-16T17:09:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/728197751",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/177646?v=4",
         "events_url" : "https://api.github.com/users/narula/events{/privacy}",
         "followers_url" : "https://api.github.com/users/narula/followers",
         "following_url" : "https://api.github.com/users/narula/following{/other_user}",
         "gists_url" : "https://api.github.com/users/narula/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/narula",
         "id" : 177646,
         "login" : "narula",
         "node_id" : "MDQ6VXNlcjE3NzY0Ng==",
         "organizations_url" : "https://api.github.com/users/narula/orgs",
         "received_events_url" : "https://api.github.com/users/narula/received_events",
         "repos_url" : "https://api.github.com/users/narula/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/narula/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/narula/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/narula"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> What is the difference between me being a -blocksonly node and me setting all of my connections to block-relay-only (let's hypothetically say you could)?\r\n\r\nSome differences:\r\n\r\n- block-relay-only isn't a configuration option. The user has no control over how many block-relay-only connections the node makes, or to which addresses.\r\n- in `-blocksonly` mode, we still participate in address relay (we send getaddr messages to our peers, process the addr messages in response, and gossip new incoming addresses). block-relay-only connections do not participate in address relay, to preserve the privacy of those connections.\r\n- in `-blocksonly` mode, we could theoretically turn off other components, such as the fee estimator (which relies on participating in p2p transaction relay). #18766 does that. \r\n- block-relay-only connections are persisted across restart as 'anchor connections'.\r\n\r\nThere may be others.",
      "created_at" : "2020-11-16T17:52:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-728223762",
      "id" : 728223762,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyODIyMzc2Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-16T17:52:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/728223762",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> > What is the difference between me being a -blocksonly node and me setting all of my connections to block-relay-only (let's hypothetically say you could)?\r\n> \r\n> Some differences:\r\n> \r\n> * block-relay-only isn't a configuration option. The user has no control over how many block-relay-only connections the node makes, or to which addresses.\r\n> * in `-blocksonly` mode, we still participate in address relay (we send getaddr messages to our peers, process the addr messages in response, and gossip new incoming addresses). block-relay-only connections do not participate in address relay, to preserve the privacy of those connections.\r\n> * in `-blocksonly` mode, we could theoretically turn off other components, such as the fee estimator (which relies on participating in p2p transaction relay). #18766 does that.\r\n> * block-relay-only connections are persisted across restart as 'anchor connections'.\r\n> \r\n> There may be others.\r\n\r\nThank you, that's very helpful! Just to wrap up, it sounds like in my thought experiment (a hypothetical node with all block-relay-only connections vs. a node with `-blocksonly`) the applicable differences are bullet points 2 and 4, in that the `-blocksonly` node would still send around and process addrs and its connections would not be persisted across restart. \r\n\r\nThis makes sense because in `-blocksonly` mode a node still needs to learn about other nodes, so processing addrs is important.  block-relay-only connections were never designed to be all of the connections, so it's fine for them not to process addrs because the node can rely on the other connections to do that. \r\n\r\nWe wouldn't want to persist all connections across a restart (https://github.com/bitcoin/bitcoin/issues/17326#issuecomment-550521262), but because block-relay-only connections are more privacy-preserving and they are extra connections (we can rely on the other connections cycling) it's fine for them to be persisted. And persisting them sort of helps with eclipse attacks (https://github.com/bitcoin/bitcoin/issues/17326).\r\n\r\nI think I'm confused because the check for block-relay-only connections in the code is sometimes to see if m_tx_relay exists, which is non-intuitive because block-relay-only also implies that addrs are not gossiped with this peer either, not just transactions, and sometimes to call `IsBlockOnlyConn()`.\r\n\r\nI think the new name for !g_relay_txes, m_ignore_incoming_txs, is much clearer.",
      "created_at" : "2020-11-16T19:29:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-728275457",
      "id" : 728275457,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyODI3NTQ1Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-16T19:29:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/728275457",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/177646?v=4",
         "events_url" : "https://api.github.com/users/narula/events{/privacy}",
         "followers_url" : "https://api.github.com/users/narula/followers",
         "following_url" : "https://api.github.com/users/narula/following{/other_user}",
         "gists_url" : "https://api.github.com/users/narula/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/narula",
         "id" : 177646,
         "login" : "narula",
         "node_id" : "MDQ6VXNlcjE3NzY0Ng==",
         "organizations_url" : "https://api.github.com/users/narula/orgs",
         "received_events_url" : "https://api.github.com/users/narula/received_events",
         "repos_url" : "https://api.github.com/users/narula/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/narula/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/narula/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/narula"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I think I'm confused because the check for block-relay-only connections in the code is sometimes to see if m_tx_relay exists, which is non-intuitive because block-relay-only also implies that addrs are not gossiped with this peer either, not just transactions, and sometimes to call IsBlockOnlyConn().\r\n\r\n`IsBlockOnlyConn()` was added later, and I think is much clearer since it's instantly obvious what the test is for, rather than `if (m_tx_relay)`, which might just be defensive code to ensure that a null ptr isn't dererenced. I'd support a PR that made changes like:\r\n\r\n```diff\r\ndiff --git a/src/net_processing.cpp b/src/net_processing.cpp\r\nindex a69efa4fc0..3ea2c1a1f9 100644\r\n--- a/src/net_processing.cpp\r\n+++ b/src/net_processing.cpp\r\n@@ -1657,7 +1657,7 @@ void static ProcessGetData(CNode& pfrom, Peer& peer, const CChainParams& chainpa\r\n \r\n         const CInv &inv = *it++;\r\n \r\n-        if (pfrom.m_tx_relay == nullptr) {\r\n+        if (peer.IsBlockOnlyConn()) {\r\n             // Ignore GETDATA requests for transactions from blocks-only peers.\r\n             continue;\r\n         }\r\n```\r\n\r\nThat's out of scope for this PR.\r\n\r\n> I think the new name for !g_relay_txes, m_ignore_incoming_txs, is much clearer.\r\n\r\nGreat. @MarcoFalke gets credit for that!",
      "created_at" : "2020-11-19T11:20:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-730305922",
      "id" : 730305922,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20217",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDczMDMwNTkyMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-19T11:20:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/730305922",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
