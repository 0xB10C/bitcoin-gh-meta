[
   {
      "author_association" : "MEMBER",
      "body" : "Nice improvement, concept ACK.",
      "created_at" : "2018-05-23T08:57:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13309#issuecomment-391273351",
      "id" : 391273351,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13309",
      "updated_at" : "2018-05-23T08:57:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/391273351",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13309#discussion_r190177627"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13309"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/190177627"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why drop `explicit` here? I don't see changes to the call sites.",
      "commit_id" : "b4fa297e7e293c125617c5a9f82a031e174da086",
      "created_at" : "2018-05-23T09:19:50Z",
      "diff_hunk" : "@@ -124,7 +124,8 @@ struct PrecomputedTransactionData\n     uint256 hashPrevouts, hashSequence, hashOutputs;\n     bool ready = false;\n \n-    explicit PrecomputedTransactionData(const CTransaction& tx);\n+    template<class T>\n+    PrecomputedTransactionData(const T& tx);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13309#discussion_r190177627",
      "id" : 190177627,
      "original_commit_id" : "c3e1a21902ebe36b444b4a365783614c5117eb77",
      "original_position" : 6,
      "path" : "src/script/interpreter.h",
      "position" : null,
      "pull_request_review_id" : 122498647,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13309",
      "updated_at" : "2018-05-23T11:55:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/190177627",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2018-05-23T09:25:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13309#issuecomment-391281933",
      "id" : 391281933,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13309",
      "updated_at" : "2018-05-23T09:25:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/391281933",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13309#discussion_r190182210"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13309"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/190182210"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit, drop `Generic` prefix?",
      "commit_id" : "b4fa297e7e293c125617c5a9f82a031e174da086",
      "created_at" : "2018-05-23T09:34:23Z",
      "diff_hunk" : "@@ -160,10 +162,11 @@ class BaseSignatureChecker\n     virtual ~BaseSignatureChecker() {}\n };\n \n-class TransactionSignatureChecker : public BaseSignatureChecker\n+template<class T>\n+class GenericTransactionSignatureChecker : public BaseSignatureChecker",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13309#discussion_r190182210",
      "id" : 190182210,
      "original_commit_id" : "c3e1a21902ebe36b444b4a365783614c5117eb77",
      "original_position" : 26,
      "path" : "src/script/interpreter.h",
      "position" : 26,
      "pull_request_review_id" : 122504131,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13309",
      "updated_at" : "2018-05-23T11:55:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/190182210",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13309#discussion_r190193752"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13309"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/190193752"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I've added it so that the names `TransactionSignatureChecker` and `MutableTransactionSignatureChecker` are still valid as used before",
      "commit_id" : "b4fa297e7e293c125617c5a9f82a031e174da086",
      "created_at" : "2018-05-23T10:12:13Z",
      "diff_hunk" : "@@ -160,10 +162,11 @@ class BaseSignatureChecker\n     virtual ~BaseSignatureChecker() {}\n };\n \n-class TransactionSignatureChecker : public BaseSignatureChecker\n+template<class T>\n+class GenericTransactionSignatureChecker : public BaseSignatureChecker",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13309#discussion_r190193752",
      "id" : 190193752,
      "in_reply_to_id" : 190182210,
      "original_commit_id" : "c3e1a21902ebe36b444b4a365783614c5117eb77",
      "original_position" : 26,
      "path" : "src/script/interpreter.h",
      "position" : 26,
      "pull_request_review_id" : 122518041,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13309",
      "updated_at" : "2018-05-23T11:55:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/190193752",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13309#discussion_r190197054"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13309"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/190197054"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "you are right, I probably should not drop that.",
      "commit_id" : "b4fa297e7e293c125617c5a9f82a031e174da086",
      "created_at" : "2018-05-23T10:26:22Z",
      "diff_hunk" : "@@ -124,7 +124,8 @@ struct PrecomputedTransactionData\n     uint256 hashPrevouts, hashSequence, hashOutputs;\n     bool ready = false;\n \n-    explicit PrecomputedTransactionData(const CTransaction& tx);\n+    template<class T>\n+    PrecomputedTransactionData(const T& tx);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13309#discussion_r190197054",
      "id" : 190197054,
      "in_reply_to_id" : 190177627,
      "original_commit_id" : "c3e1a21902ebe36b444b4a365783614c5117eb77",
      "original_position" : 6,
      "path" : "src/script/interpreter.h",
      "position" : null,
      "pull_request_review_id" : 122522458,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13309",
      "updated_at" : "2018-05-23T11:55:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/190197054",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14386?v=4",
         "events_url" : "https://api.github.com/users/martinus/events{/privacy}",
         "followers_url" : "https://api.github.com/users/martinus/followers",
         "following_url" : "https://api.github.com/users/martinus/following{/other_user}",
         "gists_url" : "https://api.github.com/users/martinus/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/martinus",
         "id" : 14386,
         "login" : "martinus",
         "organizations_url" : "https://api.github.com/users/martinus/orgs",
         "received_events_url" : "https://api.github.com/users/martinus/received_events",
         "repos_url" : "https://api.github.com/users/martinus/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/martinus/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/martinus/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/martinus"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13309#discussion_r190199966"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13309"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/190199966"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Right.",
      "commit_id" : "b4fa297e7e293c125617c5a9f82a031e174da086",
      "created_at" : "2018-05-23T10:38:45Z",
      "diff_hunk" : "@@ -160,10 +162,11 @@ class BaseSignatureChecker\n     virtual ~BaseSignatureChecker() {}\n };\n \n-class TransactionSignatureChecker : public BaseSignatureChecker\n+template<class T>\n+class GenericTransactionSignatureChecker : public BaseSignatureChecker",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13309#discussion_r190199966",
      "id" : 190199966,
      "in_reply_to_id" : 190182210,
      "original_commit_id" : "c3e1a21902ebe36b444b4a365783614c5117eb77",
      "original_position" : 26,
      "path" : "src/script/interpreter.h",
      "position" : 26,
      "pull_request_review_id" : 122526111,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13309",
      "updated_at" : "2018-05-23T11:55:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/190199966",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK after squash.",
      "created_at" : "2018-05-23T11:32:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13309#issuecomment-391314461",
      "id" : 391314461,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13309",
      "updated_at" : "2018-05-23T11:32:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/391314461",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Very nice!\r\n\r\nConcept ACK",
      "created_at" : "2018-05-23T14:31:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13309#issuecomment-391369000",
      "id" : 391369000,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13309",
      "updated_at" : "2018-05-23T14:31:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/391369000",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13309#discussion_r190677481"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13309"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/190677481"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You don't actually need a template here; all existing uses of `TransactionSignatureCreator` become more efficient to rewrite using `MutableTransactionSignatureCreator` (intuitively this makes sense - you can't add a signature to an immutable transaction):\r\n```diff\r\ndiff --git a/src/wallet/wallet.cpp b/src/wallet/wallet.cpp\r\nindex 2a2f8b5b20..c2b1915b11 100644\r\n--- a/src/wallet/wallet.cpp\r\n+++ b/src/wallet/wallet.cpp\r\n@@ -2608,7 +2608,6 @@ bool CWallet::SignTransaction(CMutableTransaction &tx)\r\n     AssertLockHeld(cs_wallet); // mapWallet\r\n \r\n     // sign the new tx\r\n-    CTransaction txNewConst(tx);\r\n     int nIn = 0;\r\n     for (const auto& input : tx.vin) {\r\n         std::map<uint256, CWalletTx>::const_iterator mi = mapWallet.find(input.prevout.hash);\r\n@@ -2618,7 +2617,7 @@ bool CWallet::SignTransaction(CMutableTransaction &tx)\r\n         const CScript& scriptPubKey = mi->second.tx->vout[input.prevout.n].scriptPubKey;\r\n         const CAmount& amount = mi->second.tx->vout[input.prevout.n].nValue;\r\n         SignatureData sigdata;\r\n-        if (!ProduceSignature(*this, TransactionSignatureCreator(&txNewConst, nIn, amount, SIGHASH_ALL), scriptPubKey, sigdata)) {\r\n+        if (!ProduceSignature(*this, MutableTransactionSignatureCreator(&tx, nIn, amount, SIGHASH_ALL), scriptPubKey, sigdata)) {\r\n             return false;\r\n         }\r\n         UpdateTransaction(tx, nIn, sigdata);\r\n@@ -3040,14 +3039,13 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CTransac\r\n \r\n         if (sign)\r\n         {\r\n-            CTransaction txNewConst(txNew);\r\n             int nIn = 0;\r\n             for (const auto& coin : selected_coins)\r\n             {\r\n                 const CScript& scriptPubKey = coin.txout.scriptPubKey;\r\n                 SignatureData sigdata;\r\n \r\n-                if (!ProduceSignature(*this, TransactionSignatureCreator(&txNewConst, nIn, coin.txout.nValue, SIGHASH_ALL), scriptPubKey, sigdata))\r\n+                if (!ProduceSignature(*this, MutableTransactionSignatureCreator(&txNew, nIn, coin.txout.nValue, SIGHASH_ALL), scriptPubKey, sigdata))\r\n                 {\r\n                     strFailReason = _(\"Signing transaction failed\");\r\n                     return false;\r\n```",
      "commit_id" : "b4fa297e7e293c125617c5a9f82a031e174da086",
      "created_at" : "2018-05-24T17:58:42Z",
      "diff_hunk" : "@@ -36,26 +36,23 @@ class BaseSignatureCreator {\n     virtual bool CreateSig(const SigningProvider& provider, std::vector<unsigned char>& vchSig, const CKeyID& keyid, const CScript& scriptCode, SigVersion sigversion) const =0;\n };\n \n-/** A signature creator for transactions. */\n-class TransactionSignatureCreator : public BaseSignatureCreator {\n-    const CTransaction* txTo;\n+template <class T>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13309#discussion_r190677481",
      "id" : 190677481,
      "original_commit_id" : "b4fa297e7e293c125617c5a9f82a031e174da086",
      "original_position" : 7,
      "path" : "src/script/sign.h",
      "position" : 7,
      "pull_request_review_id" : 123106313,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13309",
      "updated_at" : "2018-05-24T17:59:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/190677481",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
