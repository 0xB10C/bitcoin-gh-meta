[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#17581](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17581.html) (refactor: Remove settings merge reverse precedence code by ryanofsky)\n* [#17580](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17580.html) (refactor: Add ALLOW_LIST flags and enforce usage in CheckArgFlags by ryanofsky)\n* [#17493](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17493.html) (util: Forbid ambiguous multiple assignments in config file by ryanofsky)\n* [#17473](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17473.html) (refactor: Settings code cleanups by ryanofsky)\n* [#17305](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17305.html) (doc: Updated -blocksonly documentation by birtony)\n* [#17127](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17127.html) (util: Correct permissions for datadir and wallets subdir by hebasto)\n* [#16673](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16673.html) (Relog configuration args on debug.log rotation by LarryRuane)\n* [#16545](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16545.html) (refactor: Implement missing error checking for ArgsManager flags by ryanofsky)\n* [#16115](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16115.html) (On bitcoind startup, write config args to debug.log by LarryRuane)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-05-02T00:43:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-488521738",
      "id" : 488521738,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4ODUyMTczOA==",
      "updated_at" : "2019-12-04T18:25:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/488521738",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "NACK, this is redundant with #11082 which is a better solution.",
      "created_at" : "2019-05-02T12:09:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-488648120",
      "id" : 488648120,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4ODY0ODEyMA==",
      "updated_at" : "2019-05-02T12:09:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/488648120",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-488648120\r\n\r\nJust as background, the settings file is not supposed to replace the config file. The settings file is supposed to replace some [`QSettings`](https://doc.qt.io/qt-5/qsettings.html) uses in `bitcoin-qt`, implementing type-safe persistent storage, and sharing this functionality with `bitcoind`, so settings modified at runtime will be stored in a common place regardless of whether you're using the GUI or a plain RPC interface. (You can see in 0ab41dd770c1f13983df528b111cfc8a51fe016a from #15936 how this works in the GUI or in 04c80c40df9fc6f4734ba238ea7f65607cf88089 from #15937 how this can be used in an RPC.)\r\n\r\n> this is redundant with #11082 which is a better solution.\r\n\r\nEvery solution has some tradeoffs, and I'm sure you can elaborate more on advantages of #11082 compared to this. But here are what I see as nice things about this approach:\r\n\r\n- Standard format. The `bitcoin.conf` format works pretty well as a manual configuration mechanism. But the format is unspecified and unstable, and less appealing for use as persistent key/value store compared to JSON which is well understood and supported by many tools and libraries.\r\n\r\n- Uniformity of representation. Since `bitcoin.conf` files are meant to be written by people and parsed by software, it's reasonable for them to provide many ways to do things like represent true/false values (`foo=1` `foo=` `foo=23` `foo=-1`, `nofoo=0` for true / `foo=0` `nofoo=1` `foo=false` for false), or to strip whitespace. But for a file that is meant to be round-trip read and written by software, only accepting plain `true` `false` keywords as bools and not mangling strings is a better way to avoid complexity, configuration errors, and software bugs.\r\n\r\n- Flexibility of representation. `bitcoin.conf` format can't currently represent strings with pound (`#`) or newline characters or strings with various types of whitespace. It can also only awkwardly represent lists by repeating settings (so there is no distinction between a non-list value and a single-element list). I think these things are likely to cause bugs, unnecessary limitations, headaches, and extra boilerplate in application-level code that reads and writes settings.\r\n\r\n- Maintainability. JSON for all that's good and bad about it is stable and usable enough and isn't going to change. Even writing this PR didn't require adding new parsing or formatting code. By contrast, #11082 not only adds new code right now to parse and generate `bitcoin_rw.conf` files, but will also require more work on an ongoing basis whenever the `bitcoin.conf` format is extended, because any new change will now require roundtrip support. (For example if we added an escaping mechanism it would require new code to escape values in addition to new code parsing escapes.)\r\n\r\nThis PR is also not mutually exclusive with #11082. I don't know exactly what features you wanted to implement on top of #11082, but if you are thinking of new features different from #15936 and #13937 that call for injecting settings into a human-edited config file, nothing in this PR should get in the way of that.\r\n\r\nThere were some other issues I had with #11082 when I reviewed it (adding a new `bitcoin.conf` parser instead of extending the existing one, and concerns about init order and inconsistent interpretation of network sections in `bitcoin.conf` and `bitcoin_rw.conf`), but those issues were specific to the implementation and not inherent to the approach.",
      "created_at" : "2019-05-08T20:35:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-490641194",
      "id" : 490641194,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5MDY0MTE5NA==",
      "updated_at" : "2019-05-08T20:35:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/490641194",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\n> Standard format. The bitcoin.conf format works pretty well as a manual configuration mechanism. But the format is unspecified and unstable, and less appealing for use as persistent key/value store compared to JSON which is well understood and supported by many tools and libraries.\r\n\r\nI strongly agree with that.",
      "created_at" : "2019-05-18T10:58:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-493668134",
      "id" : 493668134,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5MzY2ODEzNA==",
      "updated_at" : "2019-05-18T10:58:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/493668134",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "INI is a standard format, supported by at least as many tools and libraries for longer. It has been working fine for bitcoin.conf and rwconf for years now.\r\n\r\nJSON, on the other hand, is fragile, doesn't allow users to add comments, and is currently supposed to only be used for the JSON-RPC/REST interfaces of Core.\r\n\r\nThe only thing to gain over the current INI format would be to avoid rewriting the entire file for changes. JSON doesn't get us that (nor anything else).",
      "created_at" : "2019-05-18T19:52:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-493702800",
      "id" : 493702800,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5MzcwMjgwMA==",
      "updated_at" : "2019-05-18T19:52:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/493702800",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2019-07-02T18:36:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-507796445",
      "id" : 507796445,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNzc5NjQ0NQ==",
      "updated_at" : "2019-07-02T18:36:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/507796445",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept NACK from me too for much the same reasons @luke-jr gives. JSON's fine for a human-readable wire format where programs in different languages need to exchange data (ie, RPC), but it's not a great configuration language at all. I don't think \"the settings file is not supposed to replace the config file\" will hold up -- @jnewbery's already suggesting this be used for user configuration in 16248, eg.",
      "created_at" : "2019-07-03T03:45:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-507926130",
      "id" : 507926130,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwNzkyNjEzMA==",
      "updated_at" : "2019-07-03T03:45:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/507926130",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-507926130\r\n\r\nI can make a more complete response later but I think the quote \"the settings file is not supposed to replace the config file\" is not being understood correctly. I'm using \"config\" there to refer to static configuration and \"settings\" to refer to dynamic configuration (based on bitcoin.conf, which is static, and QSettings, which is dynamic, in current code).\r\n\r\nMy thought is that more advanced command-line / linux type users will want to sit down and write out their configurations in text files with comments, but less advanced users will not be editing text files and will be happy if preferences they set through gui or rpc interfaces are just persisted in a simple format without support for comments. I can write more but @ajtowns, it would be helpful to me if you could say how you would want GUI and runtime settings to be stored ideally (for example, the list of wallets to load on startup).",
      "created_at" : "2019-07-03T10:34:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-508038978",
      "id" : 508038978,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwODAzODk3OA==",
      "updated_at" : "2019-07-03T10:35:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/508038978",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@ryanofsky I think it would make sense to do any of:\r\n\r\n * just keep doing what we're already doing\r\n * switch to a different machine-readable format that can do key-value store but isn't tied to the gui (eg bdb, serialize.h, sqlite)\r\n * have a limited machine-updatable version of our human-readable config format (luke's PR roughly)\r\n * switch to a new format (eg toml, yaml, json5/hjson/hocon, etc) for our human-readable static config, and use the same format (or a restricted version of it) for the machine-modifiable dynamic/persistent config\r\n\r\nIf we stuck with a primarily machine-readable format, having a \"dumpsettings\" / \"loadsettings\" RPC pair that translated that to and from the bitcoin.conf ini-format could be workable for people who want to play with persistent settings outside of the GUI (eg, playing with settings in the gui to get something that seems to work right, then wanting to copy some of them to bitcoind on a different computer).\r\n\r\nI don't think it's realistic to treat json as a \"machine-readable format\" for case 2 because it's both human readable and more powerful than our ini-format so it's an obvious hammer to pick up for static configuration cases where the ini-format is awkward, cf https://github.com/bitcoin/bitcoin/pull/16248#issuecomment-507801090 and https://github.com/bitcoin/bitcoin/pull/16248#issuecomment-507958226 . Maybe we want to make bitcoin.conf json (or a supserset of json), but that ought to be a separate discussion.\r\n\r\nHope that makes sense",
      "created_at" : "2019-07-03T13:07:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-508085274",
      "id" : 508085274,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwODA4NTI3NA==",
      "updated_at" : "2019-07-03T13:07:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/508085274",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@ajtowns, it sounds like your opinion is basically the same as Luke's, and a concrete thing maybe we all would be happy with would be a PR that stores persistent GUI and application settings in an INI file instead of a JSON file.\r\n\r\nIf I am understanding correctly, you are not any citing direct advantages to the INI format for storing dynamic settings, but instead you're making more of a slippery slope precautionary argument: that if we add a way to represent new settings in JSON form, it will encourage creation of ever more complex settings that can be conveniently represented as JSON lists and objects that will be easy to manipulate with GUIs and dynamic configuration, but will be impossible or awkward to represent in INI format. And therefore as a result, even though the settings.json file is intended to be only machine edited, users will end up modifying it anyway and wind up putting settings in a read-write file without comments, that would be more appropriately stored in a read-only file with comments. Let me know if I have this wrong, or if you do think INI format is a better format for dynamic configuration than the JSON format for other reasons that I have not understood.\r\n\r\nBut to follow up, would you be happy with a PR like this one puts settings in a `bitcoin_rw.conf` file with a big warning on top?\r\n\r\n```ini\r\n# bitcoin_rw.conf: Dynamic settings for Bitcoin Core data directory\r\n#\r\n# Warning: DO NOT EDIT this file. Settings in this file can be overridden at\r\n# runtime and comments will be lost. Instead, to statically configure the\r\n# bitcoin node and wallet, create a bitcoin.conf file with the desired settings.\r\n\r\nproxy=host:123\r\nprune=2861\r\nwallet=wallet1\r\nwallet=wallet2\r\n```\r\n\r\ninstead of the current `settings.json` file:\r\n\r\n```json\r\n{\r\n    \"proxy\": \"host:123\",\r\n    \"prune\": 2861,\r\n    \"wallet\": [\"wallet1\", \"wallet2\"]\r\n}\r\n```\r\n\r\nI will respond to other alternatives you suggested, but I think they are all have deficiencies\r\n\r\n> just keep doing what we're already doing\r\n\r\nThe status quo is that we're storing dynamic settings in the registry on windows, in \r\nin `$HOME/.config/Bitcoin/Bitcoin-Qt.conf` files on linux and `$HOME/Library/Preferences` plist files on Mac OS, and that dynamic settings are not tied to the datadir, and not shared between bitcoind and bitcoin-qt. I think this is unfortunate and want to fix this problem before adding support for more dynamic settings.\r\n\r\n> switch to a different machine-readable format that can do key-value store but isn't tied to the gui (eg bdb, serialize.h, sqlite)\r\n\r\nI'm not sure what advantages you see in this approach compared to the current PR, other than that the settings files would be less accessible, so advanced users would be more encouraged to create static configurations where appropriate. I don't mean to be unfair, but I think we could get the same benefit with less code by just tweaking the current PR and having it save `settings.json.gz` or `settings.json.rot13` files that would also be a pain in the ass to edit.\r\n\r\n> have a limited machine-updatable version of our human-readable config format (luke's PR roughly)\r\n\r\nI do think our current format is pretty terrible (stupid about bool, and lists, can't represent strings containing `#`, etc, see previous comments) and I have other specific issues with Luke's PR (again see previous comments). But I could live with this approach and I will attempt to implement it if this PR is dead or going nowhere.\r\n\r\n> switch to a new format (eg toml, yaml, json5/hjson/hocon, etc) for our human-readable static config, and use the same format (or a restricted version of it) for the machine-modifiable dynamic/persistent config\r\n\r\nAs far as I can see (please correct me if I'm mistaken) all of these formats have 0 advantages over plain JSON for dynamic configuration, and very few advantages over current INI format for static configuration, and would trigger lots of bikeshedding, and require new parsing code. I think the major advantage of this over PR _all_ your suggested alternatives but especially this one, is that it's ridiculously simple and requires no new parsing code at all: 70675c3e4975203ad6222ba2b00c83b4e4213793",
      "created_at" : "2019-07-03T14:39:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-508121996",
      "id" : 508121996,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwODEyMTk5Ng==",
      "updated_at" : "2019-07-03T14:39:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/508121996",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> @ajtowns, it sounds like your opinion is basically the same as Luke's, and a concrete thing maybe we all would be happy with would be a PR that stores persistent GUI and application settings in an INI file instead of a JSON file.\r\n\r\nYeah; the benefit of that approach that the json one doesn't have is that you can just cut and paste lines that the gui has created into your permanent bitcoin.conf directly.\r\n\r\n> But to follow up, would you be happy with a PR like this one puts settings in a `bitcoin_rw.conf` file with a big warning on top?\r\n\r\nI think a warning makes sense.\r\n\r\n> The status quo is that we're storing dynamic settings in the registry on windows, in\r\n> in `$HOME/.config/Bitcoin/Bitcoin-Qt.conf` files on linux and `$HOME/Library/Preferences` plist files on Mac OS, and that dynamic settings are not tied to the datadir, and not shared between bitcoind and bitcoin-qt. I think this is unfortunate and want to fix this problem before adding support for more dynamic settings.\r\n\r\nA different approach would be to say \"bitcoin-qt has dynamic settings -- it has a GUI that lets you do dynamic things\" and \"bitcoind does not have dynamic settings\", and decide that's the way it's meant to be. Not having dynamic settings means that if you \"shutdown and restart\" you're back to a clean slate which can be good, and could be appropriate for a gui-less daemon. If so, it could just be enough to have some way of viewing/exporting the current dynamic settings from the gui, so you can paste them into your bitcoin.conf. Not really advocating this, but I think it's actually workable.\r\n\r\n> > switch to a different machine-readable format that can do key-value store but isn't tied to the gui (eg bdb, serialize.h, sqlite) \r\n>\r\n> I'm not sure what advantages you see in this approach compared to the current PR, other than that the settings files would be less accessible, so advanced users would be more encouraged to create static configurations where appropriate.\r\n\r\nIt's more that if you've got \"settings.json\" or \"bitcoin_rw.conf\" sitting around, people are going to go \"ah, great, I see what's going on\" and edit it. If they see an sqlite file, they might fire up sqlite, but it'll have a schema so they'll only be able to touch it in fairly sensible ways. If they see a serialize.h or bdb file, they probably won't touch it, but if they do it'll be using tools that will probably get it right and likely won't be surprised if things break. With a .json (or .json.gz or .ini) they're going to go \"oh cool! look what i found!\" and fire up notepad and mess around, and you need to give detailed error messages to help them find their mistakes and manage expectations so they're not terribly surprised when their formatting/comments/ordering/additions disappear or otherwise get mangled.\r\n\r\nUsing sqlite would get the \"avoid rewriting the entire file for changes\" benefit for whatever that's worth.\r\n\r\n> > have a limited machine-updatable version of our human-readable config format (luke's PR roughly)\r\n> \r\n> I do think our current format is pretty terrible (stupid about bool, and lists, can't represent strings containing `#`, etc, see previous comments)\r\n\r\nI don't disagree, but if that's the problem, let's actually work on it and improve the actual config format. But:\r\n\r\n> As far as I can see (please correct me if I'm mistaken) all of these formats [toml, yaml, json5/hjson/hocon, etc] have 0 advantages over plain JSON for dynamic configuration, and very few advantages over current INI format for static configuration, and would trigger lots of bikeshedding, and require new parsing code. \r\n\r\nThey'd all also require some special handling for upgrading from today's bitcoin.conf to whatever the future one is, which seems like a pain too. But if the conclusion there is \"our custom ini stuff is what's best for bitcoin.conf\" then I don't think it makes sense to complain about how terrible our current format is, if it's still the best we can do.\r\n\r\n> and I have other specific issues with Luke's PR (again see previous comments)\r\n\r\nSure. I suppose I'm obliged to review that PR now too...\r\n\r\n> I think the major advantage of this over PR _all_ your suggested alternatives but especially this one, is that it's ridiculously simple and requires no new parsing code at all\r\n\r\nIf it's the wrong thing, it doesn't really matter how easy it is...",
      "created_at" : "2019-07-03T16:06:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-508156827",
      "id" : 508156827,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwODE1NjgyNw==",
      "updated_at" : "2019-07-03T16:06:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/508156827",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> But I could live with this approach and I will attempt to implement it if this PR is dead or going nowhere.\r\n\r\nNote that this PR was discussed in an IRC meeting here: http://www.erisian.com.au/meetbot/bitcoin-core-dev/2019/bitcoin-core-dev.2019-01-10-19.00.log.html#l-175\r\n\r\nSeveral contributors there were in favour of this approach because it's less code (@jonasschnelli , @jimpo , @jamesob , @laanwj ). As far as I'm concerned that means this approach still has far more concept ACKs than NACKs (but any of those contributors should speak up if they've changed their minds).",
      "created_at" : "2019-07-10T09:11:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-509979967",
      "id" : 509979967,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUwOTk3OTk2Nw==",
      "updated_at" : "2019-07-10T09:11:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/509979967",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Note this PR didn't exist yet at the time of the IRC discussion. In any case, I tend to be more interested in reasoning behind NACKs, and how specific concerns can be addressed, than just their gut level responses. For example, Luke seemed to be concerned with comments and comment preservation in the dynamic configuration file, which could be addressed with code to read/write the dynamic configuration in ini format instead of json format. AJ seemed skeptical of dynamic configuration for bitcoind in general, and I definitely think there should be a way to turn off dynamic configuration (gray out dynamic configuration in gui, return errors from RPCs that would try to save a persistent setting).",
      "created_at" : "2019-07-10T11:24:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-510021419",
      "id" : 510021419,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxMDAyMTQxOQ==",
      "updated_at" : "2019-07-10T11:24:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/510021419",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">Several contributors there were in favour of this approach because it's less code\r\n\r\nBut it's not really. UniValue is more code than updating the INI file. And until now, we have had a policy (that IMO we should keep) to only use UniValue in the JSON-RPC code.",
      "created_at" : "2019-07-10T11:30:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-510023127",
      "id" : 510023127,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxMDAyMzEyNw==",
      "updated_at" : "2019-07-10T11:30:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/510023127",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> we have had a policy (that IMO we should keep) to only use UniValue in the JSON-RPC code\r\n\r\n@luke-jr, I think I've heard of this policy before, but maybe didn't take it seriously. Does it come from an objection to the JSON format, or problems with the univalue implementation, or something else? I wouldn't want univalue to used in application code (in wallet code or consensus code) because string lookups and variant typing lead to c++ code that's verbose, messy, and fragile. But at an API layer, or for accessing config data, univalue seems pretty well-suited, so I wonder what the concerns about it are or were.",
      "created_at" : "2019-07-10T12:02:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-510032259",
      "id" : 510032259,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxMDAzMjI1OQ==",
      "updated_at" : "2019-07-10T12:02:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/510032259",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK\r\n\r\nRationale:\r\n\r\n> Standard format. The bitcoin.conf format works pretty well as a manual configuration mechanism. But the format is unspecified and unstable, and less appealing for use as persistent key/value store compared to JSON which is well understood and supported by many tools and libraries.",
      "created_at" : "2019-07-10T15:58:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-510122585",
      "id" : 510122585,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxMDEyMjU4NQ==",
      "updated_at" : "2019-07-10T15:58:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/510122585",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think `bitcoin.conf` is easier to use than a json file by scripting languages.\r\nIt is easy to add one line to bitcoin.conf, but adding one node to a json file? It requires additional dependencies.",
      "created_at" : "2019-07-26T03:55:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-515299233",
      "id" : 515299233,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNTI5OTIzMw==",
      "updated_at" : "2019-07-26T03:55:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/515299233",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/3020646?v=4",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "node_id" : "MDQ6VXNlcjMwMjA2NDY=",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@NicolasDorier, can you clarify your use case? `settings.json` does not replace `bitcoin.conf` and should not be used for static configuration. It replaces QSettings (see #15936) and is used for dynamic configuration. It's database of settings updated dynamically while bitcoin is running, similar to peers.dat or fee_estimates.dat, only it happens to be in a human readable format.",
      "created_at" : "2019-07-26T04:42:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-515306463",
      "id" : 515306463,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNTMwNjQ2Mw==",
      "updated_at" : "2019-07-26T04:42:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/515306463",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ryanofsky ah ok then this make sense. I was worried that some configuration thing start becoming spread in different files in different format, but this is not the case here.",
      "created_at" : "2019-07-26T07:56:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-515350760",
      "id" : 515350760,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNTM1MDc2MA==",
      "updated_at" : "2019-07-26T07:56:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/515350760",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/3020646?v=4",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "node_id" : "MDQ6VXNlcjMwMjA2NDY=",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Software should be modifying bitcoin_rw.conf/settings.json, not  bitcoin.conf",
      "created_at" : "2019-07-26T12:43:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-515435882",
      "id" : 515435882,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNTQzNTg4Mg==",
      "updated_at" : "2019-07-26T12:43:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/515435882",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Software should be modifying bitcoin_rw.conf/settings.json, not bitcoin.conf\r\n\r\nIt makes sense for deployment software to generate and modify bitcoin.conf files. Specifically configuration software like ansible, package managers like nix or guix, build scripts like docker files, should all be setting up their deployments through bitcoin.conf. Managing static software configurations is a big part of what these tools do and why they exist.\r\n\r\nFor bitcoin_rw.conf/settings.json, there are some exceptions I could think of, but mainly I think the only tool that will want to write these files is bitcoin itself. Partly this is due to safety, because with features like #15936 and #15937, settings can change any time while bitcoin is running, so external programs trying to modify these files could see their updates lost. But more importantly, a major motivation for wanting to add dynamic settings is to provide new, less cumbersome ways of updating settings than the raw file system. A user is less likely to screw up something like pruning when the way to enable it is to type a command like `bitcoin-cli config prune 3gb`, and get instant error checking and feedback, than to have to locate their datadir, open a text editor, make changes without running afoul of ini sections syntax and precedence rules, stop bitcoin, restart bitcoin, and check the logs to verify their changes picked up.\r\n\r\nBitcoin isn't pure server software that only needs static configuration, and it isn't pure application software that only needs dynamic configuration. It's P2P software that should support both static and dynamic configuration for different use cases. My expectation is that server admins and advanced users will use bitcoin.conf just like now and always, and for a lot of them to disable dynamic configuration. I would expect more typical users to have no bitcoin.conf file, or only a minimal one from their distro or package manager, and to manage settings through GUI and command interfaces without editing text files.",
      "created_at" : "2019-07-26T17:23:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-515534538",
      "id" : 515534538,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNTUzNDUzOA==",
      "updated_at" : "2019-07-26T17:24:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/515534538",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The base PR #15934 is merged. Looking forward to reviewing this once it's rebased!",
      "created_at" : "2019-11-11T23:06:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-552657675",
      "id" : 552657675,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1MjY1NzY3NQ==",
      "updated_at" : "2019-11-11T23:06:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/552657675",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\n>    - Standard format. The `bitcoin.conf` format works pretty well as a manual configuration mechanism. But the format is unspecified and unstable, and less appealing for use as persistent key/value store compared to JSON which is well understood and supported by many tools and libraries.\r\n\r\nThere are many JSON standards (e.g., ISO/IEC 21778, ECMA-404). Could we point the one which UniValue complies to?",
      "created_at" : "2020-01-13T09:14:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-573569801",
      "id" : 573569801,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MzU2OTgwMQ==",
      "updated_at" : "2020-01-14T07:09:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/573569801",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think this PR goes into the right direction and it has a few concept ACKs. @ryanofsky: can you take it out of the draft mode to get final reviews?",
      "created_at" : "2020-05-29T07:28:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-635810266",
      "id" : 635810266,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNTgxMDI2Ng==",
      "updated_at" : "2020-05-29T07:28:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/635810266",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15935#discussion_r435743918"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15935"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/435743918"
         }
      },
      "author_association" : "MEMBER",
      "body" : "These logprints are currently going nowhere because `InitLogging()` is called after `ReadSettingsFile()`. Not saying it is a problem.",
      "commit_id" : "eb966f421c9365e232627209687e6506089deb34",
      "created_at" : "2020-06-05T07:40:27Z",
      "diff_hunk" : "@@ -372,6 +373,86 @@ bool ArgsManager::IsArgSet(const std::string& strArg) const\n     return !GetSetting(strArg).isNull();\n }\n \n+static bool GetSettingsPath(fs::path* filepath = nullptr, bool temp = false)\n+{\n+    if (gArgs.IsArgNegated(\"-settings\")) return false;\n+    if (filepath) {\n+        std::string settings = gArgs.GetArg(\"-settings\", BITCOIN_SETTINGS_FILENAME);\n+        *filepath = fs::absolute(temp ? settings + \".tmp\" : settings, GetDataDir(/* net_specific= */ true));\n+    }\n+    return true;\n+}\n+\n+bool ArgsManager::EnableSettingsFile()\n+{\n+    return GetSettingsPath();\n+}\n+\n+bool ArgsManager::ReadSettingsFile()\n+{\n+    fsbridge::ifstream file;\n+    fs::path filepath;\n+    if (!GetSettingsPath(&filepath, /* temp= */ false)) return true;\n+    file.open(filepath);\n+    if (!file.is_open()) return true; // Ok for file not to exist.\n+\n+    util::SettingsValue in;\n+    if (!in.read(std::string{std::istreambuf_iterator<char>(file), std::istreambuf_iterator<char>()})) {\n+        LogPrintf(\"Error: Unable to parse settings file %s\\n\", filepath.string());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#discussion_r435743918",
      "id" : 435743918,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc0MzkxOA==",
      "original_commit_id" : "6c6846cd58e33108887cea4e2a1127a56e8c7d67",
      "original_line" : 401,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/util/system.cpp",
      "position" : null,
      "pull_request_review_id" : 425064866,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15935",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T22:35:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/435743918",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15935#discussion_r435744301"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15935"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/435744301"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Without further PRs, this part is dead code,... would it at least make sense to add a test for it?",
      "commit_id" : "eb966f421c9365e232627209687e6506089deb34",
      "created_at" : "2020-06-05T07:41:15Z",
      "diff_hunk" : "@@ -372,6 +373,86 @@ bool ArgsManager::IsArgSet(const std::string& strArg) const\n     return !GetSetting(strArg).isNull();\n }\n \n+static bool GetSettingsPath(fs::path* filepath = nullptr, bool temp = false)\n+{\n+    if (gArgs.IsArgNegated(\"-settings\")) return false;\n+    if (filepath) {\n+        std::string settings = gArgs.GetArg(\"-settings\", BITCOIN_SETTINGS_FILENAME);\n+        *filepath = fs::absolute(temp ? settings + \".tmp\" : settings, GetDataDir(/* net_specific= */ true));\n+    }\n+    return true;\n+}\n+\n+bool ArgsManager::EnableSettingsFile()\n+{\n+    return GetSettingsPath();\n+}\n+\n+bool ArgsManager::ReadSettingsFile()\n+{\n+    fsbridge::ifstream file;\n+    fs::path filepath;\n+    if (!GetSettingsPath(&filepath, /* temp= */ false)) return true;\n+    file.open(filepath);\n+    if (!file.is_open()) return true; // Ok for file not to exist.\n+\n+    util::SettingsValue in;\n+    if (!in.read(std::string{std::istreambuf_iterator<char>(file), std::istreambuf_iterator<char>()})) {\n+        LogPrintf(\"Error: Unable to parse settings file %s\\n\", filepath.string());\n+        return false;\n+    }\n+    if (file.fail()) {\n+        LogPrintf(\"Error reading settings file %s\\n\", filepath.string());\n+        return false;\n+    }\n+    file.close();\n+\n+    if (!in.isObject()) {\n+        LogPrintf(\"Error: Settings file %s is not in expected key-value format.\\n\", filepath.string());\n+        return false;\n+    }\n+\n+    LOCK(cs_args);\n+    m_settings.rw_settings.clear();\n+    const std::vector<std::string>& keys = in.getKeys();\n+    const std::vector<UniValue>& values = in.getValues();\n+    for (size_t i = 0; i < keys.size(); ++i) {\n+        m_settings.rw_settings.emplace(keys[i], values[i]);\n+    }\n+    return true;\n+}\n+\n+bool ArgsManager::WriteSettingsFile() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#discussion_r435744301",
      "id" : 435744301,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNTc0NDMwMQ==",
      "original_commit_id" : "6c6846cd58e33108887cea4e2a1127a56e8c7d67",
      "original_line" : 425,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/util/system.cpp",
      "position" : null,
      "pull_request_review_id" : 425065377,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15935",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T22:35:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/435744301",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Reviewed the code and it looks good.\r\nTo merge this on its own, I think it would require some tests and, because this is read only currently, it should be mentioned in the `init.cpp` help as well as in the `files.md` (where the read-only note can be removed once something like #15936 is merged).",
      "created_at" : "2020-06-05T07:43:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#issuecomment-639315409",
      "id" : 639315409,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15935",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzOTMxNTQwOQ==",
      "updated_at" : "2020-06-05T07:49:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/639315409",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15935#discussion_r436190126"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15935"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436190126"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/15935#discussion_r435743918\r\n\r\n> These logprints are currently going nowhere because `InitLogging()` is called after `ReadSettingsFile()`. Not saying it is a problem.\r\n\r\nGood catch, errors are returned now",
      "commit_id" : "eb966f421c9365e232627209687e6506089deb34",
      "created_at" : "2020-06-05T22:21:27Z",
      "diff_hunk" : "@@ -372,6 +373,86 @@ bool ArgsManager::IsArgSet(const std::string& strArg) const\n     return !GetSetting(strArg).isNull();\n }\n \n+static bool GetSettingsPath(fs::path* filepath = nullptr, bool temp = false)\n+{\n+    if (gArgs.IsArgNegated(\"-settings\")) return false;\n+    if (filepath) {\n+        std::string settings = gArgs.GetArg(\"-settings\", BITCOIN_SETTINGS_FILENAME);\n+        *filepath = fs::absolute(temp ? settings + \".tmp\" : settings, GetDataDir(/* net_specific= */ true));\n+    }\n+    return true;\n+}\n+\n+bool ArgsManager::EnableSettingsFile()\n+{\n+    return GetSettingsPath();\n+}\n+\n+bool ArgsManager::ReadSettingsFile()\n+{\n+    fsbridge::ifstream file;\n+    fs::path filepath;\n+    if (!GetSettingsPath(&filepath, /* temp= */ false)) return true;\n+    file.open(filepath);\n+    if (!file.is_open()) return true; // Ok for file not to exist.\n+\n+    util::SettingsValue in;\n+    if (!in.read(std::string{std::istreambuf_iterator<char>(file), std::istreambuf_iterator<char>()})) {\n+        LogPrintf(\"Error: Unable to parse settings file %s\\n\", filepath.string());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#discussion_r436190126",
      "id" : 436190126,
      "in_reply_to_id" : 435743918,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE5MDEyNg==",
      "original_commit_id" : "6c6846cd58e33108887cea4e2a1127a56e8c7d67",
      "original_line" : 401,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/util/system.cpp",
      "position" : null,
      "pull_request_review_id" : 425660265,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15935",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T22:35:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436190126",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15935#discussion_r436190153"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15935"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436190153"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/15935#discussion_r435744301\r\n\r\n> Without further PRs, this part is dead code,... would it at least make sense to add a test for it?\r\n\r\nAdded a write call and tests",
      "commit_id" : "eb966f421c9365e232627209687e6506089deb34",
      "created_at" : "2020-06-05T22:21:33Z",
      "diff_hunk" : "@@ -372,6 +373,86 @@ bool ArgsManager::IsArgSet(const std::string& strArg) const\n     return !GetSetting(strArg).isNull();\n }\n \n+static bool GetSettingsPath(fs::path* filepath = nullptr, bool temp = false)\n+{\n+    if (gArgs.IsArgNegated(\"-settings\")) return false;\n+    if (filepath) {\n+        std::string settings = gArgs.GetArg(\"-settings\", BITCOIN_SETTINGS_FILENAME);\n+        *filepath = fs::absolute(temp ? settings + \".tmp\" : settings, GetDataDir(/* net_specific= */ true));\n+    }\n+    return true;\n+}\n+\n+bool ArgsManager::EnableSettingsFile()\n+{\n+    return GetSettingsPath();\n+}\n+\n+bool ArgsManager::ReadSettingsFile()\n+{\n+    fsbridge::ifstream file;\n+    fs::path filepath;\n+    if (!GetSettingsPath(&filepath, /* temp= */ false)) return true;\n+    file.open(filepath);\n+    if (!file.is_open()) return true; // Ok for file not to exist.\n+\n+    util::SettingsValue in;\n+    if (!in.read(std::string{std::istreambuf_iterator<char>(file), std::istreambuf_iterator<char>()})) {\n+        LogPrintf(\"Error: Unable to parse settings file %s\\n\", filepath.string());\n+        return false;\n+    }\n+    if (file.fail()) {\n+        LogPrintf(\"Error reading settings file %s\\n\", filepath.string());\n+        return false;\n+    }\n+    file.close();\n+\n+    if (!in.isObject()) {\n+        LogPrintf(\"Error: Settings file %s is not in expected key-value format.\\n\", filepath.string());\n+        return false;\n+    }\n+\n+    LOCK(cs_args);\n+    m_settings.rw_settings.clear();\n+    const std::vector<std::string>& keys = in.getKeys();\n+    const std::vector<UniValue>& values = in.getValues();\n+    for (size_t i = 0; i < keys.size(); ++i) {\n+        m_settings.rw_settings.emplace(keys[i], values[i]);\n+    }\n+    return true;\n+}\n+\n+bool ArgsManager::WriteSettingsFile() const",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15935#discussion_r436190153",
      "id" : 436190153,
      "in_reply_to_id" : 435744301,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE5MDE1Mw==",
      "original_commit_id" : "6c6846cd58e33108887cea4e2a1127a56e8c7d67",
      "original_line" : 425,
      "original_position" : 61,
      "original_start_line" : null,
      "path" : "src/util/system.cpp",
      "position" : null,
      "pull_request_review_id" : 425660265,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15935",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-05T22:35:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436190153",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
