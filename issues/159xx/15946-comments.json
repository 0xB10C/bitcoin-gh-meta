[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16362](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16362.html) (Add bilingual_str type by hebasto)\n* [#16224](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16224.html) (gui: Bilingual GUI error messages by hebasto)\n* [#10443](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/10443.html) (Add fee_est tool for debugging fee estimation code by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-05-03T13:40:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#issuecomment-489099020",
      "id" : 489099020,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15946",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4OTA5OTAyMA==",
      "updated_at" : "2019-07-24T14:46:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489099020",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281206430"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281206430"
         }
      },
      "author_association" : "MEMBER",
      "body" : "0d8f7369cd8b51dfb7b3b9b920e4e11f7962faa9 \r\n\r\nThis doesn't check `status & BLOCK_HAVE_DATA` on the tip, is that intentional?",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-06T14:21:58Z",
      "diff_hunk" : "@@ -66,6 +66,29 @@ bool BaseIndex::Init()\n         m_best_block_index = FindForkInGlobalIndex(chainActive, locator);\n     }\n     m_synced = m_best_block_index.load() == chainActive.Tip();\n+\n+    if (!m_synced) {\n+        bool prune_violation = false;\n+        if (!m_best_block_index) {\n+            // it looks like this index is not built yet\n+            // make sure we have all data back to the genesis\n+            const CBlockIndex* block = chainActive.Tip();\n+            while (block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281206430",
      "id" : 281206430,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTIwNjQzMA==",
      "original_commit_id" : "0d8f7369cd8b51dfb7b3b9b920e4e11f7962faa9",
      "original_position" : 11,
      "path" : "src/index/base.cpp",
      "position" : 19,
      "pull_request_review_id" : 234006796,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281206430",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281208250"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281208250"
         }
      },
      "author_association" : "MEMBER",
      "body" : "d2ab62fede34b7980863617f3669c019ee42d029 \r\n\r\nThese comment were added in the previous commit, could fixup these hunks?",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-06T14:26:02Z",
      "diff_hunk" : "@@ -70,21 +70,21 @@ bool BaseIndex::Init()\n     if (!m_synced) {\n         bool prune_violation = false;\n         if (!m_best_block_index) {\n-            // it looks like this index is not built yet\n-            // make sure we have all data back to the genesis\n+            // index is not built yet\n+            // make sure we have all block data back to the genesis",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281208250",
      "id" : 281208250,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTIwODI1MA==",
      "original_commit_id" : "d2ab62fede34b7980863617f3669c019ee42d029",
      "original_position" : 16,
      "path" : "src/index/base.cpp",
      "position" : 17,
      "pull_request_review_id" : 234006796,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281208250",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281209023"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281209023"
         }
      },
      "author_association" : "MEMBER",
      "body" : "8bb1ca8a276f5f6fc5af3639c2d58c496b71bf8f \r\n\r\n`bool IsSyned() const;`. Any reason to not write implementation here?",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-06T14:28:01Z",
      "diff_hunk" : "@@ -100,6 +100,8 @@ class BaseIndex : public CValidationInterface\n     /// not block and immediately returns false.\n     bool BlockUntilSyncedToCurrentChain();\n \n+    bool IsSynced();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281209023",
      "id" : 281209023,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTIwOTAyMw==",
      "original_commit_id" : "8bb1ca8a276f5f6fc5af3639c2d58c496b71bf8f",
      "original_position" : 4,
      "path" : "src/index/base.h",
      "position" : null,
      "pull_request_review_id" : 234006796,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281209023",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281210225"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281210225"
         }
      },
      "author_association" : "MEMBER",
      "body" : "bd11606a95022478e6ef1ccaada1589cff13a327\r\n\r\nCan be checked before locking `cs_main`?",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-06T14:30:44Z",
      "diff_hunk" : "@@ -1004,6 +1004,13 @@ static UniValue pruneblockchain(const JSONRPCRequest& request)\n \n     LOCK(cs_main);\n \n+    // reject manual pruning in case if a blockfilterindex is syncing\n+    ForEachBlockFilterIndex([](BlockFilterIndex& index) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281210225",
      "id" : 281210225,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTIxMDIyNQ==",
      "original_commit_id" : "bd11606a95022478e6ef1ccaada1589cff13a327",
      "original_position" : 5,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 5,
      "pull_request_review_id" : 234006796,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281210225",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281210459"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281210459"
         }
      },
      "author_association" : "MEMBER",
      "body" : "bd11606a95022478e6ef1ccaada1589cff13a327\r\n\r\nDo you see a way to test this?",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-06T14:31:12Z",
      "diff_hunk" : "@@ -1004,6 +1004,13 @@ static UniValue pruneblockchain(const JSONRPCRequest& request)\n \n     LOCK(cs_main);\n \n+    // reject manual pruning in case if a blockfilterindex is syncing\n+    ForEachBlockFilterIndex([](BlockFilterIndex& index) {\n+        if (!index.IsSynced()) {\n+            throw JSONRPCError(RPC_MISC_ERROR, \"Cannot prune blocks because blockfilterindex is syncing.\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281210459",
      "id" : 281210459,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTIxMDQ1OQ==",
      "original_commit_id" : "bd11606a95022478e6ef1ccaada1589cff13a327",
      "original_position" : 7,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 7,
      "pull_request_review_id" : 234006796,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281210459",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281213644"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281213644"
         }
      },
      "author_association" : "MEMBER",
      "body" : "bf744288bd58718844841c088c498cd57a8f87d8 \r\n\r\nnit, no need for `{}`. Alternative:\r\n```\r\ndelay_pruning |= !index.IsSynced();\r\n```",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-06T14:38:02Z",
      "diff_hunk" : "@@ -2085,23 +2086,34 @@ bool static FlushStateToDisk(const CChainParams& chainparams, CValidationState &\n     static int64_t nLastFlush = 0;\n     std::set<int> setFilesToPrune;\n     bool full_flush_completed = false;\n+\n+    // we delay pruning when one of the blockfilterindex is syncing\n+    bool delay_pruning = false;\n+    ForEachBlockFilterIndex([&delay_pruning](BlockFilterIndex& index) {\n+        if (!index.IsSynced()) { delay_pruning = true; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281213644",
      "id" : 281213644,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTIxMzY0NA==",
      "original_commit_id" : "bf744288bd58718844841c088c498cd57a8f87d8",
      "original_position" : 16,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 234006796,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281213644",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281218262"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281218262"
         }
      },
      "author_association" : "MEMBER",
      "body" : "bf744288bd58718844841c088c498cd57a8f87d8\r\n\r\nAn alternative is to add a global `g_delay_pruning` in validation.h which gets updated every time an index `m_synced` is updated.",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-06T14:48:22Z",
      "diff_hunk" : "@@ -11,6 +11,7 @@ export LC_ALL=C\n EXPECTED_CIRCULAR_DEPENDENCIES=(\n     \"chainparamsbase -> util/system -> chainparamsbase\"\n     \"index/txindex -> validation -> index/txindex\"\n+    \"index/blockfilterindex -> validation -> index/blockfilterindex\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281218262",
      "id" : 281218262,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTIxODI2Mg==",
      "original_commit_id" : "bf744288bd58718844841c088c498cd57a8f87d8",
      "original_position" : 4,
      "path" : "test/lint/lint-circular-dependencies.sh",
      "position" : 4,
      "pull_request_review_id" : 234006796,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281218262",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281220802"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281220802"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think the tip can ever not have data?",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-06T14:53:56Z",
      "diff_hunk" : "@@ -66,6 +66,29 @@ bool BaseIndex::Init()\n         m_best_block_index = FindForkInGlobalIndex(chainActive, locator);\n     }\n     m_synced = m_best_block_index.load() == chainActive.Tip();\n+\n+    if (!m_synced) {\n+        bool prune_violation = false;\n+        if (!m_best_block_index) {\n+            // it looks like this index is not built yet\n+            // make sure we have all data back to the genesis\n+            const CBlockIndex* block = chainActive.Tip();\n+            while (block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281220802",
      "id" : 281220802,
      "in_reply_to_id" : 281206430,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTIyMDgwMg==",
      "original_commit_id" : "0d8f7369cd8b51dfb7b3b9b920e4e11f7962faa9",
      "original_position" : 11,
      "path" : "src/index/base.cpp",
      "position" : 19,
      "pull_request_review_id" : 234024777,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281220802",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281221080"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281221080"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Or move the \"load block\" function into a separate \"storage\" module.",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-06T14:54:39Z",
      "diff_hunk" : "@@ -11,6 +11,7 @@ export LC_ALL=C\n EXPECTED_CIRCULAR_DEPENDENCIES=(\n     \"chainparamsbase -> util/system -> chainparamsbase\"\n     \"index/txindex -> validation -> index/txindex\"\n+    \"index/blockfilterindex -> validation -> index/blockfilterindex\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r281221080",
      "id" : 281221080,
      "in_reply_to_id" : 281218262,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTIyMTA4MA==",
      "original_commit_id" : "bf744288bd58718844841c088c498cd57a8f87d8",
      "original_position" : 4,
      "path" : "test/lint/lint-circular-dependencies.sh",
      "position" : 4,
      "pull_request_review_id" : 234025177,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281221080",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Closes #15867?",
      "created_at" : "2019-05-06T17:37:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#issuecomment-489707230",
      "id" : 489707230,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15946",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4OTcwNzIzMA==",
      "updated_at" : "2019-05-06T17:37:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489707230",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-05-07T16:03:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#issuecomment-490143318",
      "id" : 490143318,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15946",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5MDE0MzMxOA==",
      "updated_at" : "2019-05-07T16:03:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/490143318",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r282552651"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/282552651"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm currently working on making the block-/undo-filesize dynamic which would then allow testing this more reliable.",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-09T15:58:25Z",
      "diff_hunk" : "@@ -1004,6 +1004,13 @@ static UniValue pruneblockchain(const JSONRPCRequest& request)\n \n     LOCK(cs_main);\n \n+    // reject manual pruning in case if a blockfilterindex is syncing\n+    ForEachBlockFilterIndex([](BlockFilterIndex& index) {\n+        if (!index.IsSynced()) {\n+            throw JSONRPCError(RPC_MISC_ERROR, \"Cannot prune blocks because blockfilterindex is syncing.\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r282552651",
      "id" : 282552651,
      "in_reply_to_id" : 281210459,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MjU1MjY1MQ==",
      "original_commit_id" : "bd11606a95022478e6ef1ccaada1589cff13a327",
      "original_position" : 7,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 7,
      "pull_request_review_id" : 235678099,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/282552651",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r282601175"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/282601175"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The global `g_delay_pruning` smells fragile. Better not do that.\r\n\r\nI like the \"storage\" module approach which though would be something for another PR.",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-09T18:04:33Z",
      "diff_hunk" : "@@ -11,6 +11,7 @@ export LC_ALL=C\n EXPECTED_CIRCULAR_DEPENDENCIES=(\n     \"chainparamsbase -> util/system -> chainparamsbase\"\n     \"index/txindex -> validation -> index/txindex\"\n+    \"index/blockfilterindex -> validation -> index/blockfilterindex\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r282601175",
      "id" : 282601175,
      "in_reply_to_id" : 281218262,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MjYwMTE3NQ==",
      "original_commit_id" : "bf744288bd58718844841c088c498cd57a8f87d8",
      "original_position" : 4,
      "path" : "test/lint/lint-circular-dependencies.sh",
      "position" : 4,
      "pull_request_review_id" : 235740443,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/282601175",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r282601885"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/282601885"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> I don't think the tip can ever not have data? \r\n\r\nJup.",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-09T18:06:33Z",
      "diff_hunk" : "@@ -66,6 +66,29 @@ bool BaseIndex::Init()\n         m_best_block_index = FindForkInGlobalIndex(chainActive, locator);\n     }\n     m_synced = m_best_block_index.load() == chainActive.Tip();\n+\n+    if (!m_synced) {\n+        bool prune_violation = false;\n+        if (!m_best_block_index) {\n+            // it looks like this index is not built yet\n+            // make sure we have all data back to the genesis\n+            const CBlockIndex* block = chainActive.Tip();\n+            while (block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r282601885",
      "id" : 282601885,
      "in_reply_to_id" : 281206430,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MjYwMTg4NQ==",
      "original_commit_id" : "0d8f7369cd8b51dfb7b3b9b920e4e11f7962faa9",
      "original_position" : 11,
      "path" : "src/index/base.cpp",
      "position" : 19,
      "pull_request_review_id" : 235741371,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/282601885",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r282601960"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/282601960"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-09T18:06:46Z",
      "diff_hunk" : "@@ -100,6 +100,8 @@ class BaseIndex : public CValidationInterface\n     /// not block and immediately returns false.\n     bool BlockUntilSyncedToCurrentChain();\n \n+    bool IsSynced();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r282601960",
      "id" : 282601960,
      "in_reply_to_id" : 281209023,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MjYwMTk2MA==",
      "original_commit_id" : "8bb1ca8a276f5f6fc5af3639c2d58c496b71bf8f",
      "original_position" : 4,
      "path" : "src/index/base.h",
      "position" : null,
      "pull_request_review_id" : 235741478,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/282601960",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r282602418"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/282602418"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Fixed.",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-09T18:08:04Z",
      "diff_hunk" : "@@ -1004,6 +1004,13 @@ static UniValue pruneblockchain(const JSONRPCRequest& request)\n \n     LOCK(cs_main);\n \n+    // reject manual pruning in case if a blockfilterindex is syncing\n+    ForEachBlockFilterIndex([](BlockFilterIndex& index) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r282602418",
      "id" : 282602418,
      "in_reply_to_id" : 281210225,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MjYwMjQxOA==",
      "original_commit_id" : "bd11606a95022478e6ef1ccaada1589cff13a327",
      "original_position" : 5,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 5,
      "pull_request_review_id" : 235742086,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/282602418",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r282602625"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/282602625"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Rather not do `|= !` for code readability, but removed the extra unnecessary block ",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-05-09T18:08:38Z",
      "diff_hunk" : "@@ -2085,23 +2086,34 @@ bool static FlushStateToDisk(const CChainParams& chainparams, CValidationState &\n     static int64_t nLastFlush = 0;\n     std::set<int> setFilesToPrune;\n     bool full_flush_completed = false;\n+\n+    // we delay pruning when one of the blockfilterindex is syncing\n+    bool delay_pruning = false;\n+    ForEachBlockFilterIndex([&delay_pruning](BlockFilterIndex& index) {\n+        if (!index.IsSynced()) { delay_pruning = true; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r282602625",
      "id" : 282602625,
      "in_reply_to_id" : 281213644,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MjYwMjYyNQ==",
      "original_commit_id" : "bf744288bd58718844841c088c498cd57a8f87d8",
      "original_position" : 16,
      "path" : "src/validation.cpp",
      "position" : null,
      "pull_request_review_id" : 235742381,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-05-09T18:42:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/282602625",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased and fixed reported points.",
      "created_at" : "2019-05-09T18:10:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#issuecomment-491008776",
      "id" : 491008776,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15946",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ5MTAwODc3Ng==",
      "updated_at" : "2019-05-09T18:10:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/491008776",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-07-24T18:15:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#issuecomment-514742374",
      "id" : 514742374,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15946",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNDc0MjM3NA==",
      "updated_at" : "2019-07-24T18:15:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/514742374",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r315296449"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/315296449"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Aren't we intentionally keeping the message vague here to avoid confusing users?",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-08-19T16:17:53Z",
      "diff_hunk" : "@@ -23,7 +23,7 @@ static void FatalError(const char* fmt, const Args&... args)\n     SetMiscWarning(strMessage);\n     LogPrintf(\"*** %s\\n\", strMessage);\n     uiInterface.ThreadSafeMessageBox(\n-        \"Error: A fatal internal error occurred, see debug.log for details\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r315296449",
      "id" : 315296449,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxNTI5NjQ0OQ==",
      "original_commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "original_position" : 4,
      "path" : "src/index/base.cpp",
      "position" : 4,
      "pull_request_review_id" : 276668382,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-08-19T16:24:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/315296449",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r315297460"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/315297460"
         }
      },
      "author_association" : "MEMBER",
      "body" : "IIRC, having the data for block N is not a guarantee we have it for block N+M, since blocks are stored out of order and pruned only as entire files.",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-08-19T16:20:20Z",
      "diff_hunk" : "@@ -66,6 +66,28 @@ bool BaseIndex::Init()\n         m_best_block_index = FindForkInGlobalIndex(::ChainActive(), locator);\n     }\n     m_synced = m_best_block_index.load() == ::ChainActive().Tip();\n+    if (!m_synced) {\n+        bool prune_violation = false;\n+        if (!m_best_block_index) {\n+            // index is not built yet\n+            // make sure we have all block data back to the genesis\n+            const CBlockIndex* block = ::ChainActive().Tip();\n+            while (block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA)) {\n+                block = block->pprev;\n+            }\n+            prune_violation = block != ::ChainActive().Genesis();\n+        }\n+        // in case the index has a best block set and is not fully synced\n+        // check if we have the required blocks to continue building the index\n+        else if (!(m_best_block_index.load()->nStatus & BLOCK_HAVE_DATA)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r315297460",
      "id" : 315297460,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxNTI5NzQ2MA==",
      "original_commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "original_position" : 26,
      "path" : "src/index/base.cpp",
      "position" : 26,
      "pull_request_review_id" : 276668382,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-08-19T16:24:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/315297460",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r315297746"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/315297746"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If `m_best_block_index` is not in the main chain, we may need its parent blocks to undo indexing. This should be checked here too.",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-08-19T16:21:00Z",
      "diff_hunk" : "@@ -66,6 +66,28 @@ bool BaseIndex::Init()\n         m_best_block_index = FindForkInGlobalIndex(::ChainActive(), locator);\n     }\n     m_synced = m_best_block_index.load() == ::ChainActive().Tip();\n+    if (!m_synced) {\n+        bool prune_violation = false;\n+        if (!m_best_block_index) {\n+            // index is not built yet\n+            // make sure we have all block data back to the genesis\n+            const CBlockIndex* block = ::ChainActive().Tip();\n+            while (block->pprev && (block->pprev->nStatus & BLOCK_HAVE_DATA)) {\n+                block = block->pprev;\n+            }\n+            prune_violation = block != ::ChainActive().Genesis();\n+        }\n+        // in case the index has a best block set and is not fully synced\n+        // check if we have the required blocks to continue building the index\n+        else if (!(m_best_block_index.load()->nStatus & BLOCK_HAVE_DATA)) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r315297746",
      "id" : 315297746,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxNTI5Nzc0Ng==",
      "original_commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "original_position" : 26,
      "path" : "src/index/base.cpp",
      "position" : 26,
      "pull_request_review_id" : 276668382,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-08-19T16:24:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/315297746",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r315297976"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/315297976"
         }
      },
      "author_association" : "MEMBER",
      "body" : "lead*",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-08-19T16:21:34Z",
      "diff_hunk" : "@@ -178,6 +200,10 @@ bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_ti\n     assert(current_tip->GetAncestor(new_tip->nHeight) == new_tip);\n \n     // In the case of a reorg, ensure persisted block locator is not stale.\n+    // Pruning has a minimum of 288 blocks-to-keep and getting the index\n+    // out of sync may be possible but a users fault.\n+    // In case we reorg beyond the pruned depth, ReadBlockFromDisk would\n+    // throw and led to a graceful shutdown",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r315297976",
      "id" : 315297976,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxNTI5Nzk3Ng==",
      "original_commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "original_position" : 45,
      "path" : "src/index/base.cpp",
      "position" : 45,
      "pull_request_review_id" : 276668382,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-08-19T16:24:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/315297976",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r315298520"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/315298520"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Would be nicer to just check if the indexes are beyond the requested prune height...",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-08-19T16:22:52Z",
      "diff_hunk" : "@@ -1004,6 +1004,13 @@ static UniValue pruneblockchain(const JSONRPCRequest& request)\n \n     LOCK(cs_main);\n \n+    // reject manual pruning in case if a blockfilterindex is syncing\n+    ForEachBlockFilterIndex([](BlockFilterIndex& index) {\n+        if (!index.IsSynced()) {\n+            throw JSONRPCError(RPC_MISC_ERROR, \"Cannot prune blocks because blockfilterindex is syncing.\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r315298520",
      "id" : 315298520,
      "in_reply_to_id" : 281210459,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxNTI5ODUyMA==",
      "original_commit_id" : "bd11606a95022478e6ef1ccaada1589cff13a327",
      "original_position" : 7,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 7,
      "pull_request_review_id" : 276668382,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-08-19T16:24:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/315298520",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r315298813"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/315298813"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Won't this effectively prevent all pruning until IBD completes? Seems important to prune as soon as all indexes are caught up to the given height...",
      "commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "created_at" : "2019-08-19T16:23:38Z",
      "diff_hunk" : "@@ -2105,23 +2106,34 @@ bool static FlushStateToDisk(const CChainParams& chainparams, CValidationState &\n     static int64_t nLastFlush = 0;\n     std::set<int> setFilesToPrune;\n     bool full_flush_completed = false;\n+\n+    // we delay pruning when one of the blockfilterindex is syncing\n+    bool delay_pruning = false;\n+    ForEachBlockFilterIndex([&delay_pruning](BlockFilterIndex& index) {\n+        if (!index.IsSynced()) delay_pruning = true;\n+    });",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#discussion_r315298813",
      "id" : 315298813,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxNTI5ODgxMw==",
      "original_commit_id" : "a205fc52738088d983c22a3e3dcfa900a33e8a43",
      "original_position" : 17,
      "path" : "src/validation.cpp",
      "position" : 17,
      "pull_request_review_id" : 276668382,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15946",
      "updated_at" : "2019-08-19T16:24:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/315298813",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Any chance this will be revived? This is a blocker for `lnd` to support a pruned `bitcoind` node, as we want to be able to fetch filters from `bitcoind`, then manually fetch blocks ourselves (if `bitcoind` doesn't have them) to scan them for rescans or just normal wallet sync. ",
      "created_at" : "2020-01-08T01:43:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#issuecomment-571854091",
      "id" : 571854091,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15946",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU3MTg1NDA5MQ==",
      "updated_at" : "2020-01-08T01:43:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/571854091",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/998190?v=4",
         "events_url" : "https://api.github.com/users/Roasbeef/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Roasbeef/followers",
         "following_url" : "https://api.github.com/users/Roasbeef/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Roasbeef/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Roasbeef",
         "id" : 998190,
         "login" : "Roasbeef",
         "node_id" : "MDQ6VXNlcjk5ODE5MA==",
         "organizations_url" : "https://api.github.com/users/Roasbeef/orgs",
         "received_events_url" : "https://api.github.com/users/Roasbeef/received_events",
         "repos_url" : "https://api.github.com/users/Roasbeef/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Roasbeef/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Roasbeef/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Roasbeef"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This feature increases the value of running a pruned node significantly. +1 for adding this!",
      "created_at" : "2020-07-08T15:54:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#issuecomment-655605491",
      "id" : 655605491,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15946",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NTYwNTQ5MQ==",
      "updated_at" : "2020-07-08T15:54:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/655605491",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/42201?v=4",
         "events_url" : "https://api.github.com/users/prusnak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prusnak/followers",
         "following_url" : "https://api.github.com/users/prusnak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prusnak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prusnak",
         "id" : 42201,
         "login" : "prusnak",
         "node_id" : "MDQ6VXNlcjQyMjAx",
         "organizations_url" : "https://api.github.com/users/prusnak/orgs",
         "received_events_url" : "https://api.github.com/users/prusnak/received_events",
         "repos_url" : "https://api.github.com/users/prusnak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prusnak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prusnak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prusnak"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I suspect #19463 could be useful for this",
      "created_at" : "2020-07-08T16:56:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#issuecomment-655638171",
      "id" : 655638171,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15946",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NTYzODE3MQ==",
      "updated_at" : "2020-07-08T16:56:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/655638171",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rewrote this PR and tried to fix the reported point by @promag, @MarcoFalke and @luke-jr.\r\nAdded `-smallblockfiles` debug parameter to test pruning more effectively (added a functional-test as well).",
      "created_at" : "2020-12-10T19:30:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15946#issuecomment-742744931",
      "id" : 742744931,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15946",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0Mjc0NDkzMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-10T19:30:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/742744931",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "node_id" : "MDQ6VXNlcjE3ODQ2NA==",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   }
]
