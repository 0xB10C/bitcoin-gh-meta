[
   {
      "author_association" : "MEMBER",
      "body" : "Is this the only place in the code where this needs fixing?",
      "created_at" : "2018-06-25T12:20:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13534#issuecomment-399932193",
      "id" : 399932193,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13534",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDM5OTkzMjE5Mw==",
      "updated_at" : "2018-06-25T12:20:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/399932193",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13534#discussion_r197775550"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13534"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197775550"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You can just remove the assert. This is regtest, so a wrap is \"impossible\" anyway.",
      "commit_id" : "5df902d992038d50439891738bbdcfa5767ac2eb",
      "created_at" : "2018-06-25T12:22:03Z",
      "diff_hunk" : "@@ -41,7 +41,8 @@ static CTxIn MineBlock(const CScript& coinbase_scriptPubKey)\n     auto block = PrepareBlock(coinbase_scriptPubKey);\n \n     while (!CheckProofOfWork(block->GetHash(), block->nBits, Params().GetConsensus())) {\n-        assert(++block->nNonce);\n+        auto nNonce = ++block->nNonce;\n+        assert(nNonce);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13534#discussion_r197775550",
      "id" : 197775550,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5Nzc3NTU1MA==",
      "original_commit_id" : "5df902d992038d50439891738bbdcfa5767ac2eb",
      "original_position" : 6,
      "path" : "src/bench/block_assemble.cpp",
      "position" : 6,
      "pull_request_review_id" : 131582296,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13534",
      "updated_at" : "2018-06-25T12:22:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197775550",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13534#discussion_r197778603"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13534"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197778603"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Like this?\r\n\r\n```\r\n     while (!CheckProofOfWork(block->GetHash(), block->nBits, Params().GetConsensus())) {\r\n         ++block->nNonce;\r\n     }\r\n```",
      "commit_id" : "5df902d992038d50439891738bbdcfa5767ac2eb",
      "created_at" : "2018-06-25T12:33:57Z",
      "diff_hunk" : "@@ -41,7 +41,8 @@ static CTxIn MineBlock(const CScript& coinbase_scriptPubKey)\n     auto block = PrepareBlock(coinbase_scriptPubKey);\n \n     while (!CheckProofOfWork(block->GetHash(), block->nBits, Params().GetConsensus())) {\n-        assert(++block->nNonce);\n+        auto nNonce = ++block->nNonce;\n+        assert(nNonce);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13534#discussion_r197778603",
      "id" : 197778603,
      "in_reply_to_id" : 197775550,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5Nzc3ODYwMw==",
      "original_commit_id" : "5df902d992038d50439891738bbdcfa5767ac2eb",
      "original_position" : 6,
      "path" : "src/bench/block_assemble.cpp",
      "position" : 6,
      "pull_request_review_id" : 131586209,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13534",
      "updated_at" : "2018-06-25T12:33:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197778603",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13534#discussion_r197780332"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13534"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197780332"
         }
      },
      "author_association" : "MEMBER",
      "body" : "sure",
      "commit_id" : "5df902d992038d50439891738bbdcfa5767ac2eb",
      "created_at" : "2018-06-25T12:40:24Z",
      "diff_hunk" : "@@ -41,7 +41,8 @@ static CTxIn MineBlock(const CScript& coinbase_scriptPubKey)\n     auto block = PrepareBlock(coinbase_scriptPubKey);\n \n     while (!CheckProofOfWork(block->GetHash(), block->nBits, Params().GetConsensus())) {\n-        assert(++block->nNonce);\n+        auto nNonce = ++block->nNonce;\n+        assert(nNonce);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13534#discussion_r197780332",
      "id" : 197780332,
      "in_reply_to_id" : 197775550,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5Nzc4MDMzMg==",
      "original_commit_id" : "5df902d992038d50439891738bbdcfa5767ac2eb",
      "original_position" : 6,
      "path" : "src/bench/block_assemble.cpp",
      "position" : 6,
      "pull_request_review_id" : 131588362,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13534",
      "updated_at" : "2018-06-25T12:40:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197780332",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Again, I believe we use this excessively in other parts of the code. What makes you fix this specific instance?",
      "created_at" : "2018-06-25T21:56:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13534#issuecomment-400108748",
      "id" : 400108748,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13534",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwMDEwODc0OA==",
      "updated_at" : "2018-06-25T21:56:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400108748",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke This is the only instance I know of where the `assert(Ã¢ÂÂ¦)` includes a function or expression that has a side effect (or more specifically where the execution would differ between `defined(NDEBUG)` vs. `!defined(NDEBUG)` beyond `assert(...)` obviously being expanded to a noop in the former case). Can you find another example? :-)\r\n\r\nCandidates:\r\n\r\n```\r\ngit grep '[^_]assert(.*);' | \\\r\n    grep -vE '^(build-aux/|src/(crypto/ctaes/|leveldb/|univalue/))'\r\n```\r\n\r\n\r\n\r\n\r\n\r\n",
      "created_at" : "2018-06-26T12:53:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13534#issuecomment-400296837",
      "id" : 400296837,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13534",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwMDI5NjgzNw==",
      "updated_at" : "2018-06-26T12:59:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400296837",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "They sound a bit like side-effects, haven't checked:\r\n\r\n```\r\n$ git grep 'assert(' src/bench/checkblock.cpp src/httprpc.cpp\r\nsrc/bench/checkblock.cpp:        assert(stream.Rewind(sizeof(block_bench::block413567)));\r\nsrc/bench/checkblock.cpp:        assert(stream.Rewind(sizeof(block_bench::block413567)));\r\nsrc/bench/checkblock.cpp:        assert(CheckBlock(block, validationState, chainParams->GetConsensus()));\r\nsrc/httprpc.cpp:    assert(EventBase());\r\n",
      "created_at" : "2018-06-26T13:55:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13534#issuecomment-400317671",
      "id" : 400317671,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13534",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwMDMxNzY3MQ==",
      "updated_at" : "2018-06-26T13:55:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400317671",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@MarcoFalke `++block->nNonce` case is special in that `block` is used after the `assert(Ã¢ÂÂ¦)` takes place. I've now included the cases you mentioned and two others. Please re-review :-)",
      "created_at" : "2018-06-26T15:21:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13534#issuecomment-400349700",
      "id" : 400349700,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13534",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQwMDM0OTcwMA==",
      "updated_at" : "2018-06-26T15:21:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400349700",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   }
]
