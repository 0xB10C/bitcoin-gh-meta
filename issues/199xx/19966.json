{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "The eviction logic is one of the most important parts in our code base: a bug in the eviction logic could allow for attacker triggered network partitioning.\r\n\r\nUnfortunately the eviction logic is currently not tested properly.\r\n\r\nThe unit tests and fuzz tests don't cover the eviction logic at all.\r\n\r\nThe functional tests cover some parts of the eviction logic but the coverage is spotty/incomplete.\r\n\r\nUnfortunately `CConnman::AttemptToEvictConnection` is currently somewhat tricky to test.\r\n\r\nTo solve this I suggest simplifying `CConnman::AttemptToEvictConnection()` by introducing a new function ...\r\n\r\n```\r\n[[nodiscard]] Optional<NodeEvictionCandidate> SelectNodeToEvict(std::vector<NodeEvictionCandidate> vEvictionCandidates)\r\n```\r\n\r\n... which would be called from the now much simplified `CConnman::AttemptToEvictConnection`.\r\n\r\n`SelectNodeToEvict` would contain all eviction selection logic and could thus be tested trivially.\r\n\r\n",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19966/comments",
   "created_at" : "2020-09-17T05:13:55Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19966/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/issues/19966",
   "id" : 703271932,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19966/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "MDU6SXNzdWU3MDMyNzE5MzI=",
   "number" : 19966,
   "performed_via_github_app" : null,
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Add unit tests for eviction logic",
   "updated_at" : "2020-09-17T05:56:47Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19966",
   "user" : {
      "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
      "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
      "followers_url" : "https://api.github.com/users/practicalswift/followers",
      "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/practicalswift",
      "id" : 7826565,
      "login" : "practicalswift",
      "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
      "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
      "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
      "repos_url" : "https://api.github.com/users/practicalswift/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/practicalswift"
   }
}
