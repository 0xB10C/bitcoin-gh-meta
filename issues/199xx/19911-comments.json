[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-09-07T19:38:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19911#issuecomment-688486654",
      "id" : 688486654,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19911",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODQ4NjY1NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-07T19:38:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688486654",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-09-07T19:44:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19911#issuecomment-688488586",
      "id" : 688488586,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19911",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODQ4ODU4Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-07T19:44:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688488586",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19911#discussion_r484555699"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19911"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484555699"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Consider using the `WITH_LOCK` macro for simple one-line statements:\r\n\r\n```suggestion\r\n            WITH_LOCK(pfrom.cs_vRecv, pfrom.vRecvGetData.push_back(inv));\r\n```",
      "commit_id" : "3fe40815bf0e26b58dca03e164972ea70a6aa69d",
      "created_at" : "2020-09-07T19:54:50Z",
      "diff_hunk" : "@@ -2880,7 +2883,10 @@ void PeerLogicValidation::ProcessMessage(CNode& pfrom, const std::string& msg_ty\n             CInv inv;\n             inv.type = State(pfrom.GetId())->fWantsCmpctWitness ? MSG_WITNESS_BLOCK : MSG_BLOCK;\n             inv.hash = req.blockhash;\n-            pfrom.vRecvGetData.push_back(inv);\n+            {\n+                LOCK(pfrom.cs_vRecv);\n+                pfrom.vRecvGetData.push_back(inv);\n+            }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19911#discussion_r484555699",
      "id" : 484555699,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU1NTY5OQ==",
      "original_commit_id" : "a4d7f3dc3126b6b808f27dcf3ad7b6e8b9d6b0a7",
      "original_line" : 2889,
      "original_position" : 31,
      "original_start_line" : 2886,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 483699195,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19911",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-09-07T21:15:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484555699",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19911#discussion_r484558805"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19911"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484558805"
         }
      },
      "author_association" : "MEMBER",
      "body" : "style: consider adding braces to if blocks when touching code, to conform with the current style guide.",
      "commit_id" : "3fe40815bf0e26b58dca03e164972ea70a6aa69d",
      "created_at" : "2020-09-07T20:14:20Z",
      "diff_hunk" : "@@ -3855,15 +3861,20 @@ bool PeerLogicValidation::ProcessMessages(CNode* pfrom, std::atomic<bool>& inter\n     //\n     bool fMoreWork = false;\n \n-    if (!pfrom->vRecvGetData.empty())\n-        ProcessGetData(*pfrom, chainparams, m_connman, m_mempool, interruptMsgProc);\n+    {\n+        LOCK(pfrom->cs_vRecv);\n+        if (!pfrom->vRecvGetData.empty())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19911#discussion_r484558805",
      "id" : 484558805,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU1ODgwNQ==",
      "original_commit_id" : "a4d7f3dc3126b6b808f27dcf3ad7b6e8b9d6b0a7",
      "original_line" : 3866,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 483699195,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19911",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-07T21:15:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484558805",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19911#discussion_r484568250"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19911"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484568250"
         }
      },
      "author_association" : "MEMBER",
      "body" : "done!",
      "commit_id" : "3fe40815bf0e26b58dca03e164972ea70a6aa69d",
      "created_at" : "2020-09-07T21:15:47Z",
      "diff_hunk" : "@@ -2880,7 +2883,10 @@ void PeerLogicValidation::ProcessMessage(CNode& pfrom, const std::string& msg_ty\n             CInv inv;\n             inv.type = State(pfrom.GetId())->fWantsCmpctWitness ? MSG_WITNESS_BLOCK : MSG_BLOCK;\n             inv.hash = req.blockhash;\n-            pfrom.vRecvGetData.push_back(inv);\n+            {\n+                LOCK(pfrom.cs_vRecv);\n+                pfrom.vRecvGetData.push_back(inv);\n+            }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19911#discussion_r484568250",
      "id" : 484568250,
      "in_reply_to_id" : 484555699,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU2ODI1MA==",
      "original_commit_id" : "a4d7f3dc3126b6b808f27dcf3ad7b6e8b9d6b0a7",
      "original_line" : 2889,
      "original_position" : 31,
      "original_start_line" : 2886,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 483710588,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19911",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2020-09-07T21:15:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484568250",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/177646?v=4",
         "events_url" : "https://api.github.com/users/narula/events{/privacy}",
         "followers_url" : "https://api.github.com/users/narula/followers",
         "following_url" : "https://api.github.com/users/narula/following{/other_user}",
         "gists_url" : "https://api.github.com/users/narula/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/narula",
         "id" : 177646,
         "login" : "narula",
         "node_id" : "MDQ6VXNlcjE3NzY0Ng==",
         "organizations_url" : "https://api.github.com/users/narula/orgs",
         "received_events_url" : "https://api.github.com/users/narula/received_events",
         "repos_url" : "https://api.github.com/users/narula/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/narula/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/narula/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/narula"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19911#discussion_r484568297"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19911"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484568297"
         }
      },
      "author_association" : "MEMBER",
      "body" : "done! did not do so to adjacent code i wasn't touching.",
      "commit_id" : "3fe40815bf0e26b58dca03e164972ea70a6aa69d",
      "created_at" : "2020-09-07T21:16:00Z",
      "diff_hunk" : "@@ -3855,15 +3861,20 @@ bool PeerLogicValidation::ProcessMessages(CNode* pfrom, std::atomic<bool>& inter\n     //\n     bool fMoreWork = false;\n \n-    if (!pfrom->vRecvGetData.empty())\n-        ProcessGetData(*pfrom, chainparams, m_connman, m_mempool, interruptMsgProc);\n+    {\n+        LOCK(pfrom->cs_vRecv);\n+        if (!pfrom->vRecvGetData.empty())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19911#discussion_r484568297",
      "id" : 484568297,
      "in_reply_to_id" : 484558805,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ4NDU2ODI5Nw==",
      "original_commit_id" : "a4d7f3dc3126b6b808f27dcf3ad7b6e8b9d6b0a7",
      "original_line" : 3866,
      "original_position" : 43,
      "original_start_line" : null,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 483710633,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19911",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-09-07T21:16:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/484568297",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/177646?v=4",
         "events_url" : "https://api.github.com/users/narula/events{/privacy}",
         "followers_url" : "https://api.github.com/users/narula/followers",
         "following_url" : "https://api.github.com/users/narula/following{/other_user}",
         "gists_url" : "https://api.github.com/users/narula/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/narula",
         "id" : 177646,
         "login" : "narula",
         "node_id" : "MDQ6VXNlcjE3NzY0Ng==",
         "organizations_url" : "https://api.github.com/users/narula/orgs",
         "received_events_url" : "https://api.github.com/users/narula/received_events",
         "repos_url" : "https://api.github.com/users/narula/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/narula/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/narula/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/narula"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The thread sanitizer is complaining about locking order; I'm looking into it.",
      "created_at" : "2020-09-07T22:46:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19911#issuecomment-688531736",
      "id" : 688531736,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19911",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY4ODUzMTczNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-09-07T22:46:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/688531736",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/177646?v=4",
         "events_url" : "https://api.github.com/users/narula/events{/privacy}",
         "followers_url" : "https://api.github.com/users/narula/followers",
         "following_url" : "https://api.github.com/users/narula/following{/other_user}",
         "gists_url" : "https://api.github.com/users/narula/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/narula",
         "id" : 177646,
         "login" : "narula",
         "node_id" : "MDQ6VXNlcjE3NzY0Ng==",
         "organizations_url" : "https://api.github.com/users/narula/orgs",
         "received_events_url" : "https://api.github.com/users/narula/received_events",
         "repos_url" : "https://api.github.com/users/narula/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/narula/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/narula/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/narula"
      }
   }
]
