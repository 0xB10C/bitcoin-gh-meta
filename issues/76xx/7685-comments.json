[
   {
      "body" : "Yes, would be interesting to keep track of some statistics regarding resource usage.\r\nConcept ACK",
      "created_at" : "2016-03-15T14:08:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7685#issuecomment-196836937",
      "id" : 196836937,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7685",
      "updated_at" : "2016-03-15T14:08:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/196836937",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Concept ACK.\r\n\r\nIs this pure coincidence?\r\n```\r\n      \"mempool_filter_amountoftxes\": 1788,\r\n      \"mempool_filter_timeconsumption\": 1788\r\n```\r\n",
      "created_at" : "2016-03-15T20:03:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7685#issuecomment-196998930",
      "id" : 196998930,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7685",
      "updated_at" : "2016-03-15T20:03:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/196998930",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7685#discussion_r56232088"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7685"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/56232088"
         }
      },
      "body" : "Please remove `primitives/block.h` from the network layer. Compute the size of the block in `main.cpp` and pass the size instead of the block itself into `FilterStatsProcessBlock()`.\r\n",
      "commit_id" : "6dfbf4daa74b618d37a435d0b8d2ba1d2a3275de",
      "created_at" : "2016-03-15T20:12:26Z",
      "diff_hunk" : "@@ -10,6 +10,7 @@\n #include \"compat.h\"\n #include \"limitedmap.h\"\n #include \"netbase.h\"\n+#include \"primitives/block.h\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7685#discussion_r56232088",
      "id" : 56232088,
      "original_commit_id" : "6dfbf4daa74b618d37a435d0b8d2ba1d2a3275de",
      "original_position" : 4,
      "path" : "src/net.h",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7685",
      "updated_at" : "2016-03-15T20:12:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/56232088",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7685#discussion_r56232270"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7685"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/56232270"
         }
      },
      "body" : "cosmetic new line missing",
      "commit_id" : "6dfbf4daa74b618d37a435d0b8d2ba1d2a3275de",
      "created_at" : "2016-03-15T20:13:44Z",
      "diff_hunk" : "@@ -626,3 +626,73 @@ UniValue clearbanned(const UniValue& params, bool fHelp)\n \n     return NullUniValue;\n }\n+\n+UniValue getfilterstats(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() > 0)\n+        throw runtime_error(\n+                            \"getfilterstats\\n\"\n+                            \"\\nReturns information about the bloom filter usage\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"time_in_cycle\\\": n,    (numeric) Total time in current cycle\\n\"\n+                            \"  \\\"timeframe\\\": n,        (numeric) Length of the measuring timeframe in seconds\\n\"\n+                            \"  \\\"mempool\\\":\\n\"\n+                            \"  {\\n\"\n+                            \"    \\\"mempool_filter_count\\\": n,              (numeric) Amount of processed mempool filterings\\n\"\n+                            \"    \\\"mempool_filter_amountoftxes\\\": n,       (numeric) Amounf of transaction filtered\\n\"\n+                            \"    \\\"mempool_filter_timeconsumption\\\": n,    (numeric) Amount of milliseconds consumed for the filtering\\n\"\n+                            \"  }\\n\"\n+                            \"  \\\"blocks\\\":\\n\"\n+                            \"  {\\n\"\n+                            \"    \\\"filteredblocks_count\\\": n,              (numeric) Amount of blocks filtered\\n\"\n+                            \"    \\\"filteredblocks_amountofbytes\\\": n,      (numeric) Amounf of total bytes of all filtered blocks\\n\"\n+                            \"    \\\"filteredblocks_timeconsumption\\\": n,    (numeric) Amount of milliseconds consumed for filtering the blocks\\n\"\n+                            \"  }\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            + HelpExampleCli(\"getfilterstats\", \"\")\n+                            + HelpExampleRpc(\"getfilterstats\", \"\")\n+                            );\n+\n+    UniValue obj(UniValue::VOBJ);\n+\n+    //copy stats object\n+    NodeFilterStats stats = CNode::FilterStatsGetGlobalStats();\n+\n+    // per timeframe\n+    UniValue cycle(UniValue::VOBJ);\n+    cycle.push_back(Pair(\"time_in_timeframe\", CNode::FilterStatsGetTimeInCycle()));\n+    cycle.push_back(Pair(\"timeframe\", CNode::FilterStatsGetTimeframe()));\n+\n+    UniValue blockStats(UniValue::VOBJ);\n+    blockStats.push_back(Pair(\"filteredblocks_count\", CNode::FilterStatsGetValue(stats.nFilterBlockCountInCycle)));\n+    blockStats.push_back(Pair(\"filteredblocks_amountofbytes\", CNode::FilterStatsGetValue(stats.nFilterBlockDataCountInCycle)));\n+    blockStats.push_back(Pair(\"filteredblocks_timeconsumption\", CNode::FilterStatsGetValue(stats.nFilterBlockTimeCountInCycle)));\n+    cycle.push_back(Pair(\"blocks\", blockStats));\n+\n+    UniValue mempoolStats(UniValue::VOBJ);\n+    mempoolStats.push_back(Pair(\"mempool_filter_count\", CNode::FilterStatsGetValue(stats.nFilterMempoolCountInCycle)));\n+    mempoolStats.push_back(Pair(\"mempool_filter_amountoftxes\", CNode::FilterStatsGetValue(stats.nFilterMempoolDataCountInCycle)));\n+    mempoolStats.push_back(Pair(\"mempool_filter_timeconsumption\", CNode::FilterStatsGetValue(stats.nFilterMempoolTimeCountInCycle)));\n+    cycle.push_back(Pair(\"mempool\", mempoolStats));\n+    obj.push_back(Pair(\"current_timeframe\", cycle));\n+\n+    // total\n+    UniValue total(UniValue::VOBJ);\n+\n+    UniValue blockStatsTotal(UniValue::VOBJ);\n+    blockStatsTotal.push_back(Pair(\"filteredblocks_count\", CNode::FilterStatsGetValue(stats.nFilterBlockCountInCycle, true)));\n+    blockStatsTotal.push_back(Pair(\"filteredblocks_amountofbytes\", CNode::FilterStatsGetValue(stats.nFilterBlockDataCountInCycle, true)));\n+    blockStatsTotal.push_back(Pair(\"filteredblocks_timeconsumption\", CNode::FilterStatsGetValue(stats.nFilterBlockTimeCountInCycle, true)));\n+    total.push_back(Pair(\"blocks\", blockStatsTotal));\n+\n+    UniValue mempoolStatsTotal(UniValue::VOBJ);\n+    mempoolStatsTotal.push_back(Pair(\"mempool_filter_count\", CNode::FilterStatsGetValue(stats.nFilterMempoolCountInCycle, true)));\n+    mempoolStatsTotal.push_back(Pair(\"mempool_filter_amountoftxes\", CNode::FilterStatsGetValue(stats.nFilterMempoolDataCountInCycle, true)));\n+    mempoolStatsTotal.push_back(Pair(\"mempool_filter_timeconsumption\", CNode::FilterStatsGetValue(stats.nFilterMempoolTimeCountInCycle, true)));\n+    total.push_back(Pair(\"mempool\", mempoolStatsTotal));\n+    obj.push_back(Pair(\"total\", total));\n+    \n+    return obj;\n+}",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7685#discussion_r56232270",
      "id" : 56232270,
      "original_commit_id" : "6dfbf4daa74b618d37a435d0b8d2ba1d2a3275de",
      "original_position" : 73,
      "path" : "src/rpc/net.cpp",
      "position" : 73,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7685",
      "updated_at" : "2016-03-15T20:13:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/56232270",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   }
]
