[
   {
      "body" : "What are you switching from?\r\n\r\nNothing in coinselection should have changed. There are unit tests which should detect it if it did. ",
      "created_at" : "2016-03-09T07:51:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7657#issuecomment-194167063",
      "id" : 194167063,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7657",
      "updated_at" : "2016-03-09T07:51:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/194167063",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "> If it helps, during the time period I have received about 2.6x as many transactions as I have sent. The average receive amount was 0.11 BTC, and average send 0.26 BTC.\r\n\r\nWouldn't it make sense if you receive a lot of \"small\" inputs and only send a few \"large\" outputs, that the number of outputs in your wallet increases? (Coin selection does not select a set of coins such that the utxo is reduced but rather a set of coins that \"fits best\" to the output value)",
      "created_at" : "2016-03-09T09:34:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7657#issuecomment-194207820",
      "id" : 194207820,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7657",
      "updated_at" : "2016-03-09T09:34:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/194207820",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "> What are you switching from?\r\n\r\nSwitching from 11.2\r\n\r\n> There was a really minor change to the coin selection #4906 but this should only trigger in really rare edge cases.\r\n\r\nLooking at #4906 it might actually be the reason for the observed difference. If before it was using lots of extraneous inputs, it would've kept the unspent set in check.\r\n\r\nRight now, since last night the set has continued to grow:\r\n> $ bitcoin-cli listunspent | grep amount | wc -l\r\n> 786\r\n\r\nWhich gives me the impression that it is almost trying to converge on `100*$amountOfBitcoins` outputs, which is clearly extremely unideal.\r\n\r\nDoing a quick skim of the code, it seems the situation could be improved a lot by making bitcoin aggressively attempt to make transactions without a change output, remembering that there are potentially three extra costs associated with creating a change output:\r\na) The cost associated with the extra transaction size\r\nb) The cost associated with how in the future, that output will need to be spent\r\nc) Privacy (normally change addresses are super easy to determine, which then get spent-linked with the rest of your wallet)\r\n\r\nAnd lets say you figure the extra associated cost of a change output to be ~80.00 bits, a side benefit of forgoing that change output to save 79.00 bits, would be that extra money is going to mining fees, and might help confirm faster. \r\n\r\nI'm also not convinced that trying to make change outputs at least 0.01 BTC is particularly useful once you factor into the cost of creating change outputs For instance some extra dust outputs is actually essential in helping sourcing the exact amount of inputs required.\r\n",
      "created_at" : "2016-03-09T16:27:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7657#issuecomment-194377451",
      "id" : 194377451,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7657",
      "updated_at" : "2016-03-09T16:27:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/194377451",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9326759?v=3",
         "events_url" : "https://api.github.com/users/RHavar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RHavar/followers",
         "following_url" : "https://api.github.com/users/RHavar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RHavar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RHavar",
         "id" : 9326759,
         "login" : "RHavar",
         "organizations_url" : "https://api.github.com/users/RHavar/orgs",
         "received_events_url" : "https://api.github.com/users/RHavar/received_events",
         "repos_url" : "https://api.github.com/users/RHavar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RHavar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RHavar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RHavar"
      }
   },
   {
      "body" : "> Doing a quick skim of the code, it seems the situation could be improved a lot by making bitcoin aggressively attempt to make transactions without a change output\r\n\r\nThis would require you to always have appropriately sized coins in your wallet or just \"donate\" the change via the fee and the try to minimize the additional fee/change.\r\n\r\n>  a) The cost associated with the extra transaction size\r\n\r\nTrue, but right now the wallet code is not \"aware\" of the transaction size and does not optimize in this direction. Related: #5782\r\n\r\n>  c) Privacy (normally change addresses are super easy to determine, which then get spent-linked with the rest of your wallet)\r\n\r\nI agree it is trivial to determine the change output on random transactions that are not yours. There was some discussion in   #6569\r\n\r\n> I'm also not convinced that trying to make change outputs at least 0.01 BTC is particularly useful once you factor into the cost of creating change outputs For instance some extra dust outputs is actually essential in helping sourcing the exact amount of inputs required.\r\n\r\nPlease check #7615 which makes it 0.001 BTC\r\n\r\n",
      "created_at" : "2016-03-09T16:45:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7657#issuecomment-194390230",
      "id" : 194390230,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7657",
      "updated_at" : "2016-03-09T16:45:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/194390230",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "> This would require you to always have appropriately sized coins in your wallet or just \"donate\" the change via the fee and the try to minimize the additional fee/change.\r\n\r\nYeah. My thoughts were that the code should run coin selection twice. Once for a transaction with no change output (trying to minimize for the extraneous mining fee), and once for a transaction with a change output. \r\n\r\nThen you can compare the mining fee of the two transactions (but applying a X penalty to the one with a change output)  and pick the one with a smaller mining fee. \r\n\r\n\r\n(I think X will be around ~50 bits, but you can more scientifically calculate it by figuring out the extra fee increase transaction by increase a transaction size of +1 output and +1 transaction input)",
      "created_at" : "2016-03-09T16:58:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/7657#issuecomment-194396282",
      "id" : 194396282,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7657",
      "updated_at" : "2016-03-09T16:59:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/194396282",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/9326759?v=3",
         "events_url" : "https://api.github.com/users/RHavar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/RHavar/followers",
         "following_url" : "https://api.github.com/users/RHavar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/RHavar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/RHavar",
         "id" : 9326759,
         "login" : "RHavar",
         "organizations_url" : "https://api.github.com/users/RHavar/orgs",
         "received_events_url" : "https://api.github.com/users/RHavar/received_events",
         "repos_url" : "https://api.github.com/users/RHavar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/RHavar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/RHavar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/RHavar"
      }
   }
]
