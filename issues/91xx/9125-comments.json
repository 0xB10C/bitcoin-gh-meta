[
   {
      "body" : "Concept ACK. _Very_ curious to see some memory usage numbers :)",
      "created_at" : "2016-11-11T02:36:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-259866415",
      "id" : 259866415,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-11T03:29:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259866415",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "I created a branch with some follow-up *shared_ptr all the things* and other optimizations: https://github.com/sipa/bitcoin/commits/sharedblock2",
      "created_at" : "2016-11-11T07:12:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-259895918",
      "id" : 259895918,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-11T07:12:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259895918",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "tested ACK.",
      "created_at" : "2016-11-14T17:57:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-260409978",
      "id" : 260409978,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-14T17:57:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/260409978",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "FWIW, I attempted to test the performance impact of this but it is a bit difficulty to do a fair comparison. I am reasonably confident that it does not produce a significant slowdown. (logically it should be a speedup, but I don't think my measurements were fair/reliable enough to determine if there was on or not).",
      "created_at" : "2016-11-15T07:49:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-260570570",
      "id" : 260570570,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-15T07:49:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/260570570",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "I did a quick performance comparison running on 2 days of historical data, and though I was unable to quantify any meaningful performance difference, I agree that this doesn't appear to cause a significant slowdown.",
      "created_at" : "2016-11-16T20:01:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261055148",
      "id" : 261055148,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-16T20:01:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261055148",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7463573?v=3",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "body" : "Benchmark results (25 reindex-chainstates until last checkpoint, default dbcache, otherwise unloaded 24-core machine, measured by -debug=bench) on both master and #9125+#8580+#8589+a few shared_ptr optimizations I haven't PR'ed yet:\r\n* Average: master 1490s, shared_ptr 1442s\r\n\r\nBest master run:\r\n```\r\n2016-11-16 12:27:14   - Load block from disk: 1.25ms [273.57s]\r\n2016-11-16 12:27:14     - Sanity checks: 0.14ms [70.95s]\r\n2016-11-16 12:27:14     - Fork checks: 0.02ms [80.76s]\r\n2016-11-16 12:27:14       - Connect 64 transactions: 11.06ms (0.173ms/tx, 0.020ms/txin) [711.67s]\r\n2016-11-16 12:27:14     - Verify 550 txins: 11.09ms (0.020ms/txin) [718.24s]\r\n2016-11-16 12:27:14     - Index writing: 0.03ms [5.25s]\r\n2016-11-16 12:27:14     - Callbacks: 0.01ms [3.75s]\r\n2016-11-16 12:27:14   - Connect total: 11.34ms [896.52s]\r\n2016-11-16 12:27:14   - Flush: 0.26ms [86.70s]\r\n2016-11-16 12:27:14   - Writing chainstate: 0.02ms [112.45s]\r\n2016-11-16 12:27:14   - Connect postprocess: 0.42ms [86.88s]\r\n2016-11-16 12:27:14 - Connect block: 13.30ms [1456.12s]\r\n```\r\n\r\nBest shared_ptr run:\r\n```\r\n2016-11-16 10:17:40   - Load block from disk: 1.61ms [283.93s]\r\n2016-11-16 10:17:40     - Sanity checks: 0.18ms [76.82s]\r\n2016-11-16 10:17:40     - Fork checks: 0.03ms [83.22s]\r\n2016-11-16 10:17:40       - Connect 64 transactions: 17.43ms (0.272ms/tx, 0.032ms/txin) [717.76s]\r\n2016-11-16 10:17:40     - Verify 550 txins: 17.47ms (0.032ms/txin) [724.51s]\r\n2016-11-16 10:17:40     - Index writing: 0.02ms [5.34s]\r\n2016-11-16 10:17:40     - Callbacks: 0.02ms [3.85s]\r\n2016-11-16 10:17:40   - Connect total: 17.81ms [911.36s]\r\n2016-11-16 10:17:40   - Flush: 0.40ms [87.91s]\r\n2016-11-16 10:17:40   - Writing chainstate: 0.03ms [112.31s]\r\n2016-11-16 10:17:40   - Connect postprocess: 0.08ms [25.61s]\r\n2016-11-16 10:17:40 - Connect block: 19.94ms [1421.12s]\r\n```\r\n\r\nGoing to include just this PR in future benchmarks as well, as there seem to be some slowdowns too, and I don't know where they're coming from.",
      "created_at" : "2016-11-16T20:07:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/9125#issuecomment-261056620",
      "id" : 261056620,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/9125",
      "updated_at" : "2016-11-16T20:42:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261056620",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
