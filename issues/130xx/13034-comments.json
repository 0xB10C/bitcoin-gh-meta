[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Note to reviewers, I would prefer to have base PR's reviewed and merged first, but feel free to stay around and comment.\r\n\r\n2nd commit is mostly moved code (67420d3).",
      "created_at" : "2018-04-20T01:54:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13034#issuecomment-382940552",
      "id" : 382940552,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13034",
      "updated_at" : "2018-04-20T01:55:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/382940552",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13034#discussion_r182929363"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182929363"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "BTW, I'm planning to move the iteration to `WalletManager` and make `MaybeCompactWalletDB(WalletDatabase& dbh)`. This way `WalletManager` dependency is removed here.\r\n\r\n@jnewbery it would also move `scheduler.scheduleEvery(MaybeCompactWalletDB, 500);` to `WalletManager`.",
      "commit_id" : "d4985f3c2e005f9431c15e6891beb092601a9d3c",
      "created_at" : "2018-04-20T01:58:51Z",
      "diff_hunk" : "@@ -756,7 +757,7 @@ void MaybeCompactWalletDB()\n         return;\n     }\n \n-    for (CWallet* pwallet : GetWallets()) {\n+    for (CWallet* pwallet : g_wallet_manager.GetWallets()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13034#discussion_r182929363",
      "id" : 182929363,
      "original_commit_id" : "67420d3191ee5908e71c3e3a3b57a89b12a2f402",
      "original_position" : 13,
      "path" : "src/wallet/walletdb.cpp",
      "position" : null,
      "pull_request_review_id" : 113830104,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13034",
      "updated_at" : "2018-04-20T08:36:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182929363",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13034#discussion_r182973897"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182973897"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It would be better to use spaces.",
      "commit_id" : "d4985f3c2e005f9431c15e6891beb092601a9d3c",
      "created_at" : "2018-04-20T08:03:16Z",
      "diff_hunk" : "@@ -258,6 +259,7 @@ libbitcoin_wallet_a_SOURCES = \\\n   wallet/rpcwallet.cpp \\\n   wallet/wallet.cpp \\\n   wallet/walletdb.cpp \\\n+\twallet/walletmanager.cpp \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13034#discussion_r182973897",
      "id" : 182973897,
      "original_commit_id" : "ac21dd23430c140321e6c2a4883b5882ab241b82",
      "original_position" : 12,
      "path" : "src/Makefile.am",
      "position" : null,
      "pull_request_review_id" : 113882660,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13034",
      "updated_at" : "2018-04-20T08:36:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182973897",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/11154118?v=4",
         "events_url" : "https://api.github.com/users/ken2812221/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ken2812221/followers",
         "following_url" : "https://api.github.com/users/ken2812221/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ken2812221/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ken2812221",
         "id" : 11154118,
         "login" : "ken2812221",
         "organizations_url" : "https://api.github.com/users/ken2812221/orgs",
         "received_events_url" : "https://api.github.com/users/ken2812221/received_events",
         "repos_url" : "https://api.github.com/users/ken2812221/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ken2812221/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ken2812221"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/13034#discussion_r182981844"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13034"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182981844"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Fixed, ty.",
      "commit_id" : "d4985f3c2e005f9431c15e6891beb092601a9d3c",
      "created_at" : "2018-04-20T08:37:10Z",
      "diff_hunk" : "@@ -258,6 +259,7 @@ libbitcoin_wallet_a_SOURCES = \\\n   wallet/rpcwallet.cpp \\\n   wallet/wallet.cpp \\\n   wallet/walletdb.cpp \\\n+\twallet/walletmanager.cpp \\",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13034#discussion_r182981844",
      "id" : 182981844,
      "in_reply_to_id" : 182973897,
      "original_commit_id" : "ac21dd23430c140321e6c2a4883b5882ab241b82",
      "original_position" : 12,
      "path" : "src/Makefile.am",
      "position" : null,
      "pull_request_review_id" : 113892223,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/13034",
      "updated_at" : "2018-04-20T08:37:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/182981844",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> which will be useful for [...] src/interface/walletmanager.h for UI and process separation (@ryanofsky sgty?);\r\n\r\nIt does not seem correct to me to claim shallow organizational changes like this PR, #12587, or #13017 will help with process separation or with loading and unloading wallets after startup. I don't think these changes will hurt anything either (except maybe giving me a few interesting merge conflicts to resolve in 10d0096dfbca85318af5f4476bbcffa4dc9909ed from #10973). But at best they seem like flailing around with code organization and running in place.\r\n\r\nPersonally, I would prefer to just manage wallets with standard c++ data structures and synchronization primitives instead of having a management interface. But if you'd prefer to have a management interface, I don't see a reason why you'd want it to use pimpl, or a reason why you would want to expose and duplicate it in [`src/interfaces/`](https://github.com/bitcoin/bitcoin/tree/master/src/interfaces) outside the wallet, instead of just adding a simple `handleUnloadWallet` callback for the GUI to complement the existing [`handleLoadWallet`](https://github.com/bitcoin/bitcoin/blob/8b262eb2d80bfa27ae8501078ce47bc1407e9c55/src/interfaces/node.h#L214-L216) and [`getWallets`](https://github.com/bitcoin/bitcoin/blob/8b262eb2d80bfa27ae8501078ce47bc1407e9c55/src/interfaces/node.h#L191-L192).\r\n\r\nAll of these are just surface disagreements about code organization, though, that really don't have any effect on features. If I could encourage you to work on an actual feature, I think it would be either writing code to implement wallet unloading, or writing a design doc or sequence diagram showing what data structures in the GUI and wallet need to be updated in what order for wallet unloading to work safely and responsively. ",
      "created_at" : "2018-04-20T10:48:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/13034#issuecomment-383059451",
      "id" : 383059451,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/13034",
      "updated_at" : "2018-04-20T10:48:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383059451",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
