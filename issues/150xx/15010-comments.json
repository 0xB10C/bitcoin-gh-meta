[
   {
      "author_association" : "MEMBER",
      "body" : "#14602 has required rebase for a few weeks and has several review comments unanswered.\r\n\r\nThis PR extracts the non-contentious bugfix from that PR and adds testing and commenting.",
      "created_at" : "2018-12-20T16:21:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15010#issuecomment-449053479",
      "id" : 449053479,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15010",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0OTA1MzQ3OQ==",
      "updated_at" : "2018-12-20T16:21:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/449053479",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#13756](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13756.html) (wallet: \"avoid_reuse\" wallet flag for improved privacy by kallewoof)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2018-12-20T18:30:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15010#issuecomment-449092861",
      "id" : 449092861,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15010",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0OTA5Mjg2MQ==",
      "updated_at" : "2018-12-21T12:54:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/449092861",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I may be off base here, but looking at `CWallet::AvailableCoins` makes me think that some other argument is needed, to separately address:\r\n* coins which have received at least N confirmations, relative to the current moment\r\n* coins which were spendable M blocks ago\r\n\r\nTo me, the `getbalance` docs do not seem to indicate that coins spent in the past N blocks will be included in the balance. I would expect setting an earlier `minconf` there to uniformy decrease my balance (by windowing down to coins confirmed at greater depth / available with higher confidence), not to provide a window into the past (by excluding more recent spends).\r\n",
      "created_at" : "2018-12-20T22:17:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15010#issuecomment-449153367",
      "id" : 449153367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15010",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0OTE1MzM2Nw==",
      "updated_at" : "2018-12-20T22:17:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/449153367",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15010#discussion_r244255054"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15010"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/244255054"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is still the incorrect behaviour, I think. The correct values that should be returned here (at least with `dummy=\"*\"`) are 9.99 and -10.01, respectively. This is because sent transactions are always excluded from the balance, but incoming transactions are only included once they have sufficiently confirmed.",
      "commit_id" : "14130114d589845cf0395bf9b7ca20f0c7aa32d7",
      "created_at" : "2018-12-28T03:00:28Z",
      "diff_hunk" : "@@ -89,10 +89,9 @@ def run_test(self):\n         # Same with minconf=0\n         assert_equal(self.nodes[0].getbalance(minconf=0), Decimal('9.99'))\n         assert_equal(self.nodes[1].getbalance(minconf=0), Decimal('29.99'))\n-        # getbalance with a minconf incorrectly excludes coins that have been spent more recently than the minconf blocks ago\n-        # TODO: fix getbalance tracking of coin spentness depth\n-        assert_equal(self.nodes[0].getbalance(minconf=1), Decimal('0'))\n-        assert_equal(self.nodes[1].getbalance(minconf=1), Decimal('0'))\n+        # getbalance with a minconf includes coins that have been spent more recently than the minconf blocks ago\n+        assert_equal(self.nodes[0].getbalance(minconf=1), Decimal('50'))\n+        assert_equal(self.nodes[1].getbalance(minconf=1), Decimal('50'))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15010#discussion_r244255054",
      "id" : 244255054,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NDI1NTA1NA==",
      "original_commit_id" : "14130114d589845cf0395bf9b7ca20f0c7aa32d7",
      "original_position" : 10,
      "path" : "test/functional/wallet_balance.py",
      "position" : 10,
      "pull_request_review_id" : 188211016,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15010",
      "updated_at" : "2018-12-28T03:00:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/244255054",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Can you have a look here @MeshCollider? If this is a non-contentious bugfix we should probably try to get this in.",
      "created_at" : "2019-01-02T13:03:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15010#issuecomment-450858236",
      "id" : 450858236,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15010",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1MDg1ODIzNg==",
      "updated_at" : "2019-01-02T13:03:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/450858236",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This change looks sensible to me, but luke's comment above hasn't been addressed yet",
      "created_at" : "2019-01-03T11:20:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15010#issuecomment-451116394",
      "id" : 451116394,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15010",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ1MTExNjM5NA==",
      "updated_at" : "2019-01-03T11:20:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/451116394",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/3211283?v=4",
         "events_url" : "https://api.github.com/users/MeshCollider/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MeshCollider/followers",
         "following_url" : "https://api.github.com/users/MeshCollider/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MeshCollider/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MeshCollider",
         "id" : 3211283,
         "login" : "MeshCollider",
         "node_id" : "MDQ6VXNlcjMyMTEyODM=",
         "organizations_url" : "https://api.github.com/users/MeshCollider/orgs",
         "received_events_url" : "https://api.github.com/users/MeshCollider/received_events",
         "repos_url" : "https://api.github.com/users/MeshCollider/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MeshCollider/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MeshCollider/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MeshCollider"
      }
   }
]
