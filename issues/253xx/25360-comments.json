[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, going to test.",
      "created_at" : "2022-06-13T14:45:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25360#issuecomment-1154016080",
      "id" : 1154016080,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25360",
      "node_id" : "IC_kwDOABII585EyONQ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1154016080/reactions"
      },
      "updated_at" : "2022-06-13T14:45:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1154016080",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I haven't verified whether they work, but `readelf  -n bitcoind` on the GUIX-built RISC-V binary correctly shows the available probles:\r\n```\r\nDisplaying notes found in: .note.stapsdt\r\n  Owner                Data size        Description\r\n  stapsdt              0x00000050       NT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: net\r\n    Name: outbound_message\r\n    Location: 0x00000000000b1dd4, Base: 0x0000000000986690, Semaphore: 0x0000000000000000\r\n    Arguments: -8@s0 8@s3 8@a0 8@24(s2) 8@a5 8@a4\r\n  stapsdt              0x00000055       NT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: net\r\n    Name: inbound_message\r\n    Location: 0x00000000000ec18c, Base: 0x0000000000986690, Semaphore: 0x0000000000000000\r\n    Arguments: -8@s9 8@s10 8@232(sp) 8@72(s5) 8@a5 8@a4\r\n  stapsdt              0x00000046       NT_STAPSDT (SystemTap probe descriptors)\r\n    Provider: utxocache\r\n    Name: flush\r\n    Location: 0x0000000000253db4, Base: 0x0000000000986690, Semaphore: 0x0000000000000000\r\n    Arguments: -8@s3 4@s2 8@8(sp) 8@s7 1@s10\r\nâ¦\r\n```\r\ngdb output:\r\n```\r\n(gdb) info probes\r\nType Provider       Name                      Where              Semaphore Object\r\nstap coin_selection aps_create_tx_internal    0x000000000033194a           â¦/bitcoin-b8c146b87720/bin/bitcoind\r\nstap coin_selection attempting_aps_create_tx  0x0000000000331794           â¦/bitcoin-b8c146b87720/bin/bitcoind\r\nstap coin_selection normal_create_tx_internal 0x00000000003316ee           â¦/bitcoin-b8c146b87720/bin/bitcoind\r\nstap coin_selection selected_coins            0x000000000032fe42           â¦/bitcoin-b8c146b87720/bin/bitcoind\r\nstap net            inbound_message           0x00000000000ec18c           â¦/bitcoin-b8c146b87720/bin/bitcoind\r\nstap net            outbound_message          0x00000000000b1dd4           â¦/bitcoin-b8c146b87720/bin/bitcoind\r\nstap utxocache      add                       0x000000000043dda4           â¦/bitcoin-b8c146b87720/bin/bitcoind\r\nstap utxocache      flush                     0x0000000000253db4           â¦/bitcoin-b8c146b87720/bin/bitcoind\r\nstap utxocache      spent                     0x000000000043e328           â¦/bitcoin-b8c146b87720/bin/bitcoind\r\nstap utxocache      uncache                   0x000000000043d6da           â¦/bitcoin-b8c146b87720/bin/bitcoind\r\nstap validation     block_connected           0x000000000025a09a           â¦/bitcoin-b8c146b87720/bin/bitcoind\r\n```",
      "created_at" : "2022-06-13T17:03:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25360#issuecomment-1154166772",
      "id" : 1154166772,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25360",
      "node_id" : "IC_kwDOABII585Eyy_0",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1154166772/reactions"
      },
      "updated_at" : "2022-06-13T17:21:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1154166772",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I have tried to run the tracepoint tests in RISC-V, however, the necessary bcc python binding is not installable on this platform yet:\r\n```\r\nroot@loreley# apt install python3-bpfcc\r\nReading package lists... Done\r\nBuilding dependency tree... Done\r\nReading state information... Done\r\nSome packages could not be installed. This may mean that you have\r\nrequested an impossible situation or if you are using the unstable\r\ndistribution that some required packages have not yet been created\r\nor been moved out of Incoming.\r\nThe following information may help to resolve the situation:\r\n\r\nThe following packages have unmet dependencies:\r\n python3-bpfcc : Depends: libbpfcc (>= 0.24.0+ds-1) but it is not installable\r\nE: Unable to correct problems, you have held broken packages.\r\nroot@loreley# apt install libbpfcc\r\nReading package lists... Done\r\nBuilding dependency tree... Done\r\nReading state information... Done\r\nPackage libbpfcc is not available, but is referred to by another package.\r\nThis may mean that the package is missing, has been obsoleted, or\r\nis only available from another source\r\n\r\nE: Package 'libbpfcc' has no installation candidate\r\n```\r\nIt might be possible to build it from source, I'm not sure, I think there's some problems around LLVM.\r\n\r\nSo, I've tried to test in a different way, by breaking on the tracepoint using gdb. This seems to work, at first:\r\n```\r\n(gdb) break -probe-stap net:inbound_message\r\nBreakpoint 1 at 0xec18c\r\n(gdb) run\r\nStarting program: â¦/bitcoin-b8c146b87720/bin/bitcoind\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/lib/riscv64-linux-gnu/libthread_db.so.1\".\r\n2022-06-13T19:41:52Z Bitcoin Core version v23.99.0-gb8c146b8772030c6efaac43198c4de0d76fd25af (release build)\r\nâ¦\r\n[Thread 0x3fcaffd110 (LWP 19993) exited]\r\n[Switching to Thread 0x3fc97fa110 (LWP 19996)]\r\n\r\nThread 17 \"b-msghand\" hit Breakpoint 1, 0x0000002aaab9618c in ?? ()\r\n```\r\nPrinting the arguments apparently doesn't work on this platform yet!\r\n```\r\n(gdb) print $_probe_arg0\r\nwarning: The SystemTap SDT probe support is not fully implemented on this target;\r\nyou will not be able to inspect the arguments of the probes.\r\nPlease report a bug against GDB requesting a port to this target.\r\nInvalid probe argument 0 -- probe has 0 arguments available\r\n```\r\n",
      "created_at" : "2022-06-13T19:45:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25360#issuecomment-1154360979",
      "id" : 1154360979,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25360",
      "node_id" : "IC_kwDOABII585EziaT",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1154360979/reactions"
      },
      "updated_at" : "2022-06-13T19:45:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1154360979",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
