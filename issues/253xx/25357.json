{
   "active_lock_reason" : null,
   "assignee" : null,
   "assignees" : [],
   "author_association" : "MEMBER",
   "body" : "The PPC64 ELF ABI has a non-executable stack by default, so passing `-Wl,-z,noexecstack` to force the creation of a `GNU_STACK` segment, just so we can assert that it doesn't have the exectable permission, is awkward. Instead, just check that there is no `GNU_STACK` segment in the PPC64 binaries. I would have used `binary.header.machine_type` here, but because this check is generic, and called for all executable types, that wouldn't work, as, for example, the PE binary headers don't have a `machine_type`.\r\n\r\nA LIEF issue has been opened upstream: https://github.com/lief-project/LIEF/issues/717.\r\n\r\nSee the relevant Linux kernel [documentation for powerpc](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/powerpc/include/asm/page_64.h#n92) (and discussion in #25313):\r\n```c\r\n/*\r\n * This is the default if a program doesn't have a PT_GNU_STACK\r\n * program header entry. The PPC64 ELF ABI has a non executable stack\r\n * stack by default, so in the absence of a PT_GNU_STACK program header\r\n * we turn execute permission off.\r\n */\r\n#define VM_STACK_DEFAULT_FLAGS32\tVM_DATA_FLAGS_EXEC\r\n#define VM_STACK_DEFAULT_FLAGS64\tVM_DATA_FLAGS_NON_EXEC\r\n\r\n#define VM_STACK_DEFAULT_FLAGS \\\r\n\t(is_32bit_task() ? \\\r\n\t VM_STACK_DEFAULT_FLAGS32 : VM_STACK_DEFAULT_FLAGS64)\r\n```\r\n\r\nGuix Build (x86_64):\r\n```bash\r\nbdde0110f8cdc3ce79581acfe98da776d4057d80e80cddffd9a882b8ee5a8e78  guix-build-d5eae5f7300b/output/aarch64-linux-gnu/SHA256SUMS.part\r\nd1ad0a1e6524a90c1b05b7f16ddb156d0f35b3459a80ec8a8bf7aed9f0b64b38  guix-build-d5eae5f7300b/output/aarch64-linux-gnu/bitcoin-d5eae5f7300b-aarch64-linux-gnu-debug.tar.gz\r\n227dd5eea5c305e5ea4f1a513d541226e80b0bfbd8f6722ab554ebbb41b25f15  guix-build-d5eae5f7300b/output/aarch64-linux-gnu/bitcoin-d5eae5f7300b-aarch64-linux-gnu.tar.gz\r\n308056d504510599804d543580f025706af98ab9e0011d787abd1acf6be39e26  guix-build-d5eae5f7300b/output/arm-linux-gnueabihf/SHA256SUMS.part\r\nefb3c108fca7a55a39a68bddffbbb8c7621735d15b75034d9776a1fa840ac06a  guix-build-d5eae5f7300b/output/arm-linux-gnueabihf/bitcoin-d5eae5f7300b-arm-linux-gnueabihf-debug.tar.gz\r\nd4f33afe2e94e9f39693dfe10a3a51ad801314f29a830a7deddf7b63ad67592c  guix-build-d5eae5f7300b/output/arm-linux-gnueabihf/bitcoin-d5eae5f7300b-arm-linux-gnueabihf.tar.gz\r\n02e4224703c515a6fd9d4f3a51675dc7944220a0976d8bb7c0721def3b7ff9a3  guix-build-d5eae5f7300b/output/arm64-apple-darwin/SHA256SUMS.part\r\neae95620c321bc3403b196187447afb171b6aebb20d3277bf1081105a9dd47ac  guix-build-d5eae5f7300b/output/arm64-apple-darwin/bitcoin-d5eae5f7300b-arm64-apple-darwin-unsigned.dmg\r\nb2b285a1fab543a600a6666cd1e69678a1ddec9af0b2b82c6d8693264d4e5008  guix-build-d5eae5f7300b/output/arm64-apple-darwin/bitcoin-d5eae5f7300b-arm64-apple-darwin-unsigned.tar.gz\r\n80b6e0246ff41e9bf58fc910ffd7be9c96a69ac7eaccd987b7edecf9724c1a13  guix-build-d5eae5f7300b/output/arm64-apple-darwin/bitcoin-d5eae5f7300b-arm64-apple-darwin.tar.gz\r\n78da04fa957b0038fde70df0ff6540c53778c83f903269aa9cb8e80fbec802e5  guix-build-d5eae5f7300b/output/dist-archive/bitcoin-d5eae5f7300b.tar.gz\r\ncdf6c37d23db757ea347856cb85df5ea5a8a97a9d4bfaf7b2532f754af1696b3  guix-build-d5eae5f7300b/output/powerpc64-linux-gnu/SHA256SUMS.part\r\n9c0b43a59209d5aa63953aceab923fedb1193e08738a3b0eedd3d288180b8e45  guix-build-d5eae5f7300b/output/powerpc64-linux-gnu/bitcoin-d5eae5f7300b-powerpc64-linux-gnu-debug.tar.gz\r\nae2cc7a283ca27e43da3309631c7204850ada11929dfb3d1571dd019047b7ddb  guix-build-d5eae5f7300b/output/powerpc64-linux-gnu/bitcoin-d5eae5f7300b-powerpc64-linux-gnu.tar.gz\r\nc69b3b76e772b70f96b1ed29b3d5cc04e89f85fe1a5f72dc5077e0b9f9d104db  guix-build-d5eae5f7300b/output/powerpc64le-linux-gnu/SHA256SUMS.part\r\n9c65edaee946654a86ce33bda14b0c7f926df7db1f770fcb8595231362162e1e  guix-build-d5eae5f7300b/output/powerpc64le-linux-gnu/bitcoin-d5eae5f7300b-powerpc64le-linux-gnu-debug.tar.gz\r\n616d57fdb4d6eca4946cb7c5e72fed45702dbe707c583561f80e7d43af05a68f  guix-build-d5eae5f7300b/output/powerpc64le-linux-gnu/bitcoin-d5eae5f7300b-powerpc64le-linux-gnu.tar.gz\r\na69e4199a90eb0355943af4127e000c1de7901e59a1d451118381063959952cf  guix-build-d5eae5f7300b/output/riscv64-linux-gnu/SHA256SUMS.part\r\nf2bafcea1b8cd34261ac01748c4ce6b6704060f93518e9df9638ddcafd7e2200  guix-build-d5eae5f7300b/output/riscv64-linux-gnu/bitcoin-d5eae5f7300b-riscv64-linux-gnu-debug.tar.gz\r\n2821d1bf0fa18259e37c43d47f430e06afbfd65eb794edd21479944311416137  guix-build-d5eae5f7300b/output/riscv64-linux-gnu/bitcoin-d5eae5f7300b-riscv64-linux-gnu.tar.gz\r\nb51f43d939100c4465ae5df2202cddc95e160a68896aeafdf1800a56ab19e378  guix-build-d5eae5f7300b/output/x86_64-apple-darwin/SHA256SUMS.part\r\n543baabab34cb6c99ee38d47ef6ebd489553660f69ed28877bc9d2206c677b43  guix-build-d5eae5f7300b/output/x86_64-apple-darwin/bitcoin-d5eae5f7300b-x86_64-apple-darwin-unsigned.dmg\r\n58ac6365c9fb0f05fe29b3dccac1feb111bfaf725aa31438ad9f1dc4f6180ef1  guix-build-d5eae5f7300b/output/x86_64-apple-darwin/bitcoin-d5eae5f7300b-x86_64-apple-darwin-unsigned.tar.gz\r\n3f49ce55c22923855f027177a4eeff0d145af819e97352a54171804f686d14db  guix-build-d5eae5f7300b/output/x86_64-apple-darwin/bitcoin-d5eae5f7300b-x86_64-apple-darwin.tar.gz\r\n5d12a88a2729e0ec964e007137d7c98b783567d19c8a28c81a5ea4ee26f251dd  guix-build-d5eae5f7300b/output/x86_64-linux-gnu/SHA256SUMS.part\r\neb24d72babdba0b1d7c868f76b1af301fdce5ecfdb441e13eb392011db622d5f  guix-build-d5eae5f7300b/output/x86_64-linux-gnu/bitcoin-d5eae5f7300b-x86_64-linux-gnu-debug.tar.gz\r\n83746cba3d8a1a1ffb6c35307c6e673867438d62b7e33b6ca83e29e523627efa  guix-build-d5eae5f7300b/output/x86_64-linux-gnu/bitcoin-d5eae5f7300b-x86_64-linux-gnu.tar.gz\r\n879d0e6b5a699b8616b01b16cf351ebea476aea7bae13f9fa90363ed0fc701f8  guix-build-d5eae5f7300b/output/x86_64-w64-mingw32/SHA256SUMS.part\r\n3302fe60c613375d4c16d0eea43ad7a345e406d4edefaa8c007410755f165622  guix-build-d5eae5f7300b/output/x86_64-w64-mingw32/bitcoin-d5eae5f7300b-win64-debug.zip\r\n434a94570fac61303c34a998712c5022f4dbb08619cda3c55b9dd4a96e907116  guix-build-d5eae5f7300b/output/x86_64-w64-mingw32/bitcoin-d5eae5f7300b-win64-setup-unsigned.exe\r\n104cb87a014b59e044165a959f56ce0c35e99f3ffea05ff17cbfd095434ae503  guix-build-d5eae5f7300b/output/x86_64-w64-mingw32/bitcoin-d5eae5f7300b-win64-unsigned.tar.gz\r\n11bd219e524f223dbbbfde7253743a049d2169e3500f759eae69413d7ab9e8f7  guix-build-d5eae5f7300b/output/x86_64-w64-mingw32/bitcoin-d5eae5f7300b-win64.zip\r\n```\r\n\r\nGuix Build (arm64):\r\n```bash\r\n08b79d8ce2109593cc9efb8b9d7a027941cf4d23517717a2699c51904b553a7c  guix-build-d5eae5f7300b/output/arm-linux-gnueabihf/SHA256SUMS.part\r\n00352058bc0088a364430f3f0b5beda06d162aef0223e2837d4ef24210df483b  guix-build-d5eae5f7300b/output/arm-linux-gnueabihf/bitcoin-d5eae5f7300b-arm-linux-gnueabihf-debug.tar.gz\r\ne88f117db791aa4fe7f855d54affce30282e9ae33c598a8c74f37d0e680cbb24  guix-build-d5eae5f7300b/output/arm-linux-gnueabihf/bitcoin-d5eae5f7300b-arm-linux-gnueabihf.tar.gz\r\n705c32791115d1f1efbd2cd755911f73291a1e9633252ace1c146554940565e2  guix-build-d5eae5f7300b/output/arm64-apple-darwin/SHA256SUMS.part\r\n0905dd8909b376362194124fb480357e3f6199d25c4e1ef7918ca0d3fc44ca58  guix-build-d5eae5f7300b/output/arm64-apple-darwin/bitcoin-d5eae5f7300b-arm64-apple-darwin-unsigned.dmg\r\nb2d14aac1faa48cfb4fd42f3ee675076ec3914678fa66d9c41bd2ab0015dd1e9  guix-build-d5eae5f7300b/output/arm64-apple-darwin/bitcoin-d5eae5f7300b-arm64-apple-darwin-unsigned.tar.gz\r\n7aadbe53d2f402d14a776fbca65903af2858bc6d293ccc4bae3a67e30ccc1d87  guix-build-d5eae5f7300b/output/arm64-apple-darwin/bitcoin-d5eae5f7300b-arm64-apple-darwin.tar.gz\r\n78da04fa957b0038fde70df0ff6540c53778c83f903269aa9cb8e80fbec802e5  guix-build-d5eae5f7300b/output/dist-archive/bitcoin-d5eae5f7300b.tar.gz\r\ncb453b2298e0f85cb85be0c5f740de8c643d65a68f858477f67bd66eec599f8c  guix-build-d5eae5f7300b/output/powerpc64-linux-gnu/SHA256SUMS.part\r\nbadbffcb2dbf786bfd3ac0d6c60fad8a65b7b3ecbbda46e6b309bbffc09187ef  guix-build-d5eae5f7300b/output/powerpc64-linux-gnu/bitcoin-d5eae5f7300b-powerpc64-linux-gnu-debug.tar.gz\r\n612ad1720cef9ae74cef4c651ea05237a1f3935474388253deb023893629a101  guix-build-d5eae5f7300b/output/powerpc64-linux-gnu/bitcoin-d5eae5f7300b-powerpc64-linux-gnu.tar.gz\r\n1677f944555aa029df9825bb4036a02815cf3e5440f11752c5eb8c546ecd44bd  guix-build-d5eae5f7300b/output/powerpc64le-linux-gnu/SHA256SUMS.part\r\ne81625a5777335498ba992a7548675ce2aa9af673687889a2e00c626c09d7503  guix-build-d5eae5f7300b/output/powerpc64le-linux-gnu/bitcoin-d5eae5f7300b-powerpc64le-linux-gnu-debug.tar.gz\r\nc34f41b3093ffcf56bc438ffd9e49be2570377232e92068a95526e68242daf99  guix-build-d5eae5f7300b/output/powerpc64le-linux-gnu/bitcoin-d5eae5f7300b-powerpc64le-linux-gnu.tar.gz\r\nc16bbe48f9792d8eb26b7e4fcf01ff99e3827fe0c8fb491b81cae37b25173014  guix-build-d5eae5f7300b/output/riscv64-linux-gnu/SHA256SUMS.part\r\n022fcfe57861dea712cfeb27803011da48e9cd0dd15fe424a99ff2c7641b0648  guix-build-d5eae5f7300b/output/riscv64-linux-gnu/bitcoin-d5eae5f7300b-riscv64-linux-gnu-debug.tar.gz\r\n25b366534686f3dd2ac6c2f7e980f77e9076fe78df8d4258806e5d93890a1f7a  guix-build-d5eae5f7300b/output/riscv64-linux-gnu/bitcoin-d5eae5f7300b-riscv64-linux-gnu.tar.gz\r\nb51f43d939100c4465ae5df2202cddc95e160a68896aeafdf1800a56ab19e378  guix-build-d5eae5f7300b/output/x86_64-apple-darwin/SHA256SUMS.part\r\n543baabab34cb6c99ee38d47ef6ebd489553660f69ed28877bc9d2206c677b43  guix-build-d5eae5f7300b/output/x86_64-apple-darwin/bitcoin-d5eae5f7300b-x86_64-apple-darwin-unsigned.dmg\r\n58ac6365c9fb0f05fe29b3dccac1feb111bfaf725aa31438ad9f1dc4f6180ef1  guix-build-d5eae5f7300b/output/x86_64-apple-darwin/bitcoin-d5eae5f7300b-x86_64-apple-darwin-unsigned.tar.gz\r\n3f49ce55c22923855f027177a4eeff0d145af819e97352a54171804f686d14db  guix-build-d5eae5f7300b/output/x86_64-apple-darwin/bitcoin-d5eae5f7300b-x86_64-apple-darwin.tar.gz\r\n46cf6d86e635b1cb8fd5a042c78b7cddb6ccec10093259a3f07ab2e96f51c59b  guix-build-d5eae5f7300b/output/x86_64-linux-gnu/SHA256SUMS.part\r\n67345ebcb7a61d399fda0e4198f243bbf55676f7e747584907c6608ae9902c93  guix-build-d5eae5f7300b/output/x86_64-linux-gnu/bitcoin-d5eae5f7300b-x86_64-linux-gnu-debug.tar.gz\r\n70a74dfaf2ecdef720b45f83ef496b2ad7a3f0b7fee9b8b43cfae8964f866966  guix-build-d5eae5f7300b/output/x86_64-linux-gnu/bitcoin-d5eae5f7300b-x86_64-linux-gnu.tar.gz\r\na2bd4ee7bda52f285eb8c85cf5504e0ddca310f2972ef51132d2f2ee4b21021f  guix-build-d5eae5f7300b/output/x86_64-w64-mingw32/SHA256SUMS.part\r\nf697bdc720e10eb8fd76c5dba5e9abe12ce5b034e386ac556aa30b76b969517f  guix-build-d5eae5f7300b/output/x86_64-w64-mingw32/bitcoin-d5eae5f7300b-win64-debug.zip\r\n434a94570fac61303c34a998712c5022f4dbb08619cda3c55b9dd4a96e907116  guix-build-d5eae5f7300b/output/x86_64-w64-mingw32/bitcoin-d5eae5f7300b-win64-setup-unsigned.exe\r\n104cb87a014b59e044165a959f56ce0c35e99f3ffea05ff17cbfd095434ae503  guix-build-d5eae5f7300b/output/x86_64-w64-mingw32/bitcoin-d5eae5f7300b-win64-unsigned.tar.gz\r\n1f390d97fb1cd41f1b2df3bc3245e81f6b8b7f1eefd1e6cc96ca36c4e2c51693  guix-build-d5eae5f7300b/output/x86_64-w64-mingw32/bitcoin-d5eae5f7300b-win64.zip\r\n```",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25357/comments",
   "created_at" : "2022-06-13T12:32:21Z",
   "draft" : false,
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25357/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/25357",
   "id" : 1269369553,
   "labels" : [
      {
         "color" : "5319e7",
         "default" : false,
         "description" : null,
         "id" : 61889416,
         "name" : "Build system",
         "node_id" : "MDU6TGFiZWw2MTg4OTQxNg==",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Build%20system"
      },
      {
         "color" : "bfd4f2",
         "default" : false,
         "description" : "",
         "id" : 1947349437,
         "name" : "DrahtBot Guix build requested",
         "node_id" : "MDU6TGFiZWwxOTQ3MzQ5NDM3",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/DrahtBot%20Guix%20build%20requested"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25357/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "node_id" : "PR_kwDOABII5845jvq7",
   "number" : 25357,
   "performed_via_github_app" : null,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/25357.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25357",
      "merged_at" : null,
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/25357.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25357"
   },
   "reactions" : {
      "+1" : 0,
      "-1" : 0,
      "confused" : 0,
      "eyes" : 0,
      "heart" : 0,
      "hooray" : 0,
      "laugh" : 0,
      "rocket" : 0,
      "total_count" : 0,
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25357/reactions"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "state_reason" : null,
   "timeline_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25357/timeline",
   "title" : "guix: drop `-z,noexecstack` for PPC64",
   "updated_at" : "2022-06-13T14:27:30Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25357",
   "user" : {
      "avatar_url" : "https://avatars.githubusercontent.com/u/863730?v=4",
      "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
      "followers_url" : "https://api.github.com/users/fanquake/followers",
      "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/fanquake",
      "id" : 863730,
      "login" : "fanquake",
      "node_id" : "MDQ6VXNlcjg2MzczMA==",
      "organizations_url" : "https://api.github.com/users/fanquake/orgs",
      "received_events_url" : "https://api.github.com/users/fanquake/received_events",
      "repos_url" : "https://api.github.com/users/fanquake/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/fanquake"
   }
}
