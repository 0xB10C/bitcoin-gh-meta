[
   {
      "body" : "I like this idea!\r\nIt makes dependency on OpenSSL[for randomness] less widespread, and focused on a single place where it could easier be swapped out.\r\n",
      "created_at" : "2014-06-24T12:44:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-46965763",
      "id" : 46965763,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-24T12:44:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46965763",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Agreed. I'd like it even more if it were moved out of util and into a new file, so that util would drop that dependency.\r\n\r\nI should think that a simple RAII class for seeding and teardown would be pretty easy to whip up?",
      "created_at" : "2014-06-24T14:27:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-46977847",
      "id" : 46977847,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-24T14:27:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46977847",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "What do you mean with a RAII class for seeding and teardown? Isn't that global state, not local state?\r\n",
      "created_at" : "2014-06-24T14:38:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-46979294",
      "id" : 46979294,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-24T14:38:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/46979294",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj Yes openssl's rand stuff is global, but others may not be. And it doesn't hurt to scope, so that we know it's always seeded and valid. But don't worry about it here, we can discuss that later/elsewhere.\r\n\r\nMy request to have it moved to another file still stands, though.",
      "created_at" : "2014-06-24T17:54:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47005880",
      "id" : 47005880,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-24T17:54:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47005880",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "@theuni So to be concrete, to introduce a random.cpp + random.h? Agreed on that. All the Rand* functions could move there.",
      "created_at" : "2014-06-25T10:27:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47084308",
      "id" : 47084308,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-25T10:27:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47084308",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "How about putting that in crypto/?",
      "created_at" : "2014-06-25T10:52:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47086604",
      "id" : 47086604,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-25T10:52:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47086604",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "I thought about that, but didn't propose it, that would make crypto dependent on OpenSSL :p",
      "created_at" : "2014-06-25T11:02:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47087417",
      "id" : 47087417,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-25T11:02:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47087417",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj Yes, that's what I had in mind.\r\n\r\n-1 to moving to crypto. crypto stands alone with no dependencies, this doesn't seem like a good enough reason to change that.",
      "created_at" : "2014-06-25T16:45:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47127960",
      "id" : 47127960,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-25T16:45:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47127960",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "body" : "Agreed, I'll rework this and move RandXYZ() from util to a new random.",
      "created_at" : "2014-06-26T11:40:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47215544",
      "id" : 47215544,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-26T11:40:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47215544",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@laanwj @theuni I moved the rand functions from util to new random.h/.cpp, can you check?",
      "created_at" : "2014-06-26T12:46:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47220852",
      "id" : 47220852,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-26T12:47:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47220852",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14237980"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14237980"
         }
      },
      "body" : "This will be removed in the next rebase!",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-26T12:51:52Z",
      "diff_hunk" : "@@ -70,6 +71,7 @@\n #include <boost/program_options/detail/config_file.hpp>\n #include <boost/program_options/parsers.hpp>\n #include <openssl/crypto.h>\n+#include <openssl/err.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14237980",
      "id" : 14237980,
      "original_commit_id" : "62935b423687bb8ce57ad75089bbcf0040ace147",
      "original_position" : 12,
      "path" : "src/util.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14237980",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14238983"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14238983"
         }
      },
      "body" : "I'm going to remove the ``\"rand\"`` in the next rebase as this seems important to log!",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-26T13:14:18Z",
      "diff_hunk" : "@@ -0,0 +1,106 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"random.h\"\n+\n+#include \"util.h\" // for LogPrint()\n+\n+#include <cstring> // for memset()\n+\n+#include <openssl/crypto.h>\n+#include <openssl/err.h>\n+#include <openssl/rand.h>\n+\n+void RandAddSeed()\n+{\n+    // Seed with CPU performance counter\n+    int64_t nCounter = GetPerformanceCounter();\n+    RAND_add(&nCounter, sizeof(nCounter), 1.5);\n+    memset(&nCounter, 0, sizeof(nCounter));\n+}\n+\n+void RandAddSeedPerfmon()\n+{\n+    RandAddSeed();\n+\n+    // This can take up to 2 seconds, so only do it every 10 minutes\n+    static int64_t nLastPerfmon;\n+    if (GetTime() < nLastPerfmon + 10 * 60)\n+        return;\n+    nLastPerfmon = GetTime();\n+\n+#ifdef WIN32\n+    // Don't need this on Linux, OpenSSL automatically uses /dev/urandom\n+    // Seed with the entire set of perfmon data\n+    unsigned char pdata[250000];\n+    memset(pdata, 0, sizeof(pdata));\n+    unsigned long nSize = sizeof(pdata);\n+    long ret = RegQueryValueExA(HKEY_PERFORMANCE_DATA, \"Global\", NULL, NULL, pdata, &nSize);\n+    RegCloseKey(HKEY_PERFORMANCE_DATA);\n+    if (ret == ERROR_SUCCESS)\n+    {\n+        RAND_add(pdata, nSize, nSize/100.0);\n+        OPENSSL_cleanse(pdata, nSize);\n+        LogPrint(\"rand\", \"RandAddSeed() %lu bytes\\n\", nSize);\n+    }\n+#endif\n+}\n+\n+bool GetRandBytes(unsigned char *buf, int num)\n+{\n+    if (RAND_bytes(buf, num) == 0) {\n+        LogPrint(\"rand\", \"%s : OpenSSL RAND_bytes() failed with error: %s\\n\", __func__, ERR_error_string(ERR_get_error(), NULL));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14238983",
      "id" : 14238983,
      "original_commit_id" : "62935b423687bb8ce57ad75089bbcf0040ace147",
      "original_position" : 54,
      "path" : "src/random.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14238983",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14239066"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14239066"
         }
      },
      "body" : "Agreed!",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-26T13:16:26Z",
      "diff_hunk" : "@@ -0,0 +1,106 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"random.h\"\n+\n+#include \"util.h\" // for LogPrint()\n+\n+#include <cstring> // for memset()\n+\n+#include <openssl/crypto.h>\n+#include <openssl/err.h>\n+#include <openssl/rand.h>\n+\n+void RandAddSeed()\n+{\n+    // Seed with CPU performance counter\n+    int64_t nCounter = GetPerformanceCounter();\n+    RAND_add(&nCounter, sizeof(nCounter), 1.5);\n+    memset(&nCounter, 0, sizeof(nCounter));\n+}\n+\n+void RandAddSeedPerfmon()\n+{\n+    RandAddSeed();\n+\n+    // This can take up to 2 seconds, so only do it every 10 minutes\n+    static int64_t nLastPerfmon;\n+    if (GetTime() < nLastPerfmon + 10 * 60)\n+        return;\n+    nLastPerfmon = GetTime();\n+\n+#ifdef WIN32\n+    // Don't need this on Linux, OpenSSL automatically uses /dev/urandom\n+    // Seed with the entire set of perfmon data\n+    unsigned char pdata[250000];\n+    memset(pdata, 0, sizeof(pdata));\n+    unsigned long nSize = sizeof(pdata);\n+    long ret = RegQueryValueExA(HKEY_PERFORMANCE_DATA, \"Global\", NULL, NULL, pdata, &nSize);\n+    RegCloseKey(HKEY_PERFORMANCE_DATA);\n+    if (ret == ERROR_SUCCESS)\n+    {\n+        RAND_add(pdata, nSize, nSize/100.0);\n+        OPENSSL_cleanse(pdata, nSize);\n+        LogPrint(\"rand\", \"RandAddSeed() %lu bytes\\n\", nSize);\n+    }\n+#endif\n+}\n+\n+bool GetRandBytes(unsigned char *buf, int num)\n+{\n+    if (RAND_bytes(buf, num) == 0) {\n+        LogPrint(\"rand\", \"%s : OpenSSL RAND_bytes() failed with error: %s\\n\", __func__, ERR_error_string(ERR_get_error(), NULL));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14239066",
      "id" : 14239066,
      "original_commit_id" : "62935b423687bb8ce57ad75089bbcf0040ace147",
      "original_position" : 54,
      "path" : "src/random.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14239066",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Bonus points:  most of the uses involve vector<unsigned char>.  It would be nice to have a wrapper or two to provide type-safe interfaces, permitting\r\n```\r\n    vector<unsigned char> v;\r\n    GetRandBytes(v, 32);\r\nversus\r\n    vector<unsigned char> v;\r\n    GetRandBytes(&v[0], 32);\r\n```\r\n\r\nLess margin for error.\r\n\r\nSmarter types permit better safety checks.  If you pass in a vector, you may check .size() prior to storing a range of data.  Better checks -- particularly in a security sensitive area where buffer overflows may occur -- are always welcome.\r\n",
      "created_at" : "2014-06-26T13:53:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47227961",
      "id" : 47227961,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-26T13:53:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47227961",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "I agree that is useful to do in the future, But I think we should keep the scope of this pull down to the code movement and a trivial wrapper.",
      "created_at" : "2014-06-26T14:08:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47229775",
      "id" : 47229775,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-26T14:08:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47229775",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj Rebased after the recent change to ``RandAddSeedPerfmon()``, can you test?",
      "created_at" : "2014-06-27T07:15:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47314395",
      "id" : 47314395,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-27T07:15:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47314395",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Added required changes to ``canonical_tests.cpp``, which I forgot...",
      "created_at" : "2014-06-27T08:58:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47322040",
      "id" : 47322040,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-27T08:58:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47322040",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Fixed ``crypto_tests.cpp``.",
      "created_at" : "2014-06-27T09:11:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47323101",
      "id" : 47323101,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-27T09:11:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47323101",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14301204"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14301204"
         }
      },
      "body" : "This re-adds the dependency that we were breaking.",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-27T16:20:14Z",
      "diff_hunk" : "@@ -0,0 +1,121 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"random.h\"\n+\n+#include \"util.h\" // for LogPrint()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14301204",
      "id" : 14301204,
      "original_commit_id" : "111512108174ab2078a879f20648b120563f431b",
      "original_position" : 8,
      "path" : "src/random.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14301204",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14302807"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14302807"
         }
      },
      "body" : "What dependency? How do you mean?\r\nI don't think we can avoid an util.cpp-random.cpp cross-dependency unless we split up util.cpp further into a logging part and the part-that-uses-random...\r\n",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-27T16:55:38Z",
      "diff_hunk" : "@@ -0,0 +1,121 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"random.h\"\n+\n+#include \"util.h\" // for LogPrint()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14302807",
      "id" : 14302807,
      "original_commit_id" : "111512108174ab2078a879f20648b120563f431b",
      "original_position" : 8,
      "path" : "src/random.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14302807",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14303644"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14303644"
         }
      },
      "body" : "I don't see any reason for stand-alone helper functions to be using program state and internal functions. For example:\r\n```\r\nbool GetRandBytes(unsigned char *buf, int num)\r\n```\r\nshould become\r\n```\r\nbool GetRandBytes(unsigned char *buf, int num, std::string& error)\r\n```\r\nThen the caller decides how to handle it, in this case using LogPrintf() if the result is false;\r\n\r\nIgnore my complaint for now. I'll add it to the list of stuff I'd like to get to.",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-27T17:12:40Z",
      "diff_hunk" : "@@ -0,0 +1,121 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"random.h\"\n+\n+#include \"util.h\" // for LogPrint()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14303644",
      "id" : 14303644,
      "original_commit_id" : "111512108174ab2078a879f20648b120563f431b",
      "original_position" : 8,
      "path" : "src/random.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14303644",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/417043?v=3",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14312392"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14312392"
         }
      },
      "body" : "I don't like returning an error/warning string from a low-level utility\nfunction. That just moves the burden to every caller site. IMO the function\nshould be allowed to log if necessary.",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-27T20:01:41Z",
      "diff_hunk" : "@@ -0,0 +1,121 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"random.h\"\n+\n+#include \"util.h\" // for LogPrint()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14312392",
      "id" : 14312392,
      "original_commit_id" : "111512108174ab2078a879f20648b120563f431b",
      "original_position" : 8,
      "path" : "src/random.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14312392",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14315534"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14315534"
         }
      },
      "body" : "I also think it complicates things, if we just return an error an let the caller decide what to do. The dependency we broke is that we don't need the OpenSSL rand.h in util.h (+ many others) and can replace OpenSSL rand.h in random.h by something better in the future. I also think logging is THAT basic, that every file should be able to do that. I have been thinking about a better place for the OpenSSL init, so that util.h doesn't need ANY of the OpenSSL headers (perhaps init.cpp/.h).\r\n\r\nAnyway, it would be nice if this could be tested, reviewed so I can continue with other things :).",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-27T21:11:53Z",
      "diff_hunk" : "@@ -0,0 +1,121 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"random.h\"\n+\n+#include \"util.h\" // for LogPrint()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14315534",
      "id" : 14315534,
      "original_commit_id" : "111512108174ab2078a879f20648b120563f431b",
      "original_position" : 8,
      "path" : "src/random.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14315534",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14322828"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14322828"
         }
      },
      "body" : "BTW; this function can be moved to the implementation file and made static. It's only used in random seeding.\r\nI think this means that the header doesn't need to include compat.h and time.h anymore.",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-28T06:17:27Z",
      "diff_hunk" : "@@ -0,0 +1,69 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_RANDOM_H\n+#define BITCOIN_RANDOM_H\n+\n+#ifdef WIN32\n+#include \"compat.h\" // for Windows API\n+#endif\n+#include \"uint256.h\"\n+\n+#include <stdint.h>\n+\n+#ifndef WIN32\n+#include <sys/time.h>\n+#endif\n+\n+inline int64_t GetPerformanceCounter()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14322828",
      "id" : 14322828,
      "original_commit_id" : "111512108174ab2078a879f20648b120563f431b",
      "original_position" : 20,
      "path" : "src/random.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14322828",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14336853"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14336853"
         }
      },
      "body" : "Guess you are right, will update later...",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-30T06:04:07Z",
      "diff_hunk" : "@@ -0,0 +1,69 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_RANDOM_H\n+#define BITCOIN_RANDOM_H\n+\n+#ifdef WIN32\n+#include \"compat.h\" // for Windows API\n+#endif\n+#include \"uint256.h\"\n+\n+#include <stdint.h>\n+\n+#ifndef WIN32\n+#include <sys/time.h>\n+#endif\n+\n+inline int64_t GetPerformanceCounter()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14336853",
      "id" : 14336853,
      "original_commit_id" : "111512108174ab2078a879f20648b120563f431b",
      "original_position" : 20,
      "path" : "src/random.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14336853",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14337037"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14337037"
         }
      },
      "body" : "Util.cpp no longer needs random.h after this, right?",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-30T06:15:19Z",
      "diff_hunk" : "@@ -6,6 +6,7 @@\n #include \"util.h\"\n \n #include \"chainparamsbase.h\"\n+#include \"random.h\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14337037",
      "id" : 14337037,
      "original_commit_id" : "111512108174ab2078a879f20648b120563f431b",
      "original_position" : 4,
      "path" : "src/util.cpp",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14337037",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14337090"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14337090"
         }
      },
      "body" : "The problem is the OpenSSL init code, which uses ``RandAddSeed()``.",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-30T06:17:39Z",
      "diff_hunk" : "@@ -6,6 +6,7 @@\n #include \"util.h\"\n \n #include \"chainparamsbase.h\"\n+#include \"random.h\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14337090",
      "id" : 14337090,
      "original_commit_id" : "111512108174ab2078a879f20648b120563f431b",
      "original_position" : 4,
      "path" : "src/util.cpp",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14337090",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@laanwj See third commit, ``GetPerformanceCounter()`` was moved.",
      "created_at" : "2014-06-30T06:29:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47498593",
      "id" : 47498593,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-30T06:29:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47498593",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14337826"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14337826"
         }
      },
      "body" : "Ah yes, we need to move the OpenSSL init code at some point, you already mentioned that sorry.",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-30T07:00:17Z",
      "diff_hunk" : "@@ -6,6 +6,7 @@\n #include \"util.h\"\n \n #include \"chainparamsbase.h\"\n+#include \"random.h\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14337826",
      "id" : 14337826,
      "original_commit_id" : "111512108174ab2078a879f20648b120563f431b",
      "original_position" : 4,
      "path" : "src/util.cpp",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14337826",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14337851"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14337851"
         }
      },
      "body" : "+1 on checking error return values here",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-30T07:01:24Z",
      "diff_hunk" : "@@ -363,13 +362,15 @@ bool CWallet::EncryptWallet(const SecureString& strWalletPassphrase)\n     RandAddSeedPerfmon();\n \n     vMasterKey.resize(WALLET_CRYPTO_KEY_SIZE);\n-    RAND_bytes(&vMasterKey[0], WALLET_CRYPTO_KEY_SIZE);\n+    if (!GetRandBytes(&vMasterKey[0], WALLET_CRYPTO_KEY_SIZE))\n+        return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14337851",
      "id" : 14337851,
      "original_commit_id" : "9a14a122b56b6ef1cd47d1c9e049b47afed2613b",
      "original_position" : 14,
      "path" : "src/wallet.cpp",
      "position" : 14,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14337851",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14337954"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14337954"
         }
      },
      "body" : "Bleh that we need this here at all (I know why, there's a GetRand call in EndMessage(), at some point we should move the non-trivial functions from net.h to net.cpp, but not in this pull)",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-30T07:06:29Z",
      "diff_hunk" : "@@ -13,6 +13,7 @@\n #include \"mruset.h\"\n #include \"netbase.h\"\n #include \"protocol.h\"\n+#include \"random.h\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14337954",
      "id" : 14337954,
      "original_commit_id" : "9a14a122b56b6ef1cd47d1c9e049b47afed2613b",
      "original_position" : 4,
      "path" : "src/net.h",
      "position" : 4,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14337954",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14338000"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14338000"
         }
      },
      "body" : "The function can also return `-1` if `they are not supported by the current RAND method` (see https://www.openssl.org/docs/crypto/RAND_bytes.html). So I'd prefer `!= 1` instead to explicitly check for succes instead of not failure.\r\n",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-30T07:09:07Z",
      "diff_hunk" : "@@ -0,0 +1,140 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"random.h\"\n+\n+#ifdef WIN32\n+#include \"compat.h\" // for Windows API\n+#endif\n+#include \"util.h\" // for LogPrint()\n+\n+#ifndef WIN32\n+#include <sys/time.h>\n+#endif\n+#include <cstring> // for memset()\n+\n+#include <openssl/crypto.h>\n+#include <openssl/err.h>\n+#include <openssl/rand.h>\n+\n+static inline int64_t GetPerformanceCounter()\n+{\n+    int64_t nCounter = 0;\n+#ifdef WIN32\n+    QueryPerformanceCounter((LARGE_INTEGER*)&nCounter);\n+#else\n+    timeval t;\n+    gettimeofday(&t, NULL);\n+    nCounter = (int64_t)(t.tv_sec * 1000000 + t.tv_usec);\n+#endif\n+    return nCounter;\n+}\n+\n+void RandAddSeed()\n+{\n+    // Seed with CPU performance counter\n+    int64_t nCounter = GetPerformanceCounter();\n+    RAND_add(&nCounter, sizeof(nCounter), 1.5);\n+    memset(&nCounter, 0, sizeof(nCounter));\n+}\n+\n+void RandAddSeedPerfmon()\n+{\n+    RandAddSeed();\n+\n+    // This can take up to 2 seconds, so only do it every 10 minutes\n+    static int64_t nLastPerfmon;\n+    if (GetTime() < nLastPerfmon + 10 * 60)\n+        return;\n+    nLastPerfmon = GetTime();\n+\n+#ifdef WIN32\n+    // Don't need this on Linux, OpenSSL automatically uses /dev/urandom\n+    // Seed with the entire set of perfmon data\n+    std::vector <unsigned char> vData(250000,0);\n+    long ret = 0;\n+    unsigned long nSize = 0;\n+    const size_t nMaxSize = 10000000; // Bail out at more than 10MB of performance data\n+    while (true)\n+    {\n+        nSize = vData.size();\n+        ret = RegQueryValueExA(HKEY_PERFORMANCE_DATA, \"Global\", NULL, NULL, begin_ptr(vData), &nSize);\n+        if (ret != ERROR_MORE_DATA || vData.size() >= nMaxSize)\n+            break;\n+        vData.resize(std::max((vData.size()*3)/2, nMaxSize)); // Grow size of buffer exponentially\n+    }\n+    RegCloseKey(HKEY_PERFORMANCE_DATA);\n+    if (ret == ERROR_SUCCESS)\n+    {\n+        RAND_add(begin_ptr(vData), nSize, nSize/100.0);\n+        OPENSSL_cleanse(begin_ptr(vData), nSize);\n+        LogPrint(\"rand\", \"%s: %lu bytes\\n\", __func__, nSize);\n+    } else {\n+        static bool warned = false; // Warn only once\n+        if (!warned)\n+        {\n+            LogPrintf(\"%s: Warning: RegQueryValueExA(HKEY_PERFORMANCE_DATA) failed with code %i\\n\", __func__, ret);\n+            warned = true;\n+        }\n+    }\n+#endif\n+}\n+\n+bool GetRandBytes(unsigned char *buf, int num)\n+{\n+    if (RAND_bytes(buf, num) == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14338000",
      "id" : 14338000,
      "original_commit_id" : "9a14a122b56b6ef1cd47d1c9e049b47afed2613b",
      "original_position" : 87,
      "path" : "src/random.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14338000",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14347572"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14347572"
         }
      },
      "body" : "Agreed, will update.\r\nEdit: Updated!",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-06-30T12:41:30Z",
      "diff_hunk" : "@@ -0,0 +1,140 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"random.h\"\n+\n+#ifdef WIN32\n+#include \"compat.h\" // for Windows API\n+#endif\n+#include \"util.h\" // for LogPrint()\n+\n+#ifndef WIN32\n+#include <sys/time.h>\n+#endif\n+#include <cstring> // for memset()\n+\n+#include <openssl/crypto.h>\n+#include <openssl/err.h>\n+#include <openssl/rand.h>\n+\n+static inline int64_t GetPerformanceCounter()\n+{\n+    int64_t nCounter = 0;\n+#ifdef WIN32\n+    QueryPerformanceCounter((LARGE_INTEGER*)&nCounter);\n+#else\n+    timeval t;\n+    gettimeofday(&t, NULL);\n+    nCounter = (int64_t)(t.tv_sec * 1000000 + t.tv_usec);\n+#endif\n+    return nCounter;\n+}\n+\n+void RandAddSeed()\n+{\n+    // Seed with CPU performance counter\n+    int64_t nCounter = GetPerformanceCounter();\n+    RAND_add(&nCounter, sizeof(nCounter), 1.5);\n+    memset(&nCounter, 0, sizeof(nCounter));\n+}\n+\n+void RandAddSeedPerfmon()\n+{\n+    RandAddSeed();\n+\n+    // This can take up to 2 seconds, so only do it every 10 minutes\n+    static int64_t nLastPerfmon;\n+    if (GetTime() < nLastPerfmon + 10 * 60)\n+        return;\n+    nLastPerfmon = GetTime();\n+\n+#ifdef WIN32\n+    // Don't need this on Linux, OpenSSL automatically uses /dev/urandom\n+    // Seed with the entire set of perfmon data\n+    std::vector <unsigned char> vData(250000,0);\n+    long ret = 0;\n+    unsigned long nSize = 0;\n+    const size_t nMaxSize = 10000000; // Bail out at more than 10MB of performance data\n+    while (true)\n+    {\n+        nSize = vData.size();\n+        ret = RegQueryValueExA(HKEY_PERFORMANCE_DATA, \"Global\", NULL, NULL, begin_ptr(vData), &nSize);\n+        if (ret != ERROR_MORE_DATA || vData.size() >= nMaxSize)\n+            break;\n+        vData.resize(std::max((vData.size()*3)/2, nMaxSize)); // Grow size of buffer exponentially\n+    }\n+    RegCloseKey(HKEY_PERFORMANCE_DATA);\n+    if (ret == ERROR_SUCCESS)\n+    {\n+        RAND_add(begin_ptr(vData), nSize, nSize/100.0);\n+        OPENSSL_cleanse(begin_ptr(vData), nSize);\n+        LogPrint(\"rand\", \"%s: %lu bytes\\n\", __func__, nSize);\n+    } else {\n+        static bool warned = false; // Warn only once\n+        if (!warned)\n+        {\n+            LogPrintf(\"%s: Warning: RegQueryValueExA(HKEY_PERFORMANCE_DATA) failed with code %i\\n\", __func__, ret);\n+            warned = true;\n+        }\n+    }\n+#endif\n+}\n+\n+bool GetRandBytes(unsigned char *buf, int num)\n+{\n+    if (RAND_bytes(buf, num) == 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14347572",
      "id" : 14347572,
      "original_commit_id" : "9a14a122b56b6ef1cd47d1c9e049b47afed2613b",
      "original_position" : 87,
      "path" : "src/random.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14347572",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "@laanwj I rebased, so that we have only 2 commits left. Last and only change was the check for ``-1`` from ``RAND_bytes()``. Also needed to add changes to skiplist_test.cpp.",
      "created_at" : "2014-06-30T12:45:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47526883",
      "id" : 47526883,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-06-30T12:52:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47526883",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14398649"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14398649"
         }
      },
      "body" : "We could use ``OPENSSL_cleanse()`` here and remove the cstring include I guess. Not sure if a secure erase is needed here, but we also do that when adding the performance data as entropy source.",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-07-01T11:22:17Z",
      "diff_hunk" : "@@ -0,0 +1,140 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"random.h\"\n+\n+#ifdef WIN32\n+#include \"compat.h\" // for Windows API\n+#endif\n+#include \"util.h\" // for LogPrint()\n+\n+#ifndef WIN32\n+#include <sys/time.h>\n+#endif\n+#include <cstring> // for memset()\n+\n+#include <openssl/crypto.h>\n+#include <openssl/err.h>\n+#include <openssl/rand.h>\n+\n+static inline int64_t GetPerformanceCounter()\n+{\n+    int64_t nCounter = 0;\n+#ifdef WIN32\n+    QueryPerformanceCounter((LARGE_INTEGER*)&nCounter);\n+#else\n+    timeval t;\n+    gettimeofday(&t, NULL);\n+    nCounter = (int64_t)(t.tv_sec * 1000000 + t.tv_usec);\n+#endif\n+    return nCounter;\n+}\n+\n+void RandAddSeed()\n+{\n+    // Seed with CPU performance counter\n+    int64_t nCounter = GetPerformanceCounter();\n+    RAND_add(&nCounter, sizeof(nCounter), 1.5);\n+    memset(&nCounter, 0, sizeof(nCounter));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14398649",
      "id" : 14398649,
      "original_commit_id" : "884d6e7a84c586a80c9c23094ab0ce0e61b84b65",
      "original_position" : 40,
      "path" : "src/random.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14398649",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14399305"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14399305"
         }
      },
      "body" : "That would be consistent, but no need to do it in this pull, let's leave code movements and functional changes separate.",
      "commit_id" : "4eedf4ffeea6a3734f245f785a8d82d69634dccd",
      "created_at" : "2014-07-01T11:43:45Z",
      "diff_hunk" : "@@ -0,0 +1,140 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2014 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"random.h\"\n+\n+#ifdef WIN32\n+#include \"compat.h\" // for Windows API\n+#endif\n+#include \"util.h\" // for LogPrint()\n+\n+#ifndef WIN32\n+#include <sys/time.h>\n+#endif\n+#include <cstring> // for memset()\n+\n+#include <openssl/crypto.h>\n+#include <openssl/err.h>\n+#include <openssl/rand.h>\n+\n+static inline int64_t GetPerformanceCounter()\n+{\n+    int64_t nCounter = 0;\n+#ifdef WIN32\n+    QueryPerformanceCounter((LARGE_INTEGER*)&nCounter);\n+#else\n+    timeval t;\n+    gettimeofday(&t, NULL);\n+    nCounter = (int64_t)(t.tv_sec * 1000000 + t.tv_usec);\n+#endif\n+    return nCounter;\n+}\n+\n+void RandAddSeed()\n+{\n+    // Seed with CPU performance counter\n+    int64_t nCounter = GetPerformanceCounter();\n+    RAND_add(&nCounter, sizeof(nCounter), 1.5);\n+    memset(&nCounter, 0, sizeof(nCounter));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#discussion_r14399305",
      "id" : 14399305,
      "original_commit_id" : "884d6e7a84c586a80c9c23094ab0ce0e61b84b65",
      "original_position" : 40,
      "path" : "src/random.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4400",
      "updated_at" : "2014-07-09T07:45:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14399305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "@laanwj Perhaps you can also help me find files, which could now also work without util.h.\r\n@sipa @gmaxwell @gavinandresen @jgarzik Can you also help testing and reviewing.",
      "created_at" : "2014-07-02T10:21:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-47759584",
      "id" : 47759584,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-07-02T10:21:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47759584",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "Any more testing done yet?",
      "created_at" : "2014-07-07T06:13:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-48144107",
      "id" : 48144107,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-07-07T06:13:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48144107",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1419649?v=3",
         "events_url" : "https://api.github.com/users/Diapolo/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Diapolo/followers",
         "following_url" : "https://api.github.com/users/Diapolo/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Diapolo/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Diapolo",
         "id" : 1419649,
         "login" : "Diapolo",
         "organizations_url" : "https://api.github.com/users/Diapolo/orgs",
         "received_events_url" : "https://api.github.com/users/Diapolo/received_events",
         "repos_url" : "https://api.github.com/users/Diapolo/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Diapolo/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Diapolo"
      }
   },
   {
      "body" : "This mostly needs code review. Testing is also great (I'm using these changes on my (walletless) nodes) but changes to randomness aren't very well testable.\r\nI'd feel better if at least one more person could take a thorough look at this.",
      "created_at" : "2014-07-07T08:27:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-48152308",
      "id" : 48152308,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-07-07T08:32:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48152308",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4400_4eedf4ffeea6a3734f245f785a8d82d69634dccd/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-07-09T08:29:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-48442880",
      "id" : 48442880,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-07-09T08:29:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48442880",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "Sorry for the late comments but:\r\n\r\n\" if (RAND_bytes(buf, num) == 0) \"\r\n\r\nMy manpage here says \"RAND_bytes() returns 1 on success, 0 otherwise. The error code can be obtained by ERR_get_error(3). RAND_pseudo_bytes() returns 1 if the bytes generated are\r\n       cryptographically strong, 0 otherwise. Both functions return -1 if they are not supported by the current RAND method.\"\r\n\r\nShouldn't we best testing != 1 ?  And perhaps we should be asserting on failure?\r\n",
      "created_at" : "2014-07-14T11:02:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-48887703",
      "id" : 48887703,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-07-14T11:02:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48887703",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "body" : "We already check against 1: `RAND_bytes(buf, num) != 1`\r\n(I had the same comment)\r\n\r\nNot sure about asserting on failure, returning failures to the caller is already a big leap from what we used to do: ignore failures.\r\n",
      "created_at" : "2014-07-14T11:07:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-48888027",
      "id" : 48888027,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-07-14T11:08:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48888027",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Sorry, I was reading the actual commits in order out of git and missed it in the pull. I can't think of any case we'd not like to fail, and a failure of the RNG can be a fatal total loss of security.",
      "created_at" : "2014-07-14T11:35:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4400#issuecomment-48889943",
      "id" : 48889943,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4400",
      "updated_at" : "2014-07-14T11:35:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48889943",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/858454?v=3",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   }
]
