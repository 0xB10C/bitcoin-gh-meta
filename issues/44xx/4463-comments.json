[
   {
      "body" : "There is already a balance check in SendMoney in https://github.com/bitcoin/bitcoin/blob/master/src/wallet.cpp#L1504\r\n\r\nSee also pull #4331, which also changes where and how balance checks are being done.\r\n\r\n",
      "created_at" : "2014-07-04T16:07:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4463#issuecomment-48058603",
      "id" : 48058603,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4463",
      "updated_at" : "2014-07-04T16:07:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48058603",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Thanks for the quick reply.  Nevertheless, I think that the checks are simply misplaced in SendMoneyToDestination, since they apply equally to SendMoney alone.  Whether or not they belong there is another question.  I think that the error message \"Insufficient funds\" is better suited than \"This transaction requires a fee of at least...\" for the case that \"nValue > GetBalance()\".  Also, the check for negative nValue makes sense in my opinion.  This case is not directly caught by the current check in SendMoney, although it presumably is in generic transaction checking code.\r\n\r\nIf you think that the checks are superfluous, then I can update the patch to just remove them instead of moving.",
      "created_at" : "2014-07-04T16:14:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4463#issuecomment-48058946",
      "id" : 48058946,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4463",
      "updated_at" : "2014-07-04T16:14:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48058946",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "Agreed that the check really belongs in SendMoney.\r\nBTW: this would make SendMoneyToDestination a trivial function, maybe we can get rid of it completely.\r\n\r\n**Edit**: Had the functions the wrong way around",
      "created_at" : "2014-07-05T14:22:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4463#issuecomment-48087561",
      "id" : 48087561,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4463",
      "updated_at" : "2014-07-05T14:28:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48087561",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Yes, I thought about that myself.  It seemed like a \"too invasive\" change for the initial proposal, but I'll gladly do it.  So far, SendMoney isn't actually used anywhere by itself, only SendToDestination.  The latter is used only from the \"sendtoaddress\" and \"sendfrom\" RPC commands in rpcwallet.cpp.\r\n\r\nSo if you don't want to keep SendMoney by itself just for the sake of it, the simplest solution would be to get rid of it entirely and move everything to SendMoneyToDestination.  Or, alternatively, we could \"inline\" the trivial logic (construction of the output script from the address) and use SendMoney directly at both places.\r\n\r\nWhat do you think?  I would personally go for the first way, i. e., remove SendMoney and only keep SendMoneyToDestination unless there's some belief that SendMoney may be needed again in the future.  This will clean up the code the most.  If you agree with either of the solutions, I'll update the patch.  Thanks for your input!",
      "created_at" : "2014-07-05T14:39:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4463#issuecomment-48087933",
      "id" : 48087933,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4463",
      "updated_at" : "2014-07-05T14:39:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48087933",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "Agreed. Let's combine the functions and rename SendMoneyToDestination to SendMoney.\r\n\r\nFor more advanced use-cases such as sending to a non-destination script it's easy enough to use `CreateTransaction`/`CommitTransaction` manually. This is, for example, what the GUI does because it can send to multiple recipients.\r\n\r\n",
      "created_at" : "2014-07-07T07:01:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4463#issuecomment-48146476",
      "id" : 48146476,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4463",
      "updated_at" : "2014-07-07T07:01:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48146476",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Done.  Did you imagine it like this?",
      "created_at" : "2014-07-07T07:42:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4463#issuecomment-48149006",
      "id" : 48149006,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4463",
      "updated_at" : "2014-07-07T07:42:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48149006",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4943644?v=3",
         "events_url" : "https://api.github.com/users/domob1812/events{/privacy}",
         "followers_url" : "https://api.github.com/users/domob1812/followers",
         "following_url" : "https://api.github.com/users/domob1812/following{/other_user}",
         "gists_url" : "https://api.github.com/users/domob1812/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/domob1812",
         "id" : 4943644,
         "login" : "domob1812",
         "organizations_url" : "https://api.github.com/users/domob1812/orgs",
         "received_events_url" : "https://api.github.com/users/domob1812/received_events",
         "repos_url" : "https://api.github.com/users/domob1812/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/domob1812/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/domob1812"
      }
   },
   {
      "body" : "Yes, ACK",
      "created_at" : "2014-07-07T07:44:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4463#issuecomment-48149142",
      "id" : 48149142,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4463",
      "updated_at" : "2014-07-07T07:44:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48149142",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4463_e832ab7754732af7fd46ad7f16eef973e238c357/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-07-07T08:20:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4463#issuecomment-48151811",
      "id" : 48151811,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4463",
      "updated_at" : "2014-07-07T08:20:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48151811",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   }
]
