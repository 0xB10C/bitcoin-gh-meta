[
   {
      "body" : "There's a tradeoff with applying the rate limit before full input validation.  It will save the cost of validation when the tx wouldn't have been relayed anyway due to the rate limit (which could affect all processing), but it allows saturation of the relay rate limit with unsigned spam (which only affects respend relays).",
      "created_at" : "2014-07-02T08:27:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-47749369",
      "id" : 47749369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-02T08:27:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47749369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
         "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dgenr8/followers",
         "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dgenr8",
         "id" : 4284124,
         "login" : "dgenr8",
         "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
         "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
         "repos_url" : "https://api.github.com/users/dgenr8/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dgenr8"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4450#discussion_r14463812"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4450"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14463812"
         }
      },
      "body" : "Are you sure this Does the Right Thing?\r\n\r\n\"default behavior of a signal that has a return type is to call all slots and then return a boost::optional containing the result returned by the last slot called.\"\r\n\r\nI'm not deeply familiar with the semantics of boost::optional, but even assuming assigning it to a bool does the right thing (I'm not 100% sure of that-- does assigning an optional&lt;bool&gt; to bool return true if the bool is true, or does it return true if the optional has any value whatsoever? ), it seems like a more sophisticated combiner would be appropriate (either \"if any callback says it is OK to relay, relay\" or \"if any callbacks says it is NOT OK to relay, do not relay.\")\r\n\r\n",
      "commit_id" : "0da6b3fd187da3aa810aaa584d8bd197ad4fa2b9",
      "created_at" : "2014-07-02T15:32:27Z",
      "diff_hunk" : "@@ -944,8 +945,9 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n         // Does tx conflict with a member of the pool, and is it not equivalent to that member?\n         if (pool.mapNextTx.count(outpoint) && !tx.IsEquivalentTo(*pool.mapNextTx[outpoint].ptx))\n         {\n-            g_signals.DetectedDoubleSpend(outpoint, tx, false);\n-            return false;\n+            relayableRespend = g_signals.DetectedDoubleSpend(outpoint, tx, false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#discussion_r14463812",
      "id" : 14463812,
      "original_commit_id" : "88dd3598d22197a22565e524cecdc08107cf76ac",
      "original_position" : 41,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4450",
      "updated_at" : "2014-07-02T16:29:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14463812",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/4450#discussion_r14465340"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4450"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14465340"
         }
      },
      "body" : "In fact it does not, and my earlier tests failed to catch it.  I'm going to turn this into a regular function call until we need multiple slots; hope that's alright.",
      "commit_id" : "0da6b3fd187da3aa810aaa584d8bd197ad4fa2b9",
      "created_at" : "2014-07-02T15:54:26Z",
      "diff_hunk" : "@@ -944,8 +945,9 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n         // Does tx conflict with a member of the pool, and is it not equivalent to that member?\n         if (pool.mapNextTx.count(outpoint) && !tx.IsEquivalentTo(*pool.mapNextTx[outpoint].ptx))\n         {\n-            g_signals.DetectedDoubleSpend(outpoint, tx, false);\n-            return false;\n+            relayableRespend = g_signals.DetectedDoubleSpend(outpoint, tx, false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#discussion_r14465340",
      "id" : 14465340,
      "original_commit_id" : "88dd3598d22197a22565e524cecdc08107cf76ac",
      "original_position" : 41,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/4450",
      "updated_at" : "2014-07-02T16:29:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/14465340",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
         "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dgenr8/followers",
         "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dgenr8",
         "id" : 4284124,
         "login" : "dgenr8",
         "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
         "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
         "repos_url" : "https://api.github.com/users/dgenr8/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dgenr8"
      }
   },
   {
      "body" : "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4450_0da6b3fd187da3aa810aaa584d8bd197ad4fa2b9/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-07-02T16:45:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-47802439",
      "id" : 47802439,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-02T16:45:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47802439",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "ACK.  Code reviewed, and compiled and run on OSX\r\n",
      "created_at" : "2014-07-03T18:52:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-47970232",
      "id" : 47970232,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-03T18:52:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47970232",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "RE: saturating the relay rate limit:  maybe I'm missing something, but I don't see how an attacker can do that because the bloom filter check is done first (and any outpoint hitting the bloom filter does not count against the relay limit).\r\n\r\nIf an attacker had a huge number of unspent outpoints they might be able to flood the filter. But they would pay for that attack in transaction fees for the first-spends of those outpoints.  If they had a huge number of very old, high-priority outpoints they could flood the filter for free, once-- that mythical attacker could flood the relay-free-transaction filter, too, but as far as I know nobody has done that. Or maybe they have, and nobody noticed because blocking free transactions for a while just isn't very exciting or profitable.",
      "created_at" : "2014-07-03T18:59:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-47971047",
      "id" : 47971047,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-03T18:59:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47971047",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "Because sigs have not been checked at rate limit check, he can also submit an invalid second spend for every unconfirmed tx he has seen.  Still limited though.",
      "created_at" : "2014-07-03T20:10:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-47979009",
      "id" : 47979009,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-03T20:10:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47979009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
         "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dgenr8/followers",
         "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dgenr8",
         "id" : 4284124,
         "login" : "dgenr8",
         "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
         "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
         "repos_url" : "https://api.github.com/users/dgenr8/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dgenr8"
      }
   },
   {
      "body" : "I tested the true and false cases for RelayableRespend.  Bloom filter is initialized and functions correctly.  Also I tested that first spend was relayed and added to wallet.  I did not test bloom filter clear.",
      "created_at" : "2014-07-03T20:16:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-47979626",
      "id" : 47979626,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-03T20:16:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/47979626",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
         "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dgenr8/followers",
         "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dgenr8",
         "id" : 4284124,
         "login" : "dgenr8",
         "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
         "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
         "repos_url" : "https://api.github.com/users/dgenr8/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dgenr8"
      }
   },
   {
      "body" : "ACK",
      "created_at" : "2014-07-04T03:50:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-48006835",
      "id" : 48006835,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-04T03:50:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48006835",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I think this it is a mistake to change the network invariant \"double-spends not relayed\" that has provided quite a lot of DoS protection since 2009. The current patch looks fine. But it could have unexpected interactions.\r\nI have not actually tested these vulns, but I think they are possible..\r\n\r\n1. For example, suppose an attacker has 4000 outputs that he controls. He creates 4000 txs Tx(i) (one for each prevout) with no fees and a size so they have very low priority for miners and then spread them slowly until every node has a copy. These Txs won't be included in blocks for a long long time (months?). Then it's possible to push double-spends over the network by sending three transactions A and B with 2000 inputs each for three sets of 2000 prevouts (from the original 4000 prevouts). If A and B are processed alternatively, A will reset the double-spend bloom filter for the ouputs in B with high probability. Then B will reset those for A, in a loop. With some provisions not to exceed the rate limiter, those 2000-input double spends will probably keep forever going around the network like ghosts until Tx(i) gets into a block (if it ever does), and then the attacker can launch another similar attack by using the remaining outputs.  \r\n\r\nSo attack cost: fixed initial cost of creating 4000 outputs (maybe around 400 USD), periodic cost of re-creating A and B when a Tx(i) was included in a block.\r\nAttack timespan: forever\r\nCost to the network: consume all available double-spend bandwidth.\r\n\r\nAlso there may be problems with orphan transactions\r\n2. A user can slowly load hundreds of orphan double-spend txs, and then release them all at once with a single parent tx, even if all double-spend the same output. This is done by creating multiple versions of A(i) with small changes and multiple versions of B(i) with small changes, but with a missing parent, and then sending the parent, which will trigger the flooding. \r\n\r\nWhy not improve the network on-top-of Bitcoin instead of changing this golden rule?\r\n \r\nSuppose we change the client so that, along each transaction, it sends an additional message for each input: SmallProof(i) = < Hash(tx), input(i)  > but where the signatures for OP_CHECKSIG are taken over the TX hash, instead of over the transaction and SmallProofs are only generated if only sizeof(scriptSig)<180 bytes.\r\nThen a lightweight double-spend alert system requires just to send the SmallProofs (220 bytes) and any server that wishes to detect 0-confirmation checks that the good SmallProofs exists and no other smallproof has been broadcast (if not, then the money is returned to the sender, or the sender must provide the smallproofs again). To prevent sending BTC from a client that does not support SmallProofs, we create a new kind of Bitcoin address that states \"Smallproofs required\" using another prefix.\r\n \r\nSo to summarize this proposal needs:\r\n1. One new kind of inventory item (SmallProof) (current INVs/getdata system could be used)\r\n2. A filter that prevents SmallProofs for being sent more than twice for each prevout.\r\n3. Add the small proofs to CWalletTx to preserve them.\r\n4. A change in CWallet::CreateTransaction() so that both the Tx and the Smallproofs are signed.\r\n5. A new address prefix (optional) so that old-clients cannot recognize these addresses. \r\n6. A way to inform the user if a Tx comes with SmallProofs and if is had double-spends attempts.\r\n\r\nIf done properly, none of these modifications should affect old nodes, and we'll have way to achieve 0-confirmations with much higher confidence. \r\n",
      "created_at" : "2014-07-15T04:24:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-48989180",
      "id" : 48989180,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T13:23:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/48989180",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "body" : "Clarification: Only smallproofs are generated if the payee requires them, so the network overhead will initially be 0%, and will grow slowly as more merchants adopt the new 0-confirmation system. If all transactions required 0-conf, then the network overhead would be aprox. 50%.\r\n\r\nAlso this system is more politically correct: why the whole network should pay with less security if a bunch of merchants wants to accept 0-confs? Let THEM pay the price of upgrading their systems to this new confirmation method, and let them pay the price to convince users to upgrade their nodes to send 0-confirmation payments. Also it's not clear at all that this patch makes better or worse 0-conf, because as we're broadcasting the double-spends, we're letting miners modify their source code to choose the double-spend if the fees are high enough. With pure rational miners, we're making double-spending more easy!\r\nIf you you like the proposal of SmapllProofs (or whatever other marketing name you want to name it), I will hire a programmer and create the patch. I'll do everything I can to prevent this double-spend patch from been merged.\r\n",
      "created_at" : "2014-07-15T12:04:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49022146",
      "id" : 49022146,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T12:04:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49022146",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "body" : "A core design decision of Bitcoin was to use fully-spendable outputs instead of partially-spendable accounts for the sole reason that using fully-spendable outputs prevents spamming. For every other possible metric, accounts would have been a better choice than outputs (every new alt 2.0 coin has changed this). But now we're tweaking this to let spam be forwarded again. So we end up with the worst of both designs. Let's honor S.N. and don't try to transform Bitcoin into something it is not. Let's build the double-spend alert system on top of Bitcoin, and not ruin a foundational rule that had a clear intention in the original design.",
      "created_at" : "2014-07-15T12:18:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49023323",
      "id" : 49023323,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T12:18:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49023323",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "body" : "@SergioDemianLerner Thank you very much for your attention and thoughts on this.  Regarding the attacks 1. and 2. that you posit:\r\n\r\n1.  Relaying A will not overcome the bloom filter, because only one output is added to the bloom filter.  That is true whether A respends one output or 2000.  Another respend transaction is required to get another output added, so this is the same attack that @petertodd posited.  A determined attacker can overrun some nodes' rate limiters, but I don't yet see the risk of a self-perpetuating attack.\r\n\r\n2. Maybe you have found a more fundamental problem with orphan handling: orphans respending another orphan should not be stored.  But anyway, when the parent comes along, how is the \"flood\" different from all those txes being transmitted without the orphan step?\r\n\r\nRegarding overall network design, the current situation is that respends split the network into realms believing one or the other was first.  The network as a whole already contains both.  Relaying when possible just makes the knowledge more homogeneous and actionable.\r\n\r\nI notice #4484 is not referenced here directly.  It has straightforward improvements to this.  Your review of it would be greatly appreciated.\r\n\r\n",
      "created_at" : "2014-07-15T14:04:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49035771",
      "id" : 49035771,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T14:04:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49035771",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
         "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dgenr8/followers",
         "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dgenr8",
         "id" : 4284124,
         "login" : "dgenr8",
         "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
         "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
         "repos_url" : "https://api.github.com/users/dgenr8/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dgenr8"
      }
   },
   {
      "body" : "It gives more information at the cost of decreasing the advantage the first transaction had over the second.\r\n\r\nIf we don't believe this advantage should exist, and it is just about more information about the network, and double spends are perfectly acceptable, there is a much simpler solution to this problem, namely replace-by-fee.\r\n\r\nIf we believe this advantage should exist (and fow now I do, even if it's just best effort), we shouldn't help the sender of the second one (the alleged attacker) relay his transactions.",
      "created_at" : "2014-07-15T14:19:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49038073",
      "id" : 49038073,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T14:23:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49038073",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "RE: not helping the second transaction get his transactions to miners:\r\n\r\nThis is the fundamental disagreement; I wonder if we can somehow measure how difficult it is for a would-be double-spend-attacker to get a transaction to miners.\r\n\r\nIf it is easy with the current rules, then I argue this change is definitely positive: it should make transaction recipients more aware that they are being attacked.\r\n\r\nIf it is difficult with the current rules, then I would agree this might be a net-negative.\r\n\r\nMy belief is that it would be easy for an attacker to find nodes that are \"near\" the big miners (Matt's mining backbone network would be a good place to start).\r\n",
      "created_at" : "2014-07-15T14:27:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49039162",
      "id" : 49039162,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T14:27:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49039162",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "@gavinandresen I look as the source code and I see that if every input is a first double-spend, then every input will be added to the bloom filter.\r\nMaybe the intention was do it as you say, but the code reads otherwise. The code should be:\r\n\r\nif (pool.mapNextTx.count(outpoint) && !tx.IsEquivalentTo(*pool.mapNextTx[outpoint].ptx))\r\n        {\r\n            relayableRespend = RelayableRespend(outpoint, tx, false, doubleSpendFilter);\r\n            if (!relayableRespend)\r\n                return false;\r\n            BREAK; // <-- \r\n        }\r\n\r\nNevertheless this may open other DoS possibilities, such as allowing sending a big Tx for each double-spent output from a single Tx. It must be analyzed..",
      "created_at" : "2014-07-15T15:17:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49047166",
      "id" : 49047166,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T15:17:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49047166",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "body" : "Let's recap the method used by merchants to accept 0-conf tx.(as far as I know)\r\n1. They monitor the network in several places.\r\n2. They wait 10 seconds\r\n3. They detect double-spends.\r\n\r\nSuppose all miners are fully rational but unscrupulous. This may actually be the average case today, please forgive me if you're a miner and you're not. Then the attacker can just wait 11 seconds and rely a double-spend with much higher fees. Miners will take the second, and not the first. So the whole 0-conf detection idea does not work anymore.\r\nThe key difference between SmallProofs of double-spend and double-spend Txs is that the former does not allow a random miner to include double-spend in a block, where the later does.\r\n",
      "created_at" : "2014-07-15T15:29:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49049090",
      "id" : 49049090,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T15:29:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49049090",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "body" : "@gavinandresen Regarding your 2nd point about orphans: The point is that a huge amount of traffic can be triggered by a 100 byte message. So if I connect to 1000 nodes, and send each one 1000 double-spend orphans (slowly), then In 1 second I can make 1M messages travel around the network. Who knows how the network will react to such state! It can loop....\r\nAn attacker can prevent people for making payments in a crucial time (such as when a bet is closing, or an auction is closing..)\r\n",
      "created_at" : "2014-07-15T15:35:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49049987",
      "id" : 49049987,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T15:35:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49049987",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "body" : "Please give me a single argument why double-spend SmallProof notifications are worse than double-spending TXs,  Forget for a moment about the code already written. There much more at stake.\r\n\r\nRegarding information: Smallproofs provide more information, because they actually allow users to measure how many transactions are accepted by 0-conf, which is very important to compute risk of block-rollback attacks.\r\n\r\nRegarding bandwidth: Smallproofs require a bit more but only if we're not under a massive DoS attack using double-spend Txs, which probably will be quite common. :)\r\n\r\nAlso the SmallProof system can one day be made part of each transaction by hard-forking and computing the signature hash as Hash( prevout(i) || Hash(Tx-as-is-now) ) , so there will be no bandwidth waste.\r\n\r\nRegarding propagation time: Smallproofs propagate much faster. If small enough, they can even be pushed without the need for an INV-getdata interaction.\r\n\r\nRegarding SPV: Some SPV may not want to receive double-spend transactions. BitcoinJ may want to, but other clients using block confirmations may not. A SPV node having 10 connection may receive a different double-spend Tx from each peer.\r\n\r\nRegarding security: Signing two messages with the same private key MIGHT be bad, if there the signatures are not deterministic and the entropy source is bad. But if entropy source is bad this would allow nodes to predict the private keys generated in the first place (as it happened).\r\n\r\nRegarding politics: Give merchants what they want when accepting 0-conf: reduced risk.  With double-spend tx we cannot go and tell them: \"we've reduced the risk, here is the proof. \". We can only tell them: \"we did something we believe it might reduce the 0-conf risk, but it may actually do the opposite, we don't know, we are just playing with your money. \"\r\n",
      "created_at" : "2014-07-15T15:57:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49053279",
      "id" : 49053279,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T15:57:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49053279",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "body" : "Thank you for pointing me to #4484. This solves the first attack I proposed.\r\n\r\n",
      "created_at" : "2014-07-15T16:02:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49054085",
      "id" : 49054085,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T16:02:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49054085",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "body" : "@SergioDemianLerner Just to clarify, by \"smallproofs\" you mean my proposal of relaying the scriptSig right? Do remember that proposal requires wallets to apply special-case behavior when sending an instant-confirmation payment; it doesn't work with wallets as-is.\r\n\r\nAlso \"computing the signature hash as Hash( prevout(i) || Hash(Tx-as-is-now))\" isn't a hard-fork if done sanely. (sane changes are almost never hard-forks)",
      "created_at" : "2014-07-15T16:20:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49056585",
      "id" : 49056585,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T16:20:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49056585",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "IMHO patch #4484 is buggy. The is an old rule about bugs that states that where a bug is found, there is probably another. With this code we're probably over the fourth.. how many more we'll find?\r\nAlso I remember a brief talk with Linus Torvals I had 20 years ago, when I was developing kernel drivers for Linux and he told me the KISS principle. Don't you see this patch breaks the KISS principle?",
      "created_at" : "2014-07-15T16:22:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49056817",
      "id" : 49056817,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T16:23:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49056817",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "body" : "@SergioDemianLerner : I think you meant to tag @dgenr8  RE: a possible orphan flood attack.\r\n\r\nI've been thinking for about a year or so that storing orphan transactions is a bad idea; we could simplify the code if we got rid of mapOrphans and related, and just rely on transaction senders/receivers to rebroadcast transactions that they want mined.  KISS",
      "created_at" : "2014-07-15T16:23:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49056895",
      "id" : 49056895,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T16:23:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49056895",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/331997?v=3",
         "events_url" : "https://api.github.com/users/gavinandresen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gavinandresen/followers",
         "following_url" : "https://api.github.com/users/gavinandresen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gavinandresen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gavinandresen",
         "id" : 331997,
         "login" : "gavinandresen",
         "organizations_url" : "https://api.github.com/users/gavinandresen/orgs",
         "received_events_url" : "https://api.github.com/users/gavinandresen/received_events",
         "repos_url" : "https://api.github.com/users/gavinandresen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gavinandresen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gavinandresen"
      }
   },
   {
      "body" : "@petertodd I don't have your proposal at hand, can you send me the link? It seems that we're talking about the same. It requires the wallets to do something special, namely sign a small message along the transaction, and broadcast this message, before or after the transaction.",
      "created_at" : "2014-07-15T16:28:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49057514",
      "id" : 49057514,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T16:28:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49057514",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "body" : "@gavinandresen Re-broadcasting transactions frequently fails when all your peers have a tx but for whatever reason miners don't; need replace-by-fee or similar in that case to ensure everyone re-propagates your tx. For instance https://github.com/bitcoin/bitcoin/pull/2340 needs to be neutered right now because we don't rebroadcast orphans when we get the block.\r\n",
      "created_at" : "2014-07-15T16:28:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49057551",
      "id" : 49057551,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T16:28:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49057551",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "@SergioDemianLerner We're talking about different things I think; my scheme doesn't require signing messages of any kind. My proposal was written up here: https://github.com/bitcoin/bitcoin/pull/3883#issuecomment-45543370",
      "created_at" : "2014-07-15T16:32:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49058156",
      "id" : 49058156,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T16:32:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49058156",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "@gavinandresen +1\r\n\r\n@petertodd The mempool janitor PR (#3753) and related issues (#3722, #3723) also handle that, to a certain extent.\r\n",
      "created_at" : "2014-07-15T17:33:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49065970",
      "id" : 49065970,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T17:33:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49065970",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "@petertodd Your method works by preventing the use of a private key twice. I like it. But it has problems if the user has a single Bitcoin address to receive payments.\r\n\r\nMy method does not require a hard fork and can be implemented in different ways. Here is one:\r\n\r\nFirst the wallet signs two messages with each private key: the tx and a smallproof msg.\r\nWe make 0-conf outputs require anything that today is non-standard, such as pushing dummy 1 value before the signature script.\r\n\r\nscriptpub: OP_DROP OP_DUP OP_HASH160 < pubKeyHash > OP_EQUALVERIFY OP_CHECKSIG\r\nscriptsig: < sig > < pubKey > < dummy-val >\r\n\r\nSo these transaction will not be normally relayed.\r\nNow we add the rule add these transactions ARE relied if the the smallproof message has been previously received.\r\nSo the smallproof message \"pays\" for the transmission of the non-standard tx.\r\nIf an attacker wants to send two double-spending txs, he won't be able to \"pay\" for the transmission of both without creating to colliding smallproofs that will be detected by the merchant.\r\n",
      "created_at" : "2014-07-15T17:47:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49067681",
      "id" : 49067681,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T17:53:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49067681",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "body" : "I think the smallproof idea deserves a more formal presentation because this is not the appropriate place to do it, so I will describe it in more detail in the mailing-list.\r\n",
      "created_at" : "2014-07-15T17:56:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49068847",
      "id" : 49068847,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T17:56:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49068847",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1752347?v=3",
         "events_url" : "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
         "followers_url" : "https://api.github.com/users/SergioDemianLerner/followers",
         "following_url" : "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
         "gists_url" : "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/SergioDemianLerner",
         "id" : 1752347,
         "login" : "SergioDemianLerner",
         "organizations_url" : "https://api.github.com/users/SergioDemianLerner/orgs",
         "received_events_url" : "https://api.github.com/users/SergioDemianLerner/received_events",
         "repos_url" : "https://api.github.com/users/SergioDemianLerner/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/SergioDemianLerner/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/SergioDemianLerner"
      }
   },
   {
      "body" : "@SergioDemianLerner Your method requires a soft-fork to be secure. I could easily make a Bitcoin Core fork that treats those outputs as standard without the smallproof message; Eligius among others would happily accept them. My scriptSig relaying mechanism OTOH works regardless of what policy miners follow, and with scorched-earth, gives them incentives to \"defect\" and broadcast double-spend proofs to collect even higher fees.",
      "created_at" : "2014-07-15T17:56:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49068925",
      "id" : 49068925,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T17:56:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49068925",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "This change has about the smallest footprint possible for what it achieves.  KISS.\r\n\r\nThe problem with an as-yet unimplemented Better Solution is that it is not implemented, or even really designed.  If it is implemented, it will be subject to the same level scrutiny, and it sounds like it has a MUCH larger footprint than this one.  There will be more bugs, not less.  There will be more risks.\r\n\r\nI hope no one is giving too much weight to grave accusations being made which turn out to be based on fundamentally flawed assumptions and flawed reading of the actual commits.\r\n\r\nThis is a small change with outsized positive effects for the network.\r\n",
      "created_at" : "2014-07-15T18:46:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49075375",
      "id" : 49075375,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T19:35:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49075375",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
         "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dgenr8/followers",
         "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dgenr8",
         "id" : 4284124,
         "login" : "dgenr8",
         "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
         "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
         "repos_url" : "https://api.github.com/users/dgenr8/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dgenr8"
      }
   },
   {
      "body" : "These special alert ideas require the cooperation of the creating wallet?  tx relay is so much better than that!\r\n\r\nHighlighting another advantage that we discovered as we vetted and completed this change -- it works seamlessly with no additional code when a miner decides to spring a double-spend on the world in a block.  Let's not be too steeped in technology to remember that we are really trying to influence a REAL WORLD event of handing-over-the-goods.  Failure does not occur when the double-spend is confirmed.  It occurs when the goods are handed over and the original spend is never eventually confirmed.  Failure can be prevented by notification.\r\n",
      "created_at" : "2014-07-15T19:30:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49080939",
      "id" : 49080939,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T19:30:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49080939",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
         "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dgenr8/followers",
         "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dgenr8",
         "id" : 4284124,
         "login" : "dgenr8",
         "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
         "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
         "repos_url" : "https://api.github.com/users/dgenr8/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dgenr8"
      }
   },
   {
      "body" : "@dgenr8 If it works. Proof-of-stake is much better than proof-of-work, aside from that small problem that it doesn't work...\r\n\r\nAnyway, modulo the known bugs, I don't see how tx relay is actively harmful given the throttling.",
      "created_at" : "2014-07-15T19:54:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49083787",
      "id" : 49083787,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T19:54:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49083787",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "@sipa I agree that we should preserve what 0-conf reliability there is.  Relaying does no harm when nodes, including miners, behave in a core-like way.\r\n\r\nTrying to keep respends away from non-core-like nodes is a lost cause -- those miners take direct submissions.  This should not prevent an effort to alert tx1 recipient, and others watching double-spends.\r\n",
      "created_at" : "2014-07-15T23:20:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4450#issuecomment-49105749",
      "id" : 49105749,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4450",
      "updated_at" : "2014-07-15T23:20:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/49105749",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4284124?v=3",
         "events_url" : "https://api.github.com/users/dgenr8/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dgenr8/followers",
         "following_url" : "https://api.github.com/users/dgenr8/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dgenr8/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dgenr8",
         "id" : 4284124,
         "login" : "dgenr8",
         "organizations_url" : "https://api.github.com/users/dgenr8/orgs",
         "received_events_url" : "https://api.github.com/users/dgenr8/received_events",
         "repos_url" : "https://api.github.com/users/dgenr8/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dgenr8/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dgenr8/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dgenr8"
      }
   }
]
