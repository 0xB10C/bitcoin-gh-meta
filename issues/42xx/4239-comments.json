[
   {
      "body" : "This change is not correct.\r\nVC is correct that the vector subscript is out of range, but in this case that is what we want, because we're trying to serialize the entire array.\r\n",
      "created_at" : "2014-05-28T07:41:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4239#issuecomment-44374685",
      "id" : 44374685,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4239",
      "updated_at" : "2014-05-28T08:14:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44374685",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Automatic sanity-testing: FAILED BUILD/TEST, see http://jenkins.bluematt.me/pull-tester/34cb1fc5d6c7293b5c135b85c3dd3668e05ac2b8 for binaries and test log.\n\nThis could happen for one of several reasons:\n1. It chanages paths in makefile.linux-mingw or otherwise changes build scripts in a way that made them incompatible with the automated testing scripts (please tweak those patches in qa/pull-tester)\n2. It adds/modifies tests which test network rules (thanks for doing that), which conflicts with a patch applied at test time\n3. It does not build on either Linux i386 or Win32 (via MinGW cross compile)\n4. The test suite fails on either Linux i386 or Win32\n5. The block test-cases failed (lookup the first bNN identifier which failed in https://github.com/TheBlueMatt/test-scripts/blob/master/FullBlockTestGenerator.java)\n\nIf you believe this to be in error, please ping BlueMatt on freenode or TheBlueMatt here.\n\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.",
      "created_at" : "2014-05-28T07:57:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4239#issuecomment-44375878",
      "id" : 44375878,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4239",
      "updated_at" : "2014-05-28T07:57:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44375878",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2110907?v=3",
         "events_url" : "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
         "followers_url" : "https://api.github.com/users/BitcoinPullTester/followers",
         "following_url" : "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
         "gists_url" : "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/BitcoinPullTester",
         "id" : 2110907,
         "login" : "BitcoinPullTester",
         "organizations_url" : "https://api.github.com/users/BitcoinPullTester/orgs",
         "received_events_url" : "https://api.github.com/users/BitcoinPullTester/received_events",
         "repos_url" : "https://api.github.com/users/BitcoinPullTester/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/BitcoinPullTester/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/BitcoinPullTester"
      }
   },
   {
      "body" : "Shouldn't the correct fix be to still use &compr[compr.size()-1] while change CFlatData to use inclusive upper bound?\r\n\r\nBy definition compr[compr.size()] is a out of bound read even though it may not cause noticeable errors in certain implementations.",
      "created_at" : "2014-05-28T09:35:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4239#issuecomment-44384055",
      "id" : 44384055,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4239",
      "updated_at" : "2014-05-28T09:35:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44384055",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7006155?v=3",
         "events_url" : "https://api.github.com/users/haowang1013/events{/privacy}",
         "followers_url" : "https://api.github.com/users/haowang1013/followers",
         "following_url" : "https://api.github.com/users/haowang1013/following{/other_user}",
         "gists_url" : "https://api.github.com/users/haowang1013/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/haowang1013",
         "id" : 7006155,
         "login" : "haowang1013",
         "organizations_url" : "https://api.github.com/users/haowang1013/orgs",
         "received_events_url" : "https://api.github.com/users/haowang1013/received_events",
         "repos_url" : "https://api.github.com/users/haowang1013/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/haowang1013/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/haowang1013/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/haowang1013"
      }
   },
   {
      "body" : "Inclusive upper bound is incredibly rare in computer science. Would be extremely confusing. It could be considered to pass a pointer and a size though.\r\n\r\nNote that *taking the address of* compr[compr.size()] is not an out-of-bounds access in itself. The memory is never accessed.\r\n",
      "created_at" : "2014-05-28T09:49:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4239#issuecomment-44385318",
      "id" : 44385318,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4239",
      "updated_at" : "2014-05-28T09:49:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44385318",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Would using compr.end() work? It returns an iterator pointing to the same address as &compr[compr.size()].",
      "created_at" : "2014-05-28T09:52:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4239#issuecomment-44385536",
      "id" : 44385536,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4239",
      "updated_at" : "2014-05-28T09:53:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44385536",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Good point, I think compr.end() works the best in terms of satisfying the runtime as well as increasing readability.\r\n\r\nI personally don't have preference between inclusive and exclusive upper bounds, none of them is more confusing than the other :)",
      "created_at" : "2014-05-28T10:02:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4239#issuecomment-44386372",
      "id" : 44386372,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4239",
      "updated_at" : "2014-05-28T10:02:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44386372",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7006155?v=3",
         "events_url" : "https://api.github.com/users/haowang1013/events{/privacy}",
         "followers_url" : "https://api.github.com/users/haowang1013/followers",
         "following_url" : "https://api.github.com/users/haowang1013/following{/other_user}",
         "gists_url" : "https://api.github.com/users/haowang1013/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/haowang1013",
         "id" : 7006155,
         "login" : "haowang1013",
         "organizations_url" : "https://api.github.com/users/haowang1013/orgs",
         "received_events_url" : "https://api.github.com/users/haowang1013/received_events",
         "repos_url" : "https://api.github.com/users/haowang1013/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/haowang1013/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/haowang1013/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/haowang1013"
      }
   },
   {
      "body" : "The foremost problem with inclusive upper bounds is that they also require a record/type size. An exclusive upper bound is unambiguously the top of the address range encompassing the objects.",
      "created_at" : "2014-05-28T10:26:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4239#issuecomment-44388298",
      "id" : 44388298,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4239",
      "updated_at" : "2014-05-28T10:27:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44388298",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Using .end() makes sense here. But you'd still need something like `&(*compr.begin())` and `&(*compr.end())` to go from a vector random access iterator to a pointer. That may trigger yet another warning or may even fail in some cases if extra debug checking is compiled in.\r\n\r\nSeemingly, getting the beginning and end pointer of a vector is not trivial to do in a way that is guaranteed to be portable and guaranteed to be working for empty vectors.\r\n\r\nSee also http://stackoverflow.com/a/1339767/216357 which introduces `begin_ptr` and `end_ptr` functions.\r\n",
      "created_at" : "2014-05-29T07:03:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4239#issuecomment-44500568",
      "id" : 44500568,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4239",
      "updated_at" : "2014-05-29T10:42:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44500568",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "ok, i will try!",
      "created_at" : "2014-05-29T10:12:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4239#issuecomment-44517699",
      "id" : 44517699,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4239",
      "updated_at" : "2014-05-29T10:12:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44517699",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7669610?v=3",
         "events_url" : "https://api.github.com/users/LongShao007/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LongShao007/followers",
         "following_url" : "https://api.github.com/users/LongShao007/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LongShao007/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LongShao007",
         "id" : 7669610,
         "login" : "LongShao007",
         "organizations_url" : "https://api.github.com/users/LongShao007/orgs",
         "received_events_url" : "https://api.github.com/users/LongShao007/received_events",
         "repos_url" : "https://api.github.com/users/LongShao007/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LongShao007/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LongShao007/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LongShao007"
      }
   },
   {
      "body" : "Why not use pointer arithmetic?  This would prevent all warning messages, produce the same results as it currently is, and look purposeful (since it is).\r\n\r\n    s << CFlatData(&compr[0], (&compr[0]) + compr.size());",
      "created_at" : "2014-05-30T02:45:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4239#issuecomment-44609588",
      "id" : 44609588,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4239",
      "updated_at" : "2014-05-30T02:45:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44609588",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1155895?v=3",
         "events_url" : "https://api.github.com/users/brandondahler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brandondahler/followers",
         "following_url" : "https://api.github.com/users/brandondahler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brandondahler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brandondahler",
         "id" : 1155895,
         "login" : "brandondahler",
         "organizations_url" : "https://api.github.com/users/brandondahler/orgs",
         "received_events_url" : "https://api.github.com/users/brandondahler/received_events",
         "repos_url" : "https://api.github.com/users/brandondahler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brandondahler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brandondahler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brandondahler"
      }
   },
   {
      "body" : "@brandondahler Did you check the link I gave? `&compr[0]` won't work portably for empty vectors (you're *still* referencing out of bounds in that case). That's why I referred to the stackoverflow topic which defines the following, which I think makes sense:\r\n\r\n```c++\r\ntemplate <class T, class TAl>\r\ninline T* begin_ptr(std::vector<T,TAl>& v)\r\n{return  v.empty() ? NULL : &v[0];}\r\n\r\ntemplate <class T, class TAl>\r\ninline const T* begin_ptr(const std::vector<T,TAl>& v)\r\n{return  v.empty() ? NULL : &v[0];}\r\n\r\ntemplate <class T, class TAl>\r\ninline T* end_ptr(std::vector<T,TAl>& v)\r\n{return v.empty() ? NULL : (begin_ptr(v) + v.size());} \r\n\r\ntemplate <class T, class TAl>\r\ninline const T* end_ptr(const std::vector<T,TAl>& v)\r\n{return v.empty() ? NULL : (begin_ptr(v) + v.size());}\r\n```\r\n",
      "created_at" : "2014-05-30T06:36:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/4239#issuecomment-44619412",
      "id" : 44619412,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/4239",
      "updated_at" : "2014-05-30T06:36:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/44619412",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
