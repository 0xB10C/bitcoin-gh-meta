[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-12-19T18:59:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-748511940",
      "id" : 748511940,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20724",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODUxMTk0MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-19T18:59:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748511940",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Having run this patch on a node that does tor and accepts incoming connections for a couple of days, with debug logging disabled, my logs have:\r\n\r\n * 248x UpdateTip: new best=... \r\n * 160x New outbound peer connected: ... (block-relay)\r\n * 15x New outbound peer connected: ... (full-relay)\r\n * 7x Potential stale tip detected, will try using extra outbound peer (last tip update: 1805 seconds ago)\r\n\r\nwhich mostly seem pretty reasonable indicators of what's going on.\r\n\r\nBut they do also still have:\r\n\r\nvalidation debug info:\r\n\r\n * 11x ERROR: AcceptBlockHeader: Consensus::ContextualCheckBlockHeader: xxx, bad-diffbits, incorrect proof of work\r\n\r\nsocks/tor debug info (netbase.cpp):\r\n \r\n * 2x Socks5() connect to XXX.onion:8333 failed: host unreachable\r\n * 5x Socks5() connect to XXX.onion:8333 failed: connection refused\r\n\r\nblock file management info:\r\n \r\n * 61x Pre-allocating up to position 0xf00000 in rev02368.dat\r\n * 6x FlushStateToDisk: write coins cache to disk (264560 coins, 36800kB) completed (0.19s)\r\n * 3x Prune: UnlinkPrunedFiles deleted blk/rev (02353)\r\n * 2x Leaving block file xxx: CBlockFileInfo(xxx)\r\n \r\n For comparison: https://github.com/bitcoin/bitcoin/pull/19832#issuecomment-739733571",
      "created_at" : "2020-12-19T19:17:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-748513919",
      "id" : 748513919,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20724",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODUxMzkxOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-19T19:17:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748513919",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Very strong Concept ACK: this is a great signal-to-noise improvement!\r\n\r\n> Having run this patch on a node that does tor and accepts incoming connections for a couple of days, with debug logging disabled, my logs have:\r\n> \r\n> * 248x UpdateTip: new best=...\r\n> * 160x New outbound peer connected: ... (block-relay)\r\n> * 15x New outbound peer connected: ... (full-relay)\r\n> * 7x Potential stale tip detected, will try using extra outbound peer (last tip update: 1805 seconds ago)\r\n\r\nPerfect!",
      "created_at" : "2020-12-19T19:26:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-748514827",
      "id" : 748514827,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20724",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODUxNDgyNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-19T19:26:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748514827",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Yeah, I've resigned myself to always running nodes with net logging on now and grepping for things.",
      "created_at" : "2020-12-19T19:29:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-748515179",
      "id" : 748515179,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20724",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODUxNTE3OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-19T19:29:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748515179",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20864 (net: Move SocketSendData lock annotation to header by MarcoFalke)\n* #20726 (p2p: Add DISABLETX message for negotiating block-relay-only connections by sdaftuar)\n* #20646 (doc: refer to BIPs 339/155 in feature negotiation by jonatack)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-12-20T00:27:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-748544260",
      "id" : 748544260,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20724",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0ODU0NDI2MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-06T19:34:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748544260",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. I have a draft branch that makes `fDisconnect` private and adds a `CNode::Disconncect()`, which net processing has to call if it wants to disconnect a peer. That function takes a required  `message` argument which gets logged to the `NET` category. That'd fix all instances of net_processing not logging disconnections, and ensure that none are introduced in future.\r\n\r\nThe branch is here: https://github.com/jnewbery/bitcoin/commits/2020-12-log-disconnect. It doesn't necessarily need to go in at the same time as this, but it might make sense to try to fix this definitively.",
      "created_at" : "2020-12-29T16:02:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-752136426",
      "id" : 752136426,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20724",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MjEzNjQyNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-29T16:02:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/752136426",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-12-30T14:33:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-752641953",
      "id" : 752641953,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20724",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MjY0MTk1Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-30T14:33:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/752641953",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Removed dep on #20646 since it's no longer changing late sendaddrv2 from a disconnect, and marked as ready for review.",
      "created_at" : "2021-01-06T07:46:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-755141551",
      "id" : 755141551,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20724",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTE0MTU1MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-06T07:46:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755141551",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@jnewbery Didn't like the change to always evaluating the args to the LogPrint format that comes with a `CNode::Disconnect(args...)` method, or any of the ideas I had to prevent it, so have left it as is for this PR.",
      "created_at" : "2021-01-06T07:48:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-755142550",
      "id" : 755142550,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20724",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTE0MjU1MA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-06T07:48:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755142550",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Didn't like the change to always evaluating the args to the LogPrint format that comes with a CNode::Disconnect(args...) method, or any of the ideas I had to prevent it, so have left it as is for this PR.\r\n\r\nGood point about always evaluating the LogPrint args. In practice, I don't think it matters very much here. These logs are infrequent, only happen once per connection, and none of them have expensive-to-evaluate log args, so the performance impact would be negligible. Still, if you wanted to do it with zero cost, we could implement some `NET_LOG_MESSAGE` macro that returns a null object if net logging is disabled and returns the formatted string if net logging is enabled.",
      "created_at" : "2021-01-06T10:50:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-755228905",
      "id" : 755228905,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20724",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTIyODkwNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-06T10:50:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755228905",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20724#discussion_r552507704"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20724"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552507704"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This should be in the next scope out, ie:\r\n\r\n```\r\nif (pfrom.GetCommonVersion() >= WTXID_RELAY_VERSION) {\r\n    ...\r\n} else {\r\n    LogPrint(BCLog::NET, \"ignoring wtxidrelay...\");\r\n}",
      "commit_id" : "e28d7405c11d407b4665a378ad17bc3e9b81c4f0",
      "created_at" : "2021-01-06T10:59:38Z",
      "diff_hunk" : "@@ -2560,6 +2563,8 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n             if (!State(pfrom.GetId())->m_wtxid_relay) {\n                 State(pfrom.GetId())->m_wtxid_relay = true;\n                 g_wtxid_relay_peers++;\n+            } else {\n+                LogPrint(BCLog::NET, \"ignoring wtxidrelay due to old common version=%d from peer=%d\\n\", pfrom.GetCommonVersion(), pfrom.GetId());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#discussion_r552507704",
      "id" : 552507704,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjUwNzcwNA==",
      "original_commit_id" : "2219a8d8960d7a09355b8571d6f2c1ae0bb9575d",
      "original_line" : 2567,
      "original_position" : 51,
      "original_start_line" : 2566,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 562572497,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20724",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-01-07T00:46:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552507704",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20724#discussion_r553046139"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20724"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553046139"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "@jnewbery\r\n\r\n(Attaching to an edit to make this a thread instead of top-level comments)\r\n\r\n> Good point about always evaluating the LogPrint args. In practice, I don't think it matters very much here.\r\n\r\nYeah, I kind-of agree, just didn't feel comfortable about it. I suspect:\r\n\r\n```c++\r\n    pnode->Disconnect(strprintf(\"socket send error: %s\", NetworkErrorString(nErr));\r\n```\r\n\r\nand\r\n\r\n```c++\r\nvoid CNode::Disconnect(std::string msg)\r\n{\r\n    LogPrint(BCLog::NET, \"%s; disconnecting peer=%d\\n\", msg, GetId());\r\n    fDisconnect = true;\r\n}\r\n```\r\n\r\nwould work pretty well.\r\n\r\nCould then retain the \"only evaluate args when needed\" part by adding a:\r\n\r\n```c++\r\n#define LOGSTRPRINTF(category, fmt, ...) \\\r\n     (LogAcceptCategory((category)) ? strprintf(fmt, __VA_ARGS__) : \"\")\r\n```\r\n\r\nto logging.h and making it be `pnode->Disconnect(LOGSTRPRINTF(BCLog::NET, \"socket send error: %s\", NetworkErrorString(nErr));` but, as you say, not sure that's actually worth the effort.\r\n\r\n(Could potentially have `Disconnect()` check `IsManualConn()` and always log disconnection of manual connections too -- though would need to do something cleverer to match this with the `LOGSTRPRINTF` idea...)",
      "commit_id" : "e28d7405c11d407b4665a378ad17bc3e9b81c4f0",
      "created_at" : "2021-01-07T00:44:54Z",
      "diff_hunk" : "@@ -825,7 +825,7 @@ size_t CConnman::SocketSendData(CNode *pnode) const EXCLUSIVE_LOCKS_REQUIRED(pno\n                 int nErr = WSAGetLastError();\n                 if (nErr != WSAEWOULDBLOCK && nErr != WSAEMSGSIZE && nErr != WSAEINTR && nErr != WSAEINPROGRESS)\n                 {\n-                    LogPrintf(\"socket send error %s\\n\", NetworkErrorString(nErr));\n+                    LogPrint(BCLog::NET, \"socket send error for peer=%d: %s\\n\", pnode->GetId(), NetworkErrorString(nErr));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#discussion_r553046139",
      "id" : 553046139,
      "line" : 828,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzA0NjEzOQ==",
      "original_commit_id" : "2219a8d8960d7a09355b8571d6f2c1ae0bb9575d",
      "original_line" : 828,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 5,
      "pull_request_review_id" : 563140264,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20724",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-07T00:46:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553046139",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20724#discussion_r553046585"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20724"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553046585"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "fixed",
      "commit_id" : "e28d7405c11d407b4665a378ad17bc3e9b81c4f0",
      "created_at" : "2021-01-07T00:46:22Z",
      "diff_hunk" : "@@ -2560,6 +2563,8 @@ void PeerManager::ProcessMessage(CNode& pfrom, const std::string& msg_type, CDat\n             if (!State(pfrom.GetId())->m_wtxid_relay) {\n                 State(pfrom.GetId())->m_wtxid_relay = true;\n                 g_wtxid_relay_peers++;\n+            } else {\n+                LogPrint(BCLog::NET, \"ignoring wtxidrelay due to old common version=%d from peer=%d\\n\", pfrom.GetCommonVersion(), pfrom.GetId());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#discussion_r553046585",
      "id" : 553046585,
      "in_reply_to_id" : 552507704,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzA0NjU4NQ==",
      "original_commit_id" : "2219a8d8960d7a09355b8571d6f2c1ae0bb9575d",
      "original_line" : 2567,
      "original_position" : 51,
      "original_start_line" : 2566,
      "path" : "src/net_processing.cpp",
      "position" : null,
      "pull_request_review_id" : 563140729,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20724",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : "RIGHT",
      "updated_at" : "2021-01-07T00:46:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553046585",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/127186?v=4",
         "events_url" : "https://api.github.com/users/ajtowns/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ajtowns/followers",
         "following_url" : "https://api.github.com/users/ajtowns/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ajtowns/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ajtowns",
         "id" : 127186,
         "login" : "ajtowns",
         "node_id" : "MDQ6VXNlcjEyNzE4Ng==",
         "organizations_url" : "https://api.github.com/users/ajtowns/orgs",
         "received_events_url" : "https://api.github.com/users/ajtowns/received_events",
         "repos_url" : "https://api.github.com/users/ajtowns/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ajtowns/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ajtowns"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20724#discussion_r553195531"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20724"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553195531"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I agree! Could be done in a follow up.",
      "commit_id" : "e28d7405c11d407b4665a378ad17bc3e9b81c4f0",
      "created_at" : "2021-01-07T09:07:21Z",
      "diff_hunk" : "@@ -825,7 +825,7 @@ size_t CConnman::SocketSendData(CNode *pnode) const EXCLUSIVE_LOCKS_REQUIRED(pno\n                 int nErr = WSAGetLastError();\n                 if (nErr != WSAEWOULDBLOCK && nErr != WSAEMSGSIZE && nErr != WSAEINTR && nErr != WSAEINPROGRESS)\n                 {\n-                    LogPrintf(\"socket send error %s\\n\", NetworkErrorString(nErr));\n+                    LogPrint(BCLog::NET, \"socket send error for peer=%d: %s\\n\", pnode->GetId(), NetworkErrorString(nErr));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#discussion_r553195531",
      "id" : 553195531,
      "in_reply_to_id" : 553046139,
      "line" : 828,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzE5NTUzMQ==",
      "original_commit_id" : "2219a8d8960d7a09355b8571d6f2c1ae0bb9575d",
      "original_line" : 828,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 5,
      "pull_request_review_id" : 563316308,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20724",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-07T09:07:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553195531",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK e28d7405c11d407b4665a378ad17bc3e9b81c4f0",
      "created_at" : "2021-01-07T09:15:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-755989482",
      "id" : 755989482,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20724",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1NTk4OTQ4Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-01-07T09:15:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755989482",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
