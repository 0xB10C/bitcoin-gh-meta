[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20749#discussion_r547447969"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20749"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/547447969"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I know I've asked the same question already, but I didn't get why this can't use `chainman.ActiveChainstate().Load...`.\r\n\r\nThis should simplify review because it will touch the same lines of code less often.\r\n\r\nAlso, it shouldn't make review harder, because everyone knows that there is only one chainman (whether it is called `g_chainman` or `chainman` shouldn't matter). On top you added a runtime assertion, which validates this for all executed code paths in our tests:\r\n\r\n```cpp\r\n     assert(std::addressof(::ChainstateActive()) == std::addressof(ActiveChainstate()));",
      "commit_id" : "e8dedbb064e90aaa8b2540c7524af54bbdd49d0a",
      "created_at" : "2020-12-22T18:53:33Z",
      "diff_hunk" : "@@ -699,7 +699,7 @@ static void ThreadImport(ChainstateManager& chainman, std::vector<fs::path> vImp\n             if (!file)\n                 break; // This error is logged in OpenBlockFile\n             LogPrintf(\"Reindexing block file blk%05u.dat...\\n\", (unsigned int)nFile);\n-            LoadExternalBlockFile(chainparams, file, &pos);\n+            ::ChainstateActive().LoadExternalBlockFile(chainparams, file, &pos);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20749#discussion_r547447969",
      "id" : 547447969,
      "line" : 702,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQ0Nzk2OQ==",
      "original_commit_id" : "e8dedbb064e90aaa8b2540c7524af54bbdd49d0a",
      "original_line" : 702,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 5,
      "pull_request_review_id" : 557295697,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20749",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-22T18:53:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/547447969",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20749#discussion_r547450444"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20749"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/547450444"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Anyway, no big deal if you want to keep it that way. Will review regardless.",
      "commit_id" : "e8dedbb064e90aaa8b2540c7524af54bbdd49d0a",
      "created_at" : "2020-12-22T18:58:50Z",
      "diff_hunk" : "@@ -699,7 +699,7 @@ static void ThreadImport(ChainstateManager& chainman, std::vector<fs::path> vImp\n             if (!file)\n                 break; // This error is logged in OpenBlockFile\n             LogPrintf(\"Reindexing block file blk%05u.dat...\\n\", (unsigned int)nFile);\n-            LoadExternalBlockFile(chainparams, file, &pos);\n+            ::ChainstateActive().LoadExternalBlockFile(chainparams, file, &pos);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20749#discussion_r547450444",
      "id" : 547450444,
      "in_reply_to_id" : 547447969,
      "line" : 702,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NzQ1MDQ0NA==",
      "original_commit_id" : "e8dedbb064e90aaa8b2540c7524af54bbdd49d0a",
      "original_line" : 702,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 5,
      "pull_request_review_id" : 557298663,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20749",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-12-22T18:58:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/547450444",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20331 (allow -loadblock blocks to be unsorted by LarryRuane)\n* #20017 (rpc: Add RPCContext by promag)\n* #19806 (validation: UTXO snapshot activation by jamesob)\n* #19594 (refactor: Make mapBlocksUnknownParent local, and rename it by hebasto)\n* #19521 (Coinstats Index (without UTXO set hash) by fjahr)\n* #19438 (Introduce deploymentstatus by ajtowns)\n* #16981 (Improve runtime performance of --reindex by LarryRuane)\n* #16333 (test: Set BIP34Height = 2 for regtest by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-12-22T20:41:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20749#issuecomment-749765464",
      "id" : 749765464,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20749",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc0OTc2NTQ2NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-22T20:41:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/749765464",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   }
]
