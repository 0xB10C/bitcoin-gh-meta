[
   {
      "author_association" : "MEMBER",
      "body" : "Mind adding steps to reproduce?",
      "created_at" : "2022-07-07T05:35:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25561#issuecomment-1177097804",
      "id" : 1177097804,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25561",
      "node_id" : "IC_kwDOABII585GKRZM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177097804/reactions"
      },
      "updated_at" : "2022-07-07T05:35:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177097804",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Mind adding steps to reproduce?\r\n\r\nIncrease `-dbcache=` in then validate blocks and coins dbs (probably the easiest via python plyvel a small script to compare node dbs)\r\nIn fork that i've work on, it's flush batch at every block in ibd, so every block append in a batch then some batch records missing due to signed int overflow.",
      "created_at" : "2022-07-07T07:24:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25561#issuecomment-1177188653",
      "id" : 1177188653,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25561",
      "node_id" : "IC_kwDOABII585GKnkt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177188653/reactions"
      },
      "updated_at" : "2022-07-07T07:24:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177188653",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Sorry, I don't follow. Are you saying this is something that an end user of a Bitcoin Core release can run into or does it require local modifications or external scripts?\r\n\r\nOur functional tests run with the integer sanitizer, so are you saying this happens only outside of tests?\r\n\r\nI am happy to try to reproduce this, but it would make it a lot easier for me if there were exact and easy steps to reproduce. Ideally ones that can be copy-pasted into a terminal.",
      "created_at" : "2022-07-07T07:31:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25561#issuecomment-1177194605",
      "id" : 1177194605,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25561",
      "node_id" : "IC_kwDOABII585GKpBt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177194605/reactions"
      },
      "updated_at" : "2022-07-07T07:31:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177194605",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "If this is security relevant (or you are unsure about it), kindly follow the security policy:\r\n\r\nhttps://github.com/bitcoin/bitcoin/security/policy",
      "created_at" : "2022-07-07T07:39:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25561#issuecomment-1177201980",
      "id" : 1177201980,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25561",
      "node_id" : "IC_kwDOABII585GKq08",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177201980/reactions"
      },
      "updated_at" : "2022-07-07T07:39:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177201980",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "`DBImpl::Write` is used by `CDBWrapper` to write in leveldb, it groups batches in `DBImpl::BuildBatchGroup` then in `WriteBatchInternal::Append` uses `SetCount(dst, Count(dst) + Count(src));` more precise `Count(dst) + Count(src)` is signed int + signed int = overflow is UB that's made a record id to be unpredictable then not found.\r\n\r\nIt could compromise block / tx index and/or coins db which could lead to possible fork and compromise the network as worst case scenario.",
      "created_at" : "2022-07-07T10:17:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25561#issuecomment-1177360728",
      "id" : 1177360728,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25561",
      "node_id" : "IC_kwDOABII585GLRlY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177360728/reactions"
      },
      "updated_at" : "2022-07-07T10:19:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177360728",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8323581?v=4",
         "events_url" : "https://api.github.com/users/bvbfan/events{/privacy}",
         "followers_url" : "https://api.github.com/users/bvbfan/followers",
         "following_url" : "https://api.github.com/users/bvbfan/following{/other_user}",
         "gists_url" : "https://api.github.com/users/bvbfan/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/bvbfan",
         "id" : 8323581,
         "login" : "bvbfan",
         "node_id" : "MDQ6VXNlcjgzMjM1ODE=",
         "organizations_url" : "https://api.github.com/users/bvbfan/orgs",
         "received_events_url" : "https://api.github.com/users/bvbfan/received_events",
         "repos_url" : "https://api.github.com/users/bvbfan/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/bvbfan/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/bvbfan/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/bvbfan"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@bvbfan, `BuildBatchGroup` only groups batches if you're attempting to write batches concurrently (core [appears][1] to split updates into smaller batches and write them sequentially). Even then, the batches would need to total 2^31 updates or more. \r\n\r\nI don't think this is possible under any realistic circumstance. Writing the entire UTXO set in a single batch still wouldn't come close to triggering an overflow.\r\n\r\n[1]: https://github.com/bitcoin/bitcoin/blob/fb38c6e/src/txdb.cpp#L139",
      "created_at" : "2022-07-07T11:39:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25561#issuecomment-1177471767",
      "id" : 1177471767,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25561",
      "node_id" : "IC_kwDOABII585GLssX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177471767/reactions"
      },
      "updated_at" : "2022-07-07T11:39:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177471767",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/470564?v=4",
         "events_url" : "https://api.github.com/users/chjj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/chjj/followers",
         "following_url" : "https://api.github.com/users/chjj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/chjj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/chjj",
         "id" : 470564,
         "login" : "chjj",
         "node_id" : "MDQ6VXNlcjQ3MDU2NA==",
         "organizations_url" : "https://api.github.com/users/chjj/orgs",
         "received_events_url" : "https://api.github.com/users/chjj/received_events",
         "repos_url" : "https://api.github.com/users/chjj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/chjj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/chjj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/chjj"
      }
   }
]
