[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK. It would be great to support tracing on MacOS assuming the maintenance burden is satisfactory.\r\n\r\n(The linter checks are failing currently.)",
      "created_at" : "2022-07-04T16:53:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25541#issuecomment-1174003787",
      "id" : 1174003787,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25541",
      "node_id" : "IC_kwDOABII585F-eBL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1174003787/reactions"
      },
      "updated_at" : "2022-07-04T16:53:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1174003787",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/16323900?v=4",
         "events_url" : "https://api.github.com/users/michaelfolkson/events{/privacy}",
         "followers_url" : "https://api.github.com/users/michaelfolkson/followers",
         "following_url" : "https://api.github.com/users/michaelfolkson/following{/other_user}",
         "gists_url" : "https://api.github.com/users/michaelfolkson/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/michaelfolkson",
         "id" : 16323900,
         "login" : "michaelfolkson",
         "node_id" : "MDQ6VXNlcjE2MzIzOTAw",
         "organizations_url" : "https://api.github.com/users/michaelfolkson/orgs",
         "received_events_url" : "https://api.github.com/users/michaelfolkson/received_events",
         "repos_url" : "https://api.github.com/users/michaelfolkson/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/michaelfolkson/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/michaelfolkson/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/michaelfolkson"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913154097"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913154097"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit:\r\n\r\n```suggestion\r\n   the header file `probes.h` with the necessary tracepoints macros.\r\n```",
      "commit_id" : "b5148f53fb671abfc76914e463447235ed2ac8cb",
      "created_at" : "2022-07-04T17:03:17Z",
      "diff_hunk" : "@@ -0,0 +1,44 @@\n+/* Copyright (c) 2022 The Bitcoin Core developers\n+   Distributed under the MIT software license, see the accompanying\n+   file COPYING or http://www.opensource.org/licenses/mit-license.php. */\n+\n+/*\n+\n+   This file is part of the more involved process of using USDT probes on macOS\n+   as described in the BUILDING CODE CONTAINING USDT PROBES section in the\n+   dtrace(1) manpage https://www.unix.com/man-page/mojave/1/dtrace/\n+\n+   This defines the providers and specifies their probes in order to generate\n+   the header file `probes.h` with the neccesary tracepoints macros.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913154097",
      "id" : 913154097,
      "line" : 12,
      "node_id" : "PRRC_kwDOABII5842baAx",
      "original_commit_id" : "b5148f53fb671abfc76914e463447235ed2ac8cb",
      "original_line" : 12,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/util/probes.d",
      "position" : 12,
      "pull_request_review_id" : 1027764348,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913154097/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-04T17:03:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913154097",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2022-07-04T17:04:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25541#issuecomment-1174010011",
      "id" : 1174010011,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25541",
      "node_id" : "IC_kwDOABII585F-fib",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1174010011/reactions"
      },
      "updated_at" : "2022-07-04T17:04:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1174010011",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913157934"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913157934"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If this PR is macOS-specific, why remove Linux-specific check for `DTRACE_PROBE` macro?",
      "commit_id" : "b5148f53fb671abfc76914e463447235ed2ac8cb",
      "created_at" : "2022-07-04T17:13:24Z",
      "diff_hunk" : "@@ -1385,14 +1385,13 @@ fi\n \n if test \"$use_usdt\" != \"no\"; then\n   AC_MSG_CHECKING([whether Userspace, Statically Defined Tracing tracepoints are supported])\n-  AC_COMPILE_IFELSE([\n-    AC_LANG_PROGRAM(\n-      [#include <sys/sdt.h>],\n-      [DTRACE_PROBE(\"context\", \"event\");]\n-    )],\n-    [AC_MSG_RESULT([yes]); AC_DEFINE([ENABLE_TRACING], [1], [Define to 1 to enable tracepoints for Userspace, Statically Defined Tracing])],\n-    [AC_MSG_RESULT([no]); use_usdt=no;]\n-  )\n+  AC_CHECK_HEADER([sys/sdt.h], [use_usdt=yes], [use_usdt=no])\n+else\n+  use_usdt=no\n+fi\n+\n+if test x$use_usdt = xyes; then\n+  AC_DEFINE([ENABLE_TRACING], [1], [Define to 1 to enable tracepoints for Userspace, Statically Defined Tracing])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913157934",
      "id" : 913157934,
      "line" : 1394,
      "node_id" : "PRRC_kwDOABII5842ba8u",
      "original_commit_id" : "b5148f53fb671abfc76914e463447235ed2ac8cb",
      "original_line" : 1394,
      "original_position" : 18,
      "original_start_line" : 1388,
      "path" : "configure.ac",
      "position" : 18,
      "pull_request_review_id" : 1027769566,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913157934/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1388,
      "start_side" : "LEFT",
      "updated_at" : "2022-07-04T17:13:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913157934",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913172294"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913172294"
         }
      },
      "author_association" : "NONE",
      "body" : "Before https://github.com/bitcoin/bitcoin/pull/22238 `AC_CHECK_HEADER([sys/sdt.h],...)`was the check to detect whether USDT tracepoints are supported, but per the reasoning of the aformentioned PR, the indent of that change was to \"fail\" on macOS and not on Linux as macOS has the `sys/sdt.h` header but `DTRACE_PROBE` is not defined in it.\r\n\r\nSo even after this macOS-specific PR, if I did not change that, the binary would compiled with USDT tracing  disabled as the `DTRACE_PROBE` is still not defined. That's why I revert that change, as now there is a macOS specific clause in `util/trace.h`",
      "commit_id" : "1aacde12c9c1014da888bc0bcc43b38f00bca76d",
      "created_at" : "2022-07-04T17:49:44Z",
      "diff_hunk" : "@@ -1385,14 +1385,13 @@ fi\n \n if test \"$use_usdt\" != \"no\"; then\n   AC_MSG_CHECKING([whether Userspace, Statically Defined Tracing tracepoints are supported])\n-  AC_COMPILE_IFELSE([\n-    AC_LANG_PROGRAM(\n-      [#include <sys/sdt.h>],\n-      [DTRACE_PROBE(\"context\", \"event\");]\n-    )],\n-    [AC_MSG_RESULT([yes]); AC_DEFINE([ENABLE_TRACING], [1], [Define to 1 to enable tracepoints for Userspace, Statically Defined Tracing])],\n-    [AC_MSG_RESULT([no]); use_usdt=no;]\n-  )\n+  AC_CHECK_HEADER([sys/sdt.h], [use_usdt=yes], [use_usdt=no])\n+else\n+  use_usdt=no\n+fi\n+\n+if test x$use_usdt = xyes; then\n+  AC_DEFINE([ENABLE_TRACING], [1], [Define to 1 to enable tracepoints for Userspace, Statically Defined Tracing])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913172294",
      "id" : 913172294,
      "in_reply_to_id" : 913157934,
      "line" : 1394,
      "node_id" : "PRRC_kwDOABII5842bedG",
      "original_commit_id" : "b5148f53fb671abfc76914e463447235ed2ac8cb",
      "original_line" : 1394,
      "original_position" : 18,
      "original_start_line" : 1388,
      "path" : "configure.ac",
      "position" : 18,
      "pull_request_review_id" : 1027823811,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913172294/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 1388,
      "start_side" : "LEFT",
      "updated_at" : "2022-07-04T18:12:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913172294",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18506343?v=4",
         "events_url" : "https://api.github.com/users/kouloumos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kouloumos/followers",
         "following_url" : "https://api.github.com/users/kouloumos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kouloumos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kouloumos",
         "id" : 18506343,
         "login" : "kouloumos",
         "node_id" : "MDQ6VXNlcjE4NTA2MzQz",
         "organizations_url" : "https://api.github.com/users/kouloumos/orgs",
         "received_events_url" : "https://api.github.com/users/kouloumos/received_events",
         "repos_url" : "https://api.github.com/users/kouloumos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kouloumos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kouloumos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kouloumos"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK. Thank you for working on this :rocket:  I plan to review this. I want to see e.g. what additional things we would need to consider when adding new tracepoints. A few first impressions, notes, and questions: \r\n\r\n- This looks like a cool PoC, but not really close to being ready for merge, especially with the custom patch :). Could also be a draft PR.\r\n- Awesome to see that we can re-use the same `TRACEx` macros we've already placed in the code. This was how I envisioned macOS (or Windows if possible) tracing support.\r\n\r\n>  and then apply the [probes-fix.diff](https://gist.github.com/kouloumos/df773b1e0896adca827e7960eace1d21) patch with git apply probes-fix.diff.\r\n- Would be good find a workaround for this. Did you create the patch manually? Can we change the tracepoints to improve this? I.e. not use `bool`?\r\n- Does `src/util/probes.h` need to be in version control or can it be generated during build time?\r\n- I was able to generate `src/util/probes.h` from `src/util/probes.d` on Linux, with `dtrace` supplied by Systemtap. However, it looks very different from your `probes.h` file. See [this](https://gist.github.com/0xB10C/655e506e9e53092f4becf412284f572a) gits.\r\n- It would be ideal if we could have a probes.d file that works for both Linux and macOS.\r\n- The `*_ENABLED()` in probes.h reminded me https://eklitzke.org/how-sytemtap-userspace-probes-work  \r\n- We should check the macOS GUIX builds at some point to see if tracing works with them.\r\n- We'd probably want to document these steps in doc/tracing.md once we've figured something out that works well and doesn't add to much maintenance. Also, the *.d scripts can be mentioned under the example section.\r\n\r\ncc @jb55 ",
      "created_at" : "2022-07-05T09:48:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25541#issuecomment-1174858051",
      "id" : 1174858051,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25541",
      "node_id" : "IC_kwDOABII585GBulD",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1174858051/reactions"
      },
      "updated_at" : "2022-07-05T10:07:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1174858051",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913607647"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913607647"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "does `inbound_message` also need the `/* std::byte * */` comment? They both pass the same data.",
      "commit_id" : "1aacde12c9c1014da888bc0bcc43b38f00bca76d",
      "created_at" : "2022-07-05T09:50:12Z",
      "diff_hunk" : "@@ -0,0 +1,44 @@\n+/* Copyright (c) 2022 The Bitcoin Core developers\n+   Distributed under the MIT software license, see the accompanying\n+   file COPYING or http://www.opensource.org/licenses/mit-license.php. */\n+\n+/*\n+\n+   This file is part of the more involved process of using USDT probes on macOS\n+   as described in the BUILDING CODE CONTAINING USDT PROBES section in the\n+   dtrace(1) manpage https://www.unix.com/man-page/mojave/1/dtrace/\n+\n+   This defines the providers and specifies their probes in order to generate\n+   the header file `probes.h` with the necessary tracepoints macros.\n+\n+   Types not supported by the D language cannot be used as part of the probe's\n+   signature. On those occasions, temporary D-supported types are used to then\n+   replaced in the generated header file with those that we actually need.\n+\n+   The unsupported types are specified with inline comments next to their\n+   temporary D language supported replacement.\n+\n+*/\n+\n+provider net {\n+        probe inbound_message(int64_t, char *, char *, char *, int64_t, unsigned char *);\n+        probe outbound_message(int64_t, char *, char *, char *, int64_t, /* std::byte * */unsigned char *);\n+};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913607647",
      "id" : 913607647,
      "line" : 26,
      "node_id" : "PRRC_kwDOABII5842dIvf",
      "original_commit_id" : "1aacde12c9c1014da888bc0bcc43b38f00bca76d",
      "original_line" : 26,
      "original_position" : 26,
      "original_start_line" : 23,
      "path" : "src/util/probes.d",
      "position" : 26,
      "pull_request_review_id" : 1028360955,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913607647/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 23,
      "start_side" : "RIGHT",
      "updated_at" : "2022-07-05T09:50:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913607647",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913611013"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913611013"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "we could change that, if this makes it a lot easier for macOS. This would probably be an API break, but I think the tracepoints are still experimental enough to be able to do it. ",
      "commit_id" : "1aacde12c9c1014da888bc0bcc43b38f00bca76d",
      "created_at" : "2022-07-05T09:53:43Z",
      "diff_hunk" : "@@ -7,6 +7,44 @@\n \n #ifdef ENABLE_TRACING\n \n+#ifdef __APPLE__\n+\n+#include <util/macros.h>\n+#include <util/probes.h>\n+\n+// since the dtrace macros are automatically generated in uppercase, additional\n+// macros are needed to translate the lowercase context & event names into the\n+// required uppercase CONTEXT_EVENT macros",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913611013",
      "id" : 913611013,
      "line" : 17,
      "node_id" : "PRRC_kwDOABII5842dJkF",
      "original_commit_id" : "1aacde12c9c1014da888bc0bcc43b38f00bca76d",
      "original_line" : 17,
      "original_position" : 11,
      "original_start_line" : 15,
      "path" : "src/util/trace.h",
      "position" : 11,
      "pull_request_review_id" : 1028365709,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913611013/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 15,
      "start_side" : "RIGHT",
      "updated_at" : "2022-07-05T09:53:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913611013",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913625496"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913625496"
         }
      },
      "author_association" : "NONE",
      "body" : "I actually made a mistake with the comment there, it's the other way around. `inbound_message` is the one that needs the change to `std::byte *`. `outbound_message` works as it is with `unsigned char *`.\r\n\r\nTrying to build without changing the type at `inbound_message` results to\r\n\r\n```\r\nerror: no matching function\r\n...\r\n/util/probes.h:46:13: note: candidate function not viable: no known conversion from 'CDataStream::value_type *' (aka 'std::byte *') to 'const unsigned char *' for 6th argument\r\n```\r\nThat's why I changed that to `std::byte *`. Reading the docs, my understanding was also that the both pass the same data but it seems that the 6th arg of `inbound_message` uses the `CDataStream` class while `outbound_message` uses a `std::vector<unsigned char>`.",
      "commit_id" : "1aacde12c9c1014da888bc0bcc43b38f00bca76d",
      "created_at" : "2022-07-05T10:09:33Z",
      "diff_hunk" : "@@ -0,0 +1,44 @@\n+/* Copyright (c) 2022 The Bitcoin Core developers\n+   Distributed under the MIT software license, see the accompanying\n+   file COPYING or http://www.opensource.org/licenses/mit-license.php. */\n+\n+/*\n+\n+   This file is part of the more involved process of using USDT probes on macOS\n+   as described in the BUILDING CODE CONTAINING USDT PROBES section in the\n+   dtrace(1) manpage https://www.unix.com/man-page/mojave/1/dtrace/\n+\n+   This defines the providers and specifies their probes in order to generate\n+   the header file `probes.h` with the necessary tracepoints macros.\n+\n+   Types not supported by the D language cannot be used as part of the probe's\n+   signature. On those occasions, temporary D-supported types are used to then\n+   replaced in the generated header file with those that we actually need.\n+\n+   The unsupported types are specified with inline comments next to their\n+   temporary D language supported replacement.\n+\n+*/\n+\n+provider net {\n+        probe inbound_message(int64_t, char *, char *, char *, int64_t, unsigned char *);\n+        probe outbound_message(int64_t, char *, char *, char *, int64_t, /* std::byte * */unsigned char *);\n+};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913625496",
      "id" : 913625496,
      "in_reply_to_id" : 913607647,
      "line" : 26,
      "node_id" : "PRRC_kwDOABII5842dNGY",
      "original_commit_id" : "1aacde12c9c1014da888bc0bcc43b38f00bca76d",
      "original_line" : 26,
      "original_position" : 26,
      "original_start_line" : 23,
      "path" : "src/util/probes.d",
      "position" : 26,
      "pull_request_review_id" : 1028386255,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913625496/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 23,
      "start_side" : "RIGHT",
      "updated_at" : "2022-07-05T10:09:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913625496",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/18506343?v=4",
         "events_url" : "https://api.github.com/users/kouloumos/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kouloumos/followers",
         "following_url" : "https://api.github.com/users/kouloumos/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kouloumos/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kouloumos",
         "id" : 18506343,
         "login" : "kouloumos",
         "node_id" : "MDQ6VXNlcjE4NTA2MzQz",
         "organizations_url" : "https://api.github.com/users/kouloumos/orgs",
         "received_events_url" : "https://api.github.com/users/kouloumos/received_events",
         "repos_url" : "https://api.github.com/users/kouloumos/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kouloumos/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kouloumos/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kouloumos"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913646086"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913646086"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh, you are right. Then we should reinterpret_cast the `.data()` in `inbound_message` to `const unsigned char *` if it makes thinks easier for you (and is currently not conforming to the documentation). ",
      "commit_id" : "1aacde12c9c1014da888bc0bcc43b38f00bca76d",
      "created_at" : "2022-07-05T10:33:43Z",
      "diff_hunk" : "@@ -0,0 +1,44 @@\n+/* Copyright (c) 2022 The Bitcoin Core developers\n+   Distributed under the MIT software license, see the accompanying\n+   file COPYING or http://www.opensource.org/licenses/mit-license.php. */\n+\n+/*\n+\n+   This file is part of the more involved process of using USDT probes on macOS\n+   as described in the BUILDING CODE CONTAINING USDT PROBES section in the\n+   dtrace(1) manpage https://www.unix.com/man-page/mojave/1/dtrace/\n+\n+   This defines the providers and specifies their probes in order to generate\n+   the header file `probes.h` with the necessary tracepoints macros.\n+\n+   Types not supported by the D language cannot be used as part of the probe's\n+   signature. On those occasions, temporary D-supported types are used to then\n+   replaced in the generated header file with those that we actually need.\n+\n+   The unsupported types are specified with inline comments next to their\n+   temporary D language supported replacement.\n+\n+*/\n+\n+provider net {\n+        probe inbound_message(int64_t, char *, char *, char *, int64_t, unsigned char *);\n+        probe outbound_message(int64_t, char *, char *, char *, int64_t, /* std::byte * */unsigned char *);\n+};",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25541#discussion_r913646086",
      "id" : 913646086,
      "in_reply_to_id" : 913607647,
      "line" : 26,
      "node_id" : "PRRC_kwDOABII5842dSIG",
      "original_commit_id" : "1aacde12c9c1014da888bc0bcc43b38f00bca76d",
      "original_line" : 26,
      "original_position" : 26,
      "original_start_line" : 23,
      "path" : "src/util/probes.d",
      "position" : 26,
      "pull_request_review_id" : 1028415272,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25541",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913646086/reactions"
      },
      "side" : "RIGHT",
      "start_line" : 23,
      "start_side" : "RIGHT",
      "updated_at" : "2022-07-05T10:34:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/913646086",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19157360?v=4",
         "events_url" : "https://api.github.com/users/0xB10C/events{/privacy}",
         "followers_url" : "https://api.github.com/users/0xB10C/followers",
         "following_url" : "https://api.github.com/users/0xB10C/following{/other_user}",
         "gists_url" : "https://api.github.com/users/0xB10C/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/0xB10C",
         "id" : 19157360,
         "login" : "0xB10C",
         "node_id" : "MDQ6VXNlcjE5MTU3MzYw",
         "organizations_url" : "https://api.github.com/users/0xB10C/orgs",
         "received_events_url" : "https://api.github.com/users/0xB10C/received_events",
         "repos_url" : "https://api.github.com/users/0xB10C/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/0xB10C/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/0xB10C/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/0xB10C"
      }
   }
]
