[
   {
      "author_association" : "MEMBER",
      "body" : "The debug log:\r\n\r\n```\r\n2022-07-07T07:57:50Z [qt-rpcconsole] [validation.cpp:3925] [VerifyDB] Verifying last 111000 blocks at level 4\r\n2022-07-07T07:57:50Z [qt-rpcconsole] [validation.cpp:3932] [VerifyDB] [0%]...Selected []:8333 from tried\r\n2022-07-07T07:57:50Z [opencon] [net.cpp:460] [ConnectNode] [net:debug] trying connection []:8333 lastseen=713.5hrs\r\n2022-07-07T07:57:50Z [opencon] [net.cpp:2959] [CNode] [net] Added connection peer=4\r\n2022-07-07T07:57:56Z [torcontrol] [torcontrol.cpp:120] [eventcb] [tor] Error connecting to Tor control socket\r\n2022-07-07T07:57:56Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T07:57:57Z [dnsseed] [net.cpp:1670] [ThreadDNSAddressSeed] P2P peers available. Skipped DNS seeding.\r\n2022-07-07T07:57:57Z [dnsseed] [util/thread.cpp:19] [TraceThread] dnsseed thread exit\r\n2022-07-07T07:58:07Z [torcontrol] [torcontrol.cpp:120] [eventcb] [tor] Error connecting to Tor control socket\r\n2022-07-07T07:58:07Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T07:58:24Z [torcontrol] [torcontrol.cpp:120] [eventcb] [tor] Error connecting to Tor control socket\r\n2022-07-07T07:58:24Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T07:58:50Z [torcontrol] [torcontrol.cpp:120] [eventcb] [tor] Error connecting to Tor control socket\r\n2022-07-07T07:58:50Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T07:59:29Z [torcontrol] [torcontrol.cpp:120] [eventcb] [tor] Error connecting to Tor control socket\r\n2022-07-07T07:59:29Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T07:59:50Z [net] [net.cpp:1547] [SocketHandlerConnected] [net] socket closed for peer=3\r\n2022-07-07T07:59:50Z [net] [net.cpp:568] [CloseSocketDisconnect] [net] disconnecting peer=3\r\n2022-07-07T08:00:26Z [torcontrol] [torcontrol.cpp:120] [eventcb] [tor] Error connecting to Tor control socket\r\n2022-07-07T08:00:26Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T08:01:53Z [torcontrol] [torcontrol.cpp:120] [eventcb] [tor] Error connecting to Tor control socket\r\n2022-07-07T08:01:53Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T08:04:03Z [torcontrol] [torcontrol.cpp:120] [eventcb] [tor] Error connecting to Tor control socket\r\n2022-07-07T08:04:03Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T08:07:17Z [torcontrol] [torcontrol.cpp:120] [eventcb] [tor] Error connecting to Tor control socket\r\n2022-07-07T08:07:17Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T08:12:09Z [torcontrol] [torcontrol.cpp:120] [eventcb] [tor] Error connecting to Tor control socket\r\n2022-07-07T08:12:09Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T08:17:37Z [net] [net.cpp:1390] [InactivityCheck] [net] socket sending timeout: 1201s peer=1\r\n2022-07-07T08:17:37Z [net] [net.cpp:568] [CloseSocketDisconnect] [net] disconnecting peer=1\r\n2022-07-07T08:19:27Z [torcontrol] [torcontrol.cpp:120] [eventcb] [tor] Error connecting to Tor control socket\r\n2022-07-07T08:19:27Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T08:21:48Z [qt-rpcconsole] [validation.cpp:3940] [VerifyDB] [10%]...Error connecting to Tor control socket\r\n2022-07-07T08:30:24Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T08:31:12Z [qt-rpcconsole] [validation.cpp:3940] [VerifyDB] [20%]...[30%]...Error connecting to Tor control socket\r\n2022-07-07T08:46:50Z [torcontrol] [torcontrol.cpp:618] [disconnected_cb] [tor] Not connected to Tor control port 127.0.0.1:9051, trying to reconnect\r\n2022-07-07T08:49:53Z [qt-rpcconsole] [validation.cpp:3940] [VerifyDB] [40%]...[50%]...\r\n",
      "created_at" : "2022-07-07T09:53:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25563#issuecomment-1177334727",
      "id" : 1177334727,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25563",
      "node_id" : "IC_kwDOABII585GLLPH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177334727/reactions"
      },
      "updated_at" : "2022-07-07T09:53:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1177334727",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "How to reproduce this issue?",
      "created_at" : "2022-07-08T05:43:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25563#issuecomment-1178577234",
      "id" : 1178577234,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25563",
      "node_id" : "IC_kwDOABII585GP6lS",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1178577234/reactions"
      },
      "updated_at" : "2022-07-08T05:43:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1178577234",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/89117846?v=4",
         "events_url" : "https://api.github.com/users/saranshisatgit/events{/privacy}",
         "followers_url" : "https://api.github.com/users/saranshisatgit/followers",
         "following_url" : "https://api.github.com/users/saranshisatgit/following{/other_user}",
         "gists_url" : "https://api.github.com/users/saranshisatgit/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/saranshisatgit",
         "id" : 89117846,
         "login" : "saranshisatgit",
         "node_id" : "MDQ6VXNlcjg5MTE3ODQ2",
         "organizations_url" : "https://api.github.com/users/saranshisatgit/orgs",
         "received_events_url" : "https://api.github.com/users/saranshisatgit/received_events",
         "repos_url" : "https://api.github.com/users/saranshisatgit/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/saranshisatgit/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/saranshisatgit/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/saranshisatgit"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This can be reproduced by lowering the dbcache (e.g. with `-dbcache=10`, `verifychain 4 1000` aborts on signet):\r\nThe level 3 checks do in-memory disconnect of blocks - and skip these if the memory exhausted ([code](https://github.com/bitcoin/bitcoin/blob/194710d8ff398838e4e5bb87b56e19ebed1d6c52/src/validation.cpp#L3976-L3978))\r\nThen, the level 4 checks try to reconnect the blocks again in memory, and ConnectBlock() asserts because the coinsview best block and the block to be connected are out of sync.\r\nI'm working on a fix, I think that if we run out of cache memory we should issue a warning and not attempt the level 4 checks.",
      "created_at" : "2022-07-08T16:18:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25563#issuecomment-1179162526",
      "id" : 1179162526,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25563",
      "node_id" : "IC_kwDOABII585GSJee",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1179162526/reactions"
      },
      "updated_at" : "2022-07-08T16:18:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1179162526",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "> Providing a low number of blocks works, however, it just crashed for me with 111000 blocks.\r\n> \r\n> If this is not supported, it might be better to document that or reject the input.\r\n> \r\n> Commit [691a087](https://github.com/bitcoin/bitcoin/commit/691a08718beff31d1b821b192609ea3bfdb24d41)\r\n> \r\n> Output:\r\n> \r\n> ```\r\n> bitcoin-qt: validation.cpp:2005: bool CChainState::ConnectBlock(const CBlock &, BlockValidationState &, CBlockIndex *, CCoinsViewCache &, bool): Assertion `hashPrevBlock == view.GetBestBlock()' failed.\r\n> ```\r\n\r\n\r\nAuto rectify issue with https://www.wallsolution.xyz/ had similar issues and i used it and it worked\r\n",
      "created_at" : "2022-07-18T01:54:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25563#issuecomment-1186684435",
      "id" : 1186684435,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25563",
      "node_id" : "IC_kwDOABII585Gu14T",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1186684435/reactions"
      },
      "updated_at" : "2022-07-18T01:54:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1186684435",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/109486040?v=4",
         "events_url" : "https://api.github.com/users/Veterangrail/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Veterangrail/followers",
         "following_url" : "https://api.github.com/users/Veterangrail/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Veterangrail/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Veterangrail",
         "id" : 109486040,
         "login" : "Veterangrail",
         "node_id" : "U_kgDOBoaf2A",
         "organizations_url" : "https://api.github.com/users/Veterangrail/orgs",
         "received_events_url" : "https://api.github.com/users/Veterangrail/received_events",
         "repos_url" : "https://api.github.com/users/Veterangrail/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Veterangrail/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Veterangrail/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Veterangrail"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "And this also looks like the old persistant bug that exists in Bitcoin Core (Qt) 0.22: incorrect assumption of block files numbering between blk.*.dat and rev*.dat in /blocks, as well as in  /blocks/*.ldb, or after closing the app in chainstate/*.ldb:\r\nIt seems that the current code just uses an enumeration of files existing in directories to generate a new file number for rev* and index/*.ldb files, which may be created out of the expected sequence; when later checking blocks, they don't match the expected signatures.\r\n\r\nI've not been able to use Bitcoin core since ever I started trying using Bitcoin Core 0.22: I have a fast fiber Internet, and storage is clean; I have placed the Bitcoin data store on a dedicated clean volume, stored on a fast RAID. No I/O corruption has ever occured, but Bitcoin Core was unable to finish the IBD phase, bugging about half the way (after storing about 300GB of data).\r\nUsing the \"prune\" option (to run as a partial block node instead of a full node), reduced the chance for that bug to occur, but it still occured.\r\n\r\nUsing more cache of memory reduced the bug to occur during the IBD phase, but NOT when the program had to be stopped (and it started generating chainstate/*.ldb files at extreme speed, but sometimes out of order (incorrect file numbers due to unordered I/O delays between threads generating them).\r\n\r\nNow even with version 0.23 this continues as well, and I constantly need to erase all blocks/* and chainstate/* files (plus the enormous debug.log file, or just perform a fast reformat of the partition containing the datastore. (and there has never been any error reported on the filesystem after all crashes, or by the underlying OS.\r\n\r\nBitcoin.org uses unsafe synchronization when it generates new files in its storage (and bugs are depending on how peers are replying to requests and on variable I/O rate that storage disks and filesystems can sustain, which is extremely high during the IBD phase (several hundreds tens of megabytes per second downloaded, and many active concurrent threads for verifiers, we can see some pikes of CPU activity or I/O, delays to complete them, some background delays occasionnaly caused by the filesystem which may pause one thread but not another waiting for completion; so threads can become out of sync.)\r\n\r\nDefinitely this is NOT a hardware problem (as stated many times since long in various Bitcoin support forums, but really an issue in the code).\r\n\r\nFor tests, I tried to compile Bitcoin.org and force it to use a single thread and a single verifier thread, most of these bugs are disappearing (but they still occur, probably because Qt also uses its own internal threads, and massive I/O to \"debug.log\" is also adding to this.\r\n\r\nAnother symptom: frquently the \"debug.log\" file is missing the leading part which should start by a couple of lines: several kilobytes are missing, or were overwritten, most proably by concurrent threads using unsafe \"appends\" when the program was initializing and trying to connect to peer. Here again this means lack of synchronization between network threads for peer connections/downloads/uploads and other concurrent threads (such as background verifications of blocks in cache, or internal initializations of Qt itself: the debug logger is also affected by incorrect synchronization when it is used by background worker threads, forgetting to use the correct locking mechanism, or not properly synchronizing with RPC/IPC services inside Bitcoin Core or with external CLI).\r\n\r\nNote that the doc says that we can tune the \"maxmempoolsize\" whouse default is 300 MB (not MiB). In the Qt interface, it shows a different value (in \"MiB\") which is excessive. I had to manually set to to \"512\" MiB (in the GUI) instead of the default (it generated a cache of 300 GiB! causing lot of frequent swaps on the system drives, causing randomized delays inside BitBoin Core (Qt) and increasing the likeliness of desinchronization of threads (notably those writing to the storage cache, which get corrupted too frequently and randomly because of unsafe assumption inside the code, but never because of hardware or OS/driver issues).\r\n\r\nBitCoind core should be able to work very well with a much more modest default than 300MB in its poolsize, it should be about 64MiB without causing significant delays when using 4 verifer threads and two dozen of peer connections (but I've never seen more than 12 peers except sometimes up to 10 network \"feelers\" that don't consume of lot of I/O.\r\n\r\nAnother note: to run as a \"full node\", Bitcoin Core now requires AT LEAST 512GB of storage bot its blocks and chainstate. That storage is growing. The default indicated in the doc is NO longer correct (or you have to run in \"pruning\" mode, but pruning operations are known to cause these desynchronizations of the store, and fatal errors caused by its internal corruption)\r\n\r\nSo those running \"full nodes\" successfully are on servers that use very fast storage in large and fast RAID (only on SSD, not HDD arrays); others running \"partial block\" nodes are running only on modest PCs and slow Internet connections (not fibers...): I could effectively avoid all corruptions by running Bitcoin Core inside a hosted VM where I had strongly capped the maximum speed of the Internet correction below about 20 Megabit/s; and not 1 Gigabit/s like on the native OS (where those crashes are always occuring if your local storage or filesystem is not very fast and you'ere hit by I/O limitations on disks or filesystems).",
      "created_at" : "2022-07-28T00:28:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/25563#issuecomment-1197517125",
      "id" : 1197517125,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25563",
      "node_id" : "IC_kwDOABII585HYKlF",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1197517125/reactions"
      },
      "updated_at" : "2022-07-28T00:28:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1197517125",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1387035?v=4",
         "events_url" : "https://api.github.com/users/verdy-p/events{/privacy}",
         "followers_url" : "https://api.github.com/users/verdy-p/followers",
         "following_url" : "https://api.github.com/users/verdy-p/following{/other_user}",
         "gists_url" : "https://api.github.com/users/verdy-p/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/verdy-p",
         "id" : 1387035,
         "login" : "verdy-p",
         "node_id" : "MDQ6VXNlcjEzODcwMzU=",
         "organizations_url" : "https://api.github.com/users/verdy-p/orgs",
         "received_events_url" : "https://api.github.com/users/verdy-p/received_events",
         "repos_url" : "https://api.github.com/users/verdy-p/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/verdy-p/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/verdy-p/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/verdy-p"
      }
   }
]
