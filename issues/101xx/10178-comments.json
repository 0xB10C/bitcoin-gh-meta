[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10178#discussion_r110782830"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10178"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/110782830"
         }
      },
      "body" : "why is this in an extra block?",
      "commit_id" : "9f51ad130049fa5cbcd83d5bc5e0d145d6a73cc3",
      "created_at" : "2017-04-10T23:03:14Z",
      "diff_hunk" : "@@ -1155,6 +1155,32 @@ void CWallet::BlockConnected(const std::shared_ptr<const CBlock>& pblock, const\n     for (size_t i = 0; i < pblock->vtx.size(); i++) {\n         SyncTransaction(pblock->vtx[i], pindex, i);\n     }\n+\n+\n+    if (pindex) {\n+        // Only notify UI if this transaction is in this wallet\n+        {\n+            if (hashPrevBestCoinbase.IsNull()) {\n+                // For correctness we scan over the entire wallet, looking for\n+                // the previous block's coinbase, just in case it is ours, so\n+                // that we can notify the UI that it should now be displayed.\n+                if (pindex->pprev) {\n+                    for (const std::pair<uint256, CWalletTx>& p : mapWallet) {\n+                        if (p.second.IsCoinBase() && p.second.hashBlock == pindex->pprev->GetBlockHash()) {\n+                            NotifyTransactionChanged(this, p.first, CT_UPDATED);\n+                            break;\n+                        }\n+                    }\n+                }\n+            } else {\n+                std::map<uint256, CWalletTx>::const_iterator mi = mapWallet.find(hashPrevBestCoinbase);\n+                if (mi != mapWallet.end())\n+                    NotifyTransactionChanged(this, hashPrevBestCoinbase, CT_UPDATED);\n+            }\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10178#discussion_r110782830",
      "id" : 110782830,
      "original_commit_id" : "b6d4fc27153948b68edc2cd956caac16de2e8c36",
      "original_position" : 26,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 31980204,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10178",
      "updated_at" : "2017-04-10T23:09:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/110782830",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/10178#discussion_r110783429"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10178"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/110783429"
         }
      },
      "body" : "TBH I have no idea...probably copied and had a lock block, anyway, removed.",
      "commit_id" : "9f51ad130049fa5cbcd83d5bc5e0d145d6a73cc3",
      "created_at" : "2017-04-10T23:08:07Z",
      "diff_hunk" : "@@ -1155,6 +1155,32 @@ void CWallet::BlockConnected(const std::shared_ptr<const CBlock>& pblock, const\n     for (size_t i = 0; i < pblock->vtx.size(); i++) {\n         SyncTransaction(pblock->vtx[i], pindex, i);\n     }\n+\n+\n+    if (pindex) {\n+        // Only notify UI if this transaction is in this wallet\n+        {\n+            if (hashPrevBestCoinbase.IsNull()) {\n+                // For correctness we scan over the entire wallet, looking for\n+                // the previous block's coinbase, just in case it is ours, so\n+                // that we can notify the UI that it should now be displayed.\n+                if (pindex->pprev) {\n+                    for (const std::pair<uint256, CWalletTx>& p : mapWallet) {\n+                        if (p.second.IsCoinBase() && p.second.hashBlock == pindex->pprev->GetBlockHash()) {\n+                            NotifyTransactionChanged(this, p.first, CT_UPDATED);\n+                            break;\n+                        }\n+                    }\n+                }\n+            } else {\n+                std::map<uint256, CWalletTx>::const_iterator mi = mapWallet.find(hashPrevBestCoinbase);\n+                if (mi != mapWallet.end())\n+                    NotifyTransactionChanged(this, hashPrevBestCoinbase, CT_UPDATED);\n+            }\n+        }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10178#discussion_r110783429",
      "id" : 110783429,
      "original_commit_id" : "b6d4fc27153948b68edc2cd956caac16de2e8c36",
      "original_position" : 26,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 31980853,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10178",
      "updated_at" : "2017-04-10T23:09:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/110783429",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/649246?v=3",
         "events_url" : "https://api.github.com/users/TheBlueMatt/events{/privacy}",
         "followers_url" : "https://api.github.com/users/TheBlueMatt/followers",
         "following_url" : "https://api.github.com/users/TheBlueMatt/following{/other_user}",
         "gists_url" : "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/TheBlueMatt",
         "id" : 649246,
         "login" : "TheBlueMatt",
         "organizations_url" : "https://api.github.com/users/TheBlueMatt/orgs",
         "received_events_url" : "https://api.github.com/users/TheBlueMatt/received_events",
         "repos_url" : "https://api.github.com/users/TheBlueMatt/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/TheBlueMatt/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/TheBlueMatt"
      }
   }
]
