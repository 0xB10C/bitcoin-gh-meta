[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21236 (Net processing: Extract `addr` send functionality into MaybeSendAddr() by jnewbery)\n* #21235 (p2p: Clarify disconnect log message in ProcessGetBlockData, remove send bool by MarcoFalke)\n* #21186 (Net/Net Processing: Move addr data into net_processing by jnewbery)\n* #21061 ([p2p] Introduce node rebroadcast module by amitiuttarwar)\n* #21009 (Remove RewindBlockIndex logic by dhruv)\n* #19521 (Coinstats Index by fjahr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-02-23T00:55:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21270#issuecomment-783788519",
      "id" : 783788519,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21270",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc4Mzc4ODUxOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-09T05:53:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/783788519",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2021-03-04T10:01:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21270#issuecomment-790492000",
      "id" : 790492000,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21270",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MDQ5MjAwMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-04T10:01:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/790492000",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Will review after rebase.",
      "created_at" : "2021-03-06T18:01:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21270#issuecomment-792000937",
      "id" : 792000937,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21270",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MjAwMDkzNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-06T18:01:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/792000937",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed a0741fa4d5acb567122d0d43c725f8f64fd75eaf -> 38c325b1df093b2ff380df93c3a518286c531f32\r\n- Rebased over master",
      "created_at" : "2021-03-08T20:36:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21270#issuecomment-793058721",
      "id" : 793058721,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21270",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MzA1ODcyMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-08T20:36:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/793058721",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Pushed 38c325b1df093b2ff380df93c3a518286c531f32 -> a67983cd6d8e61565da4e03f3ba401d0148fe195\r\n- Addressed https://github.com/bitcoin/bitcoin/pull/21270#commitcomment-47985104 in prepended commit\r\n- Fixed namespace brace syntax mistake in \"net_processing: Move some static functions to PeerManager\"",
      "created_at" : "2021-03-08T20:57:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21270#issuecomment-793071459",
      "id" : 793071459,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21270",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5MzA3MTQ1OQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-08T20:57:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/793071459",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21270#discussion_r591987692"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21270"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591987692"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this line would give jnewbery a heart attack... \r\n\r\n```suggestion\r\n    GenerateCoinbaseCommitment(block,\r\n                               WITH_LOCK(::cs_main,\r\n                                         assert(std::addressof(g_chainman.m_blockman) == std::addressof(blockman));\r\n                                         return blockman.LookupBlockIndex(block.hashPrevBlock)),\r\n                               Params().GetConsensus());\r\n```",
      "commit_id" : "a67983cd6d8e61565da4e03f3ba401d0148fe195",
      "created_at" : "2021-03-11T00:53:25Z",
      "diff_hunk" : "@@ -39,13 +39,13 @@ int64_t UpdateTime(CBlockHeader* pblock, const Consensus::Params& consensusParam\n     return nNewTime - nOldTime;\n }\n \n-void RegenerateCommitments(CBlock& block)\n+void RegenerateCommitments(CBlock& block, BlockManager& blockman)\n {\n     CMutableTransaction tx{*block.vtx.at(0)};\n     tx.vout.erase(tx.vout.begin() + GetWitnessCommitmentIndex(block));\n     block.vtx.at(0) = MakeTransactionRef(tx);\n \n-    GenerateCoinbaseCommitment(block, WITH_LOCK(cs_main, return g_chainman.m_blockman.LookupBlockIndex(block.hashPrevBlock)), Params().GetConsensus());\n+    GenerateCoinbaseCommitment(block, WITH_LOCK(::cs_main, assert(std::addressof(g_chainman.m_blockman) == std::addressof(blockman)); return blockman.LookupBlockIndex(block.hashPrevBlock)), Params().GetConsensus());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21270#discussion_r591987692",
      "id" : 591987692,
      "line" : 48,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MTk4NzY5Mg==",
      "original_commit_id" : "a67983cd6d8e61565da4e03f3ba401d0148fe195",
      "original_line" : 48,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/miner.cpp",
      "position" : 12,
      "pull_request_review_id" : 609296491,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21270",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-11T01:49:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/591987692",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/25183001?v=4",
         "events_url" : "https://api.github.com/users/glozow/events{/privacy}",
         "followers_url" : "https://api.github.com/users/glozow/followers",
         "following_url" : "https://api.github.com/users/glozow/following{/other_user}",
         "gists_url" : "https://api.github.com/users/glozow/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/glozow",
         "id" : 25183001,
         "login" : "glozow",
         "node_id" : "MDQ6VXNlcjI1MTgzMDAx",
         "organizations_url" : "https://api.github.com/users/glozow/orgs",
         "received_events_url" : "https://api.github.com/users/glozow/received_events",
         "repos_url" : "https://api.github.com/users/glozow/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/glozow/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/glozow/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/glozow"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21270#discussion_r592140891"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21270"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592140891"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is a really strange C++ construction to me, to have assertions and return statements inside a function argument. It is likely out of scope of this PR to refactor it though. I'm not sure splitting it up over multiple lines makes it much more insightful.\r\n(the change here didn't make it much worse)",
      "commit_id" : "a67983cd6d8e61565da4e03f3ba401d0148fe195",
      "created_at" : "2021-03-11T08:04:52Z",
      "diff_hunk" : "@@ -39,13 +39,13 @@ int64_t UpdateTime(CBlockHeader* pblock, const Consensus::Params& consensusParam\n     return nNewTime - nOldTime;\n }\n \n-void RegenerateCommitments(CBlock& block)\n+void RegenerateCommitments(CBlock& block, BlockManager& blockman)\n {\n     CMutableTransaction tx{*block.vtx.at(0)};\n     tx.vout.erase(tx.vout.begin() + GetWitnessCommitmentIndex(block));\n     block.vtx.at(0) = MakeTransactionRef(tx);\n \n-    GenerateCoinbaseCommitment(block, WITH_LOCK(cs_main, return g_chainman.m_blockman.LookupBlockIndex(block.hashPrevBlock)), Params().GetConsensus());\n+    GenerateCoinbaseCommitment(block, WITH_LOCK(::cs_main, assert(std::addressof(g_chainman.m_blockman) == std::addressof(blockman)); return blockman.LookupBlockIndex(block.hashPrevBlock)), Params().GetConsensus());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21270#discussion_r592140891",
      "id" : 592140891,
      "in_reply_to_id" : 591987692,
      "line" : 48,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjE0MDg5MQ==",
      "original_commit_id" : "a67983cd6d8e61565da4e03f3ba401d0148fe195",
      "original_line" : 48,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/miner.cpp",
      "position" : 12,
      "pull_request_review_id" : 609480883,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21270",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-11T08:05:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592140891",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21270#discussion_r592173932"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21270"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592173932"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The assert will go away eventually, if I understood correctly, so the line is only temporarily longer than it previously was",
      "commit_id" : "a67983cd6d8e61565da4e03f3ba401d0148fe195",
      "created_at" : "2021-03-11T08:56:05Z",
      "diff_hunk" : "@@ -39,13 +39,13 @@ int64_t UpdateTime(CBlockHeader* pblock, const Consensus::Params& consensusParam\n     return nNewTime - nOldTime;\n }\n \n-void RegenerateCommitments(CBlock& block)\n+void RegenerateCommitments(CBlock& block, BlockManager& blockman)\n {\n     CMutableTransaction tx{*block.vtx.at(0)};\n     tx.vout.erase(tx.vout.begin() + GetWitnessCommitmentIndex(block));\n     block.vtx.at(0) = MakeTransactionRef(tx);\n \n-    GenerateCoinbaseCommitment(block, WITH_LOCK(cs_main, return g_chainman.m_blockman.LookupBlockIndex(block.hashPrevBlock)), Params().GetConsensus());\n+    GenerateCoinbaseCommitment(block, WITH_LOCK(::cs_main, assert(std::addressof(g_chainman.m_blockman) == std::addressof(blockman)); return blockman.LookupBlockIndex(block.hashPrevBlock)), Params().GetConsensus());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21270#discussion_r592173932",
      "id" : 592173932,
      "in_reply_to_id" : 591987692,
      "line" : 48,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjE3MzkzMg==",
      "original_commit_id" : "a67983cd6d8e61565da4e03f3ba401d0148fe195",
      "original_line" : 48,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/miner.cpp",
      "position" : 12,
      "pull_request_review_id" : 609521912,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21270",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-11T08:56:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592173932",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Code review ACK a67983cd6d8e61565da4e03f3ba401d0148fe195",
      "created_at" : "2021-03-11T10:46:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21270#issuecomment-796645222",
      "id" : 796645222,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21270",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc5NjY0NTIyMg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-03-11T10:46:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/796645222",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21270#discussion_r592257102"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21270"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592257102"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Right :smile: ",
      "commit_id" : "a67983cd6d8e61565da4e03f3ba401d0148fe195",
      "created_at" : "2021-03-11T10:49:59Z",
      "diff_hunk" : "@@ -39,13 +39,13 @@ int64_t UpdateTime(CBlockHeader* pblock, const Consensus::Params& consensusParam\n     return nNewTime - nOldTime;\n }\n \n-void RegenerateCommitments(CBlock& block)\n+void RegenerateCommitments(CBlock& block, BlockManager& blockman)\n {\n     CMutableTransaction tx{*block.vtx.at(0)};\n     tx.vout.erase(tx.vout.begin() + GetWitnessCommitmentIndex(block));\n     block.vtx.at(0) = MakeTransactionRef(tx);\n \n-    GenerateCoinbaseCommitment(block, WITH_LOCK(cs_main, return g_chainman.m_blockman.LookupBlockIndex(block.hashPrevBlock)), Params().GetConsensus());\n+    GenerateCoinbaseCommitment(block, WITH_LOCK(::cs_main, assert(std::addressof(g_chainman.m_blockman) == std::addressof(blockman)); return blockman.LookupBlockIndex(block.hashPrevBlock)), Params().GetConsensus());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21270#discussion_r592257102",
      "id" : 592257102,
      "in_reply_to_id" : 591987692,
      "line" : 48,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5MjI1NzEwMg==",
      "original_commit_id" : "a67983cd6d8e61565da4e03f3ba401d0148fe195",
      "original_line" : 48,
      "original_position" : 12,
      "original_start_line" : null,
      "path" : "src/miner.cpp",
      "position" : 12,
      "pull_request_review_id" : 609627196,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21270",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-03-11T10:49:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/592257102",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
