{
   "assignee" : null,
   "assignees" : [],
   "body" : "Checking for the existence in the CCoinsViewCache of the outputs of a new tx\r\nwill result in a disk hit for every output since they will not be found.  On the\r\nother hand if those outputs exist already, then the inputs must also have been\r\nmissing, so we can move this check inside the input existence check so in the\r\ncommon case of a new tx it doesn't need to run.\r\n\r\nThe purpose of the check is to avoid spamming the orphanMap with slightly old\r\ntxs which we have already seen in a block, but it is already only optimistic\r\n(depending on the outputs not being spent), so make it even more efficient by\r\nonly checking the cache and not the entire pcoinsTip.\r\n\r\n@sipa this is my biggest feedback to #10195 \r\n\r\nFor a single valid tx with 500 outputs in regtest on a machine with an SSD, the time to ATMP dropped from 4 ms to 2.4 ms.\r\n",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 1,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10557/comments",
   "created_at" : "2017-06-08T15:31:54Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10557/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/10557",
   "id" : 234567510,
   "labels" : [
      {
         "color" : "6060aa",
         "default" : false,
         "id" : 118379652,
         "name" : "Validation",
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/labels/Validation"
      }
   ],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10557/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 10557,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/10557.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/10557",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/10557.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Make check to distinguish between orphan txs and old txs more efficient.",
   "updated_at" : "2017-06-08T23:23:39Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/10557",
   "user" : {
      "avatar_url" : "https://avatars1.githubusercontent.com/u/4360349?v=3",
      "events_url" : "https://api.github.com/users/morcos/events{/privacy}",
      "followers_url" : "https://api.github.com/users/morcos/followers",
      "following_url" : "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url" : "https://api.github.com/users/morcos/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/morcos",
      "id" : 4360349,
      "login" : "morcos",
      "organizations_url" : "https://api.github.com/users/morcos/orgs",
      "received_events_url" : "https://api.github.com/users/morcos/received_events",
      "repos_url" : "https://api.github.com/users/morcos/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/morcos/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/morcos"
   }
}
