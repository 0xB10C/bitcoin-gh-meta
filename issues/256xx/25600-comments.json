[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> The first commit introduces a NODE_REPLACE_BY_FEE service flag to advertise support of full-rbf to our peers if https://github.com/bitcoin/bitcoin/pull/25353 is set to true. From the results of getpeerinfo or getnetworkinfo, a node operator can find full-rbf peers on the p2p network to which to manually connect to. The service flag bit select is the 26th one to be compatible with previous full-rbf [experiences](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2022-June/020570.html).\r\n\r\nIsn't this bad for privacy?",
      "created_at" : "2022-07-13T02:18:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1182690419",
      "id" : 1182690419,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585Gfmxz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182690419/reactions"
      },
      "updated_at" : "2022-07-13T02:18:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182690419",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#24170](https://github.com/bitcoin/bitcoin/pull/24170) (p2p, rpc: Manual block-relay-only connections with addnode by mzumsande)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-07-13T06:03:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1182801396",
      "id" : 1182801396,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585GgB30",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182801396/reactions"
      },
      "updated_at" : "2022-08-11T23:38:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1182801396",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Isn't this bad for privacy?\r\n\r\nI think a mass-spying node could automatically connect to a node and broadcast an opt-out transaction then a higher-fee replacement one to detect if `mempoolfullrbf=1` and wait if a inv(replacement_txid) is announced to a monitoring peer. So turning on bit 26 to signal `NODE_REPLACE_BY_FEE`  sounds to me at worst makes such \"fingerprint\" cheaper. Though by definition policy is a source of transaction processing discrepancy between nodes, so I'm not sure we can even qualify that as a fingerprint.\r\n\r\nThe other concern could be a few spying `NODE_REPLACE_BY_FEE` public peers attracting inbound connection from honest peers, getting a better leverage of initial-broadcast. If it's a qualified concern, we could announce replacement transactions only to those peers thus avoiding any privacy interferences with the node usual transaction traffic.\r\n\r\nThough if you have more transaction-relay deanonymization attacks in mind, I'm listening.",
      "created_at" : "2022-07-14T00:18:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1183805137",
      "id" : 1183805137,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585Gj27R",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1183805137/reactions"
      },
      "updated_at" : "2022-07-14T00:18:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1183805137",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think a mass-spying node could automatically connect to a node and broadcast an opt-out transaction then a higher-fee replacement one to detect if mempoolfullrbf=1 and wait if a inv(replacement_txid) is announced to a monitoring peer. So turning on bit 26 to signal NODE_REPLACE_BY_FEE sounds to me at worst makes such \"fingerprint\" cheaper. \r\n\r\nService flag makes it easier to make a list of nodes with full RBF policy. These nodes could be banned or this information can be used in different attacks. I don't think it is required, requesting LN users and some miners to use full RBF would be enough.\r\n\r\n![image](https://user-images.githubusercontent.com/94559964/178968830-afe4e395-6981-42ea-94bb-64a306299eae.png)\r\n\r\nWriting 'help' if lost on an island could result in 2 things:\r\n\r\n1. An aircraft or chopper notices and helps you\r\n2. Someone else finds you alone, looking for help, tries to exploit and kill you\r\n\r\n> The other concern could be a few spying NODE_REPLACE_BY_FEE public peers attracting inbound connection from honest peers, getting a better leverage of initial-broadcast. If it's a qualified concern, we could announce replacement transactions only to those peers thus avoiding any privacy interferences with the node usual transaction traffic.\r\n\r\nThis is a good point which I did not consider earlier though I am not sure about announcing replacement transactions only to those peers.\r\n",
      "created_at" : "2022-07-14T11:12:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1184317227",
      "id" : 1184317227,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585Glz8r",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1184317227/reactions"
      },
      "updated_at" : "2022-07-14T11:12:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1184317227",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "~~At the very least, this needs a BIP. Unsure about using the temporary bit for it, and also not sure if it makes sense conceptually; it's just a minor policy change, after all.~~\r\n\r\nEdit: Or just mark it as a temporary service bit like existing usage does",
      "created_at" : "2022-07-14T19:13:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1184804560",
      "id" : 1184804560,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585Gnq7Q",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1184804560/reactions"
      },
      "updated_at" : "2022-07-15T01:08:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1184804560",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@1440000bytes \r\n\r\n> Service flag makes it easier to make a list of nodes with full RBF policy. These nodes could be banned or this information can be used in different attacks. I don't think it is required, requesting LN users and some miners to use full RBF would be enough.\r\n\r\nWell that's a fundamental trade-off between signaling policy to ease peering and retaining information. I think the relevant question is this _additional_ information allow or significantly ease a concrete attack against node operator or funds safety. That said, even if the attack is qualified, the risk could be bearable by the operator, if the documentation is clear in that sense. E.g, in LN we recently specified out [zero-conf channels](https://github.com/lightning/bolts/pull/910), they're coming with a lot of safety tradeoffs, though they're a UX improvement for sure.\r\n\r\n> Writing 'help' if lost on an island could result in 2 things:\r\n>    An aircraft or chopper notices and helps you\r\n>    Someone else finds you alone, looking for help, tries to exploit and kill you\r\n\r\nBeware life is risky :)\r\n\r\n> This is a good point which I did not consider earlier though I am not sure about announcing replacement transactions only to those peers.\r\n\r\nIn case of uncertain privacy/security risks, security-by-compartmentalization.\r\n\r\n@luke-jr \r\n\r\n> Edit: Or just mark it as a temporary service bit like existing usage does\r\n\r\nWell, I used the same experimental bit 26 than the patchset from @petertodd. Let me know if you think I should use another one in the range bits 24-31 because of conflicts with existent bitcoin softwares.",
      "created_at" : "2022-07-25T23:19:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1194758364",
      "id" : 1194758364,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585HNpDc",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1194758364/reactions"
      },
      "updated_at" : "2022-07-25T23:19:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1194758364",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r929394210"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929394210"
         }
      },
      "author_association" : "MEMBER",
      "body" : "```suggestion\r\n    case NODE_REPLACE_BY_FEE:  return \"REPLACE_BY_FEE?\";\r\n```",
      "commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "created_at" : "2022-07-25T23:40:22Z",
      "diff_hunk" : "@@ -196,6 +196,7 @@ static std::string serviceFlagToStr(size_t bit)\n     case NODE_WITNESS:         return \"WITNESS\";\n     case NODE_COMPACT_FILTERS: return \"COMPACT_FILTERS\";\n     case NODE_NETWORK_LIMITED: return \"NETWORK_LIMITED\";\n+    case NODE_REPLACE_BY_FEE:  return \"FULL_RBF\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r929394210",
      "id" : 929394210,
      "line" : 199,
      "node_id" : "PRRC_kwDOABII5843ZW4i",
      "original_commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "original_line" : 199,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/protocol.cpp",
      "position" : 4,
      "pull_request_review_id" : 1050196502,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929394210/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-07-25T23:40:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/929394210",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@mzumsande\r\n\r\nFor more perspective, I would like to recall that seeing full-rbf more deployed on the p2p network makes multi-party funded transactions more robust, at the price of zero-conf transactions accepting services more vulnerable to double-spend attacks. I think it raises an interesting question, in the sense of how as the Bitcoin Core project we should weight for a policy A or policy B offering different set of impacts on Bitcoin applications. In my opinion, the discussions can be tie-breaked on the hard physics of the system and recognizing there is no such thing as a global mempool in a distributed system therefore making assumptions on transactions ordering is inherently unsafe.\r\n\r\nAll of that to say I would like not to adopt a game theory reasoning framework, as ultimately game theory, at least zero-sum games, relies on the assumption of moves triggered by set of players in the pursuit of a gain, at the detriment of the other subsets. I'm thinking more of this change as a \"organic\" policy release engineering practice, namely giving the tools to the node operators to progressively activate full-rbf and build the full-rbf supporting routes. Even if we can assume a active subset of node operators quickly picking up the changes, social inertia being it won't happen overnight. This should give time for zero-conf transactions accepting services to either deprecate this mode of payment or moving to safe instant payments like LN or deploy (non-perfect) distributed mempools monitoring system.\r\n\r\nHowever, I acknowledge this is an ideal policy release practice, and adding automatic preferential peering might be too much a strong statement, or the timing is too short (let's give another buffer release before to introduce automatic preferential peering ?), or we should give more time to express technical dissent from zero-conf services providers or anyone else. Posting on the mailing list was done on this purpose.\r\n\r\nBeyond, I think this discussion is still interesting even in the lack of policy reversal like with full-rbf when we deploy new transaction-relay policy changes (e.g Erlay, package-relay, new RBF rules), we might firewall the new policy changes behind settings to observe first the performance, privacy-preserving or robustness properties of new features. We could clean up the added code complexity when we estimate the feature as mature.\r\n\r\nI think it's interesting to have a robust connectivity model of the p2p network, with factors like percentage `p` of nodes that need to support the new features and the chance threshold for success. I think we would enrich such model with the set of mempools miners among the let's say 10k listening peers (maybe Stratum v2 might change some assumptions ?). About false signaling, I think we might reduce it to buggy signaling and includes some factor `f`. I believe a mitigation against false signaling could be to run a scrapper testing the effectiveness of full-rbf and noting the peers address, however the dissemination of such information of \"misbehaving\" peers if relied on centralized/semi-centralized sources like DNS seeds is more likely to be more harmful than beneficial.",
      "created_at" : "2022-07-26T01:08:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1194851844",
      "id" : 1194851844,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585HN_4E",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1194851844/reactions"
      },
      "updated_at" : "2022-07-26T01:08:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1194851844",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r934430337"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/934430337"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is getting out of scope for this review. But as an aside, IIUC this function includes manually added connections in its max connections count. I'm not sure that's correct. If I manually add a bunch of nodes that match some category, that doesn't necessarily mean I _only_ want my node connecting to the manually added nodes.",
      "commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "created_at" : "2022-08-01T11:36:30Z",
      "diff_hunk" : "@@ -1053,6 +1053,8 @@ bool CConnman::AddConnection(const std::string& address, ConnectionType conn_typ\n     case ConnectionType::BLOCK_RELAY:\n         max_connections = m_max_outbound_block_relay;\n         break;\n+    case ConnectionType::FULLRBF:\n+        max_connections = m_max_outbound_fullrbf_relay;\n     // no limit for ADDR_FETCH because -seednode has no limit either",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r934430337",
      "id" : 934430337,
      "line" : 1058,
      "node_id" : "PRRC_kwDOABII5843skaB",
      "original_commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "original_line" : 1058,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 6,
      "pull_request_review_id" : 1057155947,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/934430337/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-01T11:44:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/934430337",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r934434602"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/934434602"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I believe this should be higher. With just ~1 full-RBF peer per node, a full-RBF tx is propagating in a network that is \"chain-like\". At each propagation step, the # of new nodes receiving the tx will be approximately one.\r\n\r\nYou should set this higher, to 4 or so, to ensure that propagation is \"exponential\" in nature, with each propagating step reaching more and more nodes.",
      "commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "created_at" : "2022-08-01T11:42:14Z",
      "diff_hunk" : "@@ -64,6 +64,8 @@ static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n static const unsigned int MAX_SUBVERSION_LENGTH = 256;\n /** Maximum number of automatic outgoing nodes over which we'll relay everything (blocks, tx, addrs, etc) */\n static const int MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8;\n+/** Maximum number of automatic fullrbf peers */\n+static const int MAX_FULLRBF_RELAY_CONNECTIONS = 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r934434602",
      "id" : 934434602,
      "line" : 68,
      "node_id" : "PRRC_kwDOABII5843slcq",
      "original_commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "original_line" : 68,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : 5,
      "pull_request_review_id" : 1057155947,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/934434602/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-01T11:44:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/934434602",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r934436213"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/934436213"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It's also fine to call this service bit `NODE_FULL_RBF`. The `NODE_REPLACE_BY_FEE` name comes from code so old that the terminology hadn't been settled yet and opt-in-RBF didn't exist.",
      "commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "created_at" : "2022-08-01T11:44:18Z",
      "diff_hunk" : "@@ -196,6 +196,7 @@ static std::string serviceFlagToStr(size_t bit)\n     case NODE_WITNESS:         return \"WITNESS\";\n     case NODE_COMPACT_FILTERS: return \"COMPACT_FILTERS\";\n     case NODE_NETWORK_LIMITED: return \"NETWORK_LIMITED\";\n+    case NODE_REPLACE_BY_FEE:  return \"FULL_RBF\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r934436213",
      "id" : 934436213,
      "in_reply_to_id" : 929394210,
      "line" : 199,
      "node_id" : "PRRC_kwDOABII5843sl11",
      "original_commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "original_line" : 199,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/protocol.cpp",
      "position" : 4,
      "pull_request_review_id" : 1057155947,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/934436213/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-01T11:44:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/934436213",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I don't think it is required, requesting LN users and some miners to use full RBF would be enough.\r\n\r\nIt's not enough. As @mzumsande notes, you need a significant % of nodes supporting full-RBF propagation before txs propagate reliably; once the [percolation threshold](https://en.wikipedia.org/wiki/Percolation_theory) is reached propagation suddenly becomes quite reliable. Also, as per my review, connecting to a single full-RBF peer is insufficient to achieve good propagation.",
      "created_at" : "2022-08-01T11:46:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1201094011",
      "id" : 1201094011,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585Hlz17",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1201094011/reactions"
      },
      "updated_at" : "2022-08-01T11:46:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1201094011",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Service flag makes it easier to make a list of nodes with full RBF policy. These nodes could be banned or this information can be used in different attacks.\r\n\r\nBanning nodes in the Bitcoin P2P network is pretty much pointless, as transactions will just propagate around the ban. In fact, preferential peering helps mitigate that (minor) attack, by making it even more likely that transactions will successfully propagate around the ban.\r\n\r\nRe: attacking nodes with the service bit set, I had a similar version of this patch years ago, prior to the development of lightning when full-RBF was much more contentious. To the best of my knowledge no-one ever attacked any full-RBF-advertising nodes.",
      "created_at" : "2022-08-01T11:53:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1201100949",
      "id" : 1201100949,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585Hl1iV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1201100949/reactions"
      },
      "updated_at" : "2022-08-01T11:53:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1201100949",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r936658472"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/936658472"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh, actually, looks like this code doesn't do anything in practice, as `AddConnection` is only used by the `addconnection` RPC call.",
      "commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "created_at" : "2022-08-03T13:23:50Z",
      "diff_hunk" : "@@ -1053,6 +1053,8 @@ bool CConnman::AddConnection(const std::string& address, ConnectionType conn_typ\n     case ConnectionType::BLOCK_RELAY:\n         max_connections = m_max_outbound_block_relay;\n         break;\n+    case ConnectionType::FULLRBF:\n+        max_connections = m_max_outbound_fullrbf_relay;\n     // no limit for ADDR_FETCH because -seednode has no limit either",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r936658472",
      "id" : 936658472,
      "in_reply_to_id" : 934430337,
      "line" : 1058,
      "node_id" : "PRRC_kwDOABII58431EYo",
      "original_commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "original_line" : 1058,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 6,
      "pull_request_review_id" : 1060295251,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/936658472/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-03T13:23:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/936658472",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r936706902"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/936706902"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Oh right, that's correct my mistake. IMHO, we do have a confusing connection type with a \"flat\" approach instead of an attribute based one as argued previously in https://github.com/bitcoin/bitcoin/pull/18044#pullrequestreview-442115002. I'll fix that soon.",
      "commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "created_at" : "2022-08-03T14:03:30Z",
      "diff_hunk" : "@@ -1053,6 +1053,8 @@ bool CConnman::AddConnection(const std::string& address, ConnectionType conn_typ\n     case ConnectionType::BLOCK_RELAY:\n         max_connections = m_max_outbound_block_relay;\n         break;\n+    case ConnectionType::FULLRBF:\n+        max_connections = m_max_outbound_fullrbf_relay;\n     // no limit for ADDR_FETCH because -seednode has no limit either",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r936706902",
      "id" : 936706902,
      "in_reply_to_id" : 934430337,
      "line" : 1058,
      "node_id" : "PRRC_kwDOABII58431QNW",
      "original_commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "original_line" : 1058,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 6,
      "pull_request_review_id" : 1060368093,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/936706902/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-03T19:05:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/936706902",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r937895618"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937895618"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "You also have to take into account that each node makes 8 automatic outgoing connections that might by chance connect to more full-RBF peers. This chance becomes higher if more peers run full-RBF. So it really comes down to how small of a minority of supporting nodes we require for full-RBF to still work reliably. \r\n\r\nAlso note that increasing automatic outbound slots too much could be problematic if full-rbf was adopted by many nodes, because there might not be sufficient inbound capacity. Studies like https://arxiv.org/pdf/2108.00815v2.pdf (Fig. 3) suggest that a significant number of nodes already operate close to their maximum inbound capacity today.",
      "commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "created_at" : "2022-08-04T14:55:32Z",
      "diff_hunk" : "@@ -64,6 +64,8 @@ static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n static const unsigned int MAX_SUBVERSION_LENGTH = 256;\n /** Maximum number of automatic outgoing nodes over which we'll relay everything (blocks, tx, addrs, etc) */\n static const int MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8;\n+/** Maximum number of automatic fullrbf peers */\n+static const int MAX_FULLRBF_RELAY_CONNECTIONS = 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r937895618",
      "id" : 937895618,
      "in_reply_to_id" : 934434602,
      "line" : 68,
      "node_id" : "PRRC_kwDOABII58435ybC",
      "original_commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "original_line" : 68,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : 5,
      "pull_request_review_id" : 1062072333,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937895618/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-04T14:55:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/937895618",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Not sure if this is worth it. Now that the wallet/rpc signals for rbf by default already (to support fee bumping), this pull here would mostly benefit adversarial settings (such as lightning), where signalling isn't possible.\r\n\r\nSo assuming that in those adversarial settings there exits a direct connection to a fullrbf miner (either by running the code here, or with a manual `-connect`, or by pure chance, or whatever), we might as well turn on fullrbf by default. See also the first point in https://github.com/bitcoin/bitcoin/pull/25600#pullrequestreview-1041170369 : As long as there is one route to a fullrbf miner, fullrbf txs will eventually be confirmed, regardless of the fullrbf setting of all other nodes outside the route.",
      "created_at" : "2022-08-04T16:24:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1205481722",
      "id" : 1205481722,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585H2jD6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1205481722/reactions"
      },
      "updated_at" : "2022-08-04T16:24:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1205481722",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> So assuming that in those adversarial settings there exits a direct connection to a fullrbf miner\r\n\r\nThough this patch avoids the necessity of full-rbf miners identifying themselves, as well as make it easy to use multiple full-rbf miners at once. Without full-rbf by default, this is definitely the next best thing.\r\n\r\n> we might as well turn on fullrbf by default.\r\n\r\nMy preference as well.",
      "created_at" : "2022-08-04T17:01:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1205529190",
      "id" : 1205529190,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585H2upm",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1205529190/reactions"
      },
      "updated_at" : "2022-08-04T17:01:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1205529190",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r938047292"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/938047292"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> You also have to take into account that each node makes 8 automatic outgoing connections that might by chance connect to more full-RBF peers.\r\n\r\nThe chance is pretty low at small %'s of full-RBF nodes. I know none of my nodes were connected to RBF-advertising peers by accident without this patch.\r\n\r\n> Also note that increasing automatic outbound slots too much could be problematic if full-rbf was adopted by many nodes\r\n\r\nI think that's quite unlikely. I highly doubt more than a few % of nodes would enable this manually. Meanwhile, once a few % of nodes and miners have, any remaining arguments against enabling full-rbf by default are certainly bunk, as getting non-opt-in replacements mined will be easy.",
      "commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "created_at" : "2022-08-04T17:04:13Z",
      "diff_hunk" : "@@ -64,6 +64,8 @@ static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n static const unsigned int MAX_SUBVERSION_LENGTH = 256;\n /** Maximum number of automatic outgoing nodes over which we'll relay everything (blocks, tx, addrs, etc) */\n static const int MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8;\n+/** Maximum number of automatic fullrbf peers */\n+static const int MAX_FULLRBF_RELAY_CONNECTIONS = 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r938047292",
      "id" : 938047292,
      "in_reply_to_id" : 934434602,
      "line" : 68,
      "node_id" : "PRRC_kwDOABII58436Xc8",
      "original_commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "original_line" : 68,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : 5,
      "pull_request_review_id" : 1062305840,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/938047292/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-04T17:04:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/938047292",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "FYI I tried setting `MAX_FULLRBF_RELAY_CONNECTIONS = 4` on three of my nodes, and if that's all you do they don't reliably connect to more than one full-rbf node no matter how long the node runs, even though there are a bunch of them on the network. Secondly, as I expected, transactions don't reliably propagate between full-RBF nodes with just one full-RBF peer.\r\n\r\nPutting the `conn_type` if clause higher up in precedence does fix this problem; right now connecting to full-rbf peers has lower precedence than feeler connections.",
      "created_at" : "2022-08-04T17:24:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1205553461",
      "id" : 1205553461,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585H20k1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1205553461/reactions"
      },
      "updated_at" : "2022-08-04T17:24:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1205553461",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Even if its made default without rationale and usage, there will be lot of nodes that are running older versions with no full rbf. Most of the nodes are not even using v23.0 right now based on @luke-jr [charts][1] and [shodan][2]:\r\n\r\n![image](https://user-images.githubusercontent.com/94559964/182968827-3c438362-aec1-459d-804e-86bbc5c69d24.png)\r\n\r\n[1]: https://luke.dashjr.org/programs/bitcoin/files/charts/security.html\r\n[2]: https://www.shodan.io/search/facet.png?query=User-Agent%3A+%2FSatoshi&facet=product\r\n",
      "created_at" : "2022-08-04T22:58:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1205848983",
      "id" : 1205848983,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585H38uX",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1205848983/reactions"
      },
      "updated_at" : "2022-08-04T22:58:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1205848983",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r953200629"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953200629"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Renamed to `NODE_FULL_RBF`. ",
      "commit_id" : "36225348fef43082513d725b71957f53659f9eb4",
      "created_at" : "2022-08-24T00:01:54Z",
      "diff_hunk" : "@@ -196,6 +196,7 @@ static std::string serviceFlagToStr(size_t bit)\n     case NODE_WITNESS:         return \"WITNESS\";\n     case NODE_COMPACT_FILTERS: return \"COMPACT_FILTERS\";\n     case NODE_NETWORK_LIMITED: return \"NETWORK_LIMITED\";\n+    case NODE_REPLACE_BY_FEE:  return \"FULL_RBF\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r953200629",
      "id" : 953200629,
      "in_reply_to_id" : 929394210,
      "line" : null,
      "node_id" : "PRRC_kwDOABII58440K_1",
      "original_commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "original_line" : 199,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/protocol.cpp",
      "position" : null,
      "pull_request_review_id" : 1082963395,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953200629/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-24T00:01:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953200629",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r953204864"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953204864"
         }
      },
      "author_association" : "MEMBER",
      "body" : "As you raised, manually adding a bunch of nodes shouldn't necessarily mean that you only want your node to connect to manually added nodes, as you might like to profit from the automatic discovery and connecting logic. It sounds really artificial for us to constraint node operators in their peers topology when there is a deliberate choice to deviate from the spontaneous topology generated by `ThreadOpenConnections`.\r\n\r\nThat said, this approach of enforcing connection limits controls on the types of connection is already what is implemented by `AddConnection`, not subjecting outbound full-rbf peers to limits control would deviate from that behavior. So I think the real discussion we should have would be about if those checks make really sense in `ThreadOpenConnections`. Though as it's a point preceding this PR, I would leave as it is.\r\n\r\nBeyond, I wonder if that really matters as `addconnection` is regtest-only (cf. L347, in `src/rpc/net.cpp`).",
      "commit_id" : "36225348fef43082513d725b71957f53659f9eb4",
      "created_at" : "2022-08-24T00:13:27Z",
      "diff_hunk" : "@@ -1053,6 +1053,8 @@ bool CConnman::AddConnection(const std::string& address, ConnectionType conn_typ\n     case ConnectionType::BLOCK_RELAY:\n         max_connections = m_max_outbound_block_relay;\n         break;\n+    case ConnectionType::FULLRBF:\n+        max_connections = m_max_outbound_fullrbf_relay;\n     // no limit for ADDR_FETCH because -seednode has no limit either",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r953204864",
      "id" : 953204864,
      "in_reply_to_id" : 934430337,
      "line" : 1058,
      "node_id" : "PRRC_kwDOABII58440MCA",
      "original_commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "original_line" : 1058,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 6,
      "pull_request_review_id" : 1082968895,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953204864/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-24T00:13:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953204864",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r953229459"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953229459"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think the chances to be connected to a full-rbf subgraph by relying only on the 8 automatic outgoing connections sounds really low, even assuming you're a listening node. If you model something with ~60k nodes, ~125 connection slots and 100 full-rbf nodes across the network, the success probability is like what ~1/60 ? This could explain the observed lack of RBF-advertising peers connections.\r\n\r\nThinking back to the model laid out above, rather to define success as the existence of a full-rbf route between two full-rbf supporting nodes another success definition could be the propagation of a full-rbf tx among the quasi-unanimity of the full-rbf peers. Therefore to achieve success we should aim to eradicate disconnected graphs of full-rbf peers. The exact value of `MAX_FULLRBF_RELAY_CONNECTIONS` would be function of the set size of peers we assume enabling full-rbf by option.\r\n\r\nI think the concern about increased consumption of inbound capacity is qualified, however I would say best we can do is giving us a slot budget. I.e assuming a set size of full-rbf peers, a number of new automatic outbound connections and an occupation rate of the inbound slots of the listening peers and gauge if the result is acceptable. ",
      "commit_id" : "36225348fef43082513d725b71957f53659f9eb4",
      "created_at" : "2022-08-24T01:12:08Z",
      "diff_hunk" : "@@ -64,6 +64,8 @@ static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n static const unsigned int MAX_SUBVERSION_LENGTH = 256;\n /** Maximum number of automatic outgoing nodes over which we'll relay everything (blocks, tx, addrs, etc) */\n static const int MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8;\n+/** Maximum number of automatic fullrbf peers */\n+static const int MAX_FULLRBF_RELAY_CONNECTIONS = 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r953229459",
      "id" : 953229459,
      "in_reply_to_id" : 934434602,
      "line" : null,
      "node_id" : "PRRC_kwDOABII58440SCT",
      "original_commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "original_line" : 68,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 1083000765,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953229459/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-24T01:12:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953229459",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Sorry for the delay, updated at 3622534 with few changes.\r\n\r\nFrom my understanding, there are few conceptual viewpoints expressed about this change. One is to argue that releasing a full-rbf service bit and corresponding automatic preferential peering is a strong statement in the wide deployment of full-rbf and a more neutral position should be adopted by the project, at least for now. Another one would be shortcut the added complexity and go directly to turn on fullrbf by default. A last viewpoint would be to release only the p2p tools for a node operator to opt and enforce the replacement policy adequate for its application, without aiming for coordinated deployment network-wide.\r\n\r\nTo be clear, I'm still favoring the latest viewpoint, as in light of a more complex ecosystem, I think we should aim for gradual deployment of new policy rules, not only to experiment the robustness/privacy/performance of the changes themselves but also to enable gradual adaptions of the node operators and Bitcoin services. I think stability and previsibility of our p2p and policy rules matter.",
      "created_at" : "2022-08-24T01:29:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1225064831",
      "id" : 1225064831,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585JBQF_",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225064831/reactions"
      },
      "updated_at" : "2022-08-24T01:29:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225064831",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">One is to argue that releasing a full-rbf service bit and corresponding automatic preferential peering is a strong statement in the wide deployment of full-rbf and a more neutral position should be adopted by the project, at least for now.\r\n\r\nThis doesn't make sense. The current de facto \"position\" is *anti*-RBF. Making it an option disabled by default is the very *minimum* to be neutral.\r\n\r\n>I think we should aim for gradual deployment of new policy rules\r\n\r\nThis isn't a new rule to the network, just Core. Knots and other software have supported it for years.\r\n\r\n> I think stability and previsibility of our p2p and policy rules matter.\r\n\r\nPolicy is primarily a per-node matter, not really a per-software matter.\r\n\r\nP.S. Don't forget to rename the PR",
      "created_at" : "2022-08-24T01:37:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1225070640",
      "id" : 1225070640,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585JBRgw",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225070640/reactions"
      },
      "updated_at" : "2022-08-24T01:37:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225070640",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r953817909"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953817909"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "> The exact value of `MAX_FULLRBF_RELAY_CONNECTIONS` would be function of the set size of peers we assume enabling full-rbf by option.\r\n\r\nNo, that's not how this works. Since we're doing preferential peering, the total number of peers with full-rbf on the network isn't relevant. We simply need a figure high enough that a sufficient number of full-rbf-signalling peers we connect to are in fact, actuall full-rbf peers that likewise have preferential peering. Second, by \"sufficient number\", we need something greater than 1 so we end up with a well-connected group rather than disconnected chains. 4+ should be fine.\r\n\r\nSo the actual figure we care about is what % of peers with the full-rbf service bit set are running this code (or something like it)? There are a handful of nodes running Knots that advertise the service bit but don't do preferential peering. Once a reasonable number of people (a few dozen) use this flag, they probably won't matter as AFAICT there's less than half a dozen such Knots-running nodes.",
      "commit_id" : "36225348fef43082513d725b71957f53659f9eb4",
      "created_at" : "2022-08-24T13:40:39Z",
      "diff_hunk" : "@@ -64,6 +64,8 @@ static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n static const unsigned int MAX_SUBVERSION_LENGTH = 256;\n /** Maximum number of automatic outgoing nodes over which we'll relay everything (blocks, tx, addrs, etc) */\n static const int MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8;\n+/** Maximum number of automatic fullrbf peers */\n+static const int MAX_FULLRBF_RELAY_CONNECTIONS = 1;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r953817909",
      "id" : 953817909,
      "in_reply_to_id" : 934434602,
      "line" : null,
      "node_id" : "PRRC_kwDOABII58442hs1",
      "original_commit_id" : "bbc5d58e41a922db975821b2712b5a00ab228d06",
      "original_line" : 68,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : null,
      "pull_request_review_id" : 1083836904,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953817909/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-24T13:40:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/953817909",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think we should aim for gradual deployment of new policy rules, not only to experiment the robustness/privacy/performance of the changes themselves but also to enable gradual adaptions of the node operators and Bitcoin services.\r\n\r\nTo be clear, we always have a gradual deployment because adoption of new Bitcoin Core releases is always a gradual process. Just enabling full-rbf by default would be a gradual deployment from that point of view.\r\n\r\nOn the other hand, if you're talking about gradual deployment in the sense of new transaction types getting to miners, we always have a _non_ gradual deployment if preferential peering is not used. Because the math behind percolation means that there is a sharp transition between \"not enough nodes to reliably propagate\" and \"enough nodes to reliably propagate\"",
      "created_at" : "2022-08-24T13:52:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1225758166",
      "id" : 1225758166,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585JD5XW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225758166/reactions"
      },
      "updated_at" : "2022-08-24T13:52:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225758166",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> I think we should aim for gradual deployment of new policy rules, not only to experiment the robustness/privacy/performance of the changes themselves but also to enable gradual adaptions of the node operators and Bitcoin services.\r\n\r\nTo be clear, we always have a gradual deployment because adoption of new Bitcoin Core releases is always a gradual process. Just enabling full-rbf by default would be a gradual deployment from that point of view.\r\n\r\nOn the other hand, if you're talking about gradual deployment in the sense of new transaction types getting to miners, we always have a _non_ gradual deployment if preferential peering is not used. Because the math behind percolation means that there is a sharp transition between \"not enough nodes to reliably propagate\" and \"enough nodes to reliably propagate\"",
      "created_at" : "2022-08-24T13:54:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1225760869",
      "id" : 1225760869,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585JD6Bl",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225760869/reactions"
      },
      "updated_at" : "2022-08-24T13:54:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1225760869",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=4",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "node_id" : "MDQ6VXNlcjcwNDI=",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r956777041"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/956777041"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The switch statement in `ConnectionTypeToQString` in `guituil.cpp` needs an update too (this is why the CI fails).",
      "commit_id" : "36225348fef43082513d725b71957f53659f9eb4",
      "created_at" : "2022-08-28T20:20:40Z",
      "diff_hunk" : "@@ -74,6 +74,12 @@ enum class ConnectionType {\n      * AddrMan is empty.\n      */\n     ADDR_FETCH,\n+\n+    /**\n+     * Full-rbf connections are long-lived connections used to relay transactions\n+     * with peers accepting replacement without requiring replaceability signaling.\n+     */\n+    FULLRBF,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r956777041",
      "id" : 956777041,
      "line" : 82,
      "node_id" : "PRRC_kwDOABII5845B0JR",
      "original_commit_id" : "36225348fef43082513d725b71957f53659f9eb4",
      "original_line" : 82,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/node/connection_types.h",
      "position" : 9,
      "pull_request_review_id" : 1087908750,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/956777041/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-28T21:06:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/956777041",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r956781843"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/956781843"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "There is a `break` missing, so this would fallthrough.",
      "commit_id" : "36225348fef43082513d725b71957f53659f9eb4",
      "created_at" : "2022-08-28T21:06:25Z",
      "diff_hunk" : "@@ -1053,6 +1053,8 @@ bool CConnman::AddConnection(const std::string& address, ConnectionType conn_typ\n     case ConnectionType::BLOCK_RELAY:\n         max_connections = m_max_outbound_block_relay;\n         break;\n+    case ConnectionType::FULLRBF:\n+        max_connections = m_max_outbound_fullrbf_relay;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r956781843",
      "id" : 956781843,
      "line" : 1057,
      "node_id" : "PRRC_kwDOABII5845B1UT",
      "original_commit_id" : "36225348fef43082513d725b71957f53659f9eb4",
      "original_line" : 1057,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 5,
      "pull_request_review_id" : 1087908750,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/956781843/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-28T21:06:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/956781843",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I will reply to the summary of arguments from [this comment](https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1225064831).\r\n\r\n>releasing a full-rbf service bit and corresponding automatic preferential peering is a strong statement in the wide deployment of full-rbf and a more neutral position should be adopted by the project, at least for now\r\n\r\nI think a service bit enabled by a `fullrbf` flag that defaults to false is not a strong statement. It just allows those nodes which chose this policy to do better peering.\r\n\r\n>Another one would be shortcut the added complexity and go directly to turn on fullrbf by default.\r\n\r\nThis is a hard part for me. The opponents of `fullrbf` have expectations about their zero-conf transactions. This would destroy them right away I guess. But so does this PR, if it succeeds to achieve its goals? And my expectation is that this is just a matter of time. In practice, their expectations could be destroyed even by interested parties (LN, etc.) connecting to miners directly (assuming they run `fullrbf`).\r\nSo it seems like the main question of this alternative is how it looks politically, even though opt-in will go away one way or another.\r\n\r\n>to release only the p2p tools for a node operator to opt and enforce the replacement policy adequate for its application, without aiming for coordinated deployment network-wide.\r\n\r\n1. I don't think it really saves us much code complexity (diff is minimal).\r\n2. Politically, if this PR approach saves us some bikeshedding, sure.\r\n3. Do I miss anything?",
      "created_at" : "2022-08-29T07:32:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1229892249",
      "id" : 1229892249,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585JTqqZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1229892249/reactions"
      },
      "updated_at" : "2022-08-29T07:32:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1229892249",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r957464015"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/957464015"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "To be clear, the idea is to have 4 additional full-rbf outbound connections, in addition to the 8 full-outbound and 2 block-relay-only connections, correct?\r\nI think this isn't currently working as intended, because `m_max_outbound` (which sets the number of semaphores for outbound connections) is not adjusted in `CConnman::Init()`, so we'd currently make just 1 full-rbf connection (and stop making feelers completely).\r\n\r\nAlso, the commit msg, OP and PR title should be updated from 1 to 4.",
      "commit_id" : "36225348fef43082513d725b71957f53659f9eb4",
      "created_at" : "2022-08-29T15:08:43Z",
      "diff_hunk" : "@@ -64,6 +64,8 @@ static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n static const unsigned int MAX_SUBVERSION_LENGTH = 256;\n /** Maximum number of automatic outgoing nodes over which we'll relay everything (blocks, tx, addrs, etc) */\n static const int MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8;\n+/** Maximum number of automatic fullrbf peers */\n+static const int MAX_FULLRBF_RELAY_CONNECTIONS = 4;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r957464015",
      "id" : 957464015,
      "line" : 68,
      "node_id" : "PRRC_kwDOABII5845Eb3P",
      "original_commit_id" : "36225348fef43082513d725b71957f53659f9eb4",
      "original_line" : 68,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : 5,
      "pull_request_review_id" : 1088882624,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/957464015/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-29T15:20:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/957464015",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> This would destroy them right away I guess. \r\n\r\nIt really depends on user uptake, which is the primary difference here. If preferential peering ends up destroying whatever is left of zero-conf security, it would be done by some critical mass of users and miners opting into the new behavior. If it's universally rejected by users and miners, then it's a no-op. If it has significant uptake, we can revisit ripping out the additional complexity in follow-on release.",
      "created_at" : "2022-08-29T15:53:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1230504946",
      "id" : 1230504946,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585JWAPy",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1230504946/reactions"
      },
      "updated_at" : "2022-08-29T15:53:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1230504946",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r957643616"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/957643616"
         }
      },
      "author_association" : "MEMBER",
      "body" : "rearranging the lines and accumulating the proper value results in 4 connections (to knots nodes)",
      "commit_id" : "36225348fef43082513d725b71957f53659f9eb4",
      "created_at" : "2022-08-29T17:56:34Z",
      "diff_hunk" : "@@ -64,6 +64,8 @@ static const unsigned int MAX_PROTOCOL_MESSAGE_LENGTH = 4 * 1000 * 1000;\n static const unsigned int MAX_SUBVERSION_LENGTH = 256;\n /** Maximum number of automatic outgoing nodes over which we'll relay everything (blocks, tx, addrs, etc) */\n static const int MAX_OUTBOUND_FULL_RELAY_CONNECTIONS = 8;\n+/** Maximum number of automatic fullrbf peers */\n+static const int MAX_FULLRBF_RELAY_CONNECTIONS = 4;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#discussion_r957643616",
      "id" : 957643616,
      "in_reply_to_id" : 957464015,
      "line" : 68,
      "node_id" : "PRRC_kwDOABII5845FHtg",
      "original_commit_id" : "36225348fef43082513d725b71957f53659f9eb4",
      "original_line" : 68,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net.h",
      "position" : 5,
      "pull_request_review_id" : 1089137084,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/25600",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/957643616/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-08-29T17:57:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/957643616",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "\"zero-conf security\", outside of L2 solutions, has always been non-existent.",
      "created_at" : "2022-08-29T20:04:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1230803426",
      "id" : 1230803426,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585JXJHi",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 1,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1230803426/reactions"
      },
      "updated_at" : "2022-08-29T20:04:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1230803426",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Argument is that even if it existed, it evaporates on users opting into this feature. I'm taking the strongest position possible to work through the politics :)",
      "created_at" : "2022-08-29T20:10:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/25600#issuecomment-1230808492",
      "id" : 1230808492,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/25600",
      "node_id" : "IC_kwDOABII585JXKWs",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1230808492/reactions"
      },
      "updated_at" : "2022-08-29T20:10:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1230808492",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   }
]
