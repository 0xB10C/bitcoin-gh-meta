[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27375#discussion_r1154121825"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27375"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154121825"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think I'd go for `unix` here (but only because it's shorter).",
      "commit_id" : "7785e4d1796f3deb746916e6fc89f00990fb28cd",
      "created_at" : "2023-03-31T07:36:46Z",
      "diff_hunk" : "@@ -112,6 +112,7 @@ std::string GetNetworkName(enum Network net)\n     case NET_I2P: return \"i2p\";\n     case NET_CJDNS: return \"cjdns\";\n     case NET_INTERNAL: return \"internal\";\n+    case NET_UNIX: return \"unix_domain_socket\";",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27375#discussion_r1154121825",
      "id" : 1154121825,
      "line" : 115,
      "node_id" : "PRRC_kwDOABII585EyoBh",
      "original_commit_id" : "7785e4d1796f3deb746916e6fc89f00990fb28cd",
      "original_line" : 115,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/netbase.cpp",
      "position" : 4,
      "pull_request_review_id" : 1366408214,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27375",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154121825/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-31T09:01:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154121825",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27375#discussion_r1154147617"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27375"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154147617"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This needs to be shorter (< 92 chars?). From `man 7 unix`:\r\n\r\n```\r\n   Pathname sockets\r\n       When binding a socket to a pathname, a few rules should be observed for maximum portability and ease of coding:\r\n\r\n       *  The pathname in sun_path should be null-terminated.\r\n\r\n       *  The length of the pathname, including the terminating null byte, should not exceed the size of sun_path.\r\n\r\n       *  The addrlen argument that describes the enclosing sockaddr_un structure should have a value of at least:\r\n\r\n              offsetof(struct sockaddr_un, sun_path)+strlen(addr.sun_path)+1\r\n\r\n          or, more simply, addrlen can be specified as sizeof(struct sockaddr_un).\r\n\r\n       There is some variation in how implementations handle UNIX domain socket addresses that do not follow the above rules.  For example, some (but not all) implementations append a null terminator if none is present in the supplied\r\n       sun_path.\r\n\r\n       When coding portable applications, keep in mind that some implementations have sun_path as short as 92 bytes.\r\n```\r\n\r\nIt probably makes most sense to check this early on in _init.cpp_?",
      "commit_id" : "7785e4d1796f3deb746916e6fc89f00990fb28cd",
      "created_at" : "2023-03-31T07:59:36Z",
      "diff_hunk" : "@@ -89,13 +90,22 @@ def setup_nodes(self):\n         else:\n             self.log.warning(\"Testing without local IPv6 support\")\n \n+        socket_path = os.path.join(self.options.tmpdir, \"socket_path\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27375#discussion_r1154147617",
      "id" : 1154147617,
      "line" : 93,
      "node_id" : "PRRC_kwDOABII585EyuUh",
      "original_commit_id" : "7785e4d1796f3deb746916e6fc89f00990fb28cd",
      "original_line" : 93,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "test/functional/feature_proxy.py",
      "position" : 21,
      "pull_request_review_id" : 1366408214,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27375",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154147617/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-31T09:01:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154147617",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27375#discussion_r1154148265"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27375"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154148265"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "On the test this is trying to use a path `/private/var/folders/v7/fs2b0v3s0lz1n57gj9y4xb5m0000gn/T/cirrus-ci-build/ci/scratch/test_runner/test_runner_â¿_ð_20230331_010828/feature_proxy_156`...",
      "commit_id" : "7785e4d1796f3deb746916e6fc89f00990fb28cd",
      "created_at" : "2023-03-31T08:00:15Z",
      "diff_hunk" : "@@ -89,13 +90,22 @@ def setup_nodes(self):\n         else:\n             self.log.warning(\"Testing without local IPv6 support\")\n \n+        socket_path = os.path.join(self.options.tmpdir, \"socket_path\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27375#discussion_r1154148265",
      "id" : 1154148265,
      "in_reply_to_id" : 1154147617,
      "line" : 93,
      "node_id" : "PRRC_kwDOABII585Eyuep",
      "original_commit_id" : "7785e4d1796f3deb746916e6fc89f00990fb28cd",
      "original_line" : 93,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "test/functional/feature_proxy.py",
      "position" : 21,
      "pull_request_review_id" : 1366408214,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27375",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154148265/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-31T09:01:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154148265",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27375#discussion_r1154156655"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27375"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154156655"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I wonder if this should be a `Warning` or at least an `Info` level message?",
      "commit_id" : "7785e4d1796f3deb746916e6fc89f00990fb28cd",
      "created_at" : "2023-03-31T08:08:57Z",
      "diff_hunk" : "@@ -524,8 +524,10 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         } else if (use_proxy) {\n             sock = CreateSock(proxy.proxy);\n             if (!sock) {\n+                LogPrintLevel(BCLog::PROXY, BCLog::Level::Debug, \"Failed to create socket to proxy: %s\\n\", proxy.proxy.ToStringAddr());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27375#discussion_r1154156655",
      "id" : 1154156655,
      "line" : 527,
      "node_id" : "PRRC_kwDOABII585Eywhv",
      "original_commit_id" : "7785e4d1796f3deb746916e6fc89f00990fb28cd",
      "original_line" : 527,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 4,
      "pull_request_review_id" : 1366408214,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27375",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154156655/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-31T09:01:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154156655",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27375#discussion_r1154205583"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27375"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154205583"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Im curious why you didn't enable it for `-onion` here, as it seems a compartiviely small addtion:\r\n\r\n```diff\r\ndiff --git a/src/init.cpp b/src/init.cpp\r\nindex c0a320136..53b6b2a4b 100644\r\n--- a/src/init.cpp\r\n+++ b/src/init.cpp\r\n@@ -1283,8 +1283,8 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\r\n             std::string host_out;\r\n             uint16_t port_out{0};\r\n             if (!SplitHostPort(socket_addr, port_out, host_out)) {\r\n-                // Allow unix domain sockets for proxy e.g. unix:/some/file/path\r\n-                if (port_option != \"-proxy\" || socket_addr.find(ADDR_PREFIX_UNIX) != 0) {\r\n+                // Allow unix domain sockets for -proxy and -onion e.g. unix:/some/file/path\r\n+                if ((port_option != \"-proxy\" || port_option != \"-onion\") || socket_addr.find(ADDR_PREFIX_UNIX) != 0) {\r\n                     return InitError(InvalidPortErrMsg(port_option, socket_addr));\r\n                 }\r\n             }\r\n```",
      "commit_id" : "7785e4d1796f3deb746916e6fc89f00990fb28cd",
      "created_at" : "2023-03-31T08:48:07Z",
      "diff_hunk" : "@@ -1283,7 +1283,10 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n             std::string host_out;\n             uint16_t port_out{0};\n             if (!SplitHostPort(socket_addr, port_out, host_out)) {\n-                return InitError(InvalidPortErrMsg(port_option, socket_addr));\n+                // Allow unix domain sockets for proxy e.g. unix:/some/file/path\n+                if (port_option != \"-proxy\" || socket_addr.find(ADDR_PREFIX_UNIX) != 0) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27375#discussion_r1154205583",
      "id" : 1154205583,
      "line" : 1287,
      "node_id" : "PRRC_kwDOABII585Ey8eP",
      "original_commit_id" : "7785e4d1796f3deb746916e6fc89f00990fb28cd",
      "original_line" : 1287,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/init.cpp",
      "position" : 6,
      "pull_request_review_id" : 1366408214,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27375",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154205583/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "subject_type" : "line",
      "updated_at" : "2023-03-31T09:01:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1154205583",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   }
]
