[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK ",
      "created_at" : "2021-08-13T00:27:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#issuecomment-898061806",
      "id" : 898061806,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22693",
      "node_id" : "IC_kwDOABII5841h1Xu",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-13T00:27:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898061806",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r697381362"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697381362"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit - return type of `vector::size()` is `vector::size_type` which is `size_t` not `uint32_t`.",
      "commit_id" : "9fe79260cb7cdde75f4fce90f7615973a9233904",
      "created_at" : "2021-08-27T11:55:18Z",
      "diff_hunk" : "@@ -606,6 +607,59 @@ void CWallet::AddToSpends(const uint256& wtxid)\n         AddToSpends(txin.prevout, wtxid);\n }\n \n+void CWallet::UpdateAddressBookUsed(const CWalletTx& wtx)\n+{\n+    for (const auto& output : wtx.tx->vout) {\n+        CTxDestination dest;\n+        if (!ExtractDestination(output.scriptPubKey, dest)) continue;\n+        m_address_book[dest].m_used = true;\n+    }\n+}\n+\n+void CWallet::InitialiseAddressBookUsed()\n+{\n+    for (const auto& entry : mapWallet) {\n+        const CWalletTx& wtx = entry.second;\n+        UpdateAddressBookUsed(wtx);\n+    }\n+}\n+\n+bool CWallet::FindScriptPubKeyUsed(const std::set<CScript>& keys, const std::variant<std::monostate, std::function<void(const CWalletTx&)>, std::function<void(const CWalletTx&, uint32_t)>>& callback) const\n+{\n+    bool found_any = false;\n+    for (const auto& key : keys) {\n+        CTxDestination dest;\n+        if (!ExtractDestination(key, dest)) continue;\n+        const auto& address_book_it = m_address_book.find(dest);\n+        if (address_book_it == m_address_book.end()) continue;\n+        if (address_book_it->second.m_used) {\n+            found_any = true;\n+            break;\n+        }\n+    }\n+    if (!found_any) return false;\n+    if (std::holds_alternative<std::monostate>(callback)) return true;\n+\n+    found_any = false;\n+    for (const auto& entry : mapWallet) {\n+        const CWalletTx& wtx = entry.second;\n+        for (uint32_t i = 0; i < wtx.tx->vout.size(); ++i) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r697381362",
      "id" : 697381362,
      "line" : 646,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5NzM4MTM2Mg==",
      "original_commit_id" : "9fe79260cb7cdde75f4fce90f7615973a9233904",
      "original_line" : 646,
      "original_position" : 48,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 48,
      "pull_request_review_id" : 740440956,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-08-27T11:55:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/697381362",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2021-08-27T11:58:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#issuecomment-907148399",
      "id" : 907148399,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22693",
      "node_id" : "IC_kwDOABII5842Efxv",
      "performed_via_github_app" : null,
      "updated_at" : "2021-08-27T11:58:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/907148399",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/4500994?v=4",
         "events_url" : "https://api.github.com/users/kristapsk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kristapsk/followers",
         "following_url" : "https://api.github.com/users/kristapsk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kristapsk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kristapsk",
         "id" : 4500994,
         "login" : "kristapsk",
         "node_id" : "MDQ6VXNlcjQ1MDA5OTQ=",
         "organizations_url" : "https://api.github.com/users/kristapsk/orgs",
         "received_events_url" : "https://api.github.com/users/kristapsk/received_events",
         "repos_url" : "https://api.github.com/users/kristapsk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kristapsk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kristapsk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kristapsk"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#24699](https://github.com/bitcoin/bitcoin/pull/24699) (wallet: Improve AvailableCoins performance by reducing duplicated operations by achow101)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-09-09T17:33:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#issuecomment-916298781",
      "id" : 916298781,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22693",
      "node_id" : "IC_kwDOABII5842nZwd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/916298781/reactions"
      },
      "updated_at" : "2022-05-25T12:16:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/916298781",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased",
      "created_at" : "2021-12-18T23:50:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#issuecomment-997301052",
      "id" : 997301052,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22693",
      "node_id" : "IC_kwDOABII5847cZs8",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/997301052/reactions"
      },
      "updated_at" : "2021-12-18T23:50:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/997301052",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2021-12-29T01:44:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#issuecomment-1002355864",
      "id" : 1002355864,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22693",
      "node_id" : "IC_kwDOABII5847vryY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1002355864/reactions"
      },
      "updated_at" : "2021-12-29T01:44:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1002355864",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91535?v=4",
         "events_url" : "https://api.github.com/users/theStack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theStack/followers",
         "following_url" : "https://api.github.com/users/theStack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theStack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theStack",
         "id" : 91535,
         "login" : "theStack",
         "node_id" : "MDQ6VXNlcjkxNTM1",
         "organizations_url" : "https://api.github.com/users/theStack/orgs",
         "received_events_url" : "https://api.github.com/users/theStack/received_events",
         "repos_url" : "https://api.github.com/users/theStack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theStack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theStack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theStack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2022-02-01T20:02:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#issuecomment-1027234708",
      "id" : 1027234708,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22693",
      "node_id" : "IC_kwDOABII5849OluU",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027234708/reactions"
      },
      "updated_at" : "2022-02-01T20:02:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1027234708",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased again",
      "created_at" : "2022-02-09T07:52:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#issuecomment-1033451637",
      "id" : 1033451637,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22693",
      "node_id" : "IC_kwDOABII5849mTh1",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1033451637/reactions"
      },
      "updated_at" : "2022-02-09T07:52:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1033451637",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Concept ACK\r\n\r\ntACK 8719b084754b8346e1cb551843afd3afcd439b71\r\n\r\nGenerated a new address and verified there is no existing tx associated with it\r\n\r\n```\r\nbitcoin-cli getaddressinfo bcrt1qmdr8t0qu4xps0zu47n8206jsxzcpurh53f7de9\r\n{\r\n  \"address\": \"bcrt1qmdr8t0qu4xps0zu47n8206jsxzcpurh53f7de9\",\r\n  \"scriptPubKey\": \"0014db4675bc1ca983078b95f4cea7ea5030b01e0ef4\",\r\n  \"ismine\": false,\r\n  \"solvable\": false,\r\n  \"iswatchonly\": false,\r\n  \"isscript\": false,\r\n  \"iswitness\": true,\r\n  \"witness_version\": 0,\r\n  \"witness_program\": \"db4675bc1ca983078b95f4cea7ea5030b01e0ef4\",\r\n  \"ischange\": false,\r\n  \"labels\": [\r\n  ],\r\n  \"use_txids\": [\r\n  ]\r\n}\r\n```\r\n\r\nGenerated a new address and send to address\r\n\r\n```\r\nbitcoin-cli getaddressinfo bcrt1q23zuu74fshheztes967d26vgz6kutkv340st8a\r\n{\r\n  \"address\": \"bcrt1q23zuu74fshheztes967d26vgz6kutkv340st8a\",\r\n  \"scriptPubKey\": \"00145445ce7aa985ef912f302ebcd5698816adc5d991\",\r\n  \"ismine\": false,\r\n  \"solvable\": false,\r\n  \"iswatchonly\": false,\r\n  \"isscript\": false,\r\n  \"iswitness\": true,\r\n  \"witness_version\": 0,\r\n  \"witness_program\": \"5445ce7aa985ef912f302ebcd5698816adc5d991\",\r\n  \"ischange\": false,\r\n  \"labels\": [\r\n  ],\r\n  \"use_txids\": [\r\n    \"bf446b264f267ab6c0fd9fb8663945b80778cd3967de91acac80e60c7d040328\"\r\n  ]\r\n}\r\n```\r\n\r\nReused address to verify that both txids show up\r\n```\r\nbitcoin-cli getaddressinfo bcrt1q23zuu74fshheztes967d26vgz6kutkv340st8a\r\n{\r\n  \"address\": \"bcrt1q23zuu74fshheztes967d26vgz6kutkv340st8a\",\r\n  \"scriptPubKey\": \"00145445ce7aa985ef912f302ebcd5698816adc5d991\",\r\n  \"ismine\": false,\r\n  \"solvable\": false,\r\n  \"iswatchonly\": false,\r\n  \"isscript\": false,\r\n  \"iswitness\": true,\r\n  \"witness_version\": 0,\r\n  \"witness_program\": \"5445ce7aa985ef912f302ebcd5698816adc5d991\",\r\n  \"ischange\": false,\r\n  \"labels\": [\r\n  ],\r\n  \"use_txids\": [\r\n    \"cb41ac571ddde6622b0b00d1a39b95bfcf04b8d1f9513371d2918497691d611b\",\r\n    \"bf446b264f267ab6c0fd9fb8663945b80778cd3967de91acac80e60c7d040328\"\r\n  ]\r\n}\r\n```",
      "created_at" : "2022-04-30T05:38:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#issuecomment-1113922449",
      "id" : 1113922449,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22693",
      "node_id" : "IC_kwDOABII585CZRuR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1113922449/reactions"
      },
      "updated_at" : "2022-04-30T05:38:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1113922449",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91447896?v=4",
         "events_url" : "https://api.github.com/users/pk-b2/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pk-b2/followers",
         "following_url" : "https://api.github.com/users/pk-b2/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pk-b2/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pk-b2",
         "id" : 91447896,
         "login" : "pk-b2",
         "node_id" : "MDQ6VXNlcjkxNDQ3ODk2",
         "organizations_url" : "https://api.github.com/users/pk-b2/orgs",
         "received_events_url" : "https://api.github.com/users/pk-b2/received_events",
         "repos_url" : "https://api.github.com/users/pk-b2/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pk-b2/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pk-b2/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pk-b2"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r862305743"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862305743"
         }
      },
      "author_association" : "NONE",
      "body" : "Are there any guidelines when a response attribute should be optional vs always present?",
      "commit_id" : "8719b084754b8346e1cb551843afd3afcd439b71",
      "created_at" : "2022-04-30T05:39:18Z",
      "diff_hunk" : "@@ -541,6 +541,10 @@ RPCHelpMan getaddressinfo()\n                         {\n                             {RPCResult::Type::STR, \"label name\", \"Label name (defaults to \\\"\\\").\"},\n                         }},\n+                        {RPCResult::Type::ARR, \"use_txids\", \"\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r862305743",
      "id" : 862305743,
      "line" : 544,
      "node_id" : "PRRC_kwDOABII584zZb3P",
      "original_commit_id" : "8719b084754b8346e1cb551843afd3afcd439b71",
      "original_line" : 544,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/addresses.cpp",
      "position" : 4,
      "pull_request_review_id" : 958451252,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862305743/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-30T05:39:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862305743",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91447896?v=4",
         "events_url" : "https://api.github.com/users/pk-b2/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pk-b2/followers",
         "following_url" : "https://api.github.com/users/pk-b2/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pk-b2/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pk-b2",
         "id" : 91447896,
         "login" : "pk-b2",
         "node_id" : "MDQ6VXNlcjkxNDQ3ODk2",
         "organizations_url" : "https://api.github.com/users/pk-b2/orgs",
         "received_events_url" : "https://api.github.com/users/pk-b2/received_events",
         "repos_url" : "https://api.github.com/users/pk-b2/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pk-b2/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pk-b2/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pk-b2"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r862306508"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862306508"
         }
      },
      "author_association" : "NONE",
      "body" : "nit: Seems Initialize* with a Z is used across the code base",
      "commit_id" : "8719b084754b8346e1cb551843afd3afcd439b71",
      "created_at" : "2022-04-30T05:40:56Z",
      "diff_hunk" : "@@ -656,6 +657,59 @@ void CWallet::AddToSpends(const uint256& wtxid, WalletBatch* batch)\n         AddToSpends(txin.prevout, wtxid, batch);\n }\n \n+void CWallet::UpdateAddressBookUsed(const CWalletTx& wtx)\n+{\n+    for (const auto& output : wtx.tx->vout) {\n+        CTxDestination dest;\n+        if (!ExtractDestination(output.scriptPubKey, dest)) continue;\n+        m_address_book[dest].m_used = true;\n+    }\n+}\n+\n+void CWallet::InitialiseAddressBookUsed()",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r862306508",
      "id" : 862306508,
      "line" : 669,
      "node_id" : "PRRC_kwDOABII584zZcDM",
      "original_commit_id" : "8719b084754b8346e1cb551843afd3afcd439b71",
      "original_line" : 669,
      "original_position" : 21,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.cpp",
      "position" : 21,
      "pull_request_review_id" : 958451338,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862306508/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-30T05:40:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862306508",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91447896?v=4",
         "events_url" : "https://api.github.com/users/pk-b2/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pk-b2/followers",
         "following_url" : "https://api.github.com/users/pk-b2/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pk-b2/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pk-b2",
         "id" : 91447896,
         "login" : "pk-b2",
         "node_id" : "MDQ6VXNlcjkxNDQ3ODk2",
         "organizations_url" : "https://api.github.com/users/pk-b2/orgs",
         "received_events_url" : "https://api.github.com/users/pk-b2/received_events",
         "repos_url" : "https://api.github.com/users/pk-b2/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pk-b2/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pk-b2/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pk-b2"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r862307522"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862307522"
         }
      },
      "author_association" : "NONE",
      "body" : "Does it make sense to keep the naming of this enum more generic to cover the initialization of the entire address book than just the used attribute?\r\n\r\ne.g. `enum class AddressBook { Initialize, Skip_Initialization }`",
      "commit_id" : "8719b084754b8346e1cb551843afd3afcd439b71",
      "created_at" : "2022-04-30T05:45:25Z",
      "diff_hunk" : "@@ -666,7 +673,8 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n     CAmount GetDebit(const CTransaction& tx, const isminefilter& filter) const;\n     void chainStateFlushed(const CBlockLocator& loc) override;\n \n-    DBErrors LoadWallet();\n+    enum class do_init_used_flag { Init, Skip };",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r862307522",
      "id" : 862307522,
      "line" : 676,
      "node_id" : "PRRC_kwDOABII584zZcTC",
      "original_commit_id" : "8719b084754b8346e1cb551843afd3afcd439b71",
      "original_line" : 676,
      "original_position" : 40,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : 40,
      "pull_request_review_id" : 958451589,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862307522/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-30T05:45:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862307522",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91447896?v=4",
         "events_url" : "https://api.github.com/users/pk-b2/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pk-b2/followers",
         "following_url" : "https://api.github.com/users/pk-b2/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pk-b2/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pk-b2",
         "id" : 91447896,
         "login" : "pk-b2",
         "node_id" : "MDQ6VXNlcjkxNDQ3ODk2",
         "organizations_url" : "https://api.github.com/users/pk-b2/orgs",
         "received_events_url" : "https://api.github.com/users/pk-b2/received_events",
         "repos_url" : "https://api.github.com/users/pk-b2/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pk-b2/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pk-b2/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pk-b2"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r862308005"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862308005"
         }
      },
      "author_association" : "NONE",
      "body" : "Looking at other RPCs I tried to find a similar naming convention for txids.\r\n\r\nI found `listreceivedbyaddress` which uses an array called `txids` and `getblock`  that uses `tx` to return transaction ids in their responses.\r\n\r\nNot really consistent, but I was wondering if it would make sense to follow the `listreceivedbyaddress` response here and call the attribute `txids` as well instead of `use_txids`?",
      "commit_id" : "8719b084754b8346e1cb551843afd3afcd439b71",
      "created_at" : "2022-04-30T05:53:06Z",
      "diff_hunk" : "@@ -541,6 +541,10 @@ RPCHelpMan getaddressinfo()\n                         {\n                             {RPCResult::Type::STR, \"label name\", \"Label name (defaults to \\\"\\\").\"},\n                         }},\n+                        {RPCResult::Type::ARR, \"use_txids\", \"\",",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r862308005",
      "id" : 862308005,
      "line" : 544,
      "node_id" : "PRRC_kwDOABII584zZcal",
      "original_commit_id" : "8719b084754b8346e1cb551843afd3afcd439b71",
      "original_line" : 544,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/addresses.cpp",
      "position" : 4,
      "pull_request_review_id" : 958452026,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862308005/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-30T05:53:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862308005",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91447896?v=4",
         "events_url" : "https://api.github.com/users/pk-b2/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pk-b2/followers",
         "following_url" : "https://api.github.com/users/pk-b2/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pk-b2/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pk-b2",
         "id" : 91447896,
         "login" : "pk-b2",
         "node_id" : "MDQ6VXNlcjkxNDQ3ODk2",
         "organizations_url" : "https://api.github.com/users/pk-b2/orgs",
         "received_events_url" : "https://api.github.com/users/pk-b2/received_events",
         "repos_url" : "https://api.github.com/users/pk-b2/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pk-b2/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pk-b2/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pk-b2"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r862309374"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862309374"
         }
      },
      "author_association" : "NONE",
      "body" : "I haven't done any measurements with a large historical wallet, but is it a performance concern when we immediately initialize the address book on wallet creation?\r\n\r\nIs it worth considering to lazy-initialize the address book on first use of `FindScriptPubKeyUsed`?",
      "commit_id" : "8719b084754b8346e1cb551843afd3afcd439b71",
      "created_at" : "2022-04-30T06:09:58Z",
      "diff_hunk" : "@@ -666,7 +673,8 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n     CAmount GetDebit(const CTransaction& tx, const isminefilter& filter) const;\n     void chainStateFlushed(const CBlockLocator& loc) override;\n \n-    DBErrors LoadWallet();\n+    enum class do_init_used_flag { Init, Skip };\n+    DBErrors LoadWallet(const do_init_used_flag do_init_used_flag_val = do_init_used_flag::Init);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r862309374",
      "id" : 862309374,
      "line" : 677,
      "node_id" : "PRRC_kwDOABII584zZcv-",
      "original_commit_id" : "8719b084754b8346e1cb551843afd3afcd439b71",
      "original_line" : 677,
      "original_position" : 41,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : 41,
      "pull_request_review_id" : 958453003,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862309374/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-30T06:09:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862309374",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91447896?v=4",
         "events_url" : "https://api.github.com/users/pk-b2/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pk-b2/followers",
         "following_url" : "https://api.github.com/users/pk-b2/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pk-b2/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pk-b2",
         "id" : 91447896,
         "login" : "pk-b2",
         "node_id" : "MDQ6VXNlcjkxNDQ3ODk2",
         "organizations_url" : "https://api.github.com/users/pk-b2/orgs",
         "received_events_url" : "https://api.github.com/users/pk-b2/received_events",
         "repos_url" : "https://api.github.com/users/pk-b2/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pk-b2/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pk-b2/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pk-b2"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r862310844"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862310844"
         }
      },
      "author_association" : "NONE",
      "body" : "Would something like `FindTransactions` fit better here?",
      "commit_id" : "8719b084754b8346e1cb551843afd3afcd439b71",
      "created_at" : "2022-04-30T06:26:38Z",
      "diff_hunk" : "@@ -463,6 +468,8 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n     bool UnlockAllCoins() EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n     void ListLockedCoins(std::vector<COutPoint>& vOutpts) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n \n+    bool FindScriptPubKeyUsed(const std::set<CScript>& keys, const std::variant<std::monostate, std::function<void(const CWalletTx&)>, std::function<void(const CWalletTx&, uint32_t)>>& callback = std::monostate()) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#discussion_r862310844",
      "id" : 862310844,
      "line" : 471,
      "node_id" : "PRRC_kwDOABII584zZdG8",
      "original_commit_id" : "8719b084754b8346e1cb551843afd3afcd439b71",
      "original_line" : 471,
      "original_position" : 30,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : 30,
      "pull_request_review_id" : 958453921,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22693",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862310844/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-04-30T06:26:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/862310844",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/91447896?v=4",
         "events_url" : "https://api.github.com/users/pk-b2/events{/privacy}",
         "followers_url" : "https://api.github.com/users/pk-b2/followers",
         "following_url" : "https://api.github.com/users/pk-b2/following{/other_user}",
         "gists_url" : "https://api.github.com/users/pk-b2/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/pk-b2",
         "id" : 91447896,
         "login" : "pk-b2",
         "node_id" : "MDQ6VXNlcjkxNDQ3ODk2",
         "organizations_url" : "https://api.github.com/users/pk-b2/orgs",
         "received_events_url" : "https://api.github.com/users/pk-b2/received_events",
         "repos_url" : "https://api.github.com/users/pk-b2/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/pk-b2/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/pk-b2/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/pk-b2"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">Not sure if you have seen it but we are already keeping track of the used destinations in a slightly different way, inside the address book entry destdata field, under key called \"used\". (check CWallet::IsAddressUsed and CWallet::SetAddressUsed).\r\n\r\nThat's not the same thing, despite its confusing name.",
      "created_at" : "2022-06-01T16:33:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#issuecomment-1143849130",
      "id" : 1143849130,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22693",
      "node_id" : "IC_kwDOABII585ELcCq",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1143849130/reactions"
      },
      "updated_at" : "2022-06-01T16:33:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1143849130",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> > Not sure if you have seen it but we are already keeping track of the used destinations in a slightly different way, inside the address book entry destdata field, under key called \"used\". (check CWallet::IsAddressUsed and CWallet::SetAddressUsed).\r\n> \r\n> That's not the same thing, despite its confusing name.\r\n\r\nHmm, the storage part of the flow seems to be what you have in 698658e3 with a single difference:\r\n\r\n-> Current Flow:\r\n When the wallet receives a transaction, `AddToWallet` loops over the tx inputs and calls `SetSpentKeyState`,  which extracts the destinations and mark the ones owned by the wallet as \"used\" inside the address book entry `destdata` map.\r\n\r\nThen `IsAddressUsed` merely checks if the \"used\" key is on the address book entry `destdata` map. Which denotes that the wallet received funds to that specific destination (so, it's \"used\").\r\n\r\n-> The difference with 698658e3:\r\nIt does not mark the tx outputs destinations as \"used\" (which is what my commit implements).\r\n\r\nAm I missing something?\r\n\r\n------------------------------------------------------\r\n\r\nAside from that, outside of the scope of this PR, I do agree that the \"how this is currently used\" part of the flow is misleading. Mostly because `IsSpentKey`(which receives an outpoint to check if there is a known output that uses the same destination inside the wallet) is called from `AvailableCoins` without much context.\r\nBut.. for that, I have a PR that cleans up the `IsSpentKey` function a bit #25005.",
      "created_at" : "2022-06-01T19:33:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#issuecomment-1144053060",
      "id" : 1144053060,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22693",
      "node_id" : "IC_kwDOABII585EMN1E",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1144053060/reactions"
      },
      "updated_at" : "2022-06-01T19:33:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1144053060",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5377650?v=4",
         "events_url" : "https://api.github.com/users/furszy/events{/privacy}",
         "followers_url" : "https://api.github.com/users/furszy/followers",
         "following_url" : "https://api.github.com/users/furszy/following{/other_user}",
         "gists_url" : "https://api.github.com/users/furszy/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/furszy",
         "id" : 5377650,
         "login" : "furszy",
         "node_id" : "MDQ6VXNlcjUzNzc2NTA=",
         "organizations_url" : "https://api.github.com/users/furszy/orgs",
         "received_events_url" : "https://api.github.com/users/furszy/received_events",
         "repos_url" : "https://api.github.com/users/furszy/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/furszy/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/furszy/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/furszy"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : ">Am I missing something?\r\n\r\nThe destdata key deals with and is marked by inputs. But when an address is used, it's by an output, not an input.",
      "created_at" : "2022-06-02T04:38:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22693#issuecomment-1144428398",
      "id" : 1144428398,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22693",
      "node_id" : "IC_kwDOABII585ENpdu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1144428398/reactions"
      },
      "updated_at" : "2022-06-02T04:38:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1144428398",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   }
]
