[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Slice type seems similar to upcoming [std::span](http://en.cppreference.com/w/cpp/container/span). It may be a good idea to call this class `Span` and consciously keep the implementation compatible so it could be swapped out in the future (it does seem compatible already).",
      "created_at" : "2018-04-04T20:45:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12886#issuecomment-378739389",
      "id" : 378739389,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12886",
      "updated_at" : "2018-04-04T20:45:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378739389",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Cool, I'll rename it and add a comment. I wasn't aware of std::span.\n\nAlso, std::span seems to have a constructor that behaves like the MakeSlice function I have here. I don't think it's possible to implement that as a constructor in c++11 yet.",
      "created_at" : "2018-04-04T20:53:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12886#issuecomment-378741497",
      "id" : 378741497,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12886",
      "updated_at" : "2018-04-04T20:53:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378741497",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. Very nice!\r\n\r\nDoes this need a test?",
      "created_at" : "2018-04-04T21:09:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12886#issuecomment-378746171",
      "id" : 378746171,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12886",
      "updated_at" : "2018-04-04T21:09:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378746171",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12886#discussion_r179291732"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12886"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/179291732"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This could use an overload for the ```std::is_trivially_copyable``` trait that creates a slice for ```Slice<uint8_t>(&v, sizeof(v))```:\r\n> Objects of trivially-copyable types are the only C++ objects that may be safely copied with std::memcpy or serialized to/from binary files with std::ofstream::write()/std::ifstream::read(). In general, a trivially copyable type is any type for which the underlying bytes can be copied to an array of char or unsigned char and into a new object of the same type, and the resulting object would have the same value as the original.\r\n\r\nThat would eliminate the need for the hack in netaddress.h.",
      "commit_id" : "ce141afc5a4a322b309840789e984b0a79c603fb",
      "created_at" : "2018-04-04T21:40:42Z",
      "diff_hunk" : "@@ -0,0 +1,39 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_SLICE_H\n+#define BITCOIN_SLICE_H\n+\n+#include <type_traits>\n+#include <cstddef>\n+\n+/** A Slice is a pointer to a non-owned continuous array that acts like a container. */\n+template<typename C>\n+class Slice\n+{\n+    C* m_data;\n+    std::size_t m_size;\n+\n+public:\n+    Slice() : m_data(nullptr), m_size(0) {}\n+    Slice(C* data, std::size_t size) : m_data(data), m_size(size) {}\n+\n+    C* data() const { return m_data; }\n+    std::size_t size() const { return m_size; }\n+\n+    C* begin() const { return m_data; }\n+    C* end() const { return m_data + m_size; }\n+\n+    C& operator[](std::size_t pos) const { return m_data[pos]; }\n+};\n+\n+/** Create a slice to a container exposing data() and size()\n+ *\n+ * This correctly deals with constness: if either the element type is const\n+ * or a reference to a const container is passed, the result will be a const\n+ * Slice. */\n+template<typename V>\n+Slice<typename std::remove_pointer<decltype(std::declval<V>().data())>::type> MakeSlice(V& v) { return Slice<typename std::remove_pointer<decltype(std::declval<V>().data())>::type>(v.data(), v.size()); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12886#discussion_r179291732",
      "id" : 179291732,
      "original_commit_id" : "347405bfc9f19438d034c0aaee129fd058bb16e9",
      "original_position" : 37,
      "path" : "src/slice.h",
      "position" : null,
      "pull_request_review_id" : 109510771,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12886",
      "updated_at" : "2018-04-05T00:17:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/179291732",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, way overdue.",
      "created_at" : "2018-04-04T21:41:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12886#issuecomment-378754525",
      "id" : 378754525,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12886",
      "updated_at" : "2018-04-04T21:41:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378754525",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/417043?v=4",
         "events_url" : "https://api.github.com/users/theuni/events{/privacy}",
         "followers_url" : "https://api.github.com/users/theuni/followers",
         "following_url" : "https://api.github.com/users/theuni/following{/other_user}",
         "gists_url" : "https://api.github.com/users/theuni/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/theuni",
         "id" : 417043,
         "login" : "theuni",
         "organizations_url" : "https://api.github.com/users/theuni/orgs",
         "received_events_url" : "https://api.github.com/users/theuni/received_events",
         "repos_url" : "https://api.github.com/users/theuni/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/theuni/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/theuni/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/theuni"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "@theuni My idea of removing the hack in netaddress is introducing a BigInteger wrapper (see #10785).",
      "created_at" : "2018-04-04T21:46:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12886#issuecomment-378755557",
      "id" : 378755557,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12886",
      "updated_at" : "2018-04-04T21:46:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378755557",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "A few small changes:\r\n* Renamed to `Span`\r\n* Reduced the number of methods (it's now so trivial that I don't see what could be tested about it, @practicalswift).\r\n* Added comments to explain similarity with C++20's `std::span` (thanks @ryanofsky).\r\n* Added TODO on the netaddress port serialization hack (pointed out by @theuni).\r\n\r\n",
      "created_at" : "2018-04-04T23:23:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12886#issuecomment-378775496",
      "id" : 378775496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12886",
      "updated_at" : "2018-04-04T23:23:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378775496",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12886#discussion_r179324735"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12886"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/179324735"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "clang-format will flatten this out and make some other whitespace changes",
      "commit_id" : "ce141afc5a4a322b309840789e984b0a79c603fb",
      "created_at" : "2018-04-05T00:57:03Z",
      "diff_hunk" : "@@ -0,0 +1,40 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_SPAN_H\n+#define BITCOIN_SPAN_H\n+\n+#include <type_traits>\n+#include <cstddef>\n+\n+/** A Span is an object that can refer to a contiguous sequence of objects.\n+ *\n+ * It implements a subset of C++20's std::span.\n+ */\n+template<typename C>\n+class Span\n+{\n+    C* m_data;\n+    std::ptrdiff_t m_size;\n+\n+public:\n+    constexpr Span() noexcept : m_data(nullptr), m_size(0) {}\n+    constexpr Span(C* data, std::ptrdiff_t size) noexcept : m_data(data), m_size(size) {}\n+\n+    constexpr C* data() noexcept { return m_data; }\n+    constexpr std::ptrdiff_t size() noexcept { return m_size; }\n+};\n+\n+/** Create a span to a container exposing data() and size().\n+ *\n+ * This correctly deals with constness: the returned Span's element type will be\n+ * whatever data() returns a pointer to. If either the passed container is const,\n+ * or its element type is const, the resulting span will have a const element type.\n+ *\n+ * std::span will have a constructor that implements this functionality directly.\n+ */\n+template<typename V>\n+constexpr Span<typename std::remove_pointer<decltype(std::declval<V>().data())>::type> MakeSpan(V& v) { return Span<typename std::remove_pointer<decltype(std::declval<V>().data())>::type>(v.data(), v.size()); }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12886#discussion_r179324735",
      "id" : 179324735,
      "original_commit_id" : "ce141afc5a4a322b309840789e984b0a79c603fb",
      "original_position" : 38,
      "path" : "src/span.h",
      "position" : 38,
      "pull_request_review_id" : 109548724,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12886",
      "updated_at" : "2018-04-05T00:57:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/179324735",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "utACK https://github.com/bitcoin/bitcoin/pull/12886/commits/ce141afc5a4a322b309840789e984b0a79c603fb\r\n\r\n> A longer term goal for Spans is making the script execution operate on them rather than on CScript itself. This will allow separate storage mechanisms for scripts.\r\n\r\nFinally :)\r\n\r\n> @theuni My idea of removing the hack in netaddress is introducing a BigInteger wrapper (see #10785).\r\n\r\nGood idea, though the name BigInteger put me on the wrong foot initially. Better to spell it out as `BigEndianInteger` probably.",
      "created_at" : "2018-04-05T06:49:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12886#issuecomment-378836987",
      "id" : 378836987,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12886",
      "updated_at" : "2018-04-05T06:50:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/378836987",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
