[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12804#discussion_r177723388"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12804"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/177723388"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Does it make sense to add a `time.sleep()` before `getpeerinfo()` so that the two calls might have a better chance of being in sync?\r\n\r\nI am also curious if you have been able to reproduce locally; I have not. I assume this changes the likelihood of failure significantly lower, but I am curious if in the case where the first try fails, might the second also be likely to fail for whatever reason. ",
      "commit_id" : "b7e2619eeaef579e048eab705ddad18041d4ceb8",
      "created_at" : "2018-03-28T11:54:56Z",
      "diff_hunk" : "@@ -33,15 +33,25 @@ def _test_connection_count(self):\n         assert_equal(self.nodes[0].getconnectioncount(), 2)\n \n     def _test_getnettotals(self):\n-        # check that getnettotals totalbytesrecv and totalbytessent\n-        # are consistent with getpeerinfo\n-        peer_info = self.nodes[0].getpeerinfo()\n-        assert_equal(len(peer_info), 2)\n-        net_totals = self.nodes[0].getnettotals()\n-        assert_equal(sum([peer['bytesrecv'] for peer in peer_info]),\n-                     net_totals['totalbytesrecv'])\n-        assert_equal(sum([peer['bytessent'] for peer in peer_info]),\n-                     net_totals['totalbytessent'])\n+        # Check that getnettotals totalbytesrecv and totalbytessent\n+        # are consistent with getpeerinfo. Since the RPC calls are\n+        # not atomic, this may fail. Try up to 3 times.\n+        for i in range(3):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12804#discussion_r177723388",
      "id" : 177723388,
      "original_commit_id" : "b7e2619eeaef579e048eab705ddad18041d4ceb8",
      "original_position" : 16,
      "path" : "test/functional/rpc_net.py",
      "position" : 16,
      "pull_request_review_id" : 107645667,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12804",
      "updated_at" : "2018-03-28T11:54:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/177723388",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/14220652?v=4",
         "events_url" : "https://api.github.com/users/conscott/events{/privacy}",
         "followers_url" : "https://api.github.com/users/conscott/followers",
         "following_url" : "https://api.github.com/users/conscott/following{/other_user}",
         "gists_url" : "https://api.github.com/users/conscott/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/conscott",
         "id" : 14220652,
         "login" : "conscott",
         "organizations_url" : "https://api.github.com/users/conscott/orgs",
         "received_events_url" : "https://api.github.com/users/conscott/received_events",
         "repos_url" : "https://api.github.com/users/conscott/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/conscott/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/conscott/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/conscott"
      }
   }
]
