[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Missing test.",
      "created_at" : "2018-01-05T09:26:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12096#issuecomment-355509666",
      "id" : 355509666,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12096",
      "updated_at" : "2018-01-05T09:26:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355509666",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "This decreases the output? In some cases that may desirable, but in general I think that's very unexpected (I would think it would add a new input instead).",
      "created_at" : "2018-01-05T12:30:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12096#issuecomment-355544243",
      "id" : 355544243,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12096",
      "updated_at" : "2018-01-05T12:30:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355544243",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "If you don't have a change address chance are fairly high that you're simply moving coins (e.g. between wallets). Especially if you only have one utxo in, you may not want to associate other utxo's with it for privacy reasons.",
      "created_at" : "2018-01-05T12:40:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12096#issuecomment-355545850",
      "id" : 355545850,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12096",
      "updated_at" : "2018-01-05T12:40:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355545850",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> _\"single output transactions are special in that the exact amount doesn't usually matter (the user is emptying a wallet or using coin control to move UTXOs).\"_\r\n\r\nI would argue that this is not stated strongly enough. If they previously paid to a single output then it is *almost always* true that they do not care about the particular amount. This is especially true as the previous amount was subject to an arbitrary, variable fee.\r\n\r\nValid use cases where this behavior is necessary, where you really don't want to require adding more inputs in order to bumpfee:\r\n* Emptying a wallet\r\n* Emptying particular UTXO's\r\n\r\nI would further suggest if the receiver was expecting a particular amount then you would expect there to be a change output.",
      "created_at" : "2018-01-05T12:49:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12096#issuecomment-355547260",
      "id" : 355547260,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12096",
      "updated_at" : "2018-01-05T12:49:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355547260",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/93665?v=4",
         "events_url" : "https://api.github.com/users/wtogami/events{/privacy}",
         "followers_url" : "https://api.github.com/users/wtogami/followers",
         "following_url" : "https://api.github.com/users/wtogami/following{/other_user}",
         "gists_url" : "https://api.github.com/users/wtogami/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/wtogami",
         "id" : 93665,
         "login" : "wtogami",
         "organizations_url" : "https://api.github.com/users/wtogami/orgs",
         "received_events_url" : "https://api.github.com/users/wtogami/received_events",
         "repos_url" : "https://api.github.com/users/wtogami/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/wtogami/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/wtogami/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/wtogami"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "@kallewoof You're right that in *most* cases right now that you don't care about the amount if there is only one output, but there is certainly no guarantee. The coin selection algorithm even explicitly tries to find a solution without change first - it's just pretty terrible at its job current (#10637 will make it succeed much more often).\r\n  ",
      "created_at" : "2018-01-05T12:51:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12096#issuecomment-355547735",
      "id" : 355547735,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12096",
      "updated_at" : "2018-01-05T12:55:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355547735",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think this could be generalized and also be made safer by adding an `reduce_output` option to bumpfee (could also call it something like `output_number` or `txout`). This way you'd be able to bump single output transactions by specifying `reduce_output: 0`, but there'd be no risk of someone accidentally decreasing the amount they are trying to send by bumping the fee in other cases.\r\n  ",
      "created_at" : "2018-01-05T12:55:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12096#issuecomment-355548327",
      "id" : 355548327,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12096",
      "updated_at" : "2018-01-05T12:56:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355548327",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I don't think it makes sense to arbitrarily add inputs to bumpfee. I don't even know if RBF allows it (since you're suggesting it, I guess it does -- I thought I tried and failed).\r\n\r\nMaybe a `bump_from_output` flag in `options` that did this behavior.\r\n \r\nEdit: @ryanofsky That looks good to me.",
      "created_at" : "2018-01-05T12:55:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12096#issuecomment-355548355",
      "id" : 355548355,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12096",
      "updated_at" : "2018-01-05T12:55:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355548355",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "I don't see why RBF wouldn't allow it, as long as all transactions you're replacing have been marked as replaceable.\r\n\r\nI like the idea of explicitly marking an output that can be reduced.\r\n\r\nOver time (especially after #10637), I think we'll inevitably need a way to bump transactions that don't have change. Depending on feerates and your wallet's UTXO set distribution, a large fraction of transactions may be created without change.\r\n  ",
      "created_at" : "2018-01-05T13:00:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12096#issuecomment-355549264",
      "id" : 355549264,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12096",
      "updated_at" : "2018-01-05T13:00:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355549264",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "does the wallet track which outputs had subtractFeeFromOutput? In that case further reduction seems completely fine as well.",
      "created_at" : "2018-01-05T14:11:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12096#issuecomment-355563425",
      "id" : 355563425,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12096",
      "updated_at" : "2018-01-05T14:11:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355563425",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/12096#discussion_r159898177"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12096"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159898177"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Check new output is less than 0.00099?",
      "commit_id" : "2afb0d085ff922080c7d40be191ebc684f7f84b3",
      "created_at" : "2018-01-05T15:11:03Z",
      "diff_hunk" : "@@ -278,6 +279,13 @@ def spend_one_input(node, dest_address):\n     txid = node.sendrawtransaction(signedtx[\"hex\"])\n     return txid\n \n+def test_single_output_bump(node, dest_address):\n+    tx_input = dict(\n+        sequence=BIP125_SEQUENCE_NUMBER, **next(u for u in node.listunspent() if u[\"amount\"] == Decimal(\"0.00100000\")))\n+    rawtx = node.createrawtransaction([tx_input], {dest_address: Decimal(\"0.00099000\")})\n+    signedtx = node.signrawtransaction(rawtx)\n+    txid = node.sendrawtransaction(signedtx[\"hex\"])\n+    bumped_tx = node.bumpfee(txid)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12096#discussion_r159898177",
      "id" : 159898177,
      "original_commit_id" : "2afb0d085ff922080c7d40be191ebc684f7f84b3",
      "original_position" : 18,
      "path" : "test/functional/bumpfee.py",
      "position" : 18,
      "pull_request_review_id" : 86927273,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/12096",
      "updated_at" : "2018-01-05T15:11:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/159898177",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Agree that there are cases where the output(s) can't be reduced. In the cases it can be reduced, should it be re-funded?\r\n  ",
      "created_at" : "2018-01-05T15:14:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12096#issuecomment-355578491",
      "id" : 355578491,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12096",
      "updated_at" : "2018-01-05T15:44:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355578491",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I don't think it makes sense to arbitrarily add inputs to bumpfee. I don't even know if RBF allows it (since you're suggesting it, I guess it does -- I thought I tried and failed).\r\n\r\n@kallewoof Currently our relay policy (and BIP 125) require that if you add a new input, it must be already confirmed -- perhaps you tested with an unconfirmed input?\r\n\r\n(The idea behind that requirement was to ensure the new transaction was more likely to be mined than the ones it was replacing; now that we use ancestor feerate mining, we could perhaps relax this requirement and compare ancestor feerates of everything instead to ensure the new transaction has a higher mining score.)",
      "created_at" : "2018-01-05T15:41:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/12096#issuecomment-355585456",
      "id" : 355585456,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/12096",
      "updated_at" : "2018-01-05T15:41:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/355585456",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   }
]
