[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59392178"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59392178"
         }
      },
      "body" : "It seems to me default is simply \"not bip125\". Not sure the name \"default\" really fits, especially longer-term. ",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-12T15:03:37Z",
      "diff_hunk" : "@@ -533,6 +533,11 @@ class CAccountingEntry\n     std::vector<char> _ssExtra;\n };\n \n+enum CreateTransactionFlags {\n+    CREATE_TX_DEFAULT     = 0,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59392178",
      "id" : 59392178,
      "original_commit_id" : "f68447ad7cc265e2b949e42b02abe901f426af1c",
      "original_position" : 5,
      "path" : "src/wallet/wallet.h",
      "position" : 5,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59392178",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59392983"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59392983"
         }
      },
      "body" : "update the comment?",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-12T15:07:44Z",
      "diff_hunk" : "@@ -2179,7 +2179,7 @@ bool CWallet::CreateTransaction(const vector<CRecipient>& vecSend, CWalletTx& wt\n                 // nLockTime set above actually works.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59392983",
      "id" : 59392983,
      "original_commit_id" : "f68447ad7cc265e2b949e42b02abe901f426af1c",
      "original_position" : 86,
      "path" : "src/wallet/wallet.cpp",
      "position" : 86,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59392983",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59393236"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59393236"
         }
      },
      "body" : "Good catch! Will update.",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-12T15:08:58Z",
      "diff_hunk" : "@@ -2179,7 +2179,7 @@ bool CWallet::CreateTransaction(const vector<CRecipient>& vecSend, CWalletTx& wt\n                 // nLockTime set above actually works.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59393236",
      "id" : 59393236,
      "original_commit_id" : "f68447ad7cc265e2b949e42b02abe901f426af1c",
      "original_position" : 86,
      "path" : "src/wallet/wallet.cpp",
      "position" : 86,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59393236",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59400373"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59400373"
         }
      },
      "body" : "I think this deletes outputs going to watch-only wallet addresses. Perhaps check for isminetype we care about.",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-12T15:47:14Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59400373",
      "id" : 59400373,
      "original_commit_id" : "f68447ad7cc265e2b949e42b02abe901f426af1c",
      "original_position" : 178,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59400373",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59443131"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59443131"
         }
      },
      "body" : "I think the `CREATE_TX_DEFAULT` is okay. Passing just a `0`(int) would require casting. \"not bip125\" is also not true because in future you could combine flags (Don't SIGN & RBF)? ",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-12T20:01:30Z",
      "diff_hunk" : "@@ -533,6 +533,11 @@ class CAccountingEntry\n     std::vector<char> _ssExtra;\n };\n \n+enum CreateTransactionFlags {\n+    CREATE_TX_DEFAULT     = 0,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59443131",
      "id" : 59443131,
      "original_commit_id" : "f68447ad7cc265e2b949e42b02abe901f426af1c",
      "original_position" : 5,
      "path" : "src/wallet/wallet.h",
      "position" : 5,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59443131",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Force push fixed @instagibbs nits.",
      "created_at" : "2016-04-12T20:11:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#issuecomment-209084037",
      "id" : 209084037,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7865",
      "updated_at" : "2016-04-12T20:11:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/209084037",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "utACK post-nits\r\n\r\nAlthough it might make sense to split this into ~3 PRs to get through a couple faster, and each of which would still be useful on their own:\r\n1) bitcoin-tx stuff\r\n2) createrawtransaction stuff\r\n3) rest of stuff",
      "created_at" : "2016-04-13T20:34:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#issuecomment-209636988",
      "id" : 209636988,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7865",
      "updated_at" : "2016-04-13T20:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/209636988",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59674077"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59674077"
         }
      },
      "body" : "Why not ensuring `(nFee - nOldFee) > minTxRelayFee`, and if not, exit early with a descriptive JSONRpcError which say the fees are high enough and can't be bumped ?",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-14T07:41:13Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it) == ISMINE_SPENDABLE)\n+            it = tx.vout.erase(it);\n+        else\n+            ++it;\n+    }\n+\n+    string strFailReason;\n+    int nChangePos = -1;\n+\n+    // re-fund the transaction, a new change output will be added\n+    CReserveKey reservekey(pwalletMain);\n+    if(!pwalletMain->FundTransaction(tx, reservekey, nFee, nChangePos, strFailReason, false))\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, strFailReason);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59674077",
      "id" : 59674077,
      "original_commit_id" : "45b6ec5d22577e8152cdedf1ff4772d432b654cf",
      "original_position" : 191,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 191,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59674077",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59674231"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59674231"
         }
      },
      "body" : "Transaction can be rejected even if the fee are not already bumped if the estimated fee rate decreased compared to the previous version of the transaction.",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-14T07:42:45Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it) == ISMINE_SPENDABLE)\n+            it = tx.vout.erase(it);\n+        else\n+            ++it;\n+    }\n+\n+    string strFailReason;\n+    int nChangePos = -1;\n+\n+    // re-fund the transaction, a new change output will be added\n+    CReserveKey reservekey(pwalletMain);\n+    if(!pwalletMain->FundTransaction(tx, reservekey, nFee, nChangePos, strFailReason, false))\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, strFailReason);\n+\n+    // sign the new transaction\n+    int nIn = 0;\n+    CTransaction txNewConst(tx);\n+    bool txSignSuccess = false;\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        std::map<uint256, CWalletTx>::const_iterator mi = pwalletMain->mapWallet.find((*it).prevout.hash);\n+        if (mi != pwalletMain->mapWallet.end() && (nIn < (int)(*mi).second.vout.size()))\n+        {\n+            // get the scriptPubKey of the prevout\n+            const CScript& scriptPubKey = (*mi).second.vout[(*it).prevout.n].scriptPubKey;\n+\n+            CScript& scriptSigRes = tx.vin[nIn].scriptSig; //reference to the CMutableTx scriptSig\n+            txSignSuccess = ProduceSignature(TransactionSignatureCreator(pwalletMain, &txNewConst, nIn, SIGHASH_ALL), scriptPubKey, scriptSigRes);\n+\n+            if (!txSignSuccess)\n+                break;\n+        }\n+        nIn++;\n+    }\n+\n+    if (!txSignSuccess)\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Can't sign transaction.\");\n+\n+    // commit/broadcast the transaction\n+    CWalletTx wtxBumped(pwalletMain,tx);\n+    if (!pwalletMain->CommitTransaction(wtxBumped, reservekey))\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Error: The transaction was rejected! Did you already bump the fee for this transaction?\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59674231",
      "id" : 59674231,
      "original_commit_id" : "45b6ec5d22577e8152cdedf1ff4772d432b654cf",
      "original_position" : 219,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 219,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59674231",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59687615"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59687615"
         }
      },
      "body" : "Yes. I have though about that. But you also would like to have a check that makes sure, it would be accepted as replacement.\r\nThis would require to factor out the RBF check from `main.cpp` to `rbf.cpp` (which probably would sense in a follow up PR).",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-14T09:31:02Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it) == ISMINE_SPENDABLE)\n+            it = tx.vout.erase(it);\n+        else\n+            ++it;\n+    }\n+\n+    string strFailReason;\n+    int nChangePos = -1;\n+\n+    // re-fund the transaction, a new change output will be added\n+    CReserveKey reservekey(pwalletMain);\n+    if(!pwalletMain->FundTransaction(tx, reservekey, nFee, nChangePos, strFailReason, false))\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, strFailReason);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59687615",
      "id" : 59687615,
      "original_commit_id" : "45b6ec5d22577e8152cdedf1ff4772d432b654cf",
      "original_position" : 191,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 191,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59687615",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59687827"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59687827"
         }
      },
      "body" : "Yes. True. This is why the second sentence is a question. :)\r\nI guess it will be a common mistake to bump the same txid again.\r\nBut I'm open for suggestions.",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-14T09:32:30Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it) == ISMINE_SPENDABLE)\n+            it = tx.vout.erase(it);\n+        else\n+            ++it;\n+    }\n+\n+    string strFailReason;\n+    int nChangePos = -1;\n+\n+    // re-fund the transaction, a new change output will be added\n+    CReserveKey reservekey(pwalletMain);\n+    if(!pwalletMain->FundTransaction(tx, reservekey, nFee, nChangePos, strFailReason, false))\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, strFailReason);\n+\n+    // sign the new transaction\n+    int nIn = 0;\n+    CTransaction txNewConst(tx);\n+    bool txSignSuccess = false;\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        std::map<uint256, CWalletTx>::const_iterator mi = pwalletMain->mapWallet.find((*it).prevout.hash);\n+        if (mi != pwalletMain->mapWallet.end() && (nIn < (int)(*mi).second.vout.size()))\n+        {\n+            // get the scriptPubKey of the prevout\n+            const CScript& scriptPubKey = (*mi).second.vout[(*it).prevout.n].scriptPubKey;\n+\n+            CScript& scriptSigRes = tx.vin[nIn].scriptSig; //reference to the CMutableTx scriptSig\n+            txSignSuccess = ProduceSignature(TransactionSignatureCreator(pwalletMain, &txNewConst, nIn, SIGHASH_ALL), scriptPubKey, scriptSigRes);\n+\n+            if (!txSignSuccess)\n+                break;\n+        }\n+        nIn++;\n+    }\n+\n+    if (!txSignSuccess)\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Can't sign transaction.\");\n+\n+    // commit/broadcast the transaction\n+    CWalletTx wtxBumped(pwalletMain,tx);\n+    if (!pwalletMain->CommitTransaction(wtxBumped, reservekey))\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Error: The transaction was rejected! Did you already bump the fee for this transaction?\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59687827",
      "id" : 59687827,
      "original_commit_id" : "45b6ec5d22577e8152cdedf1ff4772d432b654cf",
      "original_position" : 219,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 219,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59687827",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59690897"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59690897"
         }
      },
      "body" : "Yes, but CommitTransaction later is already doing that under the hood if I understand.\r\nThe most likely problem is that the fees can't be bumped, for the 0.0001% chance that it still get rejected for whatever other issue during the CommitTransaction, a generic error message would be enough.",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-14T09:58:11Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it) == ISMINE_SPENDABLE)\n+            it = tx.vout.erase(it);\n+        else\n+            ++it;\n+    }\n+\n+    string strFailReason;\n+    int nChangePos = -1;\n+\n+    // re-fund the transaction, a new change output will be added\n+    CReserveKey reservekey(pwalletMain);\n+    if(!pwalletMain->FundTransaction(tx, reservekey, nFee, nChangePos, strFailReason, false))\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, strFailReason);\n+",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59690897",
      "id" : 59690897,
      "original_commit_id" : "45b6ec5d22577e8152cdedf1ff4772d432b654cf",
      "original_position" : 191,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 191,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59690897",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59691087"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59691087"
         }
      },
      "body" : "If you detect `(nFee - nOldFee) > minTxRelayFee` condition above, then it is not a question anymore. The early exit message would be \"Fee are already bumped to the actual fee rate\".\r\n\r\nThe error on CommitTransaction can be \"Something went wrong when commiting the transaction in the wallet\". Generic and not descriptive, but it should not happen very often, and if it happens, you are sure it is not because of Fees already bumped as you already checked that above.",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-14T09:59:46Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it) == ISMINE_SPENDABLE)\n+            it = tx.vout.erase(it);\n+        else\n+            ++it;\n+    }\n+\n+    string strFailReason;\n+    int nChangePos = -1;\n+\n+    // re-fund the transaction, a new change output will be added\n+    CReserveKey reservekey(pwalletMain);\n+    if(!pwalletMain->FundTransaction(tx, reservekey, nFee, nChangePos, strFailReason, false))\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, strFailReason);\n+\n+    // sign the new transaction\n+    int nIn = 0;\n+    CTransaction txNewConst(tx);\n+    bool txSignSuccess = false;\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        std::map<uint256, CWalletTx>::const_iterator mi = pwalletMain->mapWallet.find((*it).prevout.hash);\n+        if (mi != pwalletMain->mapWallet.end() && (nIn < (int)(*mi).second.vout.size()))\n+        {\n+            // get the scriptPubKey of the prevout\n+            const CScript& scriptPubKey = (*mi).second.vout[(*it).prevout.n].scriptPubKey;\n+\n+            CScript& scriptSigRes = tx.vin[nIn].scriptSig; //reference to the CMutableTx scriptSig\n+            txSignSuccess = ProduceSignature(TransactionSignatureCreator(pwalletMain, &txNewConst, nIn, SIGHASH_ALL), scriptPubKey, scriptSigRes);\n+\n+            if (!txSignSuccess)\n+                break;\n+        }\n+        nIn++;\n+    }\n+\n+    if (!txSignSuccess)\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Can't sign transaction.\");\n+\n+    // commit/broadcast the transaction\n+    CWalletTx wtxBumped(pwalletMain,tx);\n+    if (!pwalletMain->CommitTransaction(wtxBumped, reservekey))\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Error: The transaction was rejected! Did you already bump the fee for this transaction?\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59691087",
      "id" : 59691087,
      "original_commit_id" : "45b6ec5d22577e8152cdedf1ff4772d432b654cf",
      "original_position" : 219,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 219,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59691087",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59691813"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59691813"
         }
      },
      "body" : "IMO if you do `(nFee - nOldFee) > minTxRelayFee` you can't be sure if you are using enough fees. The new transaction also needs to pay the bandwith-costs of the all replaced transaction descendants. Not?",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-14T10:05:55Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it) == ISMINE_SPENDABLE)\n+            it = tx.vout.erase(it);\n+        else\n+            ++it;\n+    }\n+\n+    string strFailReason;\n+    int nChangePos = -1;\n+\n+    // re-fund the transaction, a new change output will be added\n+    CReserveKey reservekey(pwalletMain);\n+    if(!pwalletMain->FundTransaction(tx, reservekey, nFee, nChangePos, strFailReason, false))\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, strFailReason);\n+\n+    // sign the new transaction\n+    int nIn = 0;\n+    CTransaction txNewConst(tx);\n+    bool txSignSuccess = false;\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        std::map<uint256, CWalletTx>::const_iterator mi = pwalletMain->mapWallet.find((*it).prevout.hash);\n+        if (mi != pwalletMain->mapWallet.end() && (nIn < (int)(*mi).second.vout.size()))\n+        {\n+            // get the scriptPubKey of the prevout\n+            const CScript& scriptPubKey = (*mi).second.vout[(*it).prevout.n].scriptPubKey;\n+\n+            CScript& scriptSigRes = tx.vin[nIn].scriptSig; //reference to the CMutableTx scriptSig\n+            txSignSuccess = ProduceSignature(TransactionSignatureCreator(pwalletMain, &txNewConst, nIn, SIGHASH_ALL), scriptPubKey, scriptSigRes);\n+\n+            if (!txSignSuccess)\n+                break;\n+        }\n+        nIn++;\n+    }\n+\n+    if (!txSignSuccess)\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Can't sign transaction.\");\n+\n+    // commit/broadcast the transaction\n+    CWalletTx wtxBumped(pwalletMain,tx);\n+    if (!pwalletMain->CommitTransaction(wtxBumped, reservekey))\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Error: The transaction was rejected! Did you already bump the fee for this transaction?\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59691813",
      "id" : 59691813,
      "original_commit_id" : "45b6ec5d22577e8152cdedf1ff4772d432b654cf",
      "original_position" : 219,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 219,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59691813",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59692031"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59692031"
         }
      },
      "body" : "nOldFee already is enough for all previously replaced ones, so you only need to add minTxRelayFee to account for everything. That's the logic used by the replacement code as well.",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-14T10:07:54Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it) == ISMINE_SPENDABLE)\n+            it = tx.vout.erase(it);\n+        else\n+            ++it;\n+    }\n+\n+    string strFailReason;\n+    int nChangePos = -1;\n+\n+    // re-fund the transaction, a new change output will be added\n+    CReserveKey reservekey(pwalletMain);\n+    if(!pwalletMain->FundTransaction(tx, reservekey, nFee, nChangePos, strFailReason, false))\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, strFailReason);\n+\n+    // sign the new transaction\n+    int nIn = 0;\n+    CTransaction txNewConst(tx);\n+    bool txSignSuccess = false;\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        std::map<uint256, CWalletTx>::const_iterator mi = pwalletMain->mapWallet.find((*it).prevout.hash);\n+        if (mi != pwalletMain->mapWallet.end() && (nIn < (int)(*mi).second.vout.size()))\n+        {\n+            // get the scriptPubKey of the prevout\n+            const CScript& scriptPubKey = (*mi).second.vout[(*it).prevout.n].scriptPubKey;\n+\n+            CScript& scriptSigRes = tx.vin[nIn].scriptSig; //reference to the CMutableTx scriptSig\n+            txSignSuccess = ProduceSignature(TransactionSignatureCreator(pwalletMain, &txNewConst, nIn, SIGHASH_ALL), scriptPubKey, scriptSigRes);\n+\n+            if (!txSignSuccess)\n+                break;\n+        }\n+        nIn++;\n+    }\n+\n+    if (!txSignSuccess)\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Can't sign transaction.\");\n+\n+    // commit/broadcast the transaction\n+    CWalletTx wtxBumped(pwalletMain,tx);\n+    if (!pwalletMain->CommitTransaction(wtxBumped, reservekey))\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Error: The transaction was rejected! Did you already bump the fee for this transaction?\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59692031",
      "id" : 59692031,
      "original_commit_id" : "45b6ec5d22577e8152cdedf1ff4772d432b654cf",
      "original_position" : 219,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 219,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59692031",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59700857"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59700857"
         }
      },
      "body" : "@jonasschnelli I dont think so given [the condition](https://github.com/bitcoin/bitcoin/pull/6871/files#diff-7ec3c68a81efff79b6ca22ac1f1eabbaR1129), just doing the same check should be enough.",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-14T11:25:07Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it) == ISMINE_SPENDABLE)\n+            it = tx.vout.erase(it);\n+        else\n+            ++it;\n+    }\n+\n+    string strFailReason;\n+    int nChangePos = -1;\n+\n+    // re-fund the transaction, a new change output will be added\n+    CReserveKey reservekey(pwalletMain);\n+    if(!pwalletMain->FundTransaction(tx, reservekey, nFee, nChangePos, strFailReason, false))\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, strFailReason);\n+\n+    // sign the new transaction\n+    int nIn = 0;\n+    CTransaction txNewConst(tx);\n+    bool txSignSuccess = false;\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        std::map<uint256, CWalletTx>::const_iterator mi = pwalletMain->mapWallet.find((*it).prevout.hash);\n+        if (mi != pwalletMain->mapWallet.end() && (nIn < (int)(*mi).second.vout.size()))\n+        {\n+            // get the scriptPubKey of the prevout\n+            const CScript& scriptPubKey = (*mi).second.vout[(*it).prevout.n].scriptPubKey;\n+\n+            CScript& scriptSigRes = tx.vin[nIn].scriptSig; //reference to the CMutableTx scriptSig\n+            txSignSuccess = ProduceSignature(TransactionSignatureCreator(pwalletMain, &txNewConst, nIn, SIGHASH_ALL), scriptPubKey, scriptSigRes);\n+\n+            if (!txSignSuccess)\n+                break;\n+        }\n+        nIn++;\n+    }\n+\n+    if (!txSignSuccess)\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Can't sign transaction.\");\n+\n+    // commit/broadcast the transaction\n+    CWalletTx wtxBumped(pwalletMain,tx);\n+    if (!pwalletMain->CommitTransaction(wtxBumped, reservekey))\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Error: The transaction was rejected! Did you already bump the fee for this transaction?\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59700857",
      "id" : 59700857,
      "original_commit_id" : "45b6ec5d22577e8152cdedf1ff4772d432b654cf",
      "original_position" : 219,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 219,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59700857",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59707643"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59707643"
         }
      },
      "body" : "@NicolasDorier: the problem is, it could be the case that you don't have a change output, or, that increasing the fee requires another `<n>` input(s). In theory Ã¢ÂÂ it could be that you need to add 10 new inputs (you don't know the fee situation before/during bump and the value of your unspent outputs).\r\n\r\nSo, this results in the knapsack problem. You don't know how big your transaction Ã¢ÂÂ and therefore what the minimum relay fee Ã¢ÂÂ needs to be.\r\n\r\nDuring writing this PR, I though easiest solution is it, to just re-run the `CreateTransaction` logic (where it deals with min-fee, etc.).\r\n\r\nBut correct. Adding the old fee to the new fee is probably inefficient and \"to much in fees\". But this is just a small change and can be optimized later.",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-14T12:26:48Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it) == ISMINE_SPENDABLE)\n+            it = tx.vout.erase(it);\n+        else\n+            ++it;\n+    }\n+\n+    string strFailReason;\n+    int nChangePos = -1;\n+\n+    // re-fund the transaction, a new change output will be added\n+    CReserveKey reservekey(pwalletMain);\n+    if(!pwalletMain->FundTransaction(tx, reservekey, nFee, nChangePos, strFailReason, false))\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, strFailReason);\n+\n+    // sign the new transaction\n+    int nIn = 0;\n+    CTransaction txNewConst(tx);\n+    bool txSignSuccess = false;\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        std::map<uint256, CWalletTx>::const_iterator mi = pwalletMain->mapWallet.find((*it).prevout.hash);\n+        if (mi != pwalletMain->mapWallet.end() && (nIn < (int)(*mi).second.vout.size()))\n+        {\n+            // get the scriptPubKey of the prevout\n+            const CScript& scriptPubKey = (*mi).second.vout[(*it).prevout.n].scriptPubKey;\n+\n+            CScript& scriptSigRes = tx.vin[nIn].scriptSig; //reference to the CMutableTx scriptSig\n+            txSignSuccess = ProduceSignature(TransactionSignatureCreator(pwalletMain, &txNewConst, nIn, SIGHASH_ALL), scriptPubKey, scriptSigRes);\n+\n+            if (!txSignSuccess)\n+                break;\n+        }\n+        nIn++;\n+    }\n+\n+    if (!txSignSuccess)\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Can't sign transaction.\");\n+\n+    // commit/broadcast the transaction\n+    CWalletTx wtxBumped(pwalletMain,tx);\n+    if (!pwalletMain->CommitTransaction(wtxBumped, reservekey))\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Error: The transaction was rejected! Did you already bump the fee for this transaction?\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59707643",
      "id" : 59707643,
      "original_commit_id" : "45b6ec5d22577e8152cdedf1ff4772d432b654cf",
      "original_position" : 219,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 219,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59707643",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59717635"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59717635"
         }
      },
      "body" : "@jonasschnelli I don't mean to remove the call to `CreateTransaction`. I mean just adding the fee check after the signature success check. (using the size of the fully signed new transaction replacement)",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-14T13:37:27Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it) == ISMINE_SPENDABLE)\n+            it = tx.vout.erase(it);\n+        else\n+            ++it;\n+    }\n+\n+    string strFailReason;\n+    int nChangePos = -1;\n+\n+    // re-fund the transaction, a new change output will be added\n+    CReserveKey reservekey(pwalletMain);\n+    if(!pwalletMain->FundTransaction(tx, reservekey, nFee, nChangePos, strFailReason, false))\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, strFailReason);\n+\n+    // sign the new transaction\n+    int nIn = 0;\n+    CTransaction txNewConst(tx);\n+    bool txSignSuccess = false;\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        std::map<uint256, CWalletTx>::const_iterator mi = pwalletMain->mapWallet.find((*it).prevout.hash);\n+        if (mi != pwalletMain->mapWallet.end() && (nIn < (int)(*mi).second.vout.size()))\n+        {\n+            // get the scriptPubKey of the prevout\n+            const CScript& scriptPubKey = (*mi).second.vout[(*it).prevout.n].scriptPubKey;\n+\n+            CScript& scriptSigRes = tx.vin[nIn].scriptSig; //reference to the CMutableTx scriptSig\n+            txSignSuccess = ProduceSignature(TransactionSignatureCreator(pwalletMain, &txNewConst, nIn, SIGHASH_ALL), scriptPubKey, scriptSigRes);\n+\n+            if (!txSignSuccess)\n+                break;\n+        }\n+        nIn++;\n+    }\n+\n+    if (!txSignSuccess)\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Can't sign transaction.\");\n+\n+    // commit/broadcast the transaction\n+    CWalletTx wtxBumped(pwalletMain,tx);\n+    if (!pwalletMain->CommitTransaction(wtxBumped, reservekey))\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Error: The transaction was rejected! Did you already bump the fee for this transaction?\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r59717635",
      "id" : 59717635,
      "original_commit_id" : "45b6ec5d22577e8152cdedf1ff4772d432b654cf",
      "original_position" : 219,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 219,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/59717635",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "@jonasschnelli Can you please separate \"Bitcoin-Tx / CreateRawTransaction\" changes into new PR, so this can get merged?",
      "created_at" : "2016-04-26T07:06:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#issuecomment-214640789",
      "id" : 214640789,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7865",
      "updated_at" : "2016-04-26T07:06:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/214640789",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "@jonasschnelli maybe unrelated to this PR, or I should bring that up in a meeting (sadly it is 4am in japan when there is core meeting), but I think a better (or alternative) bumpfee would be one which take the number of block to confirm. As a developer using the RPC API, I'd like my backend to bump fees periodically to reach confirmation target in case of fee increase. So that bumpfee <txid> 3 would mean \"put whatever fee at current rate that can confirm into 3 blocks\". If the calculated fee are smaller than current one, then it would do be a no op.\r\n\r\nIt might not belong to this PR though.\r\n\r\nIt would also be used if I initially said \"confirm into 20 blocks\", then changed my mind and say \"now I want to confirm in the next block\".",
      "created_at" : "2016-04-26T08:45:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#issuecomment-214670775",
      "id" : 214670775,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7865",
      "updated_at" : "2016-04-26T08:47:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/214670775",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "body" : "@NicolasDorier: I agree that a confirm target for the `bumpfee` command would make sense.\r\nThe variable confirm target for `CreateTransaction` would require some refactoring.\r\n\r\nThis PR is already relatively large, we should probably add this feature in another PR.",
      "created_at" : "2016-04-27T13:54:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#issuecomment-215090659",
      "id" : 215090659,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7865",
      "updated_at" : "2016-04-27T13:54:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/215090659",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "right, utACK",
      "created_at" : "2016-04-27T14:04:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#issuecomment-215093983",
      "id" : 215093983,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7865",
      "updated_at" : "2016-04-27T14:04:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/215093983",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=3",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r61263413"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61263413"
         }
      },
      "body" : "Nicolas and I have sorted out that problem.\r\nThe current bumpfee command takes the old fee as base fee, runs the coin selection (<n> new inputs might be required to bump the fee) which results in:\r\n`newFee = oldFee + feeOfNewStandaloneTransaction`\r\n\r\nAt the moment, this results in ~doubling the fee.",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-04-27T14:10:11Z",
      "diff_hunk" : "@@ -2500,6 +2511,107 @@ UniValue fundrawtransaction(const UniValue& params, bool fHelp)\n     return result;\n }\n \n+UniValue bumpfee(const UniValue& params, bool fHelp)\n+{\n+    if (!EnsureWalletIsAvailable(fHelp))\n+        return NullUniValue;\n+\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+                            \"bumpfee \\\"txid\\\"\\n\"\n+                            \"\\nBumps the fee of a opt-in-RBF transaction.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. \\\"transactionid\\\"  (string, required) The transaction id\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"{\\n\"\n+                            \"  \\\"txid\\\":    \\\"value\\\", (string)  The id of the new transaction\\n\"\n+                            \"  \\\"oldfee\\\":    n,         (numeric) Fee of the replaced transaction\\n\"\n+                            \"  \\\"fee\\\":       n,         (numeric) Fee the resulting transaction pays\\n\"\n+                            \"}\\n\"\n+                            \"\\nExamples:\\n\"\n+                            \"\\nBump the fee, get the new transactions txid\\n\"\n+                            + HelpExampleCli(\"bumpfee\", \"<txid>\")\n+                            );\n+\n+    RPCTypeCheck(params, boost::assign::list_of(UniValue::VSTR));\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    // get the transaction\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    // ownly bump the fee if the transation signals opt-in-RBF after BIP125\n+    if (!SignalsOptInRBF(wtx))\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Transaction can't be replaced\");\n+\n+    // get the old fee to allow oldfee+newfee\n+    CAmount nDebit = wtx.GetDebit(ISMINE_SPENDABLE);\n+    CAmount nOldFee = -(wtx.IsFromMe(ISMINE_SPENDABLE) ? wtx.GetValueOut() - nDebit : 0);\n+    CAmount nFee = nOldFee; //set the old fee as the base fee\n+\n+    CMutableTransaction tx(wtx);\n+    // remove scriptSigs, the signatures are invalid after mutating the transaction\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        (*it).scriptSig = CScript();\n+    }\n+\n+    // remove \"old\" change outputs\n+    for (std::vector<CTxOut>::iterator it(tx.vout.begin()); it != tx.vout.end();)\n+    {\n+        if (pwalletMain->IsMine(*it) == ISMINE_SPENDABLE)\n+            it = tx.vout.erase(it);\n+        else\n+            ++it;\n+    }\n+\n+    string strFailReason;\n+    int nChangePos = -1;\n+\n+    // re-fund the transaction, a new change output will be added\n+    CReserveKey reservekey(pwalletMain);\n+    if(!pwalletMain->FundTransaction(tx, reservekey, nFee, nChangePos, strFailReason, false))\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, strFailReason);\n+\n+    // sign the new transaction\n+    int nIn = 0;\n+    CTransaction txNewConst(tx);\n+    bool txSignSuccess = false;\n+    for (std::vector<CTxIn>::iterator it(tx.vin.begin()); it != tx.vin.end(); ++it)\n+    {\n+        std::map<uint256, CWalletTx>::const_iterator mi = pwalletMain->mapWallet.find((*it).prevout.hash);\n+        if (mi != pwalletMain->mapWallet.end() && (nIn < (int)(*mi).second.vout.size()))\n+        {\n+            // get the scriptPubKey of the prevout\n+            const CScript& scriptPubKey = (*mi).second.vout[(*it).prevout.n].scriptPubKey;\n+\n+            CScript& scriptSigRes = tx.vin[nIn].scriptSig; //reference to the CMutableTx scriptSig\n+            txSignSuccess = ProduceSignature(TransactionSignatureCreator(pwalletMain, &txNewConst, nIn, SIGHASH_ALL), scriptPubKey, scriptSigRes);\n+\n+            if (!txSignSuccess)\n+                break;\n+        }\n+        nIn++;\n+    }\n+\n+    if (!txSignSuccess)\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Can't sign transaction.\");\n+\n+    // commit/broadcast the transaction\n+    CWalletTx wtxBumped(pwalletMain,tx);\n+    if (!pwalletMain->CommitTransaction(wtxBumped, reservekey))\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Error: The transaction was rejected! Did you already bump the fee for this transaction?\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r61263413",
      "id" : 61263413,
      "original_commit_id" : "45b6ec5d22577e8152cdedf1ff4772d432b654cf",
      "original_position" : 219,
      "path" : "src/wallet/rpcwallet.cpp",
      "position" : 219,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/61263413",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Removed `createrawtransaction` and bitcoin-tx commits because they are now in #7957.",
      "created_at" : "2016-04-28T08:41:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#issuecomment-215354020",
      "id" : 215354020,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7865",
      "updated_at" : "2016-04-28T08:41:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/215354020",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Needed rebase.",
      "created_at" : "2016-05-06T09:21:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#issuecomment-217394873",
      "id" : 217394873,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7865",
      "updated_at" : "2016-05-06T09:21:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/217394873",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r62307586"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62307586"
         }
      },
      "body" : "Mind to change this to py3?",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-05-06T09:32:42Z",
      "diff_hunk" : "@@ -0,0 +1,85 @@\n+#!/usr/bin/env python2",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r62307586",
      "id" : 62307586,
      "original_commit_id" : "5a4cb5eec389769a051a7bba6156a9f0808a9ea8",
      "original_position" : 1,
      "path" : "qa/rpc-tests/bumpfee.py",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62307586",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r62307719"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62307719"
         }
      },
      "body" : "Can you move the assert into the try block? (Keeps the scope clear)",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-05-06T09:33:59Z",
      "diff_hunk" : "@@ -0,0 +1,85 @@\n+#!/usr/bin/env python2\n+# Copyright (c) 2016 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class BumpFeeTest (BitcoinTestFramework):\n+\n+    def setup_chain(self):\n+        print(\"Initializing test directory \"+self.options.tmpdir)\n+        initialize_chain_clean(self.options.tmpdir, 4)\n+\n+    def setup_network(self, split=False):\n+        self.nodes = start_nodes(3, self.options.tmpdir)\n+        connect_nodes_bi(self.nodes,0,1)\n+        connect_nodes_bi(self.nodes,1,2)\n+        connect_nodes_bi(self.nodes,0,2)\n+        self.is_network_split=False\n+        self.sync_all()\n+\n+    def run_test (self):\n+        print \"Mining blocks...\"\n+\n+        self.nodes[0].generate(1)\n+\n+        walletinfo = self.nodes[0].getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 50)\n+        assert_equal(walletinfo['balance'], 0)\n+\n+        self.sync_all()\n+        self.nodes[1].generate(101)\n+        self.sync_all()\n+\n+        assert_equal(self.nodes[0].getbalance(), 50)\n+        assert_equal(self.nodes[1].getbalance(), 50)\n+        assert_equal(self.nodes[2].getbalance(), 0)\n+\n+        # create a opt-in RBF transaction\n+        rbftx = self.nodes[0].sendtoaddress(self.nodes[2].getnewaddress(), 5, \"\", \"\", True, True)\n+        rbftxraw = self.nodes[0].gettransaction(rbftx)\n+        bumpedrawtx = self.nodes[0].bumpfee(rbftx)\n+        assert(bumpedrawtx['fee'] - rbftxraw['fee'] > 0) #make sure the fee is at least higher\n+        \n+        rbftxrawsignedN2= self.nodes[0].getrawtransaction(bumpedrawtx['txid'])\n+        sync_mempools(self.nodes)\n+        rbftxrawsignedN0= self.nodes[1].getrawtransaction(bumpedrawtx['txid'])\n+        assert_equal(rbftxrawsignedN2, rbftxrawsignedN0) #node0 should have the transacion\n+        self.sync_all()\n+        \n+        # try to get the replaced transaction, should be evicted from the mempool\n+        replacedTx = \"\"\n+        try:\n+            replacedTx= self.nodes[1].getrawtransaction(rbftx)\n+        except JSONRPCException as e:\n+            pass\n+        assert_equal(len(replacedTx), 0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r62307719",
      "id" : 62307719,
      "original_commit_id" : "5a4cb5eec389769a051a7bba6156a9f0808a9ea8",
      "original_position" : 58,
      "path" : "qa/rpc-tests/bumpfee.py",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62307719",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r62307872"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62307872"
         }
      },
      "body" : "I don't like this syntax: #7801\r\n\r\nMind to move the assert into the except block?",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-05-06T09:35:39Z",
      "diff_hunk" : "@@ -0,0 +1,85 @@\n+#!/usr/bin/env python2\n+# Copyright (c) 2016 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class BumpFeeTest (BitcoinTestFramework):\n+\n+    def setup_chain(self):\n+        print(\"Initializing test directory \"+self.options.tmpdir)\n+        initialize_chain_clean(self.options.tmpdir, 4)\n+\n+    def setup_network(self, split=False):\n+        self.nodes = start_nodes(3, self.options.tmpdir)\n+        connect_nodes_bi(self.nodes,0,1)\n+        connect_nodes_bi(self.nodes,1,2)\n+        connect_nodes_bi(self.nodes,0,2)\n+        self.is_network_split=False\n+        self.sync_all()\n+\n+    def run_test (self):\n+        print \"Mining blocks...\"\n+\n+        self.nodes[0].generate(1)\n+\n+        walletinfo = self.nodes[0].getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 50)\n+        assert_equal(walletinfo['balance'], 0)\n+\n+        self.sync_all()\n+        self.nodes[1].generate(101)\n+        self.sync_all()\n+\n+        assert_equal(self.nodes[0].getbalance(), 50)\n+        assert_equal(self.nodes[1].getbalance(), 50)\n+        assert_equal(self.nodes[2].getbalance(), 0)\n+\n+        # create a opt-in RBF transaction\n+        rbftx = self.nodes[0].sendtoaddress(self.nodes[2].getnewaddress(), 5, \"\", \"\", True, True)\n+        rbftxraw = self.nodes[0].gettransaction(rbftx)\n+        bumpedrawtx = self.nodes[0].bumpfee(rbftx)\n+        assert(bumpedrawtx['fee'] - rbftxraw['fee'] > 0) #make sure the fee is at least higher\n+        \n+        rbftxrawsignedN2= self.nodes[0].getrawtransaction(bumpedrawtx['txid'])\n+        sync_mempools(self.nodes)\n+        rbftxrawsignedN0= self.nodes[1].getrawtransaction(bumpedrawtx['txid'])\n+        assert_equal(rbftxrawsignedN2, rbftxrawsignedN0) #node0 should have the transacion\n+        self.sync_all()\n+        \n+        # try to get the replaced transaction, should be evicted from the mempool\n+        replacedTx = \"\"\n+        try:\n+            replacedTx= self.nodes[1].getrawtransaction(rbftx)\n+        except JSONRPCException as e:\n+            pass\n+        assert_equal(len(replacedTx), 0)\n+        \n+        oldwtx = self.nodes[0].gettransaction(rbftx)\n+        assert(len(oldwtx['walletconflicts']) > 0)\n+        assert(rbftx not in self.nodes[0].getrawmempool())\n+        \n+        self.nodes[1].generate(1)\n+        self.sync_all()\n+        \n+        rbftx = self.nodes[2].sendmany('', {self.nodes[1].getnewaddress() : 1, self.nodes[1].getnewaddress() : 2}, 0, \"\", [], True)\n+        bumpedrawtx = self.nodes[2].bumpfee(rbftx)\n+        self.sync_all()\n+        \n+        assert(rbftx not in self.nodes[0].getrawmempool())\n+        assert(bumpedrawtx['txid'] in self.nodes[0].getrawmempool())\n+        \n+        # try to replace a non RBF transaction\n+        nonrbftx = self.nodes[0].sendtoaddress(self.nodes[2].getnewaddress(), 1, \"\", \"\", True, False)\n+        \n+        errorString = \"\"\n+        try:\n+            bumpedrawtx = self.nodes[0].bumpfee(nonrbftx)\n+        except JSONRPCException as e:\n+            errorString = e.error['message']\n+        assert(len(errorString) > 0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r62307872",
      "id" : 62307872,
      "original_commit_id" : "5a4cb5eec389769a051a7bba6156a9f0808a9ea8",
      "original_position" : 82,
      "path" : "qa/rpc-tests/bumpfee.py",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62307872",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "body" : "Migrated test to python3, fixed @MarcoFalke nits.",
      "created_at" : "2016-05-06T10:14:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#issuecomment-217404106",
      "id" : 217404106,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7865",
      "updated_at" : "2016-05-06T10:14:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/217404106",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r62312522"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62312522"
         }
      },
      "body" : "You don't need the errorString, just `assert(len(e.error['message']) > 0)` or `assert_raises(JSONRPCException, ...`",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-05-06T10:23:33Z",
      "diff_hunk" : "@@ -0,0 +1,86 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2016 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class BumpFeeTest (BitcoinTestFramework):\n+\n+    def setup_chain(self):\n+        print(\"Initializing test directory \"+self.options.tmpdir)\n+        initialize_chain_clean(self.options.tmpdir, 4)\n+\n+    def setup_network(self, split=False):\n+        self.nodes = start_nodes(3, self.options.tmpdir)\n+        connect_nodes_bi(self.nodes,0,1)\n+        connect_nodes_bi(self.nodes,1,2)\n+        connect_nodes_bi(self.nodes,0,2)\n+        self.is_network_split=False\n+        self.sync_all()\n+\n+    def run_test (self):\n+        print(\"Mining blocks...\")\n+\n+        self.nodes[0].generate(1)\n+\n+        walletinfo = self.nodes[0].getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 50)\n+        assert_equal(walletinfo['balance'], 0)\n+\n+        self.sync_all()\n+        self.nodes[1].generate(101)\n+        self.sync_all()\n+\n+        assert_equal(self.nodes[0].getbalance(), 50)\n+        assert_equal(self.nodes[1].getbalance(), 50)\n+        assert_equal(self.nodes[2].getbalance(), 0)\n+\n+        # create a opt-in RBF transaction\n+        rbftx = self.nodes[0].sendtoaddress(self.nodes[2].getnewaddress(), 5, \"\", \"\", True, True)\n+        rbftxraw = self.nodes[0].gettransaction(rbftx)\n+        bumpedrawtx = self.nodes[0].bumpfee(rbftx)\n+        assert(bumpedrawtx['fee'] - rbftxraw['fee'] > 0) #make sure the fee is at least higher\n+\n+        rbftxrawsignedN2= self.nodes[0].getrawtransaction(bumpedrawtx['txid'])\n+        sync_mempools(self.nodes)\n+        rbftxrawsignedN0= self.nodes[1].getrawtransaction(bumpedrawtx['txid'])\n+        assert_equal(rbftxrawsignedN2, rbftxrawsignedN0) #node0 should have the transacion\n+        self.sync_all()\n+\n+        # try to get the replaced transaction, should be evicted from the mempool\n+        replacedTx = \"\"\n+        try:\n+            replacedTx= self.nodes[1].getrawtransaction(rbftx)\n+            assert(False)\n+        except JSONRPCException as e:\n+            assert_equal(len(replacedTx), 0)\n+\n+        oldwtx = self.nodes[0].gettransaction(rbftx)\n+        assert(len(oldwtx['walletconflicts']) > 0)\n+        assert(rbftx not in self.nodes[0].getrawmempool())\n+\n+        self.nodes[1].generate(1)\n+        self.sync_all()\n+\n+        rbftx = self.nodes[2].sendmany('', {self.nodes[1].getnewaddress() : 1, self.nodes[1].getnewaddress() : 2}, 0, \"\", [], True)\n+        bumpedrawtx = self.nodes[2].bumpfee(rbftx)\n+        self.sync_all()\n+\n+        assert(rbftx not in self.nodes[0].getrawmempool())\n+        assert(bumpedrawtx['txid'] in self.nodes[0].getrawmempool())\n+\n+        # try to replace a non RBF transaction\n+        nonrbftx = self.nodes[0].sendtoaddress(self.nodes[2].getnewaddress(), 1, \"\", \"\", True, False)\n+\n+        errorString = \"\"\n+        try:\n+            bumpedrawtx = self.nodes[0].bumpfee(nonrbftx)\n+            assert(False)\n+        except JSONRPCException as e:\n+            errorString = e.error['message']\n+            assert(len(errorString) > 0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r62312522",
      "id" : 62312522,
      "original_commit_id" : "84085d19a3e55ec698bb0790d996dace1f36135c",
      "original_position" : 83,
      "path" : "qa/rpc-tests/bumpfee.py",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62312522",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r62312529"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62312529"
         }
      },
      "body" : "Is this doing anything different that `assert_raises(JSONRPCException, ...`?",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-05-06T10:23:39Z",
      "diff_hunk" : "@@ -0,0 +1,86 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2016 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class BumpFeeTest (BitcoinTestFramework):\n+\n+    def setup_chain(self):\n+        print(\"Initializing test directory \"+self.options.tmpdir)\n+        initialize_chain_clean(self.options.tmpdir, 4)\n+\n+    def setup_network(self, split=False):\n+        self.nodes = start_nodes(3, self.options.tmpdir)\n+        connect_nodes_bi(self.nodes,0,1)\n+        connect_nodes_bi(self.nodes,1,2)\n+        connect_nodes_bi(self.nodes,0,2)\n+        self.is_network_split=False\n+        self.sync_all()\n+\n+    def run_test (self):\n+        print(\"Mining blocks...\")\n+\n+        self.nodes[0].generate(1)\n+\n+        walletinfo = self.nodes[0].getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 50)\n+        assert_equal(walletinfo['balance'], 0)\n+\n+        self.sync_all()\n+        self.nodes[1].generate(101)\n+        self.sync_all()\n+\n+        assert_equal(self.nodes[0].getbalance(), 50)\n+        assert_equal(self.nodes[1].getbalance(), 50)\n+        assert_equal(self.nodes[2].getbalance(), 0)\n+\n+        # create a opt-in RBF transaction\n+        rbftx = self.nodes[0].sendtoaddress(self.nodes[2].getnewaddress(), 5, \"\", \"\", True, True)\n+        rbftxraw = self.nodes[0].gettransaction(rbftx)\n+        bumpedrawtx = self.nodes[0].bumpfee(rbftx)\n+        assert(bumpedrawtx['fee'] - rbftxraw['fee'] > 0) #make sure the fee is at least higher\n+\n+        rbftxrawsignedN2= self.nodes[0].getrawtransaction(bumpedrawtx['txid'])\n+        sync_mempools(self.nodes)\n+        rbftxrawsignedN0= self.nodes[1].getrawtransaction(bumpedrawtx['txid'])\n+        assert_equal(rbftxrawsignedN2, rbftxrawsignedN0) #node0 should have the transacion\n+        self.sync_all()\n+\n+        # try to get the replaced transaction, should be evicted from the mempool\n+        replacedTx = \"\"\n+        try:\n+            replacedTx= self.nodes[1].getrawtransaction(rbftx)\n+            assert(False)\n+        except JSONRPCException as e:\n+            assert_equal(len(replacedTx), 0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r62312529",
      "id" : 62312529,
      "original_commit_id" : "84085d19a3e55ec698bb0790d996dace1f36135c",
      "original_position" : 58,
      "path" : "qa/rpc-tests/bumpfee.py",
      "position" : 58,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62312529",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=3",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r62313502"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62313502"
         }
      },
      "body" : "Right. Fixed.",
      "commit_id" : "9569bb0b0a9b8b2beaa3d6669c39759702acf38d",
      "created_at" : "2016-05-06T10:34:57Z",
      "diff_hunk" : "@@ -0,0 +1,86 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2016 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+\n+class BumpFeeTest (BitcoinTestFramework):\n+\n+    def setup_chain(self):\n+        print(\"Initializing test directory \"+self.options.tmpdir)\n+        initialize_chain_clean(self.options.tmpdir, 4)\n+\n+    def setup_network(self, split=False):\n+        self.nodes = start_nodes(3, self.options.tmpdir)\n+        connect_nodes_bi(self.nodes,0,1)\n+        connect_nodes_bi(self.nodes,1,2)\n+        connect_nodes_bi(self.nodes,0,2)\n+        self.is_network_split=False\n+        self.sync_all()\n+\n+    def run_test (self):\n+        print(\"Mining blocks...\")\n+\n+        self.nodes[0].generate(1)\n+\n+        walletinfo = self.nodes[0].getwalletinfo()\n+        assert_equal(walletinfo['immature_balance'], 50)\n+        assert_equal(walletinfo['balance'], 0)\n+\n+        self.sync_all()\n+        self.nodes[1].generate(101)\n+        self.sync_all()\n+\n+        assert_equal(self.nodes[0].getbalance(), 50)\n+        assert_equal(self.nodes[1].getbalance(), 50)\n+        assert_equal(self.nodes[2].getbalance(), 0)\n+\n+        # create a opt-in RBF transaction\n+        rbftx = self.nodes[0].sendtoaddress(self.nodes[2].getnewaddress(), 5, \"\", \"\", True, True)\n+        rbftxraw = self.nodes[0].gettransaction(rbftx)\n+        bumpedrawtx = self.nodes[0].bumpfee(rbftx)\n+        assert(bumpedrawtx['fee'] - rbftxraw['fee'] > 0) #make sure the fee is at least higher\n+\n+        rbftxrawsignedN2= self.nodes[0].getrawtransaction(bumpedrawtx['txid'])\n+        sync_mempools(self.nodes)\n+        rbftxrawsignedN0= self.nodes[1].getrawtransaction(bumpedrawtx['txid'])\n+        assert_equal(rbftxrawsignedN2, rbftxrawsignedN0) #node0 should have the transacion\n+        self.sync_all()\n+\n+        # try to get the replaced transaction, should be evicted from the mempool\n+        replacedTx = \"\"\n+        try:\n+            replacedTx= self.nodes[1].getrawtransaction(rbftx)\n+            assert(False)\n+        except JSONRPCException as e:\n+            assert_equal(len(replacedTx), 0)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7865#discussion_r62313502",
      "id" : 62313502,
      "original_commit_id" : "84085d19a3e55ec698bb0790d996dace1f36135c",
      "original_position" : 58,
      "path" : "qa/rpc-tests/bumpfee.py",
      "position" : 58,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7865",
      "updated_at" : "2016-05-06T10:34:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/62313502",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   }
]
