[
   {
      "body" : "Nice!\r\nConcept ACK.",
      "created_at" : "2016-04-13T14:30:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#issuecomment-209475161",
      "id" : 209475161,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7871",
      "updated_at" : "2016-04-13T14:30:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/209475161",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "What use cases are motivating this mode?",
      "created_at" : "2016-04-13T20:13:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#issuecomment-209626841",
      "id" : 209626841,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7871",
      "updated_at" : "2016-04-13T20:13:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/209626841",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "body" : "Concept ACK\r\n\r\n> What use cases are motivating this mode?\r\n\r\nThis is explained in the original issue, #7365: if you have another application that needs to consume the block data before it's gone.\r\n",
      "created_at" : "2016-04-15T06:28:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#issuecomment-210304363",
      "id" : 210304363,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7871",
      "updated_at" : "2016-04-15T06:28:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/210304363",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Should have read the issue, sorry. Concept ACK",
      "created_at" : "2016-04-15T11:12:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#issuecomment-210419602",
      "id" : 210419602,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7871",
      "updated_at" : "2016-04-15T11:12:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/210419602",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/5767891?v=3",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "body" : "Concept ACK. Needs rebase.",
      "created_at" : "2016-06-02T14:30:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#issuecomment-223309524",
      "id" : 223309524,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7871",
      "updated_at" : "2016-06-02T14:30:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/223309524",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "body" : "Rebased. ",
      "created_at" : "2016-06-08T18:26:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#issuecomment-224683681",
      "id" : 224683681,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7871",
      "updated_at" : "2016-06-08T18:26:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/224683681",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7504522?v=3",
         "events_url" : "https://api.github.com/users/mrbandrews/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mrbandrews/followers",
         "following_url" : "https://api.github.com/users/mrbandrews/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mrbandrews/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mrbandrews",
         "id" : 7504522,
         "login" : "mrbandrews",
         "organizations_url" : "https://api.github.com/users/mrbandrews/orgs",
         "received_events_url" : "https://api.github.com/users/mrbandrews/received_events",
         "repos_url" : "https://api.github.com/users/mrbandrews/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mrbandrews/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mrbandrews/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mrbandrews"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r76030706"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/76030706"
         }
      },
      "body" : "I usually get told off for using global variables. Curious to know when they are permitted and when they are discouraged.",
      "commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "created_at" : "2016-08-24T10:16:02Z",
      "diff_hunk" : "@@ -3617,10 +3618,44 @@ void UnlinkPrunedFiles(std::set<int>& setFilesToPrune)\n     }\n }\n \n+/* This function is called from the RPC code for pruneblockchain */\n+void PruneBlockFilesManual(int manualPruneHeight)\n+{\n+    // stuff the prune height into a global variable, and flush",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r76030706",
      "id" : 76030706,
      "original_commit_id" : "2695b56531dcb5b4914364a49a6431a8c91a0df0",
      "original_position" : 62,
      "path" : "src/main.cpp",
      "position" : 61,
      "pull_request_review_id" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871",
      "updated_at" : "2016-09-07T13:59:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/76030706",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1530283?v=3",
         "events_url" : "https://api.github.com/users/rebroad/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rebroad/followers",
         "following_url" : "https://api.github.com/users/rebroad/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rebroad/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rebroad",
         "id" : 1530283,
         "login" : "rebroad",
         "organizations_url" : "https://api.github.com/users/rebroad/orgs",
         "received_events_url" : "https://api.github.com/users/rebroad/received_events",
         "repos_url" : "https://api.github.com/users/rebroad/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rebroad/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rebroad"
      }
   },
   {
      "body" : "Needs rebase.",
      "created_at" : "2016-08-25T11:58:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#issuecomment-242360917",
      "id" : 242360917,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7871",
      "updated_at" : "2016-08-25T11:58:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/242360917",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81861504"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81861504"
         }
      },
      "body" : "Many places, you left (pruneMode) in a boolean context. I don't see a need to change to == NONE here.",
      "commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "created_at" : "2016-10-04T21:47:57Z",
      "diff_hunk" : "@@ -1335,7 +1338,7 @@ bool AppInit2(boost::thread_group& threadGroup, CScheduler& scheduler)\n \n                 // Check for changed -prune state.  What we are concerned about is a user who has pruned blocks\n                 // in the past, but is now trying to run unpruned.\n-                if (fHavePruned && !fPruneMode) {\n+                if (fHavePruned && pruneMode==PRUNE_NONE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81861504",
      "id" : 81861504,
      "original_commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "original_position" : 41,
      "path" : "src/init.cpp",
      "position" : 41,
      "pull_request_review_id" : 2810919,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871",
      "updated_at" : "2016-10-04T22:15:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81861504",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81861586"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81861586"
         }
      },
      "body" : "A bit ugly to have the enum and variable differ only by case.",
      "commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "created_at" : "2016-10-04T21:48:29Z",
      "diff_hunk" : "@@ -71,13 +71,14 @@ bool fImporting = false;\n bool fReindex = false;\n bool fTxIndex = false;\n bool fHavePruned = false;\n-bool fPruneMode = false;\n+PruneMode pruneMode = PRUNE_NONE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81861586",
      "id" : 81861586,
      "original_commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "original_position" : 5,
      "path" : "src/main.cpp",
      "position" : 5,
      "pull_request_review_id" : 2810919,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871",
      "updated_at" : "2016-10-04T22:15:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81861586",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81861912"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81861912"
         }
      },
      "body" : "This appears to be used exclusively for passing a value from a caller to a callee, so it shouldn't be a global variable.",
      "commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "created_at" : "2016-10-04T21:50:32Z",
      "diff_hunk" : "@@ -71,13 +71,14 @@ bool fImporting = false;\n bool fReindex = false;\n bool fTxIndex = false;\n bool fHavePruned = false;\n-bool fPruneMode = false;\n+PruneMode pruneMode = PRUNE_NONE;\n bool fIsBareMultisigStd = DEFAULT_PERMIT_BAREMULTISIG;\n bool fRequireStandard = true;\n bool fCheckBlockIndex = false;\n bool fCheckpointsEnabled = DEFAULT_CHECKPOINTS_ENABLED;\n size_t nCoinCacheUsage = 5000 * 300;\n uint64_t nPruneTarget = 0;\n+unsigned int nManualPruneHeight = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81861912",
      "id" : 81861912,
      "original_commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "original_position" : 12,
      "path" : "src/main.cpp",
      "position" : 12,
      "pull_request_review_id" : 2810919,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871",
      "updated_at" : "2016-10-04T22:15:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81861912",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81863471"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81863471"
         }
      },
      "body" : "`int` is the wrong type here. It is only guaranteed to hold up to 32768, which isn't very useful for block heights.\r\n\r\nLock heights will break before 29 bits are exceeded, so I suggest using either `unsigned long` or `uint32_t`",
      "commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "created_at" : "2016-10-04T21:59:41Z",
      "diff_hunk" : "@@ -3842,10 +3843,44 @@ void UnlinkPrunedFiles(std::set<int>& setFilesToPrune)\n     }\n }\n \n+/* This function is called from the RPC code for pruneblockchain */\n+void PruneBlockFilesManual(int manualPruneHeight)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81863471",
      "id" : 81863471,
      "original_commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "original_position" : 59,
      "path" : "src/main.cpp",
      "position" : 59,
      "pull_request_review_id" : 2810919,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871",
      "updated_at" : "2016-10-04T22:15:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81863471",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81864786"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81864786"
         }
      },
      "body" : "We're trying to reduce calls to global Params() by passing things as arguments. This change has the opposite effect for no clear reason.",
      "commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "created_at" : "2016-10-04T22:08:35Z",
      "diff_hunk" : "@@ -3842,10 +3843,44 @@ void UnlinkPrunedFiles(std::set<int>& setFilesToPrune)\n     }\n }\n \n+/* This function is called from the RPC code for pruneblockchain */\n+void PruneBlockFilesManual(int manualPruneHeight)\n+{\n+    // stuff the prune height into a global variable, and flush\n+    nManualPruneHeight = (unsigned) manualPruneHeight;\n+    fCheckForPruning = true;\n+    CValidationState state;\n+    FlushStateToDisk(state, FLUSH_STATE_NONE);\n+}\n+\n+/* Calculate the block/rev files to delete based on height specified by user with RPC command pruneblockchain */\n+void FindFilesToPruneManual(std::set<int>& setFilesToPrune)\n+{\n+    LOCK2(cs_main, cs_LastBlockFile);\n+    if (chainActive.Tip() == NULL || pruneMode != PRUNE_MANUAL) {\n+        return;\n+    }\n+\n+    // last block to prune is the lesser of (user-specified height, MIN_BLOCKS_TO_KEEP from the tip)\n+    unsigned int nLastBlockWeCanPrune = min(nManualPruneHeight, chainActive.Tip()->nHeight - MIN_BLOCKS_TO_KEEP);\n+    int count=0;\n+    for (int fileNumber = 0; fileNumber < nLastBlockFile; fileNumber++) {\n+        if (vinfoBlockFile[fileNumber].nSize == 0 || vinfoBlockFile[fileNumber].nHeightLast > nLastBlockWeCanPrune)\n+            continue;\n+        PruneOneBlockFile(fileNumber);\n+        setFilesToPrune.insert(fileNumber);\n+        count++;\n+    }\n+    LogPrintf(\"Prune (Manual): prune_height=%d removed %d blk/rev pairs\\n\", nLastBlockWeCanPrune, count);\n+}\n+\n /* Calculate the block/rev files that should be deleted to remain under target*/\n-void FindFilesToPrune(std::set<int>& setFilesToPrune, uint64_t nPruneAfterHeight)\n+void FindFilesToPruneAuto(std::set<int>& setFilesToPrune)\n {\n     LOCK2(cs_main, cs_LastBlockFile);\n+    const CChainParams& chainparams = Params();\n+    uint64_t nPruneAfterHeight = chainparams.PruneAfterHeight();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81864786",
      "id" : 81864786,
      "original_commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "original_position" : 95,
      "path" : "src/main.cpp",
      "position" : 95,
      "pull_request_review_id" : 2810919,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871",
      "updated_at" : "2016-10-04T22:15:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81864786",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81865305"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81865305"
         }
      },
      "body" : "`RPC_INVALID_PARAMETER` seems more appropriate here.",
      "commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "created_at" : "2016-10-04T22:11:45Z",
      "diff_hunk" : "@@ -670,6 +670,32 @@ static bool GetUTXOStats(CCoinsView *view, CCoinsStats &stats)\n     return true;\n }\n \n+UniValue pruneblockchain(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+            \"pruneblockchain\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"height\\\"       (int, required) The block height to prune up to.\\n\");\n+\n+    if (pruneMode != PRUNE_MANUAL) {\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, \"Cannot prune via RPC unless in manual prune mode.\");\n+        return 0;\n+    }\n+\n+    LOCK(cs_main);\n+\n+    int height = params[0].get_int();\n+    if (height < 0) {\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, \"Negative block height.\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81865305",
      "id" : 81865305,
      "original_commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "original_position" : 21,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 21,
      "pull_request_review_id" : 2810919,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871",
      "updated_at" : "2016-10-04T22:15:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81865305",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81865459"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81865459"
         }
      },
      "body" : "Should this also check if the requested height is too close to the tip? Or maybe just return the height it was able to successfully prune up to...",
      "commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "created_at" : "2016-10-04T22:12:41Z",
      "diff_hunk" : "@@ -670,6 +670,32 @@ static bool GetUTXOStats(CCoinsView *view, CCoinsStats &stats)\n     return true;\n }\n \n+UniValue pruneblockchain(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+            \"pruneblockchain\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"height\\\"       (int, required) The block height to prune up to.\\n\");\n+\n+    if (pruneMode != PRUNE_MANUAL) {\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, \"Cannot prune via RPC unless in manual prune mode.\");\n+        return 0;\n+    }\n+\n+    LOCK(cs_main);\n+\n+    int height = params[0].get_int();\n+    if (height < 0) {\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, \"Negative block height.\");\n+    } else if ((unsigned int) chainActive.Height() < Params().PruneAfterHeight()) {\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, \"Blockchain is too short for pruning.\");\n+    }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81865459",
      "id" : 81865459,
      "original_commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "original_position" : 24,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 24,
      "pull_request_review_id" : 2810919,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871",
      "updated_at" : "2016-10-04T22:15:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81865459",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81865686"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81865686"
         }
      },
      "body" : "`RPC_METHOD_NOT_FOUND` seems better for this (already used for wallet RPCs when the wallet is not enabled)",
      "commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "created_at" : "2016-10-04T22:14:16Z",
      "diff_hunk" : "@@ -670,6 +670,32 @@ static bool GetUTXOStats(CCoinsView *view, CCoinsStats &stats)\n     return true;\n }\n \n+UniValue pruneblockchain(const UniValue& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+            \"pruneblockchain\\n\"\n+            \"\\nArguments:\\n\"\n+            \"1. \\\"height\\\"       (int, required) The block height to prune up to.\\n\");\n+\n+    if (pruneMode != PRUNE_MANUAL) {\n+        throw JSONRPCError(RPC_INTERNAL_ERROR, \"Cannot prune via RPC unless in manual prune mode.\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#discussion_r81865686",
      "id" : 81865686,
      "original_commit_id" : "518a942674066b249f8da49a82ee6c90b74fb0c6",
      "original_position" : 13,
      "path" : "src/rpc/blockchain.cpp",
      "position" : 13,
      "pull_request_review_id" : 2810919,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/7871",
      "updated_at" : "2016-10-04T22:15:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/81865686",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Oh, it might make sense to add \"prunemode\": \"auto\"/\"manual\" to `getblockchaininfo` also.",
      "created_at" : "2016-10-04T22:18:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/7871#issuecomment-251530369",
      "id" : 251530369,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/7871",
      "updated_at" : "2016-10-04T22:18:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/251530369",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   }
]
