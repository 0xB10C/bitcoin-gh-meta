[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6451#discussion_r34843019"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6451"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/34843019"
         }
      },
      "body" : "comment should be ```// 1MB blocks until 11 Nov 2015, then 2MB```",
      "commit_id" : "526f8e71d5fe4653b2c6634bc6de2d404e7ac9bd",
      "created_at" : "2015-07-16T22:01:40Z",
      "diff_hunk" : "@@ -6,10 +6,22 @@\n #ifndef BITCOIN_CONSENSUS_CONSENSUS_H\n #define BITCOIN_CONSENSUS_CONSENSUS_H\n \n+static const uint64_t MEG_FORK_TIME = 1447200000; // 11 Nov 2015 00:00:00 UTC\n+\n /** The maximum allowed size for a serialized block, in bytes (network rule) */\n-static const unsigned int MAX_BLOCK_SIZE = 1000000;\n+inline unsigned int MaxBlockSize(uint64_t nBlockTimestamp) {\n+    // 1MB blocks until 1 March 2016, then 20MB",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6451#discussion_r34843019",
      "id" : 34843019,
      "original_commit_id" : "526f8e71d5fe4653b2c6634bc6de2d404e7ac9bd",
      "original_position" : 9,
      "path" : "src/consensus/consensus.h",
      "position" : 9,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6451",
      "updated_at" : "2015-07-16T22:02:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/34843019",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42459?v=3",
         "events_url" : "https://api.github.com/users/djpnewton/events{/privacy}",
         "followers_url" : "https://api.github.com/users/djpnewton/followers",
         "following_url" : "https://api.github.com/users/djpnewton/following{/other_user}",
         "gists_url" : "https://api.github.com/users/djpnewton/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/djpnewton",
         "id" : 42459,
         "login" : "djpnewton",
         "organizations_url" : "https://api.github.com/users/djpnewton/orgs",
         "received_events_url" : "https://api.github.com/users/djpnewton/received_events",
         "repos_url" : "https://api.github.com/users/djpnewton/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/djpnewton/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/djpnewton/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/djpnewton"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6451#discussion_r34843282"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6451"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/34843282"
         }
      },
      "body" : "twenty? (also in comments below)",
      "commit_id" : "526f8e71d5fe4653b2c6634bc6de2d404e7ac9bd",
      "created_at" : "2015-07-16T22:04:53Z",
      "diff_hunk" : "@@ -0,0 +1,102 @@\n+// Copyright (c) 2011-2014 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"main.h\"\n+#include \"miner.h\"\n+#include \"pubkey.h\"\n+#include \"uint256.h\"\n+#include \"util.h\"\n+#include \"consensus/validation.h\"\n+\n+#include \"test/test_bitcoin.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(block_size_tests, TestingSetup)\n+\n+// Fill block with dummy transactions until it's serialized size is exactly nSize\n+static void\n+FillBlock(CBlock& block, unsigned int nSize)\n+{\n+    assert(block.vtx.size() > 0); // Start with at least a coinbase\n+\n+    unsigned int nBlockSize = ::GetSerializeSize(block, SER_NETWORK, PROTOCOL_VERSION);\n+    if (nBlockSize > nSize) {\n+        block.vtx.resize(1); // passed in block is too big, start with just coinbase\n+        nBlockSize = ::GetSerializeSize(block, SER_NETWORK, PROTOCOL_VERSION);\n+    }\n+\n+    // Create a block that is exactly 1,000,000 bytes, serialized:\n+    CMutableTransaction tx;\n+    tx.vin.resize(1);\n+    tx.vin[0].scriptSig = CScript() << OP_11;\n+    tx.vin[0].prevout.hash = block.vtx[0].GetHash(); // passes CheckBlock, would fail if we checked inputs.\n+    tx.vin[0].prevout.n = 0;\n+    tx.vout.resize(1);\n+    tx.vout[0].nValue = 1LL;\n+    tx.vout[0].scriptPubKey = block.vtx[0].vout[0].scriptPubKey;\n+\n+    unsigned int nTxSize = ::GetSerializeSize(tx, SER_NETWORK, PROTOCOL_VERSION);\n+    uint256 txhash = tx.GetHash();\n+\n+    // ... add copies of tx to the block to get close to 1MB:\n+    while (nBlockSize+nTxSize < nSize) {\n+        block.vtx.push_back(tx);\n+        nBlockSize += nTxSize;\n+        tx.vin[0].prevout.hash = txhash; // ... just to make each transaction unique\n+        txhash = tx.GetHash();\n+    }\n+    // Make the last transaction exactly the right size by making the scriptSig bigger.\n+    block.vtx.pop_back();\n+    nBlockSize = ::GetSerializeSize(block, SER_NETWORK, PROTOCOL_VERSION);\n+    unsigned int nFill = nSize - nBlockSize - nTxSize;\n+    for (unsigned int i = 0; i < nFill; i++)\n+        tx.vin[0].scriptSig << OP_11;\n+    block.vtx.push_back(tx);\n+    nBlockSize = ::GetSerializeSize(block, SER_NETWORK, PROTOCOL_VERSION);\n+    assert(nBlockSize == nSize);\n+}\n+\n+static bool TestCheckBlock(CBlock& block, uint64_t nTime, unsigned int nSize)\n+{\n+    SetMockTime(nTime);\n+    block.nTime = nTime;\n+    FillBlock(block, nSize);\n+    CValidationState validationState;\n+    bool fResult = CheckBlock(block, validationState, false, false) && validationState.IsValid();\n+    SetMockTime(0);\n+    return fResult;\n+}\n+\n+//\n+// Unit test CheckBlock() for conditions around the block size hard fork\n+//\n+BOOST_AUTO_TEST_CASE(TwentyMegFork)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6451#discussion_r34843282",
      "id" : 34843282,
      "original_commit_id" : "526f8e71d5fe4653b2c6634bc6de2d404e7ac9bd",
      "original_position" : 75,
      "path" : "src/test/block_size_tests.cpp",
      "position" : 75,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6451",
      "updated_at" : "2015-07-16T22:04:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/34843282",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42459?v=3",
         "events_url" : "https://api.github.com/users/djpnewton/events{/privacy}",
         "followers_url" : "https://api.github.com/users/djpnewton/followers",
         "following_url" : "https://api.github.com/users/djpnewton/following{/other_user}",
         "gists_url" : "https://api.github.com/users/djpnewton/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/djpnewton",
         "id" : 42459,
         "login" : "djpnewton",
         "organizations_url" : "https://api.github.com/users/djpnewton/orgs",
         "received_events_url" : "https://api.github.com/users/djpnewton/received_events",
         "repos_url" : "https://api.github.com/users/djpnewton/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/djpnewton/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/djpnewton/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/djpnewton"
      }
   },
   {
      "body" : "Note that discussion of this patch should be limited to the code itself on github; discussion of the value of a 2MB hard fork is better suited for the mailing list.",
      "created_at" : "2015-07-17T01:14:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6451#issuecomment-122142105",
      "id" : 122142105,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6451",
      "updated_at" : "2015-07-17T01:14:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/122142105",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Except the difference in size, is this same as Gavin's original 20MB proposal?",
      "created_at" : "2015-07-17T04:52:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6451#issuecomment-122175202",
      "id" : 122175202,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6451",
      "updated_at" : "2015-07-17T04:52:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/122175202",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8403418?v=3",
         "events_url" : "https://api.github.com/users/jl2012/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jl2012/followers",
         "following_url" : "https://api.github.com/users/jl2012/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jl2012/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jl2012",
         "id" : 8403418,
         "login" : "jl2012",
         "organizations_url" : "https://api.github.com/users/jl2012/orgs",
         "received_events_url" : "https://api.github.com/users/jl2012/received_events",
         "repos_url" : "https://api.github.com/users/jl2012/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jl2012/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jl2012/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jl2012"
      }
   }
]
