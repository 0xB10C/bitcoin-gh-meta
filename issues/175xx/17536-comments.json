[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The test looks good so far!\r\n\r\nSome other conditions to check:\r\n\r\n```\r\nrpcwhitelist=user1:A,B,C\r\nrpcwhitelist=user1:B\r\n```\r\n\r\nresults in only B being available, not A or C.\r\n\r\n\r\nTest empty rpcwhitelist\r\n```\r\nrpcwhitelist=user1\r\nrpcwhitelist=user2:\r\n```\r\n\r\nTest trailing comma\r\n```\r\nrpcwhitelist=user1:A,\r\n```\r\n\r\n\r\nTest the above where `whitelistrpcdefault=1` is set. This case is really difficult to do because the testing framework assumes access to the RPCs for setup. So you can set up setting the args for the test-framework's rpc credential to be sufficient, but then testing the case where there are no credentialed users seems... hard! But maybe we're OK with not covering that case via test.\r\n\r\nIt also looks like there is a new method (since I wrote the original test sketch?) called \"add_options\", which you could override to add the command line args... but what's written works so if it ain't broke...\r\n\r\n",
      "created_at" : "2019-11-20T18:39:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#issuecomment-556225907",
      "id" : 556225907,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17536",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NjIyNTkwNw==",
      "updated_at" : "2019-11-20T18:39:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/556225907",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16673](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16673.html) (Relog configuration args on debug.log rotation by LarryRuane)\n* [#16115](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16115.html) (On bitcoind startup, write config args to debug.log by LarryRuane)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-11-20T19:18:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#issuecomment-556271906",
      "id" : 556271906,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17536",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NjI3MTkwNg==",
      "updated_at" : "2019-11-20T19:18:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/556271906",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@JeremyRubin \r\nThe test was written from scratch with a method taken from `rpc_users.py`\r\nI will add your suggestions now",
      "created_at" : "2019-11-20T19:47:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#issuecomment-556305394",
      "id" : 556305394,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17536",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NjMwNTM5NA==",
      "updated_at" : "2019-11-20T19:47:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/556305394",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/12272949?v=4",
         "events_url" : "https://api.github.com/users/emilengler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/emilengler/followers",
         "following_url" : "https://api.github.com/users/emilengler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/emilengler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/emilengler",
         "id" : 12272949,
         "login" : "emilengler",
         "node_id" : "MDQ6VXNlcjEyMjcyOTQ5",
         "organizations_url" : "https://api.github.com/users/emilengler/orgs",
         "received_events_url" : "https://api.github.com/users/emilengler/received_events",
         "repos_url" : "https://api.github.com/users/emilengler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/emilengler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/emilengler"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah yeah -- I just mean that I think the add_options method appears to be new -- newer than rpc_users too I guess? Not sure!",
      "created_at" : "2019-11-20T20:31:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#issuecomment-556355916",
      "id" : 556355916,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17536",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NjM1NTkxNg==",
      "updated_at" : "2019-11-20T20:31:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/556355916",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "BTW (maybe a minority opinion here) but those linters are *super* pesky.\r\n\r\nYou need to fix the typos on \"permissions\" in order for the tests to run.",
      "created_at" : "2019-11-20T20:44:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#issuecomment-556370904",
      "id" : 556370904,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17536",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NjM3MDkwNA==",
      "updated_at" : "2019-11-20T20:44:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/556370904",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@JeremyRubin Ok, will change that.\r\nI also added the exceptions mentioned in your first comment. See f012f12",
      "created_at" : "2019-11-20T20:49:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#issuecomment-556376093",
      "id" : 556376093,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17536",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NjM3NjA5Mw==",
      "updated_at" : "2019-11-20T20:50:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/556376093",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/12272949?v=4",
         "events_url" : "https://api.github.com/users/emilengler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/emilengler/followers",
         "following_url" : "https://api.github.com/users/emilengler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/emilengler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/emilengler",
         "id" : 12272949,
         "login" : "emilengler",
         "node_id" : "MDQ6VXNlcjEyMjcyOTQ5",
         "organizations_url" : "https://api.github.com/users/emilengler/orgs",
         "received_events_url" : "https://api.github.com/users/emilengler/received_events",
         "repos_url" : "https://api.github.com/users/emilengler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/emilengler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/emilengler"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "BTW where you've found the type you meant in the comment? Any line number please?",
      "created_at" : "2019-11-20T20:52:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#issuecomment-556379660",
      "id" : 556379660,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17536",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NjM3OTY2MA==",
      "updated_at" : "2019-11-20T20:52:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/556379660",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/12272949?v=4",
         "events_url" : "https://api.github.com/users/emilengler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/emilengler/followers",
         "following_url" : "https://api.github.com/users/emilengler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/emilengler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/emilengler",
         "id" : 12272949,
         "login" : "emilengler",
         "node_id" : "MDQ6VXNlcjEyMjcyOTQ5",
         "organizations_url" : "https://api.github.com/users/emilengler/orgs",
         "received_events_url" : "https://api.github.com/users/emilengler/received_events",
         "repos_url" : "https://api.github.com/users/emilengler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/emilengler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/emilengler"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The linters fail because trailing white space was added. Trailing white space is causing issues with `git` and many editors. The type can be left as is if you want to.",
      "created_at" : "2019-11-20T21:01:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#issuecomment-556390404",
      "id" : 556390404,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17536",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NjM5MDQwNA==",
      "updated_at" : "2019-11-20T21:01:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/556390404",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Oh now I understand what you mean :D\r\nShould be fixed now",
      "created_at" : "2019-11-20T21:06:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#issuecomment-556396050",
      "id" : 556396050,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17536",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NjM5NjA1MA==",
      "updated_at" : "2019-11-20T21:06:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/556396050",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/12272949?v=4",
         "events_url" : "https://api.github.com/users/emilengler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/emilengler/followers",
         "following_url" : "https://api.github.com/users/emilengler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/emilengler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/emilengler",
         "id" : 12272949,
         "login" : "emilengler",
         "node_id" : "MDQ6VXNlcjEyMjcyOTQ5",
         "organizations_url" : "https://api.github.com/users/emilengler/orgs",
         "received_events_url" : "https://api.github.com/users/emilengler/received_events",
         "repos_url" : "https://api.github.com/users/emilengler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/emilengler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/emilengler"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@emilengler You need need to [squash your commits](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#squashing-commits). If you're fixing things like typos and whitespace, you'll always need to squash, so it's best to just do it before pushing to GitHub.",
      "created_at" : "2019-11-20T21:19:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#issuecomment-556411304",
      "id" : 556411304,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17536",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NjQxMTMwNA==",
      "updated_at" : "2019-11-20T21:19:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/556411304",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/863730?v=4",
         "events_url" : "https://api.github.com/users/fanquake/events{/privacy}",
         "followers_url" : "https://api.github.com/users/fanquake/followers",
         "following_url" : "https://api.github.com/users/fanquake/following{/other_user}",
         "gists_url" : "https://api.github.com/users/fanquake/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/fanquake",
         "id" : 863730,
         "login" : "fanquake",
         "node_id" : "MDQ6VXNlcjg2MzczMA==",
         "organizations_url" : "https://api.github.com/users/fanquake/orgs",
         "received_events_url" : "https://api.github.com/users/fanquake/received_events",
         "repos_url" : "https://api.github.com/users/fanquake/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/fanquake/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/fanquake"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@fanquake Done",
      "created_at" : "2019-11-20T21:21:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#issuecomment-556413353",
      "id" : 556413353,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17536",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NjQxMzM1Mw==",
      "updated_at" : "2019-11-20T21:21:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/556413353",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/12272949?v=4",
         "events_url" : "https://api.github.com/users/emilengler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/emilengler/followers",
         "following_url" : "https://api.github.com/users/emilengler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/emilengler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/emilengler",
         "id" : 12272949,
         "login" : "emilengler",
         "node_id" : "MDQ6VXNlcjEyMjcyOTQ5",
         "organizations_url" : "https://api.github.com/users/emilengler/orgs",
         "received_events_url" : "https://api.github.com/users/emilengler/received_events",
         "repos_url" : "https://api.github.com/users/emilengler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/emilengler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/emilengler"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17536#discussion_r348762331"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/348762331"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "just use `import re; filter(lambda x: x=='', re.split(\" |,\", user[2]))`?",
      "commit_id" : "e3825f59dde19fb6a225eca68ea6b7b3a9ae35cb",
      "created_at" : "2019-11-20T21:48:16Z",
      "diff_hunk" : "@@ -0,0 +1,93 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-2019 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+A test for RPC users with restricted permissions\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+import os\n+from test_framework.util import (\n+    get_datadir_path,\n+    assert_equal,\n+    str_to_b64str\n+)\n+import http.client\n+import urllib.parse\n+from random import randint\n+\n+def rpccall(node, user, method):\n+    url = urllib.parse.urlparse(node.url)\n+    headers = {\"Authorization\": \"Basic \" + str_to_b64str('{}:{}'.format(user[0], user[3]))}\n+    conn = http.client.HTTPConnection(url.hostname, url.port)\n+    conn.connect()\n+    conn.request('POST', '/', '{\"method\": \"' + method + '\"}', headers)\n+    resp = conn.getresponse()\n+    conn.close()\n+    return resp\n+\n+\n+class RPCWhitelistTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_chain(self):\n+        super().setup_chain()\n+        # 0 => Username\n+        # 1 => Password (Hashed)\n+        # 2 => Permissions\n+        # 3 => Password Plaintext\n+        self.users = [\n+            [\"user1\", \"50358aa884c841648e0700b073c32b2e$b73e95fff0748cc0b517859d2ca47d9bac1aa78231f3e48fa9222b612bd2083e\", \"getbestblockhash,getblockcount,\", \"12345\"],\n+            [\"user2\", \"8650ba41296f62092377a38547f361de$4620db7ba063ef4e2f7249853e9f3c5c3592a9619a759e3e6f1c63f2e22f1d21\", \"getblockcount\", \"54321\"]\n+        ]\n+        # For exceptions\n+        self.strange_users = [\n+            # Test empty\n+            [\"strangedude\", \"62d67dffec03836edd698314f1b2be62$c2fb4be29bb0e3646298661123cf2d8629640979cabc268ef05ea613ab54068d\", \":\", \"s7R4nG3R7H1nGZ\"],\n+            [\"strangedude2\", \"575c012c7fe4b1e83b9d809412da3ef7$09f448d0acfc19924dd62ecb96004d3c2d4b91f471030dfe43c6ea64a8f658c1\", \"\", \"s7R4nG3R7H1nGZ\"],\n+            # Test trailing comma\n+            [\"strangedude3\", \"23189c561b5975a56f4cf94030495d61$3a2f6aac26351e2257428550a553c4c1979594e36675bbd3db692442387728c0\", \":getblockcount,\", \"s7R4nG3R7H1nGZ\"],\n+            # Test overwrite\n+            [\"strangedude4\", \"990c895760a70df83949e8278665e19a$8f0906f20431ff24cb9e7f5b5041e4943bdf2a5c02a19ef4960dcf45e72cde1c\", \":getblockcount, getbestblockhash\", \"s7R4nG3R7H1nGZ\"],\n+            [\"strangedude4\", \"990c895760a70df83949e8278665e19a$8f0906f20431ff24cb9e7f5b5041e4943bdf2a5c02a19ef4960dcf45e72cde1c\", \":getblockcount\", \"s7R4nG3R7H1nGZ\"]\n+        ]\n+        # These commands shouldn't be allowed for any user to test failures\n+        self.never_allowed = [\"getnetworkinfo\"]\n+        with open(os.path.join(get_datadir_path(self.options.tmpdir, 0), \"bitcoin.conf\"), 'a', encoding='utf8') as f:\n+            f.write(\"\\nrpcwhitelistdefault=0\\n\")\n+            for user in self.users:\n+                f.write(\"rpcauth=\" + user[0] + \":\" + user[1] + \"\\n\")\n+                f.write(\"rpcwhitelist=\" + user[0] + \":\" + user[2] + \"\\n\")\n+            # Special cases\n+            for strangedude in self.strange_users:\n+                f.write(\"rpcauth=\" + strangedude[0] + \":\" + strangedude[1] + \"\\n\")\n+                f.write(\"rpcwhitelist=\" + strangedude[0] + strangedude[2] + \"\\n\")\n+\n+\n+    def run_test(self):\n+        for user in self.users:\n+            permissions = user[2].replace(\" \", \"\").split(\",\")\n+            # Pop all empty items\n+            i = 0\n+            while i < len(permissions):\n+                if permissions[i] == '':\n+                    permissions.pop(i)\n+\n+                i += 1",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#discussion_r348762331",
      "id" : 348762331,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0ODc2MjMzMQ==",
      "original_commit_id" : "e3825f59dde19fb6a225eca68ea6b7b3a9ae35cb",
      "original_position" : 77,
      "path" : "test/functional/rpc_whitelist.py",
      "position" : 77,
      "pull_request_review_id" : 320344763,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17536",
      "updated_at" : "2019-11-20T21:48:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/348762331",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17536#discussion_r348762842"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/348762842"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I like what you're thinking here with picking a random permission (especially if we eventually make this scale out to test a larger set), but I think for functional tests we value the determinism & repeatability a bit more. So maybe as a compromise, test everything in permissions, and then test all of the disallowed (until in the future they are too many).\r\n",
      "commit_id" : "e3825f59dde19fb6a225eca68ea6b7b3a9ae35cb",
      "created_at" : "2019-11-20T21:49:30Z",
      "diff_hunk" : "@@ -0,0 +1,93 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-2019 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+A test for RPC users with restricted permissions\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+import os\n+from test_framework.util import (\n+    get_datadir_path,\n+    assert_equal,\n+    str_to_b64str\n+)\n+import http.client\n+import urllib.parse\n+from random import randint\n+\n+def rpccall(node, user, method):\n+    url = urllib.parse.urlparse(node.url)\n+    headers = {\"Authorization\": \"Basic \" + str_to_b64str('{}:{}'.format(user[0], user[3]))}\n+    conn = http.client.HTTPConnection(url.hostname, url.port)\n+    conn.connect()\n+    conn.request('POST', '/', '{\"method\": \"' + method + '\"}', headers)\n+    resp = conn.getresponse()\n+    conn.close()\n+    return resp\n+\n+\n+class RPCWhitelistTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_chain(self):\n+        super().setup_chain()\n+        # 0 => Username\n+        # 1 => Password (Hashed)\n+        # 2 => Permissions\n+        # 3 => Password Plaintext\n+        self.users = [\n+            [\"user1\", \"50358aa884c841648e0700b073c32b2e$b73e95fff0748cc0b517859d2ca47d9bac1aa78231f3e48fa9222b612bd2083e\", \"getbestblockhash,getblockcount,\", \"12345\"],\n+            [\"user2\", \"8650ba41296f62092377a38547f361de$4620db7ba063ef4e2f7249853e9f3c5c3592a9619a759e3e6f1c63f2e22f1d21\", \"getblockcount\", \"54321\"]\n+        ]\n+        # For exceptions\n+        self.strange_users = [\n+            # Test empty\n+            [\"strangedude\", \"62d67dffec03836edd698314f1b2be62$c2fb4be29bb0e3646298661123cf2d8629640979cabc268ef05ea613ab54068d\", \":\", \"s7R4nG3R7H1nGZ\"],\n+            [\"strangedude2\", \"575c012c7fe4b1e83b9d809412da3ef7$09f448d0acfc19924dd62ecb96004d3c2d4b91f471030dfe43c6ea64a8f658c1\", \"\", \"s7R4nG3R7H1nGZ\"],\n+            # Test trailing comma\n+            [\"strangedude3\", \"23189c561b5975a56f4cf94030495d61$3a2f6aac26351e2257428550a553c4c1979594e36675bbd3db692442387728c0\", \":getblockcount,\", \"s7R4nG3R7H1nGZ\"],\n+            # Test overwrite\n+            [\"strangedude4\", \"990c895760a70df83949e8278665e19a$8f0906f20431ff24cb9e7f5b5041e4943bdf2a5c02a19ef4960dcf45e72cde1c\", \":getblockcount, getbestblockhash\", \"s7R4nG3R7H1nGZ\"],\n+            [\"strangedude4\", \"990c895760a70df83949e8278665e19a$8f0906f20431ff24cb9e7f5b5041e4943bdf2a5c02a19ef4960dcf45e72cde1c\", \":getblockcount\", \"s7R4nG3R7H1nGZ\"]\n+        ]\n+        # These commands shouldn't be allowed for any user to test failures\n+        self.never_allowed = [\"getnetworkinfo\"]\n+        with open(os.path.join(get_datadir_path(self.options.tmpdir, 0), \"bitcoin.conf\"), 'a', encoding='utf8') as f:\n+            f.write(\"\\nrpcwhitelistdefault=0\\n\")\n+            for user in self.users:\n+                f.write(\"rpcauth=\" + user[0] + \":\" + user[1] + \"\\n\")\n+                f.write(\"rpcwhitelist=\" + user[0] + \":\" + user[2] + \"\\n\")\n+            # Special cases\n+            for strangedude in self.strange_users:\n+                f.write(\"rpcauth=\" + strangedude[0] + \":\" + strangedude[1] + \"\\n\")\n+                f.write(\"rpcwhitelist=\" + strangedude[0] + strangedude[2] + \"\\n\")\n+\n+\n+    def run_test(self):\n+        for user in self.users:\n+            permissions = user[2].replace(\" \", \"\").split(\",\")\n+            # Pop all empty items\n+            i = 0\n+            while i < len(permissions):\n+                if permissions[i] == '':\n+                    permissions.pop(i)\n+\n+                i += 1\n+            self.log.info(\"[\" + user[0] + \"]: Testing a permitted permission\")\n+            assert_equal(200, rpccall(self.nodes[0], user, permissions[randint(0, len(permissions) - 1)]).status)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#discussion_r348762842",
      "id" : 348762842,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0ODc2Mjg0Mg==",
      "original_commit_id" : "e3825f59dde19fb6a225eca68ea6b7b3a9ae35cb",
      "original_position" : 79,
      "path" : "test/functional/rpc_whitelist.py",
      "position" : 79,
      "pull_request_review_id" : 320346716,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17536",
      "updated_at" : "2019-11-20T22:03:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/348762842",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/886523?v=4",
         "events_url" : "https://api.github.com/users/JeremyRubin/events{/privacy}",
         "followers_url" : "https://api.github.com/users/JeremyRubin/followers",
         "following_url" : "https://api.github.com/users/JeremyRubin/following{/other_user}",
         "gists_url" : "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/JeremyRubin",
         "id" : 886523,
         "login" : "JeremyRubin",
         "node_id" : "MDQ6VXNlcjg4NjUyMw==",
         "organizations_url" : "https://api.github.com/users/JeremyRubin/orgs",
         "received_events_url" : "https://api.github.com/users/JeremyRubin/received_events",
         "repos_url" : "https://api.github.com/users/JeremyRubin/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/JeremyRubin/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/JeremyRubin"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It might be possible to adjust `def wait_for_rpc_connection` to accept the 403 error code as acceptable signal that indicates the rpc thread is running.",
      "created_at" : "2019-11-20T21:58:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#issuecomment-556453378",
      "id" : 556453378,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17536",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NjQ1MzM3OA==",
      "updated_at" : "2019-11-20T21:58:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/556453378",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17536#discussion_r349180598"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/349180598"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "ACK",
      "commit_id" : "e3825f59dde19fb6a225eca68ea6b7b3a9ae35cb",
      "created_at" : "2019-11-21T16:17:00Z",
      "diff_hunk" : "@@ -0,0 +1,93 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-2019 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+A test for RPC users with restricted permissions\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+import os\n+from test_framework.util import (\n+    get_datadir_path,\n+    assert_equal,\n+    str_to_b64str\n+)\n+import http.client\n+import urllib.parse\n+from random import randint\n+\n+def rpccall(node, user, method):\n+    url = urllib.parse.urlparse(node.url)\n+    headers = {\"Authorization\": \"Basic \" + str_to_b64str('{}:{}'.format(user[0], user[3]))}\n+    conn = http.client.HTTPConnection(url.hostname, url.port)\n+    conn.connect()\n+    conn.request('POST', '/', '{\"method\": \"' + method + '\"}', headers)\n+    resp = conn.getresponse()\n+    conn.close()\n+    return resp\n+\n+\n+class RPCWhitelistTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_chain(self):\n+        super().setup_chain()\n+        # 0 => Username\n+        # 1 => Password (Hashed)\n+        # 2 => Permissions\n+        # 3 => Password Plaintext\n+        self.users = [\n+            [\"user1\", \"50358aa884c841648e0700b073c32b2e$b73e95fff0748cc0b517859d2ca47d9bac1aa78231f3e48fa9222b612bd2083e\", \"getbestblockhash,getblockcount,\", \"12345\"],\n+            [\"user2\", \"8650ba41296f62092377a38547f361de$4620db7ba063ef4e2f7249853e9f3c5c3592a9619a759e3e6f1c63f2e22f1d21\", \"getblockcount\", \"54321\"]\n+        ]\n+        # For exceptions\n+        self.strange_users = [\n+            # Test empty\n+            [\"strangedude\", \"62d67dffec03836edd698314f1b2be62$c2fb4be29bb0e3646298661123cf2d8629640979cabc268ef05ea613ab54068d\", \":\", \"s7R4nG3R7H1nGZ\"],\n+            [\"strangedude2\", \"575c012c7fe4b1e83b9d809412da3ef7$09f448d0acfc19924dd62ecb96004d3c2d4b91f471030dfe43c6ea64a8f658c1\", \"\", \"s7R4nG3R7H1nGZ\"],\n+            # Test trailing comma\n+            [\"strangedude3\", \"23189c561b5975a56f4cf94030495d61$3a2f6aac26351e2257428550a553c4c1979594e36675bbd3db692442387728c0\", \":getblockcount,\", \"s7R4nG3R7H1nGZ\"],\n+            # Test overwrite\n+            [\"strangedude4\", \"990c895760a70df83949e8278665e19a$8f0906f20431ff24cb9e7f5b5041e4943bdf2a5c02a19ef4960dcf45e72cde1c\", \":getblockcount, getbestblockhash\", \"s7R4nG3R7H1nGZ\"],\n+            [\"strangedude4\", \"990c895760a70df83949e8278665e19a$8f0906f20431ff24cb9e7f5b5041e4943bdf2a5c02a19ef4960dcf45e72cde1c\", \":getblockcount\", \"s7R4nG3R7H1nGZ\"]\n+        ]\n+        # These commands shouldn't be allowed for any user to test failures\n+        self.never_allowed = [\"getnetworkinfo\"]\n+        with open(os.path.join(get_datadir_path(self.options.tmpdir, 0), \"bitcoin.conf\"), 'a', encoding='utf8') as f:\n+            f.write(\"\\nrpcwhitelistdefault=0\\n\")\n+            for user in self.users:\n+                f.write(\"rpcauth=\" + user[0] + \":\" + user[1] + \"\\n\")\n+                f.write(\"rpcwhitelist=\" + user[0] + \":\" + user[2] + \"\\n\")\n+            # Special cases\n+            for strangedude in self.strange_users:\n+                f.write(\"rpcauth=\" + strangedude[0] + \":\" + strangedude[1] + \"\\n\")\n+                f.write(\"rpcwhitelist=\" + strangedude[0] + strangedude[2] + \"\\n\")\n+\n+\n+    def run_test(self):\n+        for user in self.users:\n+            permissions = user[2].replace(\" \", \"\").split(\",\")\n+            # Pop all empty items\n+            i = 0\n+            while i < len(permissions):\n+                if permissions[i] == '':\n+                    permissions.pop(i)\n+\n+                i += 1",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#discussion_r349180598",
      "id" : 349180598,
      "in_reply_to_id" : 348762331,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0OTE4MDU5OA==",
      "original_commit_id" : "e3825f59dde19fb6a225eca68ea6b7b3a9ae35cb",
      "original_position" : 77,
      "path" : "test/functional/rpc_whitelist.py",
      "position" : 77,
      "pull_request_review_id" : 321008793,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17536",
      "updated_at" : "2019-11-21T16:17:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/349180598",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/12272949?v=4",
         "events_url" : "https://api.github.com/users/emilengler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/emilengler/followers",
         "following_url" : "https://api.github.com/users/emilengler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/emilengler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/emilengler",
         "id" : 12272949,
         "login" : "emilengler",
         "node_id" : "MDQ6VXNlcjEyMjcyOTQ5",
         "organizations_url" : "https://api.github.com/users/emilengler/orgs",
         "received_events_url" : "https://api.github.com/users/emilengler/received_events",
         "repos_url" : "https://api.github.com/users/emilengler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/emilengler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/emilengler"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/17536#discussion_r349180809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17536"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/349180809"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok",
      "commit_id" : "e3825f59dde19fb6a225eca68ea6b7b3a9ae35cb",
      "created_at" : "2019-11-21T16:17:25Z",
      "diff_hunk" : "@@ -0,0 +1,93 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017-2019 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+A test for RPC users with restricted permissions\n+\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+import os\n+from test_framework.util import (\n+    get_datadir_path,\n+    assert_equal,\n+    str_to_b64str\n+)\n+import http.client\n+import urllib.parse\n+from random import randint\n+\n+def rpccall(node, user, method):\n+    url = urllib.parse.urlparse(node.url)\n+    headers = {\"Authorization\": \"Basic \" + str_to_b64str('{}:{}'.format(user[0], user[3]))}\n+    conn = http.client.HTTPConnection(url.hostname, url.port)\n+    conn.connect()\n+    conn.request('POST', '/', '{\"method\": \"' + method + '\"}', headers)\n+    resp = conn.getresponse()\n+    conn.close()\n+    return resp\n+\n+\n+class RPCWhitelistTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def setup_chain(self):\n+        super().setup_chain()\n+        # 0 => Username\n+        # 1 => Password (Hashed)\n+        # 2 => Permissions\n+        # 3 => Password Plaintext\n+        self.users = [\n+            [\"user1\", \"50358aa884c841648e0700b073c32b2e$b73e95fff0748cc0b517859d2ca47d9bac1aa78231f3e48fa9222b612bd2083e\", \"getbestblockhash,getblockcount,\", \"12345\"],\n+            [\"user2\", \"8650ba41296f62092377a38547f361de$4620db7ba063ef4e2f7249853e9f3c5c3592a9619a759e3e6f1c63f2e22f1d21\", \"getblockcount\", \"54321\"]\n+        ]\n+        # For exceptions\n+        self.strange_users = [\n+            # Test empty\n+            [\"strangedude\", \"62d67dffec03836edd698314f1b2be62$c2fb4be29bb0e3646298661123cf2d8629640979cabc268ef05ea613ab54068d\", \":\", \"s7R4nG3R7H1nGZ\"],\n+            [\"strangedude2\", \"575c012c7fe4b1e83b9d809412da3ef7$09f448d0acfc19924dd62ecb96004d3c2d4b91f471030dfe43c6ea64a8f658c1\", \"\", \"s7R4nG3R7H1nGZ\"],\n+            # Test trailing comma\n+            [\"strangedude3\", \"23189c561b5975a56f4cf94030495d61$3a2f6aac26351e2257428550a553c4c1979594e36675bbd3db692442387728c0\", \":getblockcount,\", \"s7R4nG3R7H1nGZ\"],\n+            # Test overwrite\n+            [\"strangedude4\", \"990c895760a70df83949e8278665e19a$8f0906f20431ff24cb9e7f5b5041e4943bdf2a5c02a19ef4960dcf45e72cde1c\", \":getblockcount, getbestblockhash\", \"s7R4nG3R7H1nGZ\"],\n+            [\"strangedude4\", \"990c895760a70df83949e8278665e19a$8f0906f20431ff24cb9e7f5b5041e4943bdf2a5c02a19ef4960dcf45e72cde1c\", \":getblockcount\", \"s7R4nG3R7H1nGZ\"]\n+        ]\n+        # These commands shouldn't be allowed for any user to test failures\n+        self.never_allowed = [\"getnetworkinfo\"]\n+        with open(os.path.join(get_datadir_path(self.options.tmpdir, 0), \"bitcoin.conf\"), 'a', encoding='utf8') as f:\n+            f.write(\"\\nrpcwhitelistdefault=0\\n\")\n+            for user in self.users:\n+                f.write(\"rpcauth=\" + user[0] + \":\" + user[1] + \"\\n\")\n+                f.write(\"rpcwhitelist=\" + user[0] + \":\" + user[2] + \"\\n\")\n+            # Special cases\n+            for strangedude in self.strange_users:\n+                f.write(\"rpcauth=\" + strangedude[0] + \":\" + strangedude[1] + \"\\n\")\n+                f.write(\"rpcwhitelist=\" + strangedude[0] + strangedude[2] + \"\\n\")\n+\n+\n+    def run_test(self):\n+        for user in self.users:\n+            permissions = user[2].replace(\" \", \"\").split(\",\")\n+            # Pop all empty items\n+            i = 0\n+            while i < len(permissions):\n+                if permissions[i] == '':\n+                    permissions.pop(i)\n+\n+                i += 1\n+            self.log.info(\"[\" + user[0] + \"]: Testing a permitted permission\")\n+            assert_equal(200, rpccall(self.nodes[0], user, permissions[randint(0, len(permissions) - 1)]).status)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17536#discussion_r349180809",
      "id" : 349180809,
      "in_reply_to_id" : 348762842,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0OTE4MDgwOQ==",
      "original_commit_id" : "e3825f59dde19fb6a225eca68ea6b7b3a9ae35cb",
      "original_position" : 79,
      "path" : "test/functional/rpc_whitelist.py",
      "position" : 79,
      "pull_request_review_id" : 321009093,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/17536",
      "updated_at" : "2019-11-21T16:17:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/349180809",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/12272949?v=4",
         "events_url" : "https://api.github.com/users/emilengler/events{/privacy}",
         "followers_url" : "https://api.github.com/users/emilengler/followers",
         "following_url" : "https://api.github.com/users/emilengler/following{/other_user}",
         "gists_url" : "https://api.github.com/users/emilengler/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/emilengler",
         "id" : 12272949,
         "login" : "emilengler",
         "node_id" : "MDQ6VXNlcjEyMjcyOTQ5",
         "organizations_url" : "https://api.github.com/users/emilengler/orgs",
         "received_events_url" : "https://api.github.com/users/emilengler/received_events",
         "repos_url" : "https://api.github.com/users/emilengler/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/emilengler/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/emilengler"
      }
   }
]
