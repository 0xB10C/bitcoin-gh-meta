[
   {
      "author_association" : "MEMBER",
      "body" : "I also think it'd be OK to remove the exports check completely. It was introduced back in the day because of symbol collisions between dynamically-linked Qt and the built-in statically built OpenSSL which could have scary implications.\r\n\r\nThis hasn't been the case for agesâever since Qt5 and before, we've statically linked Qtâand we don't even use OpenSSL anymore. I don't think a binary that exports symbols can usually cause problems (exporting excessive numbers of symbols would be an indication that something is going wrong in the link, but besides that). \r\n\r\nThe check is already being skipped for some architectures.",
      "created_at" : "2019-11-23T12:59:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17569#issuecomment-557795954",
      "id" : 557795954,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17569",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1Nzc5NTk1NA==",
      "updated_at" : "2019-11-23T13:01:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557795954",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "It looks like there is a third problem that needs to be fixed before gitian passes again, the RISC-V binaries fail on the NX (non-executable stack) check.\r\n\r\nI'm really confused as to what could cause this. Will try to bisect. I suspect it's another unexpected by-effect of #17270, because it passes with 1baf7d1819317e4f4aeeaba2f9d72057e63b1fea.\r\n\r\nEdit: no, it's not #17270, I don't have the issue with 0bb37e437e9cb4a29476edc9fa42f3e03c8bd797\r\n\r\nEdit: bisected it to b49b6b0f7090cc15860d815fb0ef306ddfc718ba . Seems that linking to OpenSSL was the only thing that made it set noexecstack, on RISC-V. I'm not sure why yet, although we do explicitly pass `-Wa,--noexecstack\"` CFLAGS there.\r\n(removed \"needs gitian build\" for now as i'm sure it will fail, will add it back after fixing this)",
      "created_at" : "2019-11-23T19:00:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17569#issuecomment-557823907",
      "id" : 557823907,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17569",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NzgyMzkwNw==",
      "updated_at" : "2019-11-23T22:00:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557823907",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Added a workaround to force `noexecstack` on RISC-V (I can't find any reason why this is different from other platforms, so blaming it on the immaturity of the toolchain):\r\n```bash\r\n    # Workaround for Ubuntu's g++ compiler for RV64, which\r\n    # doesn't add .note.GNU-stack sections automatically unlike other platforms,\r\n    # resulting in a NX failure of the binary in security-check.py\r\n    # TODO: remove this when no longer needed\r\n    if [ \"${i}\" = \"riscv64-linux-gnu\" ]; then\r\n      HOST_LDFLAGS=\"${HOST_LDFLAGS_BASE} -Wl,-z,noexecstack\"\r\n    else\r\n      HOST_LDFLAGS=\"${HOST_LDFLAGS_BASE}\"\r\n    fi\r\n```\r\nThis is necessary now that the flag is no longer \"inherited\" through OpenSSL's build settings.\r\n\r\nI think this should be it.",
      "created_at" : "2019-11-23T22:39:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/17569#issuecomment-557839382",
      "id" : 557839382,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/17569",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDU1NzgzOTM4Mg==",
      "updated_at" : "2019-11-23T23:58:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557839382",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
