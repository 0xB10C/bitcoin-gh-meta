[
   {
      "author_association" : "MEMBER",
      "body" : "> more focused test cases\r\n\r\n:+1:",
      "created_at" : "2018-11-30T00:02:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14845#issuecomment-443040200",
      "id" : 443040200,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14845",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0MzA0MDIwMA==",
      "updated_at" : "2018-11-30T00:02:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/443040200",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2018-11-30T00:27:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14845#issuecomment-443045267",
      "id" : 443045267,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/14845",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ0MzA0NTI2Nw==",
      "updated_at" : "2018-11-30T00:27:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/443045267",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/5470?v=4",
         "events_url" : "https://api.github.com/users/Empact/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Empact/followers",
         "following_url" : "https://api.github.com/users/Empact/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Empact/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Empact",
         "id" : 5470,
         "login" : "Empact",
         "node_id" : "MDQ6VXNlcjU0NzA=",
         "organizations_url" : "https://api.github.com/users/Empact/orgs",
         "received_events_url" : "https://api.github.com/users/Empact/received_events",
         "repos_url" : "https://api.github.com/users/Empact/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Empact/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Empact/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Empact"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14845#discussion_r237783145"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14845"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237783145"
         }
      },
      "author_association" : "MEMBER",
      "body" : "2018? Or is this based on existing stuff?",
      "commit_id" : "b31985d8c9a1cac749250a8f976fa6ccc2095b1e",
      "created_at" : "2018-11-30T08:47:54Z",
      "diff_hunk" : "@@ -0,0 +1,133 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2014-2018 The Bitcoin Core developers",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14845#discussion_r237783145",
      "id" : 237783145,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNzc4MzE0NQ==",
      "original_commit_id" : "b31985d8c9a1cac749250a8f976fa6ccc2095b1e",
      "original_position" : 2,
      "path" : "test/functional/wallet_balance.py",
      "position" : 2,
      "pull_request_review_id" : 180165950,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14845",
      "updated_at" : "2018-11-30T08:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237783145",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14845#discussion_r237783830"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14845"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237783830"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`propagation`",
      "commit_id" : "b31985d8c9a1cac749250a8f976fa6ccc2095b1e",
      "created_at" : "2018-11-30T08:50:35Z",
      "diff_hunk" : "@@ -0,0 +1,133 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2014-2018 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet balance RPC methods.\"\"\"\n+from decimal import Decimal\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+RANDOM_COINBASE_ADDRESS = 'mneYUmWYsuk7kySiURxCi3AGxrAqZxLgPZ'\n+\n+class WalletTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def create_transactions(self, node, address, amt, fees):\n+        # Create and sign raw transactions from node to address for amt.\n+        # Creates a transaction for each fee and returns an array\n+        # of the raw transactions.\n+        utxos = node.listunspent(0)\n+\n+        # Create transactions\n+        inputs = []\n+        ins_total = 0\n+        for utxo in utxos:\n+            inputs.append({\"txid\": utxo[\"txid\"], \"vout\": utxo[\"vout\"]})\n+            ins_total += utxo['amount']\n+            if ins_total > amt:\n+                break\n+\n+        txs = []\n+        for fee in fees:\n+            outputs = {address: amt, node.getrawchangeaddress(): ins_total - amt - fee}\n+            raw_tx = node.createrawtransaction(inputs, outputs, 0, True)\n+            raw_tx = node.signrawtransactionwithwallet(raw_tx)\n+            txs.append(raw_tx)\n+\n+        return txs\n+\n+    def run_test(self):\n+        # Check that nodes don't own any UTXOs\n+        assert_equal(len(self.nodes[0].listunspent()), 0)\n+        assert_equal(len(self.nodes[1].listunspent()), 0)\n+\n+        self.log.info(\"Mining one block for each node\")\n+\n+        self.nodes[0].generate(1)\n+        self.sync_all()\n+        self.nodes[1].generate(1)\n+        self.nodes[1].generatetoaddress(100, RANDOM_COINBASE_ADDRESS)\n+        self.sync_all()\n+\n+        assert_equal(self.nodes[0].getbalance(), 50)\n+        assert_equal(self.nodes[1].getbalance(), 50)\n+\n+        self.log.info(\"Test getbalance with different arguments\")\n+        assert_equal(self.nodes[0].getbalance(\"*\"), 50)\n+        assert_equal(self.nodes[0].getbalance(\"*\", 1), 50)\n+        assert_equal(self.nodes[0].getbalance(\"*\", 1, True), 50)\n+        assert_equal(self.nodes[0].getbalance(minconf=1), 50)\n+\n+        # Send 40 BTC from 0 to 1 and 60 BTC from 1 to 0.\n+        txs = self.create_transactions(self.nodes[0], self.nodes[1].getnewaddress(), 40, [Decimal('0.01')])\n+        self.nodes[0].sendrawtransaction(txs[0]['hex'])\n+        self.nodes[1].sendrawtransaction(txs[0]['hex'])  # sending on both nodes is faster than waiting for propogation\n+\n+        self.sync_all()\n+        txs = self.create_transactions(self.nodes[1], self.nodes[0].getnewaddress(), 60, [Decimal('0.01'), Decimal('0.02')])\n+        self.nodes[1].sendrawtransaction(txs[0]['hex'])\n+        self.nodes[0].sendrawtransaction(txs[0]['hex'])  # sending on both nodes is faster than waiting for propogation",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14845#discussion_r237783830",
      "id" : 237783830,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNzc4MzgzMA==",
      "original_commit_id" : "b31985d8c9a1cac749250a8f976fa6ccc2095b1e",
      "original_position" : 78,
      "path" : "test/functional/wallet_balance.py",
      "position" : 78,
      "pull_request_review_id" : 180165950,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14845",
      "updated_at" : "2018-11-30T08:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237783830",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14845#discussion_r237783874"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14845"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237783874"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`propagation`",
      "commit_id" : "b31985d8c9a1cac749250a8f976fa6ccc2095b1e",
      "created_at" : "2018-11-30T08:50:47Z",
      "diff_hunk" : "@@ -0,0 +1,133 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2014-2018 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet balance RPC methods.\"\"\"\n+from decimal import Decimal\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+RANDOM_COINBASE_ADDRESS = 'mneYUmWYsuk7kySiURxCi3AGxrAqZxLgPZ'\n+\n+class WalletTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def create_transactions(self, node, address, amt, fees):\n+        # Create and sign raw transactions from node to address for amt.\n+        # Creates a transaction for each fee and returns an array\n+        # of the raw transactions.\n+        utxos = node.listunspent(0)\n+\n+        # Create transactions\n+        inputs = []\n+        ins_total = 0\n+        for utxo in utxos:\n+            inputs.append({\"txid\": utxo[\"txid\"], \"vout\": utxo[\"vout\"]})\n+            ins_total += utxo['amount']\n+            if ins_total > amt:\n+                break\n+\n+        txs = []\n+        for fee in fees:\n+            outputs = {address: amt, node.getrawchangeaddress(): ins_total - amt - fee}\n+            raw_tx = node.createrawtransaction(inputs, outputs, 0, True)\n+            raw_tx = node.signrawtransactionwithwallet(raw_tx)\n+            txs.append(raw_tx)\n+\n+        return txs\n+\n+    def run_test(self):\n+        # Check that nodes don't own any UTXOs\n+        assert_equal(len(self.nodes[0].listunspent()), 0)\n+        assert_equal(len(self.nodes[1].listunspent()), 0)\n+\n+        self.log.info(\"Mining one block for each node\")\n+\n+        self.nodes[0].generate(1)\n+        self.sync_all()\n+        self.nodes[1].generate(1)\n+        self.nodes[1].generatetoaddress(100, RANDOM_COINBASE_ADDRESS)\n+        self.sync_all()\n+\n+        assert_equal(self.nodes[0].getbalance(), 50)\n+        assert_equal(self.nodes[1].getbalance(), 50)\n+\n+        self.log.info(\"Test getbalance with different arguments\")\n+        assert_equal(self.nodes[0].getbalance(\"*\"), 50)\n+        assert_equal(self.nodes[0].getbalance(\"*\", 1), 50)\n+        assert_equal(self.nodes[0].getbalance(\"*\", 1, True), 50)\n+        assert_equal(self.nodes[0].getbalance(minconf=1), 50)\n+\n+        # Send 40 BTC from 0 to 1 and 60 BTC from 1 to 0.\n+        txs = self.create_transactions(self.nodes[0], self.nodes[1].getnewaddress(), 40, [Decimal('0.01')])\n+        self.nodes[0].sendrawtransaction(txs[0]['hex'])\n+        self.nodes[1].sendrawtransaction(txs[0]['hex'])  # sending on both nodes is faster than waiting for propogation",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14845#discussion_r237783874",
      "id" : 237783874,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNzc4Mzg3NA==",
      "original_commit_id" : "b31985d8c9a1cac749250a8f976fa6ccc2095b1e",
      "original_position" : 73,
      "path" : "test/functional/wallet_balance.py",
      "position" : 73,
      "pull_request_review_id" : 180165950,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14845",
      "updated_at" : "2018-11-30T08:54:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237783874",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/250224?v=4",
         "events_url" : "https://api.github.com/users/kallewoof/events{/privacy}",
         "followers_url" : "https://api.github.com/users/kallewoof/followers",
         "following_url" : "https://api.github.com/users/kallewoof/following{/other_user}",
         "gists_url" : "https://api.github.com/users/kallewoof/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/kallewoof",
         "id" : 250224,
         "login" : "kallewoof",
         "node_id" : "MDQ6VXNlcjI1MDIyNA==",
         "organizations_url" : "https://api.github.com/users/kallewoof/orgs",
         "received_events_url" : "https://api.github.com/users/kallewoof/received_events",
         "repos_url" : "https://api.github.com/users/kallewoof/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/kallewoof/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/kallewoof"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/14845#discussion_r237787146"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14845"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237787146"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`create_transactions` is not using `self` and could thus be a function instead of a method?",
      "commit_id" : "b31985d8c9a1cac749250a8f976fa6ccc2095b1e",
      "created_at" : "2018-11-30T09:03:28Z",
      "diff_hunk" : "@@ -0,0 +1,133 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2014-2018 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test the wallet balance RPC methods.\"\"\"\n+from decimal import Decimal\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import (\n+    assert_equal,\n+    assert_raises_rpc_error,\n+)\n+\n+RANDOM_COINBASE_ADDRESS = 'mneYUmWYsuk7kySiURxCi3AGxrAqZxLgPZ'\n+\n+class WalletTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+\n+    def skip_test_if_missing_module(self):\n+        self.skip_if_no_wallet()\n+\n+    def create_transactions(self, node, address, amt, fees):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/14845#discussion_r237787146",
      "id" : 237787146,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNzc4NzE0Ng==",
      "original_commit_id" : "b31985d8c9a1cac749250a8f976fa6ccc2095b1e",
      "original_position" : 24,
      "path" : "test/functional/wallet_balance.py",
      "position" : 24,
      "pull_request_review_id" : 180171057,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/14845",
      "updated_at" : "2018-11-30T09:03:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/237787146",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   }
]
