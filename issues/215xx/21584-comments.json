[
   {
      "author_association" : "MEMBER",
      "body" : "Introduced in #19806",
      "created_at" : "2021-04-03T14:52:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21584#issuecomment-812875881",
      "id" : 812875881,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21584",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMjg3NTg4MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-07T06:13:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/812875881",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21620 (ChainstateManager locking improvements by jamesob)\n* #21582 (Fix assumeutxo crash due to missing base_blockhash by MarcoFalke)\n* #19521 (Coinstats Index by fjahr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-04-04T06:43:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21584#issuecomment-812983482",
      "id" : 812983482,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21584",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxMjk4MzQ4Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-07T00:27:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/812983482",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Still draft, please review #21592 first.",
      "created_at" : "2021-04-07T07:19:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21584#issuecomment-814669220",
      "id" : 814669220,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/21584",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDgxNDY2OTIyMA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-04-07T07:19:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/814669220",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21584#discussion_r611988631"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21584"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611988631"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"refactor: Assumeutxo lookup by blockhash\" (fa3b1cd38eb98dd90be097bd8f0734a802de38f0)\r\n\r\nSeems like you could drop `// height = 110` to not repeat `110` next line. Could maybe write do `/* height = */` there to be clearer the value is a height.",
      "commit_id" : "fae09976880051232a4082248e30cc7a3b801644",
      "created_at" : "2021-04-12T22:13:52Z",
      "diff_hunk" : "@@ -440,12 +440,12 @@ class CRegTestParams : public CChainParams {\n \n         m_assumeutxo_data = MapAssumeutxo{\n             {\n-                110,\n-                {uint256S(\"0x1ebbf5850204c0bdb15bf030f47c7fe91d45c44c712697e4509ba67adb01c618\"), 110},\n+                BlockHash{uint256S(\"0x696e92821f65549c7ee134edceeeeaaa4105647a3c4fd9f298c0aec0ab50425c\")}, // height 110",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21584#discussion_r611988631",
      "id" : 611988631,
      "line" : 443,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTk4ODYzMQ==",
      "original_commit_id" : "fa3b1cd38eb98dd90be097bd8f0734a802de38f0",
      "original_line" : 443,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 6,
      "pull_request_review_id" : 634008593,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21584",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-12T23:13:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611988631",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21584#discussion_r611990689"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21584"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611990689"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"refactor: Assumeutxo lookup by blockhash\" (fa3b1cd38eb98dd90be097bd8f0734a802de38f0)\r\n\r\nInteresting this adds block hash information to the MapAssumeutxo map. Previously there was discussion about doing the opposite and removing block height information https://github.com/bitcoin/bitcoin/pull/19806#discussion_r508081070.\r\n\r\nIt seems to me like maybe it could be better not to add extra hardcoded information that needs more runtime code and reviewer effort to check. An alternative to hardcoding block hashes here could just be to look up the block hashes as they are needed using the heights (i.e. when loading a new snapshot, iterate over m_assumeutxo_data entries and check if snapshot base hash matches block hash of any entry's height).\r\n\r\nThis is just a thought. No strong opinion about what's hardcoded or not hardcoded.",
      "commit_id" : "fae09976880051232a4082248e30cc7a3b801644",
      "created_at" : "2021-04-12T22:18:44Z",
      "diff_hunk" : "@@ -43,7 +52,7 @@ struct AssumeutxoData {\n \n std::ostream& operator<<(std::ostream& o, const AssumeutxoData& aud);\n \n-using MapAssumeutxo = std::map<int, const AssumeutxoData>;\n+using MapAssumeutxo = std::map<BlockHash, const AssumeutxoData>;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21584#discussion_r611990689",
      "id" : 611990689,
      "line" : 53,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTk5MDY4OQ==",
      "original_commit_id" : "fa3b1cd38eb98dd90be097bd8f0734a802de38f0",
      "original_line" : 55,
      "original_position" : 37,
      "original_start_line" : null,
      "path" : "src/chainparams.h",
      "position" : 39,
      "pull_request_review_id" : 634008593,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21584",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-12T23:13:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611990689",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21584#discussion_r612000367"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21584"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612000367"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"Fix assumeutxo crash due to invalid base_blockhash\" (fa8676b668cfd71eb299bd7e59cdec374c5d5407)\r\n\r\nAfter #21582, should this commit description be updated? This commit seems not to avoid a crash, but just be an optimization that makes the check for a known assumeutxo hash happen a little earlier than it used to.",
      "commit_id" : "fae09976880051232a4082248e30cc7a3b801644",
      "created_at" : "2021-04-12T22:42:04Z",
      "diff_hunk" : "@@ -5252,6 +5252,14 @@ bool ChainstateManager::ActivateSnapshot(\n         return false;\n     }\n \n+    auto maybe_au_data = ExpectedAssumeutxo(BlockHash{base_blockhash}, ::Params());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21584#discussion_r612000367",
      "id" : 612000367,
      "line" : 5261,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMjAwMDM2Nw==",
      "original_commit_id" : "fa8676b668cfd71eb299bd7e59cdec374c5d5407",
      "original_line" : 5255,
      "original_position" : 4,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 85,
      "pull_request_review_id" : 634008593,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21584",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-12T23:13:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612000367",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21584#discussion_r612001395"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21584"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612001395"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "In commit \"refactor: Avoid magic value of all-zeros in assumeutxo base_blockhash\" (fae09976880051232a4082248e30cc7a3b801644)\r\n\r\nSeems fine to drop this line, but strictly speaking this check could still work and could be kept? (Just want to make sure I'm not missing something and it had to be removed for another reason)",
      "commit_id" : "fae09976880051232a4082248e30cc7a3b801644",
      "created_at" : "2021-04-12T22:44:53Z",
      "diff_hunk" : "@@ -273,9 +271,8 @@ BOOST_FIXTURE_TEST_CASE(chainstatemanager_activate_snapshot, TestChain100Setup)\n     BOOST_REQUIRE(CreateAndActivateUTXOSnapshot(m_node, m_path_root));\n \n     // Ensure our active chain is the snapshot chainstate.\n-    BOOST_CHECK(!chainman.ActiveChainstate().m_from_snapshot_blockhash.IsNull());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21584#discussion_r612001395",
      "id" : 612001395,
      "line" : 271,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMjAwMTM5NQ==",
      "original_commit_id" : "fae09976880051232a4082248e30cc7a3b801644",
      "original_line" : 276,
      "original_position" : 17,
      "original_start_line" : null,
      "path" : "src/test/validation_chainstatemanager_tests.cpp",
      "position" : 29,
      "pull_request_review_id" : 634008593,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21584",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-12T23:13:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612001395",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/21584#discussion_r612161383"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21584"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612161383"
         }
      },
      "author_association" : "MEMBER",
      "body" : ";)\r\n\r\nThe value is not height but nChainTx",
      "commit_id" : "fae09976880051232a4082248e30cc7a3b801644",
      "created_at" : "2021-04-13T06:25:14Z",
      "diff_hunk" : "@@ -440,12 +440,12 @@ class CRegTestParams : public CChainParams {\n \n         m_assumeutxo_data = MapAssumeutxo{\n             {\n-                110,\n-                {uint256S(\"0x1ebbf5850204c0bdb15bf030f47c7fe91d45c44c712697e4509ba67adb01c618\"), 110},\n+                BlockHash{uint256S(\"0x696e92821f65549c7ee134edceeeeaaa4105647a3c4fd9f298c0aec0ab50425c\")}, // height 110",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/21584#discussion_r612161383",
      "id" : 612161383,
      "in_reply_to_id" : 611988631,
      "line" : 443,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMjE2MTM4Mw==",
      "original_commit_id" : "fa3b1cd38eb98dd90be097bd8f0734a802de38f0",
      "original_line" : 443,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/chainparams.cpp",
      "position" : 6,
      "pull_request_review_id" : 634211239,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/21584",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-04-13T06:25:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612161383",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
