[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19486 (Remove unused constants `CADDR_TIME_VERSION` and `GETHEADERS_VERSION` by jnewbery)\n* #19031 (Implement ADDRv2 support (part of BIP155) by vasild)\n* #17785 (p2p: Unify Send and Receive protocol versions by hebasto)\n* #14053 (Add address-based index (attempt 4?) by marcinja)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2020-07-13T05:51:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#issuecomment-657373448",
      "id" : 657373448,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19503",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NzM3MzQ0OA==",
      "updated_at" : "2020-07-13T05:51:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657373448",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK\r\n\r\nGetting rid of `GetVersion`/`GetType` and replacing them with a compile-time checked approach would be very nice.",
      "created_at" : "2020-07-13T08:17:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#issuecomment-657400171",
      "id" : 657400171,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19503",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NzQwMDE3MQ==",
      "updated_at" : "2020-07-13T08:17:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657400171",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
      "created_at" : "2020-07-13T10:21:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#issuecomment-657472439",
      "id" : 657472439,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19503",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1NzQ3MjQzOQ==",
      "updated_at" : "2020-07-13T10:21:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657472439",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453556220"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453556220"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This sentence can be removed now. It's meaningless without a serialization version.",
      "commit_id" : "f00db5cd0d03776f56889b226066b404b6a49bab",
      "created_at" : "2020-07-13T10:35:05Z",
      "diff_hunk" : "@@ -354,28 +354,43 @@ static inline bool MayHaveUsefulAddressDB(ServiceFlags services)\n     return (services & NODE_NETWORK) || (services & NODE_NETWORK_LIMITED);\n }\n \n+enum class AddrSerialization {\n+    DISK,\n+\n+    // The only time we serialize a CAddress object without nTime is in\n+    // the initial VERSION messages which contain two CAddress records.\n+    // At that point, the serialization version is INIT_PROTO_VERSION.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453556220",
      "id" : 453556220,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzU1NjIyMA==",
      "original_commit_id" : "2149a5f52835bb4bd33f7b2ec974f91fde4c9f91",
      "original_line" : 362,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 447132141,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-13T20:12:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453556220",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453789310"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453789310"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit \"distentangle ...\":\r\n\r\nThis is not compatible with the live network. When testing I get:\r\n\r\n```\r\n2020-07-13T16:36:11Z [opencon] trying connection 188.42.33.44:18333 lastseen=1702.0hrs\r\n2020-07-13T16:36:11Z [opencon] Added connection peer=7\r\n2020-07-13T16:36:11Z [opencon] sending version (111 bytes) peer=7\r\n2020-07-13T16:36:11Z [opencon] send version message: version 70015, blocks=1746853, us=[::]:0, peer=7\r\n2020-07-13T16:36:11Z [msghand] received: reject (31 bytes) peer=7\r\n2020-07-13T16:36:11Z [msghand] Misbehaving: 188.42.33.44:18333 peer=7 (0 -> 1)\r\n2020-07-13T16:36:11Z [net] socket closed for peer=7\r\n2020-07-13T16:36:11Z [net] disconnecting peer=7\r\n2020-07-13T16:36:11Z [net] Cleared nodestate for peer=7\r\n",
      "commit_id" : "f00db5cd0d03776f56889b226066b404b6a49bab",
      "created_at" : "2020-07-13T16:50:43Z",
      "diff_hunk" : "@@ -359,26 +359,32 @@ class CAddress : public CService\n {\n     static constexpr uint32_t TIME_INIT{100000000};\n \n+    /** The disk serialization for CAddress includes a version number.\n+     *  Traditionally the number CLIENT_VERSION was used, but it has since\n+     *  been disentangled from it. */\n+    static constexpr uint32_t DISK_VERSION{210000};\n+\n public:\n     CAddress() : CService{} {};\n     explicit CAddress(CService ipIn, ServiceFlags nServicesIn) : CService{ipIn}, nServices{nServicesIn} {};\n \n     SERIALIZE_METHODS(CAddress, obj)\n     {\n         SER_READ(obj, obj.nTime = TIME_INIT);\n-        int nVersion = s.GetVersion();\n         if (s.GetType() & SER_DISK) {\n-            READWRITE(nVersion);\n-        }\n-        if ((s.GetType() & SER_DISK) ||\n-            (nVersion != INIT_PROTO_VERSION && !(s.GetType() & SER_GETHASH))) {\n+            uint32_t disk_version = DISK_VERSION;\n+            READWRITE(disk_version);\n+            READWRITE(obj.nTime);\n+        } else if (s.GetType() & SER_NETWORK) {\n             // The only time we serialize a CAddress object without nTime is in\n             // the initial VERSION messages which contain two CAddress records.\n             // At that point, the serialization version is INIT_PROTO_VERSION.\n             // After the version handshake, serialization version is >=\n             // MIN_PEER_PROTO_VERSION and all ADDR messages are serialized with\n             // nTime.\n-            READWRITE(obj.nTime);\n+            if (s.GetVersion() >= INIT_PROTO_VERSION) {\n+                READWRITE(obj.nTime);\n+            }\n         }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453789310",
      "id" : 453789310,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzc4OTMxMA==",
      "original_commit_id" : "908c6feb3673479579467afab69c42a7f535e39b",
      "original_line" : 388,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 447426942,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-13T20:12:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453789310",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453805326"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453805326"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in commit \"user serialization ...\":\r\n\r\n\r\nStill not compatible. Now I get:\r\n\r\n```\r\n2020-07-13T17:01:39Z [opencon] trying connection 95.183.48.89:18333 lastseen=2468.3hrs\r\n2020-07-13T17:01:39Z [opencon] Added connection peer=2\r\n2020-07-13T17:01:39Z [opencon] sending version (103 bytes) peer=2\r\n2020-07-13T17:01:39Z [opencon] send version message: version 70015, blocks=1746969, us=[::]:0, peer=2\r\n2020-07-13T17:01:39Z [msghand] received: version (102 bytes) peer=2\r\n2020-07-13T17:01:39Z [msghand] ProcessMessages(version, 102 bytes): Exception 'CDataStream::read(): end of data: iostream error' (NSt8ios_base7failureB5cxx11E) caught\r\n2020-07-13T17:01:39Z [msghand] received: verack (0 bytes) peer=2\r\n2020-07-13T17:01:39Z [msghand] Misbehaving: 95.183.48.89:18333 peer=2 (0 -> 1)\r\n",
      "commit_id" : "f00db5cd0d03776f56889b226066b404b6a49bab",
      "created_at" : "2020-07-13T17:17:27Z",
      "diff_hunk" : "@@ -368,23 +380,15 @@ class CAddress : public CService\n     CAddress() : CService{} {};\n     explicit CAddress(CService ipIn, ServiceFlags nServicesIn) : CService{ipIn}, nServices{nServicesIn} {};\n \n-    SERIALIZE_METHODS(CAddress, obj)\n+    SERIALIZE_METHODS_PARAMS(CAddress, obj, AddrSerialization, fmt)\n     {\n         SER_READ(obj, obj.nTime = TIME_INIT);\n-        if (s.GetType() & SER_DISK) {\n+        if (fmt == AddrSerialization::DISK) {\n             uint32_t disk_version = DISK_VERSION;\n             READWRITE(disk_version);\n             READWRITE(obj.nTime);\n-        } else if (s.GetType() & SER_NETWORK) {\n-            // The only time we serialize a CAddress object without nTime is in\n-            // the initial VERSION messages which contain two CAddress records.\n-            // At that point, the serialization version is INIT_PROTO_VERSION.\n-            // After the version handshake, serialization version is >=\n-            // MIN_PEER_PROTO_VERSION and all ADDR messages are serialized with\n-            // nTime.\n-            if (s.GetVersion() >= INIT_PROTO_VERSION) {\n-                READWRITE(obj.nTime);\n-            }\n+        } else if (fmt == AddrSerialization::NETWORK_WITHTIME) {\n+            READWRITE(obj.nTime);\n         }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453805326",
      "id" : 453805326,
      "line" : 386,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzgwNTMyNg==",
      "original_commit_id" : "2149a5f52835bb4bd33f7b2ec974f91fde4c9f91",
      "original_line" : 386,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 37,
      "pull_request_review_id" : 447426942,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-13T20:12:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453805326",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453808173"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453808173"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in the last commit:\r\n\r\nCould add a trailing semicolon? I've prepared a suggested diff for you that also switches to a switch-case so that the compiler can check all cases are covered, feel free to take or reject:\r\n\r\n\r\n```diff\r\ndiff --git a/src/protocol.h b/src/protocol.h\r\nindex 500cf346e9..0f5786a1a9 100644\r\n--- a/src/protocol.h\r\n+++ b/src/protocol.h\r\n@@ -356,14 +356,8 @@ static inline bool MayHaveUsefulAddressDB(ServiceFlags services)\r\n \r\n enum class AddrSerialization {\r\n     DISK,\r\n-\r\n-    // The only time we serialize a CAddress object without nTime is in\r\n-    // the initial VERSION messages which contain two CAddress records.\r\n-    // At that point, the serialization version is INIT_PROTO_VERSION.\r\n-    // After the version handshake, all ADDR messages are serialized with\r\n-    // nTime.\r\n     NETWORK_NOTIME,\r\n-    NETWORK_WITHTIME\r\n+    NETWORK_WITHTIME,\r\n };\r\n \r\n /** A CService with information about it as peer */\r\n@@ -383,13 +377,23 @@ public:\r\n     SERIALIZE_METHODS_PARAMS(CAddress, obj, AddrSerialization, fmt)\r\n     {\r\n         SER_READ(obj, obj.nTime = TIME_INIT);\r\n-        if (fmt == AddrSerialization::DISK) {\r\n+        switch (fmt) {\r\n+        case AddrSerialization::DISK: {\r\n             uint32_t disk_version = DISK_VERSION;\r\n             READWRITE(disk_version);\r\n             READWRITE(obj.nTime);\r\n-        } else if (fmt == AddrSerialization::NETWORK_WITHTIME) {\r\n+            break;\r\n+        }\r\n+        case AddrSerialization::NETWORK_WITHTIME: {\r\n             READWRITE(obj.nTime);\r\n+            break;\r\n+        }\r\n+        case AddrSerialization::NETWORK_NOTIME: {\r\n+            // The only time we serialize a CAddress object without nTime is in\r\n+            // the initial VERSION messages which contain two CAddress records.\r\n+            break;\r\n         }\r\n+        } // no default case, so the compiler can warn about missing cases\r\n         READWRITE(Using<CustomUintFormatter<8>>(obj.nServices), AsBase<CService>(obj));\r\n     }\r\n \r\n",
      "commit_id" : "f00db5cd0d03776f56889b226066b404b6a49bab",
      "created_at" : "2020-07-13T17:22:00Z",
      "diff_hunk" : "@@ -354,28 +354,43 @@ static inline bool MayHaveUsefulAddressDB(ServiceFlags services)\n     return (services & NODE_NETWORK) || (services & NODE_NETWORK_LIMITED);\n }\n \n+enum class AddrSerialization {\n+    DISK,\n+\n+    // The only time we serialize a CAddress object without nTime is in\n+    // the initial VERSION messages which contain two CAddress records.\n+    // At that point, the serialization version is INIT_PROTO_VERSION.\n+    // After the version handshake, all ADDR messages are serialized with\n+    // nTime.\n+    NETWORK_NOTIME,\n+    NETWORK_WITHTIME",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453808173",
      "id" : 453808173,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzgwODE3Mw==",
      "original_commit_id" : "2149a5f52835bb4bd33f7b2ec974f91fde4c9f91",
      "original_line" : 366,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 447426942,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-13T20:12:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453808173",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453872482"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453872482"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Why not use `static_cast` instead of `AsBase`?",
      "commit_id" : "f00db5cd0d03776f56889b226066b404b6a49bab",
      "created_at" : "2020-07-13T19:12:56Z",
      "diff_hunk" : "@@ -165,11 +165,10 @@ enum\n };\n \n //! Convert the reference base type to X, without changing constness or reference type.\n-template<typename X> X& ReadWriteAsHelper(X& x) { return x; }\n-template<typename X> const X& ReadWriteAsHelper(const X& x) { return x; }\n+template<typename X> X& AsBase(X& x) { return x; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453872482",
      "id" : 453872482,
      "line" : 168,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzg3MjQ4Mg==",
      "original_commit_id" : "2149a5f52835bb4bd33f7b2ec974f91fde4c9f91",
      "original_line" : 168,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 6,
      "pull_request_review_id" : 447527591,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-13T20:34:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453872482",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453877989"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453877989"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit: `s/thet/the/`",
      "commit_id" : "f00db5cd0d03776f56889b226066b404b6a49bab",
      "created_at" : "2020-07-13T19:23:02Z",
      "diff_hunk" : "@@ -1114,4 +1129,71 @@ size_t GetSerializeSizeMany(int nVersion, const T&... t)\n     return sc.size();\n }\n \n+/** Wrapper that overrides thet GetParams() function of a stream. */",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453877989",
      "id" : 453877989,
      "line" : 1132,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1Mzg3Nzk4OQ==",
      "original_commit_id" : "2149a5f52835bb4bd33f7b2ec974f91fde4c9f91",
      "original_line" : 1132,
      "original_position" : 68,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 68,
      "pull_request_review_id" : 447527591,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-13T20:34:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453877989",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK as it will allow for a previously hacky solution to be neater. See https://github.com/bitcoin/bitcoin/issues/19477 for more details\r\n\r\nPerhaps a worthwhile followup: Completing the example documentations of our serialization \"helpers\" (seems like there's already a few examples, but not all of them are documented)",
      "created_at" : "2020-07-13T19:56:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#issuecomment-657759825",
      "id" : 657759825,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19503",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1Nzc1OTgyNQ==",
      "updated_at" : "2020-07-13T19:56:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657759825",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3445290?v=4",
         "events_url" : "https://api.github.com/users/dongcarl/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dongcarl/followers",
         "following_url" : "https://api.github.com/users/dongcarl/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dongcarl/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dongcarl",
         "id" : 3445290,
         "login" : "dongcarl",
         "node_id" : "MDQ6VXNlcjM0NDUyOTA=",
         "organizations_url" : "https://api.github.com/users/dongcarl/orgs",
         "received_events_url" : "https://api.github.com/users/dongcarl/received_events",
         "repos_url" : "https://api.github.com/users/dongcarl/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dongcarl/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dongcarl"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453904401"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453904401"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Arguably there still is a serialization version, but the link between that and CAddress serialization is purely historical. Removed by incorporating @MarcoFalke's changes below.",
      "commit_id" : "f00db5cd0d03776f56889b226066b404b6a49bab",
      "created_at" : "2020-07-13T20:13:24Z",
      "diff_hunk" : "@@ -354,28 +354,43 @@ static inline bool MayHaveUsefulAddressDB(ServiceFlags services)\n     return (services & NODE_NETWORK) || (services & NODE_NETWORK_LIMITED);\n }\n \n+enum class AddrSerialization {\n+    DISK,\n+\n+    // The only time we serialize a CAddress object without nTime is in\n+    // the initial VERSION messages which contain two CAddress records.\n+    // At that point, the serialization version is INIT_PROTO_VERSION.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453904401",
      "id" : 453904401,
      "in_reply_to_id" : 453556220,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkwNDQwMQ==",
      "original_commit_id" : "2149a5f52835bb4bd33f7b2ec974f91fde4c9f91",
      "original_line" : 362,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 447567007,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-13T20:13:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453904401",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453904737"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453904737"
         }
      },
      "author_association" : "MEMBER",
      "body" : "There was a bug (`>= INIT_PROTO_VERSION` instead of `!= INIT_PROTO_VERSION`), fixed.",
      "commit_id" : "f00db5cd0d03776f56889b226066b404b6a49bab",
      "created_at" : "2020-07-13T20:14:02Z",
      "diff_hunk" : "@@ -359,26 +359,32 @@ class CAddress : public CService\n {\n     static constexpr uint32_t TIME_INIT{100000000};\n \n+    /** The disk serialization for CAddress includes a version number.\n+     *  Traditionally the number CLIENT_VERSION was used, but it has since\n+     *  been disentangled from it. */\n+    static constexpr uint32_t DISK_VERSION{210000};\n+\n public:\n     CAddress() : CService{} {};\n     explicit CAddress(CService ipIn, ServiceFlags nServicesIn) : CService{ipIn}, nServices{nServicesIn} {};\n \n     SERIALIZE_METHODS(CAddress, obj)\n     {\n         SER_READ(obj, obj.nTime = TIME_INIT);\n-        int nVersion = s.GetVersion();\n         if (s.GetType() & SER_DISK) {\n-            READWRITE(nVersion);\n-        }\n-        if ((s.GetType() & SER_DISK) ||\n-            (nVersion != INIT_PROTO_VERSION && !(s.GetType() & SER_GETHASH))) {\n+            uint32_t disk_version = DISK_VERSION;\n+            READWRITE(disk_version);\n+            READWRITE(obj.nTime);\n+        } else if (s.GetType() & SER_NETWORK) {\n             // The only time we serialize a CAddress object without nTime is in\n             // the initial VERSION messages which contain two CAddress records.\n             // At that point, the serialization version is INIT_PROTO_VERSION.\n             // After the version handshake, serialization version is >=\n             // MIN_PEER_PROTO_VERSION and all ADDR messages are serialized with\n             // nTime.\n-            READWRITE(obj.nTime);\n+            if (s.GetVersion() >= INIT_PROTO_VERSION) {\n+                READWRITE(obj.nTime);\n+            }\n         }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453904737",
      "id" : 453904737,
      "in_reply_to_id" : 453789310,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkwNDczNw==",
      "original_commit_id" : "908c6feb3673479579467afab69c42a7f535e39b",
      "original_line" : 388,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 447567443,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-13T20:14:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453904737",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453905123"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453905123"
         }
      },
      "author_association" : "MEMBER",
      "body" : "There was an unrelated bug to the previous one in this commit, with the same effect: `addrFrom` in the VERSION message was parsed with `NETWORK_WITHTIME`.",
      "commit_id" : "f00db5cd0d03776f56889b226066b404b6a49bab",
      "created_at" : "2020-07-13T20:14:45Z",
      "diff_hunk" : "@@ -368,23 +380,15 @@ class CAddress : public CService\n     CAddress() : CService{} {};\n     explicit CAddress(CService ipIn, ServiceFlags nServicesIn) : CService{ipIn}, nServices{nServicesIn} {};\n \n-    SERIALIZE_METHODS(CAddress, obj)\n+    SERIALIZE_METHODS_PARAMS(CAddress, obj, AddrSerialization, fmt)\n     {\n         SER_READ(obj, obj.nTime = TIME_INIT);\n-        if (s.GetType() & SER_DISK) {\n+        if (fmt == AddrSerialization::DISK) {\n             uint32_t disk_version = DISK_VERSION;\n             READWRITE(disk_version);\n             READWRITE(obj.nTime);\n-        } else if (s.GetType() & SER_NETWORK) {\n-            // The only time we serialize a CAddress object without nTime is in\n-            // the initial VERSION messages which contain two CAddress records.\n-            // At that point, the serialization version is INIT_PROTO_VERSION.\n-            // After the version handshake, serialization version is >=\n-            // MIN_PEER_PROTO_VERSION and all ADDR messages are serialized with\n-            // nTime.\n-            if (s.GetVersion() >= INIT_PROTO_VERSION) {\n-                READWRITE(obj.nTime);\n-            }\n+        } else if (fmt == AddrSerialization::NETWORK_WITHTIME) {\n+            READWRITE(obj.nTime);\n         }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453905123",
      "id" : 453905123,
      "in_reply_to_id" : 453805326,
      "line" : 386,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkwNTEyMw==",
      "original_commit_id" : "2149a5f52835bb4bd33f7b2ec974f91fde4c9f91",
      "original_line" : 386,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : 37,
      "pull_request_review_id" : 447567907,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-13T20:14:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453905123",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453905248"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453905248"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Included.",
      "commit_id" : "f00db5cd0d03776f56889b226066b404b6a49bab",
      "created_at" : "2020-07-13T20:14:57Z",
      "diff_hunk" : "@@ -354,28 +354,43 @@ static inline bool MayHaveUsefulAddressDB(ServiceFlags services)\n     return (services & NODE_NETWORK) || (services & NODE_NETWORK_LIMITED);\n }\n \n+enum class AddrSerialization {\n+    DISK,\n+\n+    // The only time we serialize a CAddress object without nTime is in\n+    // the initial VERSION messages which contain two CAddress records.\n+    // At that point, the serialization version is INIT_PROTO_VERSION.\n+    // After the version handshake, all ADDR messages are serialized with\n+    // nTime.\n+    NETWORK_NOTIME,\n+    NETWORK_WITHTIME",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453905248",
      "id" : 453905248,
      "in_reply_to_id" : 453808173,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkwNTI0OA==",
      "original_commit_id" : "2149a5f52835bb4bd33f7b2ec974f91fde4c9f91",
      "original_line" : 366,
      "original_position" : 13,
      "original_start_line" : null,
      "path" : "src/protocol.h",
      "position" : null,
      "pull_request_review_id" : 447568043,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-13T20:14:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453905248",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased after #19486 merge. Addressed comments.",
      "created_at" : "2020-07-13T20:18:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#issuecomment-657769998",
      "id" : 657769998,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19503",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY1Nzc2OTk5OA==",
      "updated_at" : "2020-07-13T20:18:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/657769998",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453917160"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453917160"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It needs to maintain constness. During serialization, the object may be `const T`, while during deserialization it cannot be `const`. This function is effectively a static cast, but one that passes through constness.",
      "commit_id" : "f00db5cd0d03776f56889b226066b404b6a49bab",
      "created_at" : "2020-07-13T20:36:45Z",
      "diff_hunk" : "@@ -165,11 +165,10 @@ enum\n };\n \n //! Convert the reference base type to X, without changing constness or reference type.\n-template<typename X> X& ReadWriteAsHelper(X& x) { return x; }\n-template<typename X> const X& ReadWriteAsHelper(const X& x) { return x; }\n+template<typename X> X& AsBase(X& x) { return x; }",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19503#discussion_r453917160",
      "id" : 453917160,
      "in_reply_to_id" : 453872482,
      "line" : 168,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MzkxNzE2MA==",
      "original_commit_id" : "2149a5f52835bb4bd33f7b2ec974f91fde4c9f91",
      "original_line" : 168,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/serialize.h",
      "position" : 6,
      "pull_request_review_id" : 447582680,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19503",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-07-13T20:36:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/453917160",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
