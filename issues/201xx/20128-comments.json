[
   {
      "author_association" : "MEMBER",
      "body" : "I think it has previously been suggested to only allow absolute paths",
      "created_at" : "2020-10-12T07:30:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-706933436",
      "id" : 706933436,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcwNjkzMzQzNg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-12T07:30:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/706933436",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "```c++\r\n    std::__cxx11::regex invalid_chars(\"(/|\\\\.)(.*)\");\r\n\r\n    if (regex_match(request.params[0].get_str(), invalid_chars)) {\r\n        throw JSONRPCError(RPC_WALLET_ERROR, \"Invalid characters in wallet name\");\r\n    }\r\n```\r\nHow about this? And can someone help me understand what all files need to be changed for this `if` statement to work? \r\n\r\n`rpcwallet.cpp` and `wallet.cpp` ? ",
      "created_at" : "2020-11-13T23:46:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-727087784",
      "id" : 727087784,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzA4Nzc4NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-13T23:46:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727087784",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Not sure what needs to be validated, if it's a valid file path then it should be fine.\r\n\r\n",
      "created_at" : "2020-11-15T22:46:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-727650556",
      "id" : 727650556,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzY1MDU1Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-15T22:46:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727650556",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Not sure what needs to be validated, if it's a valid file path then it should be fine.\r\n\r\nI think we can just validate if the wallet name string has any characters in the beginning that can be used to do more than just creating a wallet in an expected directory. I am thinking to include few more characters in it like `%` mentioned here: https://owasp.org/www-community/attacks/Path_Traversal\r\n\r\n![image](https://user-images.githubusercontent.com/13405205/99200270-4fc32c00-27ca-11eb-9a7d-de6309b8595a.png)\r\n\r\nTrying to stop the user to do anything in the blue area on left when he uses the web application.\r\n\r\nI have never tried to fix things in past, only break lol so not really sure if this thing may affect web apps using bitcoin core but its always good to restrict the user by validating inputs. Other thing which I understood after reading everything is that users should not have privileges to access other directories. This is something we can't control so just basic checks in place. If validating the wallet name string for 3-4 special chars in the beginning breaks anything we can ignore this issue and PR. I will do more research this week and add everything in the PR with tests.",
      "created_at" : "2020-11-15T23:45:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-727659025",
      "id" : 727659025,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzY1OTAyNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-15T23:45:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727659025",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> when he uses the web application\r\n\r\nClearly you could validate user input on the web app. You could even assign a \"safe\" wallet name for the desired wallet name.",
      "created_at" : "2020-11-16T00:11:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-727662809",
      "id" : 727662809,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzY2MjgwOQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-16T00:11:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727662809",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Sure. That's why I mentioned 4 things in the issue description earlier:\r\n\r\n1. > Describe alternatives you've considered\r\nWeb developers should create **secure** web apps that use Bitcoin Core.\r\n2. > can be exploited in **vulnerable** web applications that use Bitcoin Core\r\n3. > It was an issue with the website and we had to fix it although nobody could exploit it because the **third party APIs** that we were using to book the fight tickets were **validating all the things**. So a ticket couldn't be processed after tampering and changing the price by attacker. Similarly, if any web developer makes a mistake and using Bitcoin Core for the web app would still be unaffected if Bitcoin Core itself doesn't allow such things for wallet names.\r\n4. > not a vulnerability in Bitcoin Core and only affects **vulnerable web apps** that use Bitcoin Core",
      "created_at" : "2020-11-16T00:37:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/20128#issuecomment-727668671",
      "id" : 727668671,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20128",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyNzY2ODY3MQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-16T00:37:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727668671",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/13405205?v=4",
         "events_url" : "https://api.github.com/users/prayank23/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prayank23/followers",
         "following_url" : "https://api.github.com/users/prayank23/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prayank23/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prayank23",
         "id" : 13405205,
         "login" : "prayank23",
         "node_id" : "MDQ6VXNlcjEzNDA1MjA1",
         "organizations_url" : "https://api.github.com/users/prayank23/orgs",
         "received_events_url" : "https://api.github.com/users/prayank23/received_events",
         "repos_url" : "https://api.github.com/users/prayank23/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prayank23/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prayank23/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prayank23"
      }
   }
]
