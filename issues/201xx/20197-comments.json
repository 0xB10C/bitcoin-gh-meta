[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-10-20T14:07:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-712879256",
      "id" : 712879256,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMjg3OTI1Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-20T14:07:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712879256",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/7463573?v=4",
         "events_url" : "https://api.github.com/users/sdaftuar/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sdaftuar/followers",
         "following_url" : "https://api.github.com/users/sdaftuar/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sdaftuar/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sdaftuar",
         "id" : 7463573,
         "login" : "sdaftuar",
         "node_id" : "MDQ6VXNlcjc0NjM1NzM=",
         "organizations_url" : "https://api.github.com/users/sdaftuar/orgs",
         "received_events_url" : "https://api.github.com/users/sdaftuar/received_events",
         "repos_url" : "https://api.github.com/users/sdaftuar/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sdaftuar/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sdaftuar"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2020-10-20T14:35:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-712899496",
      "id" : 712899496,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMjg5OTQ5Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-23T04:11:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712899496",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK",
      "created_at" : "2020-10-20T15:00:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-712916354",
      "id" : 712916354,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMjkxNjM1NA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-20T15:00:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712916354",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2020-10-20T16:51:02Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-712999337",
      "id" : 712999337,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMjk5OTMzNw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-20T16:51:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712999337",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Added `CNode::m_inbound_onion` unit test coverage in #20210.",
      "created_at" : "2020-10-21T10:15:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-713464786",
      "id" : 713464786,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMzQ2NDc4Ng==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-23T02:48:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/713464786",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Sounds good, although you might want to add a couple slots for actual localhost peers. :)",
      "created_at" : "2020-10-21T20:43:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-713865992",
      "id" : 713865992,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcxMzg2NTk5Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-10-21T20:43:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/713865992",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Sounds good, although you might want to add a couple slots for actual localhost peers. :)\r\n\r\nAnyone with an old manually-configured hidden service not using the new bind style will have their inbound Tor connections not classified as such, so this may be degradation for them if there is no explicit affordance for localhost peers.",
      "created_at" : "2020-11-05T02:03:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-722078028",
      "id" : 722078028,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMjA3ODAyOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-05T02:03:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/722078028",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thank you for the feedback @gmaxwell and @sipa, will update soon.",
      "created_at" : "2020-11-05T07:58:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-722209703",
      "id" : 722209703,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMjIwOTcwMw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-05T07:58:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/722209703",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->\nð This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a \"draft\".</sub>",
      "created_at" : "2020-11-05T14:09:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-722401457",
      "id" : 722401457,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDcyMjQwMTQ1Nw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-11-05T14:09:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/722401457",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Now that we have unit testing of the eviction logic in `master` (see merged PR #20477): what about adding a small test for this change? :)",
      "created_at" : "2020-12-23T14:09:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-750316382",
      "id" : 750316382,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MDMxNjM4Mg==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-23T14:09:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/750316382",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased, and updated to fall back to localhost if no onion peers are removed. Depending on feedback, this could go further and count onion peers removed to activate localhost if too few onion peers are removed.\r\n\r\n> Now that we have unit testing of the eviction logic in `master` (see merged PR #20477): what about adding a small test for this change? :)\r\n\r\n@practicalswift I agree and spent time yesterday writing tests after extracting some of the untested parts of `SelectNodeToEvict()` to a separate function for reliable testability of the current code and plan to propose that in a separate PR.\r\n",
      "created_at" : "2020-12-23T14:41:55Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-750329753",
      "id" : 750329753,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MDMyOTc1Mw==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-23T14:41:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/750329753",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Rebased and updated after merge of #19972 that created a silent merge conflict.",
      "created_at" : "2020-12-25T23:51:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#issuecomment-751300798",
      "id" : 751300798,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/20197",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDc1MTMwMDc5OA==",
      "performed_via_github_app" : null,
      "updated_at" : "2020-12-25T23:51:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/751300798",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550767783"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550767783"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "there is a nice syntax for this:\r\n\r\n```cpp\r\n{.id = 123, .nTimeConnected = 567, ...}\r\n```\r\n\r\nbut last time I tried some old version of GCC did not support it. Maybe some day...",
      "commit_id" : "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "created_at" : "2021-01-01T13:16:31Z",
      "diff_hunk" : "@@ -21,17 +21,18 @@ FUZZ_TARGET(node_eviction)\n     std::vector<NodeEvictionCandidate> eviction_candidates;\n     while (fuzzed_data_provider.ConsumeBool()) {\n         eviction_candidates.push_back({\n-            fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeIntegral<uint64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n+            /* id */ fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n+            /* nTimeConnected */ fuzzed_data_provider.ConsumeIntegral<int64_t>(),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550767783",
      "id" : 550767783,
      "line" : 25,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2Nzc4Mw==",
      "original_commit_id" : "0d167683b670cb2220052a7719c8ab32ce479bbd",
      "original_line" : 25,
      "original_position" : 16,
      "original_start_line" : 24,
      "path" : "src/test/fuzz/node_eviction.cpp",
      "position" : 16,
      "pull_request_review_id" : 560586885,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197",
      "side" : "RIGHT",
      "start_line" : 24,
      "start_side" : "RIGHT",
      "updated_at" : "2021-01-01T14:59:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550767783",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550768441"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550768441"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "The commit message reads \"p2p: add m_inbound_onion to AttemptToEvictConnection()\". Shouldn't that be `s/AttemptToEvictConnection()/NodeEvictionCandidate/`?",
      "commit_id" : "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "created_at" : "2021-01-01T13:25:44Z",
      "diff_hunk" : "@@ -1247,6 +1247,7 @@ struct NodeEvictionCandidate\n     uint64_t nKeyedNetGroup;\n     bool prefer_evict;\n     bool m_is_local;\n+    bool m_is_onion;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550768441",
      "id" : 550768441,
      "line" : 1250,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2ODQ0MQ==",
      "original_commit_id" : "0d167683b670cb2220052a7719c8ab32ce479bbd",
      "original_line" : 1250,
      "original_position" : 4,
      "original_start_line" : 1249,
      "path" : "src/net.h",
      "position" : 4,
      "pull_request_review_id" : 560586885,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197",
      "side" : "RIGHT",
      "start_line" : 1249,
      "start_side" : "RIGHT",
      "updated_at" : "2021-01-01T14:59:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550768441",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550769530"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550769530"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "```suggestion\r\n    // configured hidden services not using -bind=addr:port=onion will not be detected as inbound onion connections.\r\n```",
      "commit_id" : "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "created_at" : "2021-01-01T13:39:46Z",
      "diff_hunk" : "@@ -923,16 +929,25 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n \n     // Protect the half of the remaining nodes which have been connected the longest.\n     // This replicates the non-eviction implicit behavior, and precludes attacks that start later.\n-    // Reserve half of these protected spots for localhost peers, even if\n+    // Reserve half of these protected spots for onion and localhost peers, even if\n     // they're not longest-uptime overall. This helps protect tor peers, which\n     // tend to be otherwise disadvantaged under our eviction criteria.\n-    size_t initial_size = vEvictionCandidates.size();\n+    const size_t initial_size = vEvictionCandidates.size();\n     size_t total_protect_size = initial_size / 2;\n \n-    // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\n-    size_t local_erase_size = total_protect_size / 2;\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\n+    // Pick out up to 1/4 peers that are connected via our tor onion service, sorted by longest uptime.\n+    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareOnionTimeConnected);\n+    const size_t local_erase_size = total_protect_size / 2;\n+    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_onion; }), vEvictionCandidates.end());\n+\n+    // If no onion peers were removed, extend the same protection to localhost peers, as manually\n+    // configured hidden services not using -bind will not be detected as inbound onion connections.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550769530",
      "id" : 550769530,
      "line" : 944,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc2OTUzMA==",
      "original_commit_id" : "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "original_line" : 944,
      "original_position" : 35,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 35,
      "pull_request_review_id" : 560586885,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-01T14:59:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550769530",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550774610"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550774610"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What about extending `EraseLastKElements()` with one more argument \"predicate\" and remove elements only if it returns `true` on them (with a default that assumes `true` for any element)?\r\n\r\nThen this code would look like:\r\n\r\n```cpp\r\nEraseLastKElements(\r\n    vEvictionCandidates,\r\n    CompareOnionTimeConnected,\r\n    local_erase_size,\r\n    [](NodeEvictionCandidate const &n) { return n.m_is_onion; });\r\n```\r\n\r\nmaybe out of the scope of this PR.",
      "commit_id" : "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "created_at" : "2021-01-01T14:41:41Z",
      "diff_hunk" : "@@ -923,16 +929,25 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n \n     // Protect the half of the remaining nodes which have been connected the longest.\n     // This replicates the non-eviction implicit behavior, and precludes attacks that start later.\n-    // Reserve half of these protected spots for localhost peers, even if\n+    // Reserve half of these protected spots for onion and localhost peers, even if\n     // they're not longest-uptime overall. This helps protect tor peers, which\n     // tend to be otherwise disadvantaged under our eviction criteria.\n-    size_t initial_size = vEvictionCandidates.size();\n+    const size_t initial_size = vEvictionCandidates.size();\n     size_t total_protect_size = initial_size / 2;\n \n-    // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\n-    size_t local_erase_size = total_protect_size / 2;\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\n+    // Pick out up to 1/4 peers that are connected via our tor onion service, sorted by longest uptime.\n+    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareOnionTimeConnected);\n+    const size_t local_erase_size = total_protect_size / 2;\n+    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_onion; }), vEvictionCandidates.end());",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550774610",
      "id" : 550774610,
      "line" : 941,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc3NDYxMA==",
      "original_commit_id" : "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "original_line" : 941,
      "original_position" : 32,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 32,
      "pull_request_review_id" : 560586885,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-01T14:59:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550774610",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550775652"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550775652"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Just to note - this assumes that if there are recognizable onion connections (via `-bind=addr:port=onion`) then there are **not** non-recognizable ones (statically/manually configured tor daemon pointing to our standard p2p port, e.g. 8333).\r\n\r\nThis assumption may not be true as there could be a node that is configured both via `-bind=addr:port=onion` (connections coming to 8334 are recognized as onion) and also a static tor config redirecting to 8333.\r\n\r\nI think the code is ok as it is because the above would be rare and maybe not worth the code complexity to tweak the eviction policy for it.",
      "commit_id" : "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "created_at" : "2021-01-01T14:54:19Z",
      "diff_hunk" : "@@ -923,16 +929,25 @@ static void EraseLastKElements(std::vector<T> &elements, Comparator comparator,\n \n     // Protect the half of the remaining nodes which have been connected the longest.\n     // This replicates the non-eviction implicit behavior, and precludes attacks that start later.\n-    // Reserve half of these protected spots for localhost peers, even if\n+    // Reserve half of these protected spots for onion and localhost peers, even if\n     // they're not longest-uptime overall. This helps protect tor peers, which\n     // tend to be otherwise disadvantaged under our eviction criteria.\n-    size_t initial_size = vEvictionCandidates.size();\n+    const size_t initial_size = vEvictionCandidates.size();\n     size_t total_protect_size = initial_size / 2;\n \n-    // Pick out up to 1/4 peers that are localhost, sorted by longest uptime.\n-    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareLocalHostTimeConnected);\n-    size_t local_erase_size = total_protect_size / 2;\n-    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_local; }), vEvictionCandidates.end());\n+    // Pick out up to 1/4 peers that are connected via our tor onion service, sorted by longest uptime.\n+    std::sort(vEvictionCandidates.begin(), vEvictionCandidates.end(), CompareOnionTimeConnected);\n+    const size_t local_erase_size = total_protect_size / 2;\n+    vEvictionCandidates.erase(std::remove_if(vEvictionCandidates.end() - local_erase_size, vEvictionCandidates.end(), [](NodeEvictionCandidate const &n) { return n.m_is_onion; }), vEvictionCandidates.end());\n+\n+    // If no onion peers were removed, extend the same protection to localhost peers, as manually\n+    // configured hidden services not using -bind will not be detected as inbound onion connections.\n+    if (initial_size == vEvictionCandidates.size()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r550775652",
      "id" : 550775652,
      "line" : 945,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MDc3NTY1Mg==",
      "original_commit_id" : "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "original_line" : 945,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 36,
      "pull_request_review_id" : 560586885,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-01-01T14:59:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/550775652",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r557297105"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557297105"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Designated initializers are only standardized in c++20: https://en.cppreference.com/w/cpp/language/aggregate_initialization#Designated_initializers",
      "commit_id" : "c16ed372bdc71795fbebc5dbf519a1d748a136dc",
      "created_at" : "2021-01-14T10:34:54Z",
      "diff_hunk" : "@@ -21,17 +21,18 @@ FUZZ_TARGET(node_eviction)\n     std::vector<NodeEvictionCandidate> eviction_candidates;\n     while (fuzzed_data_provider.ConsumeBool()) {\n         eviction_candidates.push_back({\n-            fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeIntegral<int64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeIntegral<uint64_t>(),\n-            fuzzed_data_provider.ConsumeBool(),\n-            fuzzed_data_provider.ConsumeBool(),\n+            /* id */ fuzzed_data_provider.ConsumeIntegral<NodeId>(),\n+            /* nTimeConnected */ fuzzed_data_provider.ConsumeIntegral<int64_t>(),",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/20197#discussion_r557297105",
      "id" : 557297105,
      "in_reply_to_id" : 550767783,
      "line" : 25,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzI5NzEwNQ==",
      "original_commit_id" : "0d167683b670cb2220052a7719c8ab32ce479bbd",
      "original_line" : 25,
      "original_position" : 16,
      "original_start_line" : 24,
      "path" : "src/test/fuzz/node_eviction.cpp",
      "position" : 16,
      "pull_request_review_id" : 568106998,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/20197",
      "side" : "RIGHT",
      "start_line" : 24,
      "start_side" : "RIGHT",
      "updated_at" : "2021-01-14T10:34:55Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557297105",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
