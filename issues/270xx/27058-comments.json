[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\nA summary of reviews will appear here.\n",
      "created_at" : "2023-02-07T19:17:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27058#issuecomment-1421318701",
      "id" : 1421318701,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27058",
      "node_id" : "IC_kwDOABII585Ut5ot",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1421318701/reactions"
      },
      "updated_at" : "2023-02-07T19:17:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1421318701",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27058#discussion_r1099150826"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1099150826"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "If you're removing this line, so there is no need to have `branch` var anymore? ",
      "commit_id" : "61f21001ac41b0c81962e16876b40a99386b4587",
      "created_at" : "2023-02-07T20:04:38Z",
      "diff_hunk" : "@@ -153,15 +200,11 @@ def main():\n         allow_unclean = current_commit in unclean_merge_allowed\n         if len(parents) == 2 and check_merge and not allow_unclean:\n             current_tree = subprocess.check_output([GIT, 'show', '--format=%T', current_commit]).decode('utf8').splitlines()[0]\n-            subprocess.call([GIT, 'checkout', '--force', '--quiet', parents[0]])\n-            subprocess.call([GIT, 'merge', '--no-ff', '--quiet', '--no-gpg-sign', parents[1]], stdout=subprocess.DEVNULL)\n-            recreated_tree = subprocess.check_output([GIT, 'show', '--format=format:%T', 'HEAD']).decode('utf8').splitlines()[0]\n+            recreated_tree = subprocess.check_output([GIT, \"merge-tree\", parents[0], parents[1]]).decode('utf8').splitlines()[0]\n             if current_tree != recreated_tree:\n                 print(\"Merge commit {} is not clean\".format(current_commit), file=sys.stderr)\n-                subprocess.call([GIT, 'diff', current_commit])\n-                subprocess.call([GIT, 'checkout', '--force', '--quiet', branch])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27058#discussion_r1099150826",
      "id" : 1099150826,
      "line" : 162,
      "node_id" : "PRRC_kwDOABII585Bg7Xq",
      "original_commit_id" : "61f21001ac41b0c81962e16876b40a99386b4587",
      "original_line" : 162,
      "original_position" : 96,
      "original_start_line" : null,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : 96,
      "pull_request_review_id" : 1287910421,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1099150826/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-07T20:04:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1099150826",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27058#discussion_r1099250181"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1099250181"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Removed.",
      "commit_id" : "15d9fc0933be20f9459a32d8605030145230226d",
      "created_at" : "2023-02-07T21:14:34Z",
      "diff_hunk" : "@@ -153,15 +200,11 @@ def main():\n         allow_unclean = current_commit in unclean_merge_allowed\n         if len(parents) == 2 and check_merge and not allow_unclean:\n             current_tree = subprocess.check_output([GIT, 'show', '--format=%T', current_commit]).decode('utf8').splitlines()[0]\n-            subprocess.call([GIT, 'checkout', '--force', '--quiet', parents[0]])\n-            subprocess.call([GIT, 'merge', '--no-ff', '--quiet', '--no-gpg-sign', parents[1]], stdout=subprocess.DEVNULL)\n-            recreated_tree = subprocess.check_output([GIT, 'show', '--format=format:%T', 'HEAD']).decode('utf8').splitlines()[0]\n+            recreated_tree = subprocess.check_output([GIT, \"merge-tree\", parents[0], parents[1]]).decode('utf8').splitlines()[0]\n             if current_tree != recreated_tree:\n                 print(\"Merge commit {} is not clean\".format(current_commit), file=sys.stderr)\n-                subprocess.call([GIT, 'diff', current_commit])\n-                subprocess.call([GIT, 'checkout', '--force', '--quiet', branch])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27058#discussion_r1099250181",
      "id" : 1099250181,
      "in_reply_to_id" : 1099150826,
      "line" : 162,
      "node_id" : "PRRC_kwDOABII585BhToF",
      "original_commit_id" : "61f21001ac41b0c81962e16876b40a99386b4587",
      "original_line" : 162,
      "original_position" : 96,
      "original_start_line" : null,
      "path" : "contrib/verify-commits/verify-commits.py",
      "position" : 107,
      "pull_request_review_id" : 1288010694,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1099250181/reactions"
      },
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-07T21:14:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1099250181",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27058#discussion_r1099900493"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1099900493"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Not sure if it makes sense to document the last merge commit here.\r\n\r\nKeeping the key will also mean that the script will break again once the key naturally expires or is revoked. So I guess you'd also have to document a faketime where the script still passes? Moreover, the key might be purged from keyservers if it is expired/revoked, so you may also have to document the full key here. Not sure if we want this.\r\n\r\nIt seems easier to just bump the trusted root, like it was done before, see d4b3dc5b0a726cc4cc7a8467be43126e78f841cf\r\n\r\nThe trusted root hash commits to all previous commits, so there shouldn't be any downside, compared to listing a subset of commits prior to the trusted root hash.\r\n\r\nOf course anyone is free to archive previous keys as long as they want and re-run gpg on previous commits, with or without faketime, as often as they want. But doing that once as part of the review process of bumping the trusted root should be enough. I don't see a need to maintain every key forever.\r\n\r\nOverall I think, the script should ideally be easy to understand and use, so that many users can read and use it. It is already hard enough to properly run the script (just one example: https://github.com/bitcoin/bitcoin/pull/25197#issuecomment-1137097923 ; happy to provide more examples), so adding even more complexity and failure modes will mean that likely no one is running it in practice, let alone understand it and be able to act on errors if there are any.",
      "commit_id" : "15d9fc0933be20f9459a32d8605030145230226d",
      "created_at" : "2023-02-08T09:54:15Z",
      "diff_hunk" : "@@ -1,6 +1,7 @@\n-71A3B16735405025D447E8F274810B012346C9A6\n-B8B3F1C0E58C15DB6A81D30C3648A882F4316B9B\n-E777299FC265DD04793070EB944D35F9AC3DB76A\n-D1DBF2C4B96F2DEBF4C16654410108112E7EA81F\n-152812300785C96444D3334D17565732E08E5E41\n-6B002C6EA3F91B1B0DF0C9BC8F617F1200A6D25C\n+key,since,until",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27058#discussion_r1099900493",
      "id" : 1099900493,
      "line" : 1,
      "node_id" : "PRRC_kwDOABII585BjyZN",
      "original_commit_id" : "15d9fc0933be20f9459a32d8605030145230226d",
      "original_line" : 1,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "contrib/verify-commits/trusted-keys",
      "position" : 7,
      "pull_request_review_id" : 1288827276,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1099900493/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-08T09:54:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1099900493",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27058#discussion_r1100328392"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1100328392"
         }
      },
      "author_association" : "MEMBER",
      "body" : "For me, the question was how comfortable are we with a really recent trusted root? Suppose an active maintainer needs to be removed on very short notice, e.g. keys and account is compromised. We could drop the key and update the trusted root to the current `HEAD`, but are we okay with doing that? With this change, we could just set the `until` commit rather than removing the key.\r\n\r\nMy thinking was that the trusted root shouldn't be updated ever, and really we should make it possible to move it even earlier so that older commits signed by previous maintainers can still be verified. But maybe that's not how people think of verify-commits.",
      "commit_id" : "15d9fc0933be20f9459a32d8605030145230226d",
      "created_at" : "2023-02-08T15:43:23Z",
      "diff_hunk" : "@@ -1,6 +1,7 @@\n-71A3B16735405025D447E8F274810B012346C9A6\n-B8B3F1C0E58C15DB6A81D30C3648A882F4316B9B\n-E777299FC265DD04793070EB944D35F9AC3DB76A\n-D1DBF2C4B96F2DEBF4C16654410108112E7EA81F\n-152812300785C96444D3334D17565732E08E5E41\n-6B002C6EA3F91B1B0DF0C9BC8F617F1200A6D25C\n+key,since,until",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27058#discussion_r1100328392",
      "id" : 1100328392,
      "in_reply_to_id" : 1099900493,
      "line" : 1,
      "node_id" : "PRRC_kwDOABII585Bla3I",
      "original_commit_id" : "15d9fc0933be20f9459a32d8605030145230226d",
      "original_line" : 1,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "contrib/verify-commits/trusted-keys",
      "position" : 7,
      "pull_request_review_id" : 1289464151,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1100328392/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-08T15:43:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1100328392",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27058#discussion_r1100351986"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27058"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1100351986"
         }
      },
      "author_association" : "MEMBER",
      "body" : "> But maybe that's not how people think of verify-commits.\r\n\r\nYeah opinions may differ on this. Though, I think there is no easy way out of manually reviewing (and manually taking over! [1]) changes to this script and the data it uses. So optimizing for an easy and repeatable review process should be priority, to allow as many people to repeat it as possible. Otherwise, if the review process is different for each occasion, it is impossible to document and hard to follow. I do think it probably makes sense to allow for one-off rare exceptions (unclean merge, unsigned merge, wrong sha512, ...), which can be used during the review process of bumping the trusted root, but I think will complicate stuff if they are needed to be maintained for the whole history at the HEAD commit forever. (Note that anyone can check out an earlier version to get them for a previous commit, even if they are removed from HEAD)\r\n\r\n> We could drop the key and update the trusted root to the current HEAD, but are we okay with doing that?\r\n\r\nI'd say yes. There is no way out of doing a change on short notice. And then, whether reviewers review the `until` commit, or the trusted root, which will be equal to the `until` commit, shouldn't make a difference?\r\n\r\n\r\n\r\n\r\n[1] Blindly checking out the script on the fetched/downloaded/merged git commit is next to useless, unless you are the CI doing a smoke test.",
      "commit_id" : "15d9fc0933be20f9459a32d8605030145230226d",
      "created_at" : "2023-02-08T16:01:33Z",
      "diff_hunk" : "@@ -1,6 +1,7 @@\n-71A3B16735405025D447E8F274810B012346C9A6\n-B8B3F1C0E58C15DB6A81D30C3648A882F4316B9B\n-E777299FC265DD04793070EB944D35F9AC3DB76A\n-D1DBF2C4B96F2DEBF4C16654410108112E7EA81F\n-152812300785C96444D3334D17565732E08E5E41\n-6B002C6EA3F91B1B0DF0C9BC8F617F1200A6D25C\n+key,since,until",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27058#discussion_r1100351986",
      "id" : 1100351986,
      "in_reply_to_id" : 1099900493,
      "line" : 1,
      "node_id" : "PRRC_kwDOABII585Blgny",
      "original_commit_id" : "15d9fc0933be20f9459a32d8605030145230226d",
      "original_line" : 1,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "contrib/verify-commits/trusted-keys",
      "position" : 7,
      "pull_request_review_id" : 1289500329,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27058",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1100351986/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-08T16:01:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1100351986",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
