[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| ACK | [achow101](https://github.com/bitcoin/bitcoin/pull/27068#issuecomment-1424987145), [furszy](https://github.com/bitcoin/bitcoin/pull/27068#pullrequestreview-1293142331) |\n| Concept ACK | [stickies-v](https://github.com/bitcoin/bitcoin/pull/27068#pullrequestreview-1293798021) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26347](https://github.com/bitcoin/bitcoin/pull/26347) (wallet: ensure the wallet is unlocked when needed for rescanning by ishaanam)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2023-02-09T18:53:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27068#issuecomment-1424666568",
      "id" : 1424666568,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27068",
      "node_id" : "IC_kwDOABII585U6q_I",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1424666568/reactions"
      },
      "updated_at" : "2023-02-10T18:44:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1424666568",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/27068#discussion_r1101936133"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27068"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1101936133"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Instead of repeating this in all places where SecureString is used, what about moving it to src/support/allocators/secure.h once? ",
      "commit_id" : "2119fd3039caa0dab8e627acd776ab7bc749d2d2",
      "created_at" : "2023-02-09T19:36:36Z",
      "diff_hunk" : "@@ -229,11 +226,10 @@ RPCHelpMan encryptwallet()\n         throw JSONRPCError(RPC_WALLET_WRONG_ENC_STATE, \"Error: running with an encrypted wallet, but encryptwallet was called.\");\n     }\n \n-    // TODO: get rid of this .c_str() by implementing SecureString::operator=(std::string)\n-    // Alternately, find a way to make request.params[0] mlock()'d to begin with.\n+    // Consider finding a way to make request.params[0] mlock()ed",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27068#discussion_r1101936133",
      "id" : 1101936133,
      "line" : null,
      "node_id" : "PRRC_kwDOABII585BrjYF",
      "original_commit_id" : "d7b59b498c2266cf6970bd7ecc47e4fcaf06911f",
      "original_line" : 229,
      "original_position" : 36,
      "original_start_line" : null,
      "path" : "src/wallet/rpc/encrypt.cpp",
      "position" : null,
      "pull_request_review_id" : 1291870270,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/27068",
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1101936133/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2023-02-09T19:41:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1101936133",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "ACK 6ac272390a3d39ee0151cddc6cfa03877a9fd600",
      "created_at" : "2023-02-09T23:48:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27068#issuecomment-1424987145",
      "id" : 1424987145,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27068",
      "node_id" : "IC_kwDOABII585U75QJ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1424987145/reactions"
      },
      "updated_at" : "2023-02-09T23:48:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1424987145",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "node_id" : "MDQ6VXNlcjM3ODIyNzQ=",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> As the impossibility to unlock the wallet could be an stressful time, what about notifying the user if the passphrase has a null character and decryption failed?.\r\n\r\nInteresting idea! I agree that it could be useful to provide feedback in these (likely unusual) cases.\r\n\r\nI can think of three potential approaches:\r\n\r\n1. The one you described -- though we may want to be explicit about the version they'd need to run.\r\n2. Return something like _\"Error: decryption failed: the passphrase contains a null character. If this passphrase was set with a version of this software prior to 25.0, please try again with only the characters up to the first null character.\"_\r\n3. Check to see if the wallet _would_ decrypt using the substring up to the first null and only then emit errors (or even just warnings) like in 1 or 2.\r\n\r\nThe third option is probably the most user-friendly, and I don't _think_ it's a significant security reduction (it's a free second attempt), but my intuition says it's the wrong approach. ",
      "created_at" : "2023-02-10T17:36:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/27068#issuecomment-1426129248",
      "id" : 1426129248,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/27068",
      "node_id" : "IC_kwDOABII585VAQFg",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1426129248/reactions"
      },
      "updated_at" : "2023-02-10T17:36:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1426129248",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/116917595?v=4",
         "events_url" : "https://api.github.com/users/john-moffett/events{/privacy}",
         "followers_url" : "https://api.github.com/users/john-moffett/followers",
         "following_url" : "https://api.github.com/users/john-moffett/following{/other_user}",
         "gists_url" : "https://api.github.com/users/john-moffett/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/john-moffett",
         "id" : 116917595,
         "login" : "john-moffett",
         "node_id" : "U_kgDOBvgFWw",
         "organizations_url" : "https://api.github.com/users/john-moffett/orgs",
         "received_events_url" : "https://api.github.com/users/john-moffett/received_events",
         "repos_url" : "https://api.github.com/users/john-moffett/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/john-moffett/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/john-moffett/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/john-moffett"
      }
   }
]
