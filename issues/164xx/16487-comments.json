[
   {
      "author_association" : "MEMBER",
      "body" : "Could add a test to make it technically in use? Perhaps with a comment describing that the parameter is intentionally (and temporarily) unused outside of tests.",
      "created_at" : "2019-07-29T18:08:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16487#issuecomment-516101703",
      "id" : 516101703,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16487",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNjEwMTcwMw==",
      "updated_at" : "2019-07-29T18:08:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/516101703",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16324](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16324.html) (Get cs_main out of the critical path in ProcessMessages by TheBlueMatt)\n* [#16323](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16323.html) (Call ProcessNewBlock() asynchronously by TheBlueMatt)\n* [#16279](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16279.html) (Return the AcceptBlock CValidationState directly in ProcessNewBlock by TheBlueMatt)\n* [#14384](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14384.html) (Fire TransactionRemovedFromMempool callbacks from mempool by l2a5b1)\n* [#13686](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13686.html) (ZMQ: Small cleanups in the ZMQ code by domob1812)\n* [#9849](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/9849.html) (Qt: Network Watch tool by luke-jr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-07-29T21:29:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16487#issuecomment-516169688",
      "id" : 516169688,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16487",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNjE2OTY4OA==",
      "updated_at" : "2019-07-30T19:14:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/516169688",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The current [appveyor errors](https://ci.appveyor.com/project/DrahtBot/bitcoin/builds/26320361) are really brutal, they don't even tell you what source file they come from\r\n\r\n```\r\nc:\\program files (x86)\\microsoft visual studio\\2017\\community\\vc\\tools\\msvc\\14.16.27023\\include\\type_traits(912): error C2139: 'CChainState': an undefined class is not allowed as an argument to compiler intrinsic type trait '__is_assignable' [C:\\projects\\bitcoin\\build_msvc\\libbitcoin_server\\libbitcoin_server.vcxproj]\r\nc:\\program files (x86)\\microsoft visual studio\\2017\\community\\vc\\tools\\msvc\\14.16.27023\\include\\type_traits(901): error C2139: 'CChainState': an undefined class is not allowed as an argument to compiler intrinsic type trait '__is_assignable' [C:\\projects\\bitcoin\\build_msvc\\libbitcoin_server\\libbitcoin_server.vcxproj]\r\n```\r\n\r\n@MarcoFalke, maybe we should consider removing the `/v:q` option from the appveyor config? (I'm guessing it controls verbosity)?\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/74f1a27f2f45af7dafcc34df766cf76d29c7c6ed/.appveyor.yml#L36\r\n\r\nWe could experiment with removing `/v:q` in this PR to see if that helps.",
      "created_at" : "2019-07-30T19:56:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16487#issuecomment-516571886",
      "id" : 516571886,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16487",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNjU3MTg4Ng==",
      "updated_at" : "2019-07-30T19:56:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/516571886",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "cc @sipsorcery ",
      "created_at" : "2019-07-30T20:28:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16487#issuecomment-516583025",
      "id" : 516583025,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16487",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUxNjU4MzAyNQ==",
      "updated_at" : "2019-07-30T20:28:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/516583025",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16487#discussion_r308936332"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16487"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/308936332"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "CChainState isn't really a data object by itself, more of a handle to access other objects containing real state, so I'm curious what the `const` keywords throughout the PR are expressing. \r\n\r\nI guess I'm asking to be reassured that this PR isn't likely to be followed with another PR in the future removing all these consts because one `CValidationInterface` listener needs call a non-const method. It's good have some general reasoning before adding an infectious `const` to avoid churn or arms races of `mutable`'s overriding `const`'s and generally misleading code.",
      "commit_id" : "fa47a73330199758d8c7b7e1ad6ab209276d54c3",
      "created_at" : "2019-07-30T20:50:33Z",
      "diff_hunk" : "@@ -188,7 +188,8 @@ bool BaseIndex::Rewind(const CBlockIndex* current_tip, const CBlockIndex* new_ti\n     return true;\n }\n \n-void BaseIndex::BlockConnected(const std::shared_ptr<const CBlock>& block, const CBlockIndex* pindex,\n+void BaseIndex::BlockConnected(const CChainState& chainstate,",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16487#discussion_r308936332",
      "id" : 308936332,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwODkzNjMzMg==",
      "original_commit_id" : "fa47a73330199758d8c7b7e1ad6ab209276d54c3",
      "original_position" : 5,
      "path" : "src/index/base.cpp",
      "position" : 5,
      "pull_request_review_id" : 268659955,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16487",
      "updated_at" : "2019-07-30T21:20:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/308936332",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16487#discussion_r308945435"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16487"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/308945435"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This looks right, but in case the std::bind code is what's responsible for the msvc errors, you could try a workaround by replacing `std::bind` calls with lambdas:\r\n\r\n```\r\nvoid RegisterValidationInterface(CValidationInterface* pwalletIn) {\r\n    ValidationInterfaceConnections& conns = g_signals.m_internals->m_connMainSignals[pwalletIn];\r\n    conns.UpdatedBlockTip = g_signals.m_internals->UpdatedBlockTip.connect([pwalletIn](const CChainState& chainstate, const CBlockIndex *pindexNew, const CBlockIndex *pindexFork, bool fInitialDownload){ pwalletIn->UpdatedBlockTip(chainstate, pindexNew, pindexFork, fInitialDownload); });\r\n    conns.TransactionAddedToMempool = g_signals.m_internals->TransactionAddedToMempool.connect([pwalletIn](const CTransactionRef &ptxn){ pwalletIn->TransactionAddedToMempool(ptxn); });\r\n    conns.TransactionRemovedFromMempool = g_signals.m_internals->TransactionRemovedFromMempool.connect([pwalletIn](const CTransactionRef &ptx){ pwalletIn->TransactionRemovedFromMempool(ptx); });\r\n    conns.BlockConnected = g_signals.m_internals->BlockConnected.connect([pwalletIn](const CChainState& chainstate, const std::shared_ptr<const CBlock> &block, const CBlockIndex *pindex, const std::vector<CTransactionRef> &txnConflicted){ pwalletIn->BlockConnected(chainstate, block, pindex, txnConflicted); });\r\n    conns.BlockDisconnected = g_signals.m_internals->BlockDisconnected.connect([pwalletIn](const CChainState& chainstate, const std::shared_ptr<const CBlock> &block){ pwalletIn->BlockDisconnected(chainstate, block); });\r\n    conns.ChainStateFlushed = g_signals.m_internals->ChainStateFlushed.connect([pwalletIn](const CChainState& chainstate, const CBlockLocator &locator){ pwalletIn->ChainStateFlushed(chainstate, locator); });\r\n    conns.BlockChecked = g_signals.m_internals->BlockChecked.connect([pwalletIn](const CChainState& chainstate, const CBlock& block, const CValidationState& state){ pwalletIn->BlockChecked(chainstate, block, state); });\r\n    conns.NewPoWValidBlock = g_signals.m_internals->NewPoWValidBlock.connect([pwalletIn](const CChainState& chainstate, const CBlockIndex *pindex, const std::shared_ptr<const CBlock>& block){ pwalletIn->NewPoWValidBlock(chainstate, pindex, block); });\r\n}\r\n```",
      "commit_id" : "fa47a73330199758d8c7b7e1ad6ab209276d54c3",
      "created_at" : "2019-07-30T21:13:21Z",
      "diff_hunk" : "@@ -91,14 +91,14 @@ CMainSignals& GetMainSignals()\n \n void RegisterValidationInterface(CValidationInterface* pwalletIn) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16487#discussion_r308945435",
      "id" : 308945435,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwODk0NTQzNQ==",
      "original_commit_id" : "fa47a73330199758d8c7b7e1ad6ab209276d54c3",
      "original_position" : 23,
      "path" : "src/validationinterface.cpp",
      "position" : 23,
      "pull_request_review_id" : 268659955,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16487",
      "updated_at" : "2019-07-30T21:20:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/308945435",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
