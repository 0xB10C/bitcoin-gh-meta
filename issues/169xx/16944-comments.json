[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Concept ACK",
      "created_at" : "2019-09-23T19:14:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-534243460",
      "id" : 534243460,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNDI0MzQ2MA==",
      "updated_at" : "2019-09-23T19:14:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/534243460",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/45598?v=4",
         "events_url" : "https://api.github.com/users/jb55/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jb55/followers",
         "following_url" : "https://api.github.com/users/jb55/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jb55/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jb55",
         "id" : 45598,
         "login" : "jb55",
         "node_id" : "MDQ6VXNlcjQ1NTk4",
         "organizations_url" : "https://api.github.com/users/jb55/orgs",
         "received_events_url" : "https://api.github.com/users/jb55/received_events",
         "repos_url" : "https://api.github.com/users/jb55/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jb55/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jb55/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jb55"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Would love to see this happen +1",
      "created_at" : "2019-09-23T19:18:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-534244571",
      "id" : 534244571,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNDI0NDU3MQ==",
      "updated_at" : "2019-09-23T19:18:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/534244571",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/797193?v=4",
         "events_url" : "https://api.github.com/users/nvk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/nvk/followers",
         "following_url" : "https://api.github.com/users/nvk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/nvk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/nvk",
         "id" : 797193,
         "login" : "nvk",
         "node_id" : "MDQ6VXNlcjc5NzE5Mw==",
         "organizations_url" : "https://api.github.com/users/nvk/orgs",
         "received_events_url" : "https://api.github.com/users/nvk/received_events",
         "repos_url" : "https://api.github.com/users/nvk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/nvk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/nvk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/nvk"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16966](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16966.html) (ui: make send a wizard by Sjors)\n* [#16964](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16964.html) (gui: Change sendcoins dialogue Yes to Send by instagibbs)\n* [#16710](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16710.html) (build: Enable -Wsuggest-override if available by hebasto)\n* [#15987](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15987.html) (Wallet, GUI: Warn when sending to already-used Bitcoin addresses by luke-jr)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-09-23T20:01:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-534260562",
      "id" : 534260562,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNDI2MDU2Mg==",
      "updated_at" : "2019-09-26T10:04:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/534260562",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "concept ACK.\r\n\r\nI do however think a proper dialogue will be required to let the user know what's going on at a minimum rather than magic resulting in a clipboard result.\r\n\r\nvery light testing also shows it appears it does what's on the tin. I'll do lots more testing later once approach is settled.",
      "created_at" : "2019-09-23T20:28:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-534270538",
      "id" : 534270538,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNDI3MDUzOA==",
      "updated_at" : "2019-09-23T20:31:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/534270538",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "So as some of you saw, I did some related work quite awhile ago. I have a dialog with support for creating/saving/loading/signing/sending these. It's somewhat modeled after the offline signing UI in Armory. I was never _happy_ with the UI, and I think designing this to be intuitive is really hard, but I think it may already be an improvement over clipboard-only.\r\n\r\nLet me spend a few minutes figuring out what the most recent version is that builds cleanly and works, and I will link it here so people can try it.",
      "created_at" : "2019-09-23T20:58:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-534282105",
      "id" : 534282105,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNDI4MjEwNQ==",
      "updated_at" : "2019-09-23T20:58:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/534282105",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.",
      "created_at" : "2019-09-23T21:42:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-534297117",
      "id" : 534297117,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNDI5NzExNw==",
      "updated_at" : "2019-09-23T21:42:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/534297117",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ok, if you'd like to see my work on this, please have a look at https://github.com/gwillen/bitcoin/tree/feature-offline-v2 .\r\n\r\nYou will need to check preferences->wallet->enable offline transaction features. Then you'll get an 'Offline' menu, a new offline transactions dialog box, and a new pair of checkboxes in the 'send' dialog: \"Include watchonly coins\" and \"create offline transaction\" (which is forced on if you include watchonly). If you select the latter, the 'send' button becomes \"Create unsigned\" and will take you to the new dialog.\r\n\r\nThere is still some amount of jank to be ironed out, there are some XXX comments in the source and some missing error handling.\r\n\r\nI've had this vaguely shelved for awhile, but I'd be happy to bring it out and work aggressively on it now if desired; I'd also be happy to bring it out less aggressively and start prepping it as a possible sequel to the PR under discussion here.",
      "created_at" : "2019-09-23T22:20:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-534307676",
      "id" : 534307676,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNDMwNzY3Ng==",
      "updated_at" : "2019-09-23T22:22:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/534307676",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/458997?v=4",
         "events_url" : "https://api.github.com/users/gwillen/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gwillen/followers",
         "following_url" : "https://api.github.com/users/gwillen/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gwillen/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gwillen",
         "id" : 458997,
         "login" : "gwillen",
         "node_id" : "MDQ6VXNlcjQ1ODk5Nw==",
         "organizations_url" : "https://api.github.com/users/gwillen/orgs",
         "received_events_url" : "https://api.github.com/users/gwillen/received_events",
         "repos_url" : "https://api.github.com/users/gwillen/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gwillen/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gwillen/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gwillen"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@gwillen can you make a (draft) PR with that branch? If you rebase on top of this, you can probably drop the \"Enable offline transaction features\" checkbox as well as the \"include watchonly coins\" and \"create unsigned \"checkboxes, in favor of only allowing the functionality with watch-only wallets.\r\n\r\nI like how the send button text changes, so I'll steal that for this PR :-)\r\n\r\n<img width=\"898\" alt=\"Schermafbeelding 2019-09-24 om 13 49 21\" src=\"https://user-images.githubusercontent.com/10217/65509165-219dd100-ded2-11e9-8a3e-c6c9c93dc371.png\">\r\n\r\nOnce we have descriptor wallets and better HWI integration, the simple distinction between watch-only and wallets with private keys will no longer work. For example you might be part of a 2 of 3 multisig, with the keys in the wallet. Or maybe you don't have keys in the Core wallet, but your hardware wallet can sign its part via USB.\r\n\r\nSo in terms of your wizard, I would split into two wizards: one for composing & exporting, and one for loading.\r\n\r\n<img width=\"910\" alt=\"Schermafbeelding 2019-09-24 om 14 09 54\" src=\"https://user-images.githubusercontent.com/10217/65511729-1b125800-ded8-11e9-9a77-510e0902fcef.png\">\r\n\r\nThere's probably a step 0 where you attempt to (partially) sign with your own keys and with any connected devices. If that's not enough, then you go to step 1 where you can export the PSBT via clipboard or file system.\r\n\r\nI would introduce a fresh dialog for loading, maybe co-signing and then broadcasting a transaction. ",
      "created_at" : "2019-09-24T12:36:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-534538035",
      "id" : 534538035,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNDUzODAzNQ==",
      "updated_at" : "2019-09-24T12:39:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/534538035",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Let's continue the UX brainstom here: #16954",
      "created_at" : "2019-09-24T13:34:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-534560388",
      "id" : 534560388,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNDU2MDM4OA==",
      "updated_at" : "2019-09-24T13:34:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/534560388",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm afraid the current version of this PR introduces a bug in `CWallet::ListCoins`.\r\n\r\nFirst, note that `==` has higher precedence than the ternary conditional:\r\n\r\n```\r\n[cling]$ 1 == 2 ? 3 : 4\r\n(int) 4\r\n[cling]$ (1 == 2) ? 3 : 4\r\n(int) 4\r\n[cling]$ 1 == (2 ? 3 : 4)\r\n(bool) false\r\n```\r\n\r\nSecond, some context:\r\n\r\n```\r\nunsigned int IsMine(...);\r\nbool IsWalletFlagSet(...);\r\nint ISMINE_WATCH_ONLY = 1;\r\nint ISMINE_SPENDABLE = 2;\r\n```\r\n\r\nThis is being suggested in this PR:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/41c5165aa30d65d40ef3921bf4760c13f5d42b21/src/wallet/wallet.cpp#L2592-L2593\r\n\r\nShortened to highlight the issue:\r\n\r\n```\r\nif (... &&\r\n    IsMine(it->second.tx->vout[output.n]) ==\r\n      IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS) ?\r\n      ISMINE_WATCH_ONLY : ISMINE_SPENDABLE) {\r\n```\r\n\r\nWhich -- given the precedence rules -- is equivalent to:\r\n\r\n```\r\nif (... &&\r\n    (IsMine(it->second.tx->vout[output.n]) ==\r\n      IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS)) ?\r\n      ISMINE_WATCH_ONLY : ISMINE_SPENDABLE) {\r\n```\r\n\r\nWhich -- given that `ISMINE_WATCH_ONLY` and `ISMINE_SPENDABLE` are both non-zero integer constants (`1` and `2`) that will be evaluated in a boolean context -- is equivalent to:\r\n\r\n```\r\nif (... && true) {\r\n```\r\n\r\nOr simply:\r\n\r\n```\r\nif (...) {\r\n```\r\n\r\n:)\r\n\r\nI think the intention was:\r\n\r\n```\r\nif (... &&\r\n    IsMine(it->second.tx->vout[output.n]) ==\r\n      (IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS) ?\r\n      ISMINE_WATCH_ONLY : ISMINE_SPENDABLE)) {\r\n```\r\n\r\nCould that be the case? :)\r\n\r\n",
      "created_at" : "2019-09-25T11:23:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-534976077",
      "id" : 534976077,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNDk3NjA3Nw==",
      "updated_at" : "2019-09-25T11:26:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/534976077",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16944#discussion_r328116392"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/328116392"
         }
      },
      "author_association" : "MEMBER",
      "body" : "As @practicalswift notes you likely wanted parenths around this new clause",
      "commit_id" : "41c5165aa30d65d40ef3921bf4760c13f5d42b21",
      "created_at" : "2019-09-25T13:19:04Z",
      "diff_hunk" : "@@ -2590,7 +2590,7 @@ std::map<CTxDestination, std::vector<COutput>> CWallet::ListCoins(interfaces::Ch\n         if (it != mapWallet.end()) {\n             int depth = it->second.GetDepthInMainChain(locked_chain);\n             if (depth >= 0 && output.n < it->second.tx->vout.size() &&\n-                IsMine(it->second.tx->vout[output.n]) == ISMINE_SPENDABLE) {\n+                IsMine(it->second.tx->vout[output.n]) == IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS) ? ISMINE_WATCH_ONLY : ISMINE_SPENDABLE) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#discussion_r328116392",
      "id" : 328116392,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyODExNjM5Mg==",
      "original_commit_id" : "0e88841b33dcb0865690fb1316f22a16aa27d8a9",
      "original_position" : 14,
      "path" : "src/wallet/wallet.cpp",
      "position" : 14,
      "pull_request_review_id" : 293068945,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16944",
      "updated_at" : "2019-09-25T13:28:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/328116392",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16944#discussion_r328117961"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/328117961"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: annotate the optional bool args for clarity",
      "commit_id" : "41c5165aa30d65d40ef3921bf4760c13f5d42b21",
      "created_at" : "2019-09-25T13:22:05Z",
      "diff_hunk" : "@@ -383,17 +386,36 @@ void SendCoinsDialog::on_sendButton_clicked()\n         return;\n     }\n \n-    // now send the prepared transaction\n-    WalletModel::SendCoinsReturn sendStatus = model->sendCoins(currentTransaction);\n-    // process sendStatus and on error generate message shown to user\n-    processSendCoinsReturn(sendStatus);\n+    bool done = false;\n+    if (model->privateKeysDisabled()) {\n+        done = true;\n+        CMutableTransaction mtx = CMutableTransaction{*(currentTransaction.getWtx())};\n+        PartiallySignedTransaction psbtx(mtx);\n+        bool complete = false;\n+        const TransactionError err = model->wallet().fillPSBT(psbtx, complete, SIGHASH_ALL, false, true);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#discussion_r328117961",
      "id" : 328117961,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyODExNzk2MQ==",
      "original_commit_id" : "078583e2c5a174ea081333f46790cf2dfdc3c738",
      "original_position" : 42,
      "path" : "src/qt/sendcoinsdialog.cpp",
      "position" : 55,
      "pull_request_review_id" : 293068945,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16944",
      "updated_at" : "2019-09-25T13:28:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/328117961",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16944#discussion_r328121141"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/328121141"
         }
      },
      "author_association" : "MEMBER",
      "body" : "`done` isn't really helping me parse what is going on here, maybe call it `send_failure` and reverse the meaning?",
      "commit_id" : "41c5165aa30d65d40ef3921bf4760c13f5d42b21",
      "created_at" : "2019-09-25T13:27:59Z",
      "diff_hunk" : "@@ -383,17 +386,36 @@ void SendCoinsDialog::on_sendButton_clicked()\n         return;\n     }\n \n-    // now send the prepared transaction\n-    WalletModel::SendCoinsReturn sendStatus = model->sendCoins(currentTransaction);\n-    // process sendStatus and on error generate message shown to user\n-    processSendCoinsReturn(sendStatus);\n+    bool done = false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#discussion_r328121141",
      "id" : 328121141,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyODEyMTE0MQ==",
      "original_commit_id" : "078583e2c5a174ea081333f46790cf2dfdc3c738",
      "original_position" : 36,
      "path" : "src/qt/sendcoinsdialog.cpp",
      "position" : 49,
      "pull_request_review_id" : 293068945,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16944",
      "updated_at" : "2019-09-25T13:28:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/328121141",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "The final dialogue should have the \"Yes\" text replace with \"Copy unsigned tx to clipboard\" or something self-explanatory.\r\n\r\nReally \"Yes\" should be \"Send\" in the average case anyways(think I might PR that change separately)",
      "created_at" : "2019-09-25T13:36:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-535026260",
      "id" : 535026260,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNTAyNjI2MA==",
      "updated_at" : "2019-09-25T13:36:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/535026260",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/16944#discussion_r328358110"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16944"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/328358110"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should be \"clipboard\" :)",
      "commit_id" : "41c5165aa30d65d40ef3921bf4760c13f5d42b21",
      "created_at" : "2019-09-25T21:56:09Z",
      "diff_hunk" : "@@ -383,17 +392,36 @@ void SendCoinsDialog::on_sendButton_clicked()\n         return;\n     }\n \n-    // now send the prepared transaction\n-    WalletModel::SendCoinsReturn sendStatus = model->sendCoins(currentTransaction);\n-    // process sendStatus and on error generate message shown to user\n-    processSendCoinsReturn(sendStatus);\n+    bool done = false;\n+    if (model->privateKeysDisabled()) {\n+        done = true;\n+        CMutableTransaction mtx = CMutableTransaction{*(currentTransaction.getWtx())};\n+        PartiallySignedTransaction psbtx(mtx);\n+        bool complete = false;\n+        const TransactionError err = model->wallet().fillPSBT(psbtx, complete, SIGHASH_ALL, false, true);\n+        assert(!complete);\n+        assert(err == TransactionError::OK);\n+        // Serialize the PSBT\n+        CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);\n+        ssTx << psbtx;\n+        GUIUtil::setClipboard(EncodeBase64(ssTx.str()).c_str());\n+        Q_EMIT message(tr(\"PSBT copied\"), \"Copied to clipbboard\", CClientUIInterface::MSG_INFORMATION);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#discussion_r328358110",
      "id" : 328358110,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyODM1ODExMA==",
      "original_commit_id" : "41c5165aa30d65d40ef3921bf4760c13f5d42b21",
      "original_position" : 62,
      "path" : "src/qt/sendcoinsdialog.cpp",
      "position" : 62,
      "pull_request_review_id" : 293387152,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/16944",
      "updated_at" : "2019-09-25T21:56:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/328358110",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Fixed the precedence bug @practicalswift found.\r\n\r\nI added some additional copy:\r\n<img width=\"391\" alt=\"Schermafbeelding 2019-09-26 om 11 15 42\" src=\"https://user-images.githubusercontent.com/10217/65675777-04424180-e04f-11e9-9bd2-426104c2bda8.png\">\r\n\r\n<img width=\"627\" alt=\"Schermafbeelding 2019-09-26 om 11 30 25\" src=\"https://user-images.githubusercontent.com/10217/65676974-14f3b700-e051-11e9-91d4-479afd086d30.png\">\r\n\r\nWith that I don't think it's necessary to show a dialog with the PSBT text. See also #16966 for a more rigorous approach (I'm trying to keep that an easy rebase), where it will be easier to integrate @gwillen's PSBT management changes (save to disk, check progress, etc).",
      "created_at" : "2019-09-26T09:46:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-535427802",
      "id" : 535427802,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNTQyNzgwMg==",
      "updated_at" : "2019-09-26T09:46:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/535427802",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "\"e.g., and offline Bitcoin Core wallet, or a PSBT-compatible hardware wallet\"\r\n\r\nI think that change would make me happy.",
      "created_at" : "2019-09-26T14:12:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-535521894",
      "id" : 535521894,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNTUyMTg5NA==",
      "updated_at" : "2019-09-26T14:12:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/535521894",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@instagibbs done (I didn't update the screenshots)",
      "created_at" : "2019-09-26T14:27:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-535529063",
      "id" : 535529063,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNTUyOTA2Mw==",
      "updated_at" : "2019-09-26T14:27:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/535529063",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "tACK https://github.com/bitcoin/bitcoin/pull/16944/commits/da869592ecf82f8a03eb4ab2339d6bffa3dcea58\r\n\r\nRan both watch-only and non-watch-only modes, tested coin control in watch-only mode, tested a Core -> HWI -> Core round-trip and successfully finalized a PSBT with the desired properties.",
      "created_at" : "2019-09-26T15:02:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/16944#issuecomment-535546393",
      "id" : 535546393,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/16944",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDUzNTU0NjM5Mw==",
      "updated_at" : "2019-09-26T15:02:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/535546393",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/5767891?v=4",
         "events_url" : "https://api.github.com/users/instagibbs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/instagibbs/followers",
         "following_url" : "https://api.github.com/users/instagibbs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/instagibbs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/instagibbs",
         "id" : 5767891,
         "login" : "instagibbs",
         "node_id" : "MDQ6VXNlcjU3Njc4OTE=",
         "organizations_url" : "https://api.github.com/users/instagibbs/orgs",
         "received_events_url" : "https://api.github.com/users/instagibbs/received_events",
         "repos_url" : "https://api.github.com/users/instagibbs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/instagibbs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/instagibbs"
      }
   }
]
