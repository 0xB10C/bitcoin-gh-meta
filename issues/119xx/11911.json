{
   "assignee" : null,
   "assignees" : [],
   "author_association" : "CONTRIBUTOR",
   "body" : "**This is based on #11687.** The non-base commits are:\r\n\r\n- [`aca8ec0dab` Free CDBEnv instances when not in use](https://github.com/bitcoin/bitcoin/pull/11911/commits/aca8ec0dabb4987a4f73a19e2a7dc09177197adb)\r\n\r\n---\r\n\r\nInstead of adding CDBEnv objects permanently to the g_dbenvs map, use reference counted shared pointers and remove map entries when the last CDBEnv reference goes out of scope.\r\n\r\nThis change was requested by @TheBlueMatt and makes code that sets up mock databases cleaner. The mock database environment will now go out of scope and be reset on destruction so there is no need to call CDBEnv::Reset() during wallet construction to clear out prior state.\r\n\r\nThis change does affect bitcoin behavior slightly. On startup, instead of same wallet environments staying open throughout VerifyWallets() and OpenWallets() calls, VerifyWallets() will open and close an environment once for each wallet, and OpenWallets() will create its own environment(s) later.\r\n",
   "closed_at" : null,
   "closed_by" : null,
   "comments" : 0,
   "comments_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11911/comments",
   "created_at" : "2017-12-15T19:18:49Z",
   "events_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11911/events",
   "html_url" : "https://github.com/bitcoin/bitcoin/pull/11911",
   "id" : 282522038,
   "labels" : [],
   "labels_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11911/labels{/name}",
   "locked" : false,
   "milestone" : null,
   "number" : 11911,
   "pull_request" : {
      "diff_url" : "https://github.com/bitcoin/bitcoin/pull/11911.diff",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11911",
      "patch_url" : "https://github.com/bitcoin/bitcoin/pull/11911.patch",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/11911"
   },
   "repository_url" : "https://api.github.com/repos/bitcoin/bitcoin",
   "state" : "open",
   "title" : "Free CDBEnv instances when not in use",
   "updated_at" : "2017-12-15T19:36:39Z",
   "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11911",
   "user" : {
      "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
      "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
      "followers_url" : "https://api.github.com/users/ryanofsky/followers",
      "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "gravatar_id" : "",
      "html_url" : "https://github.com/ryanofsky",
      "id" : 7133040,
      "login" : "ryanofsky",
      "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
      "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
      "repos_url" : "https://api.github.com/users/ryanofsky/repos",
      "site_admin" : false,
      "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
      "type" : "User",
      "url" : "https://api.github.com/users/ryanofsky"
   }
}
