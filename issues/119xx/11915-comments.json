[
   {
      "author_association" : "OWNER",
      "body" : "I don't think this is correct. The command line option should override the GUI setting with respect to the value used, but it should not set/change the GUI setting. Command line arguments shouldn't stick, which I think is what this does?\r\n\r\n(reason is, for example: to be able to run with `-dbcache=10000` temporarily, then quit, then run without `-dbcache` and go back to the normal setting)",
      "created_at" : "2017-12-16T07:58:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11915#issuecomment-352168178",
      "id" : 352168178,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11915",
      "updated_at" : "2017-12-16T07:58:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/352168178",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@laanwj Sorry I'm not sure I understand. When I run the GUI with this code, if I run with `-dbcache=10000` it will display 10000 in the options menu. If I then quit and run without the flag, I see the either number in `bitcoin.conf` or the default in the options menu. \r\n\r\nAre you saying when you run without the flag a second time it still displays the last flag value used? ",
      "created_at" : "2017-12-17T23:15:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11915#issuecomment-352293875",
      "id" : 352293875,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11915",
      "updated_at" : "2017-12-17T23:16:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/352293875",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/10647624?v=4",
         "events_url" : "https://api.github.com/users/valentinewallace/events{/privacy}",
         "followers_url" : "https://api.github.com/users/valentinewallace/followers",
         "following_url" : "https://api.github.com/users/valentinewallace/following{/other_user}",
         "gists_url" : "https://api.github.com/users/valentinewallace/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/valentinewallace",
         "id" : 10647624,
         "login" : "valentinewallace",
         "organizations_url" : "https://api.github.com/users/valentinewallace/orgs",
         "received_events_url" : "https://api.github.com/users/valentinewallace/received_events",
         "repos_url" : "https://api.github.com/users/valentinewallace/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/valentinewallace/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/valentinewallace/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/valentinewallace"
      }
   },
   {
      "author_association" : "OWNER",
      "body" : "Yes. This:\r\n```\r\nsettings.setValue(\"nDatabaseCache\", (qint64)gArgs.GetArg(\"-dbcache\", nDefaultDbCache));\r\n```\r\nWrites the value from the command line / bitcoin.conf to the QSettings object persistently. That's not how it's supposed to work.",
      "created_at" : "2017-12-19T13:17:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11915#issuecomment-352745883",
      "id" : 352745883,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11915",
      "updated_at" : "2017-12-19T13:17:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/352745883",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "To fix #11788, I would propose to show the \"underlaying\" dbcache value (set via bitcoin.conf or `-dbcache=<value>`) in the GUI settings pannel...\r\n\r\nbut only, if the value has not been overwritten by the QT settings (` (!settings.contains(\"nDatabaseCache\")`).\r\n\r\nAlso, only write the GUI set database cache to QSettings when...\r\n* Either `nDatabaseCache` is set\r\n* Or the new value is not equal to the underlaying `-dbcache` value.",
      "created_at" : "2017-12-19T18:52:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11915#issuecomment-352851616",
      "id" : 352851616,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11915",
      "updated_at" : "2017-12-19T18:52:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/352851616",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "@jonasschnelli \r\n\r\n> but only, if the value has not been overwritten by the QT settings ((!settings.contains(\"nDatabaseCache\")).\r\n\r\nCurrently, due to `init` in optionsmodel, QSettings will always contain `nDatabaseCache`, it'll just contain the default if the user doesn't give it a different value through the GUI. However, this could be altered so it doesn't get set in `settings` unless the user sets it. \r\n\r\nIntuitively, my takeaway from your comment is that the GUI settings panel should display: \r\n- QSettings value if set by the user\r\n- else flag value if set \r\n- else bitcoin.conf if set \r\n- else default value\r\n\r\nMy one reservation is that it makes more sense to me for the GUI to display the *currently effective* settings no matter what (a la the second comment in [this thread](https://github.com/bitcoin/bitcoin/issues/1903)). If we're going with showing the effective settings, I changed my code and I'll update the PR, otherwise will keep chugging along :) ",
      "created_at" : "2017-12-21T01:14:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11915#issuecomment-353229346",
      "id" : 353229346,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11915",
      "updated_at" : "2017-12-21T02:54:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/353229346",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/10647624?v=4",
         "events_url" : "https://api.github.com/users/valentinewallace/events{/privacy}",
         "followers_url" : "https://api.github.com/users/valentinewallace/followers",
         "following_url" : "https://api.github.com/users/valentinewallace/following{/other_user}",
         "gists_url" : "https://api.github.com/users/valentinewallace/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/valentinewallace",
         "id" : 10647624,
         "login" : "valentinewallace",
         "organizations_url" : "https://api.github.com/users/valentinewallace/orgs",
         "received_events_url" : "https://api.github.com/users/valentinewallace/received_events",
         "repos_url" : "https://api.github.com/users/valentinewallace/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/valentinewallace/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/valentinewallace/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/valentinewallace"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Oh. Your right...\r\nCurrent code:\r\n```\r\nif (!settings.contains(\"nDatabaseCache\"))\r\n        settings.setValue(\"nDatabaseCache\", (qint64)nDefaultDbCache);\r\n```\r\nThis seems suboptimal. After executing this, you have no way to find out if the user has set a value or if we just have copied over the default from `nDefaultDbCache`.\r\n\r\nI think it should only write a value to `nDatabaseCache` if it was set by the user and if it was different as the default.\r\nAlso, if `nDatabaseCache` is set, there could be a different color indicating that the value has been \"overwritten\".\r\n\r\nBut I agree, it should always show the current active database cache size.",
      "created_at" : "2017-12-22T07:14:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11915#issuecomment-353537282",
      "id" : 353537282,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11915",
      "updated_at" : "2017-12-22T07:14:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/353537282",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/178464?v=4",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "That line you mentioned^ was there before I touched the file so I put it back in the spirit of making as few changes as possible to solve the problem (maybe I should've done the commits differently?), but I agree it does seem suboptimal. \r\n\r\n> I think it should only write a value to `nDatabaseCache` if it was set by the user and if it was different as the default.\r\n\r\nMight it make sense to write a value even if the user sets it to the default value? Otherwise the bitcoin.conf value will override it even if the value the user wants in QSettings happens to be the default. \r\n\r\nRe: only writing a value to `nDatabaseCache` if user-set-- one tradeoff is that it makes the code for `init`ing the DatabaseCache value in QSettings different from how all the other QSettings values are initialized which is currently very uniform, adding a bit of complexity.   \r\n\r\nHowever, I'll look into making that change and the color-coding tmrw :) ",
      "created_at" : "2017-12-22T22:39:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11915#issuecomment-353685596",
      "id" : 353685596,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11915",
      "updated_at" : "2017-12-22T22:39:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/353685596",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/10647624?v=4",
         "events_url" : "https://api.github.com/users/valentinewallace/events{/privacy}",
         "followers_url" : "https://api.github.com/users/valentinewallace/followers",
         "following_url" : "https://api.github.com/users/valentinewallace/following{/other_user}",
         "gists_url" : "https://api.github.com/users/valentinewallace/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/valentinewallace",
         "id" : 10647624,
         "login" : "valentinewallace",
         "organizations_url" : "https://api.github.com/users/valentinewallace/orgs",
         "received_events_url" : "https://api.github.com/users/valentinewallace/received_events",
         "repos_url" : "https://api.github.com/users/valentinewallace/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/valentinewallace/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/valentinewallace/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/valentinewallace"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Okay, now we only write to QSettings if the user sets a non-default value! ",
      "created_at" : "2018-01-01T04:27:35Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/11915#issuecomment-354636144",
      "id" : 354636144,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11915",
      "updated_at" : "2018-01-01T04:27:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/354636144",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/10647624?v=4",
         "events_url" : "https://api.github.com/users/valentinewallace/events{/privacy}",
         "followers_url" : "https://api.github.com/users/valentinewallace/followers",
         "following_url" : "https://api.github.com/users/valentinewallace/following{/other_user}",
         "gists_url" : "https://api.github.com/users/valentinewallace/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/valentinewallace",
         "id" : 10647624,
         "login" : "valentinewallace",
         "organizations_url" : "https://api.github.com/users/valentinewallace/orgs",
         "received_events_url" : "https://api.github.com/users/valentinewallace/received_events",
         "repos_url" : "https://api.github.com/users/valentinewallace/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/valentinewallace/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/valentinewallace/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/valentinewallace"
      }
   }
]
