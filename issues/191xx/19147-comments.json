[
   {
      "author_association" : "MEMBER",
      "body" : "This is a quite exotic case. As you mention, there are much worse thing that can be done if an attacker (even temporarily) can MitM a connection.\r\n\r\nI think it may be a good idea to document this property of BanMan, but I'd prefer to be more brief.\r\nSomething like this:\r\n\r\n``\r\nBanMan can be exploited by an on-path attacker: not necessarily user's hosting ISP, but any \"critical\" ISP on the way.\r\nAn attacker would have to spoof packets to trigger honest sane nodes banning each other.\r\nThis may be used to influence the network topology.\r\n``",
      "created_at" : "2020-06-03T04:28:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-637944916",
      "id" : 637944916,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19147",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzNzk0NDkxNg==",
      "updated_at" : "2020-06-03T04:29:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/637944916",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436053295"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436053295"
         }
      },
      "author_association" : "MEMBER",
      "body" : "\"unlawful\"?",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-05T17:12:17Z",
      "diff_hunk" : "@@ -37,6 +37,23 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// With regards to impersonation attack, i.e a malicious\n+// actor sending us directly invalid data while IP-spoofing\n+// an address of honest reacheable peers, thus triggering an\n+// unlawful ban of those:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436053295",
      "id" : 436053295,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjA1MzI5NQ==",
      "original_commit_id" : "743cb6e00a1be6e45f3ea7bc58a50640f40528db",
      "original_line" : 44,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425478537,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436053295",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436053503"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436053503"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Couldn't such attackers just block the connection ?",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-05T17:12:41Z",
      "diff_hunk" : "@@ -37,6 +37,23 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// With regards to impersonation attack, i.e a malicious\n+// actor sending us directly invalid data while IP-spoofing\n+// an address of honest reacheable peers, thus triggering an\n+// unlawful ban of those:\n+// * if attacker is a simple IP host, it won't work as our\n+// default connections rely on TCP and being out-the-path\n+// it will miss the SYN-ACK handshake reply.\n+// * if attacker is an on-the-path infrastructure one (ISPs,\n+// Tier2 or Tier1, ...), assuming IP packets forgeability\n+// capabilities, a malicious packet can be injected, i.e\n+// a mutated block received by node 1 from node 2 therefore\n+// provoking ban of node 2 for 24h. Such threat model scenario",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436053503",
      "id" : 436053503,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjA1MzUwMw==",
      "original_commit_id" : "743cb6e00a1be6e45f3ea7bc58a50640f40528db",
      "original_line" : 52,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425478537,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436053503",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436174733"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436174733"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sure, an on-path attacker can drop the connection, but if honest peers have another connection path without him on it, that's still work. I would say banning is more harmful than a connection drop, and so more interesting ?",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-05T21:35:54Z",
      "diff_hunk" : "@@ -37,6 +37,23 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// With regards to impersonation attack, i.e a malicious\n+// actor sending us directly invalid data while IP-spoofing\n+// an address of honest reacheable peers, thus triggering an\n+// unlawful ban of those:\n+// * if attacker is a simple IP host, it won't work as our\n+// default connections rely on TCP and being out-the-path\n+// it will miss the SYN-ACK handshake reply.\n+// * if attacker is an on-the-path infrastructure one (ISPs,\n+// Tier2 or Tier1, ...), assuming IP packets forgeability\n+// capabilities, a malicious packet can be injected, i.e\n+// a mutated block received by node 1 from node 2 therefore\n+// provoking ban of node 2 for 24h. Such threat model scenario",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436174733",
      "id" : 436174733,
      "in_reply_to_id" : 436053503,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE3NDczMw==",
      "original_commit_id" : "743cb6e00a1be6e45f3ea7bc58a50640f40528db",
      "original_line" : 52,
      "original_position" : 16,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425638814,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436174733",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436175777"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436175777"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes I need a better wording here, with regards to banning a misbehavior is qualified but in reality both peers are honest ?",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-05T21:38:52Z",
      "diff_hunk" : "@@ -37,6 +37,23 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// With regards to impersonation attack, i.e a malicious\n+// actor sending us directly invalid data while IP-spoofing\n+// an address of honest reacheable peers, thus triggering an\n+// unlawful ban of those:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436175777",
      "id" : 436175777,
      "in_reply_to_id" : 436053295,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjE3NTc3Nw==",
      "original_commit_id" : "743cb6e00a1be6e45f3ea7bc58a50640f40528db",
      "original_line" : 44,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425640107,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436175777",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks @naumenkogs, updated with your wording with still a reference to Erebus to provide context and threat model comparison.",
      "created_at" : "2020-06-05T21:46:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-639839651",
      "id" : 639839651,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19147",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzOTgzOTY1MQ==",
      "updated_at" : "2020-06-05T21:46:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/639839651",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@mzumsande you may be interested based on review club IRC discussion IIRC",
      "created_at" : "2020-06-05T21:47:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-639840005",
      "id" : 639840005,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19147",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDYzOTg0MDAwNQ==",
      "updated_at" : "2020-06-05T21:47:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/639840005",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Almost ACK the text now. I see some English grammar issues (\"pursue with\", and this sentence is just too long). \r\n\r\nAlso, I don't understand the part about less efficient attack Also not sure about \"peers can be hijacked\".\r\nI'd drop that part because:\r\n1. What do you mean efficient? We don't really now what an actual full attack based on this thing may be, so it's hard to compare.\r\n2. I feel like even in a year, maybe 10% of the readers of this text would understand what Erebus is",
      "created_at" : "2020-06-06T13:40:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-640062897",
      "id" : 640062897,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19147",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MDA2Mjg5Nw==",
      "updated_at" : "2020-06-06T13:40:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/640062897",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436270642"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436270642"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you want s/on the way/in the path/ here.",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-06T13:51:38Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not\n+// necessarily user's hosting ISP, but any \"critical\" ISP\n+// on the way. An attacker may spoof packets with invalid data",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436270642",
      "id" : 436270642,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI3MDY0Mg==",
      "original_commit_id" : "a0f23ae6ed5ecefb5489f39893dcdf2e43a1bb0c",
      "original_line" : 43,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425741873,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436270642",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436270785"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436270785"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It looks like you're translating from French *sain* directly to \"sane\" but describing the sanity of nodes seems a bit odd. Maybe \"normal\" or \"healthy\", or just omit \"sane\".",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-06T13:53:52Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not\n+// necessarily user's hosting ISP, but any \"critical\" ISP\n+// on the way. An attacker may spoof packets with invalid data\n+// to trigger honest sane nodes banning each other. This may",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436270785",
      "id" : 436270785,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI3MDc4NQ==",
      "original_commit_id" : "a0f23ae6ed5ecefb5489f39893dcdf2e43a1bb0c",
      "original_line" : 44,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425741873,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436270785",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436270809"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436270809"
         }
      },
      "author_association" : "MEMBER",
      "body" : "in a way that is favorable",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-06T13:54:23Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not\n+// necessarily user's hosting ISP, but any \"critical\" ISP\n+// on the way. An attacker may spoof packets with invalid data\n+// to trigger honest sane nodes banning each other. This may\n+// be used to influence the network topology in a way favorable",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436270809",
      "id" : 436270809,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI3MDgwOQ==",
      "original_commit_id" : "a0f23ae6ed5ecefb5489f39893dcdf2e43a1bb0c",
      "original_line" : 45,
      "original_position" : 9,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425741873,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436270809",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436270957"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436270957"
         }
      },
      "author_association" : "MEMBER",
      "body" : "s/on-path/in-the-path/ ?\r\n\r\ns/:/;/\r\n\r\nsuggest: s/can/can potentially/ or \"may\"",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-06T13:55:55Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436270957",
      "id" : 436270957,
      "line" : 41,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI3MDk1Nw==",
      "original_commit_id" : "a0f23ae6ed5ecefb5489f39893dcdf2e43a1bb0c",
      "original_line" : 41,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : 5,
      "pull_request_review_id" : 425741873,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436270957",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436271009"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436271009"
         }
      },
      "author_association" : "MEMBER",
      "body" : "s/user's/the user's/",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-06T13:56:28Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not\n+// necessarily user's hosting ISP, but any \"critical\" ISP",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436271009",
      "id" : 436271009,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI3MTAwOQ==",
      "original_commit_id" : "a0f23ae6ed5ecefb5489f39893dcdf2e43a1bb0c",
      "original_line" : 42,
      "original_position" : 6,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425741873,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436271009",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436271209"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436271209"
         }
      },
      "author_association" : "MEMBER",
      "body" : "If with \"to pursue with\" you had *poursuivre* in mind, then perhaps s/to pursue with/carrying out/\r\n\r\ns/to trigger honest sane nodes banning/triggering honest nodes to ban/",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-06T13:58:54Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not\n+// necessarily user's hosting ISP, but any \"critical\" ISP\n+// on the way. An attacker may spoof packets with invalid data\n+// to trigger honest sane nodes banning each other. This may\n+// be used to influence the network topology in a way favorable\n+// to the attacker to pursue with single-node eclipsing or",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436271209",
      "id" : 436271209,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI3MTIwOQ==",
      "original_commit_id" : "a0f23ae6ed5ecefb5489f39893dcdf2e43a1bb0c",
      "original_line" : 46,
      "original_position" : 10,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425741873,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436271209",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436271436"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436271436"
         }
      },
      "author_association" : "MEMBER",
      "body" : "suggest: \"An impersonation attack like this would be less...\"",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-06T14:02:20Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not\n+// necessarily user's hosting ISP, but any \"critical\" ISP\n+// on the way. An attacker may spoof packets with invalid data\n+// to trigger honest sane nodes banning each other. This may\n+// be used to influence the network topology in a way favorable\n+// to the attacker to pursue with single-node eclipsing or\n+// network partitions. Such \"impersonation\" attack is less",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436271436",
      "id" : 436271436,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI3MTQzNg==",
      "original_commit_id" : "a0f23ae6ed5ecefb5489f39893dcdf2e43a1bb0c",
      "original_line" : 47,
      "original_position" : 11,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425741873,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436271436",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436297646"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436297646"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nope, this was my suggestion (see above).\r\nI use honest + sane to highlight that nodes may be honest but just broken, like due to hardware issues or whatnot. Healthy may be a better alternative",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-06T20:17:09Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not\n+// necessarily user's hosting ISP, but any \"critical\" ISP\n+// on the way. An attacker may spoof packets with invalid data\n+// to trigger honest sane nodes banning each other. This may",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436297646",
      "id" : 436297646,
      "in_reply_to_id" : 436270785,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjI5NzY0Ng==",
      "original_commit_id" : "a0f23ae6ed5ecefb5489f39893dcdf2e43a1bb0c",
      "original_line" : 44,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425766102,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436297646",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436328707"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436328707"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Ok. \"honest but just broken\" is good but an additional meaning that doesn't make sense in this case, IIUC? Perhaps \"honest, otherwise-healthy nodes mistakenly banning each other.\" Though honest on its own could be enough, too.",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-07T06:05:36Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not\n+// necessarily user's hosting ISP, but any \"critical\" ISP\n+// on the way. An attacker may spoof packets with invalid data\n+// to trigger honest sane nodes banning each other. This may",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436328707",
      "id" : 436328707,
      "in_reply_to_id" : 436270785,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjMyODcwNw==",
      "original_commit_id" : "a0f23ae6ed5ecefb5489f39893dcdf2e43a1bb0c",
      "original_line" : 44,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425789910,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436328707",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436331369"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436331369"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Now I agree, just \"honest\" is probably fine.",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-07T06:44:57Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not\n+// necessarily user's hosting ISP, but any \"critical\" ISP\n+// on the way. An attacker may spoof packets with invalid data\n+// to trigger honest sane nodes banning each other. This may",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436331369",
      "id" : 436331369,
      "in_reply_to_id" : 436270785,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNjMzMTM2OQ==",
      "original_commit_id" : "a0f23ae6ed5ecefb5489f39893dcdf2e43a1bb0c",
      "original_line" : 44,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 425792030,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/436331369",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7975071?v=4",
         "events_url" : "https://api.github.com/users/naumenkogs/events{/privacy}",
         "followers_url" : "https://api.github.com/users/naumenkogs/followers",
         "following_url" : "https://api.github.com/users/naumenkogs/following{/other_user}",
         "gists_url" : "https://api.github.com/users/naumenkogs/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/naumenkogs",
         "id" : 7975071,
         "login" : "naumenkogs",
         "node_id" : "MDQ6VXNlcjc5NzUwNzE=",
         "organizations_url" : "https://api.github.com/users/naumenkogs/orgs",
         "received_events_url" : "https://api.github.com/users/naumenkogs/received_events",
         "repos_url" : "https://api.github.com/users/naumenkogs/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/naumenkogs/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/naumenkogs"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r437169824"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/437169824"
         }
      },
      "author_association" : "MEMBER",
      "body" : "On-path attacker has some reference in network security literature so will keep it.",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-09T06:38:41Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r437169824",
      "id" : 437169824,
      "in_reply_to_id" : 436270957,
      "line" : 41,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzE2OTgyNA==",
      "original_commit_id" : "a0f23ae6ed5ecefb5489f39893dcdf2e43a1bb0c",
      "original_line" : 41,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : 5,
      "pull_request_review_id" : 426828305,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/437169824",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r437169974"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/437169974"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Updated to \"between peers\"",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-09T06:39:05Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not\n+// necessarily user's hosting ISP, but any \"critical\" ISP\n+// on the way. An attacker may spoof packets with invalid data",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r437169974",
      "id" : 437169974,
      "in_reply_to_id" : 436270642,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzE2OTk3NA==",
      "original_commit_id" : "a0f23ae6ed5ecefb5489f39893dcdf2e43a1bb0c",
      "original_line" : 43,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 426828518,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T06:53:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/437169974",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@naumenkogs \r\n\r\n>  What do you mean efficient? We don't really now what an actual full attack based on this thing may be, so it's hard to compare.\r\n \r\nRight, what I intended by documenting is raising awareness about this potential vector of exploitation. It's hard to compare with the state of your knowledge, so I modified to say that any mitigation deployed for same threat model (e.g Erebus) is likely to benefit here too.\r\n\r\n> I feel like even in a year, maybe 10% of the readers of this text would understand what Erebus is\r\n\r\nI think that worst-case scenario of mentioning Erebus is someone googling or asking to learn about it :)",
      "created_at" : "2020-06-09T06:54:38Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-641072805",
      "id" : 641072805,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/19147",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDY0MTA3MjgwNQ==",
      "updated_at" : "2020-06-09T06:54:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/641072805",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r437198410"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/437198410"
         }
      },
      "author_association" : "MEMBER",
      "body" : "undesirable?",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-09T07:38:06Z",
      "diff_hunk" : "@@ -37,6 +37,23 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// With regards to impersonation attack, i.e a malicious\n+// actor sending us directly invalid data while IP-spoofing\n+// an address of honest reacheable peers, thus triggering an\n+// unlawful ban of those:",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r437198410",
      "id" : 437198410,
      "in_reply_to_id" : 436053295,
      "line" : null,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzE5ODQxMA==",
      "original_commit_id" : "743cb6e00a1be6e45f3ea7bc58a50640f40528db",
      "original_line" : 44,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : null,
      "pull_request_review_id" : 426865561,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T07:38:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/437198410",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r437214847"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/437214847"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think this is formulated confusingly: these are attacks on address management in general, and to an extent to banning logic specifically. But it isn't an attack on BanMan, which is just a storage object for keeping track lf bans that were decided elsewhere.",
      "commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "created_at" : "2020-06-09T08:06:18Z",
      "diff_hunk" : "@@ -37,6 +37,16 @@ class CSubNet;\n // dangerous, because it can cause a network split\n // between nodes running old code and nodes running\n // new code.\n+//\n+// BanMan can be exploited by an on-path attacker: not",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/19147#discussion_r437214847",
      "id" : 437214847,
      "line" : 41,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNzIxNDg0Nw==",
      "original_commit_id" : "4f512fcfc3c0cfccb54744398f4268386561b771",
      "original_line" : 41,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/banman.h",
      "position" : 5,
      "pull_request_review_id" : 426886553,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/19147",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2020-06-09T08:06:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/437214847",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   }
]
