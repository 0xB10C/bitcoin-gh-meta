[
   {
      "body" : "Concept ACK",
      "created_at" : "2016-06-28T09:37:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8278#issuecomment-229000780",
      "id" : 229000780,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8278",
      "updated_at" : "2016-06-28T09:37:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/229000780",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Concept ACK",
      "created_at" : "2016-06-28T09:39:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8278#issuecomment-229001113",
      "id" : 229001113,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8278",
      "updated_at" : "2016-06-28T09:39:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/229001113",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=3",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8278#discussion_r68740822"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8278"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/68740822"
         }
      },
      "body" : "Nice use of the build system",
      "commit_id" : "136908e94b1782c2cbe12899c61f91122e02fca9",
      "created_at" : "2016-06-28T11:38:46Z",
      "diff_hunk" : "@@ -514,6 +514,9 @@ AC_SEARCH_LIBS([inet_pton], [nsl resolv], [AC_DEFINE(HAVE_INET_PTON, 1, [Define\n \n AC_CHECK_DECLS([strnlen])\n \n+# Check for daemon(3), unrelated to --with-daemon (although used by it)\n+AC_CHECK_DECLS([daemon])",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8278#discussion_r68740822",
      "id" : 68740822,
      "original_commit_id" : "136908e94b1782c2cbe12899c61f91122e02fca9",
      "original_position" : 5,
      "path" : "configure.ac",
      "position" : 5,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8278",
      "updated_at" : "2016-06-28T11:38:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/68740822",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8278#discussion_r68741029"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8278"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/68741029"
         }
      },
      "body" : "This may be a change of behavior: we should check whether there are arguments that take relative paths (e.g. `-datadir`, `-conf`, but also the `-*notify` options) that are affected by this.",
      "commit_id" : "136908e94b1782c2cbe12899c61f91122e02fca9",
      "created_at" : "2016-06-28T11:41:05Z",
      "diff_hunk" : "@@ -150,9 +159,20 @@ bool AppInit(int argc, char* argv[])\n \n             pid_t sid = setsid();\n             if (sid < 0)\n-                fprintf(stderr, \"Error: setsid() returned %d errno %d\\n\", sid, errno);\n+                fprintf(stderr, \"Error: setsid() failed: %s\\n\", strerror(errno));\n+\n+            (void)chdir(\"/\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8278#discussion_r68741029",
      "id" : 68741029,
      "original_commit_id" : "136908e94b1782c2cbe12899c61f91122e02fca9",
      "original_position" : 35,
      "path" : "src/bitcoind.cpp",
      "position" : 35,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8278",
      "updated_at" : "2016-06-28T11:41:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/68741029",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8278#discussion_r68816747"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8278"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/68816747"
         }
      },
      "body" : "Having looked up alternative ways of dealing with absolute/relative paths, I've come up with these options:\r\n\r\n* Remove chdir and tell daemon() not to either\r\n\r\n* Remember PWD before changing and prepend it to all relative paths (alternatively open a fd to PWD before changing and cd back or openat when necessary, but that won't work with exec and is probably a terrible idea even if it did)\r\n\r\n* Abort if -daemon and any paths in the listed options are relative but include a -nochdir option to disable the chdir\r\n\r\n* Don't chdir by default and require a -chdir or similar option to do so; should probably still abort if relative paths are provided\r\n\r\nThere are advantages to performing the chdir to / when daemonising especially if/when bitcoind becomes suitable to use as a system service so if it can be done with minimal fuss I think it should be.",
      "commit_id" : "136908e94b1782c2cbe12899c61f91122e02fca9",
      "created_at" : "2016-06-28T18:39:04Z",
      "diff_hunk" : "@@ -150,9 +159,20 @@ bool AppInit(int argc, char* argv[])\n \n             pid_t sid = setsid();\n             if (sid < 0)\n-                fprintf(stderr, \"Error: setsid() returned %d errno %d\\n\", sid, errno);\n+                fprintf(stderr, \"Error: setsid() failed: %s\\n\", strerror(errno));\n+\n+            (void)chdir(\"/\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8278#discussion_r68816747",
      "id" : 68816747,
      "original_commit_id" : "136908e94b1782c2cbe12899c61f91122e02fca9",
      "original_position" : 35,
      "path" : "src/bitcoind.cpp",
      "position" : 35,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8278",
      "updated_at" : "2016-06-28T18:42:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/68816747",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/139629?v=3",
         "events_url" : "https://api.github.com/users/ChoHag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ChoHag/followers",
         "following_url" : "https://api.github.com/users/ChoHag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ChoHag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ChoHag",
         "id" : 139629,
         "login" : "ChoHag",
         "organizations_url" : "https://api.github.com/users/ChoHag/orgs",
         "received_events_url" : "https://api.github.com/users/ChoHag/received_events",
         "repos_url" : "https://api.github.com/users/ChoHag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ChoHag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ChoHag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ChoHag"
      }
   },
   {
      "body" : "Concept ACK",
      "created_at" : "2016-06-28T20:18:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8278#issuecomment-229169814",
      "id" : 229169814,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8278",
      "updated_at" : "2016-06-28T20:18:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/229169814",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/8278#discussion_r68895080"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8278"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/68895080"
         }
      },
      "body" : "I think the first option for this PR makes sense. That keeps this a refactor, not a change of behavior (which would break compatibility for users). In some later change the chdir could be re-added after implementing one of the other options.",
      "commit_id" : "136908e94b1782c2cbe12899c61f91122e02fca9",
      "created_at" : "2016-06-29T07:06:17Z",
      "diff_hunk" : "@@ -150,9 +159,20 @@ bool AppInit(int argc, char* argv[])\n \n             pid_t sid = setsid();\n             if (sid < 0)\n-                fprintf(stderr, \"Error: setsid() returned %d errno %d\\n\", sid, errno);\n+                fprintf(stderr, \"Error: setsid() failed: %s\\n\", strerror(errno));\n+\n+            (void)chdir(\"/\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8278#discussion_r68895080",
      "id" : 68895080,
      "original_commit_id" : "136908e94b1782c2cbe12899c61f91122e02fca9",
      "original_position" : 35,
      "path" : "src/bitcoind.cpp",
      "position" : 35,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/8278",
      "updated_at" : "2016-06-29T07:06:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/68895080",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "I'm not overly concerned with making the feature freeze but I realised it's a bad code smell to have two mutually exclusive command line arguments, so have simply removed the chdir for the time being.",
      "created_at" : "2016-06-30T10:49:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8278#issuecomment-229625332",
      "id" : 229625332,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8278",
      "updated_at" : "2016-06-30T10:49:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/229625332",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/139629?v=3",
         "events_url" : "https://api.github.com/users/ChoHag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ChoHag/followers",
         "following_url" : "https://api.github.com/users/ChoHag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ChoHag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ChoHag",
         "id" : 139629,
         "login" : "ChoHag",
         "organizations_url" : "https://api.github.com/users/ChoHag/orgs",
         "received_events_url" : "https://api.github.com/users/ChoHag/received_events",
         "repos_url" : "https://api.github.com/users/ChoHag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ChoHag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ChoHag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ChoHag"
      }
   },
   {
      "body" : "Thanks. Will test.",
      "created_at" : "2016-07-01T07:58:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/8278#issuecomment-229881799",
      "id" : 229881799,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/8278",
      "updated_at" : "2016-07-01T07:58:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/229881799",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
