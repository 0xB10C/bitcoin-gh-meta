[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15921](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15921.html) (Tidy up ValidationState interface by jnewbery)\n* [#15606](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15606.html) ([experimental] UTXO snapshots by jamesob)\n* [#15112](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15112.html) (build: Optionally enable -Wzero-as-null-pointer-constant by Empact)\n* [#14920](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14920.html) (Build: enable -Wdocumentation via isystem by Empact)\n* [#9381](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/9381.html) (Remove CWalletTx merging logic from AddToWallet by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2019-04-01T02:38:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-478415987",
      "id" : 478415987,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3ODQxNTk4Nw==",
      "updated_at" : "2019-05-08T05:25:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/478415987",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-04-01T20:13:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-478729279",
      "id" : 478729279,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3ODcyOTI3OQ==",
      "updated_at" : "2019-04-01T20:13:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/478729279",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271524444"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271524444"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks for consolidating the code from `relayTransaction` and `submitToMemoryPool` in `interfaces/chain.cpp` and from `BroadcastTransaction` in `node/transaction.cpp`.\r\n\r\nI do think the right place for all this code to live is in `node/transaction.cpp`, though. `interfaces/chain.cpp` is really just meant to be a simple glue file with lines like:\r\n\r\n```c++\r\nbool broadcastTransaction(...) override { return BroadcastTransaction(...); }\r\n```\r\n\r\nAlso, I didn't look closely yet, but it seems like this refactoring might be changing wallet behavior (this could explain travis test failures). It would probably be better if this PR avoided changing behavior to the extent possible. This might require adding some extra options to the existing `BroadcastTransaction` function in `node/transaction.cpp`, or adding a second broadcast function there that can hopefully share some code with the current one.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-02T22:47:36Z",
      "diff_hunk" : "@@ -306,10 +301,58 @@ class ChainImpl : public Chain\n         auto it = ::mempool.GetIter(txid);\n         return it && (*it)->GetCountWithDescendants() > 1;\n     }\n-    void relayTransaction(const uint256& txid) override\n+    bool broadcastTransaction(const CTransactionRef& tx, const uint256& txid, CValidationState& state, const CAmount& absurdfee, bool relay) override",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271524444",
      "id" : 271524444,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MTUyNDQ0NA==",
      "original_commit_id" : "abae70356f288277618b2848a7bb659aff7d6200",
      "original_position" : 40,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 221937992,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271524444",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271564894"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271564894"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Okay was thinking than ```node/transaction.cpp``` was temporary and long term goal was to aggregate it to ```interfaces/node.cpp```.\r\nDidn't want to change wallet behavior, fixed it by adding options in the existing BroadcastTransaction (but still not sure of ReacceptWalletTransactions, should we broadcast txn there ?), functional tests should be good now. Also rebased",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-03T03:04:24Z",
      "diff_hunk" : "@@ -306,10 +301,58 @@ class ChainImpl : public Chain\n         auto it = ::mempool.GetIter(txid);\n         return it && (*it)->GetCountWithDescendants() > 1;\n     }\n-    void relayTransaction(const uint256& txid) override\n+    bool broadcastTransaction(const CTransactionRef& tx, const uint256& txid, CValidationState& state, const CAmount& absurdfee, bool relay) override",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271564894",
      "id" : 271564894,
      "in_reply_to_id" : 271524444,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MTU2NDg5NA==",
      "original_commit_id" : "abae70356f288277618b2848a7bb659aff7d6200",
      "original_position" : 40,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 221987898,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271564894",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271569776"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271569776"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271524444\r\n\r\nThanks! This looks good and now net removes code (+63/-83).\r\n\r\n> Okay was thinking than node/transaction.cpp was temporary\r\n\r\nYeah, that may have been the original thought. But I think it could be a reasonable long term location if more things are moved around it. In any case it's where the BroadcastTransaction function currently lives, so it's easier not to move in this PR, which is more about simplifying wallet code.\r\n\r\n> and long term goal was to aggregate it to interfaces/node.cpp\r\n\r\nEverything in interfaces/, including interfaces/node.cpp is just supposed to be very short glue code (the files would be huge otherwise). The interfaces are a way of letting wallet, node, and gui code run in different processes, and a way of preventing them from accessing each others internal state.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-03T03:43:00Z",
      "diff_hunk" : "@@ -306,10 +301,58 @@ class ChainImpl : public Chain\n         auto it = ::mempool.GetIter(txid);\n         return it && (*it)->GetCountWithDescendants() > 1;\n     }\n-    void relayTransaction(const uint256& txid) override\n+    bool broadcastTransaction(const CTransactionRef& tx, const uint256& txid, CValidationState& state, const CAmount& absurdfee, bool relay) override",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271569776",
      "id" : 271569776,
      "in_reply_to_id" : 271524444,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MTU2OTc3Ng==",
      "original_commit_id" : "abae70356f288277618b2848a7bb659aff7d6200",
      "original_position" : 40,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 221993941,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271569776",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271570034"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271570034"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Can drop this whole comment since assumeLocked call is removed.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-03T03:44:48Z",
      "diff_hunk" : "@@ -210,8 +205,7 @@ class NotificationsHandlerImpl : public Handler, CValidationInterface\n         // should be able to be removed entirely if `ResendWalletTransactions`\n         // is replaced by a wallet timer as suggested in\n         // https://github.com/bitcoin/bitcoin/issues/15619",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271570034",
      "id" : 271570034,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MTU3MDAzNA==",
      "original_commit_id" : "322638ca7bd5859cc49be694e9f8f9c7923572dc",
      "original_position" : 24,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 221994261,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271570034",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271571388"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271571388"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Should be no need to lock again because locked_chain is passed as an argument above. Guessing this is a rebase issue after 0440481c6bf5683eff669c789bdf6a306d99adc5 (#15652)",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-03T03:55:13Z",
      "diff_hunk" : "@@ -1867,43 +1867,44 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     if (!fBroadcastTransactions)\n         return;\n     std::map<int64_t, CWalletTx*> mapSorted;\n-\n-    // Sort pending wallet transactions based on their initial wallet insertion order\n-    for (std::pair<const uint256, CWalletTx>& item : mapWallet)\n     {\n-        const uint256& wtxid = item.first;\n-        CWalletTx& wtx = item.second;\n-        assert(wtx.GetHash() == wtxid);\n+        auto locked_chain = chain().lock();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271571388",
      "id" : 271571388,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MTU3MTM4OA==",
      "original_commit_id" : "322638ca7bd5859cc49be694e9f8f9c7923572dc",
      "original_position" : 11,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 221994261,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271571388",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Thanks for looking at this @ariard. My view is different from @ryanofsky's. I think rather than trying to maintain existing behaviour, we should use this interface tidyup to better define the relationship between the wallet and the node, ie to answer the question \"What services should the node offer to the wallet?\" Currently, the node exposes two methods to the wallet for sending a transaction:\r\n\r\n1. `submitToMemoryPool(const CTransactionRef& tx, CAmount absurd_fee, CValidationState& state)`: Add transaction to memory pool if the transaction fee is below the amount specified by absurd_fee. Returns false if the transaction could not be added due to the fee or for another reason. This is only called in `CWalletTx::AcceptToMemoryPool()`\r\n2. `relayTransaction(const uint256& txid)`: adds the txid to the INV queue for each peer. This is only called in `CWalletTx::RelayWalletTransaction()` (which also calls `CWalletTx::AcceptToMemoryPool()`)\r\n\r\nNote that to relay an INV for the transaction to peers (2), the transaction must already be in the mempool. See:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/ba54342c9dd3f2e5cdeed9ac57f1924f0d885cc6/src/net_processing.cpp#L3804\r\n\r\n`relayTransaction()` is only ever called if `InMempool() || AcceptToMemoryPool()` is true.\r\n\r\nThe wallet currently calls `CWalletTx::AcceptToMemoryPool()` in the following places:\r\n\r\n1a. In `CWallet::ReacceptWalletTransactions()`, called after the wallet has started up to make sure that its transactions are added to the mempool at start.\r\n2a. In `CWalletTx::RelayWalletTransaction()`, mentioned above.\r\n3a. In `CWallet::CommitTransaction()`, when a transaction is to be broadcast to the network for the first time.\r\n\r\nThe wallet currently calls `CWalletTx::RelayWalletTransaction()` in the following places:\r\n\r\n2a. In `CWallet::ResendWalletTransactions()`, called on a timer to rebroadcast unconfirmed transactions.\r\n2b. In `CWallet::CommitTransaction()`, but only if the transaction is successfully added to the mempool.\r\n\r\nI've been thinking about this in the context of the wallet rebroadcasting transactions (see discussion here: http://www.erisian.com.au/meetbot/bitcoin-core-dev/2019/bitcoin-core-dev.2019-03-29-19.10.log.html#l-9). My view now is that the wallet should not have any access to relay functionality. It should be able to submit transactions to the node's mempool, and it should then be the mempool's responsibility to broadcast/rebroadcast the transaction (see comment here: http://www.erisian.com.au/meetbot/bitcoin-core-dev/2019/bitcoin-core-dev.2019-03-29-19.10.log.html#l-92). That seems like a much cleaner divide of responsibility.\r\n\r\nThis PR seems like a simplification in terms of combining `submitToMemoryPool()` and `relayTransaction()` into a single method, but I don't think that it moves us towards a point where the node<->wallet interface is simpler to understand.",
      "created_at" : "2019-04-03T20:32:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-479647663",
      "id" : 479647663,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3OTY0NzY2Mw==",
      "updated_at" : "2019-04-03T20:32:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/479647663",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "John are you just saying that this PR does not go far enough, or that it does something bad or makes things more complicated?\r\n\r\nI haven't looked closely enough at this yet but if it exposes one node method node instead of two, and reduces the amount of code without changing behavior, it would seem like a strict improvement. Is your rebroadcast proposal harder to implement after this PR?",
      "created_at" : "2019-04-03T20:45:49Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-479652022",
      "id" : 479652022,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3OTY1MjAyMg==",
      "updated_at" : "2019-04-03T20:45:49Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/479652022",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> I haven't looked closely enough at this yet but if it exposes one node method node instead of two, and reduces the amount of code without changing behavior, it would seem like a strict improvement.\r\n\r\nIt does reduce the number of node methods exposed, but does so by adding a flag to one of them which toggles the behaviour. I'm not sure if that counts as a simplification, or it's just moving the complexity around. I'm also not sure if this maintains existing behaviour. For example, the `GetDepthInMainChain(locked_chain) == 0` in `RelayWalletTransaction()` seems to have gone and not been replaced by anything.",
      "created_at" : "2019-04-03T21:24:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-479664520",
      "id" : 479664520,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3OTY2NDUyMA==",
      "updated_at" : "2019-04-03T21:24:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/479664520",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271969421"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271969421"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Done",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-03T23:22:35Z",
      "diff_hunk" : "@@ -210,8 +205,7 @@ class NotificationsHandlerImpl : public Handler, CValidationInterface\n         // should be able to be removed entirely if `ResendWalletTransactions`\n         // is replaced by a wallet timer as suggested in\n         // https://github.com/bitcoin/bitcoin/issues/15619",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271969421",
      "id" : 271969421,
      "in_reply_to_id" : 271570034,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MTk2OTQyMQ==",
      "original_commit_id" : "322638ca7bd5859cc49be694e9f8f9c7923572dc",
      "original_position" : 24,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 222499264,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271969421",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I kinda agree with @jnewbery here, wallet shouldn't have access to relay, because if so it may add complexity of proper tx rebroadcasting tracking, notably in privacy-enhancing context in referenced discussions ?\r\nHave taken GetDepthInMainChain and IsCoinbase out, because seems it's cleaner to let the mempool do the checks, in AcceptToMemoryPoolWorker if I understand it well. And not multiply spurious wallet accesses to chain state.\r\nSorry scope of PR wasn't clear, would happily change it to underline the real issue I guess.",
      "created_at" : "2019-04-03T23:55:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-479699376",
      "id" : 479699376,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ3OTY5OTM3Ng==",
      "updated_at" : "2019-04-03T23:57:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/479699376",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271980722"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271980722"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes on my own, should be corrected!",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-04T00:24:54Z",
      "diff_hunk" : "@@ -1867,43 +1867,44 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     if (!fBroadcastTransactions)\n         return;\n     std::map<int64_t, CWalletTx*> mapSorted;\n-\n-    // Sort pending wallet transactions based on their initial wallet insertion order\n-    for (std::pair<const uint256, CWalletTx>& item : mapWallet)\n     {\n-        const uint256& wtxid = item.first;\n-        CWalletTx& wtx = item.second;\n-        assert(wtx.GetHash() == wtxid);\n+        auto locked_chain = chain().lock();",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r271980722",
      "id" : 271980722,
      "in_reply_to_id" : 271571388,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MTk4MDcyMg==",
      "original_commit_id" : "322638ca7bd5859cc49be694e9f8f9c7923572dc",
      "original_position" : 11,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 222512751,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/271980722",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-04-09T12:41:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-481234548",
      "id" : 481234548,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTIzNDU0OA==",
      "updated_at" : "2019-04-09T12:41:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481234548",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Ariard or John, what are next steps? Should this PR be closed and revisited in the future if rebroadcasting is improved? Should the current code comment about this be removed or clarified?\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/f3ecf3025f82f84d42ec463990ff787647cc7bf5/src/interfaces/chain.h#L52-L54",
      "created_at" : "2019-04-09T14:48:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-481283974",
      "id" : 481283974,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTI4Mzk3NA==",
      "updated_at" : "2019-04-09T14:48:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481283974",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I don't want to discourage @ariard from making this change if you both think it's an improvement over the existing code. It certainly doesn't preclude us from makeing the changes that I proposed in https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-479647663 at a later time. @ariard - if you think this should still go in, can you perhaps break up the PR into commits and justify any changes (eg why remove `GetDepthInMainChain` and `IsCoinbase` from `RelayWalletTransaction()`.\r\n\r\nNote that this conflicts with my #15728 which I think is a useful tidy-up in itself.",
      "created_at" : "2019-04-09T15:06:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-481291686",
      "id" : 481291686,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTI5MTY4Ng==",
      "updated_at" : "2019-04-09T15:06:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481291686",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Okay will keep working on it by breaking up the PR and justify changes. Had a look on #15728, IMO conflicts should be solved smoothly once yours get into it.\r\n@jnewbery  I've taken notes of your proposed changes of preventing wallet access to relay functionality but as far as I understand it would need first implementation of relay responsibility  in mempool, something not submit yet ? Once that done, removing relay from this code path seems really straightforward changes.",
      "created_at" : "2019-04-09T22:30:46Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-481464427",
      "id" : 481464427,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MTQ2NDQyNw==",
      "updated_at" : "2019-04-09T22:30:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/481464427",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Rebased, splitted the commits, added justifications. Note that I removed relay flag in BroadcastTransaction, if I get John opinion submitting tx to memory pool should imply relay if it's a valid one.",
      "created_at" : "2019-04-11T16:22:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-482185015",
      "id" : 482185015,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MjE4NTAxNQ==",
      "updated_at" : "2019-04-11T16:22:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/482185015",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274531705"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274531705"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This interface function doesn't need to expose the `wait_callback` bool since it's only ever called with `wait_callback` set to `false`.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-11T17:08:47Z",
      "diff_hunk" : "@@ -301,10 +296,13 @@ class ChainImpl : public Chain\n         auto it = ::mempool.GetIter(txid);\n         return it && (*it)->GetCountWithDescendants() > 1;\n     }\n-    void relayTransaction(const uint256& txid) override\n+    bool broadcastTransaction(const CTransactionRef& tx, uint256& txid, std::string& err_string, const CAmount& absurdfee, bool wait_callback) override",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274531705",
      "id" : 274531705,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDUzMTcwNQ==",
      "original_commit_id" : "56286233ab8dbb67eafba495d62ef0cd20043a2e",
      "original_position" : 26,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 225670184,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274531705",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274532313"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274532313"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: `return TransactionError::OK == err;`",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-11T17:09:23Z",
      "diff_hunk" : "@@ -301,10 +296,13 @@ class ChainImpl : public Chain\n         auto it = ::mempool.GetIter(txid);\n         return it && (*it)->GetCountWithDescendants() > 1;\n     }\n-    void relayTransaction(const uint256& txid) override\n+    bool broadcastTransaction(const CTransactionRef& tx, uint256& txid, std::string& err_string, const CAmount& absurdfee, bool wait_callback) override\n     {\n-        CInv inv(MSG_TX, txid);\n-        g_connman->ForEachNode([&inv](CNode* node) { node->PushInventory(inv); });\n+        const TransactionError err = BroadcastTransaction(tx, txid, err_string, absurdfee, wait_callback);\n+        if (TransactionError::OK == err) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274532313",
      "id" : 274532313,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDUzMjMxMw==",
      "original_commit_id" : "56286233ab8dbb67eafba495d62ef0cd20043a2e",
      "original_position" : 31,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 225670184,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274532313",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274543462"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274543462"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I still have a doubt on BroadcastTransaction HaveChain check behavior. ```HaveChain = !existingCoin.IsSpent()``` doesn't mean if tx is in chain, but all of its outputs has been spent, we accept it again to mempool/relay ?",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-11T17:28:15Z",
      "diff_hunk" : "@@ -1892,30 +1891,27 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     // Try to add wallet transactions to memory pool\n     for (const std::pair<const int64_t, CWalletTx*>& item : mapSorted) {\n         CWalletTx& wtx = *(item.second);\n-        CValidationState state;\n-        wtx.AcceptToMemoryPool(locked_chain, state);\n+        std::string err_string;\n+        wtx.SubmitMemoryPoolAndRelay(err_string);\n     }\n }\n \n-bool CWalletTx::RelayWalletTransaction(interfaces::Chain::Lock& locked_chain)\n+bool CWalletTx::SubmitMemoryPoolAndRelay(std::string& err_string)\n {\n     // Can't relay if wallet is not broadcasting\n     if (!pwallet->GetBroadcastTransactions()) return false;\n-    // Don't relay coinbase transactions outside blocks\n-    if (IsCoinBase()) return false;\n     // Don't relay abandoned transactions\n     if (isAbandoned()) return false;\n-    // Don't relay conflicted or already confirmed transactions\n-    if (GetDepthInMainChain(locked_chain) != 0) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274543462",
      "id" : 274543462,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDU0MzQ2Mg==",
      "original_commit_id" : "56286233ab8dbb67eafba495d62ef0cd20043a2e",
      "original_position" : 31,
      "path" : "src/wallet/wallet.cpp",
      "position" : 31,
      "pull_request_review_id" : 225679355,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274543462",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274545185"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274545185"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I think you can make this slightly clearer by adding a local variable `callback_set{false}`, setting it to `true` in the first `else if (wait_callback)` block, removing the second `else if (wait_callback)` block, and then testing for it here.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-11T17:32:52Z",
      "diff_hunk" : "@@ -55,15 +55,17 @@ TransactionError BroadcastTransaction(const CTransactionRef tx, uint256& hashTx,\n         }\n     } else if (fHaveChain) {\n         return TransactionError::ALREADY_IN_CHAIN;\n-    } else {\n+    } else if (wait_callback) {\n         // Make sure we don't block forever if re-sending\n         // a transaction already in mempool.\n         promise.set_value();\n     }\n \n     } // cs_main\n \n-    promise.get_future().wait();\n+    if (wait_callback) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274545185",
      "id" : 274545185,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDU0NTE4NQ==",
      "original_commit_id" : "56286233ab8dbb67eafba495d62ef0cd20043a2e",
      "original_position" : 32,
      "path" : "src/node/transaction.cpp",
      "position" : null,
      "pull_request_review_id" : 225670184,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274545185",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274545864"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274545864"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: I'd prefer to standardise on the name `max_tx_fee` (rather than `max_tx_fee`, `highfee`, `absurdfee`, etc)",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-11T17:34:37Z",
      "diff_hunk" : "@@ -189,8 +180,10 @@ class Chain\n     //! Check if transaction has descendants in mempool.\n     virtual bool hasDescendantsInMempool(const uint256& txid) = 0;\n \n-    //! Relay transaction.\n-    virtual void relayTransaction(const uint256& txid) = 0;\n+    //! Transaction is added to memory pool, if the transdaction fee is below the\n+    //! amount specified by absurdfee, and broadcast to all nodes.\n+    //! Return false if the transaction could not be added due to the fee or for another reason.\n+    virtual bool broadcastTransaction(const CTransactionRef& tx, uint256& txid, std::string& err_string, const CAmount& absurdfee, bool wait_callback) = 0;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274545864",
      "id" : 274545864,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDU0NTg2NA==",
      "original_commit_id" : "56286233ab8dbb67eafba495d62ef0cd20043a2e",
      "original_position" : 32,
      "path" : "src/interfaces/chain.h",
      "position" : null,
      "pull_request_review_id" : 225670184,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274545864",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274915099"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274915099"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Ah yes, thanks done",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T13:52:40Z",
      "diff_hunk" : "@@ -301,10 +296,13 @@ class ChainImpl : public Chain\n         auto it = ::mempool.GetIter(txid);\n         return it && (*it)->GetCountWithDescendants() > 1;\n     }\n-    void relayTransaction(const uint256& txid) override\n+    bool broadcastTransaction(const CTransactionRef& tx, uint256& txid, std::string& err_string, const CAmount& absurdfee, bool wait_callback) override",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274915099",
      "id" : 274915099,
      "in_reply_to_id" : 274531705,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDkxNTA5OQ==",
      "original_commit_id" : "56286233ab8dbb67eafba495d62ef0cd20043a2e",
      "original_position" : 26,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 226092323,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274915099",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274915158"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274915158"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T13:52:49Z",
      "diff_hunk" : "@@ -301,10 +296,13 @@ class ChainImpl : public Chain\n         auto it = ::mempool.GetIter(txid);\n         return it && (*it)->GetCountWithDescendants() > 1;\n     }\n-    void relayTransaction(const uint256& txid) override\n+    bool broadcastTransaction(const CTransactionRef& tx, uint256& txid, std::string& err_string, const CAmount& absurdfee, bool wait_callback) override\n     {\n-        CInv inv(MSG_TX, txid);\n-        g_connman->ForEachNode([&inv](CNode* node) { node->PushInventory(inv); });\n+        const TransactionError err = BroadcastTransaction(tx, txid, err_string, absurdfee, wait_callback);\n+        if (TransactionError::OK == err) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274915158",
      "id" : 274915158,
      "in_reply_to_id" : 274532313,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDkxNTE1OA==",
      "original_commit_id" : "56286233ab8dbb67eafba495d62ef0cd20043a2e",
      "original_position" : 31,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 226092412,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274915158",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274915414"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274915414"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Okay, also add params comments on it in.h",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T13:53:25Z",
      "diff_hunk" : "@@ -55,15 +55,17 @@ TransactionError BroadcastTransaction(const CTransactionRef tx, uint256& hashTx,\n         }\n     } else if (fHaveChain) {\n         return TransactionError::ALREADY_IN_CHAIN;\n-    } else {\n+    } else if (wait_callback) {\n         // Make sure we don't block forever if re-sending\n         // a transaction already in mempool.\n         promise.set_value();\n     }\n \n     } // cs_main\n \n-    promise.get_future().wait();\n+    if (wait_callback) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274915414",
      "id" : 274915414,
      "in_reply_to_id" : 274545185,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDkxNTQxNA==",
      "original_commit_id" : "56286233ab8dbb67eafba495d62ef0cd20043a2e",
      "original_position" : 32,
      "path" : "src/node/transaction.cpp",
      "position" : null,
      "pull_request_review_id" : 226092745,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274915414",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274949378"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274949378"
         }
      },
      "author_association" : "MEMBER",
      "body" : "no tabs please :)",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T15:09:53Z",
      "diff_hunk" : "@@ -301,10 +296,10 @@ class ChainImpl : public Chain\n         auto it = ::mempool.GetIter(txid);\n         return it && (*it)->GetCountWithDescendants() > 1;\n     }\n-    void relayTransaction(const uint256& txid) override\n+    bool broadcastTransaction(const CTransactionRef& tx, uint256& txid, std::string& err_string, const CAmount& max_tx_fee, bool relay) override\n     {\n-        CInv inv(MSG_TX, txid);\n-        g_connman->ForEachNode([&inv](CNode* node) { node->PushInventory(inv); });\n+        const TransactionError err = BroadcastTransaction(tx, txid, err_string, max_tx_fee, relay, false);\n+\treturn TransactionError::OK == err;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274949378",
      "id" : 274949378,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk0OTM3OA==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 31,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274949378",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274949818"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274949818"
         }
      },
      "author_association" : "MEMBER",
      "body" : "s/broadcast to all nodes/broadcast to all peers if relay is set to true/",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T15:10:42Z",
      "diff_hunk" : "@@ -189,8 +180,10 @@ class Chain\n     //! Check if transaction has descendants in mempool.\n     virtual bool hasDescendantsInMempool(const uint256& txid) = 0;\n \n-    //! Relay transaction.\n-    virtual void relayTransaction(const uint256& txid) = 0;\n+    //! Transaction is added to memory pool, if the transdaction fee is below the\n+    //! amount specified by max_tx_fee, and broadcast to all nodes.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274949818",
      "id" : 274949818,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk0OTgxOA==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 30,
      "path" : "src/interfaces/chain.h",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274949818",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274950390"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274950390"
         }
      },
      "author_association" : "MEMBER",
      "body" : "tab",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T15:12:01Z",
      "diff_hunk" : "@@ -52,6 +53,7 @@ TransactionError BroadcastTransaction(const CTransactionRef tx, uint256& hashTx,\n             CallFunctionInValidationInterfaceQueue([&promise] {\n                 promise.set_value();\n             });\n+\t    callback_set = true;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274950390",
      "id" : 274950390,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk1MDM5MA==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 35,
      "path" : "src/node/transaction.cpp",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274950390",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274950634"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274950634"
         }
      },
      "author_association" : "MEMBER",
      "body" : "you can remove the `else` block in LL60-64",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T15:12:34Z",
      "diff_hunk" : "@@ -63,7 +65,9 @@ TransactionError BroadcastTransaction(const CTransactionRef tx, uint256& hashTx,\n \n     } // cs_main\n \n-    promise.get_future().wait();\n+    if (callback_set) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274950634",
      "id" : 274950634,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk1MDYzNA==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 44,
      "path" : "src/node/transaction.cpp",
      "position" : 52,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274950634",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274950864"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274950864"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: two spaces",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T15:13:09Z",
      "diff_hunk" : "@@ -16,9 +16,11 @@\n  * @param[in]  tx the transaction to broadcast\n  * @param[out] &txid the txid of the transaction, if successfully broadcast\n  * @param[out] &err_string reference to std::string to fill with error string if available\n- * @param[in]  highfee Reject txs with fees higher than this (if 0, accept any fee)\n+ * @param[in]  max_tx_fee reject txs with fees higher than this (if 0, accept any fee)\n+ * @param[in]  relay flag if both mempool insertion and p2p relay  are requested",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274950864",
      "id" : 274950864,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk1MDg2NA==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 6,
      "path" : "src/node/transaction.h",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274950864",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274951244"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274951244"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: don't include unnecessary whitespace changes",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T15:14:01Z",
      "diff_hunk" : "@@ -36,7 +36,6 @@\n #include <validation.h>\n #include <validationinterface.h>\n \n-",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274951244",
      "id" : 274951244,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk1MTI0NA==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 4,
      "path" : "src/rpc/rawtransaction.cpp",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274951244",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274951887"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274951887"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You've added the `relay` bool but you're not using it.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T15:15:32Z",
      "diff_hunk" : "@@ -13,10 +13,11 @@\n \n #include <future>\n \n-TransactionError BroadcastTransaction(const CTransactionRef tx, uint256& hashTx, std::string& err_string, const CAmount& highfee)\n+TransactionError BroadcastTransaction(const CTransactionRef tx, uint256& hashTx, std::string& err_string, const CAmount& max_tx_fee, bool relay, bool wait_callback)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274951887",
      "id" : 274951887,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk1MTg4Nw==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 5,
      "path" : "src/node/transaction.cpp",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274951887",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274952597"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274952597"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This comment is incorrect. The function will just return immediately if `fBroadcastTransactions` is set to false.\r\n\r\n(I think this is from a bad rebase. The comment was changed to `Pass this transaction to the node to relay to its peers` in a more recent version.)",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T15:17:05Z",
      "diff_hunk" : "@@ -515,11 +515,8 @@ class CWalletTx : public CMerkleTx\n \n     int64_t GetTxTime() const;\n \n-    // Pass this transaction to the node to relay to its peers\n-    bool RelayWalletTransaction(interfaces::Chain::Lock& locked_chain);\n-\n-    /** Pass this transaction to the mempool. Fails if absolute fee exceeds absurd fee. */\n-    bool AcceptToMemoryPool(interfaces::Chain::Lock& locked_chain, CValidationState& state);\n+    // SubmitMemoryPoolAndRelay may only be called if fBroadcastTransactions!",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274952597",
      "id" : 274952597,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk1MjU5Nw==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 9,
      "path" : "src/wallet/wallet.h",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274952597",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274953029"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274953029"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is a behaviour change. You're relaying the transaction instead of just adding it to the mempool.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T15:18:17Z",
      "diff_hunk" : "@@ -1892,30 +1891,27 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     // Try to add wallet transactions to memory pool\n     for (const std::pair<const int64_t, CWalletTx*>& item : mapSorted) {\n         CWalletTx& wtx = *(item.second);\n-        CValidationState state;\n-        wtx.AcceptToMemoryPool(locked_chain, state);\n+        std::string err_string;\n+        wtx.SubmitMemoryPoolAndRelay(err_string);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274953029",
      "id" : 274953029,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk1MzAyOQ==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 17,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274953029",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274955618"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274955618"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Review note: This is a minor behaviour change. `chain().broadcastTransaction()` could return false if `BroadcastTransaction()` returned `TransactionError::P2P_DISABLED` (ie the transaction is added to the mempool but not relayed).",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T15:24:40Z",
      "diff_hunk" : "@@ -1892,30 +1891,27 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     // Try to add wallet transactions to memory pool\n     for (const std::pair<const int64_t, CWalletTx*>& item : mapSorted) {\n         CWalletTx& wtx = *(item.second);\n-        CValidationState state;\n-        wtx.AcceptToMemoryPool(locked_chain, state);\n+        std::string err_string;\n+        wtx.SubmitMemoryPoolAndRelay(err_string);\n     }\n }\n \n-bool CWalletTx::RelayWalletTransaction(interfaces::Chain::Lock& locked_chain)\n+bool CWalletTx::SubmitMemoryPoolAndRelay(std::string& err_string)\n {\n     // Can't relay if wallet is not broadcasting\n     if (!pwallet->GetBroadcastTransactions()) return false;\n-    // Don't relay coinbase transactions outside blocks\n-    if (IsCoinBase()) return false;\n     // Don't relay abandoned transactions\n     if (isAbandoned()) return false;\n-    // Don't relay conflicted or already confirmed transactions\n-    if (GetDepthInMainChain(locked_chain) != 0) return false;\n-    // Don't relay transactions that aren't accepted to the mempool\n-    CValidationState unused_state;\n-    if (!InMempool() && !AcceptToMemoryPool(locked_chain, unused_state)) return false;\n-    // Don't try to relay if the node is not connected to the p2p network\n-    if (!pwallet->chain().p2pEnabled()) return false;\n-\n-    // Try to relay the transaction\n-    pwallet->WalletLogPrintf(\"Relaying wtx %s\\n\", GetHash().ToString());\n-    pwallet->chain().relayTransaction(GetHash());\n+\n+    // Submit transaction to mempool for relay\n+    pwallet->WalletLogPrintf(\"Submitting wtx %s to mempool for relay\\n\", GetHash().ToString());\n+    uint256 txid;\n+    // We must set fInMempool here - while it will be re-set to true by the\n+    // entered-mempool callback, if we did not there would be a race where a\n+    // user could call sendmoney in a loop and hit spurious out of funds errors\n+    // because we think that this newly generated transaction's change is\n+    // unavailable as we're not yet aware that it is in the mempool.\n+    if (!(fInMempool |= pwallet->chain().broadcastTransaction(tx, txid, err_string, pwallet->chain().maxTxFee(), false))) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274955618",
      "id" : 274955618,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk1NTYxOA==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 50,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274955618",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274956702"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274956702"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Consider naming thuis `unused_err_string` to indicate that we throw it away without using it.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T15:27:08Z",
      "diff_hunk" : "@@ -1892,30 +1891,27 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     // Try to add wallet transactions to memory pool\n     for (const std::pair<const int64_t, CWalletTx*>& item : mapSorted) {\n         CWalletTx& wtx = *(item.second);\n-        CValidationState state;\n-        wtx.AcceptToMemoryPool(locked_chain, state);\n+        std::string err_string;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274956702",
      "id" : 274956702,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk1NjcwMg==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 16,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274956702",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274956745"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274956745"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Consider naming thuis `unused_err_string` to indicate that we throw it away without using it.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T15:27:15Z",
      "diff_hunk" : "@@ -2160,9 +2155,10 @@ void CWallet::ResendWalletTransactions()\n             // only rebroadcast unconfirmed txes older than 5 minutes before the\n             // last block was found\n             if (wtx.nTimeReceived > m_best_block_time - 5 * 60) continue;\n-            if (wtx.RelayWalletTransaction(*locked_chain)) ++relayed_tx_count;\n+            std::string err_string;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274956745",
      "id" : 274956745,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk1Njc0NQ==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 69,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274956745",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274989316"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274989316"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is also a behaviour change because previously, `AcceptToMemoryPool()` would return `false` if `submitToMemoryPool()` returned `false`. Now, if `fInMempool` is set to `true` but `broadcastTransaction()` returns `false`, then it'll return `true`.\r\n\r\nI think it makes sense to stick with the structure of the old `AcceptToMemoryPool()` function.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T17:01:25Z",
      "diff_hunk" : "@@ -1892,30 +1891,27 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     // Try to add wallet transactions to memory pool\n     for (const std::pair<const int64_t, CWalletTx*>& item : mapSorted) {\n         CWalletTx& wtx = *(item.second);\n-        CValidationState state;\n-        wtx.AcceptToMemoryPool(locked_chain, state);\n+        std::string err_string;\n+        wtx.SubmitMemoryPoolAndRelay(err_string);\n     }\n }\n \n-bool CWalletTx::RelayWalletTransaction(interfaces::Chain::Lock& locked_chain)\n+bool CWalletTx::SubmitMemoryPoolAndRelay(std::string& err_string)\n {\n     // Can't relay if wallet is not broadcasting\n     if (!pwallet->GetBroadcastTransactions()) return false;\n-    // Don't relay coinbase transactions outside blocks\n-    if (IsCoinBase()) return false;\n     // Don't relay abandoned transactions\n     if (isAbandoned()) return false;\n-    // Don't relay conflicted or already confirmed transactions\n-    if (GetDepthInMainChain(locked_chain) != 0) return false;\n-    // Don't relay transactions that aren't accepted to the mempool\n-    CValidationState unused_state;\n-    if (!InMempool() && !AcceptToMemoryPool(locked_chain, unused_state)) return false;\n-    // Don't try to relay if the node is not connected to the p2p network\n-    if (!pwallet->chain().p2pEnabled()) return false;\n-\n-    // Try to relay the transaction\n-    pwallet->WalletLogPrintf(\"Relaying wtx %s\\n\", GetHash().ToString());\n-    pwallet->chain().relayTransaction(GetHash());\n+\n+    // Submit transaction to mempool for relay\n+    pwallet->WalletLogPrintf(\"Submitting wtx %s to mempool for relay\\n\", GetHash().ToString());\n+    uint256 txid;\n+    // We must set fInMempool here - while it will be re-set to true by the\n+    // entered-mempool callback, if we did not there would be a race where a\n+    // user could call sendmoney in a loop and hit spurious out of funds errors\n+    // because we think that this newly generated transaction's change is\n+    // unavailable as we're not yet aware that it is in the mempool.\n+    if (!(fInMempool |= pwallet->chain().broadcastTransaction(tx, txid, err_string, pwallet->chain().maxTxFee(), false))) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274989316",
      "id" : 274989316,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk4OTMxNg==",
      "original_commit_id" : "94623bd79106bc2e614f5c5a79e7495fbb843576",
      "original_position" : 50,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274989316",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274991614"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274991614"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Thanks for adding comments. I'd add to the description of the `wait_callback` param that this **must not** be set while cs_main, cs_mempool or cs_wallet is being held or there'll be a deadlock.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-12T17:08:51Z",
      "diff_hunk" : "@@ -16,9 +16,11 @@\n  * @param[in]  tx the transaction to broadcast\n  * @param[out] &txid the txid of the transaction, if successfully broadcast\n  * @param[out] &err_string reference to std::string to fill with error string if available\n- * @param[in]  highfee Reject txs with fees higher than this (if 0, accept any fee)\n+ * @param[in]  max_tx_fee reject txs with fees higher than this (if 0, accept any fee)\n+ * @param[in]  relay flag if both mempool insertion and p2p relay  are requested\n+ * @param[in]  wait_callback, wait until callbacks have been processed to avoid stale result due to a sequentially RPC",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274991614",
      "id" : 274991614,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NDk5MTYxNA==",
      "original_commit_id" : "94623bd79106bc2e614f5c5a79e7495fbb843576",
      "original_position" : 7,
      "path" : "src/node/transaction.h",
      "position" : null,
      "pull_request_review_id" : 226137291,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/274991614",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275122038"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275122038"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, configured my editor accordingly!",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-13T15:26:08Z",
      "diff_hunk" : "@@ -301,10 +296,10 @@ class ChainImpl : public Chain\n         auto it = ::mempool.GetIter(txid);\n         return it && (*it)->GetCountWithDescendants() > 1;\n     }\n-    void relayTransaction(const uint256& txid) override\n+    bool broadcastTransaction(const CTransactionRef& tx, uint256& txid, std::string& err_string, const CAmount& max_tx_fee, bool relay) override\n     {\n-        CInv inv(MSG_TX, txid);\n-        g_connman->ForEachNode([&inv](CNode* node) { node->PushInventory(inv); });\n+        const TransactionError err = BroadcastTransaction(tx, txid, err_string, max_tx_fee, relay, false);\n+\treturn TransactionError::OK == err;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275122038",
      "id" : 275122038,
      "in_reply_to_id" : 274949378,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTEyMjAzOA==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 31,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 226357237,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275122038",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275122126"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275122126"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Corrected but was to align with other descriptions?",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-13T15:28:45Z",
      "diff_hunk" : "@@ -16,9 +16,11 @@\n  * @param[in]  tx the transaction to broadcast\n  * @param[out] &txid the txid of the transaction, if successfully broadcast\n  * @param[out] &err_string reference to std::string to fill with error string if available\n- * @param[in]  highfee Reject txs with fees higher than this (if 0, accept any fee)\n+ * @param[in]  max_tx_fee reject txs with fees higher than this (if 0, accept any fee)\n+ * @param[in]  relay flag if both mempool insertion and p2p relay  are requested",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275122126",
      "id" : 275122126,
      "in_reply_to_id" : 274950864,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTEyMjEyNg==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 6,
      "path" : "src/node/transaction.h",
      "position" : null,
      "pull_request_review_id" : 226357320,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275122126",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275122154"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275122154"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "What's your take on returning a pair of boolean from chain().broadcastTransaction() to encode both mempool/relay results ?",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-13T15:30:01Z",
      "diff_hunk" : "@@ -1892,30 +1891,27 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     // Try to add wallet transactions to memory pool\n     for (const std::pair<const int64_t, CWalletTx*>& item : mapSorted) {\n         CWalletTx& wtx = *(item.second);\n-        CValidationState state;\n-        wtx.AcceptToMemoryPool(locked_chain, state);\n+        std::string err_string;\n+        wtx.SubmitMemoryPoolAndRelay(err_string);\n     }\n }\n \n-bool CWalletTx::RelayWalletTransaction(interfaces::Chain::Lock& locked_chain)\n+bool CWalletTx::SubmitMemoryPoolAndRelay(std::string& err_string)\n {\n     // Can't relay if wallet is not broadcasting\n     if (!pwallet->GetBroadcastTransactions()) return false;\n-    // Don't relay coinbase transactions outside blocks\n-    if (IsCoinBase()) return false;\n     // Don't relay abandoned transactions\n     if (isAbandoned()) return false;\n-    // Don't relay conflicted or already confirmed transactions\n-    if (GetDepthInMainChain(locked_chain) != 0) return false;\n-    // Don't relay transactions that aren't accepted to the mempool\n-    CValidationState unused_state;\n-    if (!InMempool() && !AcceptToMemoryPool(locked_chain, unused_state)) return false;\n-    // Don't try to relay if the node is not connected to the p2p network\n-    if (!pwallet->chain().p2pEnabled()) return false;\n-\n-    // Try to relay the transaction\n-    pwallet->WalletLogPrintf(\"Relaying wtx %s\\n\", GetHash().ToString());\n-    pwallet->chain().relayTransaction(GetHash());\n+\n+    // Submit transaction to mempool for relay\n+    pwallet->WalletLogPrintf(\"Submitting wtx %s to mempool for relay\\n\", GetHash().ToString());\n+    uint256 txid;\n+    // We must set fInMempool here - while it will be re-set to true by the\n+    // entered-mempool callback, if we did not there would be a race where a\n+    // user could call sendmoney in a loop and hit spurious out of funds errors\n+    // because we think that this newly generated transaction's change is\n+    // unavailable as we're not yet aware that it is in the mempool.\n+    if (!(fInMempool |= pwallet->chain().broadcastTransaction(tx, txid, err_string, pwallet->chain().maxTxFee(), false))) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275122154",
      "id" : 275122154,
      "in_reply_to_id" : 274955618,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTEyMjE1NA==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 50,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226357358,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275122154",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275122174"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275122174"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Okay back to AcceptToMemoryPool structure",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-13T15:30:33Z",
      "diff_hunk" : "@@ -1892,30 +1891,27 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     // Try to add wallet transactions to memory pool\n     for (const std::pair<const int64_t, CWalletTx*>& item : mapSorted) {\n         CWalletTx& wtx = *(item.second);\n-        CValidationState state;\n-        wtx.AcceptToMemoryPool(locked_chain, state);\n+        std::string err_string;\n+        wtx.SubmitMemoryPoolAndRelay(err_string);\n     }\n }\n \n-bool CWalletTx::RelayWalletTransaction(interfaces::Chain::Lock& locked_chain)\n+bool CWalletTx::SubmitMemoryPoolAndRelay(std::string& err_string)\n {\n     // Can't relay if wallet is not broadcasting\n     if (!pwallet->GetBroadcastTransactions()) return false;\n-    // Don't relay coinbase transactions outside blocks\n-    if (IsCoinBase()) return false;\n     // Don't relay abandoned transactions\n     if (isAbandoned()) return false;\n-    // Don't relay conflicted or already confirmed transactions\n-    if (GetDepthInMainChain(locked_chain) != 0) return false;\n-    // Don't relay transactions that aren't accepted to the mempool\n-    CValidationState unused_state;\n-    if (!InMempool() && !AcceptToMemoryPool(locked_chain, unused_state)) return false;\n-    // Don't try to relay if the node is not connected to the p2p network\n-    if (!pwallet->chain().p2pEnabled()) return false;\n-\n-    // Try to relay the transaction\n-    pwallet->WalletLogPrintf(\"Relaying wtx %s\\n\", GetHash().ToString());\n-    pwallet->chain().relayTransaction(GetHash());\n+\n+    // Submit transaction to mempool for relay\n+    pwallet->WalletLogPrintf(\"Submitting wtx %s to mempool for relay\\n\", GetHash().ToString());\n+    uint256 txid;\n+    // We must set fInMempool here - while it will be re-set to true by the\n+    // entered-mempool callback, if we did not there would be a race where a\n+    // user could call sendmoney in a loop and hit spurious out of funds errors\n+    // because we think that this newly generated transaction's change is\n+    // unavailable as we're not yet aware that it is in the mempool.\n+    if (!(fInMempool |= pwallet->chain().broadcastTransaction(tx, txid, err_string, pwallet->chain().maxTxFee(), false))) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275122174",
      "id" : 275122174,
      "in_reply_to_id" : 274989316,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTEyMjE3NA==",
      "original_commit_id" : "94623bd79106bc2e614f5c5a79e7495fbb843576",
      "original_position" : 50,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226357378,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275122174",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks @jnewbery for the review and sorry for the ugly commit split. I think I've addressed all your points except this one : https://github.com/bitcoin/bitcoin/pull/15713#discussion_r274955618 ?",
      "created_at" : "2019-04-13T15:32:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-482822062",
      "id" : 482822062,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MjgyMjA2Mg==",
      "updated_at" : "2019-04-13T15:32:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/482822062",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275374247"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275374247"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: Should be \"transaction\" :-)",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-15T14:00:17Z",
      "diff_hunk" : "@@ -189,8 +180,10 @@ class Chain\n     //! Check if transaction has descendants in mempool.\n     virtual bool hasDescendantsInMempool(const uint256& txid) = 0;\n \n-    //! Relay transaction.\n-    virtual void relayTransaction(const uint256& txid) = 0;\n+    //! Transaction is added to memory pool, if the transdaction fee is below the",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275374247",
      "id" : 275374247,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTM3NDI0Nw==",
      "original_commit_id" : "602e38d0a79c3e7cf72740fb92261e3d66642ce3",
      "original_position" : 29,
      "path" : "src/interfaces/chain.h",
      "position" : null,
      "pull_request_review_id" : 226662919,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275374247",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/7826565?v=4",
         "events_url" : "https://api.github.com/users/practicalswift/events{/privacy}",
         "followers_url" : "https://api.github.com/users/practicalswift/followers",
         "following_url" : "https://api.github.com/users/practicalswift/following{/other_user}",
         "gists_url" : "https://api.github.com/users/practicalswift/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/practicalswift",
         "id" : 7826565,
         "login" : "practicalswift",
         "node_id" : "MDQ6VXNlcjc4MjY1NjU=",
         "organizations_url" : "https://api.github.com/users/practicalswift/orgs",
         "received_events_url" : "https://api.github.com/users/practicalswift/received_events",
         "repos_url" : "https://api.github.com/users/practicalswift/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/practicalswift/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/practicalswift"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275378505"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275378505"
         }
      },
      "author_association" : "MEMBER",
      "body" : "sorry, I meant the two spaces between `relay` and `are`. I think two spaces at the front to align with the other params is fine.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-15T14:09:18Z",
      "diff_hunk" : "@@ -16,9 +16,11 @@\n  * @param[in]  tx the transaction to broadcast\n  * @param[out] &txid the txid of the transaction, if successfully broadcast\n  * @param[out] &err_string reference to std::string to fill with error string if available\n- * @param[in]  highfee Reject txs with fees higher than this (if 0, accept any fee)\n+ * @param[in]  max_tx_fee reject txs with fees higher than this (if 0, accept any fee)\n+ * @param[in]  relay flag if both mempool insertion and p2p relay  are requested",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275378505",
      "id" : 275378505,
      "in_reply_to_id" : 274950864,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTM3ODUwNQ==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 6,
      "path" : "src/node/transaction.h",
      "position" : null,
      "pull_request_review_id" : 226668418,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275378505",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275381581"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275381581"
         }
      },
      "author_association" : "MEMBER",
      "body" : "In the existing code there's not a return code for `chain::relayTransaction()`. I think it's fine for the new `broadcastTransaction` interface method to only return `false` if the transaction failed to get into the mempool, and treat `TransactionError::P2P_DISABLED` as success. That way, `fInMempool` will get updated in exactly the same way as the existing code.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-15T14:15:42Z",
      "diff_hunk" : "@@ -1892,30 +1891,27 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     // Try to add wallet transactions to memory pool\n     for (const std::pair<const int64_t, CWalletTx*>& item : mapSorted) {\n         CWalletTx& wtx = *(item.second);\n-        CValidationState state;\n-        wtx.AcceptToMemoryPool(locked_chain, state);\n+        std::string err_string;\n+        wtx.SubmitMemoryPoolAndRelay(err_string);\n     }\n }\n \n-bool CWalletTx::RelayWalletTransaction(interfaces::Chain::Lock& locked_chain)\n+bool CWalletTx::SubmitMemoryPoolAndRelay(std::string& err_string)\n {\n     // Can't relay if wallet is not broadcasting\n     if (!pwallet->GetBroadcastTransactions()) return false;\n-    // Don't relay coinbase transactions outside blocks\n-    if (IsCoinBase()) return false;\n     // Don't relay abandoned transactions\n     if (isAbandoned()) return false;\n-    // Don't relay conflicted or already confirmed transactions\n-    if (GetDepthInMainChain(locked_chain) != 0) return false;\n-    // Don't relay transactions that aren't accepted to the mempool\n-    CValidationState unused_state;\n-    if (!InMempool() && !AcceptToMemoryPool(locked_chain, unused_state)) return false;\n-    // Don't try to relay if the node is not connected to the p2p network\n-    if (!pwallet->chain().p2pEnabled()) return false;\n-\n-    // Try to relay the transaction\n-    pwallet->WalletLogPrintf(\"Relaying wtx %s\\n\", GetHash().ToString());\n-    pwallet->chain().relayTransaction(GetHash());\n+\n+    // Submit transaction to mempool for relay\n+    pwallet->WalletLogPrintf(\"Submitting wtx %s to mempool for relay\\n\", GetHash().ToString());\n+    uint256 txid;\n+    // We must set fInMempool here - while it will be re-set to true by the\n+    // entered-mempool callback, if we did not there would be a race where a\n+    // user could call sendmoney in a loop and hit spurious out of funds errors\n+    // because we think that this newly generated transaction's change is\n+    // unavailable as we're not yet aware that it is in the mempool.\n+    if (!(fInMempool |= pwallet->chain().broadcastTransaction(tx, txid, err_string, pwallet->chain().maxTxFee(), false))) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275381581",
      "id" : 275381581,
      "in_reply_to_id" : 274955618,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTM4MTU4MQ==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 50,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226672473,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275381581",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275381858"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275381858"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You now have `locked_chain` as a parameter, even though it's unused in this function in the final commit.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-15T14:16:23Z",
      "diff_hunk" : "@@ -1892,32 +1891,29 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     // Try to add wallet transactions to memory pool\n     for (const std::pair<const int64_t, CWalletTx*>& item : mapSorted) {\n         CWalletTx& wtx = *(item.second);\n-        CValidationState state;\n-        wtx.AcceptToMemoryPool(locked_chain, state);\n+        std::string unused_err_string;\n+        wtx.SubmitMemoryPoolAndRelay(unused_err_string, false, locked_chain);\n     }\n }\n \n-bool CWalletTx::RelayWalletTransaction(interfaces::Chain::Lock& locked_chain)\n+bool CWalletTx::SubmitMemoryPoolAndRelay(std::string& err_string, bool relay, interfaces::Chain::Lock& locked_chain)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275381858",
      "id" : 275381858,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTM4MTg1OA==",
      "original_commit_id" : "602e38d0a79c3e7cf72740fb92261e3d66642ce3",
      "original_position" : 22,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 226672846,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275381858",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Still a couple of minor issues to fix up.",
      "created_at" : "2019-04-15T14:17:04Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-483270158",
      "id" : 483270158,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4MzI3MDE1OA==",
      "updated_at" : "2019-04-15T14:17:04Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/483270158",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275797359"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275797359"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Good, added ```TransactionError::P2P_DISABLED == err``` check in broadcastTransaction interface",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-16T13:30:34Z",
      "diff_hunk" : "@@ -1892,30 +1891,27 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     // Try to add wallet transactions to memory pool\n     for (const std::pair<const int64_t, CWalletTx*>& item : mapSorted) {\n         CWalletTx& wtx = *(item.second);\n-        CValidationState state;\n-        wtx.AcceptToMemoryPool(locked_chain, state);\n+        std::string err_string;\n+        wtx.SubmitMemoryPoolAndRelay(err_string);\n     }\n }\n \n-bool CWalletTx::RelayWalletTransaction(interfaces::Chain::Lock& locked_chain)\n+bool CWalletTx::SubmitMemoryPoolAndRelay(std::string& err_string)\n {\n     // Can't relay if wallet is not broadcasting\n     if (!pwallet->GetBroadcastTransactions()) return false;\n-    // Don't relay coinbase transactions outside blocks\n-    if (IsCoinBase()) return false;\n     // Don't relay abandoned transactions\n     if (isAbandoned()) return false;\n-    // Don't relay conflicted or already confirmed transactions\n-    if (GetDepthInMainChain(locked_chain) != 0) return false;\n-    // Don't relay transactions that aren't accepted to the mempool\n-    CValidationState unused_state;\n-    if (!InMempool() && !AcceptToMemoryPool(locked_chain, unused_state)) return false;\n-    // Don't try to relay if the node is not connected to the p2p network\n-    if (!pwallet->chain().p2pEnabled()) return false;\n-\n-    // Try to relay the transaction\n-    pwallet->WalletLogPrintf(\"Relaying wtx %s\\n\", GetHash().ToString());\n-    pwallet->chain().relayTransaction(GetHash());\n+\n+    // Submit transaction to mempool for relay\n+    pwallet->WalletLogPrintf(\"Submitting wtx %s to mempool for relay\\n\", GetHash().ToString());\n+    uint256 txid;\n+    // We must set fInMempool here - while it will be re-set to true by the\n+    // entered-mempool callback, if we did not there would be a race where a\n+    // user could call sendmoney in a loop and hit spurious out of funds errors\n+    // because we think that this newly generated transaction's change is\n+    // unavailable as we're not yet aware that it is in the mempool.\n+    if (!(fInMempool |= pwallet->chain().broadcastTransaction(tx, txid, err_string, pwallet->chain().maxTxFee(), false))) return false;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275797359",
      "id" : 275797359,
      "in_reply_to_id" : 274955618,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTc5NzM1OQ==",
      "original_commit_id" : "bcbc316b6bc5b0e4ce427ab93e604497705e2aaf",
      "original_position" : 50,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 227194054,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275797359",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275797481"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275797481"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Thanks, good catch!",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-16T13:30:49Z",
      "diff_hunk" : "@@ -189,8 +180,10 @@ class Chain\n     //! Check if transaction has descendants in mempool.\n     virtual bool hasDescendantsInMempool(const uint256& txid) = 0;\n \n-    //! Relay transaction.\n-    virtual void relayTransaction(const uint256& txid) = 0;\n+    //! Transaction is added to memory pool, if the transdaction fee is below the",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275797481",
      "id" : 275797481,
      "in_reply_to_id" : 275374247,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTc5NzQ4MQ==",
      "original_commit_id" : "602e38d0a79c3e7cf72740fb92261e3d66642ce3",
      "original_position" : 29,
      "path" : "src/interfaces/chain.h",
      "position" : null,
      "pull_request_review_id" : 227194209,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275797481",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275797688"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275797688"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Yes rebase issue, should be solved",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-16T13:31:14Z",
      "diff_hunk" : "@@ -1892,32 +1891,29 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     // Try to add wallet transactions to memory pool\n     for (const std::pair<const int64_t, CWalletTx*>& item : mapSorted) {\n         CWalletTx& wtx = *(item.second);\n-        CValidationState state;\n-        wtx.AcceptToMemoryPool(locked_chain, state);\n+        std::string unused_err_string;\n+        wtx.SubmitMemoryPoolAndRelay(unused_err_string, false, locked_chain);\n     }\n }\n \n-bool CWalletTx::RelayWalletTransaction(interfaces::Chain::Lock& locked_chain)\n+bool CWalletTx::SubmitMemoryPoolAndRelay(std::string& err_string, bool relay, interfaces::Chain::Lock& locked_chain)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275797688",
      "id" : 275797688,
      "in_reply_to_id" : 275381858,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTc5NzY4OA==",
      "original_commit_id" : "602e38d0a79c3e7cf72740fb92261e3d66642ce3",
      "original_position" : 22,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 227194462,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275797688",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275864733"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275864733"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: sort includes",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-16T15:40:51Z",
      "diff_hunk" : "@@ -30,6 +30,7 @@\n #include <util/system.h>\n #include <validation.h>\n #include <validationinterface.h>\n+#include <node/transaction.h>",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275864733",
      "id" : 275864733,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTg2NDczMw==",
      "original_commit_id" : "b857c21ffd093142aab983491c97ac5a37861405",
      "original_position" : 4,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 227280903,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275864733",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275865799"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275865799"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: could include an inline comment for the last parameter:\r\n\r\n```c++\r\nconst TransactionError err = BroadcastTransaction(tx, txid, err_string, max_tx_fee, relay, /*wait_callback*/ false);\r\n```",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-16T15:42:52Z",
      "diff_hunk" : "@@ -301,10 +296,10 @@ class ChainImpl : public Chain\n         auto it = ::mempool.GetIter(txid);\n         return it && (*it)->GetCountWithDescendants() > 1;\n     }\n-    void relayTransaction(const uint256& txid) override\n+    bool broadcastTransaction(const CTransactionRef& tx, uint256& txid, std::string& err_string, const CAmount& max_tx_fee, bool relay) override\n     {\n-        CInv inv(MSG_TX, txid);\n-        g_connman->ForEachNode([&inv](CNode* node) { node->PushInventory(inv); });\n+        const TransactionError err = BroadcastTransaction(tx, txid, err_string, max_tx_fee, relay, false);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275865799",
      "id" : 275865799,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTg2NTc5OQ==",
      "original_commit_id" : "b857c21ffd093142aab983491c97ac5a37861405",
      "original_position" : 30,
      "path" : "src/interfaces/chain.cpp",
      "position" : null,
      "pull_request_review_id" : 227280903,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275865799",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275866879"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275866879"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Should this also be within the `if (relay)` block? Returning a `TransactionError::P2P_DISABLED` error when the caller hasn't asked for the transaction to be relayed seems wrong.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-16T15:45:02Z",
      "diff_hunk" : "@@ -52,27 +53,28 @@ TransactionError BroadcastTransaction(const CTransactionRef tx, uint256& hashTx,\n             CallFunctionInValidationInterfaceQueue([&promise] {\n                 promise.set_value();\n             });\n+            callback_set = true;\n         }\n     } else if (fHaveChain) {\n         return TransactionError::ALREADY_IN_CHAIN;\n-    } else {\n-        // Make sure we don't block forever if re-sending\n-        // a transaction already in mempool.\n-        promise.set_value();\n     }\n \n     } // cs_main\n \n-    promise.get_future().wait();\n+    if (callback_set) {\n+        promise.get_future().wait();\n+    }\n \n     if (!g_connman) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275866879",
      "id" : 275866879,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTg2Njg3OQ==",
      "original_commit_id" : "b857c21ffd093142aab983491c97ac5a37861405",
      "original_position" : 52,
      "path" : "src/node/transaction.cpp",
      "position" : null,
      "pull_request_review_id" : 227280903,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275866879",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275870210"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275870210"
         }
      },
      "author_association" : "MEMBER",
      "body" : "See comment in interface/chain.h. I recommend you remove the unused uint256 from the interface method.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-16T15:51:40Z",
      "diff_hunk" : "@@ -1892,32 +1891,29 @@ void CWallet::ReacceptWalletTransactions(interfaces::Chain::Lock& locked_chain)\n     // Try to add wallet transactions to memory pool\n     for (const std::pair<const int64_t, CWalletTx*>& item : mapSorted) {\n         CWalletTx& wtx = *(item.second);\n-        CValidationState state;\n-        wtx.AcceptToMemoryPool(locked_chain, state);\n+        std::string unused_err_string;\n+        wtx.SubmitMemoryPoolAndRelay(unused_err_string, false);\n     }\n }\n \n-bool CWalletTx::RelayWalletTransaction(interfaces::Chain::Lock& locked_chain)\n+bool CWalletTx::SubmitMemoryPoolAndRelay(std::string& err_string, bool relay)\n {\n     // Can't relay if wallet is not broadcasting\n     if (!pwallet->GetBroadcastTransactions()) return false;\n-    // Don't relay coinbase transactions outside blocks\n-    if (IsCoinBase()) return false;\n     // Don't relay abandoned transactions\n     if (isAbandoned()) return false;\n-    // Don't relay conflicted or already confirmed transactions\n-    if (GetDepthInMainChain(locked_chain) != 0) return false;\n-    // Don't relay transactions that aren't accepted to the mempool\n-    CValidationState unused_state;\n-    if (!InMempool() && !AcceptToMemoryPool(locked_chain, unused_state)) return false;\n-    // Don't try to relay if the node is not connected to the p2p network\n-    if (!pwallet->chain().p2pEnabled()) return false;\n-\n-    // Try to relay the transaction\n-    pwallet->WalletLogPrintf(\"Relaying wtx %s\\n\", GetHash().ToString());\n-    pwallet->chain().relayTransaction(GetHash());\n \n-    return true;\n+    // Submit transaction to mempool for relay\n+    pwallet->WalletLogPrintf(\"Submitting wtx %s to mempool for relay\\n\", GetHash().ToString());\n+    uint256 txid;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275870210",
      "id" : 275870210,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTg3MDIxMA==",
      "original_commit_id" : "b857c21ffd093142aab983491c97ac5a37861405",
      "original_position" : 45,
      "path" : "src/wallet/wallet.cpp",
      "position" : null,
      "pull_request_review_id" : 227280903,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275870210",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275871197"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275871197"
         }
      },
      "author_association" : "MEMBER",
      "body" : "You could remove the `hashTx` parameter from this interface method. The only caller of the method supplies an unused uint256 and then throws it away.",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-16T15:53:37Z",
      "diff_hunk" : "@@ -13,10 +13,11 @@\n \n #include <future>\n \n-TransactionError BroadcastTransaction(const CTransactionRef tx, uint256& hashTx, std::string& err_string, const CAmount& highfee)\n+TransactionError BroadcastTransaction(const CTransactionRef tx, uint256& hashTx, std::string& err_string, const CAmount& max_tx_fee, bool relay, bool wait_callback)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275871197",
      "id" : 275871197,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTg3MTE5Nw==",
      "original_commit_id" : "b857c21ffd093142aab983491c97ac5a37861405",
      "original_position" : 5,
      "path" : "src/node/transaction.cpp",
      "position" : null,
      "pull_request_review_id" : 227280903,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275871197",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275872607"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275872607"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is exactly right, but I think it could do with a comment. Something like:\r\n\r\n```\r\n// Chain clients only care about failures to accept the tx to the mempool. Disregard non-mempool related failures\r\n// Note: this will need to be updated if BroadcastTransaction() is updated to return other non-mempool failures\r\n// that Chain clients do not need to know about.\r\n```",
      "commit_id" : "0a1f4d96790207162a566c9dba9c07f9fc4c2b97",
      "created_at" : "2019-04-16T15:56:36Z",
      "diff_hunk" : "@@ -301,10 +296,10 @@ class ChainImpl : public Chain\n         auto it = ::mempool.GetIter(txid);\n         return it && (*it)->GetCountWithDescendants() > 1;\n     }\n-    void relayTransaction(const uint256& txid) override\n+    bool broadcastTransaction(const CTransactionRef& tx, uint256& txid, std::string& err_string, const CAmount& max_tx_fee, bool relay) override\n     {\n-        CInv inv(MSG_TX, txid);\n-        g_connman->ForEachNode([&inv](CNode* node) { node->PushInventory(inv); });\n+        const TransactionError err = BroadcastTransaction(tx, txid, err_string, max_tx_fee, relay, false);\n+        return TransactionError::OK == err || TransactionError::P2P_DISABLED == err;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#discussion_r275872607",
      "id" : 275872607,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3NTg3MjYwNw==",
      "original_commit_id" : "b857c21ffd093142aab983491c97ac5a37861405",
      "original_position" : 31,
      "path" : "src/interfaces/chain.cpp",
      "position" : 34,
      "pull_request_review_id" : 227280903,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15713",
      "updated_at" : "2019-05-02T18:42:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/275872607",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "a00303c updated with @jnewbery last review comments, specially removing unused uint256 from BroadcastTransaction interface\r\n\r\nAnd \"Initial build successful, but not enough time remains to run later build stages and tests. Please manually re-run this job by using the travis restart button or asking a bitcoin maintainer to restart. The next run should not time out because the build cache has been saved.\"",
      "created_at" : "2019-04-17T13:11:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-484077995",
      "id" : 484077995,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NDA3Nzk5NQ==",
      "updated_at" : "2019-04-17T14:09:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/484077995",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Looks like this might also help a little bit with #14912, since right now it's adding another broadcastTransaction method (a7678372bd8b4ef4ce33a406559a0ea860ce1abf).",
      "created_at" : "2019-04-17T16:48:45Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-484171393",
      "id" : 484171393,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NDE3MTM5Mw==",
      "updated_at" : "2019-04-17T16:48:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/484171393",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Looks good. utACK e5b0fe904a9c6186b8273c61e93ee1538418b245\r\n\r\n(I was only suggesting to remove the uint256 from the interface `broadcastTransaction()` method, not the `BroadcastTransaction()` function in node/transaction, but removing it there is also fine I think.)",
      "created_at" : "2019-04-17T17:10:01Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-484179422",
      "id" : 484179422,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NDE3OTQyMg==",
      "updated_at" : "2019-04-17T17:10:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/484179422",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
      "created_at" : "2019-04-27T13:35:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-487286730",
      "id" : 487286730,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NzI4NjczMA==",
      "updated_at" : "2019-04-27T13:35:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/487286730",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@Sjors you mean erasing errors which seems to be used by no one right now (like TransactionError::MEMPOOL_ERROR) and just return a generic error for these cases ? Or returning errors from `broadcastTransactions` instead of a boolean and let caller to filter ?",
      "created_at" : "2019-05-02T15:58:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15713#issuecomment-488730104",
      "id" : 488730104,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15713",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4ODczMDEwNA==",
      "updated_at" : "2019-05-02T15:58:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/488730104",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/23310655?v=4",
         "events_url" : "https://api.github.com/users/ariard/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ariard/followers",
         "following_url" : "https://api.github.com/users/ariard/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ariard/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ariard",
         "id" : 23310655,
         "login" : "ariard",
         "node_id" : "MDQ6VXNlcjIzMzEwNjU1",
         "organizations_url" : "https://api.github.com/users/ariard/orgs",
         "received_events_url" : "https://api.github.com/users/ariard/received_events",
         "repos_url" : "https://api.github.com/users/ariard/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ariard/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ariard/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ariard"
      }
   }
]
