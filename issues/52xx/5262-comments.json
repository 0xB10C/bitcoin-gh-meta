[
   {
      "body" : "We really need a RPC testcase in `qa/rpc-tests` for this. As long as there is no regression test case, an obscure feature like this is bound to stop working.\r\n\r\n",
      "created_at" : "2014-12-05T11:31:00Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5262#issuecomment-65778367",
      "id" : 65778367,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5262",
      "updated_at" : "2014-12-05T11:31:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65778367",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "body" : "Indeed the keep-alive implementation is not working but partial available in the code.\r\nI try to write some http keep-alive rpc-tests and finish/fix the implementation.",
      "created_at" : "2014-12-05T12:52:19Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5262#issuecomment-65785805",
      "id" : 65785805,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5262",
      "updated_at" : "2014-12-05T12:52:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65785805",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "I checked the whole http handling.\r\nThe RPC server does correctly handles persistent connection (according to http 1.1). The RPC server can handle multiple requests/responses within the same http connection.\r\nI wrote a rcp-test for this, but it's probably not worth committing to the core.\r\n\r\n@zenixls2 \r\nI cannot follow your reported issue. I saw that the bitcoin-cli utility is not able to process multiple http requests/responses in the same http-connection. But obviously this also not necessary for the bitcoin-cli app itself (one app-run executes one rpc call). As a http-client there is no need in bitcoin-core to support a persistent (keep-alive) connection.\r\nIt would need some effort to make the internals (`Object CallRPC(const string& strMethod, const Array& params)` http-persistent-keep-alive-conform. IMO there is no need for this, but feel free to contribute this in a PR.\r\n\r\nIMO: issue can be close.",
      "created_at" : "2014-12-06T20:45:16Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5262#issuecomment-65913147",
      "id" : 65913147,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5262",
      "updated_at" : "2014-12-06T20:45:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65913147",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "@jonasschnelli There was at least one bug in the past related to keep-alive in the HTTP server.  I think it would be worth it to commit the test, as long as you have written it.\r\n",
      "created_at" : "2014-12-06T21:04:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5262#issuecomment-65913850",
      "id" : 65913850,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5262",
      "updated_at" : "2014-12-06T21:04:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65913850",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/494411?v=3",
         "events_url" : "https://api.github.com/users/jgarzik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jgarzik/followers",
         "following_url" : "https://api.github.com/users/jgarzik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jgarzik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jgarzik",
         "id" : 494411,
         "login" : "jgarzik",
         "organizations_url" : "https://api.github.com/users/jgarzik/orgs",
         "received_events_url" : "https://api.github.com/users/jgarzik/received_events",
         "repos_url" : "https://api.github.com/users/jgarzik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jgarzik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jgarzik"
      }
   },
   {
      "body" : "here we go: #5436",
      "created_at" : "2014-12-06T22:15:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5262#issuecomment-65916319",
      "id" : 65916319,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5262",
      "updated_at" : "2014-12-06T22:15:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65916319",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "I wonder if we ought to be disabling keep-alive support as long as idle connections prevent new ones from working (by tying up a RPC thread)?",
      "created_at" : "2014-12-06T22:26:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5262#issuecomment-65916681",
      "id" : 65916681,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5262",
      "updated_at" : "2014-12-06T22:26:28Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65916681",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "The magic keyword for that would be \"timeout\". Apaches default timeout is 15s. That would also be feasible for bitcoind.\r\nI never checked the timeout behavior.\r\n\r\nDisabling keep-alive could harm heavy rpc and REST user. Because it gives the possible to do more queries with less resources.\r\n\r\nZombi-Ideling connections are only there becaus of wrong client implementation. A client needs to close the connection at the end.\r\nWe don't have the unknown browser situation so we should expect the rpc clients work as expected and close connections at the end.",
      "created_at" : "2014-12-07T07:24:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5262#issuecomment-65929288",
      "id" : 65929288,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5262",
      "updated_at" : "2014-12-07T07:24:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/65929288",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   },
   {
      "body" : "Thanks for testing @jonasschnelli ! Closing this.\r\n\r\nI don't agree with disabling keep-alive by default. It's up to the user (and those delegated to w/ -rpcallow) to use the RPC server responsibly, if he wants to run a slowloris attack against it to hold up threads, so be it.\r\n",
      "created_at" : "2014-12-08T08:23:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/5262#issuecomment-66036681",
      "id" : 66036681,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/5262",
      "updated_at" : "2014-12-08T08:23:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/66036681",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=3",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
