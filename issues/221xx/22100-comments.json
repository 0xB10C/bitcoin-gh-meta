[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21260 (wallet: indicate whether a transaction is in the mempool by danben)\n* #20205 (wallet: Properly support a wallet id by achow101)\n* #15719 (Wallet passive startup by ryanofsky)\n* #14707 ([RPC] Include coinbase transactions in receivedby RPCs by andrewtoth)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2021-05-30T16:05:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22100#issuecomment-851022611",
      "id" : 851022611,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22100",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1MTAyMjYxMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-30T16:05:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/851022611",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22100#discussion_r642592067"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22100"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/642592067"
         }
      },
      "author_association" : "MEMBER",
      "body" : "How come you're able to move `GetCredit` but not `GetDebit`?",
      "commit_id" : "a3f623035a2653049d098f43e55b9e01850cb16c",
      "created_at" : "2021-05-31T16:29:58Z",
      "diff_hunk" : "@@ -677,25 +640,16 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n \n     isminetype IsMine(const CTxDestination& dest) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n     isminetype IsMine(const CScript& script) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n-    isminetype IsMine(const CTxIn& txin) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n     /**\n      * Returns amount of debit if the input matches the\n      * filter, otherwise returns 0\n      */\n     CAmount GetDebit(const CTxIn& txin, const isminefilter& filter) const;\n     isminetype IsMine(const CTxOut& txout) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n-    CAmount GetCredit(const CTxOut& txout, const isminefilter& filter) const;\n-    bool IsChange(const CTxOut& txout) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n-    bool IsChange(const CScript& script) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n-    CAmount GetChange(const CTxOut& txout) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n     bool IsMine(const CTransaction& tx) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n     /** should probably be renamed to IsRelevantToMe */\n     bool IsFromMe(const CTransaction& tx) const;\n     CAmount GetDebit(const CTransaction& tx, const isminefilter& filter) const;\n-    /** Returns whether all of the inputs match the filter */\n-    bool IsAllFromMe(const CTransaction& tx, const isminefilter& filter) const;\n-    CAmount GetCredit(const CTransaction& tx, const isminefilter& filter) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22100#discussion_r642592067",
      "id" : 642592067,
      "line" : 697,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0MjU5MjA2Nw==",
      "original_commit_id" : "a3f623035a2653049d098f43e55b9e01850cb16c",
      "original_line" : 697,
      "original_position" : 191,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : 191,
      "pull_request_review_id" : 672442046,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22100",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-05-31T16:50:19Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/642592067",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/10217?v=4",
         "events_url" : "https://api.github.com/users/Sjors/events{/privacy}",
         "followers_url" : "https://api.github.com/users/Sjors/followers",
         "following_url" : "https://api.github.com/users/Sjors/following{/other_user}",
         "gists_url" : "https://api.github.com/users/Sjors/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/Sjors",
         "id" : 10217,
         "login" : "Sjors",
         "node_id" : "MDQ6VXNlcjEwMjE3",
         "organizations_url" : "https://api.github.com/users/Sjors/orgs",
         "received_events_url" : "https://api.github.com/users/Sjors/received_events",
         "repos_url" : "https://api.github.com/users/Sjors/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/Sjors/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/Sjors"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22100#discussion_r642612870"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22100"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/642612870"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "re: https://github.com/bitcoin/bitcoin/pull/22100#discussion_r642592067\r\n\r\n> How come you're able to move `GetCredit` but not `GetDebit`?\r\n\r\nI would like to move it, but it's kept in place for now to avoid circular dependencies. The problem is that the `CWallet::SyncTransaction` method needs to call `CWallet::AddToWalletIfInvolvingMe` which needs to call `CWallet::IsFromMe` which needs to call `CWallet::GetDebit`. These functions can't be moved out of `wallet.cpp` to `receive.cpp`, because `wallet.cpp` can't depend on `receive.cpp` (by design, higher level `receive.cpp` `spend.cpp` and a future `sync.cpp` are all meant to depend on the lower level `wallet.cpp` `CWallet` object).\r\n\r\nI think a future fix for this will move `CWallet::SyncTransaction` along with chain attach and rescan code from `wallet.cpp` to `sync.cpp`. It should then be no problem for `sync.cpp` to depend on `receive.cpp` and for `CWallet::AddToWalletIfInvolvingMe` and related code to move to `receive.cpp`. The reason I didn't create `sync.cpp` and move these things already is that I was waiting for #20773 to split up the monolithic `CWallet::Create` function to make this easier.",
      "commit_id" : "a3f623035a2653049d098f43e55b9e01850cb16c",
      "created_at" : "2021-05-31T17:30:05Z",
      "diff_hunk" : "@@ -677,25 +640,16 @@ class CWallet final : public WalletStorage, public interfaces::Chain::Notificati\n \n     isminetype IsMine(const CTxDestination& dest) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n     isminetype IsMine(const CScript& script) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n-    isminetype IsMine(const CTxIn& txin) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n     /**\n      * Returns amount of debit if the input matches the\n      * filter, otherwise returns 0\n      */\n     CAmount GetDebit(const CTxIn& txin, const isminefilter& filter) const;\n     isminetype IsMine(const CTxOut& txout) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n-    CAmount GetCredit(const CTxOut& txout, const isminefilter& filter) const;\n-    bool IsChange(const CTxOut& txout) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n-    bool IsChange(const CScript& script) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n-    CAmount GetChange(const CTxOut& txout) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n     bool IsMine(const CTransaction& tx) const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\n     /** should probably be renamed to IsRelevantToMe */\n     bool IsFromMe(const CTransaction& tx) const;\n     CAmount GetDebit(const CTransaction& tx, const isminefilter& filter) const;\n-    /** Returns whether all of the inputs match the filter */\n-    bool IsAllFromMe(const CTransaction& tx, const isminefilter& filter) const;\n-    CAmount GetCredit(const CTransaction& tx, const isminefilter& filter) const;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22100#discussion_r642612870",
      "id" : 642612870,
      "in_reply_to_id" : 642592067,
      "line" : 697,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0MjYxMjg3MA==",
      "original_commit_id" : "a3f623035a2653049d098f43e55b9e01850cb16c",
      "original_line" : 697,
      "original_position" : 191,
      "original_start_line" : null,
      "path" : "src/wallet/wallet.h",
      "position" : 191,
      "pull_request_review_id" : 672466425,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22100",
      "side" : "LEFT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-05-31T17:53:35Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/642612870",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   }
]
