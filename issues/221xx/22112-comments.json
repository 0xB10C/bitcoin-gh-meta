[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "TODO: see if something has to be done about this assert:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/8462cd56010a8beadf95d4f3cb1357ca9d88493b/src/bench/addrman.cpp#L91",
      "created_at" : "2021-05-31T16:34:32Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22112#issuecomment-851589805",
      "id" : 851589805,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22112",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1MTU4OTgwNQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-31T16:34:32Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/851589805",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I think that's just a way to test that the returned address object isn't empty. Should probably replace it with another test.",
      "created_at" : "2021-05-31T16:36:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22112#issuecomment-851590531",
      "id" : 851590531,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22112",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1MTU5MDUzMQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-05-31T16:36:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/851590531",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, earlier I was convinced it would be better to get rid of ports completely for I2P, but at the time I thought it didn't exist as a concept there. I was unaware that the concept *does* exists for newer versions of the protocol.\r\n\r\nThis is more forward compatible with future versions of `i2pd` and new SAM protocol, so seems better to me.",
      "created_at" : "2021-06-02T15:51:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22112#issuecomment-853143208",
      "id" : 853143208,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22112",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1MzE0MzIwOA==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-02T15:52:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/853143208",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22112#discussion_r644216009"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22112"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/644216009"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think this is exactly what we want. As (with SAM 3.1) we're unable to connect to anything except port 0 (from the perspective of later versions), shouldn't this equally bias away from port 0, as we bias away from the default port for other networks?\r\n\r\nIn other words: maybe this can be done a bit cleaner by having a network-dependent default port, which is 0 for I2P and the normal port for everything else?",
      "commit_id" : "4401bb56cf3822950b221c3fa47fb0b65312d12f",
      "created_at" : "2021-06-02T18:22:23Z",
      "diff_hunk" : "@@ -2019,8 +2019,9 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             // from advertising themselves as a service on another host and\n             // port, causing a DoS attack as nodes around the network attempt\n             // to connect to it fruitlessly.\n-            if (addr.GetPort() != Params().GetDefaultPort() && nTries < 50)\n+            if (!addr.IsI2P() && addr.GetPort() != Params().GetDefaultPort() && nTries < 50) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22112#discussion_r644216009",
      "id" : 644216009,
      "line" : 2022,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NDIxNjAwOQ==",
      "original_commit_id" : "4401bb56cf3822950b221c3fa47fb0b65312d12f",
      "original_line" : 2022,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 5,
      "pull_request_review_id" : 674541400,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22112",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-02T18:22:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/644216009",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/22112#discussion_r644694720"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22112"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/644694720"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I think the limitation of only being able to connect to ports that equal 0 is purely internal to the I2P code - it depends on the SAM version being used and higher level code shouldn't care about that or be aware of it. So I planted the refuse-to-connect-to-non-zero-ports [check in i2p.cpp](https://github.com/bitcoin/bitcoin/pull/22112/commits/4401bb56cf3822950b221c3fa47fb0b65312d12f#diff-8945a03581b372d674f34dcb6a63e537343e376ebcd9d8c7c3d94d4366cd9b9dR175-R180).\r\n\r\nThis allows some day to remove that by only modifying `i2p.cpp` - easier, compared to if this knowledge is spilled in other modules.\r\n\r\nA network-dependent default port seems like an unnecessary generalization to me because it is only relevant for I2P. If there was at least one other network that used !=8333 default port, then it would be more appealing :)\r\n\r\nOff-scope: I think this entire `if` should be removed.",
      "commit_id" : "4401bb56cf3822950b221c3fa47fb0b65312d12f",
      "created_at" : "2021-06-03T10:56:51Z",
      "diff_hunk" : "@@ -2019,8 +2019,9 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             // from advertising themselves as a service on another host and\n             // port, causing a DoS attack as nodes around the network attempt\n             // to connect to it fruitlessly.\n-            if (addr.GetPort() != Params().GetDefaultPort() && nTries < 50)\n+            if (!addr.IsI2P() && addr.GetPort() != Params().GetDefaultPort() && nTries < 50) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22112#discussion_r644694720",
      "id" : 644694720,
      "in_reply_to_id" : 644216009,
      "line" : 2022,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY0NDY5NDcyMA==",
      "original_commit_id" : "4401bb56cf3822950b221c3fa47fb0b65312d12f",
      "original_line" : 2022,
      "original_position" : 5,
      "original_start_line" : null,
      "path" : "src/net.cpp",
      "position" : 5,
      "pull_request_review_id" : 675147662,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/22112",
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2021-06-03T10:56:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/644694720",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> ... I was convinced it would be better to get rid of ports completely for I2P, but at the time I thought it didn't exist as a concept there. I was unaware that the concept does exists for newer versions of the protocol.\r\n\r\nMe too!",
      "created_at" : "2021-06-03T10:58:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/22112#issuecomment-853781755",
      "id" : 853781755,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/22112",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDg1Mzc4MTc1NQ==",
      "performed_via_github_app" : null,
      "updated_at" : "2021-06-03T10:58:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/853781755",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/266751?v=4",
         "events_url" : "https://api.github.com/users/vasild/events{/privacy}",
         "followers_url" : "https://api.github.com/users/vasild/followers",
         "following_url" : "https://api.github.com/users/vasild/following{/other_user}",
         "gists_url" : "https://api.github.com/users/vasild/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/vasild",
         "id" : 266751,
         "login" : "vasild",
         "node_id" : "MDQ6VXNlcjI2Njc1MQ==",
         "organizations_url" : "https://api.github.com/users/vasild/orgs",
         "received_events_url" : "https://api.github.com/users/vasild/received_events",
         "repos_url" : "https://api.github.com/users/vasild/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/vasild/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/vasild/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/vasild"
      }
   }
]
