[
   {
      "body" : "Mind fixing that BIP link? 404",
      "created_at" : "2015-06-21T18:28:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-113938242",
      "id" : 113938242,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-06-21T18:28:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/113938242",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Fixed.\n\nOn Sun, Jun 21, 2015 at 11:28 AM, Peter Todd <notifications@github.com>\nwrote:\n\n> Mind fixing that BIP link? 404\n>\n> Ã¢ÂÂ\n> Reply to this email directly or view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-113938242>.\n>\n",
      "created_at" : "2015-06-21T18:39:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-113938911",
      "id" : 113938911,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-06-21T18:39:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/113938911",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "Now again, could you please do up a quick demo example app that actually uses this? e.g. like my https://github.com/petertodd/checklocktimeverify-demos/blob/master/micropayment-channel.py\r\n\r\nDoesn't have to be much, but we really need a worked out example here... Notably, see how without a way to fix tx mutability the nSequence proposal really isn't any different in practice than just signing increasingly decreasing nLockTime's? Because if you could safely sign the transaction it'd already be mined and thus you don't need a relative nSequence - an absolute nLockTime calculated from the height/time of the tx you know already is in the chain is fine.\r\n\r\nIMO there's no reason to merge this until it has a safe use-case that provides a concrete benefit over the existing status quo; a simple change in what exact number is being signed isn't a concrete benefit.",
      "created_at" : "2015-06-22T00:05:23Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-113970979",
      "id" : 113970979,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-06-22T00:05:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/113970979",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "Why doesn' this patch include the code for OP_CHECKSEQUENCEVERIFY?",
      "created_at" : "2015-06-23T20:19:48Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-114630825",
      "id" : 114630825,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-06-23T20:20:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/114630825",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "@btcdrak that code is here:\r\n\r\nhttps://github.com/maaku/bitcoin/tree/checksequenceverify\r\n\r\nIt is entirely separate from what this pull request accomplishes. For example, it is possible to do simple transaction replacement without CHECKSEQUENCEVERIFY, as explained in the BIP. Likewise the source code of the CSV branch does not in fact depend on this pull request -- all CSV does is verify a constraint on the sequence number of the input, it does not depend on that sequence number having consensus-enforced semantics.",
      "created_at" : "2015-06-23T20:38:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-114634773",
      "id" : 114634773,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-06-23T20:38:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/114634773",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "@maaku I think the value of this PR in isolation is limited. You really need the opcode as well. It would be wonderful if you could publish a separate PR+BIP for CSV if you dont wish to combine them.\r\n\r\nCSV is a very useful feature and one I think we clearly need to help address scalability. I see no profit in not getting it on the table now especially since it's been deployed in Elements already and is clearly working.",
      "created_at" : "2015-06-23T22:13:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-114656954",
      "id" : 114656954,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-06-23T22:13:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/114656954",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "I'm working on it. Things take time.\nOn Jun 23, 2015 15:14, \"Ã Â¸Â¿tcDrak\" <notifications@github.com> wrote:\n\n> @maaku <https://github.com/maaku> I think the value of this PR in\n> isolation is limited. You really need the opcode as well. It would be\n> wonderful if you could publish a separate PR+BIP for CSV if you dont wish\n> to combine them.\n>\n> CSV is a very useful feature and one I think we clearly need to help\n> address scalability. I see no profit in not getting it on the table now\n> especially since it's been deployed in Elements already and is clearly\n> working.\n>\n> Ã¢ÂÂ\n> Reply to this email directly or view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-114656954>.\n>\n",
      "created_at" : "2015-06-23T22:21:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-114658497",
      "id" : 114658497,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-06-23T22:21:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/114658497",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r33211341"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33211341"
         }
      },
      "body" : "Probably should call this something other than sequence?",
      "commit_id" : "da272921dd53bd92507427fa1ac20f487cd2ba50",
      "created_at" : "2015-06-24T23:59:09Z",
      "diff_hunk" : "@@ -14,5 +14,7 @@ static const unsigned int MAX_BLOCK_SIGOPS = MAX_BLOCK_SIZE/50;\n static const int COINBASE_MATURITY = 100;\n /** Threshold for nLockTime: below this value it is interpreted as block number, otherwise as UNIX timestamp. */\n static const unsigned int LOCKTIME_THRESHOLD = 500000000; // Tue Nov  5 00:53:20 1985 UTC\n+/** Threshold for inverted CTxIn::nSequence: below this value it is interpreted as a relative lock-time, otherwise ignored. */\n+static const uint32_t SEQUENCE_THRESHOLD = (1 << 31);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r33211341",
      "id" : 33211341,
      "original_commit_id" : "856081c2b69027287660b099722af855f1cf1c1f",
      "original_position" : 5,
      "path" : "src/consensus/consensus.h",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312",
      "updated_at" : "2015-08-18T01:31:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33211341",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r33211350"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33211350"
         }
      },
      "body" : "IsFinalTx was a better name IMO.",
      "commit_id" : "da272921dd53bd92507427fa1ac20f487cd2ba50",
      "created_at" : "2015-06-24T23:59:21Z",
      "diff_hunk" : "@@ -673,22 +673,110 @@ bool IsStandardTx(const CTransaction& tx, string& reason)\n     return true;\n }\n \n-bool IsFinalTx(const CTransaction &tx, int nBlockHeight, int64_t nBlockTime)\n+int64_t LockTime(const CTransaction &tx, int flags, const CCoinsView* pCoinsView, int nBlockHeight, int64_t nBlockTime)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r33211350",
      "id" : 33211350,
      "original_commit_id" : "856081c2b69027287660b099722af855f1cf1c1f",
      "original_position" : 5,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312",
      "updated_at" : "2015-08-18T01:31:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33211350",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r33322311"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33322311"
         }
      },
      "body" : "The version check is in LockTime already, so redundant here...",
      "commit_id" : "da272921dd53bd92507427fa1ac20f487cd2ba50",
      "created_at" : "2015-06-26T01:31:35Z",
      "diff_hunk" : "@@ -969,6 +1050,19 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n         view.SetBackend(dummy);\n         }\n \n+        // Enforce sequnce numbers as relative lock-time\n+        // only for tx.nVersion >= 2.\n+        int nLockTimeFlags = 0;\n+        if (tx.nVersion >= 2)\n+            nLockTimeFlags |= LOCKTIME_VERIFY_SEQUENCE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r33322311",
      "id" : 33322311,
      "original_commit_id" : "856081c2b69027287660b099722af855f1cf1c1f",
      "original_position" : 144,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312",
      "updated_at" : "2015-08-18T01:31:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33322311",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r33322326"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33322326"
         }
      },
      "body" : "Perhaps STANDARD_LOCKTIME_VERIFY_FLAGS instead of nLockTimeFlags?",
      "commit_id" : "da272921dd53bd92507427fa1ac20f487cd2ba50",
      "created_at" : "2015-06-26T01:32:11Z",
      "diff_hunk" : "@@ -969,6 +1050,19 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n         view.SetBackend(dummy);\n         }\n \n+        // Enforce sequnce numbers as relative lock-time\n+        // only for tx.nVersion >= 2.\n+        int nLockTimeFlags = 0;\n+        if (tx.nVersion >= 2)\n+            nLockTimeFlags |= LOCKTIME_VERIFY_SEQUENCE;\n+\n+        // Only accept nLockTime-using transactions that can be mined in the next\n+        // block; we don't want our mempool filled up with transactions that can't\n+        // be mined yet.\n+        if (LockTime(tx, nLockTimeFlags, &view, chainActive.Height() + 1, GetAdjustedTime()))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r33322326",
      "id" : 33322326,
      "original_commit_id" : "856081c2b69027287660b099722af855f1cf1c1f",
      "original_position" : 149,
      "path" : "src/main.cpp",
      "position" : 148,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312",
      "updated_at" : "2015-08-18T01:31:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33322326",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r33322335"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33322335"
         }
      },
      "body" : "The version check is in LockTime already, so redundant here...",
      "commit_id" : "da272921dd53bd92507427fa1ac20f487cd2ba50",
      "created_at" : "2015-06-26T01:32:26Z",
      "diff_hunk" : "@@ -153,7 +159,14 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n              mi != mempool.mapTx.end(); ++mi)\n         {\n             const CTransaction& tx = mi->second.GetTx();\n-            if (tx.IsCoinBase() || !IsFinalTx(tx, nHeight, pblock->nTime))\n+\n+            // Enforce sequnce numbers as relative lock-time\n+            // only for tx.nVersion >= 2.\n+            int nLockTimeFlags = 0;\n+            if (tx.nVersion >= 2)\n+                nLockTimeFlags |= LOCKTIME_VERIFY_SEQUENCE;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r33322335",
      "id" : 33322335,
      "original_commit_id" : "856081c2b69027287660b099722af855f1cf1c1f",
      "original_position" : 32,
      "path" : "src/miner.cpp",
      "position" : 10,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312",
      "updated_at" : "2015-08-18T01:31:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33322335",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "needs rebase",
      "created_at" : "2015-08-04T22:50:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-127784773",
      "id" : 127784773,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-08-04T22:50:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/127784773",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "Rebased.",
      "created_at" : "2015-08-12T06:39:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-130186849",
      "id" : 130186849,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-08-12T06:39:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/130186849",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r37031834"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/37031834"
         }
      },
      "body" : "`s/sequnce/sequence`",
      "commit_id" : "da272921dd53bd92507427fa1ac20f487cd2ba50",
      "created_at" : "2015-08-13T22:10:46Z",
      "diff_hunk" : "@@ -860,6 +942,18 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n         view.SetBackend(dummy);\n         }\n \n+        // Enforce sequnce numbers as relative lock-time",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r37031834",
      "id" : 37031834,
      "original_commit_id" : "b011af6c551585e03a8575e3cc9e87d02472fba5",
      "original_position" : 139,
      "path" : "src/main.cpp",
      "position" : null,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312",
      "updated_at" : "2015-08-18T01:31:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/37031834",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "concept ACK",
      "created_at" : "2015-08-13T22:14:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-130863975",
      "id" : 130863975,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-08-13T22:14:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/130863975",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "body" : "Refs #6564",
      "created_at" : "2015-08-17T19:28:44Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-131936872",
      "id" : 131936872,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-08-17T19:28:44Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/131936872",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7275704?v=3",
         "events_url" : "https://api.github.com/users/btcdrak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/btcdrak/followers",
         "following_url" : "https://api.github.com/users/btcdrak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/btcdrak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/btcdrak",
         "id" : 7275704,
         "login" : "btcdrak",
         "organizations_url" : "https://api.github.com/users/btcdrak/orgs",
         "received_events_url" : "https://api.github.com/users/btcdrak/received_events",
         "repos_url" : "https://api.github.com/users/btcdrak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/btcdrak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/btcdrak"
      }
   },
   {
      "body" : "Agreed with @petertodd that this is fairly pointless without BIP-62 (malleability), but I do want both for lightning.\r\n\r\n(I also note that we should in future detach the locktime field from requiring non-FFFFFFFF nSequence; they're completely orthogonal AFAICT.  But that's a minor soft-fork.)",
      "created_at" : "2015-08-18T00:18:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-132002885",
      "id" : 132002885,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-08-18T00:18:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/132002885",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/775844?v=3",
         "events_url" : "https://api.github.com/users/rustyrussell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/rustyrussell/followers",
         "following_url" : "https://api.github.com/users/rustyrussell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/rustyrussell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/rustyrussell",
         "id" : 775844,
         "login" : "rustyrussell",
         "organizations_url" : "https://api.github.com/users/rustyrussell/orgs",
         "received_events_url" : "https://api.github.com/users/rustyrussell/received_events",
         "repos_url" : "https://api.github.com/users/rustyrussell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/rustyrussell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/rustyrussell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/rustyrussell"
      }
   },
   {
      "body" : "@petertodd isn't the point of this that it is relative?  That is,  I don't need to know what block the first transaction is in,  nor the follow up transactions?\r\nBut I know that they will be (at least) no less than `nSequence` apart?",
      "created_at" : "2015-08-18T00:28:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-132004029",
      "id" : 132004029,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-08-18T00:28:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/132004029",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r37256672"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/37256672"
         }
      },
      "body" : "Took me a while to see what you're suggestion, but I agree. I'll rework it to be a policy.h option.",
      "commit_id" : "da272921dd53bd92507427fa1ac20f487cd2ba50",
      "created_at" : "2015-08-18T01:34:37Z",
      "diff_hunk" : "@@ -969,6 +1050,19 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n         view.SetBackend(dummy);\n         }\n \n+        // Enforce sequnce numbers as relative lock-time\n+        // only for tx.nVersion >= 2.\n+        int nLockTimeFlags = 0;\n+        if (tx.nVersion >= 2)\n+            nLockTimeFlags |= LOCKTIME_VERIFY_SEQUENCE;\n+\n+        // Only accept nLockTime-using transactions that can be mined in the next\n+        // block; we don't want our mempool filled up with transactions that can't\n+        // be mined yet.\n+        if (LockTime(tx, nLockTimeFlags, &view, chainActive.Height() + 1, GetAdjustedTime()))",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#discussion_r37256672",
      "id" : 37256672,
      "original_commit_id" : "856081c2b69027287660b099722af855f1cf1c1f",
      "original_position" : 149,
      "path" : "src/main.cpp",
      "position" : 148,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6312",
      "updated_at" : "2015-08-18T01:34:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/37256672",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "@rustyrussell @petertodd : what relative lock-time gives you is a committed response window to a proof-of-publication. With CHECKSEQUENCEVERIFY (#6564) there is indeed some features you can get that in some situations aren't just replicatable with CHECKLOCKTIMEVERIFY. However the most exciting use cases also require something additional still. In the case of lightning, not just BIP 62, but some sort of normative txid.\r\n\r\n@dcousens I believe @petertodd's point is that since all the inputs are already on the block chain, you can just set nLockTime to the confirmed age of the input + the relative lock-time. And if the inputs are not all confirmed, then you are building chains of transactions that aren't safe due to malleability. So really this is a feature that becomes most useful when we have a definitive fix for malleability, which we will in the not so distant future.",
      "created_at" : "2015-08-18T01:42:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-132024558",
      "id" : 132024558,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-08-18T01:42:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/132024558",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/69154?v=3",
         "events_url" : "https://api.github.com/users/maaku/events{/privacy}",
         "followers_url" : "https://api.github.com/users/maaku/followers",
         "following_url" : "https://api.github.com/users/maaku/following{/other_user}",
         "gists_url" : "https://api.github.com/users/maaku/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/maaku",
         "id" : 69154,
         "login" : "maaku",
         "organizations_url" : "https://api.github.com/users/maaku/orgs",
         "received_events_url" : "https://api.github.com/users/maaku/received_events",
         "repos_url" : "https://api.github.com/users/maaku/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/maaku/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/maaku/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/maaku"
      }
   },
   {
      "body" : "Yup, my objection was a somewhat pedantic point of process; now that CSV has been proposed it's moot objection.\n\nWill review all this stuff soon FWIW, travelling right now... Per usual. :/\n\nOn 17 August 2015 18:43:33 GMT-07:00, Mark Friedenbach <notifications@github.com> wrote:\n>@rustyrussell @petertodd : what relative lock-time gives you is a\n>committed response window to a proof-of-publication. With\n>CHECKSEQUENCEVERIFY (#6564) there is indeed some features you can get\n>that in some situations aren't just replicatable with\n>CHECKLOCKTIMEVERIFY. However the most exciting use cases also require\n>something additional still. In the case of lightning, not just BIP 62,\n>but some sort of normative txid.\n>\n>@dcousens I believe @petertodd's point is that since all the inputs are\n>already on the block chain, you can just set nLockTime to the confirmed\n>age of the input + the relative lock-time. And if the inputs are not\n>all confirmed, then you are building chains of transactions that aren't\n>safe due to malleability. So really this is a feature that becomes most\n>useful when we have a definitive fix for malleability, which we will in\n>the not so distant future.\n>\n>---\n>Reply to this email directly or view it on GitHub:\n>https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-132024558\n\n",
      "created_at" : "2015-08-18T01:57:13Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-132028861",
      "id" : 132028861,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-08-18T01:57:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/132028861",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/7042?v=3",
         "events_url" : "https://api.github.com/users/petertodd/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petertodd/followers",
         "following_url" : "https://api.github.com/users/petertodd/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petertodd/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petertodd",
         "id" : 7042,
         "login" : "petertodd",
         "organizations_url" : "https://api.github.com/users/petertodd/orgs",
         "received_events_url" : "https://api.github.com/users/petertodd/received_events",
         "repos_url" : "https://api.github.com/users/petertodd/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petertodd/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petertodd"
      }
   },
   {
      "body" : "> And if the inputs are not all confirmed, then you are building chains of transactions that aren't safe due to malleability.\r\n\r\nRight,  thanks for clearing that up @maaku :)",
      "created_at" : "2015-08-18T02:23:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6312#issuecomment-132039404",
      "id" : 132039404,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6312",
      "updated_at" : "2015-08-18T02:23:59Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/132039404",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/413395?v=3",
         "events_url" : "https://api.github.com/users/dcousens/events{/privacy}",
         "followers_url" : "https://api.github.com/users/dcousens/followers",
         "following_url" : "https://api.github.com/users/dcousens/following{/other_user}",
         "gists_url" : "https://api.github.com/users/dcousens/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/dcousens",
         "id" : 413395,
         "login" : "dcousens",
         "organizations_url" : "https://api.github.com/users/dcousens/orgs",
         "received_events_url" : "https://api.github.com/users/dcousens/received_events",
         "repos_url" : "https://api.github.com/users/dcousens/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/dcousens/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/dcousens"
      }
   }
]
