[
   {
      "body" : "FIXME: allow more than one OP_RETURN on testnet and regtest according to chain params.\r\n",
      "created_at" : "2015-06-27T15:02:17Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6346#issuecomment-116083536",
      "id" : 116083536,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6346",
      "updated_at" : "2015-06-27T15:02:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/116083536",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6848764?v=3",
         "events_url" : "https://api.github.com/users/paveljanik/events{/privacy}",
         "followers_url" : "https://api.github.com/users/paveljanik/followers",
         "following_url" : "https://api.github.com/users/paveljanik/following{/other_user}",
         "gists_url" : "https://api.github.com/users/paveljanik/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/paveljanik",
         "id" : 6848764,
         "login" : "paveljanik",
         "organizations_url" : "https://api.github.com/users/paveljanik/orgs",
         "received_events_url" : "https://api.github.com/users/paveljanik/received_events",
         "repos_url" : "https://api.github.com/users/paveljanik/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/paveljanik/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/paveljanik"
      }
   },
   {
      "body" : "OP_RETURN <data> transactions are relayed in order to minimize harm to the network. Do you think this change will convert people from UTXO spam to the less-bad OP_RETURN spam, or will it just make it easier for non-spammers to start spamming? I have a feeling it's the latter unfortunately.",
      "created_at" : "2015-06-27T16:24:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6346#issuecomment-116093115",
      "id" : 116093115,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6346",
      "updated_at" : "2015-06-27T16:24:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/116093115",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2560255?v=3",
         "events_url" : "https://api.github.com/users/lapp0/events{/privacy}",
         "followers_url" : "https://api.github.com/users/lapp0/followers",
         "following_url" : "https://api.github.com/users/lapp0/following{/other_user}",
         "gists_url" : "https://api.github.com/users/lapp0/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/lapp0",
         "id" : 2560255,
         "login" : "lapp0",
         "organizations_url" : "https://api.github.com/users/lapp0/orgs",
         "received_events_url" : "https://api.github.com/users/lapp0/received_events",
         "repos_url" : "https://api.github.com/users/lapp0/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/lapp0/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/lapp0/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/lapp0"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6346#discussion_r33414547"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6346"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33414547"
         }
      },
      "body" : "Key probably should be named \"commitment\" or \"data\", not \"OP_RETURN\" (which is just a technical implementation detail).",
      "commit_id" : "8f7a99b59897227b1359fe7fb104113b629237f9",
      "created_at" : "2015-06-27T17:51:08Z",
      "diff_hunk" : "@@ -334,12 +334,18 @@ UniValue createrawtransaction(const UniValue& params, bool fHelp)\n             \"      ,...\\n\"\n             \"    }\\n\"\n \n+            \"\\n\"\n+            \"    If you want to create OP_RETURN output instead of an address output, entries should be in the following format:\\n\"\n+            \"\\n\"\n+            \"      \\\"OP_RETURN\\\": \\\"hex\\\" (string, required) The key is \\\"OP_RETURN\\\", the value is hex encoded data\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6346#discussion_r33414547",
      "id" : 33414547,
      "original_commit_id" : "8f7a99b59897227b1359fe7fb104113b629237f9",
      "original_position" : 7,
      "path" : "src/rpcrawtransaction.cpp",
      "position" : 7,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6346",
      "updated_at" : "2015-06-27T17:51:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33414547",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6346#discussion_r33414553"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6346"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33414553"
         }
      },
      "body" : "Prefer expounding on the proper use cases here to avoid people getting the impression it should be used incorrectly.",
      "commit_id" : "8f7a99b59897227b1359fe7fb104113b629237f9",
      "created_at" : "2015-06-27T17:51:45Z",
      "diff_hunk" : "@@ -334,12 +334,18 @@ UniValue createrawtransaction(const UniValue& params, bool fHelp)\n             \"      ,...\\n\"\n             \"    }\\n\"\n \n+            \"\\n\"\n+            \"    If you want to create OP_RETURN output instead of an address output, entries should be in the following format:\\n\"",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6346#discussion_r33414553",
      "id" : 33414553,
      "original_commit_id" : "8f7a99b59897227b1359fe7fb104113b629237f9",
      "original_position" : 5,
      "path" : "src/rpcrawtransaction.cpp",
      "position" : 5,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6346",
      "updated_at" : "2015-06-27T17:51:45Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33414553",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6346#discussion_r33414558"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6346"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33414558"
         }
      },
      "body" : "createrawtransaction shouldn't enforce policy.",
      "commit_id" : "8f7a99b59897227b1359fe7fb104113b629237f9",
      "created_at" : "2015-06-27T17:52:21Z",
      "diff_hunk" : "@@ -369,20 +375,36 @@ UniValue createrawtransaction(const UniValue& params, bool fHelp)\n \n     set<CBitcoinAddress> setAddress;\n     vector<string> addrList = sendTo.getKeys();\n+    bool fOpReturnFound = false;\n     BOOST_FOREACH(const string& name_, addrList) {\n-        CBitcoinAddress address(name_);\n-        if (!address.IsValid())\n-            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, string(\"Invalid Bitcoin address: \")+name_);\n \n-        if (setAddress.count(address))\n-            throw JSONRPCError(RPC_INVALID_PARAMETER, string(\"Invalid parameter, duplicated address: \")+name_);\n-        setAddress.insert(address);\n+        if (name_ == \"OP_RETURN\") {\n+\t    if (fOpReturnFound)\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, string(\"Only one OP_RETURN transaction output permitted\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6346#discussion_r33414558",
      "id" : 33414558,
      "original_commit_id" : "8f7a99b59897227b1359fe7fb104113b629237f9",
      "original_position" : 34,
      "path" : "src/rpcrawtransaction.cpp",
      "position" : 34,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6346",
      "updated_at" : "2015-06-27T17:52:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33414558",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/6346#discussion_r33414567"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6346"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33414567"
         }
      },
      "body" : "Again, policy. Although maybe okay if you use nMaxDatacarrierBytes instead.",
      "commit_id" : "8f7a99b59897227b1359fe7fb104113b629237f9",
      "created_at" : "2015-06-27T17:53:07Z",
      "diff_hunk" : "@@ -369,20 +375,36 @@ UniValue createrawtransaction(const UniValue& params, bool fHelp)\n \n     set<CBitcoinAddress> setAddress;\n     vector<string> addrList = sendTo.getKeys();\n+    bool fOpReturnFound = false;\n     BOOST_FOREACH(const string& name_, addrList) {\n-        CBitcoinAddress address(name_);\n-        if (!address.IsValid())\n-            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, string(\"Invalid Bitcoin address: \")+name_);\n \n-        if (setAddress.count(address))\n-            throw JSONRPCError(RPC_INVALID_PARAMETER, string(\"Invalid parameter, duplicated address: \")+name_);\n-        setAddress.insert(address);\n+        if (name_ == \"OP_RETURN\") {\n+\t    if (fOpReturnFound)\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, string(\"Only one OP_RETURN transaction output permitted\"));\n+\t    fOpReturnFound = true;\n \n-        CScript scriptPubKey = GetScriptForDestination(address.Get());\n-        CAmount nAmount = AmountFromValue(sendTo[name_]);\n+            std::vector<unsigned char> data = ParseHexV(sendTo[name_].getValStr(),\"OP_RETURN data\");\n \n-        CTxOut out(nAmount, scriptPubKey);\n-        rawTx.vout.push_back(out);\n+            if (data.size() > MAX_OP_RETURN_RELAY)\n+                throw JSONRPCError(RPC_INVALID_PARAMETER, string(\"OP_RETURN data too long\"));",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6346#discussion_r33414567",
      "id" : 33414567,
      "original_commit_id" : "8f7a99b59897227b1359fe7fb104113b629237f9",
      "original_position" : 44,
      "path" : "src/rpcrawtransaction.cpp",
      "position" : 44,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/6346",
      "updated_at" : "2015-06-27T17:53:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/33414567",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "To address @lapp0 's concern, I'd recommend instead focussing on doing this in bitcoin-tx, or even more ideal, beginning work on a tx utility library (that bitcoin-tx would wrap).",
      "created_at" : "2015-06-27T17:55:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6346#issuecomment-116109053",
      "id" : 116109053,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6346",
      "updated_at" : "2015-06-27T17:55:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/116109053",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1095675?v=3",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "body" : "Nice work!\r\nBut i also agree with @luke-jr. Best would be to add OP_RETURN support to `bitcoin-tx`. Together with now merged `fundrawtransaction` this would make sense. There it would be good to avoid policy and support multiple OP_RETURN outputs.",
      "created_at" : "2015-06-27T18:45:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/6346#issuecomment-116116041",
      "id" : 116116041,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/6346",
      "updated_at" : "2015-06-27T18:45:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/116116041",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/178464?v=3",
         "events_url" : "https://api.github.com/users/jonasschnelli/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonasschnelli/followers",
         "following_url" : "https://api.github.com/users/jonasschnelli/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonasschnelli",
         "id" : 178464,
         "login" : "jonasschnelli",
         "organizations_url" : "https://api.github.com/users/jonasschnelli/orgs",
         "received_events_url" : "https://api.github.com/users/jonasschnelli/received_events",
         "repos_url" : "https://api.github.com/users/jonasschnelli/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonasschnelli/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonasschnelli"
      }
   }
]
