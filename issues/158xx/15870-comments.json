[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK.\r\n\r\nThere is an argument against doing things like this:  that it's better to fail deterministically rather than fail randomly at some point in the future and have created incorrect expectations of functionality.  But setting prune to some large \"future\" amount is a perfectly reasonable configuration.  And this doesn't cause it to fail randomly, but rather work until it doesn't.  So I don't believe the general argument against this sort of thing offsets the benefit.",
      "created_at" : "2019-04-22T18:44:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-485509311",
      "id" : 485509311,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTUwOTMxMQ==",
      "updated_at" : "2019-04-22T18:44:06Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485509311",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/858454?v=4",
         "events_url" : "https://api.github.com/users/gmaxwell/events{/privacy}",
         "followers_url" : "https://api.github.com/users/gmaxwell/followers",
         "following_url" : "https://api.github.com/users/gmaxwell/following{/other_user}",
         "gists_url" : "https://api.github.com/users/gmaxwell/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/gmaxwell",
         "id" : 858454,
         "login" : "gmaxwell",
         "node_id" : "MDQ6VXNlcjg1ODQ1NA==",
         "organizations_url" : "https://api.github.com/users/gmaxwell/orgs",
         "received_events_url" : "https://api.github.com/users/gmaxwell/received_events",
         "repos_url" : "https://api.github.com/users/gmaxwell/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/gmaxwell/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/gmaxwell"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "This seems to affect importaddress, importpubkey, importprivkey, and importwallet but not importmulti. I wonder how the new behavior compares to importmulti behavior, and if there's a difference, whether that's justified.",
      "created_at" : "2019-04-22T19:16:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-485519649",
      "id" : 485519649,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTUxOTY0OQ==",
      "updated_at" : "2019-04-22T19:16:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485519649",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/7133040?v=4",
         "events_url" : "https://api.github.com/users/ryanofsky/events{/privacy}",
         "followers_url" : "https://api.github.com/users/ryanofsky/followers",
         "following_url" : "https://api.github.com/users/ryanofsky/following{/other_user}",
         "gists_url" : "https://api.github.com/users/ryanofsky/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/ryanofsky",
         "id" : 7133040,
         "login" : "ryanofsky",
         "node_id" : "MDQ6VXNlcjcxMzMwNDA=",
         "organizations_url" : "https://api.github.com/users/ryanofsky/orgs",
         "received_events_url" : "https://api.github.com/users/ryanofsky/received_events",
         "repos_url" : "https://api.github.com/users/ryanofsky/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/ryanofsky/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/ryanofsky"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
      "created_at" : "2019-04-22T19:30:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-485523746",
      "id" : 485523746,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTUyMzc0Ng==",
      "updated_at" : "2019-04-27T15:15:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485523746",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@ryanofsky The only difference between importmulti and the other calls is that in importmulti you can \"opt-out\" of scanning early blocks by setting a later timestamp. Otherwise, my change makes all calls behave in the same way.\r\n\r\nEdit: I believe the only difference is that importmulti will import the keys and then fail the rescan, whereas the other calls will exit early and not attempt to import anything.",
      "created_at" : "2019-04-22T19:34:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-485524753",
      "id" : 485524753,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NTUyNDc1Mw==",
      "updated_at" : "2019-04-22T19:59:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/485524753",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Edit: I believe the only difference is that importmulti will import the keys and then fail the rescan, whereas the other calls will exit early and not attempt to import anything.\r\n\r\nWhy a different behavior? It's already possible to call `importmulti ... '{\"rescan\": false}'` and then `rescanblockchain ...`? I think RPCs should (try to) be atomic so that the client doesn't have to figure out what succeeded or not.",
      "created_at" : "2019-04-24T20:12:51Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-486407340",
      "id" : 486407340,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NjQwNzM0MA==",
      "updated_at" : "2019-04-24T20:12:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/486407340",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Why a different behavior?\r\n\r\nI don't know. I didn't write the importmulti RPC and I don't plan to change it in this pull request.",
      "created_at" : "2019-04-24T20:23:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-486411063",
      "id" : 486411063,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NjQxMTA2Mw==",
      "updated_at" : "2019-04-24T20:23:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/486411063",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r278306246"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278306246"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Move to the chain lock?",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-04-24T20:33:49Z",
      "diff_hunk" : "@@ -326,7 +326,11 @@ class ChainImpl : public Chain\n     CFeeRate relayIncrementalFee() override { return ::incrementalRelayFee; }\n     CFeeRate relayDustFee() override { return ::dustRelayFee; }\n     CAmount maxTxFee() override { return ::maxTxFee; }\n-    bool getPruneMode() override { return ::fPruneMode; }\n+    bool havePruned() override",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r278306246",
      "id" : 278306246,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3ODMwNjI0Ng==",
      "original_commit_id" : "fad84519391a05f2ad42381cca9135323b709657",
      "original_position" : 5,
      "path" : "src/interfaces/chain.cpp",
      "position" : 11,
      "pull_request_review_id" : 230341302,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-03T19:32:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278306246",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r278307845"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278307845"
         }
      },
      "author_association" : "MEMBER",
      "body" : "A block can be pruned before RescanWallet (L202). What would be the error then?",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-04-24T20:38:11Z",
      "diff_hunk" : "@@ -157,8 +157,8 @@ UniValue importprivkey(const JSONRPCRequest& request)\n         if (!request.params[2].isNull())\n             fRescan = request.params[2].get_bool();\n \n-        if (fRescan && pwallet->chain().getPruneMode()) {\n-            throw JSONRPCError(RPC_WALLET_ERROR, \"Rescan is disabled in pruned mode\");\n+        if (fRescan && pwallet->chain().havePruned()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r278307845",
      "id" : 278307845,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3ODMwNzg0NQ==",
      "original_commit_id" : "fad84519391a05f2ad42381cca9135323b709657",
      "original_position" : 6,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 6,
      "pull_request_review_id" : 230341302,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-03T19:32:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278307845",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/3534524?v=4",
         "events_url" : "https://api.github.com/users/promag/events{/privacy}",
         "followers_url" : "https://api.github.com/users/promag/followers",
         "following_url" : "https://api.github.com/users/promag/following{/other_user}",
         "gists_url" : "https://api.github.com/users/promag/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/promag",
         "id" : 3534524,
         "login" : "promag",
         "node_id" : "MDQ6VXNlcjM1MzQ1MjQ=",
         "organizations_url" : "https://api.github.com/users/promag/orgs",
         "received_events_url" : "https://api.github.com/users/promag/received_events",
         "repos_url" : "https://api.github.com/users/promag/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/promag/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/promag/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/promag"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r278315111"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278315111"
         }
      },
      "author_association" : "MEMBER",
      "body" : "It will throw an error `\"Rescan was unable to fully rescan the blockchain. Some transactions may be missing.\"`",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-04-24T20:57:57Z",
      "diff_hunk" : "@@ -157,8 +157,8 @@ UniValue importprivkey(const JSONRPCRequest& request)\n         if (!request.params[2].isNull())\n             fRescan = request.params[2].get_bool();\n \n-        if (fRescan && pwallet->chain().getPruneMode()) {\n-            throw JSONRPCError(RPC_WALLET_ERROR, \"Rescan is disabled in pruned mode\");\n+        if (fRescan && pwallet->chain().havePruned()) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r278315111",
      "id" : 278315111,
      "in_reply_to_id" : 278307845,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3ODMxNTExMQ==",
      "original_commit_id" : "fad84519391a05f2ad42381cca9135323b709657",
      "original_position" : 6,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 6,
      "pull_request_review_id" : 230352707,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-03T19:32:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278315111",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r278315293"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278315293"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Why?",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-04-24T20:58:28Z",
      "diff_hunk" : "@@ -326,7 +326,11 @@ class ChainImpl : public Chain\n     CFeeRate relayIncrementalFee() override { return ::incrementalRelayFee; }\n     CFeeRate relayDustFee() override { return ::dustRelayFee; }\n     CAmount maxTxFee() override { return ::maxTxFee; }\n-    bool getPruneMode() override { return ::fPruneMode; }\n+    bool havePruned() override",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r278315293",
      "id" : 278315293,
      "in_reply_to_id" : 278306246,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3ODMxNTI5Mw==",
      "original_commit_id" : "fad84519391a05f2ad42381cca9135323b709657",
      "original_position" : 5,
      "path" : "src/interfaces/chain.cpp",
      "position" : 11,
      "pull_request_review_id" : 230352946,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-03T19:32:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278315293",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r278316048"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278316048"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Sorry for the brief reply, but see here:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/fad84519391a05f2ad42381cca9135323b709657/src/interfaces/chain.h#L69-L73\r\n\r\nThe chain lock is deprecated and will be removed in the future.",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-04-24T21:00:32Z",
      "diff_hunk" : "@@ -326,7 +326,11 @@ class ChainImpl : public Chain\n     CFeeRate relayIncrementalFee() override { return ::incrementalRelayFee; }\n     CFeeRate relayDustFee() override { return ::dustRelayFee; }\n     CAmount maxTxFee() override { return ::maxTxFee; }\n-    bool getPruneMode() override { return ::fPruneMode; }\n+    bool havePruned() override",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r278316048",
      "id" : 278316048,
      "in_reply_to_id" : 278306246,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3ODMxNjA0OA==",
      "original_commit_id" : "fad84519391a05f2ad42381cca9135323b709657",
      "original_position" : 5,
      "path" : "src/interfaces/chain.cpp",
      "position" : 11,
      "pull_request_review_id" : 230353926,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-03T19:32:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/278316048",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> Concept ACK. Correct me if I'm wrong, but it doesn't have to fail if all required blocks are available right?\r\n\r\nimportmulti does not fail the rescan when all blocks after the timestamp are available, but it fails *after* the import if a block is missing.\r\nthe other import* (after my change) also do not fail the rescan when all blocks after time=0 are available. However, they fail *before* the import if a block is missing.",
      "created_at" : "2019-04-24T21:03:53Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-486425232",
      "id" : 486425232,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4NjQyNTIzMg==",
      "updated_at" : "2019-04-24T21:03:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/486425232",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Let's use prune height instead, so `rescanblockchain` can be picky about it?",
      "created_at" : "2019-05-01T06:02:21Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-488217020",
      "id" : 488217020,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4ODIxNzAyMA==",
      "updated_at" : "2019-05-01T06:02:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/488217020",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I am not touching `rescanblockchain` at all. Could you explain what you mean?",
      "created_at" : "2019-05-01T14:02:10Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-488290292",
      "id" : 488290292,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4ODI5MDI5Mg==",
      "updated_at" : "2019-05-01T14:02:10Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/488290292",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I mean it would make sense to use a common interface with `rescanblockchain`, which would need prune-height rather than have-pruned.",
      "created_at" : "2019-05-01T23:26:52Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-488489329",
      "id" : 488489329,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4ODQ4OTMyOQ==",
      "updated_at" : "2019-05-01T23:26:52Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/488489329",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Oh, the RPCs I touch are already deprecated in favor of importmulti, so I'd rather not add features to them.",
      "created_at" : "2019-05-02T13:10:42Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-488666562",
      "id" : 488666562,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4ODY2NjU2Mg==",
      "updated_at" : "2019-05-02T13:10:42Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/488666562",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm commenting on the src/interfaces changes specifically.",
      "created_at" : "2019-05-02T18:17:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-488777086",
      "id" : 488777086,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4ODc3NzA4Ng==",
      "updated_at" : "2019-05-02T18:17:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/488777086",
      "user" : {
         "avatar_url" : "https://avatars2.githubusercontent.com/u/1095675?v=4",
         "events_url" : "https://api.github.com/users/luke-jr/events{/privacy}",
         "followers_url" : "https://api.github.com/users/luke-jr/followers",
         "following_url" : "https://api.github.com/users/luke-jr/following{/other_user}",
         "gists_url" : "https://api.github.com/users/luke-jr/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/luke-jr",
         "id" : 1095675,
         "login" : "luke-jr",
         "node_id" : "MDQ6VXNlcjEwOTU2NzU=",
         "organizations_url" : "https://api.github.com/users/luke-jr/orgs",
         "received_events_url" : "https://api.github.com/users/luke-jr/received_events",
         "repos_url" : "https://api.github.com/users/luke-jr/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/luke-jr/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/luke-jr"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ah. Yeah, since we don't store the prune height, this would complicate my changes slightly. I think the additional code can be added later (when needed in rescanblockchain).",
      "created_at" : "2019-05-02T18:21:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-488778502",
      "id" : 488778502,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4ODc3ODUwMg==",
      "updated_at" : "2019-05-02T18:21:38Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/488778502",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "I'm a little concerned about this change. Anywhere that `havePruned()` is called without `cs_main` is racy, since a block may be pruned after `havePruned()` is called. We therefore need to make sure that the code after those `havePruned()` calls is robust against being run when blocks have been pruned. If that's the case, why not just remove the `chain().getPruneMode()` check entirely and let the error-handling in the later code handle when a block is missing?\r\n\r\nThe four call sites in rpcdump do not hold `cs_main`. The call site in `CreateWalletFromFile()` does hold `cs_main` indirectly through `locked_chain`, but a goal is to remove that lock.",
      "created_at" : "2019-05-03T17:25:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-489175006",
      "id" : 489175006,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4OTE3NTAwNg==",
      "updated_at" : "2019-05-03T17:25:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489175006",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@jnewbery The check is only there to provide a nice error message. As you correctly observe it is not needed for correctness. Should I clarify that with a comment?\r\n\r\nThe error message otherwise would be https://github.com/bitcoin/bitcoin/pull/15870#discussion_r278315111",
      "created_at" : "2019-05-03T17:49:27Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-489182583",
      "id" : 489182583,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4OTE4MjU4Mw==",
      "updated_at" : "2019-05-03T17:49:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489182583",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> The check is only there to provide a nice error message. As you correctly observe it is not needed for correctness. Should I clarify that with a comment?\r\n\r\nYes, that sounds good. Thanks!",
      "created_at" : "2019-05-03T17:57:12Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-489185056",
      "id" : 489185056,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4OTE4NTA1Ng==",
      "updated_at" : "2019-05-03T17:57:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489185056",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r280892339"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280892339"
         }
      },
      "author_association" : "MEMBER",
      "body" : "nit: indentation\r\n\r\nEDIT: just remove this function entirely",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-05-03T18:59:19Z",
      "diff_hunk" : "@@ -40,9 +39,6 @@ class Variant(collections.namedtuple(\"Variant\", \"call data rescan prune\")):\n     \"\"\"Helper for importing one key and verifying scanned transactions.\"\"\"\n \n     def try_rpc(self, func, *args, **kwargs):\n-        if self.expect_disabled:\n-            assert_raises_rpc_error(-4, \"Rescan is disabled in pruned mode\", func, *args, **kwargs)\n-        else:\n             return func(*args, **kwargs)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r280892339",
      "id" : 280892339,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDg5MjMzOQ==",
      "original_commit_id" : "fa9fa5d647092710aa03dadf92433584e9fe26a3",
      "original_position" : 15,
      "path" : "test/functional/wallet_import_rescan.py",
      "position" : null,
      "pull_request_review_id" : 233623884,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-03T19:32:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280892339",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r280902472"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280902472"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Done",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-05-03T19:33:35Z",
      "diff_hunk" : "@@ -40,9 +39,6 @@ class Variant(collections.namedtuple(\"Variant\", \"call data rescan prune\")):\n     \"\"\"Helper for importing one key and verifying scanned transactions.\"\"\"\n \n     def try_rpc(self, func, *args, **kwargs):\n-        if self.expect_disabled:\n-            assert_raises_rpc_error(-4, \"Rescan is disabled in pruned mode\", func, *args, **kwargs)\n-        else:\n             return func(*args, **kwargs)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r280902472",
      "id" : 280902472,
      "in_reply_to_id" : 280892339,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDkwMjQ3Mg==",
      "original_commit_id" : "fa9fa5d647092710aa03dadf92433584e9fe26a3",
      "original_position" : 15,
      "path" : "test/functional/wallet_import_rescan.py",
      "position" : null,
      "pull_request_review_id" : 233637159,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-03T19:33:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280902472",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "utACK fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-05-03T19:46:56Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#issuecomment-489218060",
      "id" : 489218060,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/15870",
      "node_id" : "MDEyOklzc3VlQ29tbWVudDQ4OTIxODA2MA==",
      "updated_at" : "2019-05-03T19:46:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489218060",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281252918"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281252918"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: Update year in line 1? `// Copyright (c) 2009-2018 The Bitcoin Core developers`",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-05-06T16:11:54Z",
      "diff_hunk" : "@@ -157,8 +157,11 @@ UniValue importprivkey(const JSONRPCRequest& request)\n         if (!request.params[2].isNull())",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281252918",
      "id" : 281252918,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTI1MjkxOA==",
      "original_commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "original_position" : 1,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 1,
      "pull_request_review_id" : 234065801,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-06T16:56:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281252918",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281253401"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281253401"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Nit: space after // in lines 4222 and 4223",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-05-06T16:13:15Z",
      "diff_hunk" : "@@ -4221,8 +4221,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n     {\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281253401",
      "id" : 281253401,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTI1MzQwMQ==",
      "original_commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "original_position" : 3,
      "path" : "src/wallet/wallet.cpp",
      "position" : 3,
      "pull_request_review_id" : 234065801,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-06T16:56:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281253401",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281254503"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281254503"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Perhaps out of PR scope but the docs in lines 4222 and 4223 could be clearer, e.g. is \"error\" the end of a sentence and \"this\" the start of a sentence, or...",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-05-06T16:16:25Z",
      "diff_hunk" : "@@ -4221,8 +4221,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n     {\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281254503",
      "id" : 281254503,
      "in_reply_to_id" : 281253401,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTI1NDUwMw==",
      "original_commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "original_position" : 3,
      "path" : "src/wallet/wallet.cpp",
      "position" : 3,
      "pull_request_review_id" : 234065801,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-06T16:56:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281254503",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281261523"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281261523"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Does the code doc in 588 correspond correctly with the error message in 589? ",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-05-06T16:36:31Z",
      "diff_hunk" : "@@ -573,7 +582,10 @@ UniValue importwallet(const JSONRPCRequest& request)\n                 },\n             }.ToString());\n \n-    if (pwallet->chain().getPruneMode()) {\n+    if (pwallet->chain().havePruned()) {\n+        // Exit early and print an error.\n+        // If a block is pruned after this check, we will import the key(s),\n+        // but fail the rescan with a generic error.\n         throw JSONRPCError(RPC_WALLET_ERROR, \"Importing wallets is disabled in pruned mode\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281261523",
      "id" : 281261523,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTI2MTUyMw==",
      "original_commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "original_position" : 51,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 51,
      "pull_request_review_id" : 234065801,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-06T16:56:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281261523",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281264587"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281264587"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Would it be worth extracting this code block repeated in `importprivkey`, `importaddress`, `importpubkey`, and `importwallet` (the latter with a different error message).\r\n\r\n```cpp\r\n    if (fRescan && pwallet->chain().havePruned()) {\r\n        // Exit early and print an error.\r\n        // If a block is pruned after this check, we will import the key(s),\r\n        // but fail the rescan with a generic error.\r\n        throw JSONRPCError(RPC_WALLET_ERROR, \"Rescan is disabled when blocks are pruned\");\r\n    }\r\n```\r\n\r\nEdit: I understand it may be a premature or unnecessary optimisation. Just an observation.",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-05-06T16:45:40Z",
      "diff_hunk" : "@@ -314,8 +317,11 @@ UniValue importaddress(const JSONRPCRequest& request)\n     if (!request.params[2].isNull())\n         fRescan = request.params[2].get_bool();\n \n-    if (fRescan && pwallet->chain().getPruneMode()) {\n-        throw JSONRPCError(RPC_WALLET_ERROR, \"Rescan is disabled in pruned mode\");\n+    if (fRescan && pwallet->chain().havePruned()) {\n+        // Exit early and print an error.\n+        // If a block is pruned after this check, we will import the key(s),\n+        // but fail the rescan with a generic error.\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Rescan is disabled when blocks are pruned\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281264587",
      "id" : 281264587,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTI2NDU4Nw==",
      "original_commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "original_position" : 24,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 24,
      "pull_request_review_id" : 234065801,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-06T17:01:56Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281264587",
      "user" : {
         "avatar_url" : "https://avatars1.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281270503"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281270503"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yes, \"importing wallet\" means \"importing key(s)\", I believe.",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-05-06T17:01:41Z",
      "diff_hunk" : "@@ -573,7 +582,10 @@ UniValue importwallet(const JSONRPCRequest& request)\n                 },\n             }.ToString());\n \n-    if (pwallet->chain().getPruneMode()) {\n+    if (pwallet->chain().havePruned()) {\n+        // Exit early and print an error.\n+        // If a block is pruned after this check, we will import the key(s),\n+        // but fail the rescan with a generic error.\n         throw JSONRPCError(RPC_WALLET_ERROR, \"Importing wallets is disabled in pruned mode\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281270503",
      "id" : 281270503,
      "in_reply_to_id" : 281261523,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTI3MDUwMw==",
      "original_commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "original_position" : 51,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 51,
      "pull_request_review_id" : 234087587,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-06T17:01:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281270503",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281270849"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281270849"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Yeah, could make sense. Will do if I have to touch for other reasons.",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-05-06T17:02:40Z",
      "diff_hunk" : "@@ -314,8 +317,11 @@ UniValue importaddress(const JSONRPCRequest& request)\n     if (!request.params[2].isNull())\n         fRescan = request.params[2].get_bool();\n \n-    if (fRescan && pwallet->chain().getPruneMode()) {\n-        throw JSONRPCError(RPC_WALLET_ERROR, \"Rescan is disabled in pruned mode\");\n+    if (fRescan && pwallet->chain().havePruned()) {\n+        // Exit early and print an error.\n+        // If a block is pruned after this check, we will import the key(s),\n+        // but fail the rescan with a generic error.\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"Rescan is disabled when blocks are pruned\");",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281270849",
      "id" : 281270849,
      "in_reply_to_id" : 281264587,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTI3MDg0OQ==",
      "original_commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "original_position" : 24,
      "path" : "src/wallet/rpcdump.cpp",
      "position" : 24,
      "pull_request_review_id" : 234087988,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-06T17:02:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281270849",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281271143"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281271143"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is only a dev comment, so no need to over-optimize. Will take specific suggestions if I need to touch this pull for other reasons, though.",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-05-06T17:03:36Z",
      "diff_hunk" : "@@ -4221,8 +4221,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n     {\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281271143",
      "id" : 281271143,
      "in_reply_to_id" : 281253401,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTI3MTE0Mw==",
      "original_commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "original_position" : 3,
      "path" : "src/wallet/wallet.cpp",
      "position" : 3,
      "pull_request_review_id" : 234088366,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-06T17:03:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281271143",
      "user" : {
         "avatar_url" : "https://avatars0.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281277772"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281277772"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I don't think \"no need to over-optimize\" is a helpful response. The grammar is wrong. Why not correct it?",
      "commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "created_at" : "2019-05-06T17:20:58Z",
      "diff_hunk" : "@@ -4221,8 +4221,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n     {\n         //We can't rescan beyond non-pruned blocks, stop and throw an error\n         //this might happen if a user uses an old wallet within a pruned node",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/15870#discussion_r281277772",
      "id" : 281277772,
      "in_reply_to_id" : 281253401,
      "node_id" : "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MTI3Nzc3Mg==",
      "original_commit_id" : "fa9f3cc89442e9b332a27b81b04201bb4a0caf28",
      "original_position" : 3,
      "path" : "src/wallet/wallet.cpp",
      "position" : 3,
      "pull_request_review_id" : 234096556,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/15870",
      "updated_at" : "2019-05-06T17:20:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/281277772",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   }
]
