[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26515#discussion_r1024587778"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26515"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1024587778"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Haven't tested yet if this works, but checking for `fStateStats` seems a bit of a smell in general and I wanted to remove it entirely, e.g. https://github.com/bitcoin/bitcoin/pull/25923, though the way you use it here looks like a real improvement that could be orthogonal to much of that pull.\r\n\r\nNote that you haven't updated the code for the GUI peers details.",
      "commit_id" : "ec839fe2a49e922aee75e49c7f432ff405322a63",
      "created_at" : "2022-11-16T22:57:51Z",
      "diff_hunk" : "@@ -185,6 +185,14 @@ static RPCHelpMan getpeerinfo()\n         UniValue obj(UniValue::VOBJ);\n         CNodeStateStats statestats;\n         bool fStateStats = peerman.GetNodeStateStats(stats.nodeid, statestats);\n+        // GetNodeStateStats() requires the existence of a CNodeState and a Peer object\n+        // to succeed for this peer. These are created at connection initialisation and\n+        // exist for the duration of the connection - except if there is a race where the\n+        // peer got disconnected in between the GetNodeStats() and the GetNodeStateStats()\n+        // calls. In this case, the peer doesn't need to be reported here.\n+        if (!fStateStats) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#discussion_r1024587778",
      "id" : 1024587778,
      "line" : 193,
      "node_id" : "PRRC_kwDOABII5849EfgC",
      "original_commit_id" : "ec839fe2a49e922aee75e49c7f432ff405322a63",
      "original_line" : 193,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : 44,
      "pull_request_review_id" : 1183444682,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26515",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1024587778/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-17T05:13:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1024587778",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Reviewers |\n| ---- | --------- |\n| Concept ACK | [jonatack](https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1318084235) |\n\nIf your review is incorrectly listed, please react with ð to this comment and the bot will ignore it on the next update.\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26516](https://github.com/bitcoin/bitcoin/pull/26516) (rpc: Always return getpeerinfo \"relaytxes\" field by jonatack)\n* [#26328](https://github.com/bitcoin/bitcoin/pull/26328) (netinfo: fix relaytxes doc, display 3 relaytxes states by jonatack)\n* [#25923](https://github.com/bitcoin/bitcoin/pull/25923) (p2p: always provide CNodeStateStats and getpeerinfo/netinfo/gui updates by jonatack)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-11-17T03:29:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1318012205",
      "id" : 1318012205,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585Oj0Ut",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318012205/reactions"
      },
      "updated_at" : "2022-11-28T19:00:13Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318012205",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, will look further at this change.",
      "created_at" : "2022-11-17T05:07:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1318084235",
      "id" : 1318084235,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585OkF6L",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318084235/reactions"
      },
      "updated_at" : "2022-11-17T05:07:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318084235",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Do we really want this, given that the fields have been optional forever(?)? I think we should first think if there are fields that should be optional. If the answer to that is *no*, then this seems fine to do, but without an answer, it seems too early to change.",
      "created_at" : "2022-11-17T17:20:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1318960431",
      "id" : 1318960431,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585Onb0v",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318960431/reactions"
      },
      "updated_at" : "2022-11-17T17:20:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318960431",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Do we really want this, given that the fields have been optional forever(?)? I think we should first think if there are fields that should be optional. If the answer to that is _no_, then this seems fine to do, but without an answer, it seems too early to change.\r\n\r\nI think that if we make any fields optional, we should have a reason for this, and communicate to the users within the RPC help in which situations these fields won't be included.\r\nUnless I'm missing something, the honest explanation as to why these fields are optional right now would be:\r\n\"We can't keep our internal objects in sync as well as we'd like to, so in case of a race condition some fields may be left out from the response because they are part of Internal Object 1, and others are always present because they belong to Internal Object 2\" - this seems really unsatisfactory to me.\r\n\r\nThe reason should be something that has to do with the actual meaning of the field, e.g. if there is a good reason why it's not available under certain conditions (like it's currently being done for fields like `mapped_as` or `minping`).",
      "created_at" : "2022-11-17T18:06:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1319014413",
      "id" : 1319014413,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585OnpAN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319014413/reactions"
      },
      "updated_at" : "2022-11-17T18:06:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319014413",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> The reason should be something that has to do with the actual meaning of the field\r\n\r\nyes, agree. This is what I was trying to say we should answer first before changing the code.",
      "created_at" : "2022-11-17T18:21:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1319032326",
      "id" : 1319032326,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585OntYG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319032326/reactions"
      },
      "updated_at" : "2022-11-17T18:21:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319032326",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> yes, agree. This is what I was trying to say we should answer first before changing the code.\r\n\r\nOk, I'll look into this field by field before taking this out of draft. However, note that if we decide to keep certain field optional for an intrinsic reason, it would likely be a behavior change, because we currently include all `CNodeStateStats` fields as long as we have a `Peer` and `CNodeState` object for the peer.",
      "created_at" : "2022-11-17T18:26:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1319037959",
      "id" : 1319037959,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585OnuwH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319037959/reactions"
      },
      "updated_at" : "2022-11-17T18:26:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319037959",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> if we decide to keep certain field optional for an intrinsic reason, it would likely be a behavior change\r\n\r\nHeh, this might actually be a convincing argument to go ahead with the changes here as-is. (And then add a new field name, if needed, for \"truly\" optional fields instead of breaking the behaviour?)",
      "created_at" : "2022-11-17T18:37:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1319048753",
      "id" : 1319048753,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585OnxYx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319048753/reactions"
      },
      "updated_at" : "2022-11-17T18:42:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319048753",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26515#discussion_r1025824755"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26515"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1025824755"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Looking into #25923 right now - it seems that it does some what Marco suggested below, making some fields, like txrelay, optional for an intrinsic reason instead of using defaults like -1 or 0 when the info is not known.\r\n\r\nAs for the GUI - I didn't change it on purpose, because [this comment](https://github.com/bitcoin/bitcoin/blob/6863ad79a65842504ab6f5584fac3d1de7ecf87e/src/qt/rpcconsole.cpp#L1200-L1201) scared me off. I think that #25923 is affected by that too, I'll comment there.",
      "commit_id" : "ec839fe2a49e922aee75e49c7f432ff405322a63",
      "created_at" : "2022-11-17T23:06:15Z",
      "diff_hunk" : "@@ -185,6 +185,14 @@ static RPCHelpMan getpeerinfo()\n         UniValue obj(UniValue::VOBJ);\n         CNodeStateStats statestats;\n         bool fStateStats = peerman.GetNodeStateStats(stats.nodeid, statestats);\n+        // GetNodeStateStats() requires the existence of a CNodeState and a Peer object\n+        // to succeed for this peer. These are created at connection initialisation and\n+        // exist for the duration of the connection - except if there is a race where the\n+        // peer got disconnected in between the GetNodeStats() and the GetNodeStateStats()\n+        // calls. In this case, the peer doesn't need to be reported here.\n+        if (!fStateStats) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#discussion_r1025824755",
      "id" : 1025824755,
      "in_reply_to_id" : 1024587778,
      "line" : 193,
      "node_id" : "PRRC_kwDOABII5849JNfz",
      "original_commit_id" : "ec839fe2a49e922aee75e49c7f432ff405322a63",
      "original_line" : 193,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : 44,
      "pull_request_review_id" : 1185227165,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26515",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1025824755/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-17T23:06:16Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1025824755",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Though,\r\n\r\n> If this gets approval, bitcoin-cli -netinfo could probably be simplified as a follow-up because it wouldn't need to deal with missing entries for some of these fields anymore.\r\n\r\nI don't think this part is true. `bitcoin-cli` would still need to deduce if a non-optional field is \"true\" optional with some heuristics like https://github.com/bitcoin-core/gui/pull/677. Though, this is already true on master and seems unrelated to this pull.",
      "created_at" : "2022-11-18T08:35:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1319698071",
      "id" : 1319698071,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585OqP6X",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319698071/reactions"
      },
      "updated_at" : "2022-11-18T08:35:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319698071",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26515#discussion_r1031861127"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26515"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1031861127"
         }
      },
      "author_association" : "MEMBER",
      "body" : "The `TRY_LOCK` for accessing `CNodeStats` has been in the GUI since peer information was added in #4225 (see https://github.com/bitcoin/bitcoin/pull/4225#issuecomment-44150459). I'm not sure why it was decided that the GUI could block on taking `cs_vNodes`, but can't block on taking `cs_main`.",
      "commit_id" : "ec839fe2a49e922aee75e49c7f432ff405322a63",
      "created_at" : "2022-11-24T21:29:05Z",
      "diff_hunk" : "@@ -185,6 +185,14 @@ static RPCHelpMan getpeerinfo()\n         UniValue obj(UniValue::VOBJ);\n         CNodeStateStats statestats;\n         bool fStateStats = peerman.GetNodeStateStats(stats.nodeid, statestats);\n+        // GetNodeStateStats() requires the existence of a CNodeState and a Peer object\n+        // to succeed for this peer. These are created at connection initialisation and\n+        // exist for the duration of the connection - except if there is a race where the\n+        // peer got disconnected in between the GetNodeStats() and the GetNodeStateStats()\n+        // calls. In this case, the peer doesn't need to be reported here.\n+        if (!fStateStats) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#discussion_r1031861127",
      "id" : 1031861127,
      "in_reply_to_id" : 1024587778,
      "line" : 193,
      "node_id" : "PRRC_kwDOABII5849gPOH",
      "original_commit_id" : "ec839fe2a49e922aee75e49c7f432ff405322a63",
      "original_line" : 193,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : 44,
      "pull_request_review_id" : 1193648235,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26515",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1031861127/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-24T21:29:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1031861127",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1063656?v=4",
         "events_url" : "https://api.github.com/users/jnewbery/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jnewbery/followers",
         "following_url" : "https://api.github.com/users/jnewbery/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jnewbery/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jnewbery",
         "id" : 1063656,
         "login" : "jnewbery",
         "node_id" : "MDQ6VXNlcjEwNjM2NTY=",
         "organizations_url" : "https://api.github.com/users/jnewbery/orgs",
         "received_events_url" : "https://api.github.com/users/jnewbery/received_events",
         "repos_url" : "https://api.github.com/users/jnewbery/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jnewbery/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jnewbery"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I removed the part that makes the `CNodeStateStats` fields non-optional. Since that part conflicts with #25293 and can be a separate discussion (I commented [there](https://github.com/bitcoin/bitcoin/pull/25923#pullrequestreview-1188773952)), this PR now only addresses the situation where we have a `CNode` but no `CNodeStateStats` due to a race during shutdown.\r\n\r\n> I don't think this part is true. (...)\r\n\r\nRemoved from OP",
      "created_at" : "2022-11-28T19:10:58Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1329613201",
      "id" : 1329613201,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585PQEmR",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1329613201/reactions"
      },
      "updated_at" : "2022-11-28T19:10:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1329613201",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26515#discussion_r1033977162"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26515"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1033977162"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm not sure either, but one reason might be because it slows down IBD a little if the GUI constantly competes with validation for `cs_main` just to update the peers window. Another reason might be that `cs_main` is held more often and longer by the node compared to `cs_vNodes` (current name `m_nodes_mutex`), so it might become noticeable that the GUI freezes. In both of these cases, skipping some of the requests from the GUI could make sense.",
      "commit_id" : "6fefd49527fa0ed9535e54f2a3e76fe2599b2350",
      "created_at" : "2022-11-28T19:39:46Z",
      "diff_hunk" : "@@ -185,6 +185,14 @@ static RPCHelpMan getpeerinfo()\n         UniValue obj(UniValue::VOBJ);\n         CNodeStateStats statestats;\n         bool fStateStats = peerman.GetNodeStateStats(stats.nodeid, statestats);\n+        // GetNodeStateStats() requires the existence of a CNodeState and a Peer object\n+        // to succeed for this peer. These are created at connection initialisation and\n+        // exist for the duration of the connection - except if there is a race where the\n+        // peer got disconnected in between the GetNodeStats() and the GetNodeStateStats()\n+        // calls. In this case, the peer doesn't need to be reported here.\n+        if (!fStateStats) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#discussion_r1033977162",
      "id" : 1033977162,
      "in_reply_to_id" : 1024587778,
      "line" : 193,
      "node_id" : "PRRC_kwDOABII5849oT1K",
      "original_commit_id" : "ec839fe2a49e922aee75e49c7f432ff405322a63",
      "original_line" : 193,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : 9,
      "pull_request_review_id" : 1196444628,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26515",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1033977162/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-28T19:39:46Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1033977162",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   }
]
