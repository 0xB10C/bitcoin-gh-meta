[
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/26515#discussion_r1024587778"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26515"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1024587778"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Haven't tested yet if this works, but checking for `fStateStats` seems a bit of a smell and I wanted to remove it entirely, e.g. https://github.com/bitcoin/bitcoin/pull/25923.\r\n\r\nNote that you haven't updated the code for the GUI peers details.",
      "commit_id" : "ec839fe2a49e922aee75e49c7f432ff405322a63",
      "created_at" : "2022-11-16T22:57:51Z",
      "diff_hunk" : "@@ -185,6 +185,14 @@ static RPCHelpMan getpeerinfo()\n         UniValue obj(UniValue::VOBJ);\n         CNodeStateStats statestats;\n         bool fStateStats = peerman.GetNodeStateStats(stats.nodeid, statestats);\n+        // GetNodeStateStats() requires the existence of a CNodeState and a Peer object\n+        // to succeed for this peer. These are created at connection initialisation and\n+        // exist for the duration of the connection - except if there is a race where the\n+        // peer got disconnected in between the GetNodeStats() and the GetNodeStateStats()\n+        // calls. In this case, the peer doesn't need to be reported here.\n+        if (!fStateStats) {",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#discussion_r1024587778",
      "id" : 1024587778,
      "line" : 193,
      "node_id" : "PRRC_kwDOABII5849EfgC",
      "original_commit_id" : "ec839fe2a49e922aee75e49c7f432ff405322a63",
      "original_line" : 193,
      "original_position" : 44,
      "original_start_line" : null,
      "path" : "src/rpc/net.cpp",
      "position" : 44,
      "pull_request_review_id" : 1183444682,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/26515",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1024587778/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-11-16T22:57:51Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/1024587778",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--021abf342d371248e50ceaed478a90ca-->\n### Reviews\nSee [the guideline](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#code-review) for information on the review process.\n| Type | Count | Reviewers |\n| ---- | ----- | --------- |\n| Concept ACK | 1 | [jonatack](https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1318084235) |\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#26516](https://github.com/bitcoin/bitcoin/pull/26516) (rpc: Always return getpeerinfo \"relaytxes\" field by jonatack)\n* [#26328](https://github.com/bitcoin/bitcoin/pull/26328) (netinfo: fix relaytxes doc, display 3 relaytxes states by jonatack)\n* [#25923](https://github.com/bitcoin/bitcoin/pull/25923) (p2p: always provide CNodeStateStats and getpeerinfo/netinfo/gui updates by jonatack)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.\n",
      "created_at" : "2022-11-17T03:29:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1318012205",
      "id" : 1318012205,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585Oj0Ut",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318012205/reactions"
      },
      "updated_at" : "2022-11-17T17:20:27Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318012205",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK, will look further at this change.",
      "created_at" : "2022-11-17T05:07:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1318084235",
      "id" : 1318084235,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585OkF6L",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318084235/reactions"
      },
      "updated_at" : "2022-11-17T05:07:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318084235",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/2415484?v=4",
         "events_url" : "https://api.github.com/users/jonatack/events{/privacy}",
         "followers_url" : "https://api.github.com/users/jonatack/followers",
         "following_url" : "https://api.github.com/users/jonatack/following{/other_user}",
         "gists_url" : "https://api.github.com/users/jonatack/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/jonatack",
         "id" : 2415484,
         "login" : "jonatack",
         "node_id" : "MDQ6VXNlcjI0MTU0ODQ=",
         "organizations_url" : "https://api.github.com/users/jonatack/orgs",
         "received_events_url" : "https://api.github.com/users/jonatack/received_events",
         "repos_url" : "https://api.github.com/users/jonatack/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/jonatack/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/jonatack"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Do we really want this, given that the fields have been optional forever(?)? I think we should first think if there are fields that should be optional. If the answer to that is *no*, then this seems fine to do, but without an answer, it seems too early to change.",
      "created_at" : "2022-11-17T17:20:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1318960431",
      "id" : 1318960431,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585Onb0v",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318960431/reactions"
      },
      "updated_at" : "2022-11-17T17:20:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1318960431",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Do we really want this, given that the fields have been optional forever(?)? I think we should first think if there are fields that should be optional. If the answer to that is _no_, then this seems fine to do, but without an answer, it seems too early to change.\r\n\r\nI think that if we make any fields optional, we should have a reason for this, and communicate to the users within the RPC help in which situations these fields won't be included.\r\nUnless I'm missing something, the honest explanation as to why these fields are optional right now would be:\r\n\"We can't keep our internal objects in sync as well as we'd like to, so in case of a race condition some fields may be left out from the response because they are part of Internal Object 1, and others are always present because they belong to Internal Object 2\" - this seems really unsatisfactory to me.\r\n\r\nThe reason should be something that has to do with the actual meaning of the field, e.g. if there is a good reason why it's not available under certain conditions (like it's currently being done for fields like `mapped_as` or `minping`).",
      "created_at" : "2022-11-17T18:06:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1319014413",
      "id" : 1319014413,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585OnpAN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319014413/reactions"
      },
      "updated_at" : "2022-11-17T18:06:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319014413",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> The reason should be something that has to do with the actual meaning of the field\r\n\r\nyes, agree. This is what I was trying to say we should answer first before changing the code.",
      "created_at" : "2022-11-17T18:21:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1319032326",
      "id" : 1319032326,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585OntYG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319032326/reactions"
      },
      "updated_at" : "2022-11-17T18:21:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319032326",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> yes, agree. This is what I was trying to say we should answer first before changing the code.\r\n\r\nOk, I'll look into this field by field before taking this out of draft. However, note that if we decide to keep certain field optional for an intrinsic reason, it would likely be a behavior change, because we currently include all `CNodeStateStats` fields as long as we have a `Peer` and `CNodeState` object for the peer.",
      "created_at" : "2022-11-17T18:26:47Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1319037959",
      "id" : 1319037959,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585OnuwH",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319037959/reactions"
      },
      "updated_at" : "2022-11-17T18:26:47Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319037959",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> if we decide to keep certain field optional for an intrinsic reason, it would likely be a behavior change\r\n\r\nHeh, this might actually be a convincing argument to go ahead with the changes here as-is. (And then add a new field name, if needed, for \"truly\" optional fields instead of breaking the behaviour?)",
      "created_at" : "2022-11-17T18:37:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/26515#issuecomment-1319048753",
      "id" : 1319048753,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26515",
      "node_id" : "IC_kwDOABII585OnxYx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319048753/reactions"
      },
      "updated_at" : "2022-11-17T18:42:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1319048753",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
