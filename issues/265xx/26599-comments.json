[
   {
      "author_association" : "MEMBER",
      "body" : "> It means that this error give us lot's of work \r\n\r\nDo you happen to know why it corrupts? If it is due to hardware error, it might be scary to just continue, because it might also corrupt wallet.dat.",
      "created_at" : "2022-11-29T12:38:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1330584634",
      "id" : 1330584634,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585PTxw6",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1330584634/reactions"
      },
      "updated_at" : "2022-11-29T12:38:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1330584634",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "If the cause is known and harmless, it can be fixed like https://github.com/bitcoin/bitcoin/commit/b00b60ed4f27066656e45635f1386e6b1550c6ed",
      "created_at" : "2022-11-29T12:41:14Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1330592310",
      "id" : 1330592310,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585PTzo2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1330592310/reactions"
      },
      "updated_at" : "2022-11-29T12:41:14Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1330592310",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@NicolasDorier Were you able to find the reason for corruption? Steps to reproduce could help in knowing the severity of the issue",
      "created_at" : "2022-11-30T22:05:43Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1332791869",
      "id" : 1332791869,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585PcMo9",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1332791869/reactions"
      },
      "updated_at" : "2022-11-30T22:05:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1332791869",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@1440000bytes @MarcoFalke I don't know the reason, I can just report it happened to maybe 2 or 3 different people on our support in one or two months. Removing the `peers.dat` fixed their problem.\r\nMy guess is that bitcoin core was not shut down cleanly. (such as the process killed while saving peers.dat?)\r\n\r\nOn another note: A wallet corruption, which is genuinely more scary, doesn't make bitcoin core crash when starting. (it isn't related to this issue, but I can share a corrupted wallet.dat not crashing bitcoin core on startup if that interest anybody)",
      "created_at" : "2022-12-01T02:29:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1333071141",
      "id" : 1333071141,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585PdQ0l",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333071141/reactions"
      },
      "updated_at" : "2022-12-01T02:35:23Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333071141",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=4",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "node_id" : "MDQ6VXNlcjMwMjA2NDY=",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "> such as the process killed while saving peers.dat\r\n\r\nRenameOver should be atomic, so I don't think this can happen.\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/e2bfd41f832dc7c7be6f17e928352f0eb2865f66/src/addrdb.cpp#L79",
      "created_at" : "2022-12-01T08:46:07Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1333412109",
      "id" : 1333412109,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585PekEN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333412109/reactions"
      },
      "updated_at" : "2022-12-01T08:46:07Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333412109",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I will ask for the next time it happens to save the `peers.dat` so we can analyze it.",
      "created_at" : "2022-12-01T09:03:15Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1333441743",
      "id" : 1333441743,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585PerTP",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333441743/reactions"
      },
      "updated_at" : "2022-12-01T09:03:15Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333441743",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=4",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "node_id" : "MDQ6VXNlcjMwMjA2NDY=",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Ok, thanks. Closing for now, but this can be reopened if you leave another comment or referred to if you open a new issue.",
      "created_at" : "2022-12-01T09:13:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1333456025",
      "id" : 1333456025,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585PeuyZ",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333456025/reactions"
      },
      "updated_at" : "2022-12-01T09:13:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333456025",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@MarcoFalke I think the reason why it is corrupt is different from the topic of not crashing for a `peers.dat` file. This file is non-essential, it shouldn't be a problem to restart.",
      "created_at" : "2022-12-01T09:47:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1333495464",
      "id" : 1333495464,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585Pe4ao",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333495464/reactions"
      },
      "updated_at" : "2022-12-01T09:47:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333495464",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=4",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "node_id" : "MDQ6VXNlcjMwMjA2NDY=",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "So I don't know if that help, told me that it mainly happen with people running with low spec RAM (2GB)\r\nApparently, one user had repeated corruptions with 1gb ram.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
      "created_at" : "2022-12-01T11:21:22Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1333612693",
      "id" : 1333612693,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585PfVCV",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333612693/reactions"
      },
      "updated_at" : "2022-12-01T11:21:43Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333612693",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=4",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "node_id" : "MDQ6VXNlcjMwMjA2NDY=",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "To me it sounds like a bug that should be fixed and not silently ignored",
      "created_at" : "2022-12-01T11:23:29Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1333614893",
      "id" : 1333614893,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585PfVkt",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333614893/reactions"
      },
      "updated_at" : "2022-12-01T11:23:29Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333614893",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "The `peers.dat` file is designed to avoid having to reach out to the DNS or hardcoded seeds more than once, as this is the moment your node is most susceptible to being poisoned with attacker ip addresses and perhaps in the future blocks and transactions.\r\n\r\nIf the file becomes corrupted then `anchors.dat` should help protect the node from a successful future eclipse attack, but new addresses will have to either be added manually or fetched from DNS or hardcoded seeds again.\r\n\r\nI agree that the best course of action here is to find out what's corrupting `peers.dat` and fix that, rather than have Core silently ignore errors on something that _could_ be used as a first step towards eclipse attacking you...\r\n\r\nSide note: it does make me wonder whether it could be worth having certain runtime \"profiles\". For example I have seen software with \"paranoia level\" settings, and we could perhaps have something like\r\n\r\n- **Paranoid**: Fail on detecting any corrupt file, data, etc. debugging enabled on many categories by default, notification of re-orgs >= `n` blocks etc.\r\n- **Normal** (default): Somthing similar to todays defaults\r\n- **Resilient**: Try to recover from more non-critical errors to stay operational. Automatcially restart and rebuild broken indexes, etc. if needed",
      "created_at" : "2022-12-01T12:14:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1333679286",
      "id" : 1333679286,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585PflS2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333679286/reactions"
      },
      "updated_at" : "2022-12-01T12:14:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333679286",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Maybe related: #25874 (with a slightly different error)\r\n\r\nI agree that having access to a corrupted `peers.dat` would be very helpful.",
      "created_at" : "2022-12-01T15:41:34Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1333957965",
      "id" : 1333957965,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585PgpVN",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333957965/reactions"
      },
      "updated_at" : "2022-12-01T15:41:34Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333957965",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "It _would_ be interesting if somehow Core is corrupting its own `peers.dat` in some way, but a more common source of errors is bad disk failure or a `mv` or archive operation going wrong/being cancelled mid-way through.\r\n\r\nI just used `dd if=/dev/urandom of=peers.dat bs=1024 seek=(math (random) % 10) count=1 conv=notrunc` (fish syntax) to write some random bytes to one of the first 10 blocks for a quick test which reproduced the error.\r\n\r\nI suppose in theory we could try to recover whatever entries we can. If an attacker has modified it they would also be able to update the checksum, so the hash is not providing any protection in this scenario.",
      "created_at" : "2022-12-01T15:58:05Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1333985193",
      "id" : 1333985193,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585Pgv-p",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333985193/reactions"
      },
      "updated_at" : "2022-12-01T15:58:05Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1333985193",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> It would be interesting if somehow Core is corrupting its own peers.dat in some way, but a more common source of errors is bad disk failure or a mv or archive operation going wrong/being cancelled mid-way through.\r\n\r\nIt would be more interesting if I can corrupt it remotely for another node. That would be something we need to report to: https://github.com/bitcoin/bitcoin/security/policy",
      "created_at" : "2022-12-01T19:10:40Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1334226764",
      "id" : 1334226764,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585Phq9M",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1334226764/reactions"
      },
      "updated_at" : "2022-12-01T19:10:40Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1334226764",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/94559964?v=4",
         "events_url" : "https://api.github.com/users/1440000bytes/events{/privacy}",
         "followers_url" : "https://api.github.com/users/1440000bytes/followers",
         "following_url" : "https://api.github.com/users/1440000bytes/following{/other_user}",
         "gists_url" : "https://api.github.com/users/1440000bytes/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/1440000bytes",
         "id" : 94559964,
         "login" : "1440000bytes",
         "node_id" : "U_kgDOBaLe3A",
         "organizations_url" : "https://api.github.com/users/1440000bytes/orgs",
         "received_events_url" : "https://api.github.com/users/1440000bytes/received_events",
         "repos_url" : "https://api.github.com/users/1440000bytes/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/1440000bytes/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/1440000bytes/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/1440000bytes"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@NicolasDorier I was just re-reading your original issue and had forgotten you had asked for a bash script to detect issues. `peers.dat` is just double sha256 checksummed, so something like this should work for you:\r\n\r\n```bash\r\n#!/usr/bin/env bash\r\n\r\necho \"Validating double sha256 checksum of file $1\"\r\n\r\n# Check if file is provided as argument\r\nif [ -z \"$1\" ]; then\r\n\techo \"Please provide a file as an argument\"\r\n\texit 1\r\nfi\r\n\r\n# Check if file exists\r\nif [ ! -f \"$1\" ]; then\r\n\techo \"File does not exist\"\r\n\texit 1\r\nfi\r\n\r\n# Use a full path for better error logging if possible\r\nif command -v realpath &>/dev/null; then\r\n\tfile=$(realpath \"$1\")\r\nelse\r\n\tfile=\"$1\"\r\nfi\r\n\r\n# Original file hash from file $1\r\nfile_hash=$(tail --bytes=32 \"$file\")\r\n\r\n# Calculated sha256 hash of file $1\r\ncalc_hash=$(head --bytes=-32 \"$file\" | sha256sum -b | cut -c1-64 | xxd -r -p | sha256sum | cut -c1-64 | xxd -r -p)\r\n\r\nif [ \"$file_hash\" == \"$calc_hash\" ]; then\r\n\techo \"File $file has a valid sha256 checksum\"\r\n\texit 0\r\nelse\r\n\techo \"File $file has an invalid sha256 checksum and may be corrupted\"\r\n\techo \"$file sha256 hash:\"\r\n\techo \"$file_hash\" | xxd --plain -cols 64\r\n\techo \"$file calculated sha256 hash:\"\r\n\techo \"$calc_hash\" | xxd --plain -cols 64\r\n\techo \"Please consider communicating this corrupt $1 file to Bitcoin Core developers for analysis\"\r\n\r\n\r\n    # You could optionally move/rename the file here so that Bitcoin Core will startup without error\r\n\t# e.g.:\r\n    # mv \"$1\" \"$1.corrupt\"\r\n\texit 1\r\nfi\r\n```\r\n\r\nIf you do use a check like this, perhaps you could consider a way we could have these multiple corrupt `peers.dat` files returned for analysis?",
      "created_at" : "2022-12-02T10:02:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1335014680",
      "id" : 1335014680,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585PkrUY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1335014680/reactions"
      },
      "updated_at" : "2022-12-02T10:02:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1335014680",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6606587?v=4",
         "events_url" : "https://api.github.com/users/willcl-ark/events{/privacy}",
         "followers_url" : "https://api.github.com/users/willcl-ark/followers",
         "following_url" : "https://api.github.com/users/willcl-ark/following{/other_user}",
         "gists_url" : "https://api.github.com/users/willcl-ark/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/willcl-ark",
         "id" : 6606587,
         "login" : "willcl-ark",
         "node_id" : "MDQ6VXNlcjY2MDY1ODc=",
         "organizations_url" : "https://api.github.com/users/willcl-ark/orgs",
         "received_events_url" : "https://api.github.com/users/willcl-ark/received_events",
         "repos_url" : "https://api.github.com/users/willcl-ark/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/willcl-ark/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/willcl-ark/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/willcl-ark"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@willcl-ark  The corrupt peers.dat probably didn't have the sha256 matching. @petzsch was going to try to reproduce. Will ping him.",
      "created_at" : "2022-12-10T11:08:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1345240580",
      "id" : 1345240580,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585QLr4E",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345240580/reactions"
      },
      "updated_at" : "2022-12-10T11:08:36Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345240580",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/3020646?v=4",
         "events_url" : "https://api.github.com/users/NicolasDorier/events{/privacy}",
         "followers_url" : "https://api.github.com/users/NicolasDorier/followers",
         "following_url" : "https://api.github.com/users/NicolasDorier/following{/other_user}",
         "gists_url" : "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/NicolasDorier",
         "id" : 3020646,
         "login" : "NicolasDorier",
         "node_id" : "MDQ6VXNlcjMwMjA2NDY=",
         "organizations_url" : "https://api.github.com/users/NicolasDorier/orgs",
         "received_events_url" : "https://api.github.com/users/NicolasDorier/received_events",
         "repos_url" : "https://api.github.com/users/NicolasDorier/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/NicolasDorier/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/NicolasDorier"
      }
   },
   {
      "author_association" : "NONE",
      "body" : "Still working at reproducing the issue on a VirtualBox VM with 1 GB RAM and 8 CPU cores for hopefully faster syncing (at around 20% synced now). So far no errors concerning the peers.dat.\r\n\r\nIs there anything else I should try for forcing data corruption to happen? Like power down the VM without a regular shutdown sequence? Not sure what our users where doing with their installs to torture them into this error. :-)\r\n\r\nCould this error be hardware specific (not just low RAM)? I'm virtualizing with VirtualBox on a i9-9900k ...the VM has 64 Bit Ubuntu 22.04 running with the usual btcpay docker stack.\r\n\r\n@NicolasDorier you mentioned a user who ran into this error several times with 1 GB RAM: Can we still reach them for more details what machine they used?",
      "created_at" : "2022-12-10T11:39:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/26599#issuecomment-1345245604",
      "id" : 1345245604,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/26599",
      "node_id" : "IC_kwDOABII585QLtGk",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345245604/reactions"
      },
      "updated_at" : "2022-12-10T11:39:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1345245604",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/1374810?v=4",
         "events_url" : "https://api.github.com/users/petzsch/events{/privacy}",
         "followers_url" : "https://api.github.com/users/petzsch/followers",
         "following_url" : "https://api.github.com/users/petzsch/following{/other_user}",
         "gists_url" : "https://api.github.com/users/petzsch/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/petzsch",
         "id" : 1374810,
         "login" : "petzsch",
         "node_id" : "MDQ6VXNlcjEzNzQ4MTA=",
         "organizations_url" : "https://api.github.com/users/petzsch/orgs",
         "received_events_url" : "https://api.github.com/users/petzsch/received_events",
         "repos_url" : "https://api.github.com/users/petzsch/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/petzsch/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/petzsch/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/petzsch"
      }
   }
]
