[
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK!\r\n\r\n> detection when the feature can be used\r\n\r\nOn Linux (the only system we care about for ARM, i guess), the following would be the way to do detection:\r\n```c++\r\n#include <sys/auxv.h>\r\n#include <asm/hwcap.h>\r\nâ¦\r\n#ifdef __arm__\r\n/* ARM 32 bit */\r\nif (getauxval(AT_HWCAP2) & HWCAP2_SHA2) {\r\n    have_arm_shani = true;\r\n}\r\n#endif\r\n#ifdef __aarch64__\r\n/* ARM 64 bit */\r\nif (getauxval(AT_HWCAP) & HWCAP_SHA2) {\r\n    have_arm_shani = true;\r\n}\r\n#endif\r\n```\r\nNote that the capability bit is on a different HWCAP word on 32 and 64 bit (dunno if you even want to support 32 bit here).\r\n",
      "created_at" : "2022-01-20T18:55:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#issuecomment-1017819167",
      "id" : 1017819167,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24115",
      "node_id" : "IC_kwDOABII5848qrAf",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017819167/reactions"
      },
      "updated_at" : "2022-01-20T19:00:53Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017819167",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> the following would be the way to do detection:\r\n\r\nAdded in f7dd1ef",
      "created_at" : "2022-01-20T19:26:59Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#issuecomment-1017847752",
      "id" : 1017847752,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24115",
      "node_id" : "IC_kwDOABII5848qx_I",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017847752/reactions"
      },
      "updated_at" : "2022-01-20T19:57:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017847752",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42201?v=4",
         "events_url" : "https://api.github.com/users/prusnak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prusnak/followers",
         "following_url" : "https://api.github.com/users/prusnak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prusnak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prusnak",
         "id" : 42201,
         "login" : "prusnak",
         "node_id" : "MDQ6VXNlcjQyMjAx",
         "organizations_url" : "https://api.github.com/users/prusnak/orgs",
         "received_events_url" : "https://api.github.com/users/prusnak/received_events",
         "repos_url" : "https://api.github.com/users/prusnak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prusnak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prusnak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prusnak"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "On commit f7dd1efae715593f5c9ff8186d518d25d1c9023c\r\n\r\nOn a Linux aarch64 Cortex-A53 system with:\r\n\r\n```\r\n$ cat /proc/cpuinfo \r\nprocessor       : 0\r\nBogoMIPS        : 200.00\r\nFeatures        : fp asimd evtstrm aes pmull sha1 sha2 crc32 cpuid\r\nCPU implementer : 0x41\r\nCPU architecture: 8\r\nCPU variant     : 0x0\r\nCPU part        : 0xd03\r\nCPU revision    : 4\r\n```\r\n\r\nwhich I presume means it has the necessary SHA2 extensions.\r\n\r\nThe GCC 9.3.0 compiler used supports the extensions (crypto/libbitcoin_crypto_arm_shani.a is being built):\r\n\r\n```\r\nchecking for x86 SHA-NI intrinsics... no\r\nchecking whether C++ compiler accepts -march=armv8-a+crc+crypto... yes\r\nchecking whether C++ compiler accepts -march=armv8-a+crc+crypto... (cached) yes\r\nchecking for AArch64 CRC32 intrinsics... yes\r\nchecking for AArch64 SHA-NI intrinsics... yes\r\n```\r\n\r\nStill, the extension doesn't seem to be detected. debug.log says:\r\n\r\n```\r\n2022-01-20T20:37:05Z Using the 'standard' SHA256 implementation\r\n```\r\n",
      "created_at" : "2022-01-20T20:43:36Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#issuecomment-1017911640",
      "id" : 1017911640,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24115",
      "node_id" : "IC_kwDOABII5848rBlY",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017911640/reactions"
      },
      "updated_at" : "2022-01-20T20:55:12Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017911640",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa should be fixed in c0849fc4fd9aa7e70973445a1b962a9270fd859c",
      "created_at" : "2022-01-20T21:42:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#issuecomment-1017953150",
      "id" : 1017953150,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24115",
      "node_id" : "IC_kwDOABII5848rLt-",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017953150/reactions"
      },
      "updated_at" : "2022-01-20T21:42:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017953150",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42201?v=4",
         "events_url" : "https://api.github.com/users/prusnak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prusnak/followers",
         "following_url" : "https://api.github.com/users/prusnak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prusnak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prusnak",
         "id" : 42201,
         "login" : "prusnak",
         "node_id" : "MDQ6VXNlcjQyMjAx",
         "organizations_url" : "https://api.github.com/users/prusnak/orgs",
         "received_events_url" : "https://api.github.com/users/prusnak/received_events",
         "repos_url" : "https://api.github.com/users/prusnak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prusnak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prusnak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prusnak"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "On c0849fc4fd9aa7e70973445a1b962a9270fd859c:\r\n\r\n```\r\n2022-01-20T22:15:44Z Using the 'arm_shani(1way)' SHA256 implementation\r\n```",
      "created_at" : "2022-01-20T22:16:18Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#issuecomment-1017974870",
      "id" : 1017974870,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24115",
      "node_id" : "IC_kwDOABII5848rRBW",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 1,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 1,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017974870/reactions"
      },
      "updated_at" : "2022-01-20T22:16:18Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1017974870",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "This PR (c0849fc4fd9aa7e70973445a1b962a9270fd859c):\r\n\r\n|             ns/byte |              byte/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|                2.56 |      390,886,099.70 |    0.9% |      0.03 | `SHA256`\r\n|               10.27 |       97,329,584.86 |    0.0% |      0.01 | `SHA256D64_1024`\r\n|               14.60 |       68,478,670.64 |    0.4% |      0.01 | `SHA256_32b`\r\n\r\nOn master (e3ce019667fba2ec50a59814a26566fb67fa9125):\r\n\r\n|             ns/byte |              byte/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|               15.69 |       63,715,155.54 |    0.0% |      0.17 | `SHA256`\r\n|               43.42 |       23,029,615.98 |    0.5% |      0.03 | `SHA256D64_1024`\r\n|               41.67 |       23,995,549.21 |    0.1% |      0.01 | `SHA256_32b`\r\n",
      "created_at" : "2022-01-20T23:01:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#issuecomment-1018001885",
      "id" : 1018001885,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24115",
      "node_id" : "IC_kwDOABII5848rXnd",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 2,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 2,
         "total_count" : 4,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1018001885/reactions"
      },
      "updated_at" : "2022-01-20T23:01:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1018001885",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> On Linux (the only system we care about for ARM, i guess)\r\n\r\nM1 macs would like a word with you.",
      "created_at" : "2022-01-21T05:08:06Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#issuecomment-1018185286",
      "id" : 1018185286,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24115",
      "node_id" : "IC_kwDOABII5848sEZG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1018185286/reactions"
      },
      "updated_at" : "2022-01-22T06:04:48Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1018185286",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6443210?v=4",
         "events_url" : "https://api.github.com/users/PastaPastaPasta/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PastaPastaPasta/followers",
         "following_url" : "https://api.github.com/users/PastaPastaPasta/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PastaPastaPasta/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PastaPastaPasta",
         "id" : 6443210,
         "login" : "PastaPastaPasta",
         "node_id" : "MDQ6VXNlcjY0NDMyMTA=",
         "organizations_url" : "https://api.github.com/users/PastaPastaPasta/orgs",
         "received_events_url" : "https://api.github.com/users/PastaPastaPasta/received_events",
         "repos_url" : "https://api.github.com/users/PastaPastaPasta/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PastaPastaPasta/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PastaPastaPasta/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PastaPastaPasta"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Speaking of m1, I was able to compile this locally on my m1 pro 10 core, ./configure realized that SHA2 intrinsics could be used. See benchmarks below. \r\n\r\non https://github.com/bitcoin/bitcoin/commit/c0849fc4fd9aa7e70973445a1b962a9270fd859c\r\n|             ns/byte |              byte/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|                0.47 |    2,148,996,364.97 |    0.3% |      0.01 | `SHA256`\r\n|                1.48 |      676,354,727.08 |    0.3% |      0.01 | `SHA256D64_1024`\r\n|                1.15 |      873,060,380.08 |    0.1% |      0.01 | `SHA256_32b`\r\n\r\non master\r\n|             ns/byte |              byte/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|                3.10 |      322,550,263.01 |    1.3% |      0.03 | `SHA256`\r\n|                9.26 |      107,941,088.30 |    0.7% |      0.01 | `SHA256D64_1024`\r\n|                6.22 |      160,743,377.26 |    1.6% |      0.01 | `SHA256_32b`\r\n",
      "created_at" : "2022-01-21T05:31:50Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#issuecomment-1018195343",
      "id" : 1018195343,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24115",
      "node_id" : "IC_kwDOABII5848sG2P",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1018195343/reactions"
      },
      "updated_at" : "2022-01-21T05:31:50Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1018195343",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6443210?v=4",
         "events_url" : "https://api.github.com/users/PastaPastaPasta/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PastaPastaPasta/followers",
         "following_url" : "https://api.github.com/users/PastaPastaPasta/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PastaPastaPasta/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PastaPastaPasta",
         "id" : 6443210,
         "login" : "PastaPastaPasta",
         "node_id" : "MDQ6VXNlcjY0NDMyMTA=",
         "organizations_url" : "https://api.github.com/users/PastaPastaPasta/orgs",
         "received_events_url" : "https://api.github.com/users/PastaPastaPasta/received_events",
         "repos_url" : "https://api.github.com/users/PastaPastaPasta/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PastaPastaPasta/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PastaPastaPasta/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PastaPastaPasta"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Speaking of m1, I was able to compile this locally on my m1 pro 10 core, ./configure realized that SHA2 intrinsics could be used. See benchmarks below.\r\n\r\nYes, support for Apple Silicon is included in this PR.",
      "created_at" : "2022-01-21T10:22:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#issuecomment-1018373574",
      "id" : 1018373574,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24115",
      "node_id" : "IC_kwDOABII5848syXG",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1018373574/reactions"
      },
      "updated_at" : "2022-01-21T10:22:03Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1018373574",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42201?v=4",
         "events_url" : "https://api.github.com/users/prusnak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prusnak/followers",
         "following_url" : "https://api.github.com/users/prusnak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prusnak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prusnak",
         "id" : 42201,
         "login" : "prusnak",
         "node_id" : "MDQ6VXNlcjQyMjAx",
         "organizations_url" : "https://api.github.com/users/prusnak/orgs",
         "received_events_url" : "https://api.github.com/users/prusnak/received_events",
         "repos_url" : "https://api.github.com/users/prusnak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prusnak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prusnak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prusnak"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24115#discussion_r789869130"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24115"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/789869130"
         }
      },
      "author_association" : "MEMBER",
      "body" : "I'm a bit concerned this is not well-defined. We can't guarantee that chunk has an alignment that is compatible with the `uint8x16_t` type, and even if it is, whether such a reinterpretation is permitted would be highly architecture-specific (of course, this is already architecture-specific code). Do you know of documentation that specifically permits this?\r\n\r\nIf not, I'd use this patch:\r\n\r\n```diff\r\ndiff --git a/src/crypto/sha256_arm_shani.cpp b/src/crypto/sha256_arm_shani.cpp\r\nindex c051d87042..a783be9068 100644\r\n--- a/src/crypto/sha256_arm_shani.cpp\r\n+++ b/src/crypto/sha256_arm_shani.cpp\r\n@@ -47,8 +47,6 @@ void Transform(uint32_t* s, const unsigned char* chunk, size_t blocks)\r\n     STATE0 = vld1q_u32(&s[0]);\r\n     STATE1 = vld1q_u32(&s[4]);\r\n \r\n-    const uint8x16_t* input32 = reinterpret_cast<const uint8x16_t*>(chunk);\r\n-\r\n     while (blocks--)\r\n     {\r\n         // Save state\r\n@@ -56,10 +54,14 @@ void Transform(uint32_t* s, const unsigned char* chunk, size_t blocks)\r\n         CDGH_SAVE = STATE1;\r\n \r\n         // Load and convert input chunk to Big Endian\r\n-        MSG0 = vreinterpretq_u32_u8(vrev32q_u8(*input32++));\r\n-        MSG1 = vreinterpretq_u32_u8(vrev32q_u8(*input32++));\r\n-        MSG2 = vreinterpretq_u32_u8(vrev32q_u8(*input32++));\r\n-        MSG3 = vreinterpretq_u32_u8(vrev32q_u8(*input32++));\r\n+        MSG0 = vreinterpretq_u32_u8(vrev32q_u8(vld1q_u8(chunk + 0)));\r\n+        MSG1 = vreinterpretq_u32_u8(vrev32q_u8(vld1q_u8(chunk + 16)));\r\n+        MSG2 = vreinterpretq_u32_u8(vrev32q_u8(vld1q_u8(chunk + 32)));\r\n+        MSG3 = vreinterpretq_u32_u8(vrev32q_u8(vld1q_u8(chunk + 48)));\r\n+        chunk += 64;\r\n \r\n         // Original implemenation preloaded message and constant addition which was 1-3% slower.\r\n         // Now included as first step in quad round code saving one Q Neon register\r\n```\r\n",
      "commit_id" : "f06f46cd5e2d732669e70fbfeacd7bf9b9ac8815",
      "created_at" : "2022-01-21T17:38:17Z",
      "diff_hunk" : "@@ -0,0 +1,199 @@\n+// Copyright (c) 2018-2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+// Based on https://github.com/noloader/SHA-Intrinsics/blob/master/sha256-arm.c,\n+// Written and placed in public domain by Jeffrey Walton.\n+// Based on code from ARM, and by Johannes Schneiders, Skip Hovsmith and\n+// Barry O'Rourke for the mbedTLS project.\n+\n+#ifdef ENABLE_ARM_SHANI\n+\n+#include <cstdint>\n+#include <cstddef>\n+#include <arm_acle.h>\n+#include <arm_neon.h>\n+\n+namespace {\n+static const uint32_t K[] =\n+{\n+    0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5,\n+    0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5,\n+    0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3,\n+    0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174,\n+    0xE49B69C1, 0xEFBE4786, 0x0FC19DC6, 0x240CA1CC,\n+    0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA,\n+    0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7,\n+    0xC6E00BF3, 0xD5A79147, 0x06CA6351, 0x14292967,\n+    0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13,\n+    0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85,\n+    0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3,\n+    0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070,\n+    0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5,\n+    0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3,\n+    0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208,\n+    0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2,\n+};\n+}\n+\n+namespace sha256_arm_shani {\n+void Transform(uint32_t* s, const unsigned char* chunk, size_t blocks)\n+{\n+    uint32x4_t STATE0, STATE1, ABEF_SAVE, CDGH_SAVE;\n+    uint32x4_t MSG0, MSG1, MSG2, MSG3;\n+    uint32x4_t TMP0, TMP2;\n+\n+    // Load state\n+    STATE0 = vld1q_u32(&s[0]);\n+    STATE1 = vld1q_u32(&s[4]);\n+\n+    const uint8x16_t* input32 = reinterpret_cast<const uint8x16_t*>(chunk);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#discussion_r789869130",
      "id" : 789869130,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vFHJK",
      "original_commit_id" : "d47c5fb566e17334a9ec0dd3cfe4d9947817fbf5",
      "original_line" : 50,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/crypto/sha256_arm_shani.cpp",
      "position" : null,
      "pull_request_review_id" : 859848710,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24115",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/789869130/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-21T17:38:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/789869130",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24115#discussion_r789889185"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24115"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/789889185"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Better safe than sorry - applied in f06f46c\r\n\r\nI do not see any performance hit with this change.",
      "commit_id" : "f06f46cd5e2d732669e70fbfeacd7bf9b9ac8815",
      "created_at" : "2022-01-21T18:08:41Z",
      "diff_hunk" : "@@ -0,0 +1,199 @@\n+// Copyright (c) 2018-2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+// Based on https://github.com/noloader/SHA-Intrinsics/blob/master/sha256-arm.c,\n+// Written and placed in public domain by Jeffrey Walton.\n+// Based on code from ARM, and by Johannes Schneiders, Skip Hovsmith and\n+// Barry O'Rourke for the mbedTLS project.\n+\n+#ifdef ENABLE_ARM_SHANI\n+\n+#include <cstdint>\n+#include <cstddef>\n+#include <arm_acle.h>\n+#include <arm_neon.h>\n+\n+namespace {\n+static const uint32_t K[] =\n+{\n+    0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5,\n+    0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5,\n+    0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3,\n+    0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174,\n+    0xE49B69C1, 0xEFBE4786, 0x0FC19DC6, 0x240CA1CC,\n+    0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA,\n+    0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7,\n+    0xC6E00BF3, 0xD5A79147, 0x06CA6351, 0x14292967,\n+    0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13,\n+    0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85,\n+    0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3,\n+    0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070,\n+    0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5,\n+    0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3,\n+    0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208,\n+    0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2,\n+};\n+}\n+\n+namespace sha256_arm_shani {\n+void Transform(uint32_t* s, const unsigned char* chunk, size_t blocks)\n+{\n+    uint32x4_t STATE0, STATE1, ABEF_SAVE, CDGH_SAVE;\n+    uint32x4_t MSG0, MSG1, MSG2, MSG3;\n+    uint32x4_t TMP0, TMP2;\n+\n+    // Load state\n+    STATE0 = vld1q_u32(&s[0]);\n+    STATE1 = vld1q_u32(&s[4]);\n+\n+    const uint8x16_t* input32 = reinterpret_cast<const uint8x16_t*>(chunk);",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#discussion_r789889185",
      "id" : 789889185,
      "in_reply_to_id" : 789869130,
      "line" : null,
      "node_id" : "PRRC_kwDOABII584vFMCh",
      "original_commit_id" : "d47c5fb566e17334a9ec0dd3cfe4d9947817fbf5",
      "original_line" : 50,
      "original_position" : 50,
      "original_start_line" : null,
      "path" : "src/crypto/sha256_arm_shani.cpp",
      "position" : null,
      "pull_request_review_id" : 859877409,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24115",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/789889185/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-21T18:09:00Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/789889185",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42201?v=4",
         "events_url" : "https://api.github.com/users/prusnak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prusnak/followers",
         "following_url" : "https://api.github.com/users/prusnak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prusnak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prusnak",
         "id" : 42201,
         "login" : "prusnak",
         "node_id" : "MDQ6VXNlcjQyMjAx",
         "organizations_url" : "https://api.github.com/users/prusnak/orgs",
         "received_events_url" : "https://api.github.com/users/prusnak/received_events",
         "repos_url" : "https://api.github.com/users/prusnak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prusnak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prusnak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prusnak"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Tested c0849fc4fd9aa7e70973445a1b962a9270fd859c on Mac mini (M1, 2020):\r\n```\r\n% time ./src/bitcoind -datadir=/Users/hebasto/SHANI -assumevalid=0 -stopatheight=719700 -prune=550\r\n2022-01-21T07:44:20Z Bitcoin Core version v22.99.0-c0849fc4fd9a (release build)\r\n2022-01-21T07:44:20Z Validating signatures for all blocks.\r\n2022-01-21T07:44:20Z Setting nMinimumChainWork=00000000000000000000000000000000000000001fa4663bbbe19f82de910280\r\n2022-01-21T07:44:20Z Prune configured to target 550 MiB on disk for block and undo files.\r\n2022-01-21T07:44:20Z Using the 'arm_shani(1way)' SHA256 implementation\r\n...\r\n2022-01-21T22:38:17Z Shutdown: done\r\n./src/bitcoind -datadir=/Users/hebasto/SHANI -assumevalid=0  -prune=550  149587.28s user 11456.17s system 300% cpu 14:53:56.52 total",
      "created_at" : "2022-01-21T22:45:09Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#issuecomment-1018918711",
      "id" : 1018918711,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24115",
      "node_id" : "IC_kwDOABII5848u3c3",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1018918711/reactions"
      },
      "updated_at" : "2022-01-21T22:45:09Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1018918711",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/32963518?v=4",
         "events_url" : "https://api.github.com/users/hebasto/events{/privacy}",
         "followers_url" : "https://api.github.com/users/hebasto/followers",
         "following_url" : "https://api.github.com/users/hebasto/following{/other_user}",
         "gists_url" : "https://api.github.com/users/hebasto/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/hebasto",
         "id" : 32963518,
         "login" : "hebasto",
         "node_id" : "MDQ6VXNlcjMyOTYzNTE4",
         "organizations_url" : "https://api.github.com/users/hebasto/orgs",
         "received_events_url" : "https://api.github.com/users/hebasto/received_events",
         "repos_url" : "https://api.github.com/users/hebasto/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/hebasto/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/hebasto"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "See https://github.com/sipa/bitcoin/commits/pr24115, which adds a 2-way 64-byte optimized variant. On my Cortex-A53 It's roughly a 2x speedup for the SHA256D64_1024 benchmark (relevant for Merkle root computation) compared to this PR. For more modern architectures I could imagine it's more:\r\n\r\n|             ns/byte |              byte/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|                2.60 |      384,105,263.28 |    0.3% |      0.03 | `SHA256`\r\n|                5.35 |      187,019,153.94 |    0.1% |      0.01 | `SHA256D64_1024`\r\n|               14.61 |       68,437,280.69 |    0.0% |      0.01 | `SHA256_32b`\r\n\r\nFor reference, master again:\r\n\r\n|             ns/byte |              byte/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|               15.69 |       63,715,155.54 |    0.0% |      0.17 | `SHA256`\r\n|               43.42 |       23,029,615.98 |    0.5% |      0.03 | `SHA256D64_1024`\r\n|               41.67 |       23,995,549.21 |    0.1% |      0.01 | `SHA256_32b`\r\n\r\n",
      "created_at" : "2022-01-21T23:50:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#issuecomment-1018973816",
      "id" : 1018973816,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24115",
      "node_id" : "IC_kwDOABII5848vE54",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1018973816/reactions"
      },
      "updated_at" : "2022-01-21T23:58:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1018973816",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa's branch on m1:\r\n\r\n|             ns/byte |              byte/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|                0.46 |    2,174,603,243.64 |    0.6% |      0.01 | `SHA256`\r\n|                0.95 |    1,053,985,898.82 |    0.8% |      0.01 | `SHA256D64_1024`\r\n|                1.15 |      871,857,965.44 |    0.4% |      0.01 | `SHA256_32b`\r\n\r\nprevious results on c0849 \r\n|             ns/byte |              byte/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|                0.47 |    2,148,996,364.97 |    0.3% |      0.01 | `SHA256`\r\n|                1.48 |      676,354,727.08 |    0.3% |      0.01 | `SHA256D64_1024`\r\n|                1.15 |      873,060,380.08 |    0.1% |      0.01 | `SHA256_32b`\r\n\r\n",
      "created_at" : "2022-01-22T05:04:25Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#issuecomment-1019055086",
      "id" : 1019055086,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24115",
      "node_id" : "IC_kwDOABII5848vYvu",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019055086/reactions"
      },
      "updated_at" : "2022-01-22T05:04:25Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019055086",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6443210?v=4",
         "events_url" : "https://api.github.com/users/PastaPastaPasta/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PastaPastaPasta/followers",
         "following_url" : "https://api.github.com/users/PastaPastaPasta/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PastaPastaPasta/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PastaPastaPasta",
         "id" : 6443210,
         "login" : "PastaPastaPasta",
         "node_id" : "MDQ6VXNlcjY0NDMyMTA=",
         "organizations_url" : "https://api.github.com/users/PastaPastaPasta/orgs",
         "received_events_url" : "https://api.github.com/users/PastaPastaPasta/received_events",
         "repos_url" : "https://api.github.com/users/PastaPastaPasta/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PastaPastaPasta/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PastaPastaPasta/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PastaPastaPasta"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24115#discussion_r790108893"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24115"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790108893"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I'm not sure if bitcoin core has a preference documented somewhere, but I prefer documenting what the endif is associated with such as\r\n```suggestion\r\n#endif // __arm__\r\n```",
      "commit_id" : "f06f46cd5e2d732669e70fbfeacd7bf9b9ac8815",
      "created_at" : "2022-01-22T06:10:17Z",
      "diff_hunk" : "@@ -623,6 +633,34 @@ std::string SHA256AutoDetect()\n #endif\n #endif\n \n+#if defined(ENABLE_ARM_SHANI) && !defined(BUILD_BITCOIN_INTERNAL)\n+    bool have_arm_shani = false;\n+\n+#ifdef __linux__\n+#ifdef __arm__ // 32-bit\n+    if (getauxval(AT_HWCAP2) & HWCAP2_SHA2) {\n+        have_arm_shani = true;\n+    }\n+#endif",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#discussion_r790108893",
      "id" : 790108893,
      "line" : 644,
      "node_id" : "PRRC_kwDOABII584vGBrd",
      "original_commit_id" : "f06f46cd5e2d732669e70fbfeacd7bf9b9ac8815",
      "original_line" : 644,
      "original_position" : 85,
      "original_start_line" : null,
      "path" : "src/crypto/sha256.cpp",
      "position" : 85,
      "pull_request_review_id" : 860173429,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24115",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790108893/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-22T06:10:17Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790108893",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6443210?v=4",
         "events_url" : "https://api.github.com/users/PastaPastaPasta/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PastaPastaPasta/followers",
         "following_url" : "https://api.github.com/users/PastaPastaPasta/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PastaPastaPasta/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PastaPastaPasta",
         "id" : 6443210,
         "login" : "PastaPastaPasta",
         "node_id" : "MDQ6VXNlcjY0NDMyMTA=",
         "organizations_url" : "https://api.github.com/users/PastaPastaPasta/orgs",
         "received_events_url" : "https://api.github.com/users/PastaPastaPasta/received_events",
         "repos_url" : "https://api.github.com/users/PastaPastaPasta/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PastaPastaPasta/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PastaPastaPasta/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PastaPastaPasta"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24115#discussion_r790120301"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24115"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790120301"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "I checked all the other files in `src/crypto` and we use the endif comments only for the include guards.",
      "commit_id" : "f06f46cd5e2d732669e70fbfeacd7bf9b9ac8815",
      "created_at" : "2022-01-22T08:44:36Z",
      "diff_hunk" : "@@ -623,6 +633,34 @@ std::string SHA256AutoDetect()\n #endif\n #endif\n \n+#if defined(ENABLE_ARM_SHANI) && !defined(BUILD_BITCOIN_INTERNAL)\n+    bool have_arm_shani = false;\n+\n+#ifdef __linux__\n+#ifdef __arm__ // 32-bit\n+    if (getauxval(AT_HWCAP2) & HWCAP2_SHA2) {\n+        have_arm_shani = true;\n+    }\n+#endif",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24115#discussion_r790120301",
      "id" : 790120301,
      "in_reply_to_id" : 790108893,
      "line" : 644,
      "node_id" : "PRRC_kwDOABII584vGEdt",
      "original_commit_id" : "f06f46cd5e2d732669e70fbfeacd7bf9b9ac8815",
      "original_line" : 644,
      "original_position" : 85,
      "original_start_line" : null,
      "path" : "src/crypto/sha256.cpp",
      "position" : 85,
      "pull_request_review_id" : 860185590,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24115",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790120301/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-22T08:44:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/790120301",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/42201?v=4",
         "events_url" : "https://api.github.com/users/prusnak/events{/privacy}",
         "followers_url" : "https://api.github.com/users/prusnak/followers",
         "following_url" : "https://api.github.com/users/prusnak/following{/other_user}",
         "gists_url" : "https://api.github.com/users/prusnak/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/prusnak",
         "id" : 42201,
         "login" : "prusnak",
         "node_id" : "MDQ6VXNlcjQyMjAx",
         "organizations_url" : "https://api.github.com/users/prusnak/orgs",
         "received_events_url" : "https://api.github.com/users/prusnak/received_events",
         "repos_url" : "https://api.github.com/users/prusnak/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/prusnak/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/prusnak/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/prusnak"
      }
   }
]
