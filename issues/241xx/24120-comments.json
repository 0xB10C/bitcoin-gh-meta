[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "@sipa would you be able to attempt to replicate this on your non-m1 arm machine?\r\n@prusnak would you be able to attempt to replicate this on your m1 machine?",
      "created_at" : "2022-01-22T12:43:37Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/24120#issuecomment-1019240819",
      "id" : 1019240819,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24120",
      "node_id" : "IC_kwDOABII5848wGFz",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019240819/reactions"
      },
      "updated_at" : "2022-01-22T12:43:37Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019240819",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6443210?v=4",
         "events_url" : "https://api.github.com/users/PastaPastaPasta/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PastaPastaPasta/followers",
         "following_url" : "https://api.github.com/users/PastaPastaPasta/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PastaPastaPasta/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PastaPastaPasta",
         "id" : 6443210,
         "login" : "PastaPastaPasta",
         "node_id" : "MDQ6VXNlcjY0NDMyMTA=",
         "organizations_url" : "https://api.github.com/users/PastaPastaPasta/orgs",
         "received_events_url" : "https://api.github.com/users/PastaPastaPasta/received_events",
         "repos_url" : "https://api.github.com/users/PastaPastaPasta/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PastaPastaPasta/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PastaPastaPasta/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PastaPastaPasta"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Can you debug where the time is spent? There is certain \"anti virus\" software that slows down RPC connections.",
      "created_at" : "2022-01-22T12:52:08Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/24120#issuecomment-1019245366",
      "id" : 1019245366,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24120",
      "node_id" : "IC_kwDOABII5848wHM2",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019245366/reactions"
      },
      "updated_at" : "2022-01-22T12:52:08Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019245366",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@PastaPastaPasta I'm afraid that any comparison will be difficult. The machine I have is a 24-core Cortex-A53 (an architecture designed in 2012) running at 1 GHz, with 4 GiB RAM. In terms of single-threaded performance, even a RPi 3 is faster.",
      "created_at" : "2022-01-22T13:52:54Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/24120#issuecomment-1019273182",
      "id" : 1019273182,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24120",
      "node_id" : "IC_kwDOABII5848wN_e",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019273182/reactions"
      },
      "updated_at" : "2022-01-22T13:52:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019273182",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/548488?v=4",
         "events_url" : "https://api.github.com/users/sipa/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sipa/followers",
         "following_url" : "https://api.github.com/users/sipa/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sipa/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sipa",
         "id" : 548488,
         "login" : "sipa",
         "node_id" : "MDQ6VXNlcjU0ODQ4OA==",
         "organizations_url" : "https://api.github.com/users/sipa/orgs",
         "received_events_url" : "https://api.github.com/users/sipa/received_events",
         "repos_url" : "https://api.github.com/users/sipa/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sipa/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sipa/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sipa"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Can you debug where the time is spent? There is certain \"anti virus\" software that slows down RPC connections.\r\n\r\n@MarcoFalke this is a brand new M1 install, so no custom AV or anything like that has been installed.\r\n\r\nSee attached screen shot for high level profiling. It seems like 80% of this thread (which is a rpc worker that did exclusively `getnewaddress`) was spent in wallet::DatabaseBatch::Write. The vast majority of this time ended up being spent in libsystem_kernel.dylib`__fcntl\r\n\r\nNotes for replication, start bitcoind --regtest and attach profiler to it. Then, repeatidely run `getnewaddress` I used a bash script\r\n```\r\nwhile True\r\ndo\r\n    time ./src/bitcoin-cli --regtest getnewaddress\r\n    sleep 0\r\ndone\r\n```\r\n\r\nI did this for about a minute.\r\n\r\n<img width=\"1568\" alt=\"image\" src=\"https://user-images.githubusercontent.com/6443210/150643045-f6cecb98-c223-4a30-b12e-05db26a49fe4.png\">\r\n",
      "created_at" : "2022-01-22T14:47:03Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/24120#issuecomment-1019284395",
      "id" : 1019284395,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24120",
      "node_id" : "IC_kwDOABII5848wQur",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019284395/reactions"
      },
      "updated_at" : "2022-01-22T16:04:22Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019284395",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6443210?v=4",
         "events_url" : "https://api.github.com/users/PastaPastaPasta/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PastaPastaPasta/followers",
         "following_url" : "https://api.github.com/users/PastaPastaPasta/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PastaPastaPasta/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PastaPastaPasta",
         "id" : 6443210,
         "login" : "PastaPastaPasta",
         "node_id" : "MDQ6VXNlcjY0NDMyMTA=",
         "organizations_url" : "https://api.github.com/users/PastaPastaPasta/orgs",
         "received_events_url" : "https://api.github.com/users/PastaPastaPasta/received_events",
         "repos_url" : "https://api.github.com/users/PastaPastaPasta/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PastaPastaPasta/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PastaPastaPasta/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PastaPastaPasta"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Are you using an external hard drive? I presume RPCs that don't write to disk are faster/immediate?",
      "created_at" : "2022-01-22T14:48:57Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/24120#issuecomment-1019284756",
      "id" : 1019284756,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24120",
      "node_id" : "IC_kwDOABII5848wQ0U",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019284756/reactions"
      },
      "updated_at" : "2022-01-22T14:48:57Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019284756",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Nope, everything is on the internal ssd",
      "created_at" : "2022-01-22T14:49:24Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/24120#issuecomment-1019284852",
      "id" : 1019284852,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24120",
      "node_id" : "IC_kwDOABII5848wQ10",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019284852/reactions"
      },
      "updated_at" : "2022-01-22T14:49:24Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019284852",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6443210?v=4",
         "events_url" : "https://api.github.com/users/PastaPastaPasta/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PastaPastaPasta/followers",
         "following_url" : "https://api.github.com/users/PastaPastaPasta/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PastaPastaPasta/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PastaPastaPasta",
         "id" : 6443210,
         "login" : "PastaPastaPasta",
         "node_id" : "MDQ6VXNlcjY0NDMyMTA=",
         "organizations_url" : "https://api.github.com/users/PastaPastaPasta/orgs",
         "received_events_url" : "https://api.github.com/users/PastaPastaPasta/received_events",
         "repos_url" : "https://api.github.com/users/PastaPastaPasta/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PastaPastaPasta/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PastaPastaPasta/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PastaPastaPasta"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "> Are you using an external hard drive? I presume RPCs that don't write to disk are faster/immediate?\r\n\r\nEven non-writing rpc calls are slightly slower than I'd expect. \r\n\r\n`getblockchaininfo` takes .002 seconds on my amd 1950x machine, ~0.01 seconds on m1, or about 5x slower (not sure if there's a difference between mac time and unix time commands)\r\n\r\n`listtransaction \"*\" 1000` in a wallet that generated 1310 blocks takes 0.055s on amd ~0.06s on m1\r\n\r\nIt seems like the issue is in disk / database involving rpc calls",
      "created_at" : "2022-01-22T15:29:11Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/24120#issuecomment-1019292299",
      "id" : 1019292299,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24120",
      "node_id" : "IC_kwDOABII5848wSqL",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019292299/reactions"
      },
      "updated_at" : "2022-01-22T15:29:11Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019292299",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6443210?v=4",
         "events_url" : "https://api.github.com/users/PastaPastaPasta/events{/privacy}",
         "followers_url" : "https://api.github.com/users/PastaPastaPasta/followers",
         "following_url" : "https://api.github.com/users/PastaPastaPasta/following{/other_user}",
         "gists_url" : "https://api.github.com/users/PastaPastaPasta/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/PastaPastaPasta",
         "id" : 6443210,
         "login" : "PastaPastaPasta",
         "node_id" : "MDQ6VXNlcjY0NDMyMTA=",
         "organizations_url" : "https://api.github.com/users/PastaPastaPasta/orgs",
         "received_events_url" : "https://api.github.com/users/PastaPastaPasta/received_events",
         "repos_url" : "https://api.github.com/users/PastaPastaPasta/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/PastaPastaPasta/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/PastaPastaPasta/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/PastaPastaPasta"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I have a Macbook Pro (16GB + Intel arch) and a Macbook Air M1, I will compare the results and post here.",
      "created_at" : "2022-01-22T22:13:30Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/24120#issuecomment-1019367321",
      "id" : 1019367321,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24120",
      "node_id" : "IC_kwDOABII5848wk-Z",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019367321/reactions"
      },
      "updated_at" : "2022-01-22T22:13:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1019367321",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "Tested some functional tests here (`wallet_listtransactions` and `rpc_blockchain`) and both executes faster on M1. 60% faster.",
      "created_at" : "2022-01-24T11:30:33Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/24120#issuecomment-1020001100",
      "id" : 1020001100,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24120",
      "node_id" : "IC_kwDOABII5848y_tM",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020001100/reactions"
      },
      "updated_at" : "2022-01-24T11:30:33Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020001100",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/19480819?v=4",
         "events_url" : "https://api.github.com/users/brunoerg/events{/privacy}",
         "followers_url" : "https://api.github.com/users/brunoerg/followers",
         "following_url" : "https://api.github.com/users/brunoerg/following{/other_user}",
         "gists_url" : "https://api.github.com/users/brunoerg/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/brunoerg",
         "id" : 19480819,
         "login" : "brunoerg",
         "node_id" : "MDQ6VXNlcjE5NDgwODE5",
         "organizations_url" : "https://api.github.com/users/brunoerg/orgs",
         "received_events_url" : "https://api.github.com/users/brunoerg/received_events",
         "repos_url" : "https://api.github.com/users/brunoerg/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/brunoerg/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/brunoerg"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "@PastaPastaPasta It might be worth to check your ssd for defects and performance",
      "created_at" : "2022-01-24T11:38:20Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/24120#issuecomment-1020007217",
      "id" : 1020007217,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24120",
      "node_id" : "IC_kwDOABII5848zBMx",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020007217/reactions"
      },
      "updated_at" : "2022-01-24T11:38:20Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1020007217",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/6399679?v=4",
         "events_url" : "https://api.github.com/users/MarcoFalke/events{/privacy}",
         "followers_url" : "https://api.github.com/users/MarcoFalke/followers",
         "following_url" : "https://api.github.com/users/MarcoFalke/following{/other_user}",
         "gists_url" : "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/MarcoFalke",
         "id" : 6399679,
         "login" : "MarcoFalke",
         "node_id" : "MDQ6VXNlcjYzOTk2Nzk=",
         "organizations_url" : "https://api.github.com/users/MarcoFalke/orgs",
         "received_events_url" : "https://api.github.com/users/MarcoFalke/received_events",
         "repos_url" : "https://api.github.com/users/MarcoFalke/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/MarcoFalke/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/MarcoFalke"
      }
   }
]
