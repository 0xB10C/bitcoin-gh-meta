[
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#24007](https://github.com/bitcoin/bitcoin/pull/24007) ([mempool] allow tx replacement by smaller witness by LarryRuane)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
      "created_at" : "2022-01-26T00:08:41Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24152#issuecomment-1021726430",
      "id" : 1021726430,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24152",
      "node_id" : "IC_kwDOABII58485k7e",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1021726430/reactions"
      },
      "updated_at" : "2022-01-26T00:08:41Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1021726430",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/39886733?v=4",
         "events_url" : "https://api.github.com/users/DrahtBot/events{/privacy}",
         "followers_url" : "https://api.github.com/users/DrahtBot/followers",
         "following_url" : "https://api.github.com/users/DrahtBot/following{/other_user}",
         "gists_url" : "https://api.github.com/users/DrahtBot/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/DrahtBot",
         "id" : 39886733,
         "login" : "DrahtBot",
         "node_id" : "MDQ6VXNlcjM5ODg2NzMz",
         "organizations_url" : "https://api.github.com/users/DrahtBot/orgs",
         "received_events_url" : "https://api.github.com/users/DrahtBot/received_events",
         "repos_url" : "https://api.github.com/users/DrahtBot/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/DrahtBot/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/DrahtBot"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802669892"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802669892"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "fee-bump **for** transaction B",
      "commit_id" : "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "created_at" : "2022-02-09T13:38:53Z",
      "diff_hunk" : "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+### Transactions Are Always Submitted Individually First\n+\n+Transactions within a package are always validated individually first, and package validation is\n+used for the transactions that failed.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping. That is, transaction A is a\n+\"legitimate\" fee-bump transaction B only if A is a descendant of B and has a higher feerate.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802669892",
      "id" : 802669892,
      "line" : 85,
      "node_id" : "PRRC_kwDOABII584v18VE",
      "original_commit_id" : "486cd4cfb1b66897cf3a414953b160faaeaafe0c",
      "original_line" : 85,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "doc/policy/packages.md",
      "position" : 29,
      "pull_request_review_id" : 877471788,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802669892/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T18:03:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802669892",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802723149"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802723149"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It's not really clear at this point of the document what \"deduplication\" means - I think both removal of transaction already in the mempool, and removal of package txs that would also get accepted individually. The *Rationale* section on this only mentions the first. Maybe add an explanation/pointer to the following section.",
      "commit_id" : "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "created_at" : "2022-02-09T14:31:46Z",
      "diff_hunk" : "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802723149",
      "id" : 802723149,
      "line" : 64,
      "node_id" : "PRRC_kwDOABII584v2JVN",
      "original_commit_id" : "486cd4cfb1b66897cf3a414953b160faaeaafe0c",
      "original_line" : 64,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "doc/policy/packages.md",
      "position" : 8,
      "pull_request_review_id" : 877471788,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802723149/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T18:03:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802723149",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802799166"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802799166"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Now that a PackageMempoolAcceptResult with empty `m_tx_results` is returned if the fee is too low, the `tx_pool_standard` fuzz test needs an update, because it [asserts](https://github.com/bitcoin/bitcoin/blob/5e8e0b3d7f6055e326bda61e60712b530e8920f0/src/test/fuzz/tx_pool.cpp#L242) non-emptiness.",
      "commit_id" : "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "created_at" : "2022-02-09T15:39:09Z",
      "diff_hunk" : "@@ -1199,6 +1211,21 @@ PackageMempoolAcceptResult MemPoolAccept::AcceptMultipleTransactions(const std::\n         m_viewmempool.PackageAddTransaction(ws.m_ptx);\n     }\n \n+    // Transactions must meet two minimum feerates: the mempool minimum fee and min relay fee.\n+    // For transactions consisting of exactly one child and its parents, it suffices to use the\n+    // package feerate (total modified fees / total virtual size) to check this requirement.\n+    m_total_vsize = std::accumulate(workspaces.cbegin(), workspaces.cend(), 0,\n+        [](int64_t sum, auto& ws) { return sum + ws.m_vsize; });\n+    m_total_modified_fees = std::accumulate(workspaces.cbegin(), workspaces.cend(), 0,\n+        [](CAmount sum, auto& ws) { return sum + ws.m_modified_fees; });\n+    const CFeeRate package_feerate(m_total_modified_fees, m_total_vsize);\n+    TxValidationState placeholder_state;\n+    if (args.m_package_feerates &&\n+        !CheckFeeRate(m_total_vsize, m_total_modified_fees, placeholder_state)) {\n+        package_state.Invalid(PackageValidationResult::PCKG_POLICY, \"package-fee-too-low\");\n+        return PackageMempoolAcceptResult(package_state, package_feerate, {});",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802799166",
      "id" : 802799166,
      "line" : 1240,
      "node_id" : "PRRC_kwDOABII584v2b4-",
      "original_commit_id" : "f90b6c52681c4a7968c2467641a383f1fc1991d2",
      "original_line" : 1226,
      "original_position" : 76,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 76,
      "pull_request_review_id" : 877471788,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802799166/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T18:03:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802799166",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802851282"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802851282"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "this sentence confused me at first because it seems to describe the very use case of CPFP where a high fee of a child does impact the consideration of a parent - maybe \"insufficient fees of children should...\"",
      "commit_id" : "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "created_at" : "2022-02-09T16:24:46Z",
      "diff_hunk" : "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+### Transactions Are Always Submitted Individually First\n+\n+Transactions within a package are always validated individually first, and package validation is\n+used for the transactions that failed.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping. That is, transaction A is a\n+\"legitimate\" fee-bump transaction B only if A is a descendant of B and has a higher feerate.\n+Package feerate, as defined above, does not consider the fees and relationships between all\n+transactions in the package. We want to prevent \"parents pay for children\" behavior; fees of",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802851282",
      "id" : 802851282,
      "line" : 87,
      "node_id" : "PRRC_kwDOABII584v2onS",
      "original_commit_id" : "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "original_line" : 87,
      "original_position" : 31,
      "original_start_line" : null,
      "path" : "doc/policy/packages.md",
      "position" : 31,
      "pull_request_review_id" : 877471788,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802851282/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T18:03:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802851282",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802858141"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802858141"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "shouldn't this be \"A's fees cannot help B\"?",
      "commit_id" : "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "created_at" : "2022-02-09T16:29:52Z",
      "diff_hunk" : "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+### Transactions Are Always Submitted Individually First\n+\n+Transactions within a package are always validated individually first, and package validation is\n+used for the transactions that failed.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping. That is, transaction A is a\n+\"legitimate\" fee-bump transaction B only if A is a descendant of B and has a higher feerate.\n+Package feerate, as defined above, does not consider the fees and relationships between all\n+transactions in the package. We want to prevent \"parents pay for children\" behavior; fees of\n+children should have no impact on the consideration of their parents, since they are not necessary\n+for the parents to be mined. More generally, if transaction B is not needed in order for transaction\n+A to be mined, B's fees cannot help A. In a child-with-parents package, simply excluding any parent",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802858141",
      "id" : 802858141,
      "line" : 90,
      "node_id" : "PRRC_kwDOABII584v2qSd",
      "original_commit_id" : "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "original_line" : 90,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "doc/policy/packages.md",
      "position" : 34,
      "pull_request_review_id" : 877471788,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802858141/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T18:03:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802858141",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802872913"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802872913"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "Could `m_total_modified_fees` and  `m_total_vsize` just be local variables? They seem to be used only in `MemPoolAccept::AcceptMultipleTransactions`.",
      "commit_id" : "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "created_at" : "2022-02-09T16:43:22Z",
      "diff_hunk" : "@@ -649,6 +656,10 @@ class MemPoolAccept\n \n     CChainState& m_active_chainstate;\n \n+    // Used to calculate package feerate.\n+    CAmount m_total_modified_fees;",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802872913",
      "id" : 802872913,
      "line" : 674,
      "node_id" : "PRRC_kwDOABII584v2t5R",
      "original_commit_id" : "f90b6c52681c4a7968c2467641a383f1fc1991d2",
      "original_line" : 660,
      "original_position" : 40,
      "original_start_line" : null,
      "path" : "src/validation.cpp",
      "position" : 40,
      "pull_request_review_id" : 877471788,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802872913/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T18:03:21Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802872913",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/48763452?v=4",
         "events_url" : "https://api.github.com/users/mzumsande/events{/privacy}",
         "followers_url" : "https://api.github.com/users/mzumsande/followers",
         "following_url" : "https://api.github.com/users/mzumsande/following{/other_user}",
         "gists_url" : "https://api.github.com/users/mzumsande/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/mzumsande",
         "id" : 48763452,
         "login" : "mzumsande",
         "node_id" : "MDQ6VXNlcjQ4NzYzNDUy",
         "organizations_url" : "https://api.github.com/users/mzumsande/orgs",
         "received_events_url" : "https://api.github.com/users/mzumsande/received_events",
         "repos_url" : "https://api.github.com/users/mzumsande/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/mzumsande/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/mzumsande"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802952279"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802952279"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "nit, most examples seem to designate a parent as A and its child as B (which I like, because that corresponds to time-order, first A, then B), but this seems to be reversed? I believe a few lines below, the convention I'm suggesting is followed, (A is parent, B is child). Also, should \"transaction B\" be \"transaction for B\"?",
      "commit_id" : "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "created_at" : "2022-02-09T18:07:18Z",
      "diff_hunk" : "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.\n+\n+To meet the two feerate requirements of a mempool, i.e., the pre-configured minimum relay feerate\n+(`minRelayTxFee`) and dynamic mempool minimum feerate, the total package feerate is used instead of\n+the individual feerate. The individual transactions are allowed to be below feerate requirements if\n+the package meets the feerate requirements. For example, the parent(s) in the package can have 0\n+fees but be paid for by the child.\n+\n+*Rationale*: This can be thought of as \"CPFP within a package,\" solving the issue of a parent not\n+meeting minimum fees on its own. This allows L2 applications to adjust their fees at broadcast time\n+instead of overshooting or risking getting stuck/pinned.\n+\n+*Rationale*: It would be incorrect to use the fees of transactions that are already in the mempool, as\n+we do not want a transaction's fees to be double-counted.\n+\n+### Transactions Are Always Submitted Individually First\n+\n+Transactions within a package are always validated individually first, and package validation is\n+used for the transactions that failed.\n+\n+*Rationale*: Packages are intended for incentive-compatible fee-bumping. That is, transaction A is a\n+\"legitimate\" fee-bump transaction B only if A is a descendant of B and has a higher feerate.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802952279",
      "id" : 802952279,
      "line" : 85,
      "node_id" : "PRRC_kwDOABII584v3BRX",
      "original_commit_id" : "486cd4cfb1b66897cf3a414953b160faaeaafe0c",
      "original_line" : 85,
      "original_position" : 29,
      "original_start_line" : null,
      "path" : "doc/policy/packages.md",
      "position" : 29,
      "pull_request_review_id" : 877867313,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802952279/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T18:19:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802952279",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802954740"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802954740"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "This is okay, but when I first read this, I had no idea what \"modified\" meant (only learning later that the `prioritisetransaction` RPC does the modifying); perhaps \"modified\" can be dropped? I think it's implicit. Or maybe briefly mention the RPC here.",
      "commit_id" : "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "created_at" : "2022-02-09T18:10:16Z",
      "diff_hunk" : "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802954740",
      "id" : 802954740,
      "line" : 63,
      "node_id" : "PRRC_kwDOABII584v3B30",
      "original_commit_id" : "486cd4cfb1b66897cf3a414953b160faaeaafe0c",
      "original_line" : 63,
      "original_position" : 7,
      "original_start_line" : null,
      "path" : "doc/policy/packages.md",
      "position" : 7,
      "pull_request_review_id" : 877867313,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802954740/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T18:19:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802954740",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802955759"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802955759"
         }
      },
      "author_association" : "CONTRIBUTOR",
      "body" : "It's unclear to me what \"deduplication\" means here. I thought a package, by definition, contains no duplicate transactions.",
      "commit_id" : "7daf3d08b48669305574bc306d42a243ff1a25fb",
      "created_at" : "2022-02-09T18:11:30Z",
      "diff_hunk" : "@@ -57,3 +57,40 @@ test accepts):\n \n    - Warning: Batched fee-bumping may be unsafe for some use cases. Users and application developers\n      should take caution if utilizing multi-parent packages.\n+\n+### Package Fees and Feerate\n+\n+*Package Feerate* is the total modified fees divided by the total virtual size of all transactions\n+in the package after deduplication.",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24152#discussion_r802955759",
      "id" : 802955759,
      "line" : 64,
      "node_id" : "PRRC_kwDOABII584v3CHv",
      "original_commit_id" : "486cd4cfb1b66897cf3a414953b160faaeaafe0c",
      "original_line" : 64,
      "original_position" : 8,
      "original_start_line" : null,
      "path" : "doc/policy/packages.md",
      "position" : 8,
      "pull_request_review_id" : 877867313,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24152",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802955759/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-02-09T18:19:02Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/802955759",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/8321330?v=4",
         "events_url" : "https://api.github.com/users/LarryRuane/events{/privacy}",
         "followers_url" : "https://api.github.com/users/LarryRuane/followers",
         "following_url" : "https://api.github.com/users/LarryRuane/following{/other_user}",
         "gists_url" : "https://api.github.com/users/LarryRuane/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/LarryRuane",
         "id" : 8321330,
         "login" : "LarryRuane",
         "node_id" : "MDQ6VXNlcjgzMjEzMzA=",
         "organizations_url" : "https://api.github.com/users/LarryRuane/orgs",
         "received_events_url" : "https://api.github.com/users/LarryRuane/received_events",
         "repos_url" : "https://api.github.com/users/LarryRuane/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/LarryRuane/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/LarryRuane/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/LarryRuane"
      }
   }
]
