[
   {
      "author_association" : "NONE",
      "body" : "hey @prayank23 please review the PR",
      "created_at" : "2022-01-27T18:34:31Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24180#issuecomment-1023525508",
      "id" : 1023525508,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24180",
      "node_id" : "IC_kwDOABII5849AcKE",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1023525508/reactions"
      },
      "updated_at" : "2022-01-27T18:34:31Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1023525508",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/58676502?v=4",
         "events_url" : "https://api.github.com/users/sh15h4nk/events{/privacy}",
         "followers_url" : "https://api.github.com/users/sh15h4nk/followers",
         "following_url" : "https://api.github.com/users/sh15h4nk/following{/other_user}",
         "gists_url" : "https://api.github.com/users/sh15h4nk/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/sh15h4nk",
         "id" : 58676502,
         "login" : "sh15h4nk",
         "node_id" : "MDQ6VXNlcjU4Njc2NTAy",
         "organizations_url" : "https://api.github.com/users/sh15h4nk/orgs",
         "received_events_url" : "https://api.github.com/users/sh15h4nk/received_events",
         "repos_url" : "https://api.github.com/users/sh15h4nk/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/sh15h4nk/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/sh15h4nk/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/sh15h4nk"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24180#discussion_r793898891"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24180"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/793898891"
         }
      },
      "author_association" : "MEMBER",
      "body" : "FWIW, if you want to allow only svgs you can also replace the first `'-'` with `'svg:-'`. This makes imagemagick check the format and would avoid adding two dependencies (or at least one).",
      "commit_id" : "11984ddd8e1b37533852b3214141fcacdf691877",
      "created_at" : "2022-01-27T18:42:15Z",
      "diff_hunk" : "@@ -120,22 +122,34 @@ def bitcoin_cli(rpc_command_and_params):\n if args.captcha != '': # Retrieve a captcha\n     try:\n         res = session.get(args.captcha)\n-    except:\n-        print('Unexpected error when contacting faucet:', sys.exc_info()[0])\n-        exit(1)\n+        res.raise_for_status()\n+    except requests.exceptions.RequestException as e:\n+        raise SystemExit(f\"Unexpected error when contacting faucet: {e}\")\n+\n+    # Size limitation\n+    svg = xml.etree.ElementTree.fromstring(res.content)\n+    if (svg.attrib.get('width') != '150' or svg.attrib.get('height') != '50'):\n+        raise SystemExit(\"Captcha dimentions doesn't satisify\")\n+\n+    # SVG sanitizing\n+    content = bleach.clean(res.content.decode(), tags=['svg', 'path'], attributes={'*': ['path', 'fill', 'height', 'width', 'd']}).encode()\n+    # Allowing only SVG's\n+    if content == b\"\":\n+        raise SystemExit(f\"No captcha found URL {args.captcha}\")\n \n     # Convert SVG image to PPM, and load it\n     try:\n-        rv = subprocess.run([args.imagemagick, '-', '-depth', '8', 'ppm:-'], input=res.content, check=True, capture_output=True)\n+        rv = subprocess.run([args.imagemagick, '-', '-depth', '8', 'ppm:-'], input=content, check=True, capture_output=True)",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24180#discussion_r793898891",
      "id" : 793898891,
      "line" : 142,
      "node_id" : "PRRC_kwDOABII584vUe-L",
      "original_commit_id" : "11984ddd8e1b37533852b3214141fcacdf691877",
      "original_line" : 142,
      "original_position" : 34,
      "original_start_line" : null,
      "path" : "contrib/signet/getcoins.py",
      "position" : 34,
      "pull_request_review_id" : 865289519,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24180",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/793898891/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-27T18:49:01Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/793898891",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24180#discussion_r793903036"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24180"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/793903036"
         }
      },
      "author_association" : "MEMBER",
      "body" : "This is not correct English, \"Captcha size doesn't match expected 150x50\" maybe",
      "commit_id" : "11984ddd8e1b37533852b3214141fcacdf691877",
      "created_at" : "2022-01-27T18:47:58Z",
      "diff_hunk" : "@@ -120,22 +122,34 @@ def bitcoin_cli(rpc_command_and_params):\n if args.captcha != '': # Retrieve a captcha\n     try:\n         res = session.get(args.captcha)\n-    except:\n-        print('Unexpected error when contacting faucet:', sys.exc_info()[0])\n-        exit(1)\n+        res.raise_for_status()\n+    except requests.exceptions.RequestException as e:\n+        raise SystemExit(f\"Unexpected error when contacting faucet: {e}\")\n+\n+    # Size limitation\n+    svg = xml.etree.ElementTree.fromstring(res.content)\n+    if (svg.attrib.get('width') != '150' or svg.attrib.get('height') != '50'):\n+        raise SystemExit(\"Captcha dimentions doesn't satisify\")",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24180#discussion_r793903036",
      "id" : 793903036,
      "line" : 132,
      "node_id" : "PRRC_kwDOABII584vUf-8",
      "original_commit_id" : "11984ddd8e1b37533852b3214141fcacdf691877",
      "original_line" : 132,
      "original_position" : 23,
      "original_start_line" : null,
      "path" : "contrib/signet/getcoins.py",
      "position" : 23,
      "pull_request_review_id" : 865295181,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24180",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/793903036/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-27T18:47:58Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/793903036",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "author_association" : "MEMBER",
      "body" : "Concept ACK. I think a dependency on `etree` xml is acceptable as it is commonly installed (or maybe even part of Python, i don't know for sure), but would prefer to avoid `bleach`.",
      "created_at" : "2022-01-27T18:50:26Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24180#issuecomment-1023537657",
      "id" : 1023537657,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/24180",
      "node_id" : "IC_kwDOABII5849AfH5",
      "performed_via_github_app" : null,
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1023537657/reactions"
      },
      "updated_at" : "2022-01-27T18:50:26Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/1023537657",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   },
   {
      "_links" : {
         "html" : {
            "href" : "https://github.com/bitcoin/bitcoin/pull/24180#discussion_r793908222"
         },
         "pull_request" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24180"
         },
         "self" : {
            "href" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/793908222"
         }
      },
      "author_association" : "MEMBER",
      "body" : "Nit: no outer `()` needed for Python if",
      "commit_id" : "11984ddd8e1b37533852b3214141fcacdf691877",
      "created_at" : "2022-01-27T18:54:54Z",
      "diff_hunk" : "@@ -120,22 +122,34 @@ def bitcoin_cli(rpc_command_and_params):\n if args.captcha != '': # Retrieve a captcha\n     try:\n         res = session.get(args.captcha)\n-    except:\n-        print('Unexpected error when contacting faucet:', sys.exc_info()[0])\n-        exit(1)\n+        res.raise_for_status()\n+    except requests.exceptions.RequestException as e:\n+        raise SystemExit(f\"Unexpected error when contacting faucet: {e}\")\n+\n+    # Size limitation\n+    svg = xml.etree.ElementTree.fromstring(res.content)\n+    if (svg.attrib.get('width') != '150' or svg.attrib.get('height') != '50'):",
      "html_url" : "https://github.com/bitcoin/bitcoin/pull/24180#discussion_r793908222",
      "id" : 793908222,
      "line" : 131,
      "node_id" : "PRRC_kwDOABII584vUhP-",
      "original_commit_id" : "11984ddd8e1b37533852b3214141fcacdf691877",
      "original_line" : 131,
      "original_position" : 22,
      "original_start_line" : null,
      "path" : "contrib/signet/getcoins.py",
      "position" : 22,
      "pull_request_review_id" : 865302277,
      "pull_request_url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/24180",
      "reactions" : {
         "+1" : 0,
         "-1" : 0,
         "confused" : 0,
         "eyes" : 0,
         "heart" : 0,
         "hooray" : 0,
         "laugh" : 0,
         "rocket" : 0,
         "total_count" : 0,
         "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/793908222/reactions"
      },
      "side" : "RIGHT",
      "start_line" : null,
      "start_side" : null,
      "updated_at" : "2022-01-27T18:54:54Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/793908222",
      "user" : {
         "avatar_url" : "https://avatars.githubusercontent.com/u/126646?v=4",
         "events_url" : "https://api.github.com/users/laanwj/events{/privacy}",
         "followers_url" : "https://api.github.com/users/laanwj/followers",
         "following_url" : "https://api.github.com/users/laanwj/following{/other_user}",
         "gists_url" : "https://api.github.com/users/laanwj/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/laanwj",
         "id" : 126646,
         "login" : "laanwj",
         "node_id" : "MDQ6VXNlcjEyNjY0Ng==",
         "organizations_url" : "https://api.github.com/users/laanwj/orgs",
         "received_events_url" : "https://api.github.com/users/laanwj/received_events",
         "repos_url" : "https://api.github.com/users/laanwj/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/laanwj/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/laanwj"
      }
   }
]
