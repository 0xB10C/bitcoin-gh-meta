[
   {
      "author_association" : "MEMBER",
      "body" : "It's probably due to the large dbcache. If the dbcache didn't flush before the shutdown, then the database would not have updated with the state stored in the dbcache.",
      "created_at" : "2017-11-18T20:30:39Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11724#issuecomment-345469157",
      "id" : 345469157,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11724",
      "updated_at" : "2017-11-18T20:30:39Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/345469157",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/3782274?v=4",
         "events_url" : "https://api.github.com/users/achow101/events{/privacy}",
         "followers_url" : "https://api.github.com/users/achow101/followers",
         "following_url" : "https://api.github.com/users/achow101/following{/other_user}",
         "gists_url" : "https://api.github.com/users/achow101/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/achow101",
         "id" : 3782274,
         "login" : "achow101",
         "organizations_url" : "https://api.github.com/users/achow101/orgs",
         "received_events_url" : "https://api.github.com/users/achow101/received_events",
         "repos_url" : "https://api.github.com/users/achow101/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/achow101/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/achow101/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/achow101"
      }
   },
   {
      "author_association" : "CONTRIBUTOR",
      "body" : "I think so too. I probably can't figure out the way the algo works, but I wonder if it deducts dbcache from \"disk space remaining\" when it determines when to shut down. \r\nAnother thing I wonder about is if there are some scheduled \"write cache flush\" index checkpoint events that didn't kick in on time due to my node's fast speed of syncing (30 MB/s).\r\n\r\nEdit: \r\nI forgot to mention one important point: I had another write-dominant workload running on the system, which probably messed up the calculation. \r\nI just did a test of shutdown time with dbcache=1000 vs dbcache=8000 and it was 0m20s vs 6m00s (in both cases, there was no other workload). \r\nIt's possible that the other workload combined with the long shutdown time made bitcoind unable to shutdown while there was still some free space on disk. If this is a situation that makes this issue invalid, I'll close it.",
      "created_at" : "2017-11-18T20:36:28Z",
      "html_url" : "https://github.com/bitcoin/bitcoin/issues/11724#issuecomment-345469501",
      "id" : 345469501,
      "issue_url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/11724",
      "updated_at" : "2017-11-18T21:13:30Z",
      "url" : "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/345469501",
      "user" : {
         "avatar_url" : "https://avatars3.githubusercontent.com/u/13134193?v=4",
         "events_url" : "https://api.github.com/users/unsystemizer/events{/privacy}",
         "followers_url" : "https://api.github.com/users/unsystemizer/followers",
         "following_url" : "https://api.github.com/users/unsystemizer/following{/other_user}",
         "gists_url" : "https://api.github.com/users/unsystemizer/gists{/gist_id}",
         "gravatar_id" : "",
         "html_url" : "https://github.com/unsystemizer",
         "id" : 13134193,
         "login" : "unsystemizer",
         "organizations_url" : "https://api.github.com/users/unsystemizer/orgs",
         "received_events_url" : "https://api.github.com/users/unsystemizer/received_events",
         "repos_url" : "https://api.github.com/users/unsystemizer/repos",
         "site_admin" : false,
         "starred_url" : "https://api.github.com/users/unsystemizer/starred{/owner}{/repo}",
         "subscriptions_url" : "https://api.github.com/users/unsystemizer/subscriptions",
         "type" : "User",
         "url" : "https://api.github.com/users/unsystemizer"
      }
   }
]
